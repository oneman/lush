A THEORY OF ORDINARY P-ADIC CURVES

A Theory of Ordinary p-adic Curves
By

Shinichi MOCHIZUKI*

Table of Contents

Table of Contents

Introduction
§0. Statement of Main Results
§1. Review of the Complex Theory
Beltrami Diﬀerentials
The Beltrami Equation
The Series Expansion of a Quasiconformal Function
Uniformization of Hyperbolic Riemann Surfaces
Uniformization of Moduli Stacks of Hyperbolic Riemann Surfaces
Quasidisks and the Bers Embedding
The Inﬁnitesimal Form of the Modular Uniformizations
Coordinates of Degeneration
The Parabolic Case
Real Curves
§2. Translation into the p-adic Case
Gunning’s Theory of Indigenous Bundles
The Canonical Coordinates Associated to a Kähler Metric
The Weil-Petersson Metric from the Point of View of Indigenous Bundles
The Philosophy of Kähler Metrics as Frobenius Liftings
The Dictionary
Loose Ends
Received September 8, 1995. Revised October 2, 1996.
1991 Mathematics Subject Classiﬁcation: 14H10, 14F30

* Research Institute for Mathematical Sciences, Kyoto University, Kyoto 606, Japan
1

Chapter I: Crystalline Projective Structures
§0. Introduction
§1. Schwarz Structures
Notation and Basic Deﬁnitions
First Properties of Schwarz Structures
Crystalline Schwarz Structures and Monodromy
Correspondence with P1 -bundles
Schwarz Structures and Square Diﬀerentials
Normalized P1 -bundles with Connection
The Schwarzian Derivative
§2. Indigenous Bundles
Basic Deﬁnitions and Examples
First Properties
Existence and de Rham Cohomology
Indigenous Bundles of Restrictable Type
§3. The Obstruction to Global Intrinsicity
Introduction of Cohomology Classes
Computation of the Second Chern Class
The Case of Dimension One
Appendix: Relation to the Complex Analytic Case

Chapter II: Indigenous Bundles in Characteristic p
§0. Introduction
§1. FL-Bundles
Deformations and FL-Bundles
The p-Curvature of an FL-Bundle
§2. The Verschiebung on Indigenous Bundles
The Deﬁnition of The Verschiebung
The p-Curvature of an Admissible Indigenous Bundle
The Inﬁnitesimal Verschiebung
Diﬀerential Criterion for Admissibility
2

§3. Hyperbolically Ordinary Curves
Basic Deﬁnitions
The Totally Degenerate Case
The Case of Elliptic Curves: The Parabolic Picture
The Case of Elliptic Curves: The Hyperbolic Picture
The Generic Uniformization Number

Chapter III: Canonical Modular Frobenius Liftings
§0. Introduction
§1. Generalities on Ordinary Frobenius Liftings
Basic Deﬁnitions
The Uniformizing Galois Representation
The Canonical p-divisible Group
Logarithms of Periods
Compatibility of Diﬀerentials
Canonical Liftings of Points in Characteristic p
Canonical Multiplicative Parameters
Canonical Aﬃne Coordinates
The Relationship Between Aﬃne and Multiplicative Parameters
§2. Construction of the Canonical Frobenius Lifting
Modular Frobenius Liftings
Indigenous Sections of D
Frobenius Invariant Indigenous Bundles
§3. Applications of the Canonical Frobenius Liftings
Canonical Liftings of Curves over Witt Vectors
Canonical Aﬃne Coordinates on Mg,r
Topological Markings and Uniformization by Quadratic Diﬀerentials
Canonical Multiplicative Parameters
The Case of Elliptic Curves

Chapter IV: Canonical Curves
§0. Introduction
3

§1. The Canonical Galois Representation
Construction and Global Properties
The Horizontal Section over the Ordinary Locus
The Canonical Frobenius Lifting over the Ordinary Locus
§2. The Canonical Log p-divisible Group
Log p-divisible Groups at Inﬁnity
Construction of the Canonical Log p-divisible Group
Review of the Theory of [Katz-Mazur]
§3. The Compactiﬁed Canonical Frobenius Lifting
The Canonical Frobenius Lifting and the Canonical Log p-divisible Group
Local Analysis at Supersingular Points
Global Hecke Correspondences
§4. p-adic Green’s Functions
Compactiﬁed Frobenius Liftings
The Height of a Frobenius Lifting
Admissible Frobenius Liftings
Geometric Criterion for Canonicality

Chapter V: Uniformizations of Ordinary Curves
§0. Introduction
§1. Crystalline Induction
The Crystalline-Induced MF ∇ -object
The Ring of Additive Periods
The Crystalline-Induced Galois Representation
Relation to the Canonical Aﬃne Coordinates
The Parabolic Case
§2. Canonical Objects over the Stack of Multiplicative Periods
The Stack of Multiplicative Periods
The Canonical Log p-divisible Group
The Canonical Frobenius Lifting

Bibliography
Index
4

Introduction
§0. Statement of Main Results
The goal of this paper is to present a theory of r-pointed stable curves of genus g over
p-adic schemes (for p odd), which, on the one hand, generalizes the Serre-Tate theory of
ordinary elliptic curves to the hyperbolic case (i.e., 2g − 2 + r ≥ 1), and, on the other hand,
generalizes the complex uniformization theory of hyperbolic Riemann surfaces (reviewed in
§1 of this introductory Chapter) due to Ahlfors, Bers, et al. to the p-adic case. We begin by
setting up the necessary algebraic machinery: that is, the language of indigenous bundles
(due to Gunning, although we rephrase Gunning’s results in a more algebraic form). An
indigenous bundle is a P1 -bundle over a curve, together with a connection, that satisfy
certain properties. One may think of an indigenous bundle as an algebraic way of encoding
uniformization data for a curve. We then study the p-curvature of indigenous bundles in
characteristic p, and show that a generic r-pointed stable curve of genus g has a ﬁnite,
nonzero number of distinguished indigenous bundles (P, ∇P ), which are characterized by
the following two properties:
(1) the p-curvature of (P, ∇P ) is nilpotent;
(2) the space of indigenous bundles with nilpotent p-curvature is étale over
the moduli stack of curves at (P, ∇P ).
We call such (P, ∇P ) nilpotent and ordinary, and we call curves ordinary if they admit at
least one such nilpotent, ordinary indigenous bundle. If a curve is ordinary, then choosing any one of the ﬁnite number of nilpotent, ordinary indigenous bundles on the curve
completely determines the “uniformization theory of the curve” – to be described in the
following paragraphs. Because of this, we refer to this choice as the choice of a p-adic
quasiconformal equivalence class to which the curve belongs.
After studying various basic properties of ordinary curves and ordinary indigenous
bundles in characteristic p, we then consider the p-adic theory. Let Mg,r be the moduli
stack of r-pointed stable curves of genus g over Zp . Then we show that there exists a
ord

canonical p-adic (nonempty) formal stack N g,r together with an étale morphism
ord

N g,r → Mg,r
ord

such that modulo p, N g,r is the moduli stack of ordinary r-pointed curves of genus g,
together with a choice of p-adic quasiconformal equivalence class. Moreover, the generic
ord
degree of N g,r over Mg,r is > 1 (as long as 2g − 2 + r ≥ 1 and p is suﬃciently large). It is
ord

over N g,r that most of our theory will take place. Our ﬁrst main result is the following:
5

ord

Theorem 0.1. Let C log → (N g,r )log (where the “log” refers to canonical log stack structures) be the tautological ordinary r-pointed stable curve of genus g. Then there exists a
ord log
, together with a canonical indigenous buncanonical Frobenius lifting Φlog
N on (N g,r )
log
log
dle (P, ∇P ) on C . Moreover, ΦN and (P, ∇P ) are uniquely characterized by the fact
(P, ∇P ) is “Frobenius invariant” (in some suitable sense) with respect to Φlog
N .
Moreover, there is an open p-adic formal substack C ord ⊆ C of “ordinary points” of
ord
the curve. The open formal substack C ord ⊆ C is dense in every ﬁber of C over N g,r . Also,
there is a unique canonical Frobenius lifting
log ord
) → (C log )ord
Φlog
C : (C

which is Φlog
N -linear and compatible with the Hodge section of the canonical indigenous
log
bundle (P, ∇P ). Finally, Φlog
C and ΦN have various functoriality properties, such as functoriality with respect to “log admissible coverings of C log ” and with respect to restriction to
the boundary of Mg,r .
This Theorem is an amalgamation of Theorem 2.8 of Chapter III and Theorem 2.6 of
Chapter V. In some sense all other results in this paper are formal consequences of the
above Theorem. For instance,
Corollary 0.2. The Frobenius lifting Φlog
N allows one to deﬁne canonical aﬃne local
coordinates on Mg,r at an ordinary point α valued in k, a perfect ﬁeld of characteristic
p. These coordinates are well-deﬁned as soon as one chooses a quasiconformal equivalence
class to which α belongs. Also, at a point α ∈ Mg,r (k) corresponding to a totally degenerate
curve, Φlog
N deﬁnes canonical multiplicative local coordinates.
This Corollary follows from Chapter III, Theorem 3.8 and Deﬁnition 3.13.
ord

Let α ∈ N g,r (A), where A = W (k), the ring of Witt vectors with coeﬃcients in a
ord

perfect ﬁeld of characteristic p. If α corresponds to a morphism Spec(A) → N g,r which
is Frobenius equivariant (with respect to the natural Frobenius on A and the Frobenius
ord
lifting Φlog
N on N g,r ), then we call the curve corresponding to α canonical. Let K be the
quotient ﬁeld of A. Let GL±
2 (−) be the group scheme which is the quotient of GL2 (−) by
{±1}.
ord

Theorem 0.3. Once one ﬁxes a k-valued point α0 of N g,r , there is a unique canonical
ord

α ∈ N g,r (A) that lifts α0 . Moreover, if a curve X log → Spec(A) is canonical, it admits
(1) A canonical dual crystalline (in the sense of [Falt], §2) Galois representation ρ : π1 (XK ) → GL±
2 (Zp ) (which satisﬁes certain properties);
6

(2) A canonical log p-divisible group Glog (up to {±1}) on X log whose Tate
module deﬁnes the representation ρ;
log ord
(3) A canonical Frobenius lifting Φlog
)
→ (X log )ord over the
X : (X
ordinary locus (which satisﬁes certain properties).

Moreover, if a lifting X log → Spec(A) of α0 has any one of these objects (1) through (3)
(satisfying various properties), then it is canonical.
This Theorem results from Chapter III, Theorem 3.2, Corollary 3.4; Chapter IV, Theorem
1.1, Theorem 1.6, Deﬁnition 2.2, Proposition 2.3, Theorem 4.17.
The case of curves with ordinary reduction modulo p which are not canonical is more
ord
complicated. Let us consider the universal case. Thus, let S log = (N g,r )log ; let f log :
X log → S log be the universal r-pointed stable curve of genus g. Let T log → S log be
the ﬁnite covering (log étale in characteristic zero) which is the Frobenius lifting Φlog
N of
log
log
log
Theorem 0.1. Let P
→ S
be the inverse limit of the coverings of S
which are
log
log
log
log
log
log
iterates of the Frobenius lifting Φlog
.
Let
X
=
X
×
T
;
X
=
X
×
.
log
S
S log P
N
T
P
We would like to consider the arithmetic fundamental groups
def

def

Π1 = π1 ((XTlog )Qp );

Π∞ = π1 ((XPlog )Qp )

Unlike the case of canonical curves, we do not get a canonical Galois representation of Π1
into GL±
2 (Zp ). Instead, we have the following
Theorem 0.4. There is a canonical Galois representation
ρ∞ : Π∞ → GL±
2 (Zp )
Moreover, the obstruction to extending ρ∞ to Π1 is nontrivial and is measured precisely by
the extent to which the canonical aﬃne coordinates (of Corollary 0.2) are nonzero. Also,
log
there is a ring DSGal with a continuous action of π1 (TQ
) such that we have a canonical
p
dual crystalline representation
Gal
ρ1 : Π1 → GL±
2 (DS )

(i.e., this is a twisted homomorphism, with respect to the action of Π1 (acting through
log
)) on DSGal ). Finally, the ring DSGal has an augmentation DSGal → Zp which is
π1 (TQ
p
Π∞ -equivariant (for the trivial action on Zp ) and which is such that after restricting to
Π∞ , and base changing by means of this augmentation, ρ1 reduces to ρ∞ .
7

This follows from Chapter V, Theorems 1.4 and 1.7.
All along, we note that when one specializes the theory to the case of elliptic curves,
one recovers the familiar classical theory of Serre-Tate. For instance, the deﬁnitions of
“ordinary curves” and “canonical liftings” specialize to the objects with the same names
in Serre-Tate theory. The p-adic canonical coordinates on the moduli stack Mg,r (Corollary
0.2) specialize to the Serre-Tate parameter. The Galois obstruction to extending ρ∞ to
a representation of Π1 specializes to the obstruction to splitting the well-known exact
sequence of Galois modules that the p-adic Tate module of an ordinary elliptic curve ﬁts
into.
For more detailed accounts of the results in each Chapter, we refer to the introductory
sections at the beginnings of each of the Chapters. In the rest of this introductory Chapter,
we explain the relationship between the p-adic case and the classically known complex case.
Acknowledgements: I would like to thank Prof. Barry Mazur of Harvard University for
providing the stimulating environment (during the Spring of 1994) in which this paper
was written. Also, I would like to thank both Prof. Mazur and Prof. Yasutaka Ihara
(of RIMS, Kyoto University) for their eﬀorts in assisting me to publish this paper, and
for permitting me to hold lecture series at Harvard (Spring of 1994) and RIMS (Fall of
1994), respectively, during which I discussed the contents of this paper. Finally, I would
like to thank Prof. Ihara for informing me of the theory of [Ih], [Ih2], [Ih3], and [Ih4].
This theory anticipates many aspects of the theory of the present paper (especially, the
discussion of Frobenius liftings and pseudo-correspondences in Chapters III and IV). On
the other hand, the techniques and point of view of Prof. Ihara’s theory diﬀer substantially
from those of the present paper. Moreover, from a rigorous, mathematical point of view,
the main results of Prof. Ihara’s theory neither imply nor are implied by the main results
of the present paper. However, it is the author’s subjective opinion that philosophically,
the motivation behind Prof. Ihara’s theory was much the same as that of the author’s.
§1. Review of the Complex Theory
In order to explain the meaning of the main results of this paper, it is ﬁrst necessary
to review the complex theory of uniformization in a fashion that makes the generalization
to ﬁnite primes more natural. This is the goal of the present Section. Since all of the
material is “standard” and “well-known,” we shall, of course, omit proofs, instead citing
references for major results. We shall say that a Riemann surface X is of ﬁnite type
if it can be obtained by removing a ﬁnite number of points p1 , . . . , pr from a compact
Riemann surface Y of genus g. Note that in this case, Y and {p1 , . . . , pr } are uniquely
determined up to isomorphism. We shall say that the Riemann surface of ﬁnite type X is
hyperbolic (respectively, parabolic; elliptic) if 2g − 2 + r ≥ 1 (respectively, 2g − 2 + r = 0;
2g − 2 + r < 0). In this paper, we shall be concerned exclusively with Riemann surfaces
of ﬁnite type (and their uniformizations). This is because it is precisely these Riemann
surfaces which correspond to algebraic objects. Also, we shall mainly be concerned with
8

the hyperbolic case, since this is the most diﬃcult. Indeed, from the point of view of
the theory of uniformization and moduli, the elliptic case is completely trivial, and the
parabolic case (although nontrivial) is relatively easy and explicit.
In some sense, the theme of our review of the classical complex theory is that in most
cases, there are two ways to approach results: the “classical” and the “quasiconformal.”
Typically, the classical approach was known earlier, and is more geometric and intuitive.
On the other hand, the classical approach has the drawback of producing theories and
results that are only real analytic, rather than holomorphic in nature. By contrast the
quasiconformal approach, which was pioneered by Ahlfors and Bers, tends to give rise to
holomorphic structures and results naturally. It is thus natural that the connection between
the “quasiconformal approach” and the p-adic theory should be much more natural and
transparent.
Beltrami Diﬀerentials
Let X be a Riemann surface (not necessarily of ﬁnite type). Let us consider the
complex line bundle τX ⊗ ω X on X, where ω X is the complex conjugate bundle to the
canonical bundle ωX , and τX is the tangent bundle. Note that if s is a section of τX ⊗ ω X
over X, then we can consider its L∞ -norm s∞ , since the transition functions of τX ⊗ ω X
have complex absolute value 1. A Beltrami diﬀerential μ on X is a measurable section of
the line bundle
τX ⊗ ω X
such that μ∞ < 1.
Why the bundle τX ⊗ ω X ? The reason is that this bundle is closely connected with
the moduli of the Riemann surface X. Indeed, Let us consider an arbitrary C ∞ section μ
of τX ⊗ ω X . Now since τX has the structure of a holomorphic line bundle, we have a ∂
operator on τX . If we look at global C ∞ sections, this gives us a complex
∂

C ∞ (X, τX ) −→

C ∞ (X, τX ⊗ ω X )

which computes the analytic cohomology of τX . If X is, for instance, compact, then this
analytic cohomology coincides with the cohomology in the Zariski topology of the algebraic
tangent bundle. Thus, for X compact and hyperbolic, the above complex has cohomology
groups H 0 = 0, and H 1 = H 1 (X, τX ), which is well-known to be the space of inﬁnitesimal
deformations of X. Moreover, if X is compact of genus g ≥ 2, and Mg is the moduli stack
of curves of genus g, then H 1 (X, τX ) is precisely the tangent space to Mg at the point
deﬁned by X.
At any rate, (for X arbitrary) we have a natural surjection
9

C ∞ (X, τX ⊗ ω X ) → H 1 (X, τX )
Thus, the image of μ under this surjection deﬁnes an inﬁnitesimal deformation of the
complex structure of X. This establishes the relationship between sections of
τX ⊗ ω X
and the moduli of X. The reason for considering measurable, rather than just C ∞ , sections is that it is easier to obtain solutions to a certain diﬀerential equation, the Beltrami
equation, when one works in this greater generality.
The Beltrami Equation
Having established the relationship between sections of τX ⊗ ω X and inﬁnitesimal
deformations, we now would like to integrate – i.e., to “give a reciprocity law” – that
assigns to a section μ of τX ⊗ ω X not just an inﬁnitesimal deformation of X, but an actual
new Riemann surface, i.e., a new complex structure on the topological manifold underlying
X. To do this, we consider the Beltrami equation
∂f = μ · ∂f
which we regard as a diﬀerential equation in the unknown function f . It is a nontrivial
result (proven, for instance, in [Lehto2]) that when μ is a Beltrami diﬀerential, there
exist local L2 solutions f to the Beltrami equation that are homeomorphisms (where they
are deﬁned). Such functions f are called quasiconformal (with dilatation μ). If f and
g (deﬁned on some open set U ⊆ X) are both quasiconformal with the same dilatation
μ, then it is easy to see that ∂ applied to f ◦ g −1 (in the distributional sense) is zero.
That is, f = h ◦ g for some biholomorphic function h. Thus, up to composition with a
biholomorphic function, quasiconformal solutions to the Beltrami equation are unique.
With these observations, we can deﬁne a new complex structure on X associated to
a Beltrami diﬀerential μ as follows. Let us call the resulting Riemann surface Xμ . Thus,
the underlying topological manifold of Xμ is the same as that of X. On an open set
U ⊆ X, we take a local quasiconformal function f of dilatation μ, and deﬁne it to be
a holomorphic function on Xμ . By the essential uniqueness of solutions to the Beltrami
equation, everything is well-deﬁned, and so we obtain a new global Riemann surface Xμ .
Thus, the assignment
μ → Xμ
is the fundamental “reciprocity law” that we are looking for.

10

The Series Expansion of a Quasiconformal Function
In order to really understand the Beltrami equation, it is useful to look at the explicit
representation of its solutions as series “in μ” (as in [Lehto], pp. 25-27). We begin by
considering Cauchy’s integral formula:
1
f (z) =
2πi



1
f (ζ) dζ
−
ζ −z
π
∂D

 

∂f (ζ) dξdη
ζ −z
D

for a function f with L1 derivatives on an open disk D in the complex plane. Thus, if f
(and its L1 derivatives) are deﬁned on all of C, and f (z) → 0 as z → ∞, then we obtain
f (z) = T ∂f
where T is the operator on C ∞ functions ω with compact support given by
1
(T ω)(z) = −
π

 

ω(ζ) dξdη
ζ −z
C

Put another way, (from the point of view of the theory of pseudodiﬀerential operators) T
is the parametrix for the elliptic diﬀerential operator ∂. If we deﬁne the Hilbert transformation H by
 

ω(ζ) dξdη
(ζ − z)2
C

1
(H ω)(z) = −
π

then we obtain that ∂T = H. Also, it can be shown that ∂ and ∂ commute with both T
and H.
Now let us suppose that μ is a Beltrami diﬀerential on C (say, with compact support),
and that f is quasiconformal on C with dilatation μ. Then f is holomorphic at inﬁnity,
and so, after normalization, in a neighborhood of inﬁnity, it looks like
f (z) = z +



bn z −n

n≥1

for some bn ∈ C. Thus, f (z) − z goes to 0 as z → ∞, so we obtain that
∂f (z) = 1 + ∂{f (z) − z}
= 1 + ∂T ∂{f (z) − z}
= 1 + H∂f (z)
11

Thus, since ∂f = μ · ∂f , it follows that
∂f = μ + μ · H∂f
This integral equation has the formal solution
∂f =



(μ · H)i μ

i≥0

which converges in L2 because
(1) it can be shown that H extends to an isometry L2 → L2 ;
(2) since μ is a Beltrami diﬀerential, μ∞ < 1 (which thus explains this
part of the deﬁnition of a Beltrami diﬀerential).
Thus, applying the operator T , we get the series solution
f (z) = z + T {



(μ · H)i μ}

i≥0

to the Beltrami equation.
From our point of view, this series solution has two important consequences. First of
all, the set of all possible μ clearly form an open subset of a (rather large) complex vector
space (i.e., the space of measurable sections of τX ⊗ ω X ). Thus, relative to the complex
structure of this complex vector space, the series solution makes it clear that f depends
holomorphically on μ. Second, it computes the inﬁnitesimal change in f as μ varies to ﬁrst
def
order. Namely, this term is given by φ = T (μ). Note that
∂φ = μ
It turns out that this result – that ∂ applied to the inﬁnitesimal change φ in the solution to
the Beltrami equation gives us back μ – holds for arbitrary Beltrami diﬀerentials μ. (See,
e.g., [Gard], p. 72).
The reason why this observation is interesting is as follows. Suppose, for simplicity,
that μ is C ∞ . Let U be an open covering of X such that the intersection of any ﬁnite
collection of open sets in U is Stein. Then by considering the standard isomorphism
between the Čech cohomology (with respect to U ) and the ∂-cohomology of τX , it thus
follows that the inﬁnitesimal deformation X·μ (where is “small”) in the complex structure
of X given by solving the Beltrami equation is precisely the same as the inﬁnitesimal
deformation given by mapping μ to H 1 (X, τX ) via the surjection
12

C ∞ (X, τX ⊗ ω X ) → H 1 (X, τX )
considered previously. This completes the justiﬁcation of the claim that the assignment
μ → Xμ is an “integrated version” of the “inﬁnitesimal reciprocity law”
C ∞ (X, τX ⊗ ω X ) → H 1 (X, τX )
that follows just from the deﬁnition of the ∂-cohomology of τX .
Uniformization of Hyperbolic Riemann Surfaces
 be its universal covering space. Thus,
Let X be a hyperbolic Riemann surface. Let X

X inherits a natural complex structure from X. Then one of the most basic results in the
ﬁeld is that we have an isomorphism of Riemann surfaces
∼
X
=H
where H is the upper half plane. By considering the covering transformations of H → X,
we get a homomorphism (well-deﬁned up to conjugation)
ρ : π1 (X) → Aut(H) ⊆ PSL2 (R)
which we call the canonical representation of X.
There are (at least) two ways to prove this result. The ﬁrst approach is the classical
approach, and goes back to Koebe’s work in the early twentieth century. It involves
 There is an intrinsic, a priori deﬁnition of
considering Green’s functions G(−, −) on X.
Green’s functions, which is not important for us here. A posteriori, that is, once one knows
∼
that X
= H, we can pull-back the hyperbolic metric
dx2 + dy 2
y2
 so that we obtain a hyperbolic distance function on X.
 Then G(x, y) (for
on H to X,
 is given by the logarithm of the hyperbolic distance between x and y. One can
x, y ∈ X)
ﬁnd a detailed exposition of this approach in [FK].
The second approach (which is more relevant to the p-adic case) is the approach of
Bers ([Bers]). Suppose that X is obtained by removing r points from a compact Riemann
surface Y of genus g. Then one ﬁrst observes that there exists a Riemann surface X 
which is obtained by removing r points from a compact Riemann surface of genus g and
  is isomorphic to H. Then one constructs (from purely
whose universal covering space X
13

elementary considerations) a quasiconformal homeomorphism X  ∼
= X. This quasiconformal homeomorphism deﬁnes a Beltrami diﬀerential μ on X  , which we can pull back to
 ∼
X
= H to obtain a Beltrami diﬀerential μH on H. By reﬂection, one extends μH to a
Beltrami diﬀerential μ
 on C. Then we solve the Beltrami equation for μ
 on C so that we
obtain a quasiconformal homeomorphism
f
:C→C
μ
which goes to inﬁnity at inﬁnity. Let Γ be the group of Möbius transformation of H
  over X  . Thus, H/Γ ∼
deﬁned by the covering transformations of X
= X  . Then it follows
from the uniqueness of solutions to the Beltrami equation that
Γ = f
◦ Γ ◦ f −1
μ

μ
def

forms a group of Möbius transformations on C. Moreover, from the reﬂection symmetry
of μ
, it follows that f
preserves the real axis, and hence so does Γ. It thus follows that
μ
H/Γ is a Riemann surface of ﬁnite type, and, by the deﬁnition of μ, that H/Γ ∼
= X. This
completes the proof.
It turns out that it is this approach of uniformizing a single Riemann surface (for each
g, r) and then “parallel transporting” the result over the rest of the moduli space that will
carry over to the p-adic case.
Uniformization of Moduli Stacks of Hyperbolic Riemann Surfaces
Let Mg,r be the moduli stack of r-pointed smooth algebraic curves of genus g over C.

Let Mg,r be its universal covering space. Then the problem of uniformization of moduli is
g,r . From the point of view of the Beltrami equation,
to give an explicit representation of M
this amounts to ﬁnding a small, ﬁnite-dimensional subspace T of the space of Beltrami
diﬀerentials μ such that the assignment μ → Xμ deﬁnes a covering space map T → Mg,r .
We begin by ﬁxing a “base point” of Mg,r , which corresponds to a hyperbolic Riemann
surface X. Let M(X) be the space of Beltrami diﬀerentials on X. Let Q be the space
of holomorphic quadratic diﬀerentials on X with at most simple poles at the punctured
points. Then there are two approaches to deﬁning morphisms from open subsets of Q
into spaces of Beltrami diﬀerentials. The ﬁrst approach is that of Teichmüller. In this
approach, if φ ∈ Q, we deﬁne a norm
def



φ =

|φ|
X

Let V ⊆ Q be the set of φ with φ ≤ 1. Then Teichmüller’s uniformization map, for
(nonzero) φ ∈ V , is given by
14

def

φ → μφ = (φ)

φ
|φ|

where φ ∈ Γ(X, ω ⊗2
X ) is the complex conjugate of φ. It is easy to see that μφ deﬁnes a
Beltrami diﬀerential on X. Thus, we get a morphism V → M(X). If we compose φ → μφ
with μ → Xμ , we get a morphism
V → Mg,r
The main result of Teichmüller theory (see, e.g., [Gard], Chapter 6) is that this morphism
g,r . One advantage of this approach is that it admits
induces an isomorphism of V onto M
a very satisfying geometric interpretation in terms of a foliation on X induced by φ and
deforming X into Xμφ by deforming a canonical coordinate arising from the foliation. The
main disadvantage of this approach from our point of view, however, is that the morphism
φ → μφ is neither holomorphic nor anti-holomorphic. Thus, it seems hopeless to try to
ﬁnd an algebraic version of Teichmüller’s map.
On the other hand, Bers’ approach is as follows. Since we now know that X can
be uniformized by the upper half plane, let vX be the hyperbolic volume element on X
induced by the hyperbolic volume element
vH =

dx ∧ dy
y2

on the upper half plane. Let X c be the conjugate Riemann surface to X. That is, the
underlying topological manifold of X c is the same as that of X, but the holomorphic
functions on X c are exactly the anti-holomorphic functions on X. Suppose that φ ∈ Q.
Then by conjugating the “input variable,” we obtain that φ deﬁnes a section φc of ω ⊗2
Xc .
Now deﬁne
def −2φ

μφ =

c

vX c

Then for some appropriate (see [Gard], pp. 100-104) open set V ⊆ Q, this μφ deﬁnes
a Beltrami diﬀerential on X c . Integrating, we get a Riemann surface Xμc . Then the
assignment φ → Xμc deﬁnes a morphism
V → Mcg,r
where the superscript “c” denotes the conjugate complex manifold. This morphism induces
cg,r ([Gard], p. 101). The important thing here is that the
an isomorphism of V onto M
correspondence φ → μφ is holomorphic. Since μ → Xμc is always holomorphic, it thus
15

c is biholomorphic. Put another way, we have a
follows that the isomorphism V ∼
= M
g,r
holomorphic embedding
g,r → Qc
B:M
which is called the Bers embedding. This embedding will be central to our entire treatment
of the complex theory, and its p-adic analogue will be central to our treatment of the p-adic
theory.
Quasidisks and the Bers Embedding
One can also deﬁne the Bers embedding in terms of Bers’ simultaneous uniformization
and Schwarzian derivatives. For details, see [Gard], pp. 100-101. To do this, we ﬁx an
 with H. Let H c be the lower half plane. Thus, if H uniformizes X,
isomorphism of X
c
then H naturally uniformizes X c . Let Γ be the group of Möbius transformiations of C
 → X. Then we may think of the space
which are the covering transformations for H = X
M(X c ) of Beltrami diﬀerentials on X c as the space of Beltrami diﬀerentials on H c which
are invariant under Γ. Let μ ∈ M(X c ). Let f μ : C → C be the unique quasiconformal
homeomorphism which ﬁxes 0 and 1, goes to inﬁnity at inﬁnity, has Beltrami coeﬃcient μ
on H c and is conformal on H. Let Γμ = f μ ◦Γ◦(f μ )−1 . Then it follows from the uniqueness
of solutions to the Beltrami equation that Γμ forms a group of Möbius transformations of
C. Moreover, we have conformal isomorphisms
f μ (H c )/Γμ ∼
= Xμc ;

f μ (H)/Γμ ∼
=X

It follows that if we take the Schwarzian derivative of the conformal “quasidisk” embedding
f μ |H : H → C
we get a Γ-invariant quadratic diﬀerential on H, hence a quadratic diﬀerential φ (with at
most simple poles at the punctures) on X. The content of the Lemma of Ahlfors-Weill
([Gard], p. 100) is that the assignment:
Xμc → φ
c → Q. On the one hand, this description of the Bers embedding is
is equal to B c : M
g,r
geometrically more satisfying than the deﬁnition given in the previous subsection, but it
has the disadvantage that it obscures the relationship between the hyperbolic and parabolic
cases. So far we have been mainly discussing the hyperbolic case, but we shall discuss the
parabolic case later.
16

The Inﬁnitesimal Form of the Modular Uniformizations
Often it is useful to express these modular uniformizations in their inﬁnitesimal form,
as metrics. On the one hand, the global uniformizations can always be essentially recovered
by integrating the metrics, and on the other hand, metrics, being local in nature, can often
be studied more easily.
In the Teichmüller case, if K is deﬁned by
φ =

K −1
K +1

g,r , given by
then one obtains a distance function on M
d(X, Xμφ ) =

1
log(K)
2

which turns out to be equal to the general hyperbolic distance introduced by Kobayashi
for an arbitrary hyperbolic complex manifold (see [Gard], Chapter 7, for an exposition).
The inﬁnitesimal form of this distance is given by the norm φ = X |φ| on quadratic
diﬀerentials (see [Royd]).
We shall be more interested in the case of the Bers embedding
g,r → Qc
B:M
By using the hyperbolic volume form vX on X, we obtain the Weil-Petersson inner product:
def



φ, ψ =

X

φ·ψ
vX

for φ, ψ ∈ Q. It is a result of Weil and Ahlfors that the resulting metric, called the WeilPetersson metric on Mg,r , is Kähler. Moreover, if we diﬀerentiate B, we get, at X, a map
on tangent spaces
dB : Q∨ → Qc
whose inverse is exactly the morphism Qc → Q∨ deﬁned by the Weil-Petersson inner product. Finally, the coordinates obtained from the Bers embedding are canonical coordinates
for the Weil-Petersson metric ([Royd]). (We shall review the general theory of canonical
coordinates associated to a real analytic Kähler metric in §2.)
It turns out that it is precisely the p-adic analogue of the Weil-Petersson metric that
will play a central role in this paper.
17

Coordinates of Degeneration
While the Bers coordinates are useful for understanding what happens in the interior
of Mg,r , they are not so useful for understanding what happens as one goes out to the
boundary, that is, as the Riemann surface degenerates to a Riemann surface with nodes.
To study this sort of degeneration, one ﬁxes a decomposition of the Riemann surface into
“pants,” which are topologically equivalent to an open disk with two smaller disks in the
interior removed. For a detailed description of the theory of pants and the coordinates they
deﬁne, we refer to [Abikoﬀ], Chapter 2. In summary, what happens is the following. Let
X be a hyperbolic Riemann surface (of genus g with r punctures), with a decomposition
into pants. We shall call the curves on X which occur in the boundary of the pants
partition curves. There are exactly 3g − 3 + r partition curves, α1 , . . . , α3g−3+r . We
assume that this decomposition is “maximal” in the sense that each partition curve is
a simple closed geodesic (in the hyperbolic metric on X). Then it turns out that the
isomorphism class of X as a Riemann surface is completely determined by 3g − 3 + r
complex numbers ζi = li eiθ (i = 1, . . . , 3g − 3 + r), one for each partition curve. Basically
li describes the circumference of the partition curve αi , while θi describes the angle of
twisting involved in gluing together the boundary curves of two neighboring pants to form
αi . These coordinates ζi are called the Fenchel-Nielsen coordinates of X. The degeneration
corresponding to pinching αi to a node is given by li → 0. This degeneration respects the
hyperbolic metrics involved: that is, if a family of smooth Xt degenerates to a nodal
Riemann surface Z, then the hyperbolic metrics on the Xt degenerate to the hyperbolic
metric on Z (given by taking the hyperbolic metric on the smooth subsurface of Z which
is the complement of the nodes). Thus, the Fenchel-Nielsen coordinates have the virtue
of admitting a very satisfying diﬀerential-geometric description (as just summarized), but
the disadvantage of not being holomorphic.
On the other hand, one can deﬁne holomorphic coordinates (as in [Wolp]), as follows.
Recall the quasidisk description of the Bers embedding. Thus, we had a μ ∈ M(X c ),
and a quasiconformal homeomorphism f μ : C → C, together with a new group of Möbius
transformations Γμ . Then each αi deﬁnes (by integration) an element Ai ∈ Γμ . Up to
conjugation, Ai is of the form z → mi · z for some mi ∈ C with |mi | > 1. This complex
number mi is uniquely deﬁned. Then the coordinates
Xμc → (m1 , . . . , m3g−3+r )
are holomorphic in μ. In [Wolp], the relationship between these coordinates and the Bers
coordinates is studied. In these coordinates, the degeneration of Xμc corresponding to the
case where the partition curve αi is pinched to a node is given by mi → 1. It turns
out that these coordinates are probably the best complex analogue to the “multiplicative
parameters at inﬁnity” that we construct in the p-adic case.

18

The Parabolic Case
So far we have mainly been discussing the case of hyperbolic Riemann surfaces, since
this case is by far the most interesting. However, often it is very diﬃcult to make explicit
computations for hyperbolic Riemann surfaces. Thus, in order to get one’s bearings, it
is sometimes useful to consider the analogous constructions in the parabolic case, where
explicit computations are much easier to carry out. Let X be a parabolic Riemann surface.
Then X is either compact of genus 1, or it is isomorphic to the projective line minus two
points. We shall mainly be interested in the compact case, where there are nontrivial
moduli.
Thus, let X be compact of genus 1. Then one can carry out Teichmüller theory in
this case (as in [Lehto], Chapter V, §6). One can also deﬁne a parabolic analogue of the
Bers embedding, as follows. Namely, we simply copy the formula
def −2φ

μφ =

c

vX c

of the hyperbolic case, except that we take vX c to be the
 parabolic volume element (as
opposed to the hyperbolic volume element) on X c , with X c vX c = 1. Then one sees (as
in [Lehto], p. 220) that one obtains a holomorphic embedding
1,0 → Qc
B1,0 : M
whose image is an open disk D ⊆ Qc of some radius. One can also deﬁne a Weil-Petersson
metric on M1,0 by simply replacing the hyperbolic volume element used before by the
parabolic volume element. A simple calculation then reveals that one obtains the standard
hyperbolic metric on the open disk D. In particular, (just as in the hyperbolic case), the
standard coordinate on D is normal at 0 for the Weil-Petersson metric.
One thing that is interesting about this parabolic case is that even though the complex
analytic stacks M1,0 and M1,1 are isomorphic, the “Bers theory” diﬀers substantially in
1,1 is far from being an open disk.
the two cases. For instance, the Bers embedding of M
In fact, (as the author was told by C. McMullen) the boundary of this hyperbolic Bers
embedding has lots of cusps. A computer-generated illustration of this boundary appears in
[McM]. Also, it is not diﬃcult to show that the Weil-Petersson metrics are quite diﬀerent.
This contrasts considerably with the “Teichmüller theory” of M1,0 and M1,1 : Indeed,
since Teichmüller’s metric always coincides with Kobayashi’s intrinsic hyperbolic metric,
it follows that the Teichmüller metrics of M1,0 and M1,1 coincide.
Real Curves
A Riemann surface X of ﬁnite type is called real if X ∼
= X c . In other words, this means
that the C-valued point deﬁned by X in the algebraic stack (Mg,r )R (over Spec(R)) is,
19

in fact, deﬁned over R (up to perhaps reordering the marked points). Various interesting
properties of real Riemann surfaces (related to uniformization theory) are studied in [Falt2].
Many of these properties are obtained by looking at various one-dimensional real analytic
submanifolds of a real X.
From our point of view, however, the notable fact about real hyperbolic Riemann
surfaces X is the following. Let φ : X ∼
= X c be a holomorphic isomorphism. For simplicity,
suppose that there exists a point x ∈ X such that φ(x) = xc , and that φc ◦ φ = idX . Fix
 ∼
c ∼
an isomorphism X
= H c . On the other hand, φ
= H. This induces an isomorphism X
c

induces a holomorphic isomorphism φ : H → H . Let C : H c → H be the conjugation
 Thus, ψ is an anti-holomorphic automorphism of H. Now let
map. Let ψ = C ◦ φ.
ΠC = π1 (X, x). Since X c has the same underlying topological space as X, we have
ΠC = π1 (X c , xc ). Thus, φ induces an automorphism φΠ of ΠC of degree 2. Let ΠR be the
extension
1 → ΠC → ΠR → Gal(C/R) → 1
which is the crossed product of ΠC with Gal(C/R) given by letting the nontrivial element
of Gal(C/R) act on ΠC by means of φΠ . Now let us consider the Lie group
def

G(R) = {M ∈ GL2 (R)| det(M ) = ±1}/{±1}
Thus, PSL2 (R) ⊆ G(R) ⊆ GL±
2 (R), so we can write
ρC : ΠC → GL±
2 (R)
for the canonical representation of X (uniformized by the upper half 
plane H).
 Note that
a b
the full group GL±
∈ GL±
2 (R) acts on the upper half plane as follows: if A =
2 (R),
c d
we let
A(z) =

aw + b
cw + d

where w = z (respectively, w = z) if det(A) is positive (respectively, negative). Thus,
the map deﬁned by A is a holomorphic (respectively, anti-holomorphic) automorphism
of H if det(A) is positive (respectively, negative). In particular, the anti-holomorphic
automorphism ψ : H → H deﬁnes an element (which by abuse of notation we call) ψ ∈
G(R). Now note that if γ ∈ ΠC , then ψ · ρ(γ) · ψ −1 = ρ(φΠ (γ)). Thus, by mapping the
nontrivial element of Gal(C/R) in the crossed product deﬁnition of ΠR to ψ, we see that
we obtain a natural homomorphism
ρR : ΠR → GL±
2 (R)
20

which extends ρC and is such that the composite with the determinant det : GL±
2 (R) →
R× is trivial on ΠC and equal to the sign representation on Gal(C/R). It is this representation ρR that will be relevant to our discussion of the p-adic case.
§2. Translation into the p-adic Case
In this Section, we discuss the dictionary for translating the complex analytic theory
of §1 into the p-adic results discussed in §0. Undoubtedly, the most fundamental tool,
which is, in fact, of an algebraic, not an arithmetic nature, is the systematic use of the
indigenous bundles of [Gunning]. This enables one to get rid of the upper half plane, and
thus to bring uniformization theory into a somewhat more algebraic setting. In any sort
of nontrivial arithmetic theory of this nature, however, algebraic manipulations alone can
never be enough. Thus, the fundamental arithmetic observation is the following:
Kähler metrics in the complex case correspond to Frobenius actions in
the p-adic case.
Since one typically gets a natural Frobenius action for free modulo p, a Frobenius action
typically means a canonical lifting of the natural Frobenius action modulo p. In fact,
in some sense, if one sorts through the complex analytic theory reviewed §1, one can
essentially distill everything down to two objects, both of which happen to be Kähler
metrics:
(1) the hyperbolic metric on a hyperbolic Riemann surface (which encodes
the upper half plane uniformization); and
(2) the Weil-Petersson metric on the moduli space (which encodes the Bers
uniformization).
Moreover, these two metrics are related to each other in the sense that the latter is essentially the push-forward of the former. In a similar way, the p-adic theory revolves around
two fundamental Frobenius liftings:
(1) the canonical Frobenius lifting on a canonical hyperbolic curve; and
(2) the canonical Frobenius lifting on a certain stack which is étale over
the moduli stack.
The goal of this Section is to explain this analogy in greater detail.

21

Gunning’s Theory of Indigenous Bundles
Let X be a compact hyperbolic Riemann surface. Let H → X be its uniformization
by the upper half plane. Then by considering the covering transformations of H → X, we
get a homomorphism (unique up to conjugation)
ρ : π1 (X) → Aut(H) ⊆ PSL2 (R)
which we call the canonical representation of X. If we regard ρ as deﬁning a morphism
into PSL2 (C), then we obtain (in the usual fashion), a local system of P1 -bundles on X,
which thus gives us a holomorphic P1 -bundle with connection (P, ∇P ) on X. By Serre’s
GAGA, (P, ∇P ) is necessarily algebraic. It turns out that P is always isomorphic to a
certain P1 -bundle of jets (which is also entirely algebraic). Thus, the upper half plane
uniformization may be thought of as just being a special choice of connection ∇P . A pair
“like” (P, ∇P ) (satisfying certain technical properties discussed in Chapter I, §2) is called
an indigenous bundle. By working with log structures, one can also deﬁne indigenous
bundles in a natural way for smooth X with punctures, as well as for nodal X.
As emphasized earlier, the point of dealing with indigenous bundles is that they allow
one to translate the upper half plane uniformization into the purely algebraic information
of a connection on P . Of course, how one chooses this particular special connection on P
is very nontrivial arithmetic issue. We shall call the pair (P, ∇P ) consisting of P equipped
with this particular connection the canonical indigenous bundle on X. Universally, over
the moduli stack Mg,r (of stable r-pointed curves of genus g over C), the space of all
indigenous bundles forms a holomorphic torsor
S g,r → Mg,r
over the logarithmic cotangent bundle Ωlog
M

g,r /C

of Mg,r . In the holomorphic category,

we shall see (in Chapter I, §3) that this torsor is highly nontrivial. In the real analytic
category, however, the canonical indigenous bundle determines a trivializing section
sH : S g,r → Mg,r
of this torsor.
In fact, indigenous bundles also allow us to translate such diﬀerential-geometric information as the hyperbolic geometry of X into algebraic terms. For instance, consider
the degeneration of Riemann surfaces from the point of view of hyperbolic geometry. As
reviewed in §1, this may be thought of in terms of certain geodesic partition curves whose
lengths go to zero as a family of smooth Xt degenerates to a nodal Riemann surface Z.
From the complex theory, we know that the hyperbolic metric on Xt degenerates to the
hyperbolic metric on Z. Using indigenous bundles, we can translate this into a more algebraic statement as follows: We deﬁne the canonical indigenous bundle on Z to be the
22

indigenous bundle obtained by gluing together the canonical indigenous bundles of the
pointed Riemann surfaces occurring in the normalization of Z. Then the statement is that
as Xt degenerates to Z, the canonical indigenous bundle on Xt degenerates to the canonical indigenous bundle on Z. The statement that the lengths of the partition geodesics
go to zero then takes the form that the monodromy of the limit indigenous bundle of the
canonical indigenous bundles of the Xt ’s is nilpotent at the nodes.
The Canonical Coordinates Associated to a Kähler Metric
In this subsection we discuss how a Kähler metric on a complex manifold can be used to
deﬁne canonical aﬃne, holomorphic coordinates on the manifold locally in a neighborhood
of a given point. We believe that what is discussed here is well-known, but our point of
view is somewhat diﬀerent from that usually taken in the literature.
Let M be a smooth complex manifold of complex dimension m. The complex analytic
structure on M deﬁnes, in particular, a real analytic structure on M . Let μ be a real
analytic (1, 1)-form on M that deﬁnes a Kähler metric on M . In particular, μ is a closed
diﬀerential form. Let M c be the conjugate complex manifold to M : that is to say, we take
M c to be that complex manifold which has the same underlying real analytic manifold
structure as M , but whose holomorphic functions are the anti-holomorphic functions of
M . Let us ﬁx a point e ∈ M . Let N be the germ of a complex manifold obtained by
localizing the complex manifold M c × M at (e, e) ∈ M c × M (where this last expression
makes sense since M c has the same underlying set as M ). Let Ωhol (respectively, Ωant ) be
the holomorphic vector bundle on N obtained by pulling back the bundle ΩM (respectively,
ΩM c ) of holomorphic diﬀerentials on M (respectively, M c ) to M c × M via the projection
M c × M → M (respectively, M c × M → M c ), and then restricting to N . Thus, in
summary, we have a 2m-dimensional germ of a complex manifold N , together with two
m-dimensional holomorphic vector bundles (locally free sheaves) Ωhol and Ωant on N .
Note that locally at e ∈ M , the fact that μ is real analytic means that we can write
μ as a convergent power series in holomorphic and anti-holomorphic local coordinates at
e. In other words, if we restrict μ to N , we may regard μ|N as deﬁning a holomorphic
section of Ωhol ⊗ON Ωant (where ON is the sheaf of holomorphic functions on N ). Let dhol
(respectively, dant ) be the exterior derivative on N with respect to the variables coming
from M (respectively, M c ). Note that since Ωhol is constructed via pull-back from M , we
can apply dant to sections of Ωhol . We thus obtain a sort of de Rham complex with respect
to dant :

0 −→

Ωhol

dant

−→

Ωhol ⊗ON Ωant

dant

−→

Ωhol ⊗ON (∧2 Ωant )

dant

−→

...

Relative to this complex, the section μ|N of Ωhol ⊗ Ωant satisﬁes dant μ|N = 0 (since μ is a
closed form). It thus follows from the Poincaré Lemma that there exists a (holomorphic)
section α of Ωhol that vanishes at (e, e) ∈ N and satisﬁes dant α = μ|N . Let Me be the
germ of a complex manifold obtained by localizing M at e ∈ M . Let
23

ι : Mec → N
be the inclusion induced by the map M c → M c ×M that takes f ∈ M c to (f, e) ∈ M c ×M .
Then ι∗ (α) deﬁnes a holomorphic morphism β : Mec → ΩM,e , where ΩM,e is the aﬃne
complex analytic space deﬁned by the cotangent space of M at e. Note, moreover, that
although α (as chosen above) is not unique, β is nonetheless independent of the choice
of α. Moreover, β is an immersion: Indeed, to see this, it suﬃces to check that the map
induced by β on tangent spaces is an isomorphism, but this follows from the fact that
dant α = μ|N , and the fact that the Hermitian form deﬁned by μ is nondegenerate.
In summary, we see that from the Kähler metric μ, we obtain a canonical holomorphic
local aﬃne uniformization
β c : Me → ΩcM,e
Pulling back the standard aﬃne coordinates on ΩcM,e gives us a canonical collection of
holomorphic coordinates on Me .
Deﬁnition 2.1. We shall refer to these coordinates as the canonical holomorphic local
coordinates of the Kähler manifold (M, μ) at e. We shall refer to β c as the canonical local
aﬃne uniformization of the Kähler manifold (M, μ) at e.
Now let us consider some basic well-known examples:
Example 1. Let M = {z ∈ C| |z| < 1}, with the standard hyperbolic metric √2dz∧dz .
1−(z·z)

hol

Then z is a canonical coordinate at 0. Indeed, to see this it suﬃces to note that d (z·dz) =
dz ∧ dz, which is equal to the metric modulo the ideal generated by z in ON . Note that by
the Köbe uniformization theorem, this example essentially covers all hyperbolic Riemann
surfaces.
Example 2. Let M be the Teichmüller space of Riemann surfaces of genus g with r
punctures, where 2g − 2 + r ≥ 1. Then as stated earlier, it is known ([Royd]) that the
coordinates arising from the Bers embedding are canonical coordinates with respect to the
Weil-Petersson metric on M . In fact, in this case, by Theorem 2.3 (proven below) the real
analytic section sH deﬁned by the canonical indigenous bundle essentially already serves
as an “α” in the above discussion. Thus, in a very real sense, the section sH already is the
Bers embedding.

24

The Weil-Petersson Metric from the Point of View of Indigenous Bundles
Let X be a compact hyperbolic Riemann surface. Let (π : P → X, ∇P ) be the
canonical indigenous bundle on X. Let Ad(P ) = π∗ τP/X be the push-forward of the
relative tangent bundle of π. Thus, Ad(P ) is a rank 3 vector bundle on X, equipped
with a simple Lie algebra structure, hence with a nondegenerate Killing form < −, − >:
Ad(P ) ⊗OX Ad(P ) → OX . Moreover, ∇P induces a connection ∇Ad on Ad(P ). Moreover,
as an indigenous bundle, Ad(P ) comes equipped with a section σ : X → P (the “Hodge
section”) which deﬁnes a Hodge ﬁltration F · (Ad(P )) on Ad(P ). (See Chapter I for more
1
(Ad(P ), ∇Ad ) module
details.) At any rate, we can take the ﬁrst de Rham cohomology HDR
of (Ad(P ), ∇Ad ). The Hodge ﬁltration on Ad(P ) then deﬁnes a Hodge ﬁltration on the de
Rham cohomology, hence an exact sequence:
⊗2
1
0 → H 0 (X, ωX
) → HDR
(Ad(P ), ∇Ad ) → H 1 (X, τX ) → 0

On the other hand, recall the representation that we used to deﬁne (P, ∇P ):
ρ : π1 (X) → Aut(H) ⊆ PSL2 (R)
Let Ad(VR ) denote the π1 (X)-module obtained by letting π1 (X) act on the Lie algebra
def

sl2 (R) by applying ρ and then conjugating matrices. Let Ad(VC ) = Ad(VR ) ⊗R C. Then
(it is elementary that) we have a “comparison theorem” that gives a natural isomorphism
between the de Rham cohomology module just considered and the group cohomology of
Ad(VC ):
1
HDR
(Ad(P ), ∇Ad ) ∼
= H 1 (π1 (X), Ad(VC ))

On the other hand, we also have:
H 1 (π1 (X), Ad(VC )) ∼
= H 1 (π1 (X), Ad(VR )) ⊗R C
which, combined with the above comparison theorem, thus gives a real structure on
1
HDR
(Ad(P ), ∇Ad ). One way to express this real structure is as an R-linear conjugation
1
1
(Ad(P ), ∇Ad ) → HDR
(Ad(P ), ∇Ad ).
morphism (read: “Frobenius action”) cDR : HDR
Now let us consider the relationship between cDR and the Hodge ﬁltration. If we
⊗2
1
compose the natural inclusion H 0 (X, ωX
) → HDR
(Ad(P ), ∇Ad ) with cDR followed by the
1
1
natural projection HDR (Ad(P ), ∇Ad ) → H (X, τX ), we obtain a C-bilinear form
β : H 0 (X, ω ⊗2 ) ⊗C H 0 (X, ω ⊗2 )c → C
(where the superscript “c” stands for the complex conjugate C-vector space).
25

Proposition 2.2. The form β is precisely the Weil-Petersson metric on quadratic diﬀerentials deﬁned in §1 by means of integration. In particular, β is nondegenerate.
Proof. In order to obtain β, we implicitly used the special case of Serre duality given by
⊗2
). But in the complex analytic context, the pairing that deﬁnes
H 1 (X, τX ) ∼
= H 0 (X, ωX
this sort of duality is given by integrating the product of ((0, 1)− and (1, 0)−) forms. The
volume form vX appears for the sake of deﬁning the duality between ωX and ω X . With
these remarks, the claim of the Lemma becomes a tautology. 
Now let us recall the real analytic section sH : Mg,r → S g,r . Since S g,r → Mg,r is a
holomorphic torsor, we may form ∂sH , which gives a section of Ωlog
M

g,r /C

log

⊗ΩMg,r /C . On the

other hand, the Weil-Petersson metric also deﬁnes a section μWP of Ωlog
M

g,r

log

⊗ ΩMg,r /C .
/C

Now we have the following result (stated in [ZT], but from a somewhat diﬀerent point of
view):
Theorem 2.3. The form ∂sH is equal to μWP .
Proof. By introducing log structures, one can handle the general case; here, for simplicity,
we restrict our attention to the case of smooth compact Riemann surfaces. Let us consider
⊗2
1
) → HDR
(Ad(P ), ∇Ad ) with cDR followed
the composite of the natural inclusion H 0 (X, ωX
1
1
by the natural projection HDR (Ad(P ), ∇Ad ) → H (X, τX ); this composite gives a C-linear
morphism:
⊗2
) → H 1 (X, τX )c
H 0 (X, ωX

which is invertible by Lemma 2.2. Taking its inverse, and dualizing, we obtain an element
⊗2
⊗2 c
δ ∈ H 0 (X, ωX
) ⊗C H 0 (X, ωX
)

On the other hand, sorting through the deﬁnitions, it is a tautology in linear algebra that
the value of ∂sH at the point [X] ∈ Mg is given by δ. But, combining this with Lemma
2.2, we see that we have proven the Theorem. 
The important point here is that this Theorem shows that:
The Weil-Petersson metric, and hence the Bers embedding, is obtained
precisely by considering the extent to which “Frobenius” – i.e., complex
conjugation – is compatible with the canonical indigenous bundle section
sH .
26

Stated in this way, the classical complex theory becomes all the more formally analogous
to the p-adic theory to be discussed in this paper.
The Philosophy of Kähler Metrics as Frobenius Liftings
Before going into a detailed account of the correspondence between complex and padic results, we pause to explain some of the motivation for considering Kähler metrics as
Frobenius liftings. Let S be a smooth p-adic formal scheme over Zp . A Frobenius lifting on
S is a morphism Φ : S → S whose reduction modulo p is equal to the Frobenius morphism
in characteristic p. Then the main point of the analogy is that just as (real analytic) Kähler
metrics deﬁne canonical coordinates (as discussed above), Frobenius liftings Φ : S → S
(that satisfy a certain technical condition called ordinariness – see Chapter III, §1 for
details) also deﬁne canonical coordinates, as follows:
The most basic example of an ordinary Frobenius lifting is the case when S is the
p-adic completion of Zp [T, T −1 ] (where T is an indeterminate), and Φ−1 (T ) = T p . Then
the theory of ordinary Frobenius liftings (Chapter III, §1) states that by means of a certain
“integration” procedure, every ordinary Frobenius lifting on an arbitrary S becomes (after
completing at a point of S) isomorphic to a product of copies of this basic example. This
“integration procedure” is thus analogous to the integration procedure just reviewed which
allowed us to construct canonical coordinates associated to real analytic Kähler metrics.
The Dictionary
The fundamental “nuts and bolts” of the complex theory lies in the Beltrami equation. Suppose that we think of the Beltrami equation not as a diﬀerential equation whose
unknown is the quasiconformal function fμ , but instead as an equation whose unknown
is the conformal quasidisk embedding function f μ |H (in the discussion of quasidisks). A
quasidisk embedding of the universal covering space of a hyperbolic Riemann surface X
deﬁnes an indigenous bundle (P, ∇P )μ on X in a natural way. Thus, from this point of
view, we can think of the Beltrami equation as an equation whose unknown is (P, ∇P )μ .
Moreover, the Beltrami coeﬃcient μ deﬁnes the “shearing” or distortion factor between
z and z. Thus, in summary, we may regard the Beltrami equation as an equation in the
unknown (P, ∇P )μ in terms of the distortion factor (eﬀected by the quasidisk embedding
f μ |H ) between z and its “Frobenius conjugate” z.
On the other hand, the “nuts and bolts” of the p-adic theory lies in the study of the
Verschiebung on indigenous bundles, which occupies most of Chapter II. As a function
on the indigenous bundles of a hyperbolic curve in characteristic p, the Verschiebung –
which is essentially the determinant of the p-curvature – measures the distortion factor
between applying Frobenius to an inﬁnitesimal on the curve and applying Frobenius to an
inﬁnitesimal motion in the (“quasidisk”) uniformization deﬁned by the indigenous bundle.
Thus, for instance, when the p-curvature is nilpotent, there is no distortion factor, and so
the indigenous bundle provides the “right” uniformization for the curve. In this sense, we
27

feel that there is an analogy between the Beltrami equation in the complex theory and the
Verschiebung on indigenous bundles in the p-adic theory.
Relative to this analogy, the fundamental existence and uniqueness theorem for solutions to the Beltrami equation becomes the result (in Chapter II) that the Verschiebung on
indigenous bundles is ﬁnite and ﬂat. Since in the p-adic case, its degree is not one, we only
have uniqueness up to a ﬁnite number of possibilities. This is why we get several distinct
“quasiconformal equivalence classes” in the p-adic case. Moreover, the important integral
operator “T ” – i.e., the parametrix to ∂ – which gives the ﬁrst term in the series expansion
for fμ may be regarded as having its analogue in the p-adic theory in the inﬁnitesimal
Verschiebung, which plays an important role throughout the paper.
More obvious is the analogy between the canonical representation ρC : π1 (X) →
PSL2 (R) of a hyperbolic Riemann surface (arising from the upper half plane uniformization), and the canonical representation ρ∞ : Π∞ → GL±
2 (Zp ) of an ordinary p-adic curve
(in Theorem 0.4). Of course in the p-adic case, Π∞ has a substantial arithmetic part in
addition to its geometric part. Although generally in the complex case, there is not much
of a Galois group to work with, at least for real curves, we saw at the end of §1, that one
does get a natural representation ρR of the full “arithmetic fundamental group” ΠR into
GL±
2 (R). Moreover, our approach to constructing ρ∞ in the p-adic case is very much akin
to Bers’ approach to constructing ρC in the complex case: Namely, if one traces through
the proof (which lies in Chapters II through V), one sees that eﬀectively what we are doing
is noting that the result is true for totally degenerate curves, and then transporting this
result over the rest of the moduli stack of ordinary curves.
Next let us consider metrics and geometry. As we stated earlier, in some sense,
one can summarize the entire complex theory by saying: We start with the hyperbolic
(Kähler) metric on a hyperbolic curve, deﬁne the Weil-Petersson (Kähler) metric on the
moduli stack precisely so as to be compatible with the hyperbolic metric on the curves
being parametrized; then our holomorphic uniformizations – i.e., both the upper half plane
uniformization of the hyperbolic curve and the Bers uniformization of the moduli stack
– are obtained by “integrating” the respective metrics. Similarly, the fundamental result
in the p-adic theory – namely, Theorem 0.1 – is a result about the existence of certain
Frobenius liftings on the universal hyperbolic curve and its moduli stack which are uniquely
characterized by the fact that they are compatible with each other. Here the compatibility
is expressed through the tool of the canonical indigenous bundle. Then, by “integrating”
these Frobenius actions, we obtain canonical (p-adically holomorphic) coordinates (as in
ord
Corollary 0.2) on C ord and N g,r . This particular analogy lies at the heart of this work.
The Bers coordinates and the coordinates of Chapter III, Theorem 2.4, are appropriate
in the locus Mg,r of smooth curves. For totally degenerate curves, one has multiplicative
parameters (Chapter III, Deﬁnition 2.7) which we believe are analogous to the holomorphic
coordinates of degeneration of [Wolp], reviewed in §1. For instance, both sets of parameters
are holomorphic and naturally indexed by the nodes of the totally degenerate curve.
For elliptic curves – regarded parabolically – one has, on the one hand, the well-known
theory of the hyperbolic upper half plane, or unit disk, in the complex case, and Serre28

Tate theory in the p-adic case. It is interesting to note that at both types of primes
(complex and p-adic), the parabolic theory may be obtained in a very precise sense as
the parabolic specializations, respectively, of Bers’ theory and of the hyperbolic p-adic
theory developed in this paper. In fact, this is one of our reasons for feeling that the
canonical p-adic coordinates of Corollary 0.2 are the p-adic analogue, not of Teichmüller’s
coordinates, but of Bers’: Namely, in addition to the fact that Teichmüller’s coordinates are
not holomorphic, whereas Bers’ are, Teichmüller obtains the same coordinates for 1-pointed
curves of genus 1 and parabolic elliptic curves. On the other hand, it is well-known that
Bers’ coordinates are very diﬀerent for 1-pointed curves of genus 1 and parabolic elliptic
curves, which is consistent with the fact that the canonical coordinates of Corollary 0.2
are also very diﬀerent for 1-pointed curves of genus 1 and parabolic elliptic curves.
Loose Ends
We close by saying that although, as described above, there are (what the author
believes to be) very strong analogies between Bers’ complex theory and the p-adic theory
presented here, the picture is by no means complete. For instance, one fundamental fact
in the complex case is that all r-pointed smooth curves of genus g are quasiconformally
equivalent, whereas in the p-adic case, the theory behaves as though there are several
diﬀerent quasiconformal equivalence classes that are permuted around to each other by a
certain monodromy action in such a way that there seems to be no one quasiconformal
equivalence class “which is better than the others.” Ideally, one would like to have a much
more complete understanding of this phenomenon. In particular, one would like to know
precisely how many quasiconformal equivalence classes there are (at least generically), as
well as a more explicit description of the set of such classes.
Also, I still do not understand what the complex, or global, analogue of a “canonical p-adic curve” is. For ordinary elliptic curves, since Serre-Tate canonical liftings have
complex multiplication, one can ask what the hyperbolic analogue of having complex multiplication is. Since having complex multiplication for an elliptic curve means having lots
of isogenies, it is natural to ask if the proper hyperbolic analogue is having lots of correspondences, which are a sort of higher genus version of isogenies. If a hyperbolic curve
does have a lot of correspondences, then one knows ([Marg]) that the image of its canonical
representation is arithmetic. In Chapter IV, we prove that a canonical curve has lots of
“pseudo-correspondences,” but unfortunately, at the time of writing, I do not see how to
make these pseudo-correspondences into genuine correspondences, so that one could apply
Margulis’ result. Another issue that arises in this connection is the question of whether one
can characterize “hyperbolic curves with complex multiplication” – whatever the correct
deﬁnition should be for this term – in terms of the Bers coordinates.
Finally, as the title implies, the present work deals exclusively with the case of ordinary
curves. In a complete theory, one would like to know what happens when one has a
nilpotent indigenous bundle which is not ordinary.

29

At any rate, in summary, with respect to these three issues of quasiconformal equivalence classes, canonical curves, and non-ordinary curves, much work remains to be done.
We hope to be able to address these issues in future papers.

30

Chapter I: Crystalline Projective Structures
§0. Introduction
The purpose of this Chapter is to study the algebraic analogue of projective structures
on a Riemann surface. In particular, we prove many of the analogues of results of [Gunning]
in a purely algebraic framework, often making use of the crystalline site where complex
analytically one would restrict to a simply connected neighborhood on which one can
integrate. Unlike Gunning, we make systematic use of the log structures of [Kato], which
enable us to work with a very general sort of “log-curve,” that is, we can handle the case
of curves with marked points, as well as singular nodal curves on an equal footing to the
smooth case.
In §1, we discuss the notion of a Schwarz structure, which is the algebraic analogue of
[Gunning]’s projective structures. We relate Schwarz structures to projective bundles with
connections as well as to square diﬀerentials, and we show that Schwarz structures naturally
give rise to a Schwarzian derivative. (Moreover, in the Appendix to this Chapter, we show
that for P1 , this abstract notion of a Schwarzian derivative essentially coincides with the
classical Schwarzian derivative.) The characterizing feature of §1 is that everything takes
place locally on the curve in question. In §2, we discuss indigenous bundles (the direct
algebraic analogue of [Gunning]’s indigenous bundles). What distinguishes §2 from §1 is
that in §2, we work mainly over stable curves, and thus global issues on the curve come
into play. In §2, we are still working locally, however, on the base. In §3, we perform
various intersection theory calculations that allow us to prove that in most cases, there
do exist any canonical indigenous bundles on the universal smooth curve over a moduli
stack. Thus, in §3, we are concerned with issues that are global not only on the curve, but
also on the base. It should be said that all the material in this Chapter is, in some sense,
“well-known,” but I do not know of any modern reference that does things from this point
of view. In particular, all the references that I know of (with the exception of [Ih], which
is algebraic, but somewhat diﬀerent in point of view) discuss things only in the complex
analytic case, and often work with “hαβ ’s” (i.e., cocycle classes) rather than with objects
that have an intrinsic meaning.

§1. Schwarz Structures
In this Section, we introduce the crystalline analogue of what Gunning calls “projective
structures on a Riemann surface.” (We shall call them Schwarz structures (after the
Schwarzian derivative) to distinguish them from the analytic notion.) We begin by letting
S be a connected noetherian scheme. Often, we shall prove results about arbitrary stable
curves by working on various compactiﬁed moduli stacks. Thus, even if one is ultimately
interested only in smooth curves, for certain proofs, we shall see that it is useful to develop
31

the machinery for arbitrary stable curves. To deal with singular curves, we shall use the
theory of log schemes of [Kato]. Thus, we assume that S has a given ﬁne ([Kato], §2) log
structure, and denote the resulting log scheme by S log .
Notation and Basic Deﬁnitions
Deﬁnition 1.1. Let f log : U log → S log be a morphism of log schemes whose underlying
morphism of schemes f : U → S is of ﬁnite type, ﬂat and of relative dimension one. Then
we shall say that f log is locally stable of dimension one if, for every point u ∈ U , there
exist étale morphisms T → S and V → U ×S T , together with v ∈ V mapping to u ∈ U
such that when we pull-back the log structure on S (respectively, U ) to T (respectively,
V ) to obtain log schemes V log and T log , one of the following holds:
(1) V → T is smooth, and V log = V ×T T log (where V and T denote the
log schemes with trivial log structure); or
(2) V → T is smooth, and there exists a section s : T → V such that if we
denote by V s the log scheme deﬁned by the relative divisor Im(s) on V ,
then V log = V s ×T T log ; or
(3) let Y = Spec(Z[t]); X = Y [x, y]/(xy − t) (where x, y, and t are indeterminates) and endow Y (respectively, X) with the log structure arising
from the divisor t = 0 (respectively, xy = 0), so we get a morphism
X log → Y log of log schemes; then there exists a morphism of log schemes
T log → Y log , together with a morphism ζ log : V log → T log ×Y log X log
such that the underlying scheme morphism ζ of ζ log is étale, and the
log structure of V log on V is the pull-back via ζ of the log structure on
T log ×Y log X log .
In case (1) (respectively, (2); (3)), we shall say that f is smooth and unmarked (respectively,
marked; singular) at u.
Note that if f log : U log → S log is locally stable of dimension one, then it is always log
smooth ([Kato], §3). Also, note that by étale descent, the images in U of all the sections
s as in Case (2) above form a divisor in U which is étale over S. We shall refer to this
divisor as the divisor of marked points in U .
Now let us suppose that there exists an odd prime p which is nilpotent on S. We also
suppose that we are given a closed subscheme S0 = V (I) ⊆ S, where the sheaf of ideals
I has a divided power structure γ. We denote the log scheme S0 ×S S log (where S0 and
S denote the log schemes which are the respective schemes endowed with the trivial log
structure) by S0log . Let f log : U log → S log be locally stable of dimension one. Then we
shall call a section of DΔ (U log ×S log U log ) (the PD-envelope of the diagonal, as in [Kato],
32

§5) a bianalytic function over U log . Note that the bianalytic functions form a sheaf, which
we denote OU bi , on the étale site of U . Let OU denote the sheaf on the étale site of U
given by considering ordinary functions. Then the two projections U ×S U → U give rise
to injections iL : OU → OU bi and iR : OU → OU bi whose images we shall call the left-sided
(respectively, right-sided) bianalytic functions on U log . We shall also refer to right-sided
bianalytic functions as constant bianalytic functions, or bianalytic constants. We denote
tensor products of an OU -module F over OU with OU bi via iL (respectively, iR ) by writing
F on the left (respectively, right). Finally, we have a multiplication morphism μ : OU bi →
OU . We denote the ideal subsheaf of OU bi which is the kernel of μ by J . We shall say
that a bianalytic function f over some étale V → U is a bianalytic uniformizer on V if f
is, in fact, a section of J which generates the line bundle J /J [2] ∼
= ωU log /S log as an OU module. Let OU bi be the completion of OU bi with respect to the divided powers J [i] , and
let J ⊆ OU bi be the closure of J in OU bi . We shall call sections of OU bi biformal functions,
and use similar terminology for biformal functions as we do for bianalytic functions.

Occasionally, we shall also need to make use of trianalytic (respectively, triformal)
functions, i.e., sections of DΔ (U log ×S log U log ×S log U log ) (respectively, its completion with
respect to the divided powers of the diagonal ideal). We denote the sheaf of trianalytic
functions (respectively, triformal) on the étale site of U by OU tr (respectively, OU tr ), and
we have left, right, and middle injections j1 , j2 , j3 : OU → OU tr , as well as injections
j12 , j23 , j13 : OU bi → OU tr . We shall apply similar terminology and notation to trianalytic
or triformal functions to that applied already to bianalytic functions. In particular, we
shall call trianalytic functions that are in the image of j23 trianalytic constants.
Deﬁnition 1.2. Let S ⊆ OU bi be a subsheaf in the category of sets. We shall call S a
Schwarz (respectively, pre-Schwarz) structure on U log if étale locally on U (i.e., for some
étale cover V → U ), S has the following form: there exists some biformal uniformizer
z ∈ Γ(V, S) such that for every étale W → V , and every section f ∈ Γ(W, OU bi ), then
f ∈ Γ(W, S) if and only if (respectively, implies that) f can be written étale locally (on W )
in the form (az + b)/(cz + d), where a, b, c, d are biformal constants and d is invertible.
It is clear that if S ⊆ OU bi is a pre-Schwarz structure on U log , then S is contained in a
unique Schwarz structure S a ⊆ OU bi on U log , which we refer to as the Schwarz structure
associated to S. If S is a Schwarz structure, then we shall denote by S × ⊆ S (respectively,
LS ) the subsheaf consisting locally of functions of the form (az +b)/(cz
 +d),
 where: (1) z is
a b
a biformal uniformizer belonging to S; (2) d is invertible; and (3)
is an invertible
c d
S × . Thus S × , LS ,
matrix of biformal constants (respectively, b = 0). We let L×
S = LS
×
and L×
S are all pre-Schwarz structures. We shall call LS (respectively, LS ) the sheaf of
biformal uniformizers (respectively, pseudo-uniformizers) of S.
Let G → U be the group scheme PGL2 , and let B ⊆ G be the subgroup scheme which
is the standard Borel subgroup of PGL2 , i.e., the image of the lower triangular matrices.
33

First Properties of Schwarz Structures
Proposition 1.3. The subsheaf L×
S ⊆ S consisting of biformal uniformizers of S forms a
B-torsor BS → U .
Proof. This follows immediately from the deﬁnition of a Schwarz structure.

 The action of
a 0
B is given by associating to a biformal uniformizer z and a matrix
(where a, c, d
c d
are biformal constants, and a, d are invertible) the biformal uniformizer az/(cz + d). 
Note that every B-torsor T → U naturally deﬁnes a P1 -bundle with a given section (by
taking the quotient of P1 ×U T modulo the diagonal action of B, where B acts on P1 by
means of aﬃne transformations that ﬁx zero; the section is the image of the zero section
of P1 ). We shall refer to the P1 -bundle PS → U associated to BS → U as the P1 -bundle
associated to the Schwarz structure S. We denote by σS : U → PS the natural section
(arising from the fact that the structure group is B rather than G).
Proposition 1.4. Let S be a Schwarz structure on U log . Then PS ∼
= P(J /J [3] ), and
σS∗ τPS /U ∼
= (J /J [2] )∨ ∼
= τU log /S log . In particular, if U → S is proper, then the height of
σS with respect to τPS /U is −deg(ωU log /S log ).
Proof. One sees by construction (e.g., by writing out transition functions) that the sheaf of
nonzero relative rational functions of relative degree one (as in [EGA IV], §20) for PS → U
that vanish at σ is naturally isomorphic to L×
S . Thus, by considering Taylor expansions
out to second order terms, we get an isomorphism OPS (−σS )/OPS (−3σS ) ∼
= J /J [3] (here
we use that p is odd). On the other hand, by multiplying and then taking the residue at
σ, we obtain a natural duality between OPS (−σS )/OPS (−3σS ) and π∗ ωPS /U (3σS ), where
π : PS → U is the natural projection. Also, note that via this duality, the ﬁltration induced
by π∗ ωPS /U (2σS ) ⊆ π∗ ωPS /U (3σS ) on OPS (−σS )/OPS (−3σS ) is the ﬁltration deﬁned by
the submodule OPS (−2σS )/OPS (−3σS ). Since PS is clearly naturally isomorphic to the
projectivization of π∗ ωPS /U (3σS ), we thus obtain the result. 
Crystalline Schwarz Structures and Monodromy
Let S be a Schwarz structure on U log . We would like to associate to S a subsheaf (in
the category of sets) of OU tr , which we shall call S12 as follows. We work locally. Thus,
we assume that there exists a biformal uniformizer z ∈ Γ(U, S). We consider the triformal
function z12 deﬁned by j12 (z), where j12 is the natural map OU bi → OU tr given by inclusion
on the ﬁrst two factors. Then we let S12 be the sheaf of all functions which étale locally
can be written in the form (az12 + b)/(cz12 + d), where a, b, c, d are triformal constants
and d is invertible. Note that the deﬁnition of S12 does not depend on the choice of z,
34

so everything glues together, and we obtain the subsheaf S12 of OU tr over our original U .
On the other hand, we also have a subsheaf S13 of OU tr deﬁned in the same way as S12 ,
except with the roles of 2 and 3 reversed.
Deﬁnition 1.5. We shall say that the Schwarz structure S is a crystalline Schwarz
structure on U log if the two subsheaves S12 and S13 of OU tr coincide. Let S be a crystalline
Schwarz structure on U log . Then we shall say that S has nilpotent monodromy if for every
marked point s : T → V (with V → U étale), there exists a biformal uniformizer z ∈ S(V )
and a section a ∈ ωU log /S log (V ) such that the image of (dz) − iR (a) (where “d” is the
exterior derivative on the right) in OU bi ⊗OU s∗ ωU log /S log is zero.
Remark. Of course, one may also phrase the deﬁnition of a crystalline Schwarz structure
as follows. First, note that OU bi , together with its right-hand sided OU -algebra structure
and standard logarithmic connection, forms a quasi-coherent crystal of algebras A on the
crystalline site of U log /S log . Then a crystalline Schwarz structure is a subsheaf of the sheaf
A on the crystalline site of U log /S log satisfying certain properties. Since this point of view
is only formally diﬀerent from the point of view of Deﬁnition 1.5, we shall use these two
points of view interchangeably in what follows.
log
Let us suppose that S is a Schwarz structure
on

 U . Let H ⊆ G be the open
a b
subscheme consisting of matrices of the form
, where d is invertible. Note that
c d
H is stable under the action by B from the right. Thus, we can take the quotient of
H ×U BS (by the diagonal action of B) to obtain a ﬁber bundle HS → U with ﬁbers
locally isomorphic to H → U . Similarly, we also obtain a G-torsor GS → U . It now
follows immediately from the deﬁnitions that the sheaf deﬁned on the étale site of U by
HS is naturally isomorphic to S × . Thus, if we assume that the Schwarz structure S
is crystalline, we see that we get a natural isomorphism between the two pull-backs of
HS → U via iL , iR : OU → OU bi , i.e., we get a logarithmic connection ∇HS on HS → U .
By basic facts about ﬁber bundles, this gives a logarithmic connection ∇GS on GS → U and
a logarithmic connection ∇PS on PS → U , as well. Thus, in summary, to every crystalline
Schwarz structure S, we have associated a natural P1 -bundle with section and logarithmic
connection (PS → U ; σS : U → PS ; ∇PS ). Moreover, it follows from the deﬁnition of
the connection ∇PS that by diﬀerentiating σS by means of ∇PS , we get an isomorphism
τU log /S log ∼
= σS∗ τPS /U , which is called the Kodaira-Spencer morphism. Indeed, to see that
this morphism is, indeed, an isomorphism, it suﬃces to realize that if, locally on U , one
takes a biformal uniformizer z, the diﬀerence j12 (z) − j13 (z) generates j23 (J )OU tr .

In addition to the fact that the Kodaira-Spencer morphism is an isomorphism, the
logarithmic connection ∇PS has another special property: If S has nilpotent monodromy,
then we can make more explicit the way in which this monodromy acts. Indeed, let
us recall from [Kato], §6, that if s : S → U is any marked point, then there exists a
unique subsheaf Ms of (OU bi ⊗OU ,s−1 OS )/OS which is isomorphic to OS and annihilated
by the monodromy operator of the standard logarithmic connection on OU bi . (Locally,
35

this subsheaf is generated by log(1 − δ), where δ = 1 − ( 1⊗t
t⊗1 ), and t is a local generator of
the ideal deﬁning s.) This subsheaf Ms thus deﬁnes a section qs : S → P(J /J [3] ) that
lies over s. Then it follows from these observations, plus Proposition 1.4, that
Proposition 1.6. If S is a crystalline Schwarz structure on U log with nilpotent monodromy, then under the isomorphism PS ∼
= P(J /J [3] ) of Proposition 1.4, qs is ﬁxed by
the monodromy action on PS ∼
= P(J /J [3] ) at s.
Correspondence with P1 -bundles
So far, from a crystalline Schwarz structure, we have constructed a P1 -bundle with
section and logarithmic connection (satisfying certain properties). We can go the other
way, as well. Suppose we are given a P1 -bundle with section and logarithmic connection
(π : P → U ; σ : U → P ; ∇P ) such that the Kodaira-Spencer morphism obtained by
diﬀerentiating σ via ∇P gives an isomorphism τU log /S log ∼
= σ ∗ τP/U . Let P L and P R denote
the pull-backs of π : P → U via iL , iR : OU → OU bi , respectively. Then the connection ∇P
deﬁnes an OU bi -linear isomorphism Ξ : P L ∼
= P R . Thus, we have a commutative diagram:
Ξ

P L −→
⏐
⏐ L
π

U bi

id

−→

PR
⏐
⏐ R
π

U bi

Let σ L (respectively, σ R ) denote the result of base-changing σ via iL (respectively, iR ).
Then by applying (σ L )∗ , we can pull-back functions on P L to biformal functions on U log .
Let R denote the étale sheaf of degree ≤ 1 relative rational functions (as in [EGA IV],
§20) on P relative to π : P → U (i.e., the divisor of poles is ﬂat of degree ≤ 1 over U )
that are regular in a neighborhood of the image of σ. Let αR : P R → P denote the
natural projection. Then it is easy to see that Ξ−1 (αR )−1 (R) deﬁnes a sheaf of functions
on P L that are regular in a neighborhood of Im(σ L ), so we can consider the subsheaf S
of biformal functions on U log which is the image of (σ L )−1 Ξ−1 (αR )−1 (R). One checks
immediately that S deﬁnes a Schwarz structure, and, moreover, that since the connection
∇P is necessarily integrable (since the dimension of U over S is one), S is automatically
crystalline. Thus, in summary, we have the crystalline analogue of Theorem 2 of [Gunning]:
Theorem 1.7. If f : U → S is as above, then there is a natural one-to-one correspondence
between crystalline Schwarz structures on U log and isomorphism classes of P1 -bundles with
section and logarithmic connection (π : P → U ; σ : U → P ; ∇P ) on U log whose associated
Kodaira-Spencer morphism is an isomorphism. Moreover, under this correspondence, the
crystalline Schwarz structures with nilpotent monodromy correpond precisely to the triples
such that ∇P has nilpotent monodromy at the marked points.
36

Proof. We have already deﬁned maps going in either direction. Thus, it suﬃces to see
that these maps are inverse to each other. Now it is easy to see that if we start with
a P1 -bundle with section and logarithmic connection as above, construct the associated
crystalline Schwarz structure S, and then from that the associated P1 -bundle PS with
section σS and logarithmic connection ∇PS , then we get back our original data. Thus, it
suﬃces to show that the map that associates a P1 -bundle with section and connection to
a crystalline Schwarz structure is injective.
Let S and S  be crystalline Schwarz structures on U log . Suppose that we are given
a horizontal isomorphism α between PS and PS  that takes σS to σS  . Then α induces
an isomorphism αB of the B-torsors BS and BS  . Let A be the OU -algebra OU bi via
∼ ×
the morphism iR . Since as sheaves with B-action, BS ∼
= L×
S and BS  = LS  , we get an
×
×
isomorphism αL : L×
S → LS  , which, by mapping a biformal uniformizer z ∈ Γ(U, LS )
(where U → X is étale) to the biformal uniformizer αL (z) ∈ Γ(U, L×
S  ) ⊆ Γ(U, A), deﬁnes
an automorphism αA of the PD-OU -algebra A that preserves the augmentation μ : A →
OU . Moreover, it follows from the horizontality of α that αA is horizontal with respect
to the standard logarithmic connection on A. On the other hand, it is immediate that A
does admit any nontrivial horizontal automorphisms (as a PD-OU -algebra) that preserve
μ. Thus, αA is the identity, and hence, S and S  must be the same subsheaf of A. This
completes the proof of the ﬁrst statement. The last statement follows directly from the
deﬁnitions. 
Schwarz Structures and Square Diﬀerentials
We would like to use Theorem 1.7 to exhibit the space of Schwarz structures as a
torsor over the square diﬀerentials. Let π : P → U be a P1 -bundle. Then we shall denote
by Ad(P ) the vector bundle on U (of rank three with trivial determinant) given by π∗ τP/U .
When we consider marked points, it is not enough just to deal with P1 -bundles; we must
deal with P1 -bundles equipped with parabolic structures, as in [Sesh]. Thus, if our divisor
D of marked points is given by sections p1 , . . . , pr : S → U , we make the following
Deﬁnition 1.8. A P1 -bundle with parabolic structure on U log is deﬁned to be a P1 -bundle
π : P → U , together with sections qi : S → P lying over pi . A rank two vector bundle
with parabolic structure on U log is a rank two vector bundle E, together with a parabolic
structure on P(E).
Let (π : P → U ; q1 , . . . , qr ) be a P1 -bundle with parabolic structure on U log . Then
we deﬁne the subsheaf Adq (P ) ⊆ Ad(P ) to be the sheaf of sections that vanish at the
qi ’s. We deﬁne Adc (P ) ⊆ Adq (P ) to be the subsheaf of sections that vanish to second
order (in the relative coordinate for π) at the qi ’s. Suppose that we are given a section
σ : U → P that avoids all the qi . Let L = σ ∗ ωP/U . Then Ad(P ) gets a ﬁltration
0 = F 2 (Ad(P )) ⊆ F 1 (Ad(P )) ⊆ F 0 (Ad(P )) ⊆ F −1 (Ad(P )) = Ad(P ) given by considering
sections of τP/U that vanish to ﬁrst or second order at σ. Thus, for Ad(P ), we have:
37

F1 ∼
= L; F 0 /F 1 ∼
= OU ; F −1 /F 0 ∼
= L−1
This ﬁltration induces ﬁltrations on Adq (P ) and Adc (P ). The subquotients are easily seen
to be the following: For Adq (P ), we have:
F1 ∼
= L(−D); F 0 /F 1 ∼
= OU ; F −1 /F 0 ∼
= L−1
For Adc (P ), we have:
F1 ∼
= L(−D); F 0 /F 1 ∼
= OU (−D); F −1 /F 0 ∼
= L−1
log
Often, L ∼
= ωU/S .

Thus, for computational purposes, it is convenient to note that

log
ωU/S
(−D) is none other than the relative dualizing sheaf of the morphism f : U → S.

Now let us assume that π : P → U is given by P(J /J [3] ), with the section σ given
by J /J [3] → J /J [2] , and the qi given by the sections “qs ” deﬁned in the paragraph
preceding Proposition 1.6. Let ∇P be a logarithmic connection whose Kodaira-Spencer
morphism at σ is the identity and whose monodromy at the marked points is nilpotent
and ﬁxes the qi . (It is not diﬃcult to see that such ∇P always exist étale locally on U .)
Then any other such logarithmic connection ∇P on P → U is given by adding to ∇P a
log
. On the other hand, the quadruples (π; σ; qi ; ∇P ) and
section of F 0 (Adc (P )) ⊗OU ωU/S

(π; σ; qi ; ∇P ) are isomorphic if and only if ∇P can be obtained from ∇P by applying an
automorphism α of (π; σ; qi ) that preserves the conormal bundle to σ (since both KodairaSpencer morphisms are the identity). Such an automorphism α is given by a section
of F 1 (Adq (P )). The eﬀect of such an automorphism α on the connection ∇P is given
log
obtained by applying the morphism
by adding to ∇P the section of Adc (P ) ⊗OU ωU/S
log
Ad(∇P ) : F 1 (Adq (P )) → F 0 (Adc (P )) ⊗OU ωU/S
(induced by the connection ∇P ) to
α. Thus, we obtain that the set of isomorphism classes of quadruples (π; σ; qi ; ∇P ) that,
relative to the bijection of Theorem 1.7, correspond to crystalline Schwarz structures with
nilpotent monodromy are a torsor over the cokernel of Ad(∇P ). On the other hand, by
looking at the explicit representations of the subquotients of the ﬁltrations on Adq (P ) and
Adc (P ) (given in the preceding paragraph), and using the fact that the Kodaira-Spencer
morphism for ∇P at σ is an isomorphism, we obtain that
log
Coker(Ad(∇P )) ∼
= (ωU/S )⊗2 (−D)

(We remark that here one uses the fact that p is odd, for when one computes Ad(∇P ) from
∇P , certain factors of 2 appear, and in order to get the above isomorphism, one needs for
those factors of 2 to be invertible.)
In other words, we have proven the following result:
38

Theorem 1.9. The étale sheaf of crystalline Schwarz structures on U log with nilpotent
log ⊗2
) (−D).
monodromy is naturally a torsor over the sheaf (ωU/S
Normalized P1 -bundles with Connection
Let us consider the P1 -bundle π : P = P(J /J [3] ) → U , and section σ : U → P
given by J /J [3] → J /J [2] , without any connection. Now, just as in the proof of Proposition 1.4, by taking residues, we obtain a natural duality between OP (−σ)/OP (−3σ)
and π∗ ωP/U (3σ) that respects the natural ﬁltrations on the two bundles. Let Q =
P((J /J [3] )∨ ). As U -schemes, we may identify Q and P . Let OQ (1) denote the line
bundle obtained from the deﬁnition of the projectivization; thus π∗ OQ (1) = (J /J [3] )∨ .
Let L = π∗ {OQ (1)⊗OQ τP/U (−3σ)}. Then L is a line bundle on U and (J /J [3] )∨ = L⊗OU
π∗ ωP/U (3σ). Thus, we obtain a natural isomorphism OP (−σ)/OP (−3σ) ∼
= (J /J [3] )⊗OU L
that respects ﬁltrations. If we then look at the quotients of both sides by their respective
rank one subbundles (that make up the ﬁltrations), we obtain an isomorphism between
log ∼
log
ωU/S
= (J /J [2] ) ⊗ L ∼
= ωU/S ⊗ L. That is, we get a natural trivial= OP (−σ)/OP (−2σ) ∼
ization OU ∼
= L of L. In summary, we see that without any connection, we have constructed
a natural ﬁltration-preserving isomorphism:
γ : OP (−σ)/OP (−3σ) ∼
= J /J [3]
Now let us suppose that we have a logarithmic connection ∇P on π whose KodairaSpencer morphism at σ is an isomorphism. Then we get a commutative diagram like the
one preceding Theorem 1.7. Pulling back by αR , then Ξ, and ﬁnally by σ L , we thus see
that ∇P induces an isomorphism:
ζ(∇P ) : OP (−σ)/OP (−3σ) ∼
= J /J [3]
Now we saw above (Theorem 1.7) that ∇P deﬁnes a Schwarz structure. But one “loose
end” relative to the statement of Theorem 1.7 is that although Schwarz structures have no
automorphisms, triples consisting of projective bundles with a section and a connection can
have automorphisms. These automorphisms were the cause of the phenomenon (observed
just before the statement of Theorem 1.9) that many diﬀerent ∇P can give rise to the same
Schwarz structure. Thus, it is convenient to have some sort of notion of a “normalized
∇P ” such that each Schwarz structure arises from a unique normalized ∇P . We choose
the normalization as follows:
Deﬁnition 1.10. We say that ∇P is normalized if γ and ζ(∇P ) are inverse to each
other.
Now as a formal consequence of this deﬁnition, we observe that we obtain the following
normalized version of Theorem 1.7:
39

Theorem 1.11. If f : U → S is as above, then there is a natural one-to-one correspondence between crystalline Schwarz structures on U log and normalized logarithmic connections on the P1 -bundle π : P(J /J [3] ) → U whose associated Kodaira-Spencer morphism
at the section σ : U → P (deﬁned by J /J [3] → J /J [2] ) is an isomorphism. Moreover,
under this correspondence, the crystalline Schwarz structures with nilpotent monodromy
correpond precisely to the triples such that ∇P has nilpotent monodromy at the marked
points.
The Schwarzian Derivative
Before proceeding, it is interesting to note that, as the name suggests, a crystalline
Schwarz structure S allows one to deﬁne a Schwarzian derivative dS , as follows. Let
×
ωU
log /S log ⊆ ωU log /S log denote the subsheaf consisting of sections that locally generate
#
⊆ OU be the subsheaf consisting of functions φ such
ωU log /S log as an OU -module. Let OU
×
that dφ is a section of ωU log /S log ⊆ ωU log /S log . Then our Schwarzian derivative will be a
morphism of sheaves of sets:
#
⊗2
dS : OU
→ ωU
log /S log
#
Let θ be a section of OU
over some étale V → U . Let us denote by jθ ∈ J /J [3] (V ) the 2jet of θ (i.e., the Taylor expansion out to second order, modulo the constant term). By the
#
deﬁnition of OU
, the image of jθ in J /J [2] (V ) is a local generator of the sheaf J /J [2] . By
Proposition 1.6, jθ then deﬁnes a section sθ : V → PS . Taking the Kodaira-Spencer map
of this section then deﬁnes an OV -linear morphism from τU log /S log to the conormal bundle
to sθ , which is simply ωU log /S log . This OV -linear morphism is thus given by multiplication
⊗2
by a section of ωU
log /S log , which we take to be dS (θ). A simple calculation reveals that

Proposition 1.12. If (as in Theorem 1.9) one modiﬁes the Schwarz structure S by
log ⊗2
) (−D)](U ) to obtain a Schwarz structure S  ,
adding the square diﬀerential δ ∈ [(ωU/S
then dS (θ) = dS  (θ) + δ.
We also have a biformal version of the Schwarzian derivative. Namely, we let O #bi be
U
the subsheaf of OU bi consisting of biformal functions φ that are of the form u + c, where u
is a biformal uniformizer, and c is a biformal constant. Then we get a morphism of sheaves
of sets:
#
⊗2
⊗2
L
dbi
S : O bi → (ωU log /S log ) = ωU log /S log ⊗OU OU bi
def

U

deﬁned as follows: If θ is a section of O #bi over some étale V → U , we let jθ be the
U

section of J /J [3] ⊗OU OU bi which is the 2-jet of θ. Thus, jθ deﬁnes a section of sθ of PSL
40

⊗2
L
whose Kodaira-Spencer map is given by multiplication by a section of (ωU
log /S log ) , which
bi
we take as dbi
S (θ). Note that dS (iL (θ)) = iL (dS (θ)), and that if we modify the Schwarz
structure by adding a square diﬀerential δ, then

bi
dbi
S (θ) = dS  (θ) + iL (δ)

Remark. In the Appendix to this Chapter, we show that the deﬁnition just given for the
Schwarzian derivative coincides with one-half the classical Schwarzian derivative, when U
is the projective line.
For the biformal version of the Schwarzian, we have an analogue of the classical
result that the Schwarzian vanishes exactly on the formal functions that make up the
projective structure of a Riemann surface. Indeed, let Ξ : PSL → PSR be the isomorphism
deﬁned by the connection ∇PS ; let αR : PSR → PS be the natural projection; and let
def

ζ : U bi = Spec(OU bi ) → PS be the morphism obtained by composing σSL : U bi → PSL with
Ξ and then αR . Since the deﬁnition of dS is functorial, dS applied to a function pulled back
by ζ is ζ −1 of the “dS ” computed for projective bundles in the Appendix, i.e., one-half the
classical Schwarzian. Thus, if θ is a section of S, then θ is the pull-back by ζ of a (degree
≤ 1) relative rational function for PS → U , so dbi
S (θ) = 0.
bi
Conversely, suppose that dbi
S (θ) = 0. Then the statement that dS (θ) = 0 means
L
that sθ is a horizontal section of PS . Thus it follows from the deﬁnition of a connection,
together with the Poincaré Lemma in crystalline cohomology (see, e.g., [Kato], §6 for the
log version) that Ξ(sθ ) is the pull-back via αR of a section tθ of PS . Now (after possible
étale localization), we can ﬁnd a (degree ≤ 1) relative rational function φ for PS → U
whose 2-jet at σS is given by the section tθ . Since ζ maps the diagonal in U bi to σSR , and
def

the formation of 2-jets is functorial, it thus follows that the 2-jet of ψ = ζ −1 (φ) deﬁnes
a section sψ of PSL which is equal to sθ when restricted to the diagonal U ⊆ U bi . But
since both sψ and sθ are horizontal, they must be equal. The biformal functions ψ and
θ thus have 2-jets that deﬁne the same “line” in J /J [3] . Let z be a local coordinate on
U . Let us denote by successive primes the derivatives of biformal functions (i.e., taken on
the left) with respect to z. Then we obtain that ψ  and θ  are both invertible biformal
functions such that ψ  · θ  = ψ  · θ  . It thus follows that (ψ  /θ  ) = 0, so θ  = a ψ  , where
a is an invertible biformal constant. Thus, θ = a ψ + b, where b is a biformal constant.
Since, by construction ψ ∈ S(V ), it follows that θ ∈ S(V ). Thus, we obtain the following
“crystalline Schwarzian Poincaré Lemma:”
Theorem 1.13. If θ is a biformal function, then dbi
S (θ) = 0 if and only if θ is a section
of S.

41

§2. Indigenous Bundles
In this Section, we globalize the local considerations of §1, and are thus led to introduce
“indigenous bundles” (as in [Gunning]). Let S log be a ﬁne log scheme, whose underlying
scheme is connected noetherian. Let f log : X log → S log be proper, geometrically connected,
and locally stable of dimension one. (Note that the ﬁrst two conditions are actually
conditions on the underlying scheme morphism f .) We assume that the ﬁbers of f : X → S
have arithmetic genus g ≥ 0, and exactly r ≥ 0 marked points (as in Deﬁnition 1.1 – note
that these may only be deﬁned étale locally, however).
Basic Deﬁnitions and Examples
If 2g − 2 + r ≥ 1, then let Mg,r be the moduli stack of stable curves of genus g,
with r marked points, over Z, and let ζ : C → Mg,r be the universal curve, with its r
marked points s1 , . . . , sr : Mg,r → C. Note that Mg,r has a natural log structure given
log

by the divisor at inﬁnity. Denote the resulting log stack Mg,r . Also, by taking the divisor
which is union of the si and the pull-back of the divisor at inﬁnity of Mg,r , we get a log
structure on C; we call the resulting log stack C log . Also, ζ : C → Mg,r extends naturally
log

to a morphism of log stacks ζ log : C log → Mg,r .
Deﬁnition 2.1. We shall say that f log : X log → S log is stable if there exists a classifying
log
morphism φlog : S log → Mg,r such that X log ∼
= S log ×Mlog C log .
g,r

Ultimately, we shall be concerned mainly with the case where f log is stable, but it is useful
to realize that the deﬁnition, as well as many of the ﬁrst properties, of indigenous bundles
can be made without these assumptions.
Let π : P → X be a P1 -bundle. If σ : X → P is a section, then we call the canonical
height of σ the number 12 degX/S (σ ∗ τP/X ), where degX/S denotes the relative degree over S
of a line bundle on X, and τP/X is the relative tangent bundle of π. If ∇P is a logarithmic
connection on P , then we call the morphism τX log /S log → σ ∗ τP/X given by diﬀerentiating
σ by means of ∇P the Kodaira-Spencer morphism at σ relative to ∇P . Often, instead of
dealing with P1 -bundles with logarithmic connections, it will be more convenient to deal
vector bundles: Thus, let E be a vector bundle equipped with a logarithmic connection
∇E , whose rank is two and whose determinant is trivial. Then Theorem 1.7 motivates the
following
Deﬁnition 2.2. We shall say that (π : P → X, ∇P ) is an indigenous bundle on X log if
the monodromy at the marked points (which exist étale locally) is nilpotent, and there
exists a section σ : X → P of π such that the Kodaira-Spencer morphism at σ with
respect to ∇P is an isomorphism. We shall say that (E, ∇E ) is an indigenous vector bundle
42

on X log if the associated P1 -bundle with logarithmic connection (P(E) → X, ∇P(E) ) is an
indigenous P1 -bundle. We shall say that P → X (respectively, E) is intrinsic if there exists
a logarithmic connection ∇P (respectively, ∇E ) on P → X (respectively, E) that makes
(P → X, ∇P ) (respectively, (E, ∇E )) indigenous. We shall say that P → X (respectively,
E) is locally intrinsic if it is intrinsic étale locally on S.
Thus, in the vector bundle case, (E, ∇E ) is indigenous if ∇E has nilpotent monodromy
at the marked points, and there exists a rank one subbundle F 0 (E) ⊆ E such that the
Kodaira-Spencer morphism F 0 (E) → ωX log /S log ⊗OX (E/F 0 (E)) (induced by ∇E ) is an
isomorphism.
So far we have been discussing the hyperbolic case (2g − 2 + r ≥ 1); however, one can
make the same deﬁnition for curves that are not hyperbolic.
Example 1.
Suppose that f : X → S is smooth, with no marked points, and that
g = 0. Thus, f is a P1 -bundle. Then the P1 -bundle given by X ×S X → X has a natural
trivial connection, together with a natural section, the diagonal section. It is trivial to see
that this triple satisﬁes the required properties for an indigenous bundle.
Example 2. Suppose that f log : X log → S log has no marked points, and that its ﬁbers
all have arithmetic genus one. Then consider the bundle E = ωX/S ⊕ OX (where ωX/S
is the relative dualizing sheaf). Let L = f∗ ωX/S . Thus, L is a line bundle on S, and
f ∗L ∼
= ωX/S . In particular, there exists on ωX/S a “trivial connection” ∇ω obtained from
tensoring the trivial connection on OX with f ∗ L. Let ∇E be the connection on E which
is the direct sum of ∇ω and the trivial connection on OX . Let ∇E be the connection on
E given by adding to ∇E the section of End(E) ⊗ ωX/S given by projecting E → ωX/S ∼
=
(0, OX ) ⊗ ωX/S ⊆ E ⊗ ωX/S . Then one checks easily that if we take (P, ∇P ) = P(E, ∇E ),
and σ : X → P to be given by (ωX/S , 0) ⊆ E, then we obtain an indigenous bundle on
X log .
Example 3.
Let S log = Spec(Z) (with the trivial log structure); X log = M1,1 (the
moduli stack of one-pointed curves of genus one over Z), with its natural log structure.
Let E be the vector bundle of rank two on X which is the ﬁrst de Rham cohomology
module of the universal one-pointed curve of genus one. Then E has a natural logarithmic
connection ∇E , the so-called “Gauss-Manin connection.” There is also a natural Hodge
def
ﬁltration F 1 (E) ⊆ E, which deﬁnes a section σ : X → P = P(E). The pair (E, ∇E ) forms
the prototypical example of an indigenous bundle on X log .
First Properties
We now proceed to examine basic properties of such bundles.
43

Proposition 2.3. If f log : X log → S log and hlog : Y log → S log are as stipulated at the
beginning of the Section, and ζ log : Y log → X log is a log étale morphism of log schemes
over S log that sends marked points to marked points, then the pull-back via ζ log of any
indigenous bundle is again indigenous.
Proof. This follows from the deﬁnitions. 
Proposition 2.4. If π : P → X is intrinsic, then the section σ : X → P is of canonical
height 1 − g − 12 r. If X log → S log is a stable curve (so, in particular, 2g − 2 + r ≥ 1),
then σ is the unique section of π of canonical height 1 − g − 12 r. We shall refer to σ as the
Hodge section of π : P → X.
Proof. The fact that the canonical height of σ is 1 − g − 12 r follows from the fact that the
Kodaira-Spencer morphism is an isomorphism. Now suppose that X log → S log is stable.
Let us ﬁrst assume that S is the spectrum of an algebraically closed ﬁeld. Suppose that
σ  : X → P also has canonical height 1−g − 12 r. Then it follows that its restriction to some
irreducible component of X has negative canonical height. Since the restriction of σ ∗ τP/X
to any irreducible component has negative degree, it follows immediately from considering
intersection numbers on P , together with the deﬁnition of “canonical height,” that there
cannot exist two distinct sections of negative canonical height over that irreducible component. Thus, σ and σ  must agree over that irreducible component. Now if there are
any other irreducible components in X, then σ  must have negative canonical height over
some other irreducible component of X, in order for its canonical height over all of X to
be 1 − g − 12 r. Thus, repeating this argument shows that σ = σ  . Finally, let us observe
that the space of deformations of σ is given by H 0 (X, σ ∗ τP/X ), which is zero, since σ ∗ τP/X
has negative degree on every irreducible component of X. The result for general S then
follows immediately from this by deformation theory. 
Now let us assume for the rest of the Section (unless stated otherwise) that there
exists an odd prime p which is nilpotent on S, together with a PD-ideal I ⊆ OS .
Proposition 2.5. If π : P → X is intrinsic, then P ∼
= P(J /J [3] ) (where J deﬁnes the
diagonal in X bi ). Moreover, for any connection on π that makes it indigenous, the monodromy at a marked point s : S → X ﬁxes the section qs : S → P(J /J [3] ) of Proposition
1.6.
Proof. This follows from Theorem 1.7 and Propositions 1.3 and 1.6. Note that the second
statement uses the fact that p is odd.
Proposition 2.6. Suppose that the number of marked point plus nodes on any geometric
irreducible component of a ﬁber of X → S is even. Let (π : P → X, ∇P ) be indigenous on
44

X log . Then étale locally on S, there exists an indigenous vector bundle (E, ∇E ) on X log
whose projectivization is (π : P → X, ∇P ). Moreover, such an (E, ∇E ) is unique up to
tensor product with a line bundle with connection (L, ∇L ) on X whose square is trivial.
Proof. Consider the relative anticanonical bundle τP/X on P . By Proposition 2.5, (after
étale localization on S) there exists a line bundle G on P whose square is τP/X . Now
let us note that since the construction of the anticanonical bundle is canonical, it follows
that the connection ∇P on the P1 -bundle induces a connection on the polarized P1 -bundle
(π : P → X, τP/X ). Moreover, since the “moduli space” of line bundles G whose square
is τP/X is étale over X, it follows that the connection ∇P on the P1 -bundle π : P → X
in fact induces a connection on the polarized P1 -bundle (π : P → X, G). Thus, we
def

get a connection ∇E on E = π∗ G. Moreover, on P , we have a natural exact sequence
0 → ωP/X → (π ∗ E) ⊗ G −1 → OP → 0, which induces an isomorphism det(π ∗ E) ∼
= OP ,
hence an isomorphism det(E) ∼
= OX , which is easily seen to be horizontal. Finally, it is
clear that the projectivization of (E, ∇E ) is isomorphic to (π : P → X, ∇P ).
Now suppose that both (E, ∇E ) and (E  , ∇E  ) have the same projectivization (π : P →
X, ∇P ). Then E deﬁnes a line bundle G on P whose square is τP/X and such that ∇P
induces a connection on the polarized P1 -bundle (π : P → X, G). Similarly, E  deﬁnes a line
bundle G  on P . Since we have horizontal isomorphisms G ⊗2 ∼
= τP/X and (G  )⊗2 ∼
= τP/X ,
 −1
it follows that if we let L = π∗ ((G ) ⊗ G), then L gets a natural connection ∇L such that
the square of (L, ∇L ) is trivial. Moreover, (E, ∇E ) ∼
= (E  , ∇E  ) ⊗ (L, ∇L ). This completes
the proof. 
In summary, the above Proposition tells us that (under the evenness assumption) up to
étale localization on the base, it is essentially the same thing to give an indigenous P1 bundle or an indigenous vector bundle. Thus, in the future, we shall frequently simply
speak of “indigenous bundles.” The same goes for intrinsic bundles.
Existence and de Rham Cohomology
The next step is to prove the existence of indigenous bundles, and to parametrize
them. We begin with the proof of existence. For the rest of this Section, we shall assume
that f log is stable. Thus, in particular, 2g − 2 + r ≥ 1.
Theorem 2.7. For any r-pointed stable curve X log → S log of genus g, the P1 -bundle
P(J /J [3] ) is locally intrinsic.
Proof. From Theorem 1.9, we know that the obstruction to the existence of a crystalline
Schwarz structure with nilpotent monodromy on X log (locally on S) is given by a section
log ⊗2
log ⊗2
of R1 f∗ (ωX/S
) (−D) over S. On the other hand, by Serre duality, R1 f∗ (ωX/S
) (−D)
45

is isomorphic to the dual of f∗ τX log /S log = 0, since the curve is stable. The Theorem now
follows form Proposition 1.6 and Theorem 1.7. 
Next we wish to compute the de Rham cohomology of the P1 -bundle with parabolic
structure (π; qi ). Note that the exterior diﬀerential operator maps Ad(P ) (respectively,
Adq (P )) into Adq (P ) (respectively, Adc (P )). We deﬁne the parabolic de Rham cohomology
(respectively, with compact supports) of Ad(P ) to be the hypercohomology of the complex
log
log
(respectively, Adq (P ) → Adc (P ) ⊗ ωX/S
).
Ad(P ) → Adq (P ) ⊗ ωX/S
Theorem 2.8. Let (P, ∇P ) be an indigenous bundle on an r-pointed stable curve f log :
X log → S log of genus g. Then the de Rham cohomology of Ad(P ) with its natural connection (induced by ∇P ) is as follows:
(1) For cohomology without compact supports, we have (fDR )∗ (Ad(P )) =
R2 (fDR )∗ (Ad(P )) = 0; and we have a natural exact sequence
log ⊗2
) (−D) → R1 (fDR )∗ (Ad(P )) → R1 f∗ τX log /S log → 0
0 → f∗ (ωX/S

(2) For cohomology with compact supports, we have (for all i ≥ 0) a natural
isomorphism
Ri (fDR )c,∗ (Ad(P )) ∼
= Ri (fDR )∗ (Ad(P ))

In particular, (P ; ∇P ) has no nontrivial automorphisms.
Proof. To compute the de Rham cohomology, one uses the long exact cohomology sequences induced by the ﬁltrations considered above, plus the fact that the Kodaira-Spencer
morphism is an isomorphism. Now let α be an automorphism. Since (fDR )∗ (Ad(P )) = 0,
all inﬁnitesimal automorphisms must vanish, so we may work over an algebraically closed
ﬁeld. By passing to a tamely ramiﬁed covering of X ramiﬁed only at the marked points
and nodes, we may assume that the hypotheses of Proposition 2.6 are satisﬁed. Then let
L be a line bundle on P whose square is τP/X . Since L ∼
= OP (σ) ⊗OS M (for a line bundle
M on S), and α always preserves σ, it follows that α preserves L. Thus, α arises from a
horizontal section of End(π∗ L) = OX ⊕ Ad(P ), hence is induced by multiplying π∗ L by a
section of OS . Thus, α is the identity, as desired. 
Finally, combining what we have done in this Section with Theorem 1.7, we obtain:
Corollary 2.9. Let f log : X log → S log be an r-pointed stable curve of genus g. Then
the set of crystalline Schwarz structures on X with nilpotent monodromy is in one-to-one
46

correspondence the set of isomorphism classes of indigenous P1 -bundles on X log . Moreover, the functor that assigns to T log → S log the set of crystalline Schwarz structures with
log ⊗2
) (−D).
nilpotent monodromy on XTlog = X log ×S log T log is a torsor over f∗ (ωX/S
Indigenous Bundles of Restrictable Type
Let filog : Xilog → S log (for i = 1, . . . , n) be an ri -pointed smooth curve of genus gi
(where 2gi − 2 + ri ≥ 1 for all i). Suppose that we are given a graph Γ consisting of n
vertices, numbered 1 through n. Let Ei be the set of edges of the ith vertex. Suppose
further that we are given an injection λi : Ei → {1, . . . , ri }. Then we can glue together
the curves filog : Xilog → S log to form an r-pointed stable curve f log : X log → S log of genus
g in such a way that the dual graph of f log is given by Γ, that is:
(1) vertex i corresponds to filog : Xilog → S log , an irreducible component of
X log ;
(2) if is an edge running from vertex i to vertex j such that λi ( ) = a
and λj ( ) = b, then corresponds to a node on X log obtained by gluing
together Xilog at the ath marked point to Xjlog at the bth marked point;
(3) g and r can be computed combinatorially from Γ, the gi ’s, the ri ’s and
the λi ’s.
: Xilog → X log be the inclusion of Xilog into X log as one of the irreducible
Let μlog
i
components.
Now let us suppose that we are given an indigenous bundle (π : P → X; ∇P ) on X log .
log
∗
Then it is not necessarily the case that (μlog
i ) (π : P → X; ∇P ) will be indigenous on Xi .
The problem is that since in general, marked points of Xilog might be sent to nodes of X log
(and not to marked points), there is no reason why the monodromy at such marked points
of Xilog should be nilpotent. We therefore make the following
log
∗
Deﬁnition 2.10. If the (μlog
for all i, then we
i ) (π : P → X; ∇P ) are indigenous on Xi
say that (π : P → X; ∇P ) is of restrictable type.

Now let us suppose that we are given indigenous bundles Πi = (πi : Pi → Xi ; ∇Pi )
on Xilog . Note that for each marked point s : S → Xi of an Xilog , s∗ Pi has a canonical
trivialization as a P1 -bundle given by considering:
(1) the Hodge section σi : Xi → Pi (pulled-back by s);
(2) the trivialization of s∗ (σi∗ ωPi /Xi ) given by the residue map; and
(3) the section qs : S → s∗ Pi of Proposition 1.6.
47

It thus follows that we can glue together the Πi ’s by means of this canonical trivialization
at the marked points to obtain an indigenous bundle Π = (π : P → X; ∇P ) on X log .
Moreover, by construction, Π is of restrictable type.
Also, we can clearly reverse the procedure: Namely, if we start with an indigenous
bundle Π on X log of restrictable type, we can reconstruct Π by restricting to the Xilog ’s,
and then regluing, in the fashion described in the preceding paragraph. Now let us deﬁne
n

(fi )∗ ω ⊗2log

def

E =

Xi

i=1

/S log

(−Di )

where Di is the divisor of marked points on Xi . Then we have the following result:
Proposition 2.11. The étale sheaf on S of isomorphism classes of indigenous P1 -bundles
of restrictable type on X log is a torsor over the vector bundle E.
Note that the rank of E is given by
than 3g − 3 + r.

n

i=1 (3gi − 3 + ri ), which, in general, is strictly less

§3. The Obstruction to Global Intrinsicity
In §2, we saw that the P1 -bundle P(J /J [3] ) is locally intrinsic on Mg,r . In this
Section, we study the obstruction (which, in general, is nonzero) to it being globally
intrinsic over all of Mg,r . The main point is a computation in Hodge cohomology which,
in many respects, is similar to that of [Falt3], Lemma IV.4. Since, however, it is not
literally the same as [Falt3], and certain technical aspects of the computation are diﬀerent,
we provide a complete proof here.
Introduction of Cohomology Classes
We shall work over a ﬁeld K of characteristic zero, say Qp , until we state otherwise.
Since we are only interested in certain intersection numbers, the base ﬁeld is essentially
irrelevant. Let us consider the universal r-pointed stable curve of genus g, ζ : C → Mg,r
(over K). We would like to consider various cohomology classes on C and Mg,r . The
cohomology theory that we will use is Hodge theory, so all cohomology classes are to be
understood as being Hodge-theoretic. Let π : P = P(J /J [3] ) → C be the P1 -bundle
which, as we saw in §2, is locally intrinsic. Let F = Ad(P ). Thus, F has a ﬁltration whose
subquotients are given by:
F1 ∼
= L; F 0 /F 1 ∼
= OC ; F −1 /F 0 ∼
= L−1
48

where L = ωC log /Mlog . Let η = c1 (L), the ﬁrst Chern class of L. Then we have: c1 (F) = 0.
g,r

On the other hand, the second Chern class of F is given by:
c2 (F) = −η 2

2
Let
r us compute ζ∗ η . Let Di ⊆ C (where i = 1, . . . , r) be the marked points. Let
D = i=1 Di . We shall write [Di ]; [D] for the respective cohomology classes on C. Let
ξ = c1 (ωC/Mg,r ). Thus, η = ξ + [D]. Since diﬀerent Di ’s do not intersect, we have
[Di ] · [Dj ] = 0 if i = j. Also, by “taking the residue,” we see that
ζ∗ {(ξ + [Di ]) · [Di ]} = 0,
r
for all i. Thus, ζ∗ {(ξ + [D]) · [D]} = 0. Let ψi = ζ∗ (ξ · [Di ]); ψ = i=1 ψi ; θ = ζ∗ ξ 2 . Then
we obtain:

ζ∗ η 2 = ζ∗ {(ξ + [D]) · ξ}
=θ+ψ
Now one knows from [AC] that for g ≥ 3, the restrictions of the classes θ and ψ to Mg,r
are linearly independent. We summarize this in a Lemma:
Lemma 3.1. We have, on Mg,r , ζ∗ η 2 = θ + ψ. In particular, if g ≥ 3, then (ζ∗ η 2 )|Mg,r
is nonzero.
We shall see below that ζ∗ c2 (F) can be related to the obstruction to the existence of a
global indigenous bundle on C. Thus, once we have done this, we will have proven that
this obstruction is given by the relatively computable cohomology class −ζ∗ η 2 on Mg,r .
Computation of the Second Chern Class
Let us ﬁrst observe that P |D has a canonical trivialization as a P1 -bundle given by
using:
(1) the Hodge section σ : C → P (restricted to D);
(2) the trivialization of (σ ∗ ωP/C )|D given by the residue map; and
(3) the section qs : D → P ×C D of Proposition 1.6.
Let us denote by Cclog the log stack obtained by letting C be the underlying stack and
log
taking for the log structure the pull-back of the log structure of Mg,r via ζ. Thus, we have
an exact sequence on C:
0 → ζ ∗ ΩMlog → ΩCclog → ωC/Mg,r → 0
g,r

49

where the ﬁrst two sheaves of diﬀerentials are over K. In the future, we shall think of this
exact sequence as deﬁning a one-step ﬁltration on ΩCclog . For i, j ≥ 0, let us deﬁne for any
OC -module G:
def

Hci,j (C, G) = H i (C, G ⊗OC ∧j ΩCclog )
This cohomology is a sort of cohomology with compact supports outside D. Thus, by using
the canonical trivialization of P |D referred to above, we see that the global obstruction to
the existence of a logarithmic connection on π : P → C (for the log structure of C log ) which
has normalized nilpotent monodromy at D deﬁnes a class κ ∈ Hc1,1 (C, Ad(P )). Now, by
taking the trace of the square of κ, we get a class in tr(κ2 ) ∈ Hc2,2 (C, OC ). If we then apply
log

def

ζ∗ , we get a class ζ∗ tr(κ2 ) ∈ H 1,1 (Mg,r ) = H 1 (Mg,r , ΩMlog ). On the other hand, let us
g,r

denote by:
S g,r → Mg,r
the ΩMlog -torsor deﬁned by looking at the crystalline Schwarz structures with nilpotent
g,r

log

monodromy on C (as in Corollary 2.9). This torsor thus deﬁnes a class Σ ∈ H 1,1 (Mg,r ).
The goal of this subsection is to prove the following:
log

Lemma 3.2. We have the following equality of classes in H 1,1 (Mg,r ): Σ = 12 ζ∗ tr(κ2 ).
Now let us note that Hc1,1 (C, Ad(P )) has two one-step ﬁltrations: one arising from
the Leray-Serre spectral sequence applied to ζ, and the other arising from the ﬁltration
deﬁned above on ΩCclog . Thinking in these terms, we see that we get a morphism:
φ00 : Hc1,1 (C, Ad(P )) → H 0 (Mg,r , R1 ζ∗ (Ad(P ) ⊗ ωC/Mg,r ))
Now since we know that P → C admits a connection of the desired type on the ﬁbers of ζ,
it follows that φ00 (κ) = 0.
Next let us consider the natural morphism:
φ10 : Hc1,1 (C, Ad(P )) → H 1 (C, Ad(P ) ⊗ ωC/Mg,r )
Since φ00 (κ) = 0, it follows from considering the Leray-Serre spectral sequence that φ10 (κ)
lies in H 1 (Mg,r , ζ∗ (Ad(P ) ⊗ ωC/Mg,r )) → H 1 (C, Ad(P ) ⊗ ωC/Mg,r ). In fact, by considering only normalized connections (as in Deﬁnition 1.10), we can say more. Namely, it
follows that φ10 (κ) is actually the image under the morphism H 1 (Mg,r , ζ∗ (ωC log /Mlog ⊗
g,r

ωC/Mg,r )) → H (Mg,r , ζ∗ (Ad(P ) ⊗ ωC/Mg,r )) (induced by ωC log /Mlog → Ad(P )) of the
1

g,r

50

class Σ (regarded as a class in H 1 (Mg,r , ζ∗ (ωC log /Mlog ⊗ ωC/Mg,r )) by means of the tautog,r
logical isomorphism Ω log ∼
)).
log ⊗ ω
= ζ∗ (ω
Mg,r

C/Mg,r

C log /Mg,r

Now let us consider the natural morphism:
φ01 : Hc1,1 (C, Ad(P )) → H 0 (Mg,r , R1 ζ∗ (Ad(P ) ⊗ ΩCclog ))
Since φ00 (κ) = 0, it follows that the section φ01 (κ) of R1 ζ∗ (Ad(P ) ⊗ ΩCclog ) lies in the
image of the natural map
ι : R1 ζ∗ (Ad(P ) ⊗ ΩMlog ) → R1 ζ∗ (Ad(P ) ⊗ ΩCclog )
g,r

In fact, we can say more. Since we are dealing with sheaves on Mg,r , we can compute
locally on Mg,r . Let U → Mg,r be étale. Let ∇P be a logarithmic connection with
normalized nilpotent monodromy (relative to ζU : CU → U ) on PU = P ×Mg,r U . Then the
obstruction to lifting ∇P to a logarithmic connection relative to CU → Spec(K) is giving by
subtracting the two pull backs of (PU → U ; ∇P ) to the ﬁrst inﬁnitesimal neighborhood ΔU
of the diagonal of U ×K U . Note that it only makes sense to compare these two pull-backs
because we have chosen a connection ∇P , so that we can deal with crystals on Crys(CU /ΔU )
(where the structure morphism CU → ΔU is given by composing ζU : CU → U with the
diagonal embedding U → ΔU ). Thus, the diﬀerence between the pull-backs deﬁnes a
section δ (over U ) of ΩMlog |U ⊗R1 (ζU )DR,∗ (Ad(P ), ∇P ). Now if we compose the projection
g,r

R1 (ζU )DR,∗ (Ad(P ), ∇P ) → R1 (ζU )∗ τC log /U log with δ, we get a morphism
U

(ΩMlog )∨ |U = ΘMlog |U → R1 (ζU )∗ τC log /U log
g,r

U

g,r

Now it is a tautology that this morphism is none other than the isomorphism β derived
log
from deformation theory of the tangent space to Mg,r with the ﬁrst cohomology group
of the relative tangent bundle of ζ log . Thus, in summary, we have proven the following
statement:
(*) locally on Mg,r , φ10 (κ) is the image under ι of some local section
ν of R1 ζ∗ (Ad(P ) ⊗ ΩMlog ) whose image in R1 ζ∗ (τC log /Mg,r ) ⊗ ΩMlog is
g,r

g,r

the tautological isomorphism β.
We are now ready to consider ζ∗ tr(κ2 ). We begin by using the observations of the
preceding two paragraphs to compute what happens when we multiply various subquotients
of the two ﬁltrations on Hc1,1 (C, Ad(P )) by each other:
(1) If we multiply two elements in the image of H 1 (Mg,r , ζ∗ (Ad(P )) ⊗
ΩMlog ), and take the trace, we get a (2, 2)-Hodge cohomology class on
g,r

51

C which is the pull-back of such a class on Mg,r ; thus, if we apply ζ∗ to
such a product, we get zero.
(2) If we multiply an element in the image of H 1 (Mg,r , ζ∗ (Ad(P ))⊗ΩMlog )
g,r

by an element in the image of H 0 (Mg,r , R1 ζ∗ (Ad(P ))⊗ΩMlog ), and take
g,r

the trace, we get a class in H 1 (Mg,r , R1 ζ∗ OC ⊗ ∧2 ΩMlog ); since there
g,r

are no factors of ωC/Mg,r in the wedge product, applying ζ∗ again gives
zero.
(3) If we multiply two elements of H 0 (Mg,r , R1 ζ∗ (Ad(P )) ⊗ ΩMlog ), we
g,r

get zero since ζ has relative dimension one.
(4) If we multiply an element in the image of H 1 (Mg,r , ζ∗ (Ad(P ))⊗ΩMlog )
g,r

by φ10 (κ) ∈ H (Mg,r , ζ∗ (Ad(P ) ⊗ ωC/Mg,r )), and take the trace, we get
zero, since we are taking the trace of the product of a nilpotent section
of Ad(P ) with a section of the same Borel subalgebra of Ad(P ).
1

(5) If we square φ10 (κ) ∈ H 1 (Mg,r , ζ∗ (Ad(P )⊗ωC/Mg,r )), we get zero since
we are, in eﬀect, squaring nilpotent sections of Ad(P ).
(6) If we multiply φ10 (κ) ∈ H 1 (Mg,r , ζ∗ (Ad(P ) ⊗ ωC/Mg,r )) by φ01 (κ) ∈

H 0 (Mg,r , R1 ζ∗ (Ad(P ) ⊗ ΩCclog )), then we are, in eﬀect, multiplying the
class Σ by the tautological isomorphism β, so that we obtain Σ, regarded
as a class in H 1 (Mg,r , ΩMlog ).
g,r

Thus, in summary, all of the possible contributions are zero, except for the last, which is
2Σ. This completes the proof of Lemma 3.2. On the other hand, by basic linear algebra,
c2 (Ad(P )) is −2 tr(κ2 ), so we see that we have, in fact, proven the following:
Lemma 3.3. We have ζ∗ c2 (Ad(P )) = −4Σ.
Finally, putting this together with Lemma 3.1, we see that we have explicitly computed
the class Σ in terms of well-known ﬁrst Chern classes of line bundles:
Theorem 3.4. The torsor of Schwarz structures deﬁnes a class Σ ∈ H 1 (Mg,r , ΩMlog )
g,r

which is equal to 14 (θ + ψ), where θ = ζ∗ ξ 2 ; ψ = ζ∗ (ξ · [D]); ξ = c1 (ωC/Mg,r ); and [D]
is the cohomology class of the divisor of marked points. In particular, if g ≥ 3, then (in
characteristic zero) Sg,r → Mg,r does not admit any sections, i.e., there are no canonical
Schwarz structures on r-pointed smooth curves of genus g ≥ 3.
Remark. Ideally, it would be nice to have an equality of classes not in H 1 (Mg,r , ΩMlog ),
g,r

but in some sort of cohomology with compact supports “Hc1 (Mg,r , ΩMlog )” (which should
g,r

52

be isomorphic to H 1 (Mg,r , ΩMg,r )). In order to do this, one would have to deﬁne some sort
of appropriate sense in which Σ is compactly supported, i.e., one would have to deﬁne some
sort of trivializations of S g,r → Mg,r at inﬁnity. In fact, S g,r → Mg,r does not (in general)
have a canonical section over the divisor at inﬁnity. However, by considering indigenous
bundles of restrictable type, one can show that, so to speak, “the more singular a curve gets,
the more of a canonical trivialization one has for S g,r → Mg,r .” For instance, if the curve
is totally degenerate, i.e., it can be constructed by gluing together (as at the end of §2) a
number of copies of P1 with three marked points, then S g,r → Mg,r does have a canonical
trivialization, as follows immediately from Proposition 2.11 (since then the indigenous
bundles of restrictable type form a torsor over the zero sheaf). Thus, in some sort of
combinatorially complicated sense, by considering indigenous bundles of restrictable type,
one can exhibit Σ as a cohomology class with compact supports. Unfortunately, however,
the combinatorics involved get rather complicated in general, so we shall not carry this
out explicitly, except in the case when the dimension of Mg,r is one, where things are not
so diﬃcult.
The Case of Dimension One
In this case, either g = r = 1 or g = 0, r = 4. Let D∞ ⊆ Mg,r be the divisor at
inﬁnity. Since D∞ is zero-dimensional, in this case we do have a canonical trivialization t∞
of S g,r → Mg,r over D∞ . Now we shall give a new deﬁnition of cohomology with compact
supports that takes into account this trivialization t∞ . Let ωC log (respectively, ω(Mlog ) ) be
g,r !

!

the subsheaf ωC/Mg,r (−D∞ ) (respectively, ωMlog (−D∞ )) of ωC/Mg,r (respectively, ωMg,r ).
g,r

Let ΩC log be the inverse image of ωC log ⊆ ωC/Mg,r via the morphism ΩCclog → ωC/Mg,r .
!
!
Thus, we have an exact sequence:
0 → ζ ∗ ΩMlog → ΩC log → ωC log → 0
g,r

!

!

which deﬁnes a ﬁltration on ΩC log . Then for i, j ≥ 0, let us deﬁne for any OC -module G:
!

def

H!i,j (C, G) = H i (C, G ⊗OC ∧j ΩC log )
!

and for any OMg,r -module H:
def

H!i,j (Mg,r , H) = H i (Mg,r , H ⊗OM

g,r

∧j ω(Mlog ) )
g,r !

Note that the push forward map ζ∗ naturally deﬁnes a morphism ζ∗ : H!2,2 (C, OC ) →
H!1,1 (Mg,r , OMg,r ). Now the obstruction to putting a logarithmic connection on P → C
with normalized nilpotent monodromy at the marked points and which is of restrictable
53

type at inﬁnity is given by a class κ! ∈ H!1,1 (C, Ad(P )). On the other hand, the torsor
S g,r → Mg,r together with the trivialization t∞ deﬁnes a class Σ! ∈ H!1,1 (Mg,r , OMg,r ).
By the same proof as before, we have Σ! = 12 ζ∗ tr(κ2! ). (In the present case, however,
one might remark that in the six types of product considered previously, the ﬁrst two types
(numbered (1) and (2)) of product vanish all the more trivially since they involve ∧2 ωMlog ,
which is zero.) Also, just as before, we have c2 (Ad(P )) = −2 tr(κ2! ). Thus, we obtain:

g,r

Theorem 3.5. In H!1,1 (Mg,r , OMg,r ) = K, we have
Σ! =

1
ζ∗ η 2
4

where η = c1 (ωC log /Mlog ).
g,r

Let us compute ζ∗ η 2 in the case g = 1, r = 1. First we introduce the classes θ = ζ∗ ξ 2 ;
ψ = ζ∗ (ξ · [D]); and λ = c1 (ζ∗ ωC/Mg,r ). By Grothendieck-Riemann-Roch, θ = 0. On the
other hand, sorting through the deﬁnitions, one sees that ψ = λ. Thus, we obtain that for
g = 1, r = 1:

Σ! =
log

1
λ
4

log

log

Next let N log : M1,1 [2] → M1,1 be the ﬁnite, log étale covering such that M1,1 [2]
is the moduli stack that parametrizes elliptic curves with level structure on the 2-torsion
points. Let
log

log

Λlog : M1,1 [2] → M0,4
be the log étale morphism given by sending an elliptic curve with a trivialization of its
two torsion to the four-pointed curve of genus zero of which the elliptic curve is a double
covering (with ramiﬁcation exactly at the four marked points). Moreover, Λlog admits a
log
section over any double covering of M0,4 (since the obstruction to such a section lies in
2
(M0,4 , Z/2Z)). Note that both N log and Λlog are, in fact, deﬁned over Z[ 12 ]. Also,
Het
note that (over Z[ 12 ]), we have an isomorphism Λ∗ S 0,4 ∼
= N ∗ S 1,1 obtained by pulling-back
and pushing forward indigenous bundles. We thus obtain the following result:
Theorem 3.6. When Mg,r is one-dimensional, the torsor S g,r → Mg,r does not admit
any section which is equal to t∞ over D∞ modulo any prime ≥ 5.
54

Proof.

We have (Σ! )1,1 = 14 λ1,1 , and λ1,1 = 12 c1 (ωMlog ), so (Σ! )1,1 = 18 c1 (ωMlog ). Thus,
1,1

∗

log

1,1

∗

is log étale, and N (Σ! )1,1 is an invertible multiple of Λ (Σ! )0,4 , it suﬃces to
since N
show that:
(1) in Hodge cohomology modulo p (for a prime p ≥ 5), Λ∗ c1 (ωMlog ) =
0,4

N ∗ c1 (ωMlog ) is nonzero; in fact, since Λlog admits a section over any
1,1

log

double covering of M0,4 , it suﬃces merely to show that c1 (ωMlog ) is
0,4

nonzero modulo p;
(2) the formation of H!1,1 (M0,4 , OM0,4 ) commutes with base change modulo
p (for p an odd prime).
But both (1) and (2) follow immediately from the fact that M0,4 is just P1 , with D∞ =
{0, 1, ∞}. (Note that there is a slight subtlety here in that (2) is not immediately obvious
for M1,1 since it is a stack; this is why we choose to verify the assertions of the Theorem
by means of M0,4 .) 

Appendix: Relation to the Complex Analytic Case
In this Appendix, we make the connection between the theory of Schwarz structures
discussed here and the classical notion of the Schwarzian derivative in complex analysis.
Let K be an algebraically closed ﬁeld of characteristic zero (such as, for instance, the
complex numbers C). Let X → Spec(K) be a smooth, proper, connected curve. Let
P = P(J /J [3] ) be the usual P1 -bundle on X, and let ∇P be a connection on P → X that
makes it indigenous. Then just as in §1, we can form the Schwarzian derivative:
#
2
D : OX
→ ωX/K

Then the purpose of this Appendix is to show that when X = P1 ; z is the standard rational
2
is trivialized by (dz)2 , then D(φ) is given (up to a factor of
function on P1 ; and ωX/K
two) by the classical formula for the Schwarzian derivative.
First, let us note that when X = P1 , there exists only one connection ∇P on π : P →
X that makes it indigenous. Indeed, this follows from the fact that Ad(P ) ⊗OX ωX/K has
no sections for degree reasons, plus the fact that the extension
0 → J [2] /J [3] → J /J [3] → J /J [2] → 0
does not split (since the extension class is the Hodge-theoretic ﬁrst Chern class c1 (ωX/K ),
which is nonzero). It thus follows that (P ; ∇P ) is necessarily isomorphic to the indigenous
55

bundle constructed in Example 1 of §2. Thus, P ∼
= X ×K X (where we regard the projection
to the second factor as the structure morphism to X); let us ﬁx such an isomorphism for
the rest of the discussion. Also, the Kodaira-Spencer morphism at the diagonal section
σΔ : X → X ×K X ∼
= P is an isomorphism. Let z be the standard rational function
on X. Let U ⊆ X be the complement of inﬁnity. Thus, z is regular on U . We shall
work mainly on U . For i = 1, 2, let pi : P ∼
= X ×K X → X be the projection to the ith
factor. Let ζ be the relative rational function on P |U → U given by p∗1 (z) − p∗2 (z). Let us
d
. Then clearly,
simply denote by ∇ the result of applying ∇P in the tangent direction dz
2
∇(ζ) = −1. Let η = 1/ζ. Thus, ∇(η) = η . Now if we regard P as P(J /J [3] ), and s is
a section given by [a dz, b (dz)2 ] (where a, b ∈ OX (V ), for some open V ⊆ U ), then we
have ζ(s) = a/b. Indeed, both sides of this equation deﬁne relative rational functions on
P |U → U . The right-hand side has a simple pole at the section [dz, 0 · (dz)2 ], which, by
computing residues as in the deﬁnition of the isomorphism of Proposition 1.4, corresponds
to the section ∞ × U . Thus, both sides of the equation have a simple pole at ∞ × U , and
the same 1-jet at σΔ , hence are equal. In particular, η(s) = b/a.
#
(V ). The 2-jet jφ of φ is given by φ dz + 12 φ (dz)2 .
Now suppose we are given φ ∈ OX
φ
Thus, if sφ is the section of P over V that is deﬁned by jφ , we have η(sφ ) = 2φ
 . Thus,
we compute:

(

φ 
) = ∇(η(sφ ))
2φ
= {∇(η)}(sφ ) + η(∇(sφ ))
= η 2 (sθ ) + D(φ) (dz)−2
=

(φ )2
+ D(φ) (dz)−2

2
4(φ )

Expanding the derivative on the left and rearranging terms, we get:
φ
(φ )2
(φ )2
−
−
} (dz)2
2φ
2(φ )2
4(φ )2
1 φ
3(φ )2
= {  −
} (dz)2
2 φ
2(φ )2

D(φ) = {

We have thus shown the following result:
Theorem A. On P1 , the Schwarzian derivative deﬁned at the end of §1 is equal to
one-half the classical Schwarzian derivative.
For a treatment of the classical Schwarzian derivative, we refer to [Lehto].

56

Chapter II: Indigenous Bundles in Characteristic p
§0. Introduction
In this Chapter, we study indigenous bundles in characteristic p. In particular, we will
be concerned with how these bundles interact with Frobenius. Our main tool for studying
this interaction will be the p-curvature. We begin in §1 by studying FL-bundles, which
are a special kind of rank two vector bundle with connection on a curve that corresponds
to a lifting of the curve modulo p2 . In §2, we deﬁne the Verschiebung map on indigenous
bundles to be the determinant of the p-curvature of the indigenous bundle. It turns out that
(essentially) indigenous bundles arise from FL-bundles precisely when their Verschiebung
vanishes. Since it is precisely this sort of indigenous bundle – which (following [Katz]) we
call nilpotent – that corresponds to an MF ∇ -object in the sense of [Falt], it is worthwhile
deﬁning and studying the moduli space N g,r of such bundles. In order to study N g,r , we
make two fundamental calculations (Theorems 2.3 and 2.13) concerning the Verschiebung.
The ﬁrst tells us that the Verschiebung is ﬁnite and ﬂat, of degree p3g−3+r , and the second
calculates the derivative the Verschiebung in terms of invariants of the indigenous bundle
which are easier to compute. In §3, we deﬁne the hyperbolic (higher genus) analogue of an
ordinary elliptic curve: namely, we say that a hyperbolic curve is hyperbolically ordinary
if it admits a nilpotent indigenous bundle at which the derivative of the Verschiebung is
an isomorphism. Using the general machinery developed in §2, we then do a number of
computations involving totally degenerate curves and elliptic curves which reveal that:
(1) the hyperbolically ordinary locus of Mg,r is open and dense (Corollary
3.8);
(2) if one applies the deﬁnition of ordinariness in terms of indigenous bundles to the case of elliptic curves, one recovers the classical deﬁnition of
an ordinary elliptic curve (Theorem 3.11); and
(3) (at least if g ≥ 3, and p is suﬃciently large then) each irreducible
component of N g,r that passes through a certain canonical nilpotent
indigenous bundle on a totally degenerate curve has degree ≥ 2 over
Mg,r ; thus, there is no canonical choice of a nilpotent indigenous bundle
on a generic r-pointed stable curve of genus g (Proposition 3.13).
We end the Chapter with the observation that (3) is interesting in the sense that it constitutes a deviation from the behavior that one might expect by analogy to the complex
case.

57

§1. FL-Bundles
In this Section, we develop the theory of a certain kind of rank two bundle, which we
call an FL-bundle, which arises from looking at the Cartier isomorphism of a curve. It
turns out that the space of such bundles can also be used to parametrize the inﬁnitesimal
deformations of a curve to Z/p2 Z. The material we present here is essentially “well-known”
(see, e.g., [Kato], §4), although our point of view is a little diﬀerent. Let p be a prime. Let
S be a noetherian scheme over Fp . Let us assume that we are given a ﬁne log structure on
S, and let us denote the resulting log scheme by S log . Let us denote the absolute Frobenius
([Kato], §4) of S log by ΦS log : S log → S log . Let f log : X log → S log be an r-pointed stable
curve of genus g (as in Chapter I, Deﬁnition 2.1, so 2g − 2 + r ≥ 1). In general, we
shall denote by means of a superscript “F ” the result of base-changing by ΦS log . Let
def
ΦX log /S log : X log → (X log )F = X log ×S log ,ΦSlog S log be the relative Frobenius.
Deformations and FL-Bundles
We begin by reviewing the Cartier isomorphism (as in [Kato], Theorem 4.12). Since
a curve is one-dimensional, this amounts to the existence of an exact sequence of sheaves
on X:
log
log F
→ (ΦX log /S log )−1 (ωX/S
) →0
0 → (ΦX log /S log )−1 OX F → OX → ωX/S
def

where the morphism in the middle is the exterior diﬀerentiation operator d. Let Q =
log
. Then note that since the above exact sequence is functorial with to based(OX ) ⊆ ωX/S
log
→ S log , the formation of Q is likewise functorial with respect to base-change.
change T
We would like to consider what happens to this exact sequence when it is tensored over
(ΦX log /S log )−1 OX F with (ΦX log /S log )−1 (τX log /S log )F . Let T = (ΦX log /S log )∗ (τX log /S log )F .
We then obtain (by using the long exact cohomology sequence for higher direct images)
the following two exact sequences of sheaves on S:
log
0 → OS → R1 f∗ Q ⊗OX T → R1 f∗ ωX/S
⊗OX T

0 → R1 f∗ (τX log /S log )F → R1 f∗ T → R1 f∗ Q ⊗OX T → 0
where we use the fact that f∗ (Q ⊗Φ−1

X log /S log

OX F

log
F
τX
log /S log ) → f∗ (ωX/S ⊗OX T ) = 0

by degree considerations. Now let us note that T has a natural logarithmic connection ∇T obtained by declaring the sections of the subsheaf (ΦX log /S log )−1 (τX log /S log )F ⊆
(ΦX log /S log )∗ (τX log /S log )F = T to be horizontal. Thus, by using the above exact sequences,
we can compute the ﬁrst de Rham cohomology module of T (where we always understand
T to be equipped with the connection ∇T ).
58

Proposition 1.1. We have an exact sequence:
0 → R1 f∗ (τX log /S log )F → R1 fDR,∗ (T ) → OS → 0
which is functorial with respect to base-change T log → S log . In particular, R1 fDR,∗ (T ) is
a vector bundle of rank 3g − 2 + r on S. Finally, R1 fDR,∗ (T ) ⊆ R1 f∗ (T ).
Let us denote by A the R1 f∗ (τX log /S log )F -torsor on S deﬁned by the above exact
sequence. Let Slog be a ﬁne log scheme whose underlying scheme is ﬂat over Z/p2 Z,
 log → Slog be an r-pointed stable curve of
and such that Slog ⊗ Z/pZ = S log . Let X
genus g lifting f log . Then for any r-pointed stable curve Y log → Slog of genus g that lifts
(X log )F → S log , we can associate a section θY of A as follows. Consider the obstruction
 log → Y log .
to lifting the relative Frobenius ΦX log /S log : X log → (X log )F to a morphism X
This deﬁnes a section θY of R1 f∗ (T ). Observe that θY is independent of the choice of lifting
 log . Indeed, this follows from the fact that locally, if one changes the lifting X
 log , the
X
log
obstruction cocycle will change by a derivation of X
applied to a function pulled-back
log F
via ΦX log /S log from (X ) . But this will always give zero. This proves that θY depends
only on Y log . Let us also observe that θY actually deﬁnes a section of R1 fDR,∗ (T ) ⊆
R1 f∗ (T ). Indeed, to see this, we reason as follows. We work with bianalytic functions,
as in Chapter I, §1. Then the inverse image via the relative Frobenius of O(X bi )F in OX bi
coincides with both iL {(ΦX log /S log )−1 OX F } and iR {(ΦX log /S log )−1 OX F }. Thus, the two
pull-backs (from the right and left) of θY to OXbi both correspond to the obstruction to
lifting iL {(ΦX log /S log )−1 OX F } = iR {(ΦX log /S log )−1 OX F } to a OS-ﬂat subalgebra (with log
structure) of OXbi . This shows that θY is horizontal.
log → Slog of (X log )F → S log . Then
Now suppose that we consider another lifting Z
the diﬀerence between the liftings Y log and Zlog naturally deﬁnes a section θY Z of the
vector bundle R1 f∗ (τX log /S log )F . It follows immediately from the deﬁnition of an obstruc
tion class that θY = θZ
+ θY Z . Thus, if there existed a lifting Y log such that θY is a
section of the subsheaf R1 f∗ (τX log /S log )F ⊆ R1 fDR,∗ (T ), then it would follow that there

exists another lifting Zlog such that θZ
= 0. Thus, the relative Frobenius would lift to a
log
log


morphism Ψ : X → Z . But then by pull-back, Ψ would induce a nonzero morphism
log F
log
of (ΦX log /S log )∗ (ωX/S
) into ωX/S
, which, by degree considerations, is absurd. Thus, we

1
conclude that no θY lies in R f∗ (τX log /S log )F ⊆ R1 fDR,∗ (T ). In other words, for every
lifting Y log , θY deﬁnes a section of A. Let D be the R1 f∗ (τX log /S log )F -torsor over S of
liftings of (X log )F → S log to Slog . Then, we see that we have deﬁned a canonical morphism
of R1 f∗ (τX log /S log )F -torsors
F :D→A
Since any morphism of torsors is necessarily an isomorphism, we see that we have proven
the following result: ([Kato], Theorem 4.12 (2))
59

Proposition 1.2. The canonical morphism F : D → A is an isomorphism.
Let (E, ∇E ) be a rank two vector bundle on X with a connection ∇E (relative to f log ).
Suppose that there exists a horizontal exact sequence
0 → T → E → OX → 0
Then this exact sequence deﬁnes a section η of R1 fDR,∗ (T ) over S.
Deﬁnition 1.3. We shall call (E, ∇E ) an FL-(vector) bundle if η maps to OS× ⊆ OS under
the map R1 fDR,∗ (T ) → OS of Proposition 1.1. We shall call a P1 -bundle with connection
(P, ∇P ) on X log an FL-(P1 )-bundle if it can be written étale locally on S as the P1 -bundle
associated to an FL-vector bundle.
Remark. The letters “FL” stand for Frobenius lifting. Since a FL-bundle deﬁnes a section
of the torsor A, it follows by Proposition 1.2 that it also deﬁnes a lifting Y log → Slog of
(X log )F → S log . Also, we shall see below (Corollary 1.5) that, at least if S is reduced, then
if a horizontal exact sequence as above exists, it is necessarily unique.
The p-Curvature of an FL-Bundle
Let us assume for the rest of the Section that p is odd. Throughout this Chapter
the notion of the p-curvature of a bundle with connection in characteristic p will play an
important role. We refer to [Katz], §5, 6; [Ogus], §1.2, 1.3 for basic facts concerning the
p-curvature. ([Katz], of course, does not handle the arbitrary “log-smooth” case, but the
deﬁnitions and proofs (of the properties that we will need) go through without change. At
any rate, on the sorts of curves that we are working with, the theory of [Katz], §5, 6, is
literally valid on an open, schematically dense subset, and many assertions can be checked
after restriction to such an open subset.) Let (E, ∇E ) be an FL-bundle. We would like
to compute the p-curvature of (E, ∇E ). The p-curvature P will be a horizontal section
of T ∨ ⊗OX Ad(E). Occasionally, we shall think of P as a morphism Ad(E) → T ∨ or a
morphism T → Ad(E) (using the fact that Ad(E) is self-dual). By abuse of notation, we
shall also refer to these morphisms by the notation P. Now, ﬁrst of all, since ∇E stabilizes
the ﬁltration T ⊆ E, by functoriality, P also respects this ﬁltration. Secondly, since T
and OX clearly have p-curvature zero, P not only respects the ﬁltration, but is nilpotent,
i.e., P : T → Ad(E) maps into the subbundle T ⊆ Ad(E) (given by endomorphisms of E
obtained by projecting E → OX , mapping OX to T , and then injecting T → E). Thus, P
basically amounts to a morphism from T to T , i.e., a section of f∗ OX = OS .
Proposition 1.4. Assume that p is odd. If (E, ∇E ) is an FL-bundle on X log , then
P : T → Ad(E) is given by multiplication T → T by −1, followed by the inclusion
T → Ad(E).
60

Proof. Since the universal example of an FL-bundle on an r-pointed stable curve of genus
g is given by the torsor A over Mg,r , which is smooth, it suﬃces to check the assertion after
restriction to a closed point of this universal A. Thus, we can assume that S = Spec(k),
where k is a ﬁnite ﬁeld. Then S has a canonical lifting to a ﬂat scheme over Z/p2 Z, namely,
S = Spec(W (k)/p2 W (k)) (where W (k) is the ring of Witt vectors with coeﬃcients in k),
 → S,
 we may
and S has a natural Frobenius lifting ΦS. Thus, for any smooth scheme U
 , that is, a S-linear

 → U
F
speak of a Frobenius lifting (mod p2 ) on U
morphism Φ : U
def 
whose reduction modulo p is the relative Frobenius U → U F of U = U
⊗ Z/pZ.

Now let us take U to be an aﬃne open subset U ⊆ X, at which f is smooth, and
 → S be a smooth lifting of U , and let t be a
which contains no marked points. Let U
local coordinate on U . By the interpretation of FL-bundles in terms of obstructions to
Frobenius liftings, we may compute E by using as follows: Over U , E|U ∼
= T |U ⊕ OU .
Let us write sections of E relative to the decomposition T |U ⊕ OU and the basis given
by (Φ−1
( d )F , 0); (0, 1) ; and let us denote by ∇ the connection ∇E applied in the
X log /S log dt
d
. Then ∇ is given by adding to the direct sum connection the matrix
direction dt



0

1 
pΦ

0

0

where the map Φ is the derivative (with respect to t) of some local Frobenius liﬁng
 . Since tF → (1 + t)p − 1 is a Frobenius lifting, Φ(tF ) must be of the form
Φ on U
(1+t)p −1+f (t), for some function f (t) on U . Therefore, p1 Φ is of the form (1+t)p−1 +f  (t).
This gives ∇(1, 0) = 0; ∇(0, 1) = ((1 + t)p−1 + f  , 0). Therefore, (∇)p (1, 0) = 0 and
d p
∇p (0, 1) = (p − 1)!(1, 0) (since ( dt
) f = 0). Finally, it follows easily from using the fact
×
that Fp is a cyclic group that (p − 1)! = −1 (in Fp ). This completes the proof. 
Corollary 1.5. Assume that p is odd. Let (E, ∇E ) be a rank two vector bundle with
logarithmic connection on X log (over S log ) deﬁned by a section η of R1 fDR,∗ (T ). Then
(E, ∇E ) is an FL-bundle if and only if its p-curvature is nonzero at some point of every
ﬁber of f : X → S.
Proof. The “only if” part follows from Proposition 1.4. On the other hand, suppose that
the image of η under the map R1 fDR,∗ (T ) → OS of Proposition 1.1 vanishes at a point.
By restricting to that point, we may assume that S is the spectrum of a ﬁeld, and that
the image of η in OS vanishes identically. But then, it follows from the exact sequence
of Proposition 1.1 that (E, ∇E ) is the pull-back of a bundle under Frobenius. Then its
p-curvature must vanish identically, which contradicts our assumption. 
Corollary 1.6. Assume that p is odd and that S is reduced. Let (E, ∇E ) be an FL-bundle.
Let U ⊆ X be an open subset; (L, ∇L ) be a line bundle with logarithmic connection on U log ;
61

and ι : L → E|U be a horizontal morphism of OU -modules with logarithmic connections.
Then ι factors through the injection T |U → E|U in the deﬁnition of E as an FL-bundle.
Proof. By shrinking U , we may assume that f : X → S is smooth on U , and that U
stays away from the marked points. We may also assume that the composite of ι with the
projection E|U → OU is an isomorphism. Thus, we obtain a horizontal isomorphism of
line bundles L → OU . But this implies that (L, ∇L ) has p-curvature zero. Thus, we get
a horizontal isomorphism L ⊕ T |U → E|U . Since the left-hand side has p-curvature zero,
the same is true of the right-hand side. But this contradicts Proposition 1.4. 
Remark. It is not diﬃcult to construct counterexamples to Corollary 1.6 if one does not
assume that S is reduced.
§2. The Verschiebung on Indigenous Bundles
In this Section, we deﬁne a “Verschiebung” morphism on the space S g,r of Schwarz
structures that takes values in the space of square diﬀerentials (twisted by Frobenius). We
then prove various basic properties of this morphism, such as computing its derivative.
This computation reveals that the derivative looks rather like the Verschiebung morphism
for the Jacobian of the curve, thus justifying the terminology. On the other hand, as
we shall see in §3, unlike the Verschiebung of the Jacobian which only pertains to H 1
of the curve, the Verschiebung on indigenous bundles pertains to a nonabelian invariant
of the curve, namely, the nilpotent indigenous bundles on the curve. It turns out that
the study of nilpotent indigenous bundles, and thus of the Verschiebung on indigenous
bundles are central to understanding uniformization theory in the p-adic context. In this
Section, Mg,r (respectively, S g,r ) will denote the moduli stack of r-pointed curves of genus
g (respectively, equipped with a Schwarz structure) over Fp . We assume throughout this
Section that p is odd.
The Deﬁnition of the Verschiebung
Let S log be a ﬁne noetherian log scheme over Fp . Let f log : X log → S log be an rpointed stable curve of genus g. Let D ⊆ X be the divisor of marked points. Let (E, ∇E )
be an indigenous bundle on X log (see §2 of Chapter I for more on such bundles). We
remark here that throughout this paper, when we do various manipulations with indigenous
bundles, it will be simpler to work with vector bundles, rather than P1 -bundles. Of course,
indigenous vector bundles only exist under certain conditions (cf. Proposition 2.6 of Chapter I), but this will not pose any problem, since we can always either Zariski localize on the
curve, or pass to some sort of covering of the curve, and then descend for the ﬁnal result.
Thus, in the future, for the rest of the paper, we shall act as if this problem does not exist,
and always work with indigenous vector bundles, when it is technically more comfortable
to do so.
62

We maintain the notation of §1 for the various Frobenius morphisms and for T =
(ΦX log /S log )∗ (τX log /S log )F . Let PE : T → Ad(E) be the p-curvature of (E, ∇E ). Consider
the composite of PE with its dual PE∨ . This composite is a horizontal morphism T → T ∨ ,
log ⊗2 F
hence deﬁnes a section of (f∗ (ωX/S
) ) . Let VE be − 12 times this section. Another way
to put the deﬁnition of VE is as follows: We consider the square (PE )2 : (T )⊗2 → End(E)
of PE , take the trace, and multiply by − 12 . Yet another way to put the deﬁnition of VE is
that it is the determinant of PE (regarded as a map (T )⊗2 → OX ).
Proposition 2.1. Assume that S is reduced. Then VE is zero if and only if the image of
PE consists of nilpotent endomorphisms of E.
Proof. Immediate from the deﬁnitions. 
Thus, we may think of VE as a measure of how nilpotent PE is. Note, in particular, that at
a marked point, by deﬁnition ∇E has nilpotent monodromy, so the p-curvature is already
nilpotent there. Thus, VE has zeroes at all the marked points. By abuse of notation, we
log ⊗2
) (−D))F .
shall denote by VE the resulting section of (f∗ (ωX/S
log ⊗2
Deﬁnition 2.2. We shall refer to the section VE of (f∗ (ωX/S
) (−D))F as the Verschiebung of the indigenous bundle (E, ∇E ).

log

Thus, in the universal case, when f log : C log → Mg,r is the universal r-pointed stable curve
of genus g, we obtain a morphism of Mg,r -schemes:

V g,r : S g,r → Qg,r
where Qg,r is the geometric vector bundle corresponding to (i.e., Spec of the symmetric
log ⊗2
) (−D))F . Note that both S g,r and Qg,r are of dimension
algebra of the dual of) (f∗ (ωX/S
3g−3+r over Mg,r . The rest of this Chapter will be devoted to studying this Verschiebung
morphism V g,r .
Let us begin with some observations concerning the degree of V g,r as a polynomial
map. Let ∇E = ∇E + θ be a logarithmic connection on E that makes it an indigenous
bundle; here we may assume that θ is an Ad(E)-valued diﬀerential which deﬁnes a squarenilpotent endomorphism of E and which corresponds to a square diﬀerential θ SD . Thus,
θ 2 = 0. If we then compute the p-curvature of (E, ∇E ) by, say, working locally on U ⊆
X where there is a local coordinate x, and letting ∇ (respectively, ∇ ; θx ) denote ∇E
def

d
(respectively, ∇E ; θ) applied in the direction ∂ = dx
, we note that because θx2 = 0, all the
terms that involve θx more than 12 (p + 1) times must vanish. Moreover, there is only one
term that involves θx exactly 12 (p + 1) times, namely:

63

θx ∇ θx ∇ . . . ∇ θx
that is, alternating θx ’s and ∇’s, with a total of 12 (p + 1) copies of θx and 12 (p − 1) copies
of ∇. For future reference let us call this term ξ. Note that since θx2 = 0, any string
θx ∇ θx can be rewritten θx [∇, θx ] (where the brackets denote the commutator), and
that this commutator [∇, θx ] is a linear operator (that is, linear over OX ). Moreover, this
linear operator [∇, θx ] preserves the Hodge ﬁltration of E. Thus, ξ may be rewritten as θx
times [∇, θx ] to some power. Since [∇, θx ] preserves the Hodge ﬁltration, it thus follows
that ξ is a linear operator on E which is nilpotent with respect to the Hodge ﬁltration. In
particular, ξ 2 = 0. At any rate, we may at least conclude that in the expression for the
trace of the square of the p-curvature of ∇E , θ occurs no more than p times in each term.
We thus obtain the following result:
(*) Relative to the aﬃne structures of S g,r and Qg,r , the pull-backs of
the aﬃne variables on Qg,r via the morphism V g,r are polynomials in
the aﬃne variables of S g,r of degree ≤ p.
In fact, we would like to conclude a stronger result, namely that the degree is exactly
p. In order to do this, we need to enlist the aid of Jacobson’s formula (see, e.g., [Jac],
pp. 186-187): This formula states that if a and b are elements of an associative ring R of
characteristic p, then

p

p

p

(a + b) = a + b +

p−1


si (a, b)

i=1

where the si (a, b) are given by the formula:

p−1

(ad(ta + b))

(a) =

p−1


isi (a, b)ti−1

i=1

computed in the ring R[t], where t is an indeterminate. In our case, we let b = ∇ and
a = θx , and we wish to compute the sj (a, b), where j = 12 (p − 1). Let η be the coeﬃcient
multiplying tj−1 in the expression (ad(ta + b))p−1 (a). Let α = ad(a); β = ad(b). Then the
terms in η look like 12 (p − 3) copies of α and 12 (p + 1) copies of β applied to a in some order.
Now ultimately, in order to compute the Verschiebung, we are interested in computing
tr(η · ξ). Let τ be one of the terms that make up η. Now we separate the analysis of τ into
two cases: the case where τ begins with an α, and the case where τ begins with a β.
Suppose that τ begins with an α. Thus, τ looks like
α γ1 . . . γp−2 a
64

where each γi is either α or β. Now let us note that when one applies α = ad(θx ) or
β = ad(∇) to a linear operator on E, one gets back a linear operator. Moreover, α applied
to any linear operator on E yields a linear operator that preserves the Hodge ﬁltration on
E. Thus, we conclude that τ is a linear operator on E that preserves the Hodge ﬁltration.
Since ξ is nilpotent with respect to the Hodge ﬁltration, it thus follows that tr(τ · ξ) = 0.
Now suppose that τ begins with a β:
β γ1 . . . γp−2 a
Let us denote by σ the linear operator on E given by γ1 . . . γp−2 a (i.e., we leave oﬀ the
initial β). We would like to show that σ preserves the Hodge ﬁltration on E. To see this,
ﬁrst note that among the γi ’s, the number of β’s is exactly one greater than the number of
α’s. Also, note that (by Griﬃths transversality) relative to the Hodge ﬁltration on Ad(E),
applying β decreases the ﬁltration index l (in F l (Ad(E))) by at most one, while applying
α always increases the ﬁltration index l by one. Thus, since a = θx ∈ F 1 (Ad(E)), it
follows that σ ∈ F 0 (Ad(E)), i.e., it ﬁxes the Hodge ﬁltration on E, and so σ · ξ is nilpotent
with respect to the Hodge ﬁltration. In particular, tr(σ · ξ) = 0. Since the trace map is
horizontal, we thus obtain that tr([∇, σ · ξ]) = 0. Therefore, when we multiply τ = β(σ)
by ξ and take the trace, we get
tr(τ · ξ) = tr([∇, σ · ξ]) − tr(σ · [∇, ξ])
= −tr(σ · [∇, ξ])
In other words, tr(τ · ξ) depends only on the images of σ and [∇, ξ] in F 0 /F 1 (Ad(E)).
To compute the image of σ in F 0 /F 1 (Ad(E)), we must analyze σ in greater detail.
Now we saw that when we compute σ by applying α’s and β’s to a, β decreases the ﬁltration
index by at most one. The only time it fails to decrease the ﬁltration index by one is when
it is applied to a linear operator which already has a nontrivial image in F −1 /F 0 (Ad(E)).
If this should occur even once, then the net change in the ﬁltration index as a result of
applying all the γi ’s (in the computation of σ) to a is ≤ 0. Thus, if this occurs even once,
σ ∈ F 1 (Ad(E)), so tr(σ · [∇, ξ]) = 0. On the other hand, if, during the calculation of σ, we
apply α to a linear operator in F 1 (Ad(E)), we get zero. Let us call the case where neither
of these two phenomena ever occurs the nondegenerate case. Thus, only the nondegenerate
terms τ will make a nonzero contribution.
Let us suppose that τ is nondegenerate. Then in order to compute the image of σ in
F 0 /F 1 (Ad(E)), it suﬃces to merely keep track of the leading term (relative to the Hodge
ﬁltration on Ad(E)) as we apply the various γi ’s. Now let us note that it follows from
the fact that the Kodaira-Spencer morphism for the Hodge ﬁltration on E is the identity
that if l ≥ 1, then applying β to a linear operator L in F l (Ad(E)) yields a linear operator
in F l−1 (Ad(E)) whose image in F l−1 /F l (Ad(E)) is the image of L in F l /F l+1 (Ad(E))
times ∂. On the other hand, if l ≤ 1, then applying α to a linear operator L in F l Ad(E)
yields a linear operator in F l+1 (Ad(E)) whose image in F l+1 /F l+2 (Ad(E)) is the image
65

of L in F l /F l+1 (Ad(E)) times θ SD · ∂. Thus, if τ is nondegenerate, then its contribution
−tr(σ · [∇, ξ]) is given by (θ SD · ∂)p · (∂)p .
It remains to compute the number of nondegenerate terms τ . Let us call this number
Np , and regard it as an element of Fp . We are interested in whether or not Np ∈ Fp is
zero. Although one can presumably compute Np explicitly using some sort of combinatorial
argument, we prefer to take the following approach. Note that Np does not depend on
g or r or on the particular curve f log : X log → S log , but only on p. Thus, it suﬃces to
show that (for each odd prime p) Np = 0 for one particular curve (with g and r arbitrary).
We shall do this in §3 when we do various computations with elliptic curves. Thus, we
log ⊗2
) (−D))F ), when applied to (∂ F )2 yields
obtain that VE (which is a section of (f∗ (ωX/S
the function c · (θ SD · ∂)p · (∂)p , where c ∈ F×
p . Put another way, the degree p component
of V g,r is a morphism:
[p]

log ⊗2
log ⊗2
V g,r : {(f∗ (ωX/S
) (−D))∨ }F → Sp (f∗ (ωX/S
) (−D))∨

which is equal to c times the Frobenius morphism, i.e., the pth -power map. We shall see
later in our computations with elliptic curves that c = −1. Thus, we thus obtain the
following important result:
Theorem 2.3. Relative to the aﬃne structures of S g,r and Qg,r , the pull-backs of the
aﬃne variables on Qg,r via the morphism V g,r are polynomials in the aﬃne variables of
[p]

S g,r of degree exactly p, with the leading term V g,r (i.e., the degree p component) given
by −1 times the pth -power map. In particular, V g,r is a ﬁnite, ﬂat morphism of degree
p3g−3+r .
Proof. It remains to verify the last assertion (that V g,r is ﬁnite and ﬂat of the right degree).
Let U = Spec(A) → Mg,r be étale. Then over U , we may choose aﬃne coordinates Xi
and Yj of S g,r and Qg,r so that V g,r looks like (the map induced on Spec’s by):
def

def

B = A[Y1 , . . . , Y3g−3+r ] → C = A[X1 , . . . , X3g−3+r ]
where Yi → fi (X1 , . . . , X3g−3+r ), and fi is of the form “−Xip plus terms of lower degree.”
Then it is easy to see that, as a B-module, C is generated by monomials of the form


3g−3+r

Xiei

i=1

where 0 ≤ ei ≤ p − 1. In particular, C is a ﬁnite B-module, so V g,r is ﬁnite. Since V g,r is
a ﬁnite morphism between regular algebraic stacks of the same dimension, it follows from
commutative algebra that V g,r is ﬂat. To compute the degree of V g,r , let P = ProjA (C[T ])
66

(with the grading such that T and the Xi ’s have degree one). Then Spec(C) ⊆ P is an
aﬃne open subset. Let Si ⊆ P be the hypersurface which is the closure of the zero
locus of fi . Then the scheme-theoretic intersection V of all the Si ’s has degree p3g−3+r
over Spec(A). Also, the intersection of V with P − Spec(C) = V+ (T ) = Proj(C) is just
p
) ⊆ Proj(C), which is the empty set. Thus, V ⊆ Spec(C), and so
V+ (X1p , . . . , X3g−3+r
deg(V g,r ) = deg(V → Spec(A)) = p3g−3+r . 
Before continuing, we introduce some more terminology that will be of use in the
future:
Deﬁnition 2.4. Let (E, ∇E ) be an indigenous bundle on X log . Then, we will say that
(E, ∇E ) is nilpotent if VE is zero. We will say that (E, ∇E ) is admissible if PE∨ : Ad(E) → T ∨
is surjective.
Note that the terminology of a “nilpotent indigenous bundle” that we have introduced
here is (by Proposition 2.1) consistent with that of [Katz]. Also, let us observe that the
nilpotent bundles form a closed subscheme
N g,r ⊆ S g,r
while the admissible bundles form an open subscheme
adm

S g,r ⊆ S g,r
adm

adm

We shall see later in this Chapter that S g,r
N g,r is nonempty and that neither S g,r nor
N g,r is contained in the other. Note, further, that Theorem 2.3 implies that the natural
morphism
N g,r → Mg,r
is ﬁnite and ﬂat of degree p3g−3+r .
Finally, we observe that one thing which is interesting about nilpotent indigenous
bundles is that (if S is the spectrum of a perfect ﬁeld, then) by a result of [Falt] such
indigenous bundles arise as the crystalline Dieudonné modules of certain ﬁnite, ﬂat group
schemes on X log . This point of view will be pursued further in later chapters. This
observation is the main reason for studying N g,r and V g,r , which is the goal of the present
Chapter.

67

The p-Curvature of an Admissible Indigenous Bundle
As a prélude to ﬁnding out more about V g,r , it is worth looking at various basic
properties of the p-curvature of an admissible indigenous bundle.
Proposition 2.5. There is a bijective correspondence between nilpotent, admissible indigenous bundles (up to tensor product with a line bundle of order two) and FL-bundles
whose projectivizations are indigenous given as follows: If (E, ∇E ) is a nilpotent, admissible indigenous bundle on X log , let PE : T → Ad(E) be its p-curvature. Then the kernel of
PE∨ : Ad(E) → T ∨ is an FL-bundle.
Moreover, if (E, ∇E ) is a nilpotent, admissible indigenous bundle on X log , there exists
a unique rank one subbundle M ⊆ E that is annihilated by the endomorphisms in the image
of PE . This subbundle M is stabilized by ∇E . The induced connection ∇M has p-curvature
zero, and we have a horizontal isomorphism M⊗2 ∼
=T.
Finally, suppose that S is reduced, and (E, ∇E ) is nilpotent, admissible, and indigenous. Let U ⊆ X be an open set, and (L, ∇L ) a line bundle with logarithmic connection
(with respect to f log : X log → S log ) on U . Let ι : L → E|U be a horizontal morphism.
Then ι factors through M ⊆ E.
Proof. First of all, since (E, ∇E ) is admissible, PE∨ is surjective, and thus its kernel is a
rank two vector bundle F which is stabilized by ∇E , hence gets a connection ∇F . Since
(E, ∇E ) is nilpotent, it follows that T ∼
= Im(PE ) ⊆ F, and that this inclusion T → F
is locally split. Also, this inclusion T → F is necessarily horizontal, and we also have a
horizontal isomorphism F/T ∼
= OX . Thus, in order to show that (F, ∇F ) is an FL-bundle,
it suﬃces to show that the p-curvature of (F, ∇F ) is nonzero generically on every ﬁber of
f : X → S (by Corollary 1.5). Thus, we may assume that S is the spectrum of a ﬁeld.
Now on some nonempty open set U ⊆ X, there is line bundle with connection (L, ∇L )
and a horizontal surjection μ : E → L such that Im(PE |U ) is given by endomorphisms that
vanish on Ker(μ) and whose image is in Ker(μ). Then sorting through what we have done,
we see that we have a horizontal isomorphism F|U ∼
= E|U ⊗ L−1 . Since L has p-curvature
zero, the fact that E|U has nonzero p-curvature implies that the same is true of F|U . This
completes the proof that (F, ∇F ) is an FL-bundle.
On the other hand, if we are given an FL-bundle (F, ∇F ) whose projectivization
(P, ∇P ) is indigenous, let (E, ∇E ) be an indigenous vector bundle whose projectivization is
(P, ∇P ). Then there exists a line bundle with connection (L, ∇L ) (relative to f log : X log →
S log ) such that we have a horizontal isomorphism F ⊗OX L ∼
= E. Taking determinants,
∨
T
we thus get a horizontal isomorphism L⊗2 ∼
,
so
the
p-curvature
of L must be zero.
=
Thus, under the natural identiﬁcation of Ad(F) with Ad(E), we see that the p-curvatures
of (E, ∇E ) and (F, ∇F ) coincide. Thus, by our computation in Proposition 1.4, (E, ∇E ) is
admissible and nilpotent. Also, it is easy to see that these two procedures are inverse to
one another, thus proving the bijective correspondence. We take M ⊆ E to be T ⊗ L ⊆
68

F ⊗L∼
= E. The remaining assertions follow immediately from what we have done so far,
plus Proposition 1.6. 
Proposition 2.6. Let (E, ∇E ) be an indigenous bundle on X log . Let PE : T → Ad(E) be
its p-curvature. Then:
(1) We shall call the composite HE : T → τX log /S log of PE with the projection E → τX log /S log arising from the Hodge ﬁltration on E the square
Hasse invariant of (E, ∇E ). If (E, ∇E ) is admissible, then HE is nonzero.
(2) Suppose that (E, ∇E ) is admissible. Then the zero locus V (HE ) ⊆ X is
a divisor DE which is ﬁnite, ﬂat, and of degree (p − 1)(2g − 2 + r) over
S. We shall call it the double supersingular divisor of (E, ∇E ).
(3) Suppose that the indigenous bundle (E, ∇E ) is admissible and nilpotent.
Then there exists a line bundle H on X whose square H⊗2 is isomorphic
to T ∨ ⊗ τX log /S log , together with a section χ of H over X whose square
is HE . We shall call χ the Hasse invariant of (E, ∇E ). In particular,
there exists a divisor EE ⊆ X such that DE = 2 EE . We shall call EE
the supersingular divisor of (E, ∇E ).
(4) Suppose that S is reduced. Then any two nilpotent, admissible indigenous bundles with the same supersingular locus are isomorphic.

Proof. For (1), it suﬃces to prove the statement after we restrict to a ﬁber of f : X → S;
thus, we may assume that S is the spectrum of a ﬁeld. If HE were zero, then that would
mean that Im(PE ) lands in F 0 (Ad(E)). Now F 0 (Ad(E)) surjects onto OX . If the image
of PE in OX is nontrivial, we get a contradication as follows: On the one hand, Im(PE )
is stabilized by ∇E . On the other hand, the fact that the Kodaira-Spencer morphism of
the Hodge ﬁltration is an isomorphism means that ∇E applied to Im(PE ) will not be in
log
F 0 (Ad(E)). If the image of PE in OX is trivial, then it must lie in F 1 (Ad(E)) ∼
= ωX/S .
Then, by using the fact that the Kodaira-Spencer morphism is an isomorphism, we again
get a contradiction. Assertion (2) follows immediately from (1).
Now suppose that (E, ∇E ) is nilpotent, admissible, and indigenous. Let M ⊆ E be the
rank one subbundle of Proposition 2.5. Let E → N be the surjection arising from the Hodge
ﬁltration. Then composing the injection M → E with this surjection, we get a morphism
χ : M → N , whose square (under the identiﬁcations M⊗2 ∼
= T ; N ⊗2 ∼
= τX log /S log ) is equal
to the Hasse invariant. Thus, if we let EE be the zero locus of χ, we have DE = 2 EE .
This proves (3).
To prove (4), we assume that S is the spectrum of a ﬁeld, and that we have two
connections ∇E and ∇E on E, both of which make E a nilpotent, admissible indigenous
bundle, and such that the respective supersingular divisors EE and EE coincide. Let us also
69

assume that ∇E = ∇E + θ, where θ is a square diﬀerential. Let ι : M → E and ι : M → E
be the respective inclusions, and χ : M → N and χ : M → N the respective composites
discussed in the preceding paragraph. We claim ﬁrst of all that M and M are isomorphic.
Indeed, this follows from the fact that N ⊗ M−1 ∼
= N ⊗ (M )−1 .
= OX (EE ) = OX (EE ) ∼
Thus, we shall henceforth identify M and M . Now χ and χ diﬀer by multiplication by
a section λ of OS , that is, χ = λ · χ . Let i1 : M → E be ι, and let i2 : M → E be ι
multiplied by λ. Then it follows that there exists a morphism α : M → F 1 (E) such that
i1 = i2 + α. Now let s be a horizontal section of M (over some open set U ⊆ X). Since
the p-curvature is a horizontal morphism, ∇E (i1 (s)) = 0 and ∇E (i2 (s)) = 0. Thus, we
compute:
∇E (i2 (s)) = (∇E + θ)(i1 (s) + α(s))
= ∇E (α(s)) + θ(i1 (s))
Suppose that α is nonzero. Then in the last line, the ﬁrst term has a nonzero image under
the surjection E → N (since the Kodaira-Spencer morphism is an isomorphism), while
the second term lies in F 1 (E). Since the sum of these terms is zero, we thus obtain a
contradiction. Thus, α must be zero. Then we obtain that θ(i1 (s)) = 0, so (if θ = 0, then)
i1 maps into F 1 (E) ⊆ E. But then χ = 0, so by (2), we again obtain a contradiction. This
completes the proof of (4). 
Proposition 2.7. Suppose that S is reduced. Let (E, ∇E ) be admissible indigenous on
X log . Let PE : T → Ad(E) be the p-curvature. Let U ⊆ X be open, and let (L, ∇L ) be a
line bundle with logarithmic connection (relative to f log ) on U whose p-curvature is zero.
Let ι : L → Ad(E) be a horizontal morphism. Then ι factors through T ∼
= Im(PE ).
Proof. By shrinking U , we may assume that L and T |U have horizontal generating sections
s and t, respectively. We may assume that s and t generate a subbundle G ⊆ Ad(E)|U of
rank two. If we take their commutator in Ad(E), we see that [s, t] must be in G. Indeed, if
this were not the case, then the p-curvature of Ad(E) would be zero. But the p-curvature
of Ad(E) is given by Ad(PE ) which is nonzero everywhere since (E, ∇E ) is admissible. This
proves the claim. Thus, G is a Lie subalgebra of Ad(E), stabilized by the connection on
Ad(E) and whose p-curvature is zero. Being of rank two, it is necessarily solvable, hence
contains a nilpotent subalgebra K ⊆ G which is stabilized by the connection on Ad(E)
and has p-curvature zero. Now K deﬁnes a horizontal ﬁltration N ⊆ E|U with respect
to which it is nilpotent. Since (N )⊗2 ∼
= K, it follows that N has p-curvature zero. Let
δ : End(E|U ) → Ad(E)|U be the canonical projection given by quotienting out by the scalar
endomorphisms. Then clearly the image of N ⊗ E|U ⊆ End(E|U ) (i.e., the endomorphisms
that anihilate N ⊆ E|U ) under δ is equal to G. Since G and N have p-curvature zero,
it thus follows that E|U has p-curvature zero, which contradicts the fact that (E, ∇E ) is
admissible. 
Proposition 2.8. Suppose that f log is obtained by gluing together various filog , as in
70

the last subsection of Chapter I, §2. Suppose that (E, ∇E ) is nilpotent, admissible, and
indigenous on X log . Then it is automatically of restrictable type.
Proof. The subbundle M ⊆ E (of Proposition 2.5) is stabilized by E and has p-curvature
zero. Thus, if we restrict to an irreducible component Xilog , the monodromy at any marked
point of Xilog must be nilpotent with respect to the ﬁltration deﬁned by M ⊆ E. This
completes the proof. 
As mentioned earlier, the reason that we are interested in nilpotent, admissible indigenous bundles is that they deﬁne MF ∇ -objects in the sense of [Falt]. Let us suppose that
S = Spec(k), where k is a perfect ﬁeld, and that f : X → S is smooth. Let S = Spec(A),
where A = W (k)/p2 W (k), and W (k) is the ring of Witt vectors with coeﬃcients in k. Let
 We suppose that S and S are
us denote by ΦA the canonical Frobenius morphism on S.
endowed with the trivial log structures, and call the resulting log schemes S log and Slog ,
 log → Slog be a smooth r-pointed curve of genus g that lifts f log .
respectively. Let flog : X
 ⊆X
 be
Let (E, ∇E ) be an indigenous bundle on X log . Let E = F 1 (E) ⊕ (E/F 1 (E)). Let U
 log → U
 log be a lifting of Frobenius. If e is a section of E,
an open subset, and let Φlog : U
Φ
∗
1
let ∇E (e) be the section of Φ (E/F (E)) ⊗ ωU log /S log obtained by applying ∇E to e (and
regarding the result modulo F 1 (E) ⊗ ωU log /S log ) to get a section of (E/F 1 (E)) ⊗ ωU log /S log ,
then pulling back by Φ on E and by p1 dΦ on ωU log /S log . Then we can deﬁne a logarithmic
connection ∇Φ on Φ∗ (EF ) by letting ∇Φ (Φ−1 (0, eF )) = 0 (if e is a section of E/F 1 (E))
1
and ∇Φ (Φ−1 (eF , 0)) = (0, ∇Φ
E (e)) (if e is a section of F (E)). Then, it is easy to see (as
in [Falt], §2) that for diﬀerent Φ, the pairs (Φ∗ (EF )|U , ∇Φ ) glue together to form a bundle
with connection F∗ (E, ∇E ) on X log . Note that F∗ (E, ∇E ) depends on the choice of lifting
 log → Slog .
X
Deﬁnition 2.9. We shall say that (E, ∇E ) forms an MF ∇ -object on X log if
(E, ∇E ) ⊗ (L, ∇L ) ∼
= F∗ (E, ∇E )
 log → Slog and some line bundle with connection (L, ∇L ) whose
for some choice of lifting X
square is trivial.
Note that this deﬁnition is consistent (though slightly weaker, since we allow the ambiguity
of tensoring with (L, ∇L )) with the notion of being an object of the category MF ∇ of [Falt],
§2. It is shown in [Falt] (Theorem 6.2) that the de Rham cohomology of a semistable family
of varieties over X log equipped with the Hodge ﬁltration and the Gauss-Manin connection
forms an object of MF ∇ (as long as p− 2 is greater than or equal to the relative dimension
of the family of varieties). The following result provides the link between what we are doing
here and [Falt], §2:
71

Proposition 2.10. Let (E, ∇E ) be an indigenous bundle on X log . Then (E, ∇E ) forms an
MF ∇ -object on X log if and only if (E, ∇E ) is admissible and nilpotent.
Proof. First, let us assume that (E, ∇E ) forms an MF ∇ -object on X log for the lifting
 log → Slog . One computes easily from the deﬁnition of the connection ∇Φ that the pX
 Also, (just
curvature is nilpotent (with respect to the ﬁltration 0 ⊕ (Φ∗ E/F 1 (E)) ⊆ Φ∗ E).
1 
as in the proof of Proposition 1.4), the derivative p Φ is of the form (1 + t)p−1 + f  (t).
Thus, since the Kodaira-Spencer morphism is the identity, it follows that the p-curvature
def
(applied to ∂ = d/dt) is obtained by multiplying a section of (Φ∗ F 1 (E)) ⊕ 0 by Φ−1 (∂ F )
times the (p − 1)th derivative of (1 + t)p−1 + f  (t) (which is just −1) and regarding the
result of this multiplication as a section of 0 ⊕ (Φ∗ E/F 1 (E)). In particular, we see that the
p-curvature is nonzero. Thus, (E, ∇E ) is admissible and nilpotent.
On the other hand, suppose that (E, ∇E ) is admissible and nilpotent. By the bijective
correspondence of Proposition 2.5, (E, ∇E ) corresponds to an FL-bundle (G, ∇G ). By
 log → Slog . It remains to see
Proposition 1.2, this FL-bundle corresponds to a lifting X
∗
that F (E, ∇E ) taken with respect to this lifting is isomorphic to (E, ∇E ) (up to tensoring
with an (L, ∇L ) whose square is trivial). Let N = E/F 1 (E). Let M = Φ∗X/S (N F ).
Let ∇M be the connection on M for which the sections of N F are horizontal. Thus,
the fact that the
(M, ∇M )⊗2 ∼
= (T , ∇T ). Now, sorting through the deﬁnitions and using

Kodaira-Spencer morphism is the identity reveals that if X = U V (where U and V
are aﬃne opens), then F∗ (E, ∇E ) ⊗ (M, ∇M ) is just the extension of OX by T obtained
from the 1-cocycle which is the diﬀerence between Frobenius liftings on U and V . It thus
follows from the deﬁnition of the canonical morphism F : D → A of Proposition 1.2 that
F∗ (E, ∇E ) ⊗ (M, ∇M ) is exactly the bundle (G, ∇G ). Thus, it follows from the deﬁnition
of the bijective correspondence in Proposition 2.5 that F∗ (E, ∇E ) ∼
= (E, ∇E ) ⊗ (L, ∇L ) for
some (L, ∇L ) whose square is trivial. 
The Inﬁnitesimal Verschiebung
Let ωX/S be the relative dualizing sheaf of f : X → S. Thus, if D ⊆ X is the divisor of
log
marked points, we have ωX/S (D) ∼
= ωX/S . Let ΦX/S : X → X F be the relative Frobenius
over S. Recall from duality theory (see, e.g., [Harts] for a treatment of duality theory) that
since f and ΦX/S are local complete intersection morphisms, we have a trace morphism:
trΦX/S : (ΦX/S )∗ ωX/S → (ωX/S )F
where we regard ωX/S as RΦ!X/S (ωX/S )F . On the other hand, let Y log be the log scheme
whose underlying scheme is X and whose log structure is the same as that of X log away
from the divisor D of marked points, and equal to the pull-back of the log structure of S log
on the open subscheme where f is smooth. Then we also have a morphism arising from
the log version of the Cartier isomorphism (applied to Y log → S log ):
72

C : (ΦX/S )∗ ωX/S → (ωX/S )F
The following result is “well-known,” but I do not know an adequate reference for it:
Lemma 2.11. The morphisms trΦX/S and C are equal.
Proof. By a density argument, we reduce to the case where f is smooth. By naturality,
we reduce to the assertion that these two morphisms are the same when X = Spec(Fp [T ]);
S = Spec(Fp ) (where T is an indeterminate). Since trΦX/S is the reduction modulo p of
a construction that holds in arbitrary or mixed characteristic, we can calculate trΦX/S by
considering the trace map obtained from duality for the ﬁnite morphism Φ : Spec(Zp [T ]) →
Spec(Zp [T ]) given by T → T p . Since trΦ (Φ∗ (dT )) = p dT , and Φ∗ (dT ) = p T p−1 dT , it
follows that trΦ (T p−1 dT ) = dT . By reducing this formula modulo p and comparing with
the construction in [Katz] of the Cartier isomorphism, we obtain the desired result. 
Let (E, ∇E ) be an indigenous bundle on X log . Let HE : T → τX log /S log be the square
Hasse invariant of (E, ∇E ). Then by pulling back via ΦX log /S log and taking R1 f∗ of HE ,
we obtain a canonical morphism:
ΦτE : (R1 f∗ τX log /S log )F → R1 f∗ τX log /S log
which we shall call the Frobenius on R1 f∗ τX log /S log induced by (E, ∇E ). On the other
log
→ T ∨ . Note that
hand, let us consider the dual morphism to HE , that is, HE∨ : ωX/S
log F
T ∨ = Φ∗X/S (ωX/S
) . Thus, if we tensor HE∨ with ωX/S , we get a morphism
log ⊗2
log F
) (−D) → ωX/S ⊗OX Φ∗X/S (ωX/S
)
(ωX/S
log F
If we then compose this morphism with the trace morphism trΦX/S tensored with (ωX/S
) ,
log ⊗2
log ⊗2
we obtain a morphism (ΦX/S )∗ (ωX/S
) (−D) → ((ωX/S
) (−D))F . Then applying f∗ to
this morphism, we obtain:
log ⊗2
log ⊗2
(−D) → (f∗ (ωX/S
) (−D))F
Φω
E : f∗ (ωX/S )
log ⊗2
which we shall call the Verschiebung on f∗ (ωX/S
) (−D) induced by (E, ∇E ). Observe
that by Serre duality applied to the morphism f , we obtain that the vector bundles
log ⊗2
) (−D) and R1 f∗ τX log /S log on S are dual to one another. Then relative to this
f∗ (ωX/S
duality, we have

τ
Proposition 2.12. The morphisms Φω
E and ΦE are dual to one another.

73

Proof. This follows immediately from duality theory. Namely, the duality between
⊗2
(−D) and R1 f∗ τX log /S log is obtained by cup product, followed by the trace morf∗ ωX/S
phism trf : R1 f∗ ωX/S → OS . On the other hand, since trace morphisms behave well
under composition, we see that trf = (trf )F ◦ trΦX/S . This fact, combined with the fact
∨
that ΦτE (respectively, Φω
E ) is obtained from HE (respectively, HE ), implies the result. 
We are now ready to state and prove the second main result of this Section. Consider the
Verschiebung on indigenous bundles deﬁned in the ﬁrst subsection of this Section. In the
universal case, it was a morphism
V g,r : S g,r → Qg,r
over Mg,r . Thus, it induces a map on tangent bundles over Mg,r :
ΘV g,r /Mg,r : ΘS g,r /Mg,r → ΘQg,r /Mg,r
If we pull-back to the point of S g,r deﬁned by our particular (E, ∇E ), we get a morphism
log ⊗2
log ⊗2
ΘV
(−D) → (f∗ (ωX/S
) (−D))F
E : f∗ (ωX/S )

Then we have the following result:
Theorem 2.13. Let (E, ∇E ) be indigenous on X log . Then the inﬁnitesimal Verschiebung
ω
morphism ΘV
E is equal to ΦE .
Proof. First, let us recall Jacobson’s formula (see, e.g., [Jac], pp. 186-187): This formula
states that if a and b are elements of an associative ring R of characteristic p, then

p

p

p

(a + b) = a + b +

p−1


si (a, b)

i=1

where the si (a, b) are given by the formula:

p−1

(ad(ta + b))

(a) =

p−1


isi (a, b)ti−1

i=1

computed in the ring R[t], where t is an indeterminate. In our case, we wish to apply this
formula in the case where a = α, α ∈ R, and is an element of the center of R such that
2
= 0. In this case, substitution yields:
74

(a + b)p = bp + (ad(b))p−1 a
ω
To prove that ΘV
E = ΦE , it suﬃces to do a local calculation on X to show that the
inﬁnitesimal change in the trace of the square of the p-curvature is given by −2 Φω
E . We
log ⊗2
2

work over the base S[ ]/( ). Let ∇E = ∇E + θ, where θ is a section of f∗ (ωX/S ) (−D),
be a connection on E that makes it an indigenous bundle. Let U ⊆ X be an open subset
that avoids the marked points and at which f is smooth. Let x be a local coordinate on U .
def d
.
Write ∇ (respectively, ∇ ; θx ) for ∇E (respectively, ∇E ; θ) applied in the direction ∂ = dx
We wish to apply the above formula in the case where b = ∇ and a = θx . We thus
obtain that the inﬁnitesimal change in the p-curvature is given by (ad(∇))p−1 θx . Now the
inﬁnitesimal Verschiebung is obtained by multiplying this term by the constant term and
then taking the trace (and multiplying by −1). Put another way, minus the inﬁnitesimal
Verschiebung is obtained by applying PE∨ to (ad(∇))p−1 θx . Since PE∨ is horizontal, it
commutes with ad(∇), so we ﬁnd that:

(∂)p−1 (PE∨ θx ) = (∂)p−1 ((PE∨ θ) · ∂)
log F
) obtained by evaluating minus the inﬁnitesimal Verschiebung
is the section of Φ∗X/S (ωX/S
log ⊗2
(which is a section of Φ∗X/S {((ωX/S
) )(−D)}F ) at ∂ F . Thus, to complete the proof of
the Theorem, we must show that
∨
F
(∂)p−1 ((PE∨ θ) · ∂) = −Φ−1
X/S {(C ⊗ 1)(PE θ) · ∂ }
log F
) . Write PE∨ θ = ν · ζ,
Now let ζ be a horizontal, locally generating section of Φ∗X/S (ωX/S
where ν is a section of ωX/S . Substituting, we see that it suﬃces to show that:
F
(∂)p−1 (ν · ∂) · ζ = −Φ−1
X/S (C(ν) · ∂ ) · ζ

If we then divide out the ζ’s, we see that really (just as in [Katz2], (7.1.2.6)), we are
reduced to proving a simple identity concerning diﬀerentiation in characteristic p. Indeed,
if we regard the equation as an identity in ν, both sides are Φ−1
X/S OX F -linear in ν and
vanish when ν is exact; thus, we are reduced to proving the identity:
(∂)p−1 (xp−1 ) = −C(xp−1 dx) · ∂ F
which follows from the deﬁnition of C and the fact that (p − 1)! = −1 in characteristic p.


75

Diﬀerential Criterion for Admissibility
We maintain the notation of the previous subsection. In the previous subsection, we
computed the relative diﬀerential map of the Verschiebung morphism V g,r over Mg,r . In
fact, however, with a little more preparation, the same calculation allows us to give an
explicit representation of the diﬀerential map of the Verschiebung over Fp . Moreover, this
explicit representation allows us to give a diﬀerential criterion for an indigenous bundle to
be admissible, which is also necessary if the bundle is nilpotent.
Consider the aﬃne bundle Qg,r → Mg,r . Since by deﬁnition, this bundle is the pull
back by the Frobenius morphism on Mg,r of a bundle over Mg,r , it follows that we get
log

a natural connection ∇Q on this aﬃne bundle Qg,r → Mg,r . Let Qg,r be the log stack
log

obtained by pulling back to Qg,r the log structure of Mg,r . Next, let us consider the
canonical exact sequence of tangent bundles on Qg,r :
0 → ΘQg,r /Mg,r → ΘQlog → ΘMlog |Qg,r → 0
g,r

g,r

Thus, our connection ∇Q induces a splitting
ΘQlog ∼
= ΘQg,r /Mg,r ⊕ ΘMlog |Qg,r
g,r

g,r

Now let us consider the “full” inﬁnitesimal Verschiebung, i.e., the morphism induced on
tangent bundles by V g,r :
ΘV g,r : ΘS g,r → ΘQg,r
On the one hand, we know what the projection of ΘV g,r to ΘMlog |Qg,r is. Thus, we would
g,r

like to compute the projection of ΘV g,r to ΘQg,r /Mg,r . We shall soon see that, in fact, we
have already computed this projection as well, in the course of proving Theorem 2.13.
Suppose (as in the previous subsection) we have a log scheme S log with an r-pointed
stable curve of genus g, f log : X log → S log , and an indigenous bundle (E, ∇E ) on X log .
Then the ﬁrst relative parabolic de Rham cohomology module R1 fDR,∗ (Ad(E)) (as in
Chapter I, Theorem 2.8) is naturally isomorphic to the pull-back to S log (via the classifying
morphism for {X log , (E, ∇E )}) of ΘS log . On R1 fDR,∗ (Ad(E)), we have a Hodge ﬁltration
g,r

log ⊗2
0 → f∗ (ωX/S
) (−D) → R1 fDR,∗ (Ad(E)) → R1 f∗ τX log /S log → 0

where the surjection in the above exact sequence is exactly the pull-back to S log of the
projection ΘS log → ΘMlog |S g,r .
g,r

g,r

76

On the other hand, consider the p-curvature of Ad(E): PE : T → Ad(E). Then by
applying “R1 fDR,∗ ” to the dual of PE , we get a morphism
R1 fDR,∗ (Ad(E)) → R1 fDR,∗ (T ∨ )
Now by Poincaré duality, we have
R1 fDR,∗ (T ∨ ) ∼
= {R1 fDR,∗ (T )}∨
Moreover, we computed R1 fDR,∗ (T ) in Proposition 1.1. In particular, we have a natural
inclusion R1 f∗ (τX log /S log )F → R1 fDR,∗ (T ). Thus, if we compose the above morphism
induced by PE∨ with the dual surjection to this natural inclusion, we obtain a natural
morphism
log ⊗2
) (−D))F
ΘE : R1 fDR,∗ (Ad(E)) → (f∗ (ωX/S

Then we have the following result:
Theorem 2.14. Let (E, ∇E ) be indigenous on X log . Then the pull-back to S log of the
projection of ΘV g,r to ΘMlog is given by the surjection in the Hodge ﬁltration; the pullg,r

back to S log of the projection of ΘV g,r to ΘQg,r /Mg,r is given by ΘE .
Proof. It remains to prove the statement about the projection to ΘQg,r /Mg,r . To do this
we consider an inﬁnitesimal deformation of (E, ∇E ) over S log [ ]/( 2 ). But the section of
log ⊗2
) (−D))F that we obtain can be computed locally on X. Moreover, locally on
(f∗ (ωX/S
X, this calculation is exactly the same as that of Theorem 2.13. This proves the result. 
Corollary 2.15. Let (E, ∇E ) be indigenous on X log . If ΘE is surjective, then (E, ∇E ) is
log
log
log
admissible. In particular, if the morphism V g,r : S g,r → Qg,r is log étale at the image of
log

the classifying morphism S log → S g,r for (E, ∇E ), then (E, ∇E ) is admissible.
Proof. Since being admissible is an open condition, it suﬃces to prove the result when S
log
is the spectrum of an algebraically closed ﬁeld. If V g,r is log étale, then by Theorem 2.14,
ΘE must be surjective. Thus, it suﬃces to prove the ﬁrst statement. Suppose that (E, ∇E )
is not admissible. Thus, the morphism PE∨ : Ad(E) → T ∨ has a nonempty zero locus.
One can compute the p-curvature explicitly at a marked point (where the monodromy is
nonzero and nilpotent); it follows that the zero locus does not contain any marked points.
Now there are two possibilities: the zero locus either avoids the nodes or it does not.
Let us ﬁrst do the case where the zero locus of PE∨ avoids the nodes. Since PE∨ is
horizontal, its zero locus must be the pull-back of some closed subscheme via ΦX/S . Thus,
77

in particular, there exists some point x ∈ X (which is neither a marked point nor a
F
node) such that PE∨ is zero at Φ−1
X/S (x ) (the scheme-theoretic ﬁber). By the deﬁnition of
log ⊗2
) (−D))F
ΘE , it follows that the image of ΘE lands in the subspace Vx of H 0 (X, (ωX/S
consisting of sections that vanish at xF . Now by Riemann-Roch on curves, Vx cannot be
log ⊗2
all of H 0 (X, (ωX/S
) (−D))F , unless g = 0 and r = 3, or g = 1 and r = 1. This completes
the proof (under the assumption that PE∨ avoids the nodes), except for these two special
cases. For g = 0, r = 3, we shall show in the subsection of §3 on totally degenerate curves
that the unique indigenous bundle on such a curve is necessarily admissible. (One checks
easily that there are no vicious circles in the reasoning.) For g = 1, r = 1, we note that
P(E, ∇E ) is necessarily invariant with respect to the automorphism α given by multiplying
by −1. Thus, if we pull-back by the morphism X → X given by multiplying by 2, it is
still invariant under α. Hence it descends to the four-pointed curve of genus zero Y log of
which X log is a log étale double covering. Let us call this descended bundle P(F, ∇F ).
Thus, P(F, ∇F ) is indigenous on Y log . It is easy to see that ΘE and ΘF are the same
morphism; thus, the hypothesis holds for P(F, ∇F ), as well. Thus, we reduce to the case
g = 0, r = 4, which has already been checked.

Now let us consider the case where PE∨ vanishes at a node ν ∈ X. Let π log : Z log →
X log be the partial normalization of X log at ν (where the log structure on Z log is such
def

that the points mapping to ν are marked points). Let (F, ∇F ) = π ∗ (E, ∇E ). Now let us
consider the commutative diagram:

H 1 (X, τX log /S log )F
⏐
⏐

−→

1
HDR
(X log , Ad(E))
⏐
⏐

−→ H 1 (X, τX log /S log )
⏐
⏐

H 1 (Z, τZ log /S log )F

−→

1
HDR
(Z log , Ad(F))

−→

H 1 (Z, τZ log /S log )

where the vertical arrows are pull-backs via π; the horizontal arrows on the left are induced
by PE ; and the horizontal arrows on the right are induced by the Hodge ﬁltration. Finally,
the “prime” on the de Rham cohomology on the bottom row indicates that the we are
taking non-parabolic de Rham cohomology on Z log (since (F, ∇F ) may not even have a
natural parabolic structure, if (E, ∇E ) is not of restrictable type). Let η be a generator of
the kernel of H 1 (X, τX log /S log ) → H 1 (Z, τZ log /S log ). Let us consider what happens to η F
as we move it around the above commutative diagram. Since PE is zero at ν, if we move it
1
(X log , Ad(E)) lies in
along the top to H 1 (X, τX log /S log ), we get zero. Thus, its image in HDR
log ⊗2
1
1
) (−D)). But the pull-back map HDR
(X log , Ad(E)) → HDR
(Z log , Ad(F))
H 0 (X, (ωX/S
log ⊗2
log ⊗2
maps H 0 (X, (ωX/S
) (−D)) injectively into H 0 (Z, (ωZ/S
) ). Going around the other
way, however, (i.e., going down and then to the right), we see that the image of η F in
1
1
HDR
(Z log , Ad(F)) is zero. We thus conclude that the image of η F in HDR
(X log , Ad(E))
is zero. But this contradicts the surjectivity of ΘE , since the upper horizontal morphism
on the left-hand side of the above diagram is dual to ΘE . This completes the proof. 

78

Conversely, let us suppose that (E, ∇E ) is nilpotent and admissible. Then we claim
that ΘE is necessarily surjective. Indeed, for simplicity, it suﬃces to prove this when S
is the spectrum of a ﬁeld. Let K be the kernel of PE∨ : Ad(E) → T ∨ . Note that the
connection on Ad(E) restricts to a connection ∇K on K. Thus, (K, ∇K ) is an FL-bundle.
Also, we have a horizontal exact sequence:
0 → T → K → OX → 0
in which the connecting morphism OS → R1 fDR,∗ (T ) must be injective (since (K, ∇K ) is
an FL-bundle). Moreover, it is a tautology that the composite of this morphism OS →
R1 fDR,∗ (T ) with the projection R1 fDR,∗ (T ) → OS of Proposition 1.1 is the identity. Thus,
we see that the morphism R1 f∗ (τX log /S log )F → R1 fDR,∗ (T ) → R1 fDR,∗ (K) is injective.
Now let C = Ad(E)/T . We have a connection ∇C on C, induced by the connection on
Ad(E). Thus, we get a horizontal exact sequence:
0 → OX → C → T ∨ → 0
log F
) → R1 fDR,∗ (OX ) must be injective (since
in which the connecting morphism (f∗ ωX/S
otherwise, C would admit two horizontal, generically linearly indendent sections, which
contradicts the fact that the p-curvature is nonzero). Lastly, we consider the horizontal
exact sequence:

0 → K → Ad(E) → T ∨ → 0
log F
) → R1 fDR,∗ (K) with the
in which the composite of the connecting morphism (f∗ ωX/S
projection R1 fDR,∗ (K) → R1 fDR,∗ (OX ) is injective, as we observed above. Since the
image of R1 f∗ (τX log /S log )F ⊆ R1 fDR,∗ (K) under the map R1 fDR,∗ (K) → R1 fDR,∗ (OX )
is zero, it thus follows that if we compose the inclusion R1 f∗ (τX log /S log )F ⊆ R1 fDR,∗ (K)
with the morphism R1 fDR,∗ (K) → R1 fDR,∗ (Ad(E)), the resulting morphism

R1 f∗ (τX log /S log )F → R1 fDR,∗ (Ad(E))
is injective. But this morphism is dual to ΘE . Thus, ΘE is surjective. This completes the
proof of the claim.
log

log

Let N g,r be the log stack obtained by pulling back the log structure on Mg,r to N g,r .
log

Since N g,r is the zero locus of the Verschiebung, it follows that N g,r is log smooth over
Fp at a point if and only if ΘE is surjective. In other words:
Corollary 2.16. Suppose that (E, ∇E ) is nilpotent indigenous. Then it is admissible if
log
and only if N g,r is smooth over Fp at the image of classifying morphism S log → N g,r for
(E, ∇E ).
79

§3. Hyperbolically Ordinary Curves
Often, in the literature, one speaks of a curve as being “ordinary” if its Jacobian is
ordinary. In fact, however, since the Jacobian only represents the “abelian part” of the
curve, it is in some sense more intrinsic to speak of a curve as ordinary if it is hyperbolically
ordinary in the sense deﬁned below. Philosophically, this means that the Verschiebung on
indigenous bundles is a local isomorphism in a neighborhood of an indigenous bundle that
provides a “nice” uniformization for the curve. Thus, relative to the analogy (explained in
the Introduction) between the Verschiebung on indigenous bundles and the Beltrami equation, to be hyperbolically ordinary means that the Verschiebung acts (at least locally) as
one might expect from this analogy, given the classical results on existence and uniqueness
of solutions to the Beltrami equation.
Basic Deﬁnitions
Let S log be a ﬁne noetherian log scheme over Fp . Let f log : X log → S log be an
r-pointed stable curve of genus g (so 2g − 2 + r ≥ 1). Let D ⊆ X be the divisor of
marked points. Let (E, ∇E ) be an indigenous bundle on X log . Let PE : T → Ad(E) be its
p-curvature. Recall the Frobenius on R1 f∗ τX log /S log induced by (E, ∇E ):
ΦτE : (R1 f∗ τX log /S log )F → R1 f∗ τX log /S log
that we deﬁned in §2.
Deﬁnition 3.1. We shall call (E, ∇E ) ordinary if ΦτE is an isomorphism.
Note that the condition of being ordinary is an open condition on S g,r . We shall denote
ord

this open set by S g,r .
Proposition 3.2. If (E, ∇E ) is ordinary, then it is admissible.
Proof. This follows a fortiori from Corollary 2.15. 
The following deﬁnition is key to the entire paper:
Deﬁnition 3.3. We shall say that f log : X log → S log is a hyperbolically ordinary curve if
there exists an étale surjection T → S and a nilpotent, ordinary indigenous bundle (E, ∇E )
on X log ×S T .
80

When the context is clear, we shall simply say that f log is an “ordinary curve.” The reason
for the descriptive “hyperbolically” is that in the literature, the term “ordinary curve” is
frequently used to mean that its Jacobian is ordinary. In this paper, when f log has an
ordinary Jacobian, we shall say that f log is parabolically ordinary.
Proposition 3.4. If the ﬁber of f log : X log → S log over s ∈ S is hyperbolically ordinary,
then there exists an open set U ⊆ S with s ∈ U such that f log |U is hyperbolically ordinary.
In particular, f log : X log → S log is hyperbolically ordinary if and only if all its ﬁbers are
hyperbolically ordinary.
Proof. Indeed, it suﬃces to consider the universal example. Recall that N g,r ⊆ S g,r is the
locus of nilpotent indigenous bundles. Write π : N g,r → Mg,r for the natural projection.
Let n ∈ N g,r ; let m ∈ Mg,r be the point π(n). Then it follows from Theorem 2.13, plus
the deﬁnition of N g,r as the zero locus of V g,r that if n is ordinary, then π must be étale
at n. Thus, π is open at n. This completes the proof. 
We shall denote the open subscheme of Mg,r (respectively, N g,r ) consisting of hyperord

bolically ordinary curves (respectively, nilpotent, ordinary indigenous bundles) by Mg,r
ord

(respectively, N g,r ). Thus, we have a natural étale surjection
ord

ord

π : N g,r → Mg,r
ord

Finally, let us note that over S g,r , we have an étale local system in Fp -vector spaces
of dimension 3g − 3 + r obtained by taking the sections of ΘMlog |S ord that are invariant
g,r

g,r

under the Frobenius action on ΘMlog |S ord given by −ΦτE . (Note the minus sign in front of
g,r

g,r

−ΦτE ! It will be important later in Chapter III.) Let us denote this local system by Θet
g,r ,
ord

and call it the tangential local system on S g,r . Similarly, by taking its dual Ωet
g,r we obtain
ord

ord

a local system on S g,r which we shall call the diﬀerential local system on S g,r . Often, we
shall be interested in the restrictions of these local systems to N g,r .
The Totally Degenerate Case
In this subsection, we show that totally degenerate curves are hyperbolically ordinary.
ord
By Proposition 3.4, this will show that Mg,r is an open dense subscheme of Mg,r . Since
totally degenerate curves have no moduli, there is no loss of generality in assuming that
S = Spec(Fp ). We begin by considering the case g = 0, r = 3. Recall the morphisms
constructed at the end of Chapter I, §3:
log

N log : M1,1 [2] → M1,1
81

(parametrizing elliptic curves with level structures on the two-torsion points) and
log

log

Λlog : M1,1 [2] → M0,4
which takes an elliptic curve to the four-pointed curve of genus zero of which it is a
log
double covering. Then in this case, we have M0,4 = X log . Let us construct a nilpotent,
log

admissible indigenous bundle on M0,4 . Since X log has only one indigenous P1 -bundle
(up to isomorphism), this will complete the proof of Corollary 2.15. To do this, we note
that (as we saw in Example 3 of Chapter I, §2), the ﬁrst de Rham cohomology module of
log
the universal elliptic curve over M1,1 [2] deﬁnes an indigenous vector bundle (E, ∇E ). Let
(P → X, ∇P ) be the associated P1 -bundle. Now since the map “multiplication by −1” on
an elliptic curve induces the map “multiplication by −1” on E, it follows that (E, ∇E ) will
not descend via Λ. However, since “multiplication by −1” induces the identity on P → X,
we see that (P → X, ∇P ) does descend via Λ. This gives us an indigenous bundle on
X log . To see that it is nilpotent and admissible, it suﬃces to see that (E, ∇E ) is nilpotent
and admissible. But by (a rather trivial special case of) [Falt], Theorem 6.2, as a de
Rham cohomology module, (E, ∇E ) necessarily forms an MF ∇ -object (see Deﬁnition 2.9).
Thus, Proposition 2.10 tells us that (E, ∇E ) is nilpotent and admissible. In particular, this
completes the proof of Corollary 2.15.
Now let us assume that f log : X log → S log is formed by gluing together a number of
copies of the 3-pointed stable curve of genus zero (as in the last subsection of Chapter I,
§2). Then, as we saw in this ﬁnal subsection of Chapter I, §2, we can glue together the
nilpotent, admissible indigenous bundles that we constructed in the previous paragraph
to obtain a nilpotent, admissible indigenous bundle (P → X, ∇P ) on X log . On the other
hand, by Proposition 2.8, every nilpotent, admissible indigenous bundle on X log is of
restrictable type. Since there is (up to isomorphism) only one indigenous P1 -bundle of
restrictable type on X log , it thus follows that:
Proposition 3.5. Up to isomorphism, a totally degenerate r-pointed stable curve of genus
g admits one and only one nilpotent, admissible indigenous P1 -bundle.
Next, let us consider the cohomology group H 1 (X, τX log /S log ) of our totally degenerate
curve. If X log is obtained by gluing together various copies Xilog of the 3-pointed stable
curve of genus zero, let Y log be the disjoint union of the Xilog , and let ν log : Y log → X log
be the natural map. Let 0 → τX log /S log → ν ∗ τY log /S log → C → 0 be the natural exact
sequence (where C is deﬁned so as to make the sequence exact). By considering the long
exact cohomology sequence associated to this exact sequence of sheaves, we see that we
obtain a natural isomorphism H 1 (X, τX log /S log ) ∼
= H 0 (X, C). On the other hand, C is
naturally isomorphic to the direct sum of the (τX log /S log )|z , where z ranges over all the
nodes in X. Moreover, the residue map gives a natural isomorphism τX log /S log |z ∼
= OS
(well-deﬁned up to sign). Let Σ be the set of nodes of X. Then
82

C=

(OS )z
z∈Σ

where the subscript “z” is just used as a marker, to indicate which copy of OS one is
referring to. Thus, we have a natural isomorphism (well-deﬁned up to sign on each factor):
H 1 (X, τX log /S log ) ∼
=

(Fp )z
z∈Σ

In particular, since Fp has a natural bilinear form (given by ring multiplication Fp × Fp →
Fp ), using this bilinear form on each factor (Fp )z gives a natural bilinear form:
B : H 1 (X, τX log /S log ) × H 1 (X, τX log /S log ) → Fp
which is now independent of all arbitrary choices of sign.
Proposition 3.6. For every totally degenerate r-pointed curve of genus g, there is a
natural nondegenerate bilinear form B on the OS -module R1 f∗ τX log /S log which takes values
in OS .
Next we would like to show that the unique nilpotent, admissible indigenous bundle
(P → X, ∇P ) on X log is ordinary. To do this, we must compute the induced Frobenius
action on H 1 (X, τX log /S log ). By using an isomorphism as above
H 1 (X, τX log /S log ) ∼
=

(Fp )z
z∈Σ

we see that it suﬃces to compute the induced Frobenius action on the various (Fp )z ’s.
Consider P |z . The Hodge section σ : X → P deﬁnes a point σz ∈ P |z (Fp ). On the other
hand, there is a unique point ﬁxed by the monodromy action qz ∈ P |z (Fp ). If we think of
P as P(J /J [3] ) (as in Chapter I, Proposition 2.5), then (J /J [3] )z = Vσ ⊕ Vq , where Vσ
(respectively, Vq ) is the subspace deﬁned by σz (respectively, qz ). Note that by the residue
map, we have natural isomorphisms Vσ ∼
= Fp and Vq ∼
= Fp . Thus, we obtain a basis
[3]
{(1, 0); (0, 1)} of (J /J )z . Let Eσ and Eq be the nilpotent endomorphisms of (J /J [3] )z
given, respectively, by the matrices


0 1





0

0

1

0



and
0 0

Thus, Eq is essentially the p-curvature of (π : P → X, ∇P ) restricted to z. Sorting through
all the deﬁnitions, it thus follows that the induced Frobenius action on (Fp )z is given by
multiplication by tr(Eσ · Eq ) = 1. We thus obtain the following result:
83

Proposition 3.7. On a totally degenerate r-pointed stable curve X log of genus g over Fp ,
the Frobenius action ΦτP on H 1 (X, τX log /S log ) induced by the unique nilpotent, admissible
indigenous bundle on X log is the identity. In particular, this unique nilpotent, admissible
indigenous bundle is ordinary, and so is X log .
ord

ord

Corollary 3.8. The open subschemes Mg,r ⊆ Mg,r and N g,r ⊆ N g,r are nonempty.
The Case of Elliptic Curves: The Parabolic Picture
One can get a better feel for ordinariness for general r-pointed stable curves of genus
g by ﬁrst studying ordinariness for elliptic curves. In the case of elliptic curves, there are,
in fact, two possible theories of ordinary bundles and curves: the parabolic theory and
the hyperbolic theory. Indeed, let f log : X log → S log be a 1-pointed stable curve of genus
1, with marked point : S → X. Let Y log be the log scheme obtained from X log (as
in the subsection “The Inﬁnitesimal Verschiebung” of §2) by removing the marked point.
Then the parabolic theory (respectively, hyperbolic theory) is obtained by considering the
various properties of the p-curvature of indigenous bundles on Y log (respectively, X log ).
So far in this Chapter, of course, we have only been considering the hyperbolic theory.
However, since the notion of an indigenous bundle is deﬁned for Y log , one can consider
its p-curvature, and deﬁne the notions of a nilpotent indigenous bundle, or an admissible
indigenous bundle, just as before. Also, many of the results (though not all) such as
Theorem 2.3 (where we replace the “3g − 3 + r” by 1) continue to hold in the parabolic
context. The purpose of this subsection is to summarize what happens when one studies
elliptic curves from the parabolic point of view, and to show, in particular, that the notion
of ordinariness that we have deﬁned in this paper (in terms of the p-curvature of indigenous
bundles) reduces to the classical notion of ordinariness of elliptic curves.
log

log

First, we introduce some notation. Let M1,0 = M1,1 . (The point here is that we
log

shall use the notation M1,0 when we are thinking about elliptic curves from the parabolic
point of view.) Let f : G → M1,0 be the universal elliptic curve, with identity section
: M1,0 → G. Let L = f∗ ωG/M1,0 be the Hodge bundle. Let G log be the log stack whose
log

underlying stack is G and whose log structure is the pull-back of the log structure on M1,0 .
Let S 1,0 → M1,0 be the torsor over L⊗2 of Schwarz structures on G log . Then just as before,
we can deﬁne a Verschiebung:
V 1,0 : S 1,0 → Q1,0
Just as before we have a closed subscheme N 1,0 ⊆ S 1,0 consisting of nilpotent indigenous
adm

bundles, and an open subscheme S 1,0 ⊆ S 1,0 consisting of admissible indigenous bundles.
Also, just as before, we deﬁne an indigenous bundle to be ordinary if its inﬁnitesimal Verschiebung is an isomorphism, and we deﬁne an elliptic curve to be (parabolically) ordinary
if it admits a nilpotent, ordinary indigenous bundle.
84

Now recall that in Example 2 of Chapter I, §2, we constructed a canonical indigenous
bundle on G log . This indigenous bundle thus deﬁnes a global section τS : M1,0 → S 1,0
which trivializes the L⊗2 -torsor S 1,0 → M1,0 . Moreover, by [KM], p. 227, one knows that
if p ≥ 5, then H 0 (M1,0 , L⊗2 ) = 0, so this trivialization is unique. Let us also recall that,
in the deﬁnition of the indigenous bundle (E, ∇E ) in Example 2 of Chapter I, §2, we had
a subbundle 0 ⊕ OG ⊆ ω ⊕ OG = E (where ω = ωG/M1,0 ) which was stabilized by the
connection ∇E . Moreover, the induced connection on OG was the trivial connection. Put
another way, E admits a nonzero horizontal section. It thus follows that the p-curvature
of ∇E is nilpotent. Thus, τS : M1,0 → S 1,0 lands inside N 1,0 .
Let θ be a section of L⊗2 over some étale V → M1,0 . Let ∇θE be the connection
formed by adding to ∇E the endomorphism given by
E = ω ⊕ OG → OG → ω ⊗2 ∼
= (ω ⊕ 0) ⊗ ω ⊆ E ⊗ ω
where the ﬁrst morphism is the natural projection; the second morphism is multiplication
by θ; and the ﬁnal inclusion is the natural one. Let δ be a section of L over V which is
everywhere nonzero. Thus, the sections δ and 1 deﬁne a global trivialization of E = ω ⊕ OG
over GV . We shall write sections of E|V in terms of this basis, given by δ and 1. Write
θ = φ · δ 2 , where φ is a function on V . Let ∇θ be the morphism E|V → E|V given by
evaluating ∇θE on δ −1 . Then we see that ∇θ is given by the following matrix:


0

φ

1

0



To obtain the p-curvature of ∇θE , we must iterate this matrix p times. This yields the
matrix:

φ

1
2 (p−1)

·

0 φ
1



0

Now let us write δ −p = h · δ −1 (so h is the classical Hasse invariant). Thus, to compute
the p-curvature of ∇θE , we must subtract from the matrix just given the following matrix:

h·

0 φ
1



0

Thus, we obtain that the p-curvature of ∇θE is given by:

(φ

1
2 (p−1)

− h) ·
85

0

φ

1

0



If we then take the determinant, we obtain our Verschiebung (applied to (δ F )2 ):
1

1

−φ · (φ 2 (p−1) − h)2 = −φp + 2h · φ 2 (p+1) − h2 · φ
Let us rewrite this in invariant form. The trivialization τS of S 1,0 → M1,0 allows us to
write S 1,0 as Spec(⊕i≥0 L⊗−2i ). On the other hand, Q1,0 is given by Spec(⊕i≥0 L⊗−2p·i ).
Thus, V 1,0 is determined by specifying the morphism of quasi-coherent sheaves:
ΓV : L⊗−2p →

L⊗−2i
i≥0

Let us denote the component of ΓV that maps into L⊗−2i by ΓV : L⊗−2p → L⊗−2i . Since
[i]
L is ample, it follows that ΓV = 0 when i > p (as we saw already in the proof of Theorem
2.3). Let χ ∈ Γ(M1,0 , Lp−1 ) be the Hasse invariant (as in [KM], p. 353). Then we see
that we have proven the following result:
[i]

[i]

[i]

Theorem 3.9. If i = p, then ΓV is multiplication by −1. If i = 12 (p + 1), then ΓV
[i]
is multiplication by 2 χ. If i = 1, then ΓV is multiplication by −χ2 . For all other i,
[i]
ΓV = 0.
In particular, this completes the proof of Theorem 2.3.
Corollary 3.10. Geometrically, N 1,0 consists of two irreducible components I1 and I2 :
One, I1 , is the section τS . The other, I2 , is nonreduced, and (I2 )red may be described as
follows: In [KM], p. 361, one ﬁnds a description of the Igusa curve Ig(p), with its canonical
(Z/pZ)× -action. Then (I2 )red is the quotient of Ig(p) by the subgroup {±1} ⊆ (Z/pZ)× .
In order to see which nilpotent bundles are ordinary, we must compute the derivative
of the Verschiebung map. In terms of the local objects we used in the computation above,
we obtain that “dV/dφ” is given by:
1

h(φ 2 (p−1) − h)
In particular, if h = 0, then the inﬁnitesimal Verschiebung is identically zero, while if
h = 0, then the inﬁnitesimal Verschiebung at τS is nonzero. Moreover, because of the
square factor in the expression for the Verschiebung, we see that if h = 0, then the only
nilpotent indigenous bundle at which the inﬁnitesimal Verschiebung will be nonzero is the
indigenous bundle given by τS . We thus obtain the following:
Theorem 3.11. An elliptic curve is parabolically ordinary if and only if it is ordinary
in the classical sense (i.e., its Hasse invariant is nonzero). If it is ordinary, then the
indigenous bundle constructed in Example 2 of Chapter I, §2, is the unique nilpotent,
ordinary indigenous bundle on the curve.

86

The Case of Elliptic Curves: The Hyperbolic Picture
In this subsection, we consider 1-pointed stable curves of genus 1 as hyperbolic objects.
In particular, we shall highlight the numerous contrasts with the parabolic viewpoint
presented above. We begin by considering the torsor S 1,1 → M1,1 . Recall that this
torsor has a canonical trivialization at inﬁnity, deﬁned by the unique nilpotent, admissible
indigenous bundle on the singular 1-pointed stable curve of genus 1 (Proposition 3.5). Let
us suppose that our prime p is ≥ 5. Then it follows from Chapter I, Theorem 3.6, that
S 1,1 → M1,1 does not admit a section which passes through the canonical trivialization
at inﬁnity. Now let us consider the closed subscheme N 1,1 ⊆ S 1,1 . By Theorem 2.3, the
natural morphism N 1,1 → M1,1 is ﬁnite and ﬂat of degree p. Let us consider the irreducible
component I ⊆ N 1,1 which passes through the canonical trivialization at inﬁnity. Then
I is generically reduced. Moreover, the degree of I → M1,1 must be ≥ 2. This behavior
already is substantially diﬀerent from the parabolic case, where the irreducible component
passing through the unique nilpotent, ordinary indigenous bundle at inﬁnity has degree
one over M1,0 . Thus, in particular, N 1,1 (respectively, V 1,1 ) is not isomorphic to N 1,0
(respectively, V 1,0 ), despite the fact that as stacks, M1,1 ∼
= M1,0 ; S 1,1 ∼
= S 1,0 ; Q1,1 ∼
= Q1,0 .
Since N 1,1 → M1,1 has degree p, it follows that there exist points of N 1,1 over the inﬁnity
point of M1,1 at which N 1,1 → M1,1 is not étale. Such points correspond to nilpotent
indigenous bundles which are not admissible (by Proposition 3.5). This fulﬁlls our earlier
pledge to show the existence of such bundles. Of these various observations, we record the
following for later reference:
Proposition 3.12. If p ≥ 5, then the irreducible component of N 1,1 passing through the
canonical trivialization at inﬁnity is generically reduced and has degree ≥ 2 over M1,1 .
The Generic Uniformization Number
We return to the case of an r-pointed stable curve of genus g, where r and g are
arbitrary (but satisfy 2g − 2 + r ≥ 1). Suppose we are given the combinatorial data Δ (as
at the end of Chapter I, Secion 2: consisting of a graph Γ, plus λi ’s, etc.) for a totally
degenerate curve. We shall call two collections of such data Δ and Δ equivalent if they
deﬁne isomorphic totally degenerate curves. Let us denote by Dg,r the equivalence classes
of such data Δ. Alternatively, one may think of Dg,r as the set of isomorphism classes of
totally degenerate r-pointed stable curves of genus g. Now let us consider the morphism:
N g,r → Mg,r
We know that it is ﬁnite, ﬂat, and of degree p3g−3+r . If Δ ∈ Dg,r , consider the irreducible
component IΔ of N g,r that passes through the unique nilpotent, admissible indigenous
bundle (as in Proposition 3.5) on the curve corresponding to Δ. Then IΔ is generically
reduced. Let GΔ be the degree of IΔ over Mg,r . We shall refer to GΔ as the generic
87

uniformization number for the data Δ. (The reason for attaching the term “uniformization”
to this number will become apparent in later Chapters.) Let
Gg,r =



GΔ

Δ∈Dg,r

Now let us suppose that p is suﬃciently large so that the class Σ (Chapter I, Theorem 3.4)
in H 1 (Mg,r , ΩMlog ) is nonzero. Then we have the following rough result:
g,r

Proposition 3.13. For g ≥ 3 and p suﬃciently large, the number GΔ is between 2 and
p3g−3+r .
Proof. The upper bound follows from the fact that N g,r → Mg,r has degree p3g−3+r . On
the other hand, since N g,r → Mg,r is ﬁnite, and Mg,r is normal, it follows that if IΔ had
degree 1 over Mg,r , it would, in fact, be isomorphic to Mg,r , hence deﬁne a section of S g,r
over Mg,r . By Chapter I, Theorem 3.4, we know that this is impossible, for p suﬃciently
large. 
It is not clear to the author how far these bounds are from being sharp. For instance,
it could be the case that N g,r is, in fact, irreducible. To compute the number GΔ exactly
would involve understanding the monodromy around curves that are not hyperbolically
ordinary. That is to say, it would involve proving a sort of hyperbolic analogue of Igusa’s
theorem on the monodromy around supersingular elliptic curves in the parabolic case.
It is interesting to know, however, that GΔ = 1 because this constitutes a departure from the behavior of complex indigenous bundles. To see this, we must ﬁrst explain
certain aspects of the analogy between the complex case and the characteristic p case
treated here. First of all, the condition of being nilpotent (and ordinary) is analogous, in
the complex case, to having real monodromy. Indeed, to be nilpotent (and admissible)
is (by Proposition 2.10) the same as coming from an MF ∇ -object in the sense of [Falt].
But to be an MF ∇ -object means, essentially, that the bundle with connection admits a
Frobenius action, i.e., that the monodromy is Frobenius-invariant. Since the Frobenius
at the inﬁnite prime is complex conjugation, it is thus natural to regard nilpotent (and
admissible) bundles as the characteristic p analogue of complex indigenous bundles with
real monodromy. On the other hand, in the complex case, within the real-analytic space
of complex indigenous bundles with real monodromy, there is a canonical, topologically
isolated component, corresponding to the indigenous bundle arising from the uniformization by the upper half-plane. On the other hand, in the characteristic p case treated here,
the fact that IΔ has degree ≥ 2 over Mg,r means that there is no canonical choice of a
nilpotent, ordinary indigenous bundle, even on a generic curve: since the monodromy at
the curves which are not hyperbolically ordinary is nontrivial, one such indigenous bundle
is always carried around to another.

88

Chapter III: Canonical Modular Frobenius Liftings
§0. Introduction
The present Chapter is central to the entire paper. In it, we construct a canonical
ord
Frobenius lifting on (N g,r )log , and a canonical indigenous bundle on the universal curve
ord

over (N g,r )log . This pair of a canonical Frobenius lifting and a canonical indigenous
bundle are uniquely characterized by the fact that, relative to this Frobenius lifting, the
renormalized Frobenius pull-back (Deﬁnition 1.4) of the canonical indigenous bundle is
equal to itself. In some sense, an ordinary (in the sense of Deﬁnition 1.1) Frobenius lifting
is like a p-adic analogue of a Kähler metric on a complex manifold in that it gives rise
to local canonical coordinates. Since there are a number of general properties of ordinary
Frobenius liftings that we will need throughout the rest of the paper, we give a basic
exposition of the properties of such Frobenius liftings in the ﬁrst Section of this Chapter.
The main result is that such a Frobenius lifting deﬁnes canonical aﬃne and multiplicative
ord
coordinates. Thus, in particular, our canonical Frobenius lifting on (N g,r )log deﬁnes such
ord

ord

canonical coordinates on N g,r . Since N g,r is étale over Mg,r , if one thinks of a point
ord

of N g,r as a point of Mg,r , together with a choice (from a ﬁnite number of possibilities)
of some added structure – which we call a p-adic quasiconformal equivalence class – then
we obtain the result that for every choice of a p-adic quasiconformal equivalence class, we
obtain a canonical local uniformization of Mg,r . The reason for the name “quasiconformal
equivalence class,” is that once one chooses this piece of data for a curve, we shall see
in this Chapter and in following Chapters that the uniformization theory of the curve is
entirely determined. This is reminiscent of Bers’ approach (as in [Bers]) to proving that
hyperbolic curves can be uniformized by the upper half plane: Namely, he proves that (in
the complex case) all hyperbolic curves with the same genus and number of marked points
belong to the same quasiconformal equivalence class. Thus, once we choose this class in
the p-adic case, we obtain a “covariant” uniformization by the aﬃne space modeled on
the tangent space to Mg,r at the curve in question. To obtain uniformizations by the
quadratic diﬀerentials (as in the complex case), we need more information than just the
quasiconformal equivalence class. Namely, we need a topological marking of the curve.
Once we deﬁne this, we obtain uniformizations by the quadratic diﬀerentials.
The canonical Frobenius gives rise to another natural notion, for which I know no
parallel in the complex case: a canonical lifting of a curve over a perfect ﬁeld to the ring of
Witt vectors with coeﬃcients in that ﬁeld. This is reminiscent of the canonical lifting of an
elliptic curve in Serre-Tate theory. In fact, this analogy is more than philosophical: Just
as in Chapter II, by using indigenous bundles on elliptic curves – regarded parabolically –
one can obtain a similar uniformization theory, involving a canonical Frobenius lifting (on
the moduli stack of ordinary elliptic curves) and a canonical indigenous bundle. We then
compute that these canonical objects for elliptic curves are precisely the canonical objects
89

that one obtains from classical Serre-Tate theory. Thus, one may regard the theory of
uniformizations and canonical liftings discussed in this Chapter as the natural hyperbolic
analogue of Serre-Tate theory.
§1. Generalities on Ordinary Frobenius Liftings
Let k be a perfect ﬁeld of odd characteristic p. Let A = W (k), the ring of Witt
vectors with coeﬃcients in k. Let S be a formally smooth, geometrically connected p-adic
formal scheme over A of constant relative dimension d. Let S log be a log formal scheme
whose underlying formal scheme is S and whose log structure is given by a relative divisor
with normal crossings D ⊆ S over A. Let ΦA : A → A be the Frobenius morphism on A.
Let us denote the result of base changing by ΦA by means of a superscripted “F .” Let
Φlog : S log → S log be a Frobenius lifting, i.e., a morphism whose reduction modulo p is the
usual Frobenius morphism in characteristic p. In this Section, we shall study the case of
a certain kind of Frobenius lifting, called an ordinary Frobenius lifting. It turns out that
such Frobenius liftings deﬁne various types of canonical parameters. It is these canonical
parameters that will constitute the various “uniformizations” that we obtain in this paper.
Basic Deﬁnitions
Let us consider the morphism
log
dΦlog : Φ∗ Ωlog
S/A → ΩS/A

induced by Φlog on logarithmic diﬀerentials. It is always divisible by p.
Deﬁnition 1.1. We shall call Φlog : S log → S log an ordinary Frobenius lifting if p1 · dΦlog :
log
Φ∗ Ωlog
S/A → ΩS/A is an isomorphism.

We shall use the notation
log
ΩΦ : Φ∗ Ωlog
S/A → ΩS/A

to denote the isomorphism p1 · dΦlog . Note that by considering the sections of Ωlog
S/A which
are invariant under ΩΦ , we obtain an étale sheaf Ωet
Φ in free Zp -modules of rank d on S.
Deﬁnition 1.2. We shall call Ωet
Φ the canonical diﬀerential local system on S associated
to Φlog . We shall call its dual Θet
Φ the canonical tangential local system on S associated to
log
Φ .
90

Moreover, by taking the sections of Ωet
Φ to be horizontal, we obtain a natural connection
log
log
∇Ω on ΩS/A which is associated to Φ . Note that since Ωet
Φ is an étale (not just log étale)
local system on S, the connection ∇Ω is a connection on S with respect to the trivial log
structure, i.e., it has no logarithmic poles at D.
The Uniformizing Galois Representation
Now we would like to associate to Φlog a canonical “uniformizing MF ∇ -object” (where
we use the category MF ∇ in the sense of [Falt], §2) as follows. Let
P = Ωlog
S/A ⊕ OS
We regard P as being ﬁltered by taking the ﬁltration
def

def

def

0
F 2 (P) = 0; F 1 (P) = Ωlog
S/A ⊕ 0 ⊆ P; F (P) = P

Let ∇P be the logarithmic connection on P obtained as follows: We start with the connection ∇P on P which is the direct sum of the trivial connection on OS and the connection

∇Ω on Ωlog
S/A . Then we add to ∇P the End(P)-valued logarithmic diﬀerential given by
log
log
∼
P → Ωlog
S/A = (0 ⊕ OS ) ⊗OS ΩS/A ⊆ P ⊗OS ΩS/A

where the ﬁrst morphism is the projection on the ﬁrst direct summand. The resulting
logarithmic connection on P will be called ∇P . Note that the Kodaira-Spencer morphism
for F 1 (P) ⊆ P with respect to ∇P is the identity map. Next, we deﬁne the Frobenius
action on P as follows: We take the Frobenius action to be the morphism PΦ : Φ∗ P → P
which is diagonal with respect to the direct sum decomposition P = Ωlog
S/A ⊕ OS and is
equal to Φ−1 on OS and to dΦlog on Ωlog
S/A . One sees easily that this Frobenius action PΦ
is horizontal with respect to ∇P . Note that this implies that ∇P is integrable, since its
∨
2 log
log
acts
curvature would deﬁne a Frobenius-invariant section of (Ωlog
S/A ) ⊗OS ∧ ΩS/A , but Φ
on this bundle with slope 1, so any Frobenius-invariant section must necessarily vanish.
Thus,
(P, F · (P), ∇P , PΦ )
deﬁnes an MF ∇ -object in the sense of [Falt], §2.
Deﬁnition 1.3. We shall call this MF ∇ -object the uniformizing MF ∇ -object on S log
associated to Φlog .
91

log
Now choose a base point s : Spf(A) → S that avoids D. Let ΠS log = π1 (SK
, sK ),
where K is the quotient ﬁeld of A, and by the fundamental group of “S log ,” we mean the
fundamental group of the open formal subscheme which is the complement of divisors that
deﬁne the log structure. Then by the theory of [Falt], §2, the uniformizing MF ∇ -object
on S log deﬁnes a dual crystalline Galois representation

Pet
of ΠS log .
Deﬁnition 1.4. We shall call this Galois representation the uniformizing Galois representation on S log associated to Φlog .
Note that OS ∼
= (0 ⊕ OS ) ⊆ P is stabilized by ∇P and PΦ , and thus deﬁnes an MF ∇ subobject of the uniformizing object which is equal to the trivial MF ∇ -object. If we take
the quotient of the uniformizing MF ∇ -object by this subobject, we obtain the MF ∇ object corresponding to the étale Galois representation Θet
Φ , Tate twisted once. Thus, we
have an exact sequence of ΠS log -modules
0 → Θet
Φ (1) → Pet → Zp → 0
which thus deﬁnes an extension class:
ηΦ ∈ H 1 (ΠS log , Θet
Φ (1))
We remark relative to the analogy between Frobenius liftings and Kähler metrics, that the
class ηΦ formally “looks” somewhat like the diﬀerential form that deﬁnes a Kähler metric.
Also, we can deﬁne a ring with Galois action which will be useful later. First consider
the symmetric algebra on Ωet
Φ (−1) over Zp :
S·Zp Ωet
Φ (−1)
Let us consider the Galois action of ΠS log on this symmetric algebra which diﬀers from
the direct sum of the actions on the Si (Ωet
Φ (−1)) by the class ηΦ . Thus, in other words,
Spec of the symmetric algebra with this Galois action parametrizes sections of the exact
sequence
0 → Θet
Φ (1) → Pet → Zp → 0
If we then adjoin the divided powers of the augmentation ideal to this Zp [ΠS log ]-algebra,
we obtain a Zp -algebra AΦ . Let T log → S log be the ﬁnite covering given by Φlog (so
92

T log ∼
= S log ). Since this ﬁnite covering is log étale in characteristic zero, we may form the
subgroup ΠT log ⊆ ΠS log corresponding to this covering. Then one sees easily that we have
a natural ΠT log -action on AΦ , compatible with the ΠS log -action on the symmetric algebra.
(We need to restrict to ΠT log so that the Galois action respects the divided powers.)
Deﬁnition 1.5. We shall call ηΦ the canonical Galois extension class associated to Φlog .
We shall call AΦ the ring of additive periods of Φlog .
The Canonical p-divisible Group
Let us look at the uniformizing MF ∇ -object
(P, F · (P), ∇P , PΦ )
again. Let U ⊆ S be the open formal subscheme which is the complement of the divisor
U . Then by [Falt], Theorem 7.1, this MF ∇ -object deﬁnes a p-divisible group GΦ over U .
Moreover, just as with the corresponding Galois representation discussed in the previous
subsection, we have an exact sequence of p-divisible groups over U :
0 → Θet
Φ (1) ⊗Zp Qp /Zp → GΦ → Qp /Zp → 0
Deﬁnition 1.6. We shall call GΦ the canonical p-divisible group associated to Φlog .
Now let ω ∈ Ωet
Φ be an element whose reduction modulo p is nonzero. Thus, ω deﬁnes
a Zp -linear morphism
ω(−) : Θet
Φ → Zp
Let Sn → S be the étale covering deﬁned by taking the kernel of the morphism ΠS log →
n
n
GL(Θet
Φ ⊗ Z/p Z). Let Un → U be its restriction to U . Then over Un , ω(−) ⊗ Z/p Z will
be Galois equivariant, so that, by pushing forward the above exact sequence by means of
ω(−), we obtain an exact sequence of ﬁnite ﬂat group schemes:
0 → Z/pn Z(1) → Gω,n → Z/pn Z → 0
which, by Kummer theory, deﬁnes an element
n

×
× p
uω,n ∈ Γ(Un , OU
)/Γ(Un , OU
)
n
n

and thus a diﬀerential
93

ωn = (duω,n )/uω,n ∈ Γ(Un , ΩUn /A ⊗ Z/pn Z)
def

Now let n → ∞. Let S be the p-adic completion of the inverse limit of the Sn . Since the
various ωn are compatible, we thus obtain a diﬀerential
, Ω
ω  ∈ Γ(U
/A )
U
Now we would like to claim that ω  is none other than the original diﬀerential ω that we
started out with. In some sense, I believe that this fact is well-known, but I do not know
of a clear reference for this fact, so I will prove it explicitly here. First, however, we need
to make a few more general observations concerning GΦ . The proof will be given in the
subsection after the next.
Logarithms of Periods
Suppose that k is algebraically closed, and let z : Spf(A) → S be a rational point
whose reduction modulo p is equal to the base point s. In particular, it follows that z
 (since it coincides with the base point s
maps into U , and factors canonically through U
modulo p). Thus, we can restrict the Gω,n to Spec(A) via z so as to obtain an extension
0 → Qp /Zp (1) → Gω,z → Qp /Zp → 0
of p-divisible groups over Spec(A). By Kummer theory, this extension deﬁnes a unit
uω,z ∈ A×
whose image in the residue ﬁeld k is 1.
On the other hand, we can consider the Dieudonné crystal Eω of Gω,z . Thus, Eω
is a free A-module of rank two with a ﬁltration F 1 (Eω ) ⊆ Eω , and a Frobenius action
ΦE : EωF → Eω . This Frobenius action has a unique subspace EF ⊆ Eω (respectively,
EV ⊆ Eω ) on which Frobenius acts with slope zero (respectively, one). Also, EV and
F 1 (Eω ) deﬁne the same subspace modulo p. Since F 1 (Eω ) and E/F 1 (Eω ) are naturally
isomorphic to A, in the future, we shall identify them with A. Thus, by projection EF →
Eω → Eω /F 1 (Eω ) = A, we obtain a natural isomorphism of EF with A, and, dually,
a natural isomorphism of EV with A. Finally, since Eω = EF ⊕ EV , we may regard
F 1 (Eω ) ⊆ Eω as the graph of an A-linear morphism A = EV → A = EF , which, by means
of the various canonical trivializations, gives us an element Lω,z ∈ p · A.
Theorem 1.7. We have Lω,z = log(uω,z ).
94

Proof. Let us denote the sequence of Galois modules which are the p-adic Tate modules
of the above exact sequence of p-divisible groups by 0 → W 0 → W → W 1 → 0. Recall the
exponential map of [BK], p. 359, Deﬁnition 3.10,
1
exp : F 1 (Eω )⊗−2 ∼
(Zp (1))
= A → A× = HGal
1
where the ﬁrst isomorphism is the trivialization referred to above, and HGal
denotes Galois
cohomology with respect to Gal(K/K), where K is the quotient ﬁeld of K. By [BK], p. 359,
Example 3.10.1, one knows that this exponential map is equal to the ordinary exponential
map deﬁned by the exponential series. Let η2 = log(uω,z ); η1 = exp(η2 ).

Now we diagram-chase. Let us denote by P the (inﬁnite dimensional) Galois module
Bcrys f =1 ⊕ BDR + (notation of [BK]). Applying the exact sequence (1.17.1) of [BK] to the
exact sequence of Galois modules 0 → W 0 → W → W 1 → 0, we obtain the following
commutative diagram:
0
(W 0 )
HGal
⏐
⏐

−→

0
HGal
(W )
⏐
⏐

−→

0
HGal
(W 1 )
⏐
⏐

−→

1
HGal
(W 0 )
⏐
⏐

0
(W 0 ⊗ P)
HGal
⏐
⏐

−→

0
HGal
(W ⊗ P)
⏐
⏐

−→

0
HGal
(W 1 ⊗ P)
⏐
⏐

−→

1
HGal
(W 0 ⊗ P)
⏐
⏐

0
HGal
(W 0 ⊗ BDR )

−→

0
HGal
(W ⊗ BDR )

0
−→ HGal
(W 1 ⊗ BDR ) −→

1
HGal
(W 0 ⊗ BDR )

0
(W 1 ) which maps via the connecting homomorphism to
Now we have an element 1 ∈ HGal
1
0
1
η1 ∈ HGal (W ); since the image of η1 in HGal
(W 0 ⊗P) is zero, we can consider log(η1 ) = η2 .
0
0
On the other hand, 1 ∈ HGal
(W 1 ) maps to an element η3 ∈ HGal
(W 1 ⊗ P) that dies when
1
(W 0 ⊗ P). Thus we see that η3 comes from
hit with the connecting homomorphism to HGal
0
0
an element η4 ∈ HGal (W ⊗ P) which is unique modulo HGal
(W 0 ⊗ P). Mapping η4 down
0
0
0
one step to HGal
(W ⊗ BDR ), we get η5 ∈ HGal
(W ⊗ BDR ) that dies in HGal
(W 1 ⊗ BDR ),
0
0
0
0
hence comes from a unique η6 ∈ HGal (W ⊗ BDR )/HGal (W ⊗ P) = T V . Now it follows
from the explicit deﬁnitions of the maps in the sequence (1.17.1) of [BK] that η6 is precisely
Lω,z . On the other hand, it follows from general principles of homological algebra that
η6 = η2 . This completes the proof. 

Compatibility of Diﬀerentials
Now we return to the issue of showing that ω  = ω. Let us begin by observing that ω
 , we
can also be deﬁned as follows. By taking the direct limit of the Gω,n ’s restricted to U
obtain an extension of p-divisible groups
0 → Qp /Zp (1) → Gω → Qp /Zp → 0
95

 . This, moreover, deﬁnes a Dieudonné crystal (E, ∇E ) with a ﬁltration F 1 (E) ⊆ E,
over U
and Frobenius action. In fact, (E, ∇E ) is obtained from (P, ∇P ) simply by pulling back
0 → OS → P → ΩS/A → 0 via ω· : OU → ΩS/A |U . Now F 1 (E) and E/F 1 (E) may
be identiﬁed with OU . Thus, ω is precisely the diﬀerential obtained by considering the
Kodaira-Spencer morphism
F 1 (E) = OU → ΩU/A ⊗ (E/F 1 (E)) = ΩU/A
Now let Rz be the complete local ring which is the completion at z of U . Let RzPD be
the p-adic completion of the PD-envelope of Rz at the augmentation ideal Rz → A deﬁned
by z. Now taking the inverse limit of the uω,n ’s deﬁnes a unit
uω ∈ (RzPD )×
whose image in the residue ﬁeld k is 1. Thus, we can consider log(uω ) ∈ RzPD .
On the other hand, let Pz = P(z ∗ E) = P(Eω ). Let σF : S → Pz (respectively, σV :
S → Pz ) denote the section determined by the subspace EF ⊆ Eω (respectively, EV ⊆ Eω ).
The trivializations discussed previously deﬁne an isomorphism of the tangent space to Pz
at σF with A. Thus, in summary, we get an isomorphism ψ : Pz ∼
= P1 by sending σF
(respectively, σV ) to inﬁnity (respectively, zero) and using the trivialization of tangent
space to σF to remove the remaining multiplicative ambiguity. Let PRzPD = P(E)|Spf(RzPD ) .
Then ∇E gives an isomorphism
ΞP : PRzPD ∼
= RzPD ⊗A Pz
which, when composed with ψ, gives an isomorphism μ : PRzPD ∼
= P1RzPD . Now by Theorem
1.7, it follows that the Hodge section (deﬁned by F 1 (E) → E)
σ : Spf(RzPD ) → PRzPD ∼
= P1RzPD
is (in terms of the standard coordinate t on P1 , which vanishes at zero and has a pole at
inﬁnity) simply log(uω ). (Indeed, Theorem 1.7 tells us that this is true after restriction
to any A-valued point of RzPD ; hence it must be true over RzPD .) It thus follows that the
def

pull-back of the diﬀerential dt on P1 via σ is simply ω  = duω /uω . But, tracing through
all the deﬁnitions, the pull-back of dt via the Hodge section is exactly the Kodaira-Spencer
morphism of the Hodge ﬁltration. Thus, we conclude that ω = ω  over RzPD . On the other
 (since O → RPD is injective).
hand, it is clear that this implies that ω = ω  over all of U
z

U
Thus, we have proven the following
.
Theorem 1.8. We have ω = duω /uω = ω  over U
96

Note that this holds (by descent) without the assumption that k is algebraically closed.
Canonical Liftings of Points in Characteristic p
Let α1 ∈ S(A) be an A-valued point of S. Suppose we apply Φ to α1 to obtain an
A-valued point β1 ∈ S(A). Then since Φ is a Frobenius lifting, it induces zero on the
morphism on cotangent spaces modulo p. Thus, β1 (mod p2 ) depends only on α1 (mod p).
Let α2 = Φ−1
A (β1 ). Thus, α2 ≡ α1 (mod p), and α2 depends only on α1 (mod p). If we then
continue in this fashion, deﬁning
αi+1 = Φ−1
A Φ(αi )
def

it is clear that αi ≡ α1 (mod p) for all i ≥ 1, and that the sequence {αi } of points in S(A)
converges p-adically. Let α∞ ∈ S(A) be the limit of this sequence. Let α0 ∈ S(k) be the
reduction of α1 modulo p. Note that we have
F
Φ(α∞ ) = α∞

and that, moreover, α∞ is the unique A-valued point of S which has this property and is
equal to α0 modulo p.
Deﬁnition 1.9. We shall call α∞ the canonical lifting of α0 . We shall call an A-valued
point of S which is a canonical lifting of some k-valued point a canonical A-valued point
of S.
All the canonical extensions that we have deﬁned become trivial when restricted to α∞ .
More precisely,
Proposition 1.10. If α0 ∈ U (k), then the restriction of uω to α∞ is 1.
Proof. Indeed, the Hodge ﬁltration of P is invariant under Φ, so its restriction to α∞
is still Frobenius invariant. By the theory of ﬁltered Dieudonné modules with Frobenius
action over A = W (k), it thus follows that the extension of p-divisible groups that one
obtains is trivial. Thus, by Kummer theory, uω |α∞ = 1. 
Canonical Multiplicative Parameters
Let us assume just in this subsection that k is algebraically closed. Let z ∈ S(k) be
a k-valued point of S. Let Szlog be the completion of S log at z. Thus, Szlog is Spf of a
complete local ring Rz which is noncanonically isomorphic to
97

A[[t1 , . . . , td ]]
with the restriction of the divisor D deﬁned by t1 · t2 · . . . · ti (where i may be zero). Then
log
if we restrict Ωet
Φ to Sz , we obtain the trivial local system.
Let ω ∈ Ωet
Φ have integral residues at all the irreducible components of D, and nonzero
reduction modulo p. Thus, ω deﬁnes a surjection
ω(−) : Θet
Φ → Zp
If we apply ω(−) to our canonical extension of p-divisible groups
0 → Θet
Φ (1) ⊗Zp Qp /Zp → GΦ → Qp /Zp → 0
def

we obtain an extension of Qp /Zp by Qp /Zp (1) over Uz = Sz |U . By Kummer theory, we
thus obtain a “logarithmic unit”
qω,z ∈ Rz [

1
1
, . . . , ]×
t1
ti

which is well-deﬁned up to multiplication by a Teichmüller representative of an element of
k. If ω has residue ej at the component of D deﬁned by tj , then the valuation of qω,z at
(tj ) is equal to ej . Indeed, this follows from the formula dqω,z /qω,z = ω (of Theorem 1.8).
Next, let us consider Φ−1 (qω,z ). Since Φ−1 multiplies dqω,z /qω,z = ω, as well as the
p
, for some
canonical extension of p-divisible groups by p, it follows that Φ−1 (qω,z ) = λ · qω,z
λ ∈ [k× ] (where the brackets mean “the Teichmüller representative of”). On the other
hand, because Φ is a Frobenius lifting, reducing modulo p shows that λ = 1. Thus, we
have that
p
Φ−1 (qω,z ) = qω,z

Deﬁnition 1.11. We shall call qω,z for such an ω a canonical multiplicative parameter
associated to Φlog .
Canonical Aﬃne Coordinates
In this subsection, k need not be algebraically closed. Let α ∈ U (A) be canonical.
Let Aα be the p-adic completion of the PD-envelope of S at the subscheme Im(α). Let
α
→ A be the augmentation that deﬁnes the point α. Let I = Ker( α ). The
α : A
A-algebra structure, together with the augmentation α deﬁne a splitting
98

Aα = A ⊕ I
which we shall call the augmentation splitting of Aα . Note that we have an A-linear
Frobenius action
ΦA : (Aα )F → Aα
induced by the Frobenius lifting Φ. Moreover, ΦA preserves the augmentation splitting,
as well as the ring structure of Aα .
Let us consider the slopes of this Frobenius action ΦA . Clearly, ΦA acts on A⊕0 ⊆ Aα
as ΦA . Next, we note that since ΦA is a Frobenius lifting, it maps I into p · I. Thus, we
have
ΦA (I [j] ) ⊆ pj · I [j]
where the superscript in brackets denotes the divided power. By the deﬁnition of an
def
ordinary Frobenius lifting, Ωα = I/I [2] has constant slope one. Thus, if we divide ΦA
restricted to Ωα by p, we obtain an isomorphism
(Ωα )F → Ωα
Next, let us consider the A-submodule Ωcan ⊆ I which is the closure (in the p-adic
topology) of the intersection of the images of ( 1p · ΦA |I )N (for all N ≥ 1). Since I/I [2] has
slope 1, it is clear that the projection Ωcan → Ωα is surjective. Now let us consider the
intersection of Ωcan with I [2] . Let φ = ( p1 · ΦA |I )N (ψ), where ψ ∈ I. If φ is contained in
I [2] modulo pN , then since I/I [2] has slope 1, it follows that ψ must also be contained in
I [2] modulo pN . But then φ = ( p1 ·ΦA |I )N (ψ) must be zero modulo pN . Thus, we conclude
that the projection Ωcan → Ωα must be an isomorphism. Inverting this isomorphism, we
thus get a canonical morphism
κ A : Ω α → Aα
Let S α be the formal scheme which is the p-adic completion of the PD-envelope in S of
the image of α ∈ U (A). Let Θα be the dual A-module to Ωα . Let Θaﬀ
α be the p-adic
completion of the PD-envelope at the origin of the aﬃne space modeled on Θα . Thus, Θaﬀ
α
is Spf of the p-adic completion of the PD-envelope of the symmetric algebra (over A) of
Ωα at the augmentation ideal. We may then reinterpret the canonical morphism κA as an
isomorphism
α
U can : Θaﬀ
α →S

99

We thus see that we have proven the following result:
Theorem 1.12. For every choice of a canonical α ∈ U (A), we obtain a local uniformization (canonically associated to Φ)
∼ α
U can : Θaﬀ
α = S
of S by the aﬃne space modeled on Θα .
Deﬁnition 1.13. We shall call the elements of the image of κA canonical aﬃne parameters
associated to Φ at α.
Now let (B, mB ) be a local ring with residue ﬁeld k which is p-adically complete and
has a topologically nilpotent PD-structure on mB . Let β ∈ S(B) be such that β(mod mB ) ∈
S(k) is equal to α(mod p) ∈ S(k). Let S β be the p-adic completion of the PD-envelope of
S ⊗A B at the image of β in S(B). Thus, S β ∼
= S α ⊗A B. Let B β = Aα ⊗A B. By tensoring
the canonical morphism κA constructed above with B, we thus obtain a morphism
def

κB : (Ωα )B = (Ωα ) ⊗A B → B β
Let β : B β → B be the augmentation corresponding to the point β ∈ S(B). Let Iβ =
Ker(β). Let
B β = B ⊕ Iβ
be the splitting deﬁned by β and the B-algebra structure on B β . Let us consider the
projections of κB on these two factors:
κ0B : (Ωα )B → B;

κ1B : (Ωα )B → Iβ

[2]

Let Ωβ = Iβ /Iβ . If we compose κ1B with the projection to Ωβ , we thus obtain a morphism
Ψαβ : (Ωα )B → Ωβ
which is an isomorphism, since it is an isomorphism modulo mB , where β coincides with
α(mod p). Let Θβ the dual B-module to Ωβ . Now we may regard κ0B as an element
−1
of (Θα )B ; if we apply (Ψ∨
, then we get an element of κβ ∈ Θβ , hence ∈ mB · Θβ
αβ )
(since β ≡ ( α )B modulo mB ). On the other hand, if we compose κ1B with Ψ−1
αβ , we get a
β
morphism Ωβ → B which gives us an isomorphism
100

β
U β : Θaﬀ
β →S

In summary, we have proven the following result:
Theorem 1.14. For every β ∈ S(B) as above, we obtain a canonical class κβ ∈ mB · Θβ ,
as well as a local uniformization
∼ β
U β : Θaﬀ
β =S
of S by the aﬃne space modeled on Θβ . Moreover, this uniformization is related to the
canonical uniformization by tensoring over A with B, applying the isomorphism
−1
: (Θα )B → Θβ
(Ψ∨
αβ )

and then translating by κβ . Finally, for all β ∈ S(B) whose reductions modulo mB are
equal to α(mod p), the correspondence β → κβ is a bijection of such β onto mB · Θβ .
Proof. All the statements except the last follow from the way we constructed the objects involved. The last statement about the bijection follows from simply evaluating the
canonical uniformization of Theorem 1.12 on B-valued points. 
Finally, we remark (relative to the analogy between Frobenius liftings and Kähler
metrics) that these canonical aﬃne parameters are like canonical coordinates for a real
analytic Kähler metric.
The Relationship Between Aﬃne and Multiplicative Parameters
Let us continue with the notation of the preceding subsection, but let us assume in
addition that k is algebraically closed, so that the canonical multiplicative parameters are
deﬁned. Let ω ∈ Ωet
Φ have integral residues at all the irreducible components of D, and
nonzero reduction modulo p. Since Ωet
Φ ⊆ Ωα , we may also regard ω as an element of
Ωα . Then we would like to establish the relationship between the canonical multiplicative
parameter qω,α and the canonical aﬃne parameter κA (ω).
First note that by Proposition 1.10, qω,α evaluated at α is a Teichmüller representative.
Thus, log(qω,α ) ∈ Aα is zero at α, as is κA (ω) ∈ Aα . Moreover, d log(qω,α ) = ω, by
Theorem 1.8. On the other hand, the fact that d κA (ω) = ω is a tautology. Thus,
log(qω,α ) and κA (ω) have the same derivative and both vanish at α. We thus obtain the
following result:
101

Theorem 1.15. We have κA (ω) = log(qω,α ) in Aα .

§2. Construction of the Canonical Frobenius Lifting
log

In this Chapter, we shall denote by Mg,r the p-adic formal stack of r-pointed stable
curves of genus g over Zp . We shall denote the reductions of objects over Zp to Fp or Z/p2 Z
ord

by means of a subscripted Fp or Z/p2 Z. Let (N g,r )Fp → (Mg,r )Fp be the étale morphism
ord

in characteristic p of Chapter II, §3. Thus, (N g,r )Fp parametrizes pairs consisting of an
r-pointed stable curve of genus g in characteristic p, together with an ordinary, nilpotent
ord
indigenous bundle. Let N g,r → Mg,r be the unique étale morphism of p-adic formal
ord

ord

schemes that lifts (N g,r )Fp → (Mg,r )Fp . Thus, N g,r is a smooth p-adic formal scheme
ord

over Zp whose reduction modulo p is (N g,r )Fp . Our goal in this Section is to construct a
ord

canonical ordinary lifting of Frobenius on N g,r .
Modular Frobenius Liftings
In this subsection, we reinterpret certain constructions from Chapter II, §1, in terms of
liftings of the Frobenius morphism on (Mg,r )Fp . Let S → (Mg,r )Fp be étale, and let S log
log

be the log scheme obtained by pulling back the log structure of Mg,r . Thus, in particular,
S is smooth over Fp . Let ΦS log : S log → S log be the absolute Frobenius morphism.
Since (Mg,r )Fp ⊆ (Mg,r )Z/p2 Z is deﬁned by a nilpotent ideal, the étale morphism S →
(Mg,r )Fp lifts naturally to an étale morphism S → (Mg,r )Z/p2 Z . We let Slog be the
log scheme obtained by pulling back the log structure of (Mg,r )Z/p2 Z . We shall call a
Frobenius lifting on Slog a log morphism Slog → Slog whose reduction modulo p is equal
to ΦS log . Note that by assigning to étale morphisms U → S the set of Frobenius liftings
 log , we obtain a sheaf L on the étale site of S, with the natural structure of a torsor
on U
def
∗
over ΘΦ
S log = ΦS ΘS log , where ΘS log is the dual vector bundle to the sheaf of logarithmic
diﬀerentials on S log . Moreover, this torsor naturally admits a connection ∇L as follows:
Consider the sheaf of bianalytic functions OS bi on S log . The image IΦS of the Frobenius
−1
morphism ΦS bi : OS bi → OS bi is equal to iL (Φ−1
S OS ), as well as to iR (ΦS OS ) (where
iL , iR : OS → OS bi are the left and right injections). Thus, the pull-back of the sheaf
L by either iL or iR is equal to the sheaf of liftings of IΦS to a Z/p2 Z-ﬂat subalgebra of
OSbi . This gives a connection ∇L on the ΘΦ
S log -torsor L → S which is compatible with
Φ
the natural connection on ΘS log (for which sections of Φ−1
S ΘS log are horizontal); also, one
checks easily that ∇L is integrable.
Now let us recall the ΘΦ
S log -torsor D → S that we deﬁned in Chapter II, §1. Let
log

f log : X log → S log be the pull-back to S log of the universal curve over (Mg,r )Fp . Recall
102

log F
then that D is the ΘΦ
) = X log ×S log ,ΦSlog
S log -torsor consisting of liftings of the curve (X

S log → S log to an S-ﬂat
curve Y log → Slog . Note that it follows immediately from the
log

deﬁnition of the classifying log stack Mg,r (plus the fact that S → Mg,r is étale) that we
have an isomorphism
α:D→L
 log → Slog (which
of ΘΦ
S log -torsors given by considering the classifying map of the lifting Y
is, by deﬁnition, a Frobenius lifting on Slog ). On the other hand, the theory of Chapter II, §1, gives a natural connection ∇D on D → S as follows. Recall the line bundle
def
T = (ΦX log /S log )∗ (τX log /S log )F on X log . By declaring the sections of the τX log /S log inside
the deﬁnition of T to be horizontal, we see that T gets a natural connection ∇T over X log
(i.e., not just in the relative sense for f log : X log → S log ). Thus, the de Rham cohomology
module R1 fDR,∗ (T ) has a Gauss-Manin connection ∇GM on S log . By Chapter II, Proposition 1.1, we have a natural surjection R1 fDR,∗ (T ) → OS , which one veriﬁes easily to be
horizontal. Since, by Chapter II, Proposition 1.2, D is just the sheaf of sections of this
surjection R1 fDR,∗ (T ) → OS , it thus follows that, as such, D gets a natural connection
(induced by ∇GM ), which we shall call ∇D .
Proposition 2.1. The isomorphism α is horizontal with respect to ∇D and ∇L .
Proof. Let us denote by X L (respectively, X R ) the pull-back of f log : X log → S log via
iL : OS → OS bi (respectively, iR : OS → OS bi ) to S bi . Thus, we obtain a diagram over
S bi :
X L ← X bi → X R
Let us denote the left-pointing (respectively, right-pointing) arrow by πL (respectively, πR ).
Similarly, we have an analogous diagram with tildes, for the various objects over Z/p2 Z.
Now consider the image of Frobenius IΦS ⊆ OS bi . We also have the image of the absolute
Frobenius on X, which we denote by IΦX ⊆ OX bi . Note that IΦX actually sits inside both
OX L and OX R .
Suppose next that we are given a Z/p2 Z-ﬂat subalgebra IΦS ⊆ OSbi that lifts IΦS . This
corresponds to a section η of LL = LR . (Here the superscript “L”’s and “R”’s denote
left and right pull-backs to S bi , respectively.) The obstruction to lifting IΦX to a Z/p2 Z1 L
L
S
ﬂat subalgebra of OX
L compatible with IΦ deﬁnes a class in R (f )∗ (T ), which is, by
def

def

deﬁnition, equal to ξ[L] = (αL )−1 (η). Similarly, we obtain a class ξ[R] = (αR )−1 (η).
Note that (πL )−1 (ξ[L]) = (πR )−1 (ξ[R]), since both classes are the obstruction to lifting
IΦX to a Z/p2 Z-ﬂat subalgebra of OX bi compatible with IΦS . Let us call this common class
ξ[bi].
103

Now suppose that (I )SΦ ⊆ OS is a Z/p2 Z-ﬂat lifting of IΦS . Suppose that this lifting corresponds to a section ζ of L. If we then take η = ζ L (in the previous paragraph), we get ξ[bi] = (πL )−1 {(α−1 (ζ))L }, and, similarly, if we take η = ζ R , we get
ξ[bi] = (πR )−1 {(α−1 (ζ))R }. On the one hand, ∇D (α−1 (ζ)) is computed by subtracting
these two ξ[bi]’s. On the other hand, (by the deﬁnition of the ΘΦ
S log -torsor structure on
D) the diﬀerence between these two ξ[bi]’s is the diﬀerence between the two classifying
morphisms given by the subalgebras {(I )SΦ }L and {(I )SΦ }R of OS bi . But this diﬀerence
is, by deﬁnition, ∇L (ζ). This completes the proof. 
Henceforth, we shall identify (D, ∇D ) with (L, ∇L ), and call the resulting torsor with
connection (D, ∇D ) (since the notation L is more natural for line bundles).
Indigenous Sections of D
We continue with the notation of the previous subsection. Thus, S → Mg,r is étale,
and we have the ΘΦ
S log -torsor D → S, with its connection ∇D . Let π : D → S be the
scheme corresponding to this torsor. Thus, D is a twisted version of Spec of the symmetric
algebra of the dual of ΘΦ
S log . We endow D with the log structure pulled back from S; this
log
gives us a log stack D . On D, taking the dual to the second fundamental exact sequence
for diﬀerentials gives a sequence of tangent bundles:
0 → ΘΦ
S log |D → ΘDlog → ΘS log |D → 0
where ΘDlog is the logarithmic tangent bundle on D log . We shall denote the surjection
ΘDlog → ΘS log |D by Θπ . The connection ∇D then deﬁnes a connection ∇D on the ﬁber
bundle π : D → S, hence a section ∇Θ : ΘS log |D → ΘDlog of Θπ .
Now let us suppose that we are given a section σ : S → D of π. Then σ induces a
section of σ ∗ Θπ , which we denote by Θσ : ΘS log → σ ∗ ΘDlog . Also, σ deﬁnes an FL-bundle
(E, ∇E ) (see Chapter II, §1) on the curve X log .
Deﬁnition 2.2. We shall call the section σ indigenous if the projectivization of the
FL-bundle on X log deﬁned by σ is an indigenous bundle on X log .
Let us assume that σ is indigenous. Then we obtain, for i = 1, 2, canonical morphisms of
vector bundles
φi : σ ∗ ΘDlog → ΘS log
deﬁned functorially as follows. By means of the étale morphism S → Mg,r , we can think
of the geometric vector bundle σ ∗ ΘDlog on S as parametrizing inﬁnitesimal deformations
η  = {(X log ) , (E  , ∇E  )} of the curve plus FL-bundle pair given by η = {X log , (E, ∇E )}.
104

Then the obstruction to lifting the Hodge ﬁltration of (E  , ∇E  )|X = (E, ∇E ) (which exists
since σ is indigenous) to a ﬁltration of E  over X  deﬁnes a section of ΘS log , which we take
for φ2 (η  ). On the other hand, if we think in terms of crystals, then (E  , ∇E  ) also deﬁnes
a deformation (E  , ∇E  ) of (E, ∇E ) on X[ ]/( 2 ). The obstruction to lifting the Hodge
ﬁltration of (E, ∇E ) to a ﬁltration of E  on X[ ]/( 2 ) deﬁnes a section of ΘS log , which we
take for φ1 (η  ). Since, σ ∗ Θπ (η  ) is simply the diﬀerence between (X log ) and the trivial
deformation of X log , we thus see that
σ ∗ Θπ = φ2 − φ1
We also have that
φ 1 ◦ σ ∗ ∇Θ = 0
Indeed, sorting through the deﬁnitions, one sees that the image of ∇Θ consists of the
η  = {(X log ) , (E  , ∇E  )} obtained by letting (E  , ∇E  ) be the FL-bundle given by regarding
(E, ∇E ) as a crystal and taking the bundle with connection that this crystal induces on the
deformation (X log ) . Thus, (E  , ∇E  ) is simply the trivial deformation of (E, ∇E ), hence
is indigenous on X log by assumption. Putting the above two formulas together, we thus
obtain that
φ2 ◦ σ ∗ ∇Θ = idΘSlog
Also, let us note that
φ2 ◦ Θσ = 0
since if it were nonzero, it would measure exactly the extent to which σ fails to stay within
the indigenous locus of D, but, by assumption, σ does stay within the indigenous locus.
Next, let us recall the morphism ΦτE : ΘΦ
S log → ΘS log , i.e., the dual to the “inﬁnitesimal
Verschiebung” of Chapter II, §2. Recall that this morphism was constructed by applying
R1 f∗ to the morphism T → τX log /S log given by composing the p-curvature P : T → Ad(E)
of E with the projection Ad(E) → τX log /S log arising from the Hodge ﬁltration. It thus
follows immediately from the deﬁnitions (by thinking about how one deﬁnes the obstruction
∗
that φ1 measures) that if we restrict φ1 : σ ∗ ΘDlog → ΘS log to ΘΦ
S log ⊆ σ ΘDlog , we get
φ1 |ΘΦ

S log

= ΦτE

So far we have been thinking about morphisms that one can obtain from σ by thinking
about the indigenous FL-bundle (E, ∇E ) that it deﬁnes. But by what we did in the previous
subsection, σ also deﬁnes a Frobenius lifting Φσ : Slog → Slog . Let us consider the
105

morphism ΘΦσ : ΘS log → ΘΦ
S log obtained by looking at the morphism induced by Φσ on
the tangent bundles, and then dividing by p. On the other hand, the morphism Θσ −σ ∗ ∇Θ :
∗
ΘS log → σ ∗ ΘDlog maps into ΘΦ
S log ⊆ σ ΘDlog . Thus, by abuse of notation, we shall regard
∗
Θσ − σ ∇Θ as a morphism ΘS log → ΘΦ
S log . Then we claim that
ΘΦσ = Θσ − σ ∗ ∇Θ
Indeed, if we think of σ ∗ ∇Θ as deﬁning a direct sum splitting of σ ∗ ΘDlog , then Θσ − σ ∗ ∇Θ
∗
is just the component of Θσ that sits in the vertical subspace ΘΦ
S log ⊆ σ ΘDlog . Put another
∗
Φ
way, Θσ −σ ∇Θ : ΘS log → ΘS log is the Kodaira-Spencer morphism for the section σ relative
to the connection ∇D . Thus, it follows from the deﬁnition of the connection called ∇L in
the previous subsection in terms of subalgebras of OS bi that ΘΦσ = Θσ − σ ∗ ∇Θ .
We are now ready to prove the main technical result of this subsection:
Proposition 2.3. If σ : S → D is an indigenous section, then −ΦτE is inverse to ΘΦσ . In
particular, the indigenous bundle associated to (E, ∇E ) is ordinary.
Proof. Indeed, using the various observations made above, we simply compute:
ΦτE ◦ ΘΦσ = φ1 ◦ (Θσ − σ ∗ ∇Θ )
= φ1 ◦ Θσ
= (φ1 − φ2 ) ◦ Θσ
= −(σ ∗ Θπ ) ◦ Θσ
= −idΘSlog
Thus, in particular ΦτE is an isomorphism, and so (E, ∇E ) deﬁnes an ordinary nilpotent
indigenous bundle. 
Frobenius Invariant Indigenous Bundles
ord

In this subsection, we change notation slightly. Let S → N g,r be an étale morphism
ord

of a p-adic formal scheme S into N g,r . Thus, S is formally smooth over Zp . Also, one may
ord

ord

think of S → N g,r as the unique étale lifting of its reduction SFp → (N g,r )Fp modulo
p. For convenience, we assume that SFp is aﬃne. Endow S with the log structure pulled
log

back from Mg,r . Thus, we get a p-adic formal log scheme S log . Pulling back the universal
curve over Mg,r , we get a morphism f log : X log → S log . Let hlog : Y log → S log be an
log
r-pointed curve of genus g whose reduction modulo p is equal to (X log )F
Fp → SFp , i.e., the
Frobenius transform of fFlog
. We shall denote the divisor of marked points on Y by E ⊆ Y .
p
106

Let n ≥ 2 be a natural number. Suppose that we have a coherent sheaf with connection (F, ∇F ) on Y log , where F is killed by pn and ﬂat over Z/pn Z, and the connection
∇F is relative to the morphism hlog : Y log → S log . Suppose, moreover, that we are given
a ﬁltration F 1 (F)Fp ⊆ FFp of the reduction of F modulo p. We shall call this ﬁltration
the Hodge ﬁltration. Then, relative to this data, we deﬁne the coherent sheaf with con/S log ).
nection F∗ (F, ∇F ) as follows. First, we regard (F, ∇F ) as a crystal on Crys(YFlog
p
Thus, if we apply the relative Frobenius morphism ΦX log /S log to this crystal (F, ∇F ), we
def

obtain a crystal (F, ∇F ) = Φ∗X log /S log (F, ∇F ) on Crys(XFlog
/S log ). Next, we consider
p
the subsheaf Φ∗X log /S log F 1 (F)Fp ⊆ FF p . If we then consider the subsheaf of (F, ∇F )
on Crys(XFlog
/S log ) consisting of sections whose reduction modulo p is contained in the
p

subsheaf Φ∗X log /S log F 1 (F)Fp , we obtain a crystal (F, ∇F ) on Crys(XFlog
/S log ). We then
p
let
F∗ (E, ∇E ) = (F, ∇F ) ⊗Zp Z/pn−1 Z
def

Deﬁnition 2.4. We shall call F∗ (F, ∇F ) the renormalized Frobenius pull-back of (F, ∇F ).

Note that if F is a vector bundle on YZ/pn Z , and F 1 (F)Fp is a vector bundle on YFp , with
the injection F 1 (F)Fp → FFp locally split, it follows immediately from the deﬁnitions that
the coherent sheaf F∗ (F) appearing in F∗ (F, ∇F ) is a vector bundle on XZ/pn−1 Z . Note
also that, if we think of the “input variable” (F, ∇F ) as a crystal on Crys(YFlog
/S log ), then
p
.
F∗ (F, ∇F ) does not depend on the choice of the deformation hlog : Y log → S log of YFlog
p

log
log
n
Often, we will be given a Frobenius lifting Φlog : SZ/p
n Z → SZ/pn Z modulo p , and we
log
log
log
log
will take YZ/p
n Z → SZ/pn Z (respectively, (F, ∇F )) to be the pull-back of XZ/pn Z → SZ/pn Z
(respectively, some (E, ∇E ) on X log ) by Φlog . If S were the spectrum of the ring of Witt
vectors of a perfect ﬁeld k, and n = 2, then the F∗ (E, ∇E )F that we have deﬁned here
would coincide with the F∗ (E, ∇E ) of Chapter II, Deﬁnition 2.9.
log
Now let (F, ∇F ) be a vector bundle with connection on YZ/p
n Z whose determinant
n−1
is trivial and which is indigenous modulo p
. We will denote its Hodge ﬁltration by
F 1 (F)Z/pn−1 Z ⊆ FZ/pn−1 Z . Let us denote by (G, ∇G ) the vector bundle with connection
on XZ/pn−1 Z which is the renormalized Frobenius pull-back of (F, ∇F ). Suppose, more∼
over, that (G, ∇G )F
Fp = (F, ∇F )Fp . Thus, one sees (as in the proof of Chapter II, Proposition 2.10) that (F, ∇F )Fp is nilpotent and admissible (hence corresponds, by Chapter II,
Proposition 2.5, to some FL-bundle).

Lemma 2.5. Let n ≥ 3. If we modify the connection ∇F by some pn−2 θ, where θ is a
section of h∗ (ωYlog/S )⊗2 (−E), then the vector bundle F∗ (F) (on XZ/pn−1 Z ), along with its
connection F∗ (∇F ), remain unchanged.
107

Proof. Looking at the deﬁnition of the renormalized Frobenius pull-back, one sees that
the pair (F∗ (F), F∗ (∇F )) is constructed by pulling back F (and ∇F ) via various local
liftings of ΦX log /S log , and then gluing together by means of gluing morphisms deﬁned
by the connection ∇F . Moreover, these gluing morphisms are obtained from the Taylor
expansion (cf. [Falt], §2, Theorem 2.3), which involves applying the connection ∇F to
tangent vectors pushed forward from the Frobenius lifting. Since such tangent vectors are
necessarily divisible by p (as well as being annihilated, of course, by pn ), it follows that
a knowledge of (∇F )Z/pn−1 Z suﬃces to compute these Taylor expansions. Thus, certainly
F∗ (F) depends at most on (∇F )Z/pn−1 Z . On the other hand, since at the end of the
construction of F∗ (F), we mod out by pn−1 · Φ∗X log /S log F 1 (F)Fp ⊆ pn−1 · Φ∗X log /S log FFp ,
we see that modifying ∇F by an endomorphism-valued diﬀerential whose image lies inside
pn−2 · F 1 (F) (where we have pn−2 rather than pn−1 since we always get an extra factor
of p from the fact that we are applying the connection to tangent vectors divisible by p)
does not aﬀect the result. This completes the proof. 
Now let us assume that (F, ∇F ) is a rank two vector bundle on YZ/pn Z with a connection (relative to hlog : Y log → S log ), whose determinant is trivial. Let us suppose,
moreover, that (F, ∇F )Z/pn−1 Z is indigenous. Let (G, ∇G ) = F∗ (F, ∇F ). As before, we
∗
∼
assume that (G, ∇G )F
Fp = (F, ∇F )Fp . Then by considering the result of applying F to various deformations (F, ∇F ) of (F, ∇F ) (i.e., such that (F, ∇F )Z/pn−1 Z = (F, ∇F )Z/pn−1 Z )
to obtain various deformations (G, ∇G ) of (G, ∇G ), we obtain a morphism:
(R1 fDR,∗ Ad(E)Fp )F → R1 fDR,∗ Ad(G)Fp ∼
= R1 fDR,∗ Ad(E)Fp
If we then compose this morphism with the projection
R1 fDR,∗ Ad(E)Fp → R1 f∗ (τX log /S log )Fp
arising from the Hodge ﬁltration, we obtain a morphism
(R1 fDR,∗ Ad(E)Fp )F → R1 f∗ (τX log /S log )Fp
which, by Lemma 2.5, vanishes on the subbundle
log ⊗2
1
F
) (−D))F
(f∗ (ωX/S
Fp ⊆ (R fDR,∗ Ad(E)Fp )

arising from the Hodge ﬁltration. Thus, we obtain a morphism of vector bundles
ΘF∗ : (R1 f∗ (τX log /S log )Fp )F → R1 f∗ (τX log /S log )Fp
Note that by Lemma 2.5, this morphism remains unchanged if one adds some pn−2 θ to
the connection ∇F .
108

Lemma 2.6. The morphism ΘF∗ is equal to −ΦτE .
Proof. In the gluing process referred to in the proof of Lemma 2.5, the deforming
n−1
cocycle in (τX log /S log )F
(τX log /S log )F (mod pn ) only aﬀects the Taylor expanFp = p
sion to ﬁrst order. Moreover, this cocycle in (τX log /S log )F
Fp is mapped to a cocycle in
∗
F
ΦX log /S log (τX log /S log )Fp → Ad(G)Fp ∼
= Ad(E)Fp , and hence to a cocyle in Ad(E)Fp . If
we then further project this cocycle via Ad(E)Fp → (τX log /S log )Fp , we obtain ΘF∗ of the
original cocycle. On the other hand, let us note that by Chapter II, Proposition 1.4, the
inclusion Φ∗X log /S log (τX log /S log )F
Fp → Ad(G)Fp = Ad(E)Fp is −1 times the p-curvature of
τ
(E, ∇E )Fp . Since ΦE is deﬁned by applying R1 f∗ to the p-curvature composed with the
projection Ad(E)Fp → (τX log /S log )Fp , we thus obtain the result. 
We are now ready to begin deﬁning a canonical Frobenius lifting on S log , which will
be fundamental to the entire paper. First, note that since (N g,r )Fp ⊆ (S g,r )Fp , we have a
ord

tautological trivialization (τN )Fp : (N g,r )ord
Fp → (S g,r )Fp of the torsor S g,r over (N g,r )Fp .
If we pull this trivialization back to S, we get a trivialization (τS )Fp : SFp → (S g,r )Fp ,
. This indigewhich thus deﬁnes a nilpotent, ordinary indigenous bundle (E, ∇E )1 on XFlog
p
nous bundle thus corresponds to an FL-bundle, hence a section of the torsor D (of the
log
log
previous subsection) over SFp , and hence a Frobenius lifting Φlog
2 : SZ/p2 Z → SZ/p2 Z . Now

log
let (E, ∇E )2 be any indigenous bundle on XZ/p
2 Z that lifts (E, ∇E )1 . (Such a lifting exists
log
log
log
since SFp is aﬃne.) We shall deﬁne Y log inductively. Let YZ/p
.
2 Z = XZ/p2 Z ×S log ,Φlog S
2

∗

∗

Let (F, ∇F )2 = (Φlog
2 ) (E, ∇E )2 . Then it is a tautology that if we take F (F, ∇F )2 , we
obtain (E, ∇E )1 (up to tensor product with a line bundle with connection whose square
is trivial; as usual, for the sake of simplicity, we shall ignore this). So far, to summarize,
log
of the objects constructed so far, Φlog
2 ; YZ/p2 Z ; and (E, ∇E )1 are canonical. The primed
objects are not canonical.
log
Let (F, ∇F )3 be any rank two bundle with connection on YZ/p
3 Z whose determinant
is trivial, and whose reduction modulo p2 is equal to (F, ∇F )2 . That is, (F, ∇F )3 is a
deformation of (F, ∇F )2 . Now by Lemma 2.6, and the fact that (E, ∇E )1 is ordinary, it
follows that, among all possible deformations (F, ∇F )3 of (F, ∇F )2 , there exists a unique
(up to changing the connection by some p2 · θ) such deformation (F, ∇F )3 such that
log
log
log
F∗ (F, ∇F )3 is indigenous on XZ/p
2 Z . Let YZ/p3 Z be the unique deformation of YZ/p2 Z
log
such that when one evaluates the crystal (F, ∇F )3 on YZ/p
3 Z , it becomes indigenous.
∗

Let (E, ∇E )2 = F (F, ∇F )3 . By Lemma 2.5, (E, ∇E )2 is independent of the choice of
log
log
log
∗
: SZ/p
(E, ∇E )2 or (F, ∇F )3 . Let (F, ∇F )2 = (Φlog
3 Z → SZ/p3 Z be
2 ) (E, ∇E )2 . Let Φ3

log
log
the classifying morphism of the r-pointed stable curve of genus g given by YZ/p
3 Z → SZ/p3 Z .
log
log
log
Thus, Φlog
3 lifts Φ2 . Again, to summarize, the objects Φ3 ; YZ/p3 Z ; and (E, ∇E )2 (as well

log
as (F, ∇F )2 ) are canonical. If we now let (E, ∇E )3 be an indigenous bundle on XZ/p
3Z

109

∗

that lifts (E, ∇E )2 , and (F, ∇F )3 = (Φlog
3 ) (E, ∇E )3 (where the primed bundles are newly
chosen here, hence diﬀerent from the temporary ones we chose before), it follows from
Lemma 2.5 that (E, ∇E )2 ∼
= F∗ (F, ∇F )3 .

Continuing in this fashion (making repeated use of Lemmas 2.5 and 2.6, as well as
the fact that (E, ∇E )1 is ordinary), we thus obtain a canonical Frobenius lifting Φlog :
S log → S log (of p-adic formal schemes), as well as a canonical indigenous bundle (E, ∇E )
on X log such that F∗ (Φlog )∗ (E, ∇E ) ∼
= (E, ∇E ) (up to tensor product with a line bundle
with connection whose square is trivial). Moreover, note that by Proposition 2.3, this
Frobenius lifting Φlog is ordinary.
Deﬁnition 2.7. Let Ψlog : S log → S log be a Frobenius lifting. We shall call an indigenous
bundle (G, ∇G ) on X log Frobenius invariant for Ψlog if (G, ∇G ) ∼
= F∗ (Ψlog )∗ (G, ∇G ) (up to
tensor product with a line bundle with connection whose square is trivial).
So far, we have been working over our aﬃne scheme S, which is étale over Mg,r . However,
since the objects that we have constructed (namely, Φlog and (E, ∇E )) are canonical, i.e.
uniquely characterized by certain properties that have nothing special to do with S, it is
ord
clear that they all descend to (N g,r )log . We thus see that we have proven the following
key result:
ord

Theorem 2.8. On (N g,r )log , there exists a canonical ordinary Frobenius lifting
ord

ord

log
Φlog
→ (N g,r )log
N : (N g,r )
ord

together with a canonical indigenous bundle (EN , ∇EN ) on C log (where C log → N g,r is the
universal r-pointed curve of genus g) whose reduction modulo p is equal to the nilpotent,
ordinary indigenous bundle deﬁned by the tautological trivialization (τN )Fp of S g,r over
ord

N g,r . Moreover, the pair {Φlog
N ; (EN , ∇EN )} is uniquely characterized by the following
properties:
ord

ord

log
→ (N g,r )log is a lifting of Frobenius;
(1) Φlog
N : (N g,r )

(2) the reduction of (EN , ∇EN ) modulo p is the bundle deﬁned by (τN )Fp ;
(3) (EN , ∇EN ) is Frobenius invariant for Φlog
N .
Moreover, the formation of Φlog
N and (EN , ∇EN ) is compatible with restriction to products
ord

ord

of N g,r ’s for smaller g’s and r’s that map into the boundary of our original N g,r via the
gluing procedure described at the end of Chapter I, §2.
110

Proof. We have proven everything except the last statement about restriction. To see
ord
this, note ﬁrst of all that Φlog
N respects such products of smaller N g,r since it respects the
ord

log structure of the original N g,r . Thus, we may restrict Φlog
N and (EN , ∇EN ) to these
products, and the result follows by uniqueness. 
Remark. This result is the central result of this paper. In some sense, the rest of the paper
is just devoted to making explicit a number of formal consequences of Theorem 2.8. In
particular, since this canonical Frobenius lifting is ordinary, it follows that we can apply
the theory of §1. We shall proceed to do this in the remainder of this Chapter.
Finally, it is useful to know that the formation of the canonical Frobenius and indigeord
nous bundle are compatible with ﬁnite coverings. Suppose that S log → (N g,r )log is log
étale, with S formally smooth over Zp , and the log structure given by a relative divisor
with normal crossings over Zp . Let f log : X log → S log be the pull-back of the universal
log

curve over Mg,r . Let q, s ≥ 0 be such that 2q − 2 + s ≥ 1. Let Y log → S log be an s-pointed
stable curve of genus q. Suppose that we are given a morphism over S log :
Y log

φlog

−→ X log

Now we make the following:
Deﬁnition 2.9. We shall say that φlog is log admissible if it is ﬁnite, log étale, and takes
marked points to marked points.
A typical example of a log admissible morphism may be obtained by considering the
“admissible coverings” of [HM]. Indeed, it is not diﬃcult to see that by endowing the
curves involved (as well as the base) with appropriate log structures, one may obtain a log
admissible covering (cf. [Mzk], §3). (Note, however, that the deﬁnition of “log admissible”
given here diﬀers from that of [Mzk], §3.)
Let (E, ∇E ) be the restriction of the canonical indigenous bundle (EN , ∇EN ) to X log .
log
(which exists
Let Φlog : S log → S log be the pull-back of the Frobenius lifting Φlog
N to S
ord

because S log → (N g,r )log is log étale). Let (F, ∇F ) = φ∗ (E, ∇E ). Observe that (F, ∇F )Fp
is a nilpotent, admissible indigenous bundle on Y log . Let us assume that:
(*) (F, ∇F )Fp is ordinary.

log

Then (F, ∇F )Fp determines a factorization of the classifying morphism S log → Mq,s
ord

through (N q,s )log . Thus, we get a morphism
ord

κlog : S log → (N q,s )log
111

ord

For simplicity, let us write T log for (N q,s )log . Let us denote by Ψlog the canonical Frobenius
ord

on (N q,s )log , and by (G, ∇G ) the canonical indigenous bundle on the universal s-pointed
ord

stable curve of genus q over (N q,s )log . Then we have the following compatibility result:
Theorem 2.10. We have a commutative diagram:
Φlog

S log −→
⏐
⏐ log
κ

T log

log

Ψ

−→

S log
⏐
⏐ log
κ

T log

and an isomorphism κ∗ (G, ∇G ) ∼
= (F, ∇F ).
Proof. We shall apply induction on i to the proposition “the Theorem is true when the
objects in it are reduced modulo pi .” The case i = 1 is clear. Thus, it suﬃces to prove the
induction step. Let us consider the crystals (F, ∇F )Φ and κ∗ (G, ∇G )Ψ on Crys(XFlog
/S log ).
p
Suppose that they agree modulo pi . If we apply F∗ (the renormalized Frobenius pullback) to them, we get the same crystal modulo pi , by the induction hypothesis and the
deﬁnition of the canonical Frobenii and indigenous bundles. Thus, by Lemma 2.6, it follows
that the underlying vector bundles of (F, ∇F )Φ and κ∗ (G, ∇G )Ψ must agree modulo pi+1 .
Since (F, ∇F )Φ is indigenous on (Y log )Φ , and κ∗ (G, ∇G )Ψ is indigenous on the s-pointed
stable curve of genus q given by pulling back the universal one by Ψlog ◦ κlog , we thus
obtain that the diagram in the Theorem commutes modulo pi+1 . Then since (F, ∇F ) and
κ∗ (G, ∇G ) agree modulo pi , it follows that their underlying vector bundles agree modulo
pi+1 . By a similar argument, their underlying vector bundles also agree modulo pi+2 , and
the diagram commutes modulo pi+2 . Then, by Lemma 2.5, since (F, ∇F ) ∼
= F∗ (F, ∇F )Φ
∗
∗ ∗
Ψ
∗
∼
and κ (G, ∇G ) = κ F (G, ∇G ) , it follows that (F, ∇F ) and κ (G, ∇G ) agree modulo pi+1 .
This completes the proof of the induction step. 

§3. Applications of the Canonical Frobenius Lifting
In this Section, we apply the general theory of §1 to the canonical modular Frobenius
lifting constructed in §2. In particular, we deﬁne the notion of a p-adic quasiconformal
equivalence class, and show how the choice of such a class allows one to construct both
aﬃne and multiplicative uniformizations of Mg,r . We will also deﬁne the notion of a padic topological marking, which will allow us to construct a local uniformization of Mg,r
by means of the aﬃne space of quadratic diﬀerentials. As we make these constructions,
we will compare them to various classical constructions in the complex case. Finally, we
will specialize what we have done in this Chapter to the case of elliptic curves (regarded
112

parabolically) to see that in this case, the canonical Frobenius lifting corresponds to a
well-known Frobenius lifting from Serre-Tate theory, and that, consequently, the various
objects constructed from it – i.e., canonical curves, modular uniformizations, etc. – reduce
to the corresponding objects of classical Serre-Tate theory.
Canonical Liftings of Curves over Witt Vectors
ord

Let N g,r ; Φlog
N be as in the last subsection of §2. Let k be a perfect ﬁeld of characteristic
p. Let A = W (k), the ring of Witt vectors with coeﬃcients in k; let S = Spec(A). Thus,
we have a natural Frobenius automorphism ΦA : A → A on A. Recall the notion of a
ord
canonical liftings of A-valued points in N g,r (Deﬁnition 1.9).
ord

Deﬁnition 3.1. We shall call a point α0 ∈ N g,r (k) a (p-adic) quasiconformal equivalence
class (valued in k). We shall call an r-pointed stable curve of genus g the canonical curve
in the class α0 if it admits an indigenous bundle such that the pair consisting of the curve
ord
and this indigenous bundle deﬁnes a canonical A-valued point of N g,r whose reduction
modulo p is α0 .
Remark. Thus, a p-adic quasiconformal equivalence class consists of a hyperbolically ordinary r-pointed stable curve (X0 → Spec(k); p1 , . . . , pr : Spec(k) → X0 ) of genus g, together
with a choice of a nilpotent, ordinary indigenous bundle (E, ∇E )0 on X0log . Recall from
Chapter II, Proposition 3.13, that for a given ordinary X0log , there are at most p3g−3+r
possible choices for (E, ∇E )0 . The reason for attaching the term “quasiconformal” to this
data will become more and more apparent as we continue: Namely, unlike the complex case
in which, once g and r are determined, all curves belong to the same quasiconformal equivalence class, the uniformization theory that we shall develop in this paper in the p-adic
setting acts (by comparison to the classical complex case) as if there are many diﬀerent
quasiconformal equivalence classes (for a given g and r), and moreover, this equivalence
ord
class is determined exactly by the datum of a point in N g,r .
Specializing the theory of §1, we obtain:
ord

Theorem 3.2. For every p-adic quasiconformal equivalence class α0 ∈ N g,r (k), there
ord

exists a canonical lifting α∞ ∈ N g,r (A), i.e., more concretely, an r-pointed stable curve
(X → Spec(A); p1 , . . . , pr : Spec(A) → X) of genus g, together with an indigenous (E, ∇E )
on X log . This canonical lifting α∞ is uniquely characterized by the fact that it is ﬁxed
log
log
under Φ−1
A ΦN , where ΦN is the canonical Frobenius lifting of Theorem 2.8.
Corollary 3.3. Suppose that the pair
113

{(X → Spec(A); p1 , . . . , pr : Spec(A) → X); (E, ∇E )}
is canonical (i.e., for (E, ∇E ), this means that it is the restriction of the (EN , ∇EN ) of
Theorem 2.8). Then
(1) If X → Spec(A) is smooth, then (E, ∇E ) deﬁnes an MF ∇ -object on
X log in the sense of [Falt], §2 (up to tensor product with a line bundle
whose square is trivial).
(2) More generally, if X → Spec(A) is not smooth, then the pair is obtained
by gluing together (as at the end of Chapter I, §2) a collection of smooth
canonical pairs.

Proof. The two statements follow by specializing Theorem 2.8. 
Corollary 3.4. A pair
{(X → Spec(A); p1 , . . . , pr : Spec(A) → X); (E, ∇E )}
consisting of a smooth r-pointed curve of genus g and an indigenous bundle on X log is
canonical if and only if
(1) the indigenous bundle (E, ∇E )Fp is ordinary;
(2) (E, ∇E ) deﬁnes an MF ∇ -object on X log in the sense of [Falt], §2 (up
to tensor product with a line bundle whose square is trivial).
More generally, a pair consisting of an r-pointed stable curve of genus g and an indigenous
bundle on X log is canonical if and only if it is obtained by gluing together canonical pairs
as at the end of Chapter I, §2.
Proof. Let us ﬁrst consider the smooth case. By the previous Corollary, it suﬃces to prove
the “if” part. Since (E, ∇E ) is an MF ∇ -object, we know (by Chapter II, Proposition 2.10)
that (E, ∇E )Fp is nilpotent. Thus, there exists a canonical pair which is equal to our given
pair modulo p. On the other hand, it follows by the analogues of Lemmas 2.5 and 2.6 for
F∗ over S = Spec(A) that there is only one lifting of our pair modulo p that admits an
indigenous bundle which is an MF ∇ -object. Thus, our pair must be the canonical pair.
Next, we consider the stable case. Again, by the previous Corollary, it suﬃces to prove
the “if” part. As before, we note that there exists a canonical pair which is equal to our
given pair modulo p. By the previous Corollary, the canonical pair is obtained by gluing
together smooth canonical pairs. Since a smooth canonical lifting is unique, it thus follows
that our pair must be the canonical pair. 
114

Corollary 3.5. Suppose that we have an r-pointed (respectively, s-pointed) stable curve
X log (respectively, Y log ) of genus g (respectively, q) over S log (for some appropriate choice
of log structure on S log ). Let (E, ∇E ) (respectively, (F, ∇F )) be an indigenous bundle on
X log (respectively, Y log ). Suppose that (F, ∇F )Fp is ordinary. Let φlog : Y log → X log be
log admissible, and suppose that (F, ∇F ) = φ∗ (E, ∇E ). Then the pair {X log ; (E, ∇E )} is
canonical if and only if the pair {Y log ; (F, ∇F )} is canonical.
ω
Proof. First note that, by pulling back square diﬀerentials and considering Φω
E and ΦF , the
ordinariness of (F, ∇F )Fp implies the ordinariness of (E, ∇E )Fp . The stipulated conditions
on φlog imply that X log is obtained by gluing if and only if Y log is obtained by gluing.
We thus reduce to the smooth case. But this follows immediately, by the criterion of the
previous Corollary (about the indigenous bundle being an MF ∇ -object) and the fact that
F∗ commutes with log étale coverings. 

Canonical Aﬃne Coordinates on Mg,r
We maintain the notation of the preceding subsection. Thus, S = Spec(A); A = W (k);
ord
and k is a perfect ﬁeld of characteristic p. Let α ∈ N g,r (A) be canonical. Since giving
ord

a canonical α ∈ N g,r (A) is equivalent to giving the p-adic quasiconformal equivalence
ord

class α(mod p) ∈ N g,r (k), we shall frequently abuse notation and speak of “the p-adic
quasiconformal equivalence class α.”
Let us assume that α corresponds to a smooth curve. Then applying Theorems 1.12
and 1.14 to the canonical Frobenius lifting of Theorem 2.8 gives the following results:
Theorem 3.6. For every choice of a p-adic quasiconformal equivalence class α, we obtain
a local canonical uniformization
∼ α
U can : Θaﬀ
α = Mg,r
of Mg,r by the aﬃne space modeled on Θα .
Let (B, mB ) be a local ring with residue ﬁeld k which is p-adically complete and has a
topologically nilpotent PD-structure on mB .
ord

Deﬁnition 3.7. We shall say that β ∈ N g,r (B) is in the (p-adic) quasiconformal equivaord

ord

lence class α if the point β(mod mB ) ∈ N g,r (k) is equal to α(mod p) ∈ N g,r (k).
In summary, we have proven the following result:
115

ord

Theorem 3.8. For every β ∈ N g,r (B) in the quasiconformal equivalence class α, we
obtain a canonical class κβ ∈ mB · Θβ , as well as a local uniformization
∼ β
U β : Θaﬀ
β = Mg,r
of Mg,r by the aﬃne space modeled on Θβ . Moreover, this uniformization is related to the
canonical uniformization by tensoring over A with B, applying the isomorphism
−1
: (Θα )B → Θβ
(Ψ∨
αβ )
ord

and then translating by κβ . Finally, for all β ∈ N g,r (B) that lie in the quasiconformal
equivalence class α, the correspondence β → κβ is a bijection of such β onto mB · Θβ .
Remark. In considering the uniformizations just obtained, it is tempting to compare them
with the local uniformization by the aﬃne space modeled on the tangent space to Mg,r
given in the complex case by considering geodesics for the Teichmüller metric. We believe,
however, that if there is any proper complex analogue to the uniformizations of Theorems
3.6 and 3.8 at all, then it is the uniformization obtained by Bers coordinates. Indeed,
unlike the Teichmüller coordinates, which are real, but not complex analytic, the Bers
coordinates are (complex) analytic, just as the aﬃne coordinates of Theorems 3.6 and
3.8. Also, (perhaps more crucially) the Teichmüller coordinates are the same for elliptic
curves regarded either hyperbolically or parabolically. We shall soon see, however, that
the uniformizations analogous to those of Theorems 3.6 and 3.8 for elliptic curves treated
parabolically are diﬀerent from those in the hyperbolic case. One diﬀerence between the
Bers uniformization and the uniformizations of Theorems 3.6 and 3.8 is that the Bers
uniformization is by the aﬃne space of quadratic diﬀerentials (of the complex conjugate
curve), not by the tangent space to Mg,r . On the other hand, (even in the complex
case) one cannot have a holomorphic local canonical uniformization by the aﬃne space of
quadratic diﬀerentials, as one can see easily by considering a one-pointed curve of genus
one with an automorphism of degree three. Thus, to obtain a uniformization by quadratic
diﬀerentials, we need more “rigidifying” information. In our case, the information will take
the form of a topological marking of the curve.
Topological Markings and Uniformization by Quadratic Diﬀerentials
We maintain the notation of the previous subsection. Let us consider the canonical
ord
ord
Frobenius lifting ΦN : N g,r → N g,r of Theorem 2.8. Just as in Deﬁnition 1.2, ΦN deﬁnes
ord

canonical étale local systems on N g,r in free Zp -modules of rank 3g − 3 + r:
ord

Deﬁnition 3.9. We shall refer to Θet
N as the tangential local system on N g,r . We shall
ord

call its dual, Ωet
N , the diﬀerential local system on N g,r .
116

Note that if one tensors over Zp with Fp , then these local systems become the local systems
(with the same names) considered in Chapter II, §3, following Proposition 3.4.
ord

Now let us assume that k is algebraically closed. Let α ∈ N g,r (A) be a p-adic quasiconformal equivalence class. In this subsection, however, we assume that α corresponds to
ord
a smooth curve. We would like to consider the fundamental groupoid of N g,r in the sense
of [SGA 1], Exposé V, p. 130. Recall that this fundamental groupoid is the category of
ord
ﬁber functors from the category of ﬁnite étale coverings of N g,r to the category of sets.
ord

Moreover, if x ∈ N g,r (k), then x deﬁnes a ﬁber functor Fx of this type by simply restrictord

ord

ing étale coverings of N g,r to Spec(k) via pull-back by x. Thus, if x, y ∈ N g,r (k), then we
shall call a path from x to y a natural transformation from Fx to Fy .
On the other hand, recall from the last subsection of Chapter II, §3, the set Dg,r of
isomorphism classes of totally degenerate r-pointed stable curves of genus g. If Δ ∈ Dg,r ,
ord

then, by abuse of notation, we shall also write Δ ∈ N g,r (A) for the totally degenerate
curve over A represented by Δ. Now we make the following important
Deﬁnition 3.10. We shall call a pair μ = (Δ; ) a (p-adic) topological marking for the
ord
quasiconformal equivalence class α if Δ ∈ Dg,r and  is a path from α(mod p) ∈ N g,r (k)
ord

to Δ ∈ N g,r (k).
Let μ = (Δ; ) be a topological marking for α. Then let us note that μ deﬁnes
a canonical nondegenerate bilinear form Bμ on Θα as follows. First note that by the
construction in Proposition 3.6 of Chapter II, §3 (which is carried out there over Fp , but
et
clearly works just as well over Zp ), we have a canonical nondegenerate bilinear form BΔ
et ∼
et
on Θet
Δ . Now the path  deﬁnes an isomorphism Θ : Θα = ΘΔ . Thus, if we pull-back
et
by means of Θ , we get a canonical nondegenerate bilinear form Bμet on Θet
BΔ
α . Since
Θα = (Θet
)
⊗
A,
we
thus
obtain
(by
tensoring)
a
canonical
nondegenerate
bilinear
form
Zp
α
Bμ on Θα .
Now let (B, mB ) be a local ring with residue ﬁeld k which is p-adically complete and has
ord
a topologically nilpotent PD-structure on mB . Let β ∈ N g,r (B) be in the quasiconformal
equivalence class α. Recall the canonical isomorphism
−1
: (Θα )B → Θβ
(Ψ∨
αβ )

implicit in Theorem 3.8. This isomorphism allows us to transport Bμ to Θβ so as to obtain
a canonical nondegenerate bilinear form Bμβ on Θβ . We summarize this as follows:
Proposition 3.11. The choice of a topological marking μ on a quasiconformal equivalence
class α allows one to deﬁne a canonical nondegenerate bilinear form Bμβ on Θβ for every
ord

β ∈ N g,r (B) in the quasiconformal equivalence class α.
117

This ﬁnally allows us to give local uniformizations of Mg,r by means of quadratic diﬀerentials: Namely, we compose the aﬃne uniformization of Theorem 3.8 with the isomorphism
Θβ ∼
= Ωβ given by the nondegenerate bilinear form Bμβ :
Theorem 3.12. The choice of a topological marking μ on a quasiconformal equivalence
class α that corresponds to a smooth curve allows one to deﬁne a canonical class κ∨
μ,β ∈
mB · Ωβ , as well as a local uniformization
∼ β
Vμ,β : Ωaﬀ
β = Mg,r
ord

of Mg,r by the aﬃne space modeled on Ωβ , for every β ∈ N g,r (B) in the quasiconformal
ord

equivalence class α. Finally, for all β ∈ N g,r (B) that lie in the quasiconformal equivalence
class α, the correspondence β → κμ,β is a bijection of such β onto mB · Ωβ .
Remark. Thus, we have obtained a canonical uniformization of Mg,r by quadratic diﬀerentials for every choice of a topological marking on α. In the complex case, a topological
marking of a Riemann surface is given by ﬁxing the underlying topological manifold, up
to homeomorphisms homotopic to the identity. Thus, the analogy between topological
markings in the p-adic and complex cases lies in the fact that a p-adic topological marking
gives one a canonical basis for Θet
β , hence for Θβ , corresponding to a collection of partition curves (see Introduction, §2) of a Riemann surface. This speciﬁcation of partition
curves determines a topological marking, by gluing together “pants” along the partition
curves. Thus, instead of uniformizing by the aﬃne space modeled on Ωβ , we could also
have uniformized by the aﬃne space modeled on a direct product of aﬃne lines, one for
each “partition curve.” Whichever choice of coordinates (i.e., quadratic diﬀerentials or
partition curves) is more useful depends on one’s tastes or the applications one has in
mind.
Canonical Multiplicative Parameters
So far we have only been working with smooth curves. In order to ﬁnd canonical
parameters at singular curves, we need to work with multiplicative parameters (like the
q-parameter in the case of elliptic curves), as opposed to aﬃne parameters, as in Theorems
3.6 and 3.8.
ord

Let α ∈ N g,r (A) be a p-adic quasiconformal equivalence class (corresponding to a
curve which is not necessarily smooth). Let us assume, for the rest of this subsection,
that k is algebraically closed. Let Ωlog
α be the restriction of ΩMlog to α, and let Θα be
g,r

the dual A-module to Ωlog
α . Then the Frobenius invariant subsections of Θα form a free
et
log
Zp -submodule Θet
⊆
Θ
α of rank 3g − 3 + r. Similarly, we have Ωα ⊆ Ωα . Let (Mg,r )α be
α
the completion of Mg,r ⊗Zp A at the image of α. Let ω ∈ Ωet
α have residues equal to zero
118

or one at all the irreducible components of the divisor at inﬁnity of Mg,r , and nonzero
reduction modulo p. Then, just as in Deﬁnition 1.11, we have a parameter
qω,α
on (Mg,r )α , which is well-deﬁned up to multiplication by a Teichmüller representative
[k× ]. This parameter is a unit at all the divisors where the residue of ω is zero and has
valuation one at all the divisors where the residue of ω is one. Moreover,
p
Φ−1
N (qω,z ) = qω,z

Deﬁnition 3.13. We shall call such a parameter qω,α a canonical multiplicative parameter
on (Mg,r )α .
The Case of Elliptic Curves
Just as in previous Chapters, it is useful to look at the case of elliptic curves (regarded
parabolically) since the calculations are usually much easier in this case. As before, we let
log
log
M1,0 be the log stack of elliptic curves, and f log : G log → M1,0 be the universal elliptic
curve (with the log structure deﬁned by the pull-back to G of the divisor at inﬁnity of
ord
M1,0 ). Let M1,0 ⊆ M1,0 be the open p-adic formal substack parametrizing ordinary
ord

ord

elliptic curves. Recall that we computed in Chapter II, Theorem 3.11, that N 1,0 = M1,0 ,
ord

and that the section of S 1,0 over (M1,0 )Fp corresponding to the unique nilpotent, ordinary
indigenous bundle on an elliptic curve was given explicitly in Example 2 of Chapter I,
§2. Now it is easy to see that, although nominally everything in this Chapter was done
for hyperbolic curves, much of the theory goes through for elliptic curves, as well. In
ord
particular, the construction of the canonical Frobenius lifting ΦN on M1,0 goes through
just as before. Since everything else in the Chapter is essentially a formal consequence of
the existence of ΦN , in this subsection, we would like to compute the lifting ΦN explicitly
for elliptic curves, and identify the resulting concepts (i.e., canonical curves, uniformization,
topological marking, etc.) with the well-known objects of classical Serre-Tate theory. For
a treatment of classical Serre-Tate theory, we refer to [Mess] and [KM] (p. 260).
ord

Let us begin by recalling a certain Frobenius lifting ΦM on M1,0 which is fundamental
to Serre-Tate theory. Ultimately, we shall show that ΦM = ΦN . First recall that the
étale quotient of the (log) p-divisible group P associated to the universal elliptic curve
ord
ord
G ord → M1,0 deﬁnes a local system L on M1,0 in free Zp -modules of rank one. Also, since
P is self-dual, taking Cartier duals gives us an inclusion L∨ (1) ⊗ (Qp /Zp ) → P (where
the “1” in parentheses denotes a Tate twist). Let PΦ ⊆ P be the subgroup scheme given
by L∨ (1) ⊗ ( p1 Zp /Zp ). Thus, taking the quotient by this subgroup scheme PΦ gives us an
isogeny:
119

ΦG : G ord → H
ord

ord

ord

to some elliptic curve H over M1,0 . Let ΦM : M1,0 → M1,0 be the classifying morphism
of H. Thus, H = Φ∗M G ord . Since considered modulo p, the subgroup scheme PΦ is nothing
but the kernel of Frobenius, it follows that ΦM is a Frobenius lifting, and that (ΦG )Fp is
ord
just the relative Frobenius on GF
. For convenience, we shall denote objects pulled back
p
via ΦM with a superscript “F .”
Now let us consider the eﬀect of pulling back the indigenous bundle (E, ∇E )F on
(G ) , where (E, ∇E ) is the indigenous bundle on G ord given in Example 2 of Chapter
I, §2. Let (F, ∇F ) = Φ∗G (E, ∇E )F . Let us denote by ω the relative dualizing sheaf of
ord F

ord

G ord → M1,0 . Then as a vector bundle,
F = Φ∗G (ω)F ⊕ OG
∗
F
Now let Φω
G : ΦG (ω) → ω denote the morphism on diﬀerentials induced by ΦG , divided
by p. Then I claim that Φω
G is an isomorphism. Indeed, since we are dealing with ordinary
elliptic curves, the local group structure near the origin is isomorphic to that of Gm (the
multiplicative group scheme), and the Frobenius lifting ΦG just amounts to the pth power
map on Gm . This proves the claim. Since E = ω ⊕ OG , Φω
G thus gives us an isomorphism:

E∼
=F
by taking the direct sum of Φω
G with the identity on OG . Next, we consider connections.
Recall that ∇E diﬀers from the trivial connection by the tautological Ad(E)-valued differential form given by mapping the ﬁrst factor ω to the second factor OG ⊗ ω. Thus,
when we pull-back by ΦG , we get a similar nilpotent endomorphism-valued diﬀerential
form, this time given by the map from Φ∗G (ω)F (the ﬁrst factor) to OG ⊗ ω (the second
factor) given by p · Φω
G . On the other hand, when we compute the renormalized Frobenius
pull-back of (E, ∇E ), we divide out by this factor of p. It thus follows that under the isomorphism E ∼
= F considered above, the renormalized Frobenius pull-back gives a connection
on F which corresponds precisely to the connection ∇E on E. Since ΦN and (EN , ∇EN )
are uniquely characterized by the property that the renormalized Frobenius pull-back of
Φ∗N (EN , ∇EN ) is isomorphic to (EN , ∇EN ), we thus see that we have proven the following
result.
Theorem 3.14. The canonical Frobenius lifting ΦN for elliptic curves (regarded parabolically) is equal to the Frobenius lifting ΦM . Moreover, the canonical indigenous bundle
(EN , ∇EN ) is the indigenous bundle constructed in Example 2 in Chapter I, §2.
Remark. In other words, what we have constructed here is just a relative version of the
uniformizing MF ∇ -object of Deﬁnition 1.3.
120

Now let k be a perfect ﬁeld of characteristic p. Then it is well-known from Serre-Tate
theory that an elliptic curve E → Spec(W (k)) is canonical in the sense of Serre-Tate theory if and only if the point in α ∈ M1,0 (W (k)) that it deﬁnes is ﬁxed by ΦM . We thus
obtain that the deﬁnition of a canonical curve given in Deﬁnition 3.1 is consistent with the
deﬁnition arising from Serre-Tate theory. Suppose we ﬁx a trivialization of L⊗2 |α . Then
Serre-Tate theory gives a local uniformization of M1,0 near this point α by the completion Gm of the multiplicative group at the identity. Relative to this uniformization, ΦM
becomes the pth power map on Gm . It thus follows immediately that the canonical aﬃne
parameters that we constructed before (in the general case) correspond to the logarithm
of the Serre-Tate parameter (up to multiplication by a unit of W (k)). Moreover, one sees
⊗2
.
easily that the local system Ωet
M corresponding to the Frobenius lifting ΦM is simply L
Thus, a topological marking (in the sense of Deﬁnition 3.10) deﬁnes a trivialization of
L⊗2 |α , and so the Serre-Tate parameter itself is a canonical multiplicative parameter in
the sense of Deﬁnition 3.13. We summarize this as follows:
Theorem 3.15. Canonical liftings for elliptic curves (as deﬁned in Deﬁnition 3.1 relative
to ΦN ) are the same as canonical liftings in the sense of Serre-Tate theory. Moreover, the
uniformization of Theorem 3.12 in the case of elliptic curves (regarded parabolically) is the
same as the uniformization of Mord
1,0 given by Serre-Tate theory.
Remark. It appears that the case discussed here in Theorem 3.15, i.e., the case g = 1, r = 0,
is the only case of the theory of this paper that is essentially a reformulation of a classically
known theory. For instance, already in the case g = 1, r = 1, despite the fact that
ord
ord
and N1,1
are quite diﬀerent.
M1,0 = M1,1 (as stacks), it is not diﬃcult to show that N1,0
ord
Indeed, in general, there exist connected components of N1,1 that are of degree > 1 over
M1,1 (cf. Proposition 3.12 of Chapter II). This implies, in particular, that ΦN in the case
g = 1, r = 1 is quite diﬀerent from ΦN in the case g = 1, r = 0.
Finally, we observe that the term “topological marking” is apt in this case in the
sense that a topological marking deﬁnes a trivialization of L|α , which is analogous in the
complex case to specifying a particular pair of generators for the fundamental group of an
elliptic curve.

121

Chapter IV: Canonical Curves
§0. Introduction
Because canonical curves (as deﬁned in Chapter III, Deﬁnition 3.1) admit Frobenius
invariant indigenous bundles, they possess a number of special arithmetic and geometric
properties. In this Chapter, we study a number of these properties, foremost among which
are the existence of a canonical Frobenius lifting, and the construction of a canonical pdivisible group. In particular, the canonical Frobenius lifting allows us to give a geometric
characterization of canonical curves which may be regarded as the hyperbolic analogue of
the statement in Serre-Tate theory that a lifting of an ordinary elliptic curve is canonical if
and only if it admits a lifting of Frobenius. From the point of view of comparison with the
complex case, this canonical Frobenius lifting may be regarded as a sort of p-adic Green’s
function. In the complex case, the Green’s function plays a central role in the development
of uniformization theory from the classical (as opposed to Bers’ quasiconformal) point of
view. In this context, the Green’s function is essentially the logarithm of the hyperbolic
distance function between two points. We shall see that the Frobenius lifting also gives us
a sort of p-adic notion of distance. Also, we shall see that we can construct “pseudo-Hecke
correspondences” which in some sense geometrically codify this notion of distance.
On the other hand, in the canonical case, we can also construct a certain Galois representation (arising from the torsion points of the canonical log p-divisible group) which is
the p-adic analogue of the canonical representation in the complex case of the fundamental
group into PSL2 (R) (deﬁned by the covering transformations of the upper half plane).
Thus, in some sense, we see that at least in the canonical case, we are able to obtain analogues of most of the fundamental objects that appear in classical complex uniformization
theory.
This brings us to the ﬁnal reason for wanting to study the canonical case: namely,
the fact that the universal hyperbolically ordinary curve (over the moduli stack) is itself
(essentially) a canonical curve. Thus, in Chapter V, by restricting these canonical objects
over the universal curve to a given (not necessarily canonical) curve, we will be able to
obtain Green’s functions, canonical Galois representations, and so on for noncanonical
curves, as well.

§1. The Canonical Galois Representation
In this Section, we construct a certain canonical Galois representation of the arithmetic fundamental group of a canonical curve. After studying some of the basic global
properties of such representations, we then consider what happens on the ordinary locus
of the curve. In particular, we construct a canonical ordinary Frobenius lifting over the
ordinary locus. This allows us to apply the general theory of Chapter III, §1. We will
122

refer to the multiplicative parameters obtained from this general theory as the Serre-Tate
parameters. We will make use of the Serre-Tate parameter quite often in this Chapter.
Throughout this Section, we will work over A = W (k), where k is a perfect ﬁeld of
odd characteristic. The quotient ﬁeld of A will be denoted by K. Let g, r be nonnegative
ord
integers such that 2g − 2 + r ≥ 1. Also, we will deal with a ﬁxed α ∈ N g,r (A), which
corresponds to a smooth canonical curve f log : X log → S log , where S log is Spec(A) with the
trivial log structure. Since singular canonical curves are just obtained by gluing together
smooth canonical curves, we shall concentrate mainly on the smooth case.
Construction and Global Properties
Let (E, ∇E ) be the canonical indigenous bundle on X log (whose existence is stated in
Chapter III, Theorem 2.8). In fact, unless the number r of marked points is even, such
a vector bundle will not exist. However, one can always pass to an étale double cover
of X on which it will exist, and then descend. For simplicity, we will just act as though
this problem does not exist, except when we state ﬁnal results in Theorems, in which
case our representations will be into GL± (that is, the general linear group GL modulo
the subgroup {±1}). Now, we would also like to say that the renormalized Frobenius
pull-back F∗ (E, ∇E )F is isomorphic to (E, ∇E ). In general, this may only be true up to
tensoring with a line bundle with connection whose square is trivial, but this may also be
ignored, provided we remember that ultimately our representations will be into GL± , not
GL. Let us choose an isomorphism ΦE : (E, ∇E ) ∼
= F∗ (E, ∇E )F which is the identity on
determinants. We shall call ΦE the canonical Frobenius action on (E, ∇E ).
Now let us assume that there exists a rational point x : S → X on X which avoids
log
the marked points. Let us denote by Π the proﬁnite group π1 (XK
, xK ). Then Theorem
2.6 of [Falt] implies that
Theorem 1.1. There exists a unique dual crystalline (in the sense of [Falt], §2) representation
ρ : Π → GL± (V )
(where V is a free Zp -module of rank two) that corresponds (under the functor D(−) of
[Falt], §2) to (E, ∇E , ΦE ). Moreover, the determinant representation of ρ is the cyclotomic
character. We shall refer to ρ as the canonical crystalline representation associated to
X log .
Remark. In the complex case, a hyperbolic Riemann surface can be uniformized by the
upper half plane. Then the fundamental group of the Riemann surface acts on the upper
half plane via covering transformations, and so we get a representation of the fundamental
123

group into PSL2 (R), which is canonically determined up to conjugation. The representation ρ of Theorem 1.1 is the p-adic analogue of this complex representation.
def

Now let Δ = π1 (XK , xK ) be the geometric subgroup of Π, so Γ = Π/Δ is the Galois
group of K over K. Then by “the comparison theorem” (Theorem 5.3 of [Falt]), we get:
Theorem 1.2. Let p ≥ 5. Then the group cohomology modules H i (Δ, Ad(V )(1)) (where
the “(1)” is a Tate twist) are zero, except when i = 1. Let U = H 1 (Δ, Ad(V )(1)). Then
U is a crystalline Zp -Γ-module, which, as a Zp -module is free of rank 6(g − 1) + 2r. It
corresponds under the functor D(−) to an MF-object (in the sense of Fontaine-Laﬀaille)
(N ; F i (N ); φi ) over A, where N is a free A-module of rank 6(g − 1) + 2r; F i (N ) = 0 if
log ⊗2
i ≥ 4; F i (N ) = N if i ≤ 0; F i (N ) is naturally isomorphic to H 0 (X, (ωX/S
) (−D)), if
1
1
i = 1, 2, 3; and N/F (N ) is naturally isomorphic to H (X, τX log /S log ).
Remark. Some mathematicians have raised questions concerning that the validity of the
proof in [Falt], Theorem 5.3. However, in this one-dimensional case, one can give ad hoc
proofs of this result, and, moreover, (at least in the closed case, when r = 0) T. Tsuji has
orally informed the author that he has obtained a diﬀerent proof of Theorem 5.3 of [Falt].
One interesting fact about the canonical representation ρ is that it is possible to
characterize it – as well as the canonicality of X log – solely in terms of the properties of ρ
as a Galois representation:
Theorem 1.3. Suppose that p ≥ 5. Let X log → Spec(A) be any (not necessarily canonical)
r-pointed smooth curve of genus g over A. Assume that we are not in the cases (g = 0; r =
3) or (g = 1; r = 1). Let τ : Π → GL± (W ) be any dual crystalline representation of
log
Π = π1 (XK
, xK ) on a free Zp -module W of rank two such that
(1) HPi (Δ, Ad(W )(1)) = 0 if i = 1; H 1 (Δ, Ad(W )(1)) is crystalline, and
corresponds to an MF-object M = (M ; F i (M ); ψ i ) such that F i (M ) =
0 if i ≥ 4; F i (M ) = M if i ≤ 0; and F i (M ) is a free A-module of rank
3(g − 1) + r if i = 1, 2, 3;
(2) the Frobenius endomorphism of (M/F 1 (M ))Fp (arising from the MFobject of (1)) is an isomorphism;
(3) det(τ ) is the cyclotomic character.
Then X log is canonical, and τ is isomorphic to the representation ρ of Theorem 1.1.
Proof. Since τ is asserted to be dual crystalline, it corresponds to some vector bundle with
connection (G, ∇G ) on X log , together with a ﬁltration F i (G) on G. Let i1 (respectively,
i2 ) be the largest i such that F i (G) = 0 (respectively, F i (G) = G). Thus, i1 ≥ i2 . The
124

condition that det(τ ) be cyclotomic implies that i1 + i2 = 1. If the rank of F i1 (G) is not
one, then i1 = i2 , and det(τ ) could not be cyclotomic, so F i1 (G) must be of rank one, and
i1 > i2 . Let L = F i1 (G). Thus, L is a line bundle.
Let j1 be the largest j such that F j (M ) = 0. Now we claim that L can not be stable
under ∇G . Indeed, if it were, then the monodromy at the marked points of ∇G on L,
being nilpotent and one-dimensional, must be zero. Thus, the induced connection on L
has no poles at the marked points. But this would imply that deg(L) = 0. Hence the
rank over A of F j1 (M ) would be ≤ h0 (X, L⊗2 ⊗ ωX/S ) ≤ g < 3g − 3 + r (by Cliﬀord’s
Theorem), which contradicts our hypotheses. This proves the claim. On the other hand,
by Griﬃths transversality, if i1 − i2 ≥ 2, then F i1 (G) would have to be stable under ∇G .
Thus, i1 = i2 + 1, so i1 + i2 = 1 implies that i1 = 1 and i2 = 0.
Now rankA (F 3 (M )) = 3g − 3 + r ≤ h0 (X, L⊗2 ⊗ ωX/S ), so the line bundle L⊗2 ⊗ ωX/S
must be nonspecial, by Cliﬀord’s Theorem. It thus follows that deg(L⊗2 ) ≥ 2g−2+r. Since
the Kodaira-Spencer morphism for the ﬁltration is nonzero, we cannot have deg(L⊗2 ) >
2g − 2 + r. Thus, we see that (G, ∇G ) must be indigenous. Since it is also carried to itself
by the renormalized Frobenius, it follows from Chapter III, Corollary 3.4, that X log is
canonical, and that (G, ∇G ) must be the canonical indigenous bundle of Theorem 1.1. 
Remark. For the reader who is interested in handling the cases g = 0; r = 3 and g = 1;
r = 1, as well, we remark that by considering conditions (similar to those imposed on
H i (Δ, Ad(W )(1))) on higher symmetric powers of W , one can characterize the canonical
representations in these cases as well solely in terms of their properties as Galois representations.
Remark. Really, the substantive missing element here is that it is not clear to the author
how to characterize the property of being “dual crystalline” solely in terms of properties of the representation relative to the triple (Π; Δ ⊆ Π; Π/Δ ∼
= Gal(K/K)). Thus,
log
is always present in the background of this
ultimately, a knowledge of the curve X
“Galois representation-theoretic” characterization of the canonical representation. For instance, if the property of being “dual crystalline” were known to depend only on the triple
(Π; Δ ⊆ Π; Π/Δ ∼
= Gal(K/K)), then one could obtain the result that whether or not a
curve is canonical depends only on that triple.
In the following, we return to the assumption that X log is canonical.
The Horizontal Section over the Ordinary Locus
We maintain the notation of the previous subsection. Let X ord be the p-adic formal
scheme which is the open sub-formal scheme of X given by the complement of the supersingular divisor (Chapter II, Proposition 2.6). Let us endow X ord with the log structure
induced by X log , and call the resulting log formal scheme (X log )ord . We shall refer to
125

(X log )ord as the ordinary locus of X log . The purpose of this subsection is to prove and
interpret the following result:
1

Theorem 1.4. There exists a unique subbundle T 2 ⊆ E|X ord of rank one with the following
properties:
1

(1) T 2 is horizontal, and moreover, for any n, the reduced line bundle
1

2
TZ/p
n Z has a nonempty subsheaf (in the category of sets) consisting of
1

2
horizontal sections that generate TZ/p
n Z as an OX ord -module;
1

(2) T 2 is taken to itself by ΦE .
Finally, (T 2 )⊗2 is naturally isomorphic to τX log /S log |X ord .
1

1

Proof. Let us prove that there exists a unique ΦE -invariant horizontal subbundle T 2 ⊆
E|X ord with horizontal generating sections. We prove this by induction on n, where the nth
1
step is the construction of such a T 2 modulo pn . For n = 1, recall that (up to tensoring
with a line bundle) EFp is an FL-bundle (Chapter II, Proposition 2.5). Then under the
1

correspondence of that Proposition, we take our subbundle TF2p to be the subbundle of
E corresponding to the subbundle that we called “T ” in our discussion of FL-bundles in
Chapter II, §1. This subbundle is clearly horizontal, and has local generating sections
that are horizontal. In this case, uniqueness follows from the fact that the p-curvature is
nonzero.
Now we assume that n ≥ 2, and that the result is known for n−1. Let U log = (X log )ord ,
and let Φlog : U log → (U log )F be a Frobenius lifting. Let us consider the quotient Q
(respectively, P) of EZ/pn Z by pn−1 · F 1 (E) (respectively, pn−1 · E). Thus, P is a quotient
of Q, and P = EZ/pn−1 Z . Let T  ⊆ P be the subbundle given us by the induction
hypothesis. Let T  ⊆ Q be the the inverse image of T  ⊆ P via the surjection Q → P.
1
∗
F
2
Then Φ∗ (T  )F ⊆ Φ∗ QF deﬁnes a subbundle TZ/p
n Z of F (E)Z/pn Z . It follows from the
1

1

2
deﬁnition of TF2p and the fact that we are on the ordinary locus that TZ/p
n Z is ﬂat over
1

2
Z/pn Z. The existence of local horizontal generating sections for TZ/p
n Z follows by taking


such a section of T , lifting it to T , and then pulling back this lifted section of T  to a
1
∗
2
section of TZ/p
n Z via Φ . That the connection vanishes on this section follows from the
deﬁnitions, plus the fact that pulling back by Φ adds an extra factor of p. Since T  is ΦE 1
1
n−1
2
2
Z = T  . Thus, by the construction of TZ/p
invariant, it follows that TZ/p
n Z ⊗ Z/p
nZ,
1


2
it is clear that TZ/p
by ΦE will
n Z is ΦE -invariant, since pulling back any lifting of T
1

2
give TZ/p
n Z . Also, this same observation (coupled with the induction hypothesis) proves
uniqueness. This completes the proof of the induction step. The last statement about
1
1
(T 2 )⊗2 follows from considering the splitting of the Hodge ﬁltration that T 2 deﬁnes. 

126

Now suppose that our basepoint x : S → X maps into the ordinary locus X ord . Let
Πord = π1 ((X log )ord
K , xK ). Thus, we have a natural morphism:
Πord → Π
Let us denote the restriction of ρ to Πord via this natural morphism by
ρord : Πord → GL± (V ord )
Then if we apply the theory of [Falt], §2 to interpret Theorem 1.4, we see that the subbundle
1
T 2 ⊆ E|X ord in fact deﬁnes a sub-MF ∇ -object corresponding to an étale representation
(ρord )et : Πord → GL± (Vet ) of Πord , for some rank one free Zp -quotient module V ord → Vet .
Here, by “étale,” we mean that the kernel of (ρord )et deﬁnes an étale covering of X ord . In
other words, we have an exact sequence of (“up to {±1}”) representations of Πord :
0 → Vet∨ (1) → V ord → Vet → 0
where the “1” in parentheses is a Tate twist. We state this as a Corollary:
Corollary 1.5. The restriction ρord of ρ to Πord deﬁnes an (“up to {±1}”) module V ord
of Πord , which ﬁts into an exact sequence:
0 → Vet∨ (1) → V ord → Vet → 0
where Vet is étale and of rank one over Zp .
The Canonical Frobenius Lifting over the Ordinary Locus
In this subsection, we construct the generalized analogue (for an arbitrary canonical
X ) of the p-adic endomorphism of the ordinary locus of the moduli stack of elliptic curves
obtained by sending an elliptic curve with ordinary reduction to its quotient modulo its
unique subgroup scheme which is étale locally isomorphic to μp . In many respects, the
construction is similar to (although not literally a logical consequence of) the construction
ord
of the Frobenius lifting on N g,r constructed in Chapter III, §2.
log

Consider the canonical indigenous bundle (E, ∇E ) (of Theorem 1.1) on the canonical
curve X log → S log . By Chapter II, Proposition 2.5, (E, ∇E )Fp corresponds to an FL-bundle
0 → TFp → F → OXFp → 0
127

on XFlog
. By the material directly preceding Chapter II, Proposition 1.2, splittings of this
p
log
exact sequence correspond to Frobenius liftings on XZ/p
2 Z . Now, over the ordinary locus
log
of X , the Hodge ﬁltration deﬁnes such a splitting. Let us denote the resulting Frobenius
lifting on the ordinary locus by

log ord F
Φ2 : (X log )ord
) )Z/p2 Z
Z/p2 Z → ((X

Let us denote by E the vector bundle which is the inductive limit of the following diagram:
F 1 (E)
⏐
⏐p·

−→

E

F 1 (E)
where the horizontal arrow is the natural inclusion. Note that EZ/pn Z depends only on
F
EZ/pn Z . By the deﬁnition of the renormalized Frobenius pull-back, Φ∗2 EZ/p
2 Z is naturally
isomorphic to EZ/p2 Z . We shall identify these two sheaves in the following discussion. On
the other hand, by considering the object in the upper right-hand corner of the diagram
 we obtain a morphism
deﬁning E,
F
Φ∗2 EZ/p
2 Z → EZ/p2 Z
∗ 1
F
∗ 1
F
whose restriction to Φ∗2 F 1 (E)F
Z/p2 Z vanishes on p · Φ2 F (E)Z/p2 Z and maps Φ2 F (E)Z/p2 Z
into p · F 1 (E)Z/p2 Z (by the deﬁnition of the correspondence between Frobenius liftings and
splittings of the FL-bundle F).
log ord F
Now let Ψ3 : (X log )ord
) )Z/p3 Z be any lifting of Φ2 . Then, again from
Z/p3 Z → ((X
the deﬁnition of the renormalized Frobenius pull-back, we obtain a morphism

F
Ψ∗3 EZ/p
3 Z → EZ/p3 Z

which vanishes on p2 · Ψ∗3 F 1 (E)F
Z/p3 Z . However, if Ψ3 is an arbitrary lifting of Φ2 , then we
∗ 1
F
don’t know that Ψ3 F (E)Z/p3 Z is mapped into F 1 (E)Z/p3 Z .
Now suppose that we modify Ψ3 by a section δ ∈ Γ(X ord , TFp ). Let HT : TFp →
(τX log /S log )Fp |X ord be the isomorphism deﬁned by projecting to the Hodge ﬁltration. Then
the subsheaf of EZ/p3 Z given by the image of F 1 (E)F
Z/p3 Z under Ψ3 + δ diﬀers from the
corresponding image subsheaf under Ψ3 by the amount HT (δ) ∈ Γ(X ord , (τX log /S log )Fp ).
Indeed, this follows from the deﬁnitions, plus the fact that the Kodaira-Spencer morphism
for E is the identity. Since HT is an isomorphism, it thus follows that there exists a unique
Frobenius lifting
128

log ord F
Φ3 : (X log )ord
) )Z/p3 Z
Z/p3 Z → ((X
1
that lifts Φ2 such that Φ∗3 maps F 1 (E)F
Z/p3 Z into F (E).

Clearly, we may repeat this procedure modulo pn for arbitrary n ≥ 3, so as to obtain
a unique
log ord
) → ((X log )ord )F
Φlog
X : (X

such that under the natural morphism
Φ∗X E F → E
the Hodge ﬁltration is preserved. Note, moreover, that it follows from the fact that the
Kodaira-Spencer morphism at the Hodge section is an isomorphism plus the interpretation
of the FL-bundle F in terms of Frobenius liftings that this Frobenius lifting Φlog
X is ordinary
in the sense of Chapter III, Deﬁnition 1.1. In summary, we have proven the following result:
Theorem 1.6. Let X log be a canonical curve; (E, ∇E ) the canonical indigenous bundle on
X log . Then there exists a unique ordinary Frobenius lifting (called canonical)
log ord
Φlog
) → ((X log )ord )F
X : (X

over the ordinary locus that preserves the Hodge ﬁltration.
In particular, we can apply the theory of Chapter III, §1, to the Frobenius lift∇
ing Φlog
X . Note that it follows immediately from the deﬁnitions that the MF -object
(E, F 1 (E), ∇E , ΦE )|(X log )ord is precisely the uniformizing MF ∇ -object associated to Φlog
X
(as in Chapter III, Deﬁnition 1.3). Let us write
T = (T 2 )⊗2
1

Thus, ∇E (respectively, ΦE ) induces a natural connection (respectively, Frobenius action)
on T , which deﬁnes the canonical tangential local system of Chapter III, Deﬁnition 1.2.
Since T is a line bundle, it is the same to give (over an étale covering of X ord ) a generating
Frobenius invariant section of it, or a generating Frobenius invariant section of its dual.
Thus, (just as in Chapter III, Deﬁnition 1.11) if θ is such a section of T , then θ deﬁnes, at
every z ∈ X ord (A) that avoids the marked points, a unique multiplicative parameter
qθ ∈ Rz×
129

(where Rz is the completion of X ord at z). If the residue of θ is equal to one at a marked
point z ∈ X ord (A), then we get a multiplicative parameter
q ∈ Rz
(with valuation one at the divisor Im(z)) which is unique up to multiplication by a Teichmüller representative [k× ].
Deﬁnition 1.7. We shall call q (respectively, qθ ) the Serre-Tate parameter (respectively,
relative to θ) at z.
Note, in particular, that by the theory of Chapter III, §1, Φ−1
X maps q (respectively, qθ ) to
p
p
q (respectively, qθ ).
Remark. In some sense, it would be more aesthetically pleasing if one could obtain the
Frobenius lifting of Theorem 1.6 in the following way. We consider the universal curve
ord
C → N g,r . Then C parametrizes (r + 1)-pointed stable curves of genus g, so we have a
Frobenius lifting on some stack which is étale over C. If we could prove that this Frobenius
ord
lifting is compatible with the canonical Frobenius lifting on N g,r , then we could obtain a
canonical Frobenius lifting on C (or at least some stack étale over C) simply by using the
ord
canonical Frobenius on N g,r+1 .
The problem with this approach is that despite the fact that the canonical modular
Frobenius liftings of Chapter III do have many interesting functorial relations (i.e., relative to restriction to the boundary and log admissible coverings), in general, the sort of
compatibility of Frobenius liftings necessary to make the above sketch of a proof work –
namely, compatibility with “forgetting a marked point” – simply does not hold. Indeed,
one can already see this in the case of the morphism
M1,1 → M1,0
which is the identity on the underlying stacks, but which we think of as assigning to a onepointed curve of genus one the underlying elliptic curve. Here, the canonical Frobenius on
ord
ord
N 1,1 cannot be compatible with the canonical Frobenius on N 1,0 for the following reason.
ord

Since N 1,0 → M1,0 is an open immersion, it would follow that the canonical Frobenius
ord

on N 1,1 would descend to an open formal subscheme of M1,1 . But this would mean that
even if a one-pointed curve of genus one in characteristic p belongs to several distinct
quasiconformal equivalence classes (a phenomenon which by Chapter II, Proposition 3.13,
does occur), the canonical liftings of that curve would be the same for all quasiconformal
equivalence classes. But this would mean that we have several diﬀerent ordinary indigenous
bundles on a single hyperbolic curve, all of which are Frobenius invariant. By Chapter III,
Lemma 2.6, this is absurd.
130

§2. The Canonical Log p-divisible Group
Although the existence of the canonical Galois representation of §1 is, in and of itself,
of some interest, one technical drawback that it has is that it is diﬃcult to relate the
log
that it
properties of the Galois representation or the characteristic zero coverings of XQ
p
log
determines to XZ/p
n Z . Thus, in this Section, we shall construct a log p-divisible group
log
on X which gives us back the canonical Galois representation (by looking at the Galois
action on torsion points), but which has the advantage that one can study and understand
its reductions modulo pn in a similar fashion to the elliptic modular case (which is studied
in [KM]).

Log p-divisible Groups at Inﬁnity
We maintain the notation of the previous Section (although k need not be algebraically
closed, just perfect). For basic facts about log schemes, we refer to [Kato] and [Kato2].
In [Kato2], certain ﬁnite, log ﬂat group objects over the compactiﬁed moduli stack of
elliptic curves are introduced which are supposed to be the analogue at inﬁnity of the
usual ﬁnite, ﬂat group schemes that one gets from elliptic curves by considering the kernel
of multiplication by a power of p. Since we will use such objects (as well as the p-divisible
group objects obtained by taking direct limits thereof) later in this Section, we take the
time out in the present subsection to review explicitly the construction of these ﬁnite, log
ﬂat group objects.
Let R = A[[q]] be a complete local ring which is formally smooth of dimension one
over A. If one inverts q, then by taking the (pn )th root of q, one obtains an extension of
ﬁnite ﬂat group schemes
0 → Z/pn Z(1) → Gn → Z/pn Z → 0
over R[1/q]. Because q is not a unit in R, it is impossible to extend this extension of ﬁnite
ﬂat group schemes over R[1/q] to an extension of ﬁnite ﬂat group schemes over R. Our goal
in this subsection, however, is to exhibit a natural extension of the above exact sequence
to an exact sequence deﬁned over R by working with group objects in the category of
ﬁnite, log ﬂat log schemes over Spec(R)log . (In this subsection, we will regard Spec(R) as
endowed with the log structure arising from the divisor deﬁned by q.)
For nonnegative integers a, b, let Ma,b be the monoid given by taking the quotient of
N (where N is the monoid of nonnegative integers) by the equivalence relation generated
by (pa , 0) ∼ (0, b). Let e1 ∈ Ma,b (respectively, e2 ∈ Ma,b ) be the image of (1, 0) (respectively, (0, 1)) in Ma,b . Then it follows from the theory of [Kato2] (especially, §4.1, 5.1) that
we can construct the desired extension
2

log

0 → Z/pn Z(1) → Gn → Z/pn Z → 0
131

n

as follows: For j ∈ {0, . . . , pn − 1}, consider the scheme Gn,j given by R[x]/(xp − q j ),
with the log structure given by the chart ([Kato], §2) Mn,j with e1 → x; e2 → q. Denote
log
the resulting log scheme by (G )log
n,j . Let Gn,j be the universal valuative log space ([Kato2],
log

§1.3.1) (which, in this case, will still be a log scheme) associated to (G )log
n,j . Let Gn be
log

log

the union of the Glog
n,j . Note that when we invert q, Gn becomes Gn . Endow Gn with
log

the unique structure of group object that extends the group structure on Gn . Then Gn
is a group object in the category of ﬁnite, log ﬂat log schemes over Spec(R)log , and it ﬁts
into an exact sequence as above.
log

log

As we allow n to vary, we get morphisms Gn → Gn+1 . Thus, we obtain an ind-group
object G over Spec(R)log .
Deﬁnition 2.1. We shall refer to G as the log p-divisible group over Spec(R)log obtained
by taking pth power roots of q ∈ R.
Finally, we remark that, although what we are doing here is, in some sense, just
“trivial general nonsense,” its utility lies in the fact that by using it, we can obtain p-adic
ﬁnite coverings of X log that are deﬁned over all of X log , thus allowing us to algebrize.
Construction of the Canonical Log p-divisible Group
We now turn to the construction of the canonical log p-divisible group on X log . Consider the MF ∇ -object (E, ∇E , ΦE ), deﬁned by the canonical indigenous bundle. Let n ≥ 1.
Let U ⊆ X be the open p-adic subscheme deﬁned by removing the marked points. Then
the reduction modulo pn of (E, ∇E , ΦE )|U deﬁnes, by [Falt], Theorem 7.1, a ﬁnite, ﬂat
group scheme (annihilated by pn ), which we denote by Gn |U → U . On the other hand, let
R be the complete local ring at any one of the marked points. Then (E, ∇E , ΦE ) deﬁnes a
Serre-Tate parameter (as in Deﬁnition 1.7) q ∈ R/[k× ]. Let q ∈ R be any representative
of q. Then R = A[[
q ]]. Let Glog
n |R be the log scheme constructed in the previous subn th
section by taking a (p ) -root of q. Observe that diﬀerent choices of q give us naturally
isomorphic Glog
, then Glog
n |R ’s. Also, note that if we invert q
n |R becomes (Gn |U )|R . Thus,
log
we see that Gn |U and the various Gn |R at the marked points glue together naturally to
log
form a ﬁnite, log ﬂat group object Glog
, which a priori is just p-adic, but may be
n → X
algebrized since X is proper over A. Also, as n varies, we obtain natural morphisms
log
. . . → Glog
n → Gn+1 → . . .

which thus form an inductive system of group objects.
Deﬁnition 2.2. We shall call this inductive system of group objects the canonical log
p-divisible group on X log .
132

Remark. As usual, strictly speaking we really have only deﬁned a “group up to {±1}.”
That is, we really only have a group object over (perhaps) a ﬁnite étale covering of X
of degree 4, plus descent data (satisfying the cocycle condition up to {±1}) down to the
original X. We could, of course, develop the general nonsense of such “groups up to {±1},”
but we choose not to, since it seems to serve no real purpose.
If we invert p, then this log p-divisible group Glog on X log deﬁnes a local system on
log
) in free Zp -modules of rank two. Thus, we get a Galois representation
the étale site (XQ
p et
on the Tate module T of characteristic zero torsion points of Glog :
ρGlog : Π → GL± (T )
Then we have the following result (which is immediate from the theory of [Falt], especially
the construction in the proof of Theorem 7.1):
Proposition 2.3. The representation ρGlog is isomorphic to the canonical Galois representation ρ of Theorem 1.1.
Review of the Theory of [Katz-Mazur]
In this subsection, we apply to the log p-divisible group Glog the theory of [KM],
which is exposed in [KM] solely in the case of the canonical log p-divisible on the compactiﬁed moduli stack of elliptic curves, but whose proofs go through without change for the
canonical log p-divisible group Glog on any canonical curve X log .
First of all, because Glog is a logarithmic p-divisible group, it follows from [Mess],
Chapter II, Theorem 3.3.13, that if we consider the formal neighborhood of the identity
section : X → G, we obtain a formally smooth formal scheme G( ) over X, which is easily
seen to have relative dimension 1 over X. We would like to use this observation to apply
the theory of [KM], Chapter 1, on “A-generators” and “A-structures” to Glog . The theory
there goes through just as in the modular case since the only technical assumption needed
on the ﬁnite, ﬂat (logarithmic) group schemes whose A-generators we wish to parametrize
is that they be closed subschemes of some smooth one-dimensional scheme. However,
looking at the proofs of [KM], one sees that in fact, it suﬃces to have the ﬁnite, ﬂat (log)
group schemes be closed subschemes of a formally smooth formal scheme (such as G( ))
of relative dimension one. Thus, we can deﬁne various moduli problems, just as in [KM],
Chapter 3, by means of various structures:
(1) a Γ(n)-structure, which consists of giving a Drinfeld basis for Glog
n ;
(2) a Γ1 (n)-structure, which consists of giving a point “of exact order pn ”
in Glog
n ;
133

(3) a Γ0 (n)-structure, which consists of giving an isogeny Glog → H log
(where H log is also a log p-divisible group) whose kernel is cyclic of
order pn .
Moreover, just as in [KM], one proves that these various moduli problems are representable
by schemes X(n); X1 (n); X0 (n) that are ﬁnite over X. Finally, all of these schemes X(n);
X1 (n); and X0 (n) are, in fact, regular. Indeed, away from the marked points, the proofs
of regularity in [KM], Chapters 5 and 6, boil down to general nonsense plus two technical
results (Proposition 5.3.4 and Theorem 6.1.1). Since these technical results are proven,
respectively, for arbitrary formal groups and arbitrary ﬁnite group schemes, it is immediate
that the regularity proofs of [KM] in the modular case go through without change for X(n);
X1 (n); and X0 (n). At the marked points, the combinatorial descriptions of the situation at
the cusps in [KM], Chapter 10, go through without change for the above moduli problems.
We thus obtain the following Theorem:
Theorem 2.4. The schemes X(n); X1 (n); and X0 (n) that represent the moduli problems
listed above are all regular, and hence equal to the normalizations of X in the ﬁnite coverings of XK deﬁned by the appropriate composites of ρ : Π → GL± (V ) with ﬁnite quotients
GL± (V ) → G, just as in the classical modular case.
Fix a positive integer n. We shall also need to analyze X0 (n) modulo p, in a fashion
similar to what is done in the modular case in [KM], Chapter 13. Let us (for the rest of
the Section) denote X0 (n) by Y , and let us use a subscript m on X, Y , etc., to denote
reduction modulo pm+1 . Let us denote by ΦA : A → A, Φk : k → k the respective absolute
Frobenius morphisms, and by a superscript F m the result of base-changing an object by the
mth power of Frobenius, and by ΦX0 : X0 → X0F the relative Frobenius of X0 . Essentially,
the description of Y0 = Y ⊗Zp Fp given in [KM], Chapter 13, goes through in our situation
here, but we need to do things with a little bit more care, since [KM] often falls back on
the “crutch” of using the modular interpretation of their “X,” which we lack in this more
general situation.
For each ordered pair of nonnegative integers (a, b) such that a + b = n, we would
like to deﬁne a k-scheme X0 (a, b) of “(a, b)-cyclic isogenies” together with a k-morphism
ι(a,b);0 : X0 (a, b) → Y0 . We do this as follows. If a, b ≥ 1, then we let X0 (a, b) be
the schematic inverse image of Inf p−1 (Δ) (the (p − 1)st inﬁnitesimal neighborhood of the
diagonal) via
b−1
F
Φa−1
X 0 × Φ X 0 : X0 × X 0

a−b

→ X0F

a−1

× X0F

a−1

If a or b is zero, then we let X0 (a, b) be the schematic inverse image of the diagonal Δ via
ΦaX0 × ΦbX0 : X0 × X0F
134

a−b

a

→ X0F × X0F

a

Observe that in either case, (X0 (a, b))red is smooth over k; ΦaX0 × ΦbX0 maps X0 (a, b) ⊆
a−b
a
a
into Δ ⊆ X0F × X0F ; and X0 (a, b) comes equipped with a ﬁnite, ﬂat, radicial
X0 × X0F
morphism
D0 (a, b) : X0 (a, b) → X0
To deﬁne
ι(a,b);0 : X0 (a, b) → Y0
we must specify a cyclic subgroup of order pn of D0 (a, b)∗ Glog
0 . Now on the one hand,
by composing the ath power of Frobenius with the bth -power of the Verschiebung (as in
[KM], Theorem 13.3.5), we get some subgroup object of order pn of D0 (a, b)∗ Glog
0 , and by
the same argument as that given in [KM], Theorem 13.3.5, one sees that this subgroup
must be cyclic (in the Drinfeldian sense). Thus, by the modular deﬁnition of Y0 , we get a
morphism ι(a,b);0 : X0 (a, b) → Y0 .
In order to apply the theory of [KM], Chapter 13, we must verify the conditions (1)
through (8) listed at the beginning of that Chapter. (Caution: The letters X and Y
in [KM], Chapter 13, are used in the reverse way to the way that they are used here.)
Conditions (1), (2), (4), (5), and (6) are trivial. Condition (3) follows from the regularity
of Y and the fact that over a supersingular point, there is only one A-generator valued in
k for a cyclic group, namely the identity element. Note that at ordinary points, one can
do the same analysis of pth power isogenies of log p-divisible groups as is done in [KM],
Chapter 13, §3. Thus, Condition (7) (that ι(a,b);0 is a closed immersion) and Condition (8)
(that the ι(a,b);0 ’s deﬁne an isomorphism of the disjoint union of X0 (a, b)’s with Y0 over
the ordinary locus) follow at the level of topological spaces from this analysis, and at the
level of complete local rings by considering the deformation parameters for the domain
and range log p-divisible groups of the isogeny. We thus get a result analogous to [KM],
Theorem 13.4.7:
Theorem 2.5. The k-scheme Y0 is the disjoint union, with crossings at the supersingular
points (in the terminology of [KM], Chapter 13, §1), of the n + 1 schemes X0 (a, b) (where
a + b = n). Let f(a,b) ∈ k[[x, y]] be the equation
a−1

(xp
a

b−1

− yp

)p−1

b

if a, b ≥ 1, and let it be xp − y p if a or b is zero. Then the completed local ring at a
k-rational supersingular point of Y0 is isomorphic to
k[[x, y]]/(



(a,b)

135

f(a,b) )

with the closed subscheme X0 (a, b) ⊆ Y0 given by the equation f(a,b) .

§3. The Compactiﬁed Canonical Frobenius Lifting
In this Section, we study the canonical Frobenius lifting on the ordinary locus of
a canonical curve (deﬁned in Theorem 1.6). In particular, we study its behavior at supersingular points, and “compactify it” in some sense, so as to obtain “pseudo-Hecke
correspondences.” It is by abstracting the main properties of this compactiﬁed Frobenius
in the canonical case that we shall obtain a geometric criterion for a curve to be canonical
in §4.
The Canonical Frobenius Lifting and the Canonical Log p-divisible Group
Let us denote by
log ord
Φlog
) → ((X log )ord )F
X : (X

the canonical Frobenius lifting of Theorem 1.6. Let Glog be the canonical log p-divisible
group on X log of Deﬁnition 2.2. Then we rephrase Theorem 1.6 in terms of Glog as follows:
Theorem 3.1. The canonical Frobenius lifting of Theorem 1.6
log ord
Φlog
) → ((X log )ord )F
X : (X

induces an isogeny of degree p
Φ∗X (Glog )F |(X log )ord → Glog |(X log )ord
between the canonical log p-divisible groups that lifts the Frobenius morphism modulo p.
log ord
)
that has this property.
Moreover, Φlog
X is the unique Frobenius lifting over (X
Proof. The existence of the isogeny follows from the fact that we have deﬁned a morphism
between the respective Dieudonné crystals that respects the Hodge ﬁltrations. This induces
the isogeny (see [BBM] and [Mess]). On the other hand, the uniqueness statement follows
from the uniqueness statement in Theorem 1.6, together with the fact that if a Frobenius
lifting induces such an isogeny, it automatically preserves the Hodge ﬁltrations on the
Dieudonné crystals. 
136

Let n ≥ 0. Let Y = X0 (n). Let Y ord ⊆ Y be the p-adic open formal subscheme
consisting of points lying over X ord . Now the Frobenius lifting of Theorem 3.1 allows us
to extend the decomposition in characteristic p of YFp into components corresponding to
(a, b)-cyclic isogenies to a decomposition over A = W (k), on the ordinary locus. To obtain
this decomposition, we deﬁne closed p-adic subschemes
X(a, b)ord ⊆ X ord ×A (X ord )F

a−b

via the same recipe as we did for X0 (a, b), except using our canonical Frobenius lifting
log ord
Φlog
)
→ ((X log )ord )F instead of ΦX0 . Then, just as before, we get a natural
X : (X
embedding ι(a,b) : X(a, b)ord → Y ord (analogous to ι(a,b);0 ) which induces an isomorphism
Y ord ∼
=



X(a, b)ord

(disjoint union)

a+b=n

Finally, over Y ord , we have a tautological isogeny
Glog
→ HYlogord
Y ord
(where Glog
is the pull-back of Glog to Y ord ) such that over X(a, b)ord , HYlogord is naturally
Y ord
a−b
a−b
isomorphic to the pull-back of (Glog )F
via the projection X(a, b)ord → (X ord )F
to
the second factor.
Local Analysis at Supersingular Points
We now exploit the existence of the isogeny of Theorem 3.1 to understand the behavior of the canonical Frobenius lifting at the supersingular points. Let x ∈ X(k) be
a supersingular point. In studying x, we will often need to involve its various Frobenius
i
conjugates xF ∈ X(k) (which may be inﬁnite in number if the perfect ﬁeld k is not ﬁnite).
We begin our analysis by considering the double iterate of the Frobenius morphism over
some inﬁnitesimal neighborhood V ⊆ XFp at x:
Φ2V : Glog |V → Glog |V F 2
Thus, V is the spectrum of a local artinian ring, with residue ﬁeld k. Let us assume that
V is contained in the supersingular divisor (Chapter II, Proposition 2.6) of the canonical
indigenous bundle. By deﬁnition, this means that over V , the Hodge ﬁltration coincides
with the FL-bundle ﬁltration. It thus follows that over V , the kernels of the Verschiebung
and Frobenius morphisms coincide. Since the kernel of the composite of the Verschiebung
and the Frobenius is just the kernel of multiplication by p, it follows that the morphism
Φ2V is isomorphic to the morphism “multiplication on p.” In particular, it follows that
137

Glog |V F 2 ∼
= Glog |V
By iterating this isomorphism, we obtain that Glog |V is isomorphic to the pull-back to V
of a p-divisible group over k. Since the Kodaira-Spencer morphism of the Hodge ﬁltration
of (E, ∇E ) is an isomorphism, this implies that V must be Spec(k). Thus, the assumption
that V lies inside the supersingular divisor implies that V is reduced. Put another way, we
see that we have proven (in this general context) the analogue of Igusa’s theorem ([KM],
p. 355):
Proposition 3.2. The supersingular divisor of the canonical indigenous bundle (E, ∇E )
is étale over k.
Next, let us observe that for any x ∈ X(k), the completed local ring Rx of X at x
(which is formally smooth of dimension one over A) is naturally isomorphic to the universal
deformation space of the p-divisible group Glog |x . Indeed, it follows from the theory of
[Mess] that deformations of Glog |x are given by deformations of the Hodge ﬁltration; thus,
our observation follows from the fact that the Kodaira-Spencer morphism of the Hodge
ﬁltration of (E, ∇E ) is an isomorphism. Now suppose that x ∈ X(k) is supersingular. Then
the isomorphism
Glog |xF 2 ∼
= Glog |x
obtained above from the double iterate of Frobenius induces a natural isomorphism of
complete local rings
Ψx : RxF 2 ∼
= Rx
which will play an important role in the sequel.
Now ﬁx a number n ≥ 1, and let Y = X0 (n). If x ∈ X(k), let us denote by Xx the
formal spectrum of X at x, i.e., Spf(Rx ). We will use similar notation for Y . Over Y , we
have a tautological cyclic isogeny of order pn :
log
Glog
Y → HY

Fix a supersingular x ∈ X(k). By the analysis of [KM], reviewed in §2, there exists a
unique y ∈ Y (k) lying over x. Now by thinking of the completed local rings of X as
universal classifying spaces, we obtain a morphism:
(Dy , Ry ) : Yy → Xx ×A XxF n
138

where Dy is the classifying morphism for the “domain p-divisible group” Glog
Y , and Ry is
log
the classifying morphism for the “range p-divisible group” HY . Here we use the fact that
restricted to x, the tautological isogeny is just the nth iterate of the Frobenius morphism, so
HYlog |y = Glog
. Also, note that by the deformation theory of [Mess], a deformation of the
xF n
tautological isogeny is uniquely determined by the induced deformations of the domain and
range p-divisible groups. It thus follows that the morphism (Dy , Ry ) is formally unramiﬁed,
hence a closed immersion. Thus, henceforth, we shall think of Yy as a formal divisor inside
Xx × XxF n by means of the closed immersion (Dy , Ry ).
One of the most important properties of this divisor Yy is its symmetry. More precisely,
given Yy , one can obtain a divisor in XxF n × Xx in two ways:
(1) by applying the isomorphism Xx × XxF n ∼
= XxF n × Xx given by switching the two factors;
(2) by conjugating ﬁrst by the nth power of Frobenius, so as to obtain a
divisor in XxF n × XxF 2n and then applying the isomorphism Spf(Ψx )−n
to the second factor.
Then we claim that these two divisors in XxF n × Xx are the same. Indeed, to see this,
it suﬃces to trace what happens to the tautological isogeny. Let us consider the second
procedure stated above. First, we conjugate the tautological isogeny by Frobenius:
n

F
→ (HYlog
)F
(Glog
Yy )
y

n

Since at y, this isogeny is just the nth iterate of the Frobenius morphism, by looking at
Dieudonné modules, it follows that the kernel of this isogeny is contained in the kernel of
multiplication by pn . Thus, we get a morphism
n

F
(HYlog
)F → (Glog
Yy )
y
n

n

2n

F
Since (Hylog )F = (Glog
, we thus see that the divisor in XxF n × Xx obtained this
y )
way is just the divisor of isogenies (lifting the nth iterate of Frobenius) from the universal
deformation of Glog
x (pulled back from the second factor) to the universal deformation of
log F n
(Gx )
(pulled back from the ﬁrst factor). On the other hand, it we look at the divisor
obtained from the ﬁrst procedure stated above, it admits exactly the same description.
This proves the claim.

The next important property of this divisor Yy ⊆ Xx × XxF n is that if we restrict it
to the ordinary locus, it becomes equal to the union of the “local versions” of the schemes
X(a, b)ord (described at the end of the preceding subsection). More precisely, X(a, b)ord
a−b
is deﬁned as a closed subscheme of X ord × (X ord )F . Thus, we obtain X(a, b)ord |Xx ⊆
a−b
(X ord × (X ord )F )Xx by restricting to the formal scheme Xx . Since a − b ≡ a + b =
139

n(mod 2), by applying the appropriate power of Ψx , we thus obtain a subscheme, which
we shall call
n

ord
X(a, b)ord
× (X ord )F )Xx
x ⊆ (X

Then it follows from the functorial deﬁnition of Y (in terms of parametrizing isogenies)
that


Yy |X ord =

X(a, b)ord
x

(disjoint union)

a+b=n

Let us denote the supersingular divisor of X by X ss . We are now ready to summarize
what we have done:
Deﬁnition 3.3. We shall call the pair
def

Hx = (Yy ; Ψx )
consisting of the divisor Yy ⊆ Xx × XxF n and the isomorphism Ψx the nth canonical local
Hecke correspondence of X log at x. We shall call the triple
(Y → X; Φlog
X ; {Hx }x∈X ss )
the nth canonical pseudo-Hecke correspondence of X log .
Of course ideally, the local Hecke correspondences Hx would glue together to form a
n
global Hecke correspondence, i.e., a morphism Y → X × X F , just as in the classical case
with modular curves. We shall investigate this issue in the next subsection, but (unfortunately) what we shall ﬁnd is that the existence of such global Hecke correspondences is a
rather rare phenomenon.
Global Hecke Correspondences
We maintain the notation of the previous subsection.
Deﬁnition 3.4. We shall say that the canonical curve X log admits a global nth canonical
Hecke correspondence if there exists a morphism
(D, R) : Y → X × X F
140

n

that is equal to the local morphisms (Dy , Ry ) of the preceding subsection for every y ∈ Y
lying over a supersingular point of X. We say that X log is of Hecke type if it admits a
global nth canonical Hecke correspondence for every n ≥ 1.
2

Proposition 3.5. Suppose that there exists an isomorphism Ψlog : X log → (X log )F that
induces the morphism Spf(Ψx ) when localized at every supersingular x ∈ X. Then X log is
of Hecke type.
Proof. This follows immediately from gluing together Y ord with the various Yy ’s by means
of Ψlog . 
Corollary 3.6. Suppose that X log , along with all of its supersingular points are deﬁned
over Fp2 . Then X log is of Hecke type.
Proof. Over Fp2 , one can take Ψlog to be the identity, for (by functoriality) the Ψx ’s must
all be the identity. 
The classical example of a case where X log is of Hecke type is the case where X log =
log
M1,0 , the compactiﬁed moduli stack of elliptic curves (over Zp ). This case is studied in
detail in [Shi], Chapter 3. To see that the supersingular points are deﬁned over Fp2 , one
2
repeats the argument preceding Proposition 3.2, to obtain an isomorphism E F ∼
= E for
every supersingular elliptic curve E.
Suppose that X log is canonical of Hecke type. Then we remark that just as in the
log ⊗N
classical case, one can deﬁne Hecke operators on H 0 (X, (ωX/S
) )Qp (as well as one the
log
étale cohomology of XQ
, etc.). Moreover, (by the same proofs as in the classical case)
p
the eﬀect on q-expansions (where q is the Serre-Tate parameter at a marked point) is the
same as in the classical case. (See, e.g., [Lang] for more details.)

Next, we justify the assertion (made in the preceding subsection) that, in some sense,
being of Hecke type is a rather rare phenomenon. Indeed, if X log admits a global ﬁrst
canonical Hecke correspondence, consider its reduction modulo p:
(D, R)Fp : YFp → XFp × XFFp

Let Z = YFp . Then Z = Z  Z  , with Z  mapping isomorphically to XFp via DFp , and
−1
DFp |Z  isomorphic to the Frobenius morphism from Z  ∼
= XFFp to XFp . On the other
−1

hand, RFp must map Z  isomorphically to XFFp . Thus, Z  is isomorphic to both XFFp
2
and XFFp . In particular, XFp ∼
= XFFp , i.e., the moduli of XFp are deﬁned over Fp2 , which
is a very rare phenomenon.
141

Remark. At the present time, the author does not know of any canonical X log of
Hecke type, except for those that arise directly from the modular case.
§4. p-adic Green’s Functions
In this Section, we give a geometric criterion for a curve to be canonical: namely, the
existence of a Frobenius lifting of the right height, over an open p-adic formal subscheme
of the curve, with “nice behavior” at the points where it is not deﬁned. We will make
these terms precise below, but the point of interest is that this criterion does not depend
ord
on knowing the action of the canonical Frobenius ΦN on N g,r – that is, it is intrinsic
to the curve – and, moreover, it is not phrased in terms of indigenous bundles. Now in
the case of elliptic curves (regarded parabolically), the canonical lifting deﬁned in terms
of indigenous bundles is the same as the canonical lifting deﬁned in Serre-Tate theory
(one of the deﬁnitions of which is the existence of a global Frobenius lifting). Thus, it is
interesting to note that the existence of an “admissible Frobenius lifting” amounts to just
the existence of a Frobenius lifting (in the case of elliptic curves). In other words, one
may regard the geometric criterion given here as the proper hyperbolic generalization of
the statement that an elliptic curve (whose reduction modulo p is ordinary) is Serre-Tate
canonical if and only if it admits a Frobenius lifting.
Compactiﬁed Frobenius Liftings
In this subsection, motivated by the construction of the pseudo-Hecke correspondences
in the previous Section, we deﬁne the general notion of a “compactiﬁed Frobenius lifting.”
Let X log → S log be a smooth r-pointed curve of genus g. Let
φlog : Y log → X log
be a ﬁnite, ﬂat morphism such that Y is regular (necessarily of dimension two), and the
log structure on Y log is deﬁned by a divisor on Y which is étale over A and equal to the
set-theoretic inverse image of the divisor of marked points of X. Let U ⊆ X be an open
formal subscheme that contains all the marked points. We endow U with the log structure
pulled back from X log , and call the resulting log formal scheme U log . We shall use the
notation Xx , Yy , etc. (as in the previous subsection) to denote the formal schemes which
are the formal neighborhoods of the closed points x, y, etc. Suppose that
Φlog : U log → (U log )F
is a Frobenius lifting.
Deﬁnition 4.1. We shall say that (φlog : Y log → X log ; ι) is a naive compactiﬁcation of the
Frobenius lifting Φlog if, when we take V = φ−1 (U ), the following conditions are satisﬁed:
142

(1) V log splits as a disjoint union (V log )



(V log ) ;

(2) φlog |V  : (V log ) → U log is an isomorphism;
(3) ιlog : (V log ) → (U log )F

−1

(4) φlog |V  ◦ (ιlog )−1 : (U log )F

is an isomorphism;
−1

→ U log is the morphism (Φlog )F

We shall frequently identify V  and U , and V  and U F

−1

−1

.

.

Suppose that (φlog ; ιlog ) is a naive compactiﬁcation for Φlog . Note that φ is necessarily
of degree p + 1. Also, note that V  admits a canonical embedding
ι(1,0) : V  → U × U F
where we take ι(1,0) = (id, Φ), while V  admits an embedding
ι(0,1) : V  → U × U F
where we take ι(0,1) = ((Φ)F

−1

−1

, id).

Let x ∈ X(k). Let
Ψx : RxF 2 ∼
= Rx
be an isomorphism. Suppose that y ∈ Y (k) maps to x. Let
(Dy , Ry ) : Yy → Xx × XxF
be a closed embedding, where Dy is obtained by restricting φ.
def

Deﬁnition 4.2. We shall say that Hx = (Ψx ; (Dy , Ry )) is a local compactiﬁcation for the
Frobenius lifting Φlog at x (relative to (φlog ; ιlog )) if
(1) y is the unique closed point of Y lying over x;
(2) the divisor Yy → Xx × XxF is symmetric in the sense that the two
divisors that it induces in XxF × Xx (by switching and by Frobeniusconjugating, then applying Ψx ) are the same;
(3) the restriction of (Dy , Ry ) to V is the union of ι(1,0) , and (ι(0,1) )F
composed with Spf(Ψx )−1 × (id).
143

2

Note that by the ﬁrst condition, x cannot lie in U . Now let us consider (Yy )Z/p2 Z . Since
Yy ⊆ Xx × XxF , it follows that (Yy )Z/p2 Z is Spf of a local ring of the form:
def

R = (A/p2 A)[[ξ, η]]/ψ(ξ, η)
where ξ is a local parameter for (Xx )Z/p2 Z , and η = ξ F is the Frobenius-conjugate local
parameter for (XxF )Z/p2 Z . Since Yy → Xx is ﬂat, the last condition implies that (Yy )Fp
has exactly two irreducible components, both of which are reduced. Thus, if we denote by
a “bar” the reduction of functions modulo p, we see that ψ is a product of two distinct
prime elements of k[[ξ, η]]. In fact, we can say more. Outside the special point of (Yy )Fp ,
p

these two primes deﬁne the closed subschemes ξ − η and η p − Ψx (ξ
f = ξ p − η;

F2

). Let

2

g = η p − Ψx (ξ F )

Thus, we may assume that ψ = f · g. In other words, we can write
ψ =f ·g+π
where π ∈ p · k[[ξ, η]]. In fact, π is actually p times a unit in k[[ξ, η]], since Yy is regular.
So far we have been working with functions on (Yy )Z/p2 Z . Now let us restrict to
functions on the open formal subscheme D(g) ⊆ (Yy )Z/p2 Z (i.e., where g is invertible).
Thus, we are in eﬀect restricting to the graph of Φ. Let us denote the restriction morphism
on functions by ζ : R → R[1/g]. Then we obtain, in R[1/g],
ζ(η) = ζ(ξ)p + ζ(π) · ζ(g)−1
By interpreting this open formal subscheme D(g) as the graph of Φ, this tells us that
Φ−1 (ξ F ) is a function which is not regular at x, but has a pole of order one (since g has a
zero of order one). In particular, it tells us that the Frobenius lifting Φ does not admit a
regular extension to any neighborhood of x. We summarize this as follows:
Proposition 4.3. If Hx is a local compactiﬁcation of Φlog at x, then (Yy )Fp is a node,
and x ∈
/ U . Also, the Frobenius lifting Φ does not admit an extension to any neighborhood
of x.
Deﬁnition 4.4. We shall call
C = (φlog ; ιlog ; {Hx }x∈U
/ )
144

a compactiﬁcation of the Frobenius lifting Φlog if (φ; ι) is a naive compactiﬁcation of Φlog ,
and for each x ∈
/ U , we are given a local compactiﬁcation Hx of Φlog relative to (φ; ι)
(where k in the deﬁnition above is replaced by the ﬁeld of rationality of x).
Thus, in particular, by what we did in the last two subsections,
Proposition 4.5. Suppose that X log is a canonical curve. Then its ﬁrst canonical
pseudo-Hecke correspondence is a compactiﬁcation of the canonical Frobenius lifting on
(X log )ord .
def

log
Suppose that (φlog ; ιlog ; {Hx }x∈U
. Let us consider Z =
/ ) is a compactiﬁcation of Φ
YFp . It follows from the above deﬁnition that Z is reduced and has exactly two irreducible
components Z  and Z  with VF p ⊆ Z  ; VFp ⊆ Z  . Since Z  is geometrically connected,
smooth, proper, and birationally equivalent to XFp over k, it follows that Z  ∼
= XF p .
 ∼
F −1


Similarly, Z = XFp . Moreover, except at the points of intersection of Z and Z (which
are nodes), Z is smooth over k.

Proposition 4.6. (Assuming that X log is hyperbolic) Y must be connected.
Proof. It suﬃces to prove that Z is connected. Suppose that Z is not connected. Then
φZ  : Z  → XFp is ﬁnite and birational, hence an isomorphism. It thus follows that Z 
lifts to a connected component Y  of Y such that φY  : Y  → X is an isomorphism.
−1
On the other hand, Z  is proper and smooth over k, and birational to XFFp , hence
−1
Z  ∼
= X F , and φ|Z  : Z  → XF is the Frobenius morphism. Moreover, Z  lifts to a
Fp

p

connected component Y  of Y . Thus, φ|Y  : Y  → X is a Frobenius lifting. But if X log is
hyperbolic, such Frobenius liftings cannot exist, for the nonzero morphism of line bundles
log
→ ωYlog /S violates degree restrictions. 
(φ|Y  )∗ ωX/S
The Height of a Frobenius Lifting
Finally, we note that often it is useful to have a precise measure of how far a Frobenius
lifting fails to extend over all of X. For this, we introduce the notion of the height of a
Frobenius lifting, as follows.
Let F → XFp be the TFp -torsor of Frobenius liftings on open sub-log schemes of
Thus, if Φlog : U log → (U log )F is a Frobenius lifting, its reduction modulo p2
deﬁnes a section σΦ : UFp → F of this torsor. Let P be the projective bundle that
canonically compactiﬁes F. Thus, P → XFp is a P1 -bundle. Recall the notion of the
canonical height of a section of P → XFp , introduced at the beginning of Chapter I, §2.
Since XFp is proper over k, it follows that σΦ extends uniquely to a section σ Φ : XFp → P .
We now make the following
log
XZ/p
2Z.

145

Deﬁnition 4.7. We deﬁne the height ht(Φ) of the Frobenius lifting Φlog to be the canonical
height of the section σ Φ of P → XFp .
More concretely, the height of Φlog can be deﬁned as follows. If x ∈ XFlog
, then let t be a
p
log
local parameter of X at x. Let Ξx be a local Frobenius lifting deﬁned in a neighborhood
−1
of x. Then p1 (Ξ−1
(t)) is a rational function δx on XFlog
. Let us say that the local
x (t) − Φ
p
log
height htx (Φ) of Φ at x is:
(1) equal to 0 if this function δx is regular at x;
(2) equal to the order of the pole of δx at x otherwise.
Then we have the formula:
Proposition 4.8. We have

p
[k(x) : k] htx (Φ)
ht(Φ) + (2g − 2 + r) =
2
log
x∈XF

p

Proof. This follows immediately from considering the intersection number of σ Φ with the
“section at inﬁnity” given by the complement of F in P . 
Corollary 4.9. If Φlog admits a compactiﬁcation, then the local heights at points outside
U are all one. Thus,
p
ht(Φ) = − (2g − 2 + r) + degk (X − U )Fp
2
where we regard (X − U )Fp as having the reduced, induced scheme structure.
Proof. The statement about local heights follows from the explicit computation preceding
Proposition 4.3. 
The following is the main result of this subsection:
Proposition 4.10. If Φlog has height ≤ 1−g− 12 r, then P (with its connection ∇P induced
by that of F) is a nilpotent, admissible indigenous bundle. In particular, if (P, ∇P ) is also
ordinary, then X log is isomorphic to a canonical curve modulo p2 , and Φlog is equal to the
canonical Frobenius lifting (of Theorem 3.1) modulo p2 .
146

Proof. Indeed, suppose that ht(Φ) ≤ 1 − g − 12 r. Consider the Kodaira-Spencer morphism
of the section σ Φ of P → X. By the general properties of FL-bundles (Chapter II, §1),
we know that the Kodaira-Spencer morphism cannot vanish (for the section at inﬁnity of
P → X is the unique horizontal section). But by degree considerations (i.e., the assumption
on ht(Φ)), once the Kodaira-Spencer morphism is nonzero, it must be an isomorphism. It
thus follows that P (with its connection induced by that of F) is a nilpotent, admissible
indigenous bundle. The last statement follows from the construction of the canonical lifting
and the canonical Frobenius. 
Thus, we see that the compactiﬁed Frobenius liftings that we are really interested in
are the ones that “look nice modulo p:”
Deﬁnition 4.11. A compactiﬁed Frobenius lifting
C = (φlog ; ιlog ; {Hx }x∈U
/ )
is called admissible if
(1) ht(Φ) = g − 1 + 12 r;
(2) the associated (P, ∇P ) (as in Proposition 4.10) is ordinary;
(3) the reductions modulo p of the isomorphisms Ψx (that make up Hx )
are equal to the canonical “Ψx ” of Deﬁnition 3.3.

Note that for an admissible compactiﬁed Frobenius C, all the objects involved (that is,
Φlog ; φlog : Y log → X log ; ιlog ; Ψx ; (Dy , Ry )) are completely determined modulo p (up to
isomorphism) once one ﬁxes the supersingular divisor (X − U )Fp . Or, in other words,
Proposition 4.12. An admissible compactiﬁed Frobenius C on X log determines a p-adic
quasiconformal equivalence class α to which X log belongs. If two admissible compactiﬁed
Frobenii C and C  on X log determine the same α, then, modulo p, all the objects that make
up C are isomorphic to those that make up C  .
Admissible Frobenius Liftings
Since an admissible compactiﬁed Frobenius is determined modulo p by the p-adic
quasiconformal equivalence class α, the next step is to understand what the possible deformations looks like. Let C be an admissible compactiﬁed Frobenius, and let us consider
CZ/p2 Z , i.e., the reductions modulo p2 of all the objects involved. Suppose we start with
147

the data (Φlog )Z/p2 Z ; (Ψx )Z/p2 Z (for all supersingular x). Now it is easy to see (by looking
at points valued in an arbitrary scheme) that the symmetry condition on the divisor Yy
amounts to the statement that (Ψx )Z/p2 Z restricted to the ordinary locus commutes with
ΦZ/p2 Z .
Let β be an automorphism of (Xx )Z/p2 Z which is equal to the identity modulo p. Then
we claim that if ΦZ/p2 Z commutes with β, then β is the identity. Indeed, since derivations
on XFp act trivially on functions that are pth powers, we get that
ΦZ/p2 Z ◦ β = ΦZ/p2 Z
Thus,
β F ◦ ΦZ/p2 Z = ΦZ/p2 Z
which implies that β is the identity, since ΦZ/p2 Z is faithfully ﬂat. Thus, in summary, the
(Ψx )Z/p2 Z are determined uniquely by the condition that they commute with ΦZ/p2 Z .
Next, we consider Y log . We can break Y log up into three parts: (V log ) ; (V log ) ; and
the Yy ’s. Since (V log ) and (V log ) are determined up to natural isomorphism by X log , it
remains to determine the Yy ’s, and the gluing morphisms. But Yy and its gluing morphisms
to (V log ) and (V log ) are completely speciﬁed once one knows the divisor Yy in Xx ×XX F .
Moreover, it follows from the condition (3) of Deﬁnition 4.2, that this divisor is determined
by Φ and Ψx . But we just saw that (Ψx )Z/p2 Z is determined by ΦZ/p2 Z . Thus, we conclude
2
that (Hx )Z/p2 Z and φlog
Z/p2 Z are completely determined by ΦZ/p Z . Sorting through all the
deﬁnitions, we thus see that we have proven that CZ/p2 Z is entirely determined by the
p-adic quasiconformal equivalence class α and the deformation ΦZ/p2 Z . Moreover, there is
nothing special about working modulo p2 : the same arguments can be made modulo an
arbitrary power of p. Thus, we see that we have proven the following result:
Lemma 4.13. Let C be an admissible compactiﬁed Frobenius lifting on X log . Then CZ/pn Z
is completely determined by Φlog
Z/pn Z .
This Lemma suggests the following deﬁnition:
Deﬁnition 4.14. Let α be a p-adic quasiconformal equivalence class to which X log
belongs. Let U ⊆ X be the ordinary locus for α. Let Φlog : U log → (U log )F be a Frobenius
lifting over U log . Then we shall say that Φlog is an admissible Frobenius lifting for (X log , α)
if it arises from a (necessarily unique) admissible compactiﬁed Frobenius C.
Thus, we can can regard admissible Frobenius liftings as being Frobenius liftings (over the
ordinary locus) that happen to have special behavior near the supersingular points.
148

Next let us consider two admissible Frobenius liftings Φlog and (Φlog ) on the same
curve X log . Let us suppose that they are equal modulo pn (where n ≥ 2). In this discussion,
we shall always be working modulo pn+1 , so (by abuse of notation) we shall use Φlog and
(Φlog ) to denote the respective reductions modulo pn+1 . Now just as in the discussion
preceding Proposition 4.3, for Φlog , (Yy )Z/pn+1 Z is Spf of a local ring of the form:
def

R = (A/pn+1 A)[[ξ, η]]/ψ(ξ, η)
where ξ is a local parameter for (Xx )Z/pn+1 Z , and η = ξ F is the Frobenius-conjugate local
parameter for (XxF )Z/pn+1 Z . Moreover, we may assume that
ψ =f ·g+π
where
f = ξ p − η;

2

g = η p − Ψx (ξ F )

and π ∈ p · (A/pn A)[[ξ, η]]. In fact, π is actually p times a unit, since Yy is regular.
Similarly, for (Φlog ) , we have
R = (A/pn+1 A)[[ξ, η]]/ψ  (ξ, η)
def

with ψ  = f · g  + π  , and g  = η p − Ψx (ξ F ). Thus,
2

g ≡ g  (mod pn );

π ≡ π  (mod pn )

So far we have been working with functions on (Yy )Z/pn+1 Z . Now let us restrict to
the open subscheme corresponding to the graph of Φ (or Φ ). Let us denote the restriction
morphism on functions by ζ. Then we obtain, on this open subscheme, in the unprimed
case:
ζ(η) = ζ(ξ)p + ζ(π) · ζ(g)−1
and, in the primed case:
ζ(η) = ζ(ξ)p + ζ(π  ) · ζ(g  )−1
= ζ(ξ)p + ζ(π  ) · ζ(g)−1
since the diﬀerence between g and g  becomes zero when multiplied by p. Ultimately, we
are interested in computing the diﬀerence between the two Frobenius liftings Φ and Φ .
149

That is, we wish to understand the diﬀerence between where η is taken by the two liftings.
But by the above formulas, the diﬀerence is of the form:
{ζ(π) − ζ(π  )}(ζ(g))−1
Moreover, because the diﬀerence in brackets is divisible by pn , only the residue of g modulo
p is involved in the above expression. Since this residue has a zero of order exactly one at
x, it follows that the diﬀerence between the two Frobenius liftings – which forms a section
of TFp over X ord – has poles of order at most one at the supersingular points. Since the
morphism
HTFp : TFp → (τX log /S log )Fp
(given by composing the p-curvature of (P, ∇P ) with the projection given by the Hodge
ﬁltration) has zeroes at the supersingular points, it thus follows that the diﬀerence between
Φlog and (Φlog ) deﬁnes a global section of (τX log /S log )Fp . Since we are dealing with hyperbolic curves, though, (τX log /S log )Fp has negative degree, hence has no global sections.
Thus, Φlog = (Φlog ) . In summary, we have proven the following strengthened form of
Lemma 4.13:
Lemma 4.15. If there exists an admissible Frobenius lifting of (X log , α), then it is unique,
and contains no nontrivial deformations modulo any power of p.
Geometric Criterion for Canonicality
Let us ﬁx X log → S log , a smooth r-pointed curve of genus g, and a p-adic quasiconformal equivalence class α to which X log belongs. Let Φlog be an admissible Frobenius
lifting for (X log , α).
 log → S log is also a smooth r-pointed curve of genus g such that
Now suppose that X
log
(X )Fp = XFp . The following “Rigidity Lemma” is fundamental to this subsection:
 log

 log , α) admits an admissible Frobenius lifting (Φlog ) . Then
Lemma 4.16. Suppose that (X
 log = X log .
X
Proof. We propose to prove inductively (on n) the following statement:
 log , (Φlog ) ) coincides with (X log , Φlog ) modulo pn+1 .
(*) (X
We know that this statement holds for n = 0. Assume that it holds for n − 1. Consider
log
log
 log
the diﬀerence between the deformations XZ/p
n+1 Z and XZ/pn+1 Z of XZ/pn Z . It deﬁnes a
class
150

μ ∈ H 1 (XFp , (τX log /S log )Fp )
Let C (respectively, C  ) be the compactiﬁed Frobenius corresponding to Φlog (respectively,
log
log 
)Z/pn Z , we can consider the diﬀerence between the defor(Φlog ) ). Since YZ/p
n Z = (Y
log
log
log 
mations YZ/p
)Z/pn+1 Z of YZ/p
n Z . This gives us a class
n+1 Z and (Y

ν ∈ Ext1YFp (ΩY log /k , OYFp )
Fp

Since φZ/pn Z = φZ/pn Z , the pull-back map deﬁned by either of these morphisms gives us

log
a map φ−1 : φ∗ (ωX/S
)Fp → ΩY log /k , which is generically zero over the component of YFp
Fp

that we called Z  in the proof of Proposition 4.6. Now φ−1 induces a pull-back morphism
on global Ext’s
ψ : Ext1YFp (ΩY log /k , OYFp ) → H 1 (YFp , φ∗ (τX log /S log )Fp )
Fp

The condition that the morphism φZ/pn+1 Z deform compatibly with the deformation of
 log , (Y  )log )Z/pn+1 Z to a morphism φ n+1 is exactly that
(X log , Y log )Z/pn+1 Z to (X
Z
Z/p
ψ(ν) = μ|YFp
Note that this condition, as well as the cohomology modules in which μ and ν live,
log
log
are independent of n. Thus, by adding μ and ν to φlog
Z/p2 Z : YZ/p2 Z → XZ/p2 Z , we obtain
a new morphism φlog : Y log → X log (of Z/p2 Z-ﬂat schemes). Then, by restricting φlog to
the open subscheme of Y log deﬁned by the ordinary locus of Z  , we obtain a Frobenius
lifting Ξlog on the ordinary locus of X log . The only points at which Ξ is not deﬁned are
the supersingular points (determined by α). Moreover, by the calculation of the discussion
preceding Proposition 4.3, it follows that the local height of Ξlog at a supersingular point
is ≤ 1. Indeed, in the notation of loc. cit., “π” is equal to p times an element of k[[ξ, η]],
which, this time, might not be a unit since Y log might not be the reduction modulo p2 of
a regular scheme; hence the inequality ≤ 1, rather than the sharp equality = 1. At any
rate, it thus follows that ht(Ξ) ≤ ht(ΦZ/p2 Z ). But then, by Proposition 4.10, X log is equal
to some canonical curve reduced modulo p2 , and, by Proposition 2.6, (4), of Chapter II, it
log
thus follows that this canonical curve is the one determined by α. Thus, X log = XZ/p
2Z.
log
log
n+1

and X
coincide modulo p
. By Lemma 4.15
But this means that μ = 0, so X
log
(the rigidity of an admissible Frobenius lifting), it thus follows that Φ and (Φlog ) also
coincide modulo pn+1 . This proves the induction step, and hence the Lemma. 
Putting everything together, we see that we have proven the following geometric
criterion for a curve to be canonical:
151

Theorem 4.17. Let X log → S log be a smooth r-pointed curve of genus g. Let α be a
p-adic quasiconformal equivalence to which X log belongs. Then X log is canonical if and
only if (X log , α) admits an admissible Frobenius lifting.
Proof. We saw in §3 that a canonical curve admits an admissible Frobenius lifting. On the
other hand, given an (X log , α) which admits an admissible Frobenius lifting, there exists
 log ≡ X log modulo p) which is canonical, hence admits an admissible
 log , α) (with X
an (X
 log . 
Frobenius lifting. Thus, by Lemma 4.16, it follows that X log = X
Deﬁnition 4.18. Suppose that (X log , α) admits an admissible Frobenius lifting Φlog .
Then we shall call Φlog the p-adic Green’s function.
Remark. The justiﬁcation for this terminology is as follows. In the classical complex case,
one of the main approaches to proving that hyperbolic curves can be uniformized by the
upper half plane is given by constructing a Green’s function on the universal covering
space of the Riemann surface (see, e.g., [FK]). Once one proves that the universal covering
space is just the upper half plane, then one sees that this Green’s function is really just
the logarithm of the hyperbolic distance between two points. On the other hand, the
canonical Frobenius lifting Φlog may also be regarded as giving us a notion of distance
on X log . Indeed, in the classical modular case, where X log parametrizes elliptic curves, if
one can get from point a to point b by applying Φlog a total of N times, then it means
that the corresponding elliptic curves are isogenous via a cyclic isogeny of order pN . Thus,
the analogy between Φlog and the classical complex Green’s function (which is just the
logartihm of the hyperbolic distance) will be established once one accepts that isogeny
is the proper analogue of distance. But to see this, one need merely think of lattices in
Q2p , which one can draw schematically as a graph. Then two lattices are related by an
isogeny of order pN if and only if they are N edges apart on this graph. This establishes
the relationship between isogeny and distance.
Remark. We also observe that for elliptic curves (regarded parabolically), the same deﬁnition of compactiﬁed Frobenius liftings, and admissible Frobenius liftings goes through,
but everything is trivial, since there are no supersingular points to contend with. Thus, we
(trivially) obtain the analogue of Theorem 4.17: that an elliptic curve over A with ordinary
reduction is canonical if and only if it admits a Frobenius lifting deﬁned everywhere on the
curve.

152

Chapter V: Uniformizations of Ordinary Curves
§0. Introduction
Having studied the case of canonical curves in the previous Chapter, in this Chapter
we turn to the case of arbitrary curves with ordinary reduction modulo p. We do this by
working with the universal case: i.e., the universal curve over the moduli stack. Unlike
the canonical case, one does not quite obtain such objects as the canonical Galois representation or the canonical log p-divisible group over the given base. Instead, one must
pass to various “schemes of multiplicative periods” – i.e., certain inﬁnite coverings of the
original base – in order to obtain such objects. On the other hand, since these objects
are canonically associated to the curve over the given base, it is natural to guess that they
should descend from the scheme of multiplicative periods back down to the original base in
some appropriate sense. The key idea here is that, for instance in the case of the canonical
Galois representation (which is fundamental to the construction of all the other objects),
if one works with modules of rank two, not over Zp , but over some appropriate ring of
p-adic periods D Gal , then one can in fact construct a canonical Galois representation over
the original base. Thus, one obtains a representation of the entire arithmetic fundamental
Gal
group into GL±
), which in some sense extends the representation of the geometric
2 (D
fundamental group into GL±
2 (Zp ). Moreover, (in the hyperbolic case) this representation
Gal
) is canonical, and dual crystalline in
of the arithmetic fundamental group into GL±
2 (D
some appropriate sense, despite the fact that (unlike the case handled in [Falt], §2), it is
on a space of inﬁnite rank over Zp . The process of passing from the canonical representation of the geometric fundamental group into GL±
2 (Zp ) to the canonical representation of
Gal
the arithmetic fundamental group into GL±
(D
) is a sort of crystalline analogue of the
2
notion of an induced representation in group theory. We therefore refer to this process as
the process of crystalline induction.
Once one has this canonical dual crystalline representation of the arithmetic fundaGal
mental group into GL±
), one can linearize the obstruction to extending the repre2 (D
sentation of the geometric fundamental group into GL±
2 (Zp ) to the full arithmetic fundamental group. This linearization tells one, for instance, that as soon as one can extend
the representation of the geometric fundamental group into GL±
2 (Zp ) at all to the arithmetic fundamental group, this extension is automatically dual crystalline. This procedure
of linearizing the obstruction also allows one to see that this obstruction is precisely the
hyperbolic analogue of the obstruction to splitting a certain exact sequence of p-adic local
systems on the moduli stack of ordinary elliptic curves (in the parabolic case).
§1. Crystalline Induction
In Chapter III, we constructed a Frobenius-invariant indigenous bundle on the univerord
sal curve over N g,r . Unfortunately, unlike the case of a canonical curve, such information
153

does not immediately constitute an object of the category MF ∇ (see [Falt], §2), so we
cannot immediately convert it into a Galois representation. The problem is that our connection on the indigenous bundle is only a relative connection (for the universal curve over
ord
N g,r ), not a full connection on the total space of the universal curve. Also, the obstruction
to extending it to a full connection on the total space of the universal curve is nonzero.
Thus, in order to obtain a Galois representation, we must replace the indigenous bundle
by a certain natural “thickening” of the indigenous bundle. This thickening formally carries the structure of an object of the category MF ∇ , but has the disadvantage of being
of inﬁnite rank, so that we cannot immediately apply the theory of [Falt] to this object.
Fortunately, it is not diﬃcult to extend the theory of [Falt] so as to handle such objects of
inﬁnite rank. We thus obtain a Galois representation, as desired, which turns out to be a
sort of crystalline analogue of the notion of an “induced representation” in group theory.
The Crystalline-Induced MF ∇ -object
def

Let p be an odd prime. Let S be formally smooth over A = W (k), where k is a perfect
ﬁeld of characteristic p. Let us assume that S is endowed with a log structure induced by
a relative divisor with normal crossings over W (k). Let S log be the resulting log formal
scheme. Let f log : X log → S log be an r-pointed stable curve of genus g. Also, let us assume
that the classifying morphism S → Mg,r deﬁned by f log is étale. Let Φlog : S log → S log
be an ordinary Frobenius lifting.
Now let us suppose that our indigenous bundle (E, ∇E ) on X log is invariant under the
renormalized Frobenius (Chapter III, Deﬁnition 1.4): that is,
ΦE : (E, ∇E ) ∼
= F∗S log (E, ∇E )Φ
where the superscript “Φ” denotes pull-back by Φ, and the subscript “S log ” denotes that we
are considering the relative renormalized Frobenius pull-back over S log . (We shall denote
by F∗A the renormalized Frobenius pull-back over A.)
Let DS be the quasi-coherent OS -algebra (with the OS -action from the right) which is
obtained by taking the p-adic completion of the PD-envelope of the diagonal embedding of
S log in S log ×A S log (see, e.g., [Kato], §5.8). Thus, DS has an ideal IS ⊆ DS with DS /IS =
log
log
OS , and IS /IS2 ∼
= ΩS/A = ΩS . Note that DS has a natural logarithmic connection
∇DS . We shall regard DS as a ﬁltered object with connection, whose ﬁltration is given by
[i]
F i (DS ) = IS (i.e., divided powers of IS ). Thus, the Kodaira-Spencer morphism for the
log
subquotient of the ﬁltration given by F 1 (DS )/F 2 (DS ) = IS /IS2 ∼
= ΩS is the identity map.
Note that the Frobenius lifting Φlog on S log induces a morphism ΦDS : Φ∗ DS → DS which
preserves the Hodge ﬁltration. Finally, let us denote by ((DS )X , ∇(DS )X ) the pull-back of
(DS , ∇DS ) to X log .
Next, let us consider the obstruction to deﬁning a full logarthmic connection ∇ on E
(i.e., relative to X log → Spec(A)) with the following properties:
154

(1) ∇ has trivial determinant;
(2) the restriction of ∇ to a relative connection (for X log → S log ) is ∇E ;
(i.e., the
(3) the curvature of ∇ is an Ad(E)-valued section of ∧2 Ωlog
S
log
log
ωX/S ⊗OS ΩS -part of the curvature vanishes).
It is easy to see that the obstruction class to deﬁning such a connection is a section ηE of
log
0
1
R1 fDR,∗ Ad(E) ⊗OS Ωlog
S = F (R fDR,∗ Ad(E) ⊗OS ΩS )
log
and ΦE
whose projection to R1 f∗ τX log /S log ⊗OS Ωlog
S is the identity. Also, note that Φ
log
1
induce a Frobenius action on R fDR,∗ Ad(E) ⊗OS ΩS , which, by naturality, preserves ηE .
Thus, in particular, we see that unless we modify E in some way, there is no hope of
constructing a full connection ∇ as speciﬁed above.
PD

Thus, we make the following construction. Let us write S log × S log for Spf(DS )
(where we take “Spf” with respect to the p-adic topology). Similarly, we shall write
PD

PD

PD

S log × S log × S log , X log × X log , etc. for the obvious p-adic completions of PDPD

envelopes at the respective diagonals. Also, we have two projections πR , πL : S log ×
S log → S log to the left and right by which we can pull-back X log → S log to obtain curves
PD

PD

(X log )L → S log × S log , and (X log )R → S log × S log . Moreover, both of these curves
PD

form PD-thickenings of X log → S log → S log × S log (where the second morphism is the
diagonal embedding). It thus follows that if we pull-back (E, ∇E ) to obtain an indigenous
PD

bundle on the curve (X log )L → S log × S log , this indigenous bundle deﬁnes a crystal
PD

on Crys(X log /(S log × S log )) which we can then evaluate on the thickening (X log )R to
obtain a rank two vector bundle E  (on X R ). If we then push this sheaf E  forward via the
projection X R → X, we obtain a quasi-coherent sheaf ED on X. Moreover, ED has the
structure of a DS -module, hence of a (DS )X -module. In fact, ED is a locally free (DS )X module of rank two. Moreover, ED is equipped with a natural Hodge ﬁltration compatible
with that of (DS )X .
Next, we would like to equip ED with a full logarithmic connection that is compatible
with its structure as a (DS )X -module and the connection on (DS )X . First, note that
PD

PD

PD

PD

X log × S log × S log → S log × S log × S log is a PD-thickening of X log → S log →
PD

PD

S log × S log × S log (where the second morphism is the diagonal embedding). Thus, if we
PD

PD

PD

pull-back (E, ∇E ) to X log × S log × S log , we obtain a crystal E  on Crys(X log /(S log ×
PD

PD

PD

PD

PD

S log × S log )). On the other hand, S log × X log × X log → S log × S log × S log is also
PD

PD

a PD-thickening of X log → S log → S log × S log × S log . Thus, if we evaluate E  on
PD

PD

PD

PD

S log × X log × X log , and then push forward via the projection S log × X log × X log →
155

PD

PD

X log × X log , we obtain a sheaf E  on X log × X log . Now since (DS )X is equipped
PD

with a connection, the two pull-backs of (DS )X to X log × X log via the two projections
PD

X
πR
, πLX : X log × X log → X log can be identiﬁed; we denote the resulting sheaf of algebras
PD

on X log × X log by (DS )

PD

X log × X log

. Then E  is equipped with the structure of a locally free

-module of rank two. On the other hand, from the deﬁnition of ED , it follows
PD
X log × X log
X ∗
that both (πLX )∗ ED and (πR
) ED are naturally isomorphic (as (DS )
-modules) to
PD
X log × X log
PD
X ∗
E  , hence to each other. This isomorphism (πLX )∗ ED ∼
) ED on X log × X log deﬁnes
= (πR
a full logarithmic connection ∇ED on ED (with respect to X log → Spec(A)). Moreover,
(DS )

one checks easily that this connection is integral.
Finally, we have a Frobenius action
ΦED : F∗S log (ED ⊗DS ,ΦDS DS ) ∼
= ED
Here, in the deﬁnition of F∗S log , we ﬁrst pull back the relevant crystal by means of relative
Frobenius, and then consider the subsheaf consisting of sections whose reduction modulo
p is contained in the subsheaf of
Φ∗XFp (ED ⊗DS ,ΦDS DS )Fp ∼
= (Φ∗XFp EFp ) ⊗OS DS
given by
(Φ∗XFp F 1 (E)Fp ) ⊗OS DS ⊆ (Φ∗XFp EFp ) ⊗OS DS
Theorem 1.1. Over X log , there exists a natural, locally free, rank two (DS )X -module ED
equipped with a Hodge ﬁltration, a full integrable logarithmic connection ∇ED (relative to
X log → Spec(A)), and a Frobenius action
ΦED : F∗S log (ED ⊗DS ,ΦDS DS ) ∼
= ED
such that ED ⊗DS (DS /IS ) = E.
The Ring of Additive Periods
Before we can convert the induced object of Theorem 1.1 into a Galois representation,
we must ﬁrst study the Galois representation associated to DS , with its natural ﬁltration,
connection, and Frobenius action. Once we have done this, since ED is of ﬁnite rank over
156

DS , converting ED into a Galois representation will be no more diﬃcult than the “classical
case” discussed in [Falt], §2.
Let us ﬁrst note that, just as when we constructed “canonical aﬃne coordinates” in
Chapter III, §1, by considering the slopes of the Frobenius action ΦDS , we obtain a unique
Frobenius-equivariant embedding of OS -modules
Ωlog
S → IS
whose composite with the projection IS → IS /IS2 = Ωlog
S is the identity. It is here that
we use the divided powers of IS ⊆ DS . Let us write Geo(DS ) for the subbundle of DS
generated by Ωlog
S and OS . Note that Geo(DS ) is stabilized by ∇DS and by Frobenius.
Moreover, the Hodge ﬁltration on DS induces a Hodge ﬁltration on Geo(DS ). Observe
that with this extra data, Geo(DS ) becomes isomorphic to the uniformizing MF ∇ -object
associated to Φlog (of Deﬁnition 1.3 of Chapter III).
Now we want to pass to Galois representations. Let us assume that we have chosen
(once and for all) a base-point of S that avoids the divisors deﬁning the log structure. In
the following, our fundamental groups will be with respect to this base-point. Since our
construction will be canonical, we can work étale locally on S. Thus, we can assume that
S is aﬃne. We may also assume that S log is small (in the sense of [Falt], §2): that is, S log
is log étale over A[T1 , . . . , Td ] (with the log structure given by the divisor T1 · . . . · Td ). We
shall call these parameters T1 , . . . , Td small parameters. Then we would like to consider
the ring B + (S log ) of [Falt], §2. We will not review the deﬁnition of this ring here, since it
is rather involved, but roughly speaking, it is obtained by
log
(1) taking the normalization S of S log in the maximal covering of SK
which is étale in characteristic zero;

(2) reducing S modulo p and taking its perfection;
(3) taking the Witt ring with coeﬃcients in this perfection;
(4) adjoining the divided powers of a certain ideal to this Witt ring; and
(5) ﬁnally, completing with respect to a certain topology.
In particular,
(1) B + (S log ) is obtained as the inverse limit of a projective system of PDthickenings of the OSFp -algebra SFp ;
(2) B + (S log ) has an ideal I + ⊆ B + (S log ) which is Galois-invariant and

such that B + (S log )/I + ∼
= S∧ (i.e., the p-adic completion of S).
157

Moreover, B + (S log ) comes equipped with a natural Frobenius action (which we shall denote
log
by means of a superscripted “F ”), as well as a continuous π1 (SK
)-action, which commutes
+
log
with the Frobenius. The Frobenius invariants of B (S ) are given by Zp ⊆ B + (S log ).
There is a Galois equivariant injection β : Zp (1) → B + (S log ). Frequently, we shall abuse
notation and write β ∈ B + (S log ) for the element of B + (S log ) obtained by applying β to
some generator of Zp (1). Then the Frobenius action on β takes β to p · β. We will denote
by B(S log ) the ring obtained from B + (S log ) by inverting β and p. This completes our
review of B + (−).
Now let us return to the speciﬁc situation we have at hand. By thinking of (DS , ∇DS )
as a crystal, and using the fact that B + (S log ) is an inverse limit of PD-thickenings of a
certain OSFp -algebra, one can evaluate this crystal on B + (S log ) (and complete p-adically)
to obtain a B + (S log )-module which we shall denote by
DS ⊗OS B + (S log )
(where the “hat” denotes p-adic completion). Alternatively, one can embed OS into
B + (S log ) by means of a choice of small parameters, and then take the literal tensor product, as described in [Falt], §2. In our situation, however, since we are given a Frobenius
lifting Φlog , the most useful point of view will be to embed
OS → B + (S log )
OS into B + (S log ) by means of the Frobenius lifting Φlog . Indeed, the choice of Frobenius
lifting gives us an embedding of OS into the ring of Witt vectors that appears in the
construction (reviewed above) of B + (S log ). Then, we may regard the module considered
above as obtained via the literal tensor product with respect to this particular embedding
of OS into B + (S log ). At any rate, DS ⊗OS B + (S log ) has a natural ﬁltration and Frobenius
action. Let T log → S log be the ﬁnite covering deﬁned by Φlog . (Thus, T log ∼
= S log .) Then
log
DS ⊗OS B + (S log ) also has a natural action by π1 (TK ). The reason why we must restrict
log
), is that the way the Galois action is deﬁned
to T log , rather than considering all of π1 (SK
(see [Falt], §2) involves exponentiating the connection ∇DS , so in order for the exponential
series to converge, one must be in a situation where the connection acts in a suﬃciently
log
)
nilpotent fashion. For convenience, let us write ΠT log (respectively, ΠS log ) for π1 (TK
log
(respectively, π1 (SK )).
Let us recall the uniformizing Galois representation Pet (Deﬁnition 1.4 of Chapter
III) associated to the ordinary Frobenius lifting Φlog . Recall that Pet ﬁts into an exact
sequence of ΠT log -modules
0 → Θet
Φ (1) → Pet → Zp → 0
The space of splittings of this sequence then forms an aﬃne Zp -scheme, which is the
∨
∨
). More concretely, Aﬀ(Pet
) is a polynomial ring over Zp in
spectrum of some ring Aﬀ(Pet
158

3g − 3 + r variables which is equipped with an action by ΠT log . Moreover, the submodule
∨
∨
∨
→ Aﬀ(Pet
). We shall refer to Aﬀ(Pet
) as the
of polynomials of degree ≤ 1 is given by Pet
∨
aﬃnization of Pet .
∨
∨
Note that Aﬀ(Pet
) has a natural ΠT log -invariant augmentation Aﬀ(Pet
) → Fp . Let
Gal
∨
DS be the p-adic completion of the PD-envelope of Aﬀ(Pet ) at this augmentation. Thus,
DSGal is equipped with a natural structure of ΠT log -algebra, and, moreover, we have a

ΠT log -invariant inclusion
∨
→ DSGal
Pet

In other words, DS may be identiﬁed with the ring of additive periods (of Deﬁnition 1.5
of Chapter III). On the other hand, since Pet is the Galois representation contravariantly
associated to Geo(DS ), it follows that we have a morphism
Pet → Geo(DS )∨ ⊗OS B + (S log )
which respects the Hodge ﬁltrations, Frobenius actions (where Pη is endowed with the
trivial Hodge ﬁltration and Frobenius action), and Galois actions (by ΠT log ). “Switching
duals,” we thus see that we have a morphism
∨
Geo(DS ) → Pet
⊗Zp B + (S log ) → DSGal ⊗Zp B + (S log )

which respects Hodge, Frobenius, and Galois. Next, since Geo(DS ) generates DS as a
“PD-polynomial algebra” with no relations, it thus follows that we obtain a morphism
DS → DSGal ⊗Zp B + (S log )
which respects Hodge, Frobenius, and Galois. Finally, tensoring with B + (S log ), we obtain
the following result:
Proposition 1.2. We have a morphism
DS ⊗OS B + (S log ) → DSGal ⊗Zp B + (S log )
which respects Hodge ﬁltrations, Frobenius actions, and Galois actions (by ΠT log ).
The Crystalline-Induced Galois Representation
Let U log ⊆ X log be a small aﬃne open subset. Choose a Frobenius lifting Ψlog on
U log that is compatible with Φlog on S log . Thus, Ψlog gives us an embedding of OU into
B + (U log ) which ﬁts into a commutative diagram
159

OS
⏐
⏐

−→

B + (S log )
⏐
⏐

OU

−→

B + (U log )

We would like to consider
∨
⊗OU B + (U log )
GU = ED
def

where the “∨” denotes the dual as a DS -module. The problem is to show that GU has
enough Frobenius-invariant sections in the zeroth step of its ﬁltration. The reason that we
cannot apply the theory of [Falt], §2 directly is that the relevant theorem (Theorem 2.4
of loc. cit.) assumes a bound on the number of steps in the ﬁltration of the MF ∇ -object
under consideration. On the other hand, ED has inﬁnitely many steps,
What we can do is base-change GU by the morphism of Proposition 1.2. We then
obtain a free (DSGal ⊗Zp B + (U log ))-module
GU
of rank two. Moreover, GU is equipped with a Galois action, a Hodge ﬁltration, and a
Frobenius action
F∗ ((GU )F ) ∼
= GU
(where the superscripted “F ” denotes base-change by the Frobenius on B + (U log )).
Proposition 1.3. The submodule
(F 0 (GU ))F =1
(consisting of Frobenius-invariant elements of F 0 (GU )) forms a free DSGal -module EUGal of
rank two.
Proof. The proof is entirely the same as that of Theorem 2.4 of [Falt], §2. The point
of base-changing by the morphism of Proposition 1.2 is that this enables us to replace
∨
whose Hodge ﬁltrations have inﬁnitely many steps by objects like GU
objects like ED
whose Hodge ﬁltration has essentially only two steps. In fact, over T log , the relative
connection ∇E on E actually extends to a full connection ∇ modulo p, so (EFp , ∇ ) deﬁnes
a Galois representation onto some Fp -vector space E  (⊆ EF∨p ⊗ B + (U log )Fp ) of dimension
two. Moreover, GU has a ﬁltration (deﬁned by taking divided powers of the augmentation
160

ideal of DSGal → Fp ) whose subquotients are tensor products of EF∨p ⊗ B + (U log )Fp with
symmetric powers of Ωet (−1)Fp . That is to say, we know that F 0 (−)F =1 for all of these
subquotients is as desired, so next we want to consider the issue of whether the various
extensions involved split over B + (U log ). But this issue is precisely that discussed in the
proof of Theorem 2.4 of [Falt], §2. Thus, we see that we have enough Frobenius invariants,
at least over the PD-completion of DSGal . But it is a simple exercise to see that the fact that
the original Frobenius action is deﬁned over DSGal (i.e., not just over the PD-completion
of DSGal ) implies that the Frobenius invariants will also be deﬁned over DSGal itself. This
completes the proof. 
def

Let XTlog = X log ×S log T log . Similarly, we have UTlog ⊆ XTlog . Now we have a natural
π1 ((UTlog )K )-action on GU Since this action preserves the ﬁltration and commutes with
Frobenius, we thus get an action of π1 ((UTlog )K ) on EUGal , which is compatible with multiplication by elements of DSGal and the ΠT log -action on DSGal . Moreover, as we vary the
open subset U ⊆ X, the resulting EUGal ’s are clearly compatible. Thus, they glue together
to form a π1 ((XTlog )K )-DSGal -module
Gal
EX

We state this as a Theorem:
Theorem 1.4. The crystalline-induced MF ∇ -object
(ED ; F i (ED ); ΦED ; ∇ED )
of Theorem 1.1 has associated to it an (up to ±1) π1 ((XTlog )K )-DSGal -module
Gal
EX
Gal
which is a free DSGal -module of rank two. We shall refer to EX
as the crystalline-induced
∇
Galois representation associated to the induced MF -object of Theorem 1.1.

Remark. Unlike the case of canonical curves, where one actually has a dual crystalline
representation (in the sense of [Falt], §2) into GL±
2 (Zp ), in the case of noncanonical curves,
Gal
EX is as close a p-adic analogue as one can get to the canonical representation in the
complex case. In the following subsection, we shall make the phrase “as close as one can
get” more precise.

161

Relation to the Canonical Aﬃne Coordinates
log
Let T∞
→ S log be the inverse limit of the coverings obtained by iterating Φlog . Let
log
log
log
be the pull-back to T∞
of X log → S log . Let us choose base-points once and
XT∞ → T∞

for all, and let

def

Π1 = π1 ((XTlog )K );

def

Π∞ = π1 ((XTlog
) )
∞ K

Thus, Π∞ ⊆ Π1 is a closed subgroup. In the preceding subsection, we constructed a DSGal Gal
Π1 -module which we called EX
. If we restrict our Galois representations from Π1 to Π∞ ,
then we obtain a Π∞ -equivariant surjection
πS : DSGal → Zp
whose kernel is the augmentation ideal ISGal , i.e., the PD-ideal generated by ΩGal
S . Thus, if
Gal
we base change EX
by πS , we obtain a rank two Zp -module with a continuous Π∞ -action
which we denote by:
def

Gal
⊗DGal ,πS Zp
E0 = EX
S

Thus, in summary, E0 has the advantage that it is of rank two over Zp , but the disadvantage
Gal
that it only has a Π∞ - (as opposed to a full Π1 -) action, while EX
has the advantage
that is has a natural Π1 -action, but the disadvantage that it is of rank two over the rather
large ring of additive periods DSGal . In this subsection, we show that the canonical aﬃne
coordinates (of Chapter III, Theorem 3.6) measure precisely the degree to which the Π∞
action on E0 cannot be extended to a full action of Π1 .
We begin with the following fundamental observation. Let Δ ⊆ Π∞ ⊆ Π1 be the
log
). Let
geometric fundamental group, i.e., the kernel of the natural morphism Π1 → π1 (TK
us consider the exact sequence of Π∞ -modules
Gal
⊗DGal DSGal /(ISGal )2 → E0 → 0
0 → E0 ⊗Zp ISGal /(ISGal )2 → EX
S

By considering the underlying Δ-module structures, we obtain that the above exact sequence deﬁnes an extension class
η Gal ∈ H 1 (Δ, Ad(E0 )) ⊗Zp ISGal /(ISGal )2 = H 1 (Δ, Ad(E0 )) ⊗Zp ΩGal
S
log
which is ﬁxed by the natural action of π1 ((T∞
)K ) on this cohomology group. On the
other hand, because our original indigenous bundle is ordinary, we see that we have a
log
)K )-equivariant inclusion
π1 ((T∞

162

∨
1
(ΩGal
S ) → H (Δ, Ad(E0 ))

Then we claim that η Gal is precisely the class in H 1 (Δ, Ad(E0 )) ⊗Zp ΩGal
that corresponds
S
to this inclusion. Indeed, this follows immediately from observing that η Gal is essentially
the Galois version of the class ηE (the obstruction to the existence of a full connection on
E) that we encountered on our way to constructing ED . It then follows immediately from
the way one passes from MF ∇ -objects to Galois representations that η Gal is the above
inclusion, as claimed. This observation concerning η Gal will be the fundamental “hard
fact” underlying what we do in this subsection; the rest will be general nonsense.
The general nonsense that we will use is the theory of [Schl]. Let us denote the
Π∞ -module E0 ⊗Zp Fp by (E0 )Fp . Note that since over T log , the obstruction to putting
a full connection on EFp vanishes, so we get a genuine MF ∇ -object (whose underlying
vector bundle is (ED ⊗ DS /IS )Fp ) modulo p. Thus, the Π∞ -action on (E0 )Fp extends to
a natural (dual crystalline) action of Π1 on (E0 )Fp . We apply Schlessinger’s theory to the
functor on artinian rings B with residue ﬁeld Fp that assigns to such a ring B the set of
isomorphism classes of continuous representations of Δ on a free B-module EB of rank
two such that (EB ) ⊗B Fp = (E0 )Fp . Since H i (Δ, Ad((E0 )Fp )) is zero if i = 1, and of
dimension 6g − 6 + 2r over Fp if i = 1, it follows easily from [Schl] that this functor is
prorepresented by a formal scheme R over Zp . Moreover, R is formally smooth over Zp ,
of relative dimension 6g − 6 + 2r.
Now we claim that there is a natural continuous action of π1 ((T log )K ) on R. Indeed,
let α ∈ Π1 . Since Δ ⊆ Π1 is a normal subgroup, for any representation of Δ on some EB
as above, we obtain a new representation by conjugating elements of Δ by α, and then
acting on EB in the original fashion. Since the original Δ-action on EB extends to a full
Π1 -action on (EB ) ⊗B Fp , it follows that this new representation is isomorphic to the old
after base change by B → Fp . Thus, the new representation deﬁnes a new B-valued point
of R. This deﬁnes an action of Π1 on R which is clearly trivial on Δ ⊆ Π1 . Thus, we
obtain a natural action of π1 ((T log )K ) on R.
Gal
Let us now turn to applying R to understanding the Π1 -module EX
. Let DSGal be
Gal
the p-adic completion of DSGal . The underlying Δ-module structure on EX
deﬁnes a
classifying morphism

κ : Spf(DSGal ) → R
(This is O.K. despite the fact that DSGal ⊗Zp Z/pN Z is not artinian, since Δ is topologically
ﬁnitely generated.) Let
σ0 : Spf(Zp ) → R
be the composite of Spf(πS ) with κ. Let RPD be the p-adic completion of the PD-envelope
of R at σ0 . Let
163

κPD : Spf(DSGal ) → RPD
be the morphism induced by κ. Then the morphism induced by κPD on the Zariski tangent
spaces at σ0 is precisely the injection corresponding to the class η Gal considered above.
Thus, we have the following:
Lemma 1.5. The morphism κPD is a closed immersion of formal schemes.
Gal
actually comes from
Now let us consider the fact that the Δ-module structure on EX
Gal
a Π1 -module structure which is DS -semilinear (with respect to the Π1 -action on DSGal
log
through π1 (TK
)). If we translate this statement by means of the functorial interpretation
of R, we obtain the following:
log
log
)-equivariant with respect to the natural π1 (TK
)Lemma 1.6. The morphism κ is π1 (TK
Gal
actions on DS and R.
log
Now let φ : Γ → π1 (TK
) be a continuous homomorphism of topological groups. Let

1 → Δ → ΠΓ → Γ → 1
be the pull-back of the group extension
log
1 → Δ → Π1 → π1 (TK
)→1

by means of φ. Then one can consider the issue of whether or not the Δ-action on E0
extends to a continuous, Zp -linear action of ΠΓ on E0 . Note that since H 0 (Δ, Ad(E0 )) = 0,
as long as we require that the associated determinant representation of ΠΓ is the cyclotomic
character, such an extension will always be unique (up to ±1). On the other hand, by the
same reasoning as that used in Lemma 1.6, the Δ-action on E0 will extend to a ΠΓ -action
on E0 if and only if the Zp -valued point σ0 of R is ﬁxed by Γ (acting through φ). Moreover,
by the preceding two lemmas, we see that σ0 is ﬁxed by Γ if and only if the Zp -valued point
of DSGal deﬁned by πS is stabilized by Γ. But this, in turn, is equivalent to the statement
that the restriction of the canonical extension class ηΦ (discussed just before Deﬁnition 1.5
of Chapter III) becomes trivial when restricted to Γ.
Now let us suppose that (B, mB ) is a local ring with residue ﬁeld k which is p-adically
complete, Zp -ﬂat, and has a topologically nilpotent PD-structure on mB . (Note that for
such a ring B, log : (1+mB ) → mB and exp : mB → (1+mB ) deﬁne inverse isomorphisms.)
Let Γ = π1 (Spf(B)K ). Suppose further that
ψ : Spf(B) → S
164

is a morphism whose image avoids the divisor deﬁning the log structure on S log . Then for
log
) which is
some closed subgroup Γ ⊆ Γ of ﬁnite index, we have a morphism φ : Γ → π1 (TK
compatible with the morphism induced on fundamental groups by ψ. Recall from Chapter
III, Theorem 3.8, the canonical aﬃne coordinates corresponding to ψ. These coordinates
are valued in B (or, more precisely, in mB ). Moreover, they are zero if and only if the
class ηΦ becomes zero when restricted to Γ . It is easy to see that ηΦ |Γ = 0 if and only
if ηΦ |Γ = 0. Also, we know from Chapter III that ψ corresponds to a canonical curve if
and only if the canonical aﬃne coordinates are zero. Thus, putting everything together,
we obtain the following result:
Theorem 1.7. The morphism ψ corresponds to a canonical curve if and only if the
Δ-action on E0 extends to a Zp -linear, continuous action of ΠΓ on E0 .
More generally, but less precisely, we see that:
(*) The canonical aﬃne coordinates in mB associated to ψ are a measure of the obstruction to extending the Δ-action on E0 to a Zp -linear,
continuous action of ΠΓ on E0 .
Since the class ηΦ is “as nonzero as it can be” on S log , we thus see that we have justiﬁed
Gal
the statement made at the end of the preceding subsection that the Π1 -module EX
is “as
close as one can get” to extending the Δ-action on E0 to a full Π1 -action.
Remark. In some sense, we can describe what we have done in this subsection as follows.
Consider the obstruction to extending the Δ-action on E0 to an action of ΠΓ . A priori,
this obstruction is highly nonlinear and diﬃcult to get one’s hands on explicitly. Note that
this nonlinearity exists despite the fact that we already have a Π∞ -action on E0 , and the
discrepancy between Π1 and Π∞ is “essentially” a linear Zp -space of rank 3g−3+r. Rather,
the nonlinearity arises fundamentally from the fact that we are considering representations
into GL±
2 , which is not an abelian (or even solvable) group. In particular, the moduli space
R of representations of Δ into GL±
2 has no natural linear structure. Thus, the point of
Gal
Gal
constructing EX and reinterpreting the existence of EX
in terms of R, as we have done
in this subsection, was to linearize this obstruction by means of the uniformization of (the
relevant part of) RPD by means κPD .
Remark. For the reader interested in pursuing analogies with the complex case, we also
make the following observation. Since R is the local moduli space of deformations of the
canonical representation Δ → GL±
2 (Zp ) of the geometric fundamental group, it is natural
to regard R as a sort of local p-adic analogue of the space RC of isomorphism classes of
representations of the geometric fundamental group into PSL2 (C) in the complex case.
Thus, RC has complex dimension 6g − 6 + 2r. Inside RC , one has Fricke space RR ,
with real dimension 6r − 6 + 2r, corresponding to the representations into PSL2 (R). In a
neighborhood of the canonical representation of a curve, RR maps diﬀeomorphically onto
165

Mg,r . Thus, one can regard the subspace Spf(DSGal ) → RPD as analogous to Fricke space
RR ⊆ RC in the complex case.
The Parabolic Case
Before proceeding, we pause to take a brief look at what happens for elliptic curves
(regarded parabolically). Although there are many similarities between the parabolic and
hyperbolic cases, there are also certain diﬀerences. This is not so surprising if one considers
the canonical representations arising from uniformizations in the complex case. Indeed,
in the complex context, for hyperbolic curves, the canonical representation of the fundamental group into PSL2 (R) is completely well-deﬁned up to conjugation by an element of
PSL2 (R), while for elliptic curves, the morphism (induced by deck transformations on the
uniformization by C) gives a representation of the fundamental group into the group of
translations Ga (C) of the complex plane, but this representation is not well-deﬁned up to
conjugation by an element of Ga (C). Rather, there is an ambiguity of multiplication by a
complex number.
On the other hand, this same phenomenon of “lack of rigidity” ultimately is a consequence of the overall linearity of the situation, which has positive aspects, as well. For
instance, one can carry out the construction of the induced MF ∇ -object (Theorem 1.1) for
elliptic curves just as in the hyperbolic case. However, precisely because the obstruction
to deﬁning an MF ∇ -object is entirely linear from the outset, this approach is a sort of
overkill. Thus, in the following we propose to examine the obstruction to deﬁning a “full”
MF ∇ -object (i.e., the same obstruction as the one we examined in the hyperbolic case)
directly, at the level of Galois representations, without resorting to the tool of crystalline
induction.
Thus, let us assume that f log : X log → S log is an ordinary zero pointed curve of
genus one such that the classifying morphism S → M1,0 is étale. Since the canonical
representation should be an extension of a rank one étale representation by its dual Tate
log
log
twisted once, we consider the local system R1 (fK
)et,∗ Zp (1) on SK
. Let us denote the
def

log
)-module corresponding to this local system by H 1 . Then there exists a
ΠS = π1 (SK
rank one ΠS -submodule E(1) ⊆ H 1 such that the action of ΠS on E is unramiﬁed, and
we have an exact sequence:

0 → E(1) → H 1 → E ∨ → 0
Suppose that E  is an étale ΠS -module such that (E  )⊗2 = E ∨ . Then, the canonical
representation of the universal elliptic curve should be an extension of E  by (E  )∨ (1). If
we tensor the above exact sequence by E, we get an exact sequence of ΠS -modules
0 → E ⊗2 (1) → H 1 ⊗ E → Zp → 0
Thus, the obstruction to the existence of such a canonical representation is precisely the
obstruction to lifting 1 ∈ Zp in the above exact sequence. This obstruction class lies in
166

H 1 (ΠS , E ⊗2 (1))
and coincides with the class ηΦ deﬁned by the canonical Frobenius lifting Φlog on S log . That
is to say, we end up with essentially the same conclusion as in the hyperbolic case: Namely,
that the obstruction to the existence of a “canonical representation” for the universal
log
)) is given precisely by the class ηΦ deﬁned
ordinary elliptic curve (deﬁned on all of π1 (XK
by the canonical Frobenius lifting.
§2. Canonical Objects Over the Stack of Multiplicative Periods
In this Section, we note that by working over the stack of multiplicative periods, we
can construct all the objects that we are familiar with from the case of canonical curves.
The Stack of Multiplicative Periods
ord

Let S log = (N g,r )log . Let Φlog be the canonical Frobenius lifting on S log (as in Chapter
III, Theorem 2.8). If, for some N ≥ 1, we take the N th iterate of Φlog , we get a ﬁnite, ﬂat
covering
(Φlog )N : S log → S log
of S log . Let P log be the inductive limit of these coverings (as N goes to inﬁnity). Let P log
be the p-adic completion of P log .
Deﬁnition 2.1. We shall call P log (respectively, P log ) the universal (respectively, complete) stack of multiplicative periods.
Unlike the rings of additive periods considered earlier, which, roughly speaking, are generated by adjoining the logarithms of the multiplicative parameters to Zp , the structure
sheaf of the stack of multiplicative periods is obtained essentially by adjoining all p-power
roots of the multiplicative parameters to the structure sheaf of the original base scheme
(or stack).
More generally, let T log be a formal log scheme, whose underlying scheme T is padically complete and ﬂat over Zp . Let hlog : Y log → T log be an r-pointed stable curve
of genus g that arises from some classifying morphism T log → S log . Then if we pull back
the morphism P log → S log via the classifying morphism T log → S log for hlog , we obtain
an object
PTlog → T log
167

over T log . Let PTlog be the p-adic completion of PTlog . We shall always assume that:
log
(*) The log structure of TQ
is trivial over an open dense set.
p

For instance, typically T log will be the normalization of Zp in a ﬁnite ﬁeld extension of Qp
with a log structure that is trivial in characteristic zero.
Deﬁnition 2.2. We shall call PTlog (respectively, PTlog ) the (respectively, completed) formal
scheme of multiplicative periods associated to the curve hlog : Y log → T log .
Note that PTlog depends on the choice of classifying morphism T log → S log for the curve
log

that lifts the morphism T log → Mg,r deﬁned by the curve itself. That is, PTlog depends on
a choice of quasiconformal equivalence class for hlog : Y log → T log .
Remark. Often in what follows we shall work in the universal case, that is, over S log , and
thus obtain objects over P log (or P log ). However, one should always remember that the
objects constructed deﬁne (by restriction) objects over PTlog (or PTlog ) for any r-pointed
stable curve of genus g over T log satisfying the hypotheses just stated.
The Canonical Log p-divisible Group
ord log
Let S log = (Ng,r
) : that is, the locus of smooth ordinary curves (with a choice of
quasiconformal equivalence class). Thus, the log structure on S log is trivial. Let f log :
X log → S log be the universal curve. Let f log [N ] : X log [N ] → S log be the pull-back of
f log by the N th iterate of the canonical Frobenius. Thus, if we pull (E, ∇E ) back to
X log [N ] and reduce modulo pN , the obstruction to deﬁning a full connection (relative
to X log [N ] → Spec(A)) vanishes, and so, we obtain an MF ∇ -object, which we shall
call E[N ]. Alternatively, this MF ∇ -object can be obtained taking the MF ∇ -object in
Theorem 1.1, pulling back to X log [N ], reducing modulo pN , and then reducing modulo
ISN . By [Falt], Theorem 7.1, away from the divisor at inﬁnity, and the method of Chapter
IV, §2 (following [Kato2]) at the divisor at inﬁnity, E[N ] deﬁnes a ﬁnite, ﬂat log group
object G[N ] on X log [N ]. Let P log → S log be the stack of multiplicative periods. Let
f log [∞] : X log [∞] → P log be the pull-back of f log to P log . Then by restricting from
X log [N ] to X log [∞] and then taking the inductive limit, we obtain an (up to ±1) log
p-divisible group

G[∞] = lim G[N ]|X log [∞]
−→

on X log [∞].
Deﬁnition 2.3. We shall call G[∞] the canonical log p-divisible group on X log [∞].
168

If we invert p, and pass to p-adic Tate modules, then we obtain an étale local system of
Zp ⊕ Zp ’s (up to ±1) on X log [∞]Qp . Now in the notation of §1, we have
Π∞ = π1 (X log [∞]Qp )
Thus, the p-adic Tate module of G[∞]Qp is given by the representation of Π∞ on E0 which
was discussed in §1. Let us denote this representation by
ρ∞ : Π∞ → GL± (E0 )
Deﬁnition 2.4. We shall call ρ∞ the canonical Galois representation of Π∞ .
ord
Remark. If T is any p-adically complete formal scheme which is Zp -ﬂat, and φ : T → Ng,r
is a morphism, then even though the canonical log p-divisible group and the canonical
Galois representation are not deﬁned until one goes up to the scheme of multiplicative
ord
periods, one can nonetheless pull-back the canonical indigenous bundle (E, ∇E )N on Ng,r
to obtain an indigenous bundle (E, ∇E )T on XTlog → T . This indigenous bundle is deﬁned
over T , i.e., one needn’t pass to the scheme of multiplicative periods.

Deﬁnition 2.5. We shall call (E, ∇E )T the canonical indigenous bundle on XTlog .
One should always remember that one only obtains the canonical indigenous bundle after
ord
(i.e., a quasiconformal equivalence class) of the classifying
choosing a lifting φ : T → Ng,r
morphism T → Mg,r of the curve.
The Canonical Frobenius Lifting
We continue with the notation of the preceding subsection. It follows from Chapter
IV, Proposition 3.2, that the supersingular divisor D ⊆ XFp (where f log : X log → S log
is the universal curve) is étale over SFp . We shall denote its complement in X, the
ordinary locus of X log , by X ord . Now it is immediate that the construction of the canonical
Frobenius lifting over the ordinary locus (preceding Theorem 1.6 of Chapter IV) carries
over immediately to the present case (where the base is S, as opposed to the ring of Witt
vectors with coeﬃcients in a perfect ﬁeld). Thus, if we denote base-change by Φlog (the
canonical Frobenius) by means of a superscript “F ,” we obtain the universal analogue of
Theorem 1.6 of Chapter IV:
Theorem 2.6. There exists a unique ordinary Frobenius lifting (called canonical)
log ord
) → ((X log )ord )F
Φlog
X : (X

169

over the ordinary locus such that we get a horizontal morphism Φ∗X E F → E which preserves
the Hodge ﬁltration.
Now let T be any p-adically complete formal scheme which is Zp -ﬂat, and let φ : T →
ord
Ng,r be a morphism. Let XTlog → T be the pull-back of the universal curve by φ. Write
XTlog
F for the pull-back of the universal curve by Φ ◦ φ. Then by restricting the morphism
log
ΦX of Theorem 2.7, we obtain a T -morphism
log ord
)T → (X log )ord
Φlog
TF
XT : (X

Thus, in the spirit of Deﬁnition 4.18 of Chapter IV, we make the following:
log
Deﬁnition 2.7. We shall call XTlog
F the Frobenius conjugate curve to XT . We shall call
log
Φlog
XT the p-adic Green’s function of the curve XT → T .

Next, we consider compactiﬁcations of this canonical Frobenius lifting. Let D[∞] ⊆
X[∞]Fp be the result of base-changing to P . Let D[∞] ⊆ X[∞] be the respective p-adic
completions. Let XD [∞] be the completion of X[∞] at D[∞]. Then just as in §3 of
Chapter IV, by looking at the universal deformation spaces of the canonical log p-divisible
group and its double Frobenius conjugate, we obtain an isomorphism
Ψ : XDF 2 [∞] ∼
= XD [∞]
Let Y [∞] → X[∞] be the ﬁnite, ﬂat covering (of degree p + 1) parametrizing cyclic
subgroups (in the Drinfeldian sense) of the canonical log p-divisible group. Then, just as
before, there exists a divisor E ⊆ Y [∞]Fp that maps isomorphically onto D[∞]Fp . Let
YE [∞] be the completion of Y [∞] at E. Then we obtain an embedding
(DE , RE ) : YE [∞] → XD [∞] ×P XDF 2 [∞]
The image of this embedding is a divisor, which, when restricted to the ordinary locus,
is equal to the union of the graph of the canonical Frobenius on (X log )ord with its “Ψtranspose,” as in Chapter IV, §3 (see the discussion preceding Deﬁnition 3.3).
Deﬁnition 2.8. We shall call Y [∞] → X[∞], together with Ψ and (DE , RE ) the compactiﬁcation of the canonical Frobenius lifting Φlog
X .
Thus, although the canonical Frobenius lifting Φlog
X is deﬁned over S (without passing to
the stack of multiplicative periods), the compactiﬁcation is only deﬁned over the completed
stack of multiplicative periods.
170

Bibliography
[Abikoﬀ] W. Abikoﬀ, The Real Analytic Theory of Teichmüller Space, Lecture Notes in Mathematics 820,
Springer, 1980.
[AC] E. Arbarello and M. Cornalba, The Picard Groups of the Moduli Space of Curves, Topology 26, No. 2
(1987), 153-171.
[BBM] P. Berthelot, L. Breen, and W. Messing, Théorie de Dieudonné cristalline II, Lecture Notes in Mathematics 930, Springer, 1982.
[Bers] L. Bers, Uniformization by Beltrami Equations, Comm. Pure Appl. Math. 14 (1961), 215-228.
[BK] S. Bloch and K. Kato, L-Functions and Tamagawa Numbers in The Grothendieck Festschrift I, Birkhäuser
(1990), 333-400.
[EGA IV] A. Grothendieck and J. Dieudonné, Éléments de Géometrie Algébrique IV, Publ. Math. IHES 32 (1967).
[Falt] G. Faltings, Crystalline Cohomology and p-adic Galois Representations, JAMI Conference, Johns Hopkins Univ. Press (1990), 25-79.
[Falt2] G. Faltings, Real Projective Structures on Riemann Surfaces, Compositio Mathematica 48, Fasc. 2
(1983), 223-269.
[Falt3] G. Faltings, Stable G-Bundles and Projective Connections, Journal of Algebraic Geometry 2, No. 3
(1993), 507-568.
[FK] H. Farkas and I. Kra, Riemann Surfaces, Graduate Texts in Mathematics 71, Springer, 1980.
[Gard] F. Gardiner, Teichmüller Theory and Quadratic Diﬀerentials, John Wiley and Sons, 1987.
[Gunning] R. C. Gunning, Special Coordinate Coverings of Riemann Surfaces, Math. Annalen 170 (1967), 67-86.
[Harts] R. Hartshorne, Residues and Duality, Lecture Notes in Mathematics 20, Springer, 1966.
[HM] J. Harris and D. Mumford, On the Kodaira Dimension of the Moduli Space of Curves, Inv. Math. 67
(1982), 23-86.
[Ih] Y. Ihara, Schwarzian Equations, Jour. Fac. Sci. Univ. Tokyo, Sect IA Math. 21 (1974), 97-118.
[Ih2] Y. Ihara, On the Diﬀerentials Associated to Congruence Relations and the Schwarzian Equations Deﬁning Uniformizations, Jour. Fac. Sci. Univ. Tokyo, Sect. IA Math. 21 (1974), 309-332.
[Ih3] Y. Ihara, On the Frobenius Correspondences of Algebraic Curves, in Algebraic Number Theory, papers
contributed for the International Symposium, Kyoto, 1976, Japan Soc. Prom. Sci., Tokyo, 1977.
[Ih4] Y. Ihara, Lifting Curves over Finite Fields Together with the Characteristic Correspondence Π + Π ,
Jour. of Algebra 75, No. 2 (1982), 452-483.
[Jac] N. Jacobson, Lie Algebras, Interscience Tracts 10, John Wiley and Sons, 1962.
[Kato] K. Kato, Logarithmic Structures of Fontaine-Illusie, Proceedings of the First JAMI Conference, JohnsHopkins University Press (1990), pp. 191-224.
[Kato2] K. Kato, Logarithmic Degeneration and Dieudonné Theory, preprint.
[Katz] N. Katz, Nilpotent Connections and the Monodromy Theorem: Applications of a Result of Turritin,
Publ. Math. IHES 39 (1970), 355-412.
[Katz2] N. Katz, Algebraic Solutions of Diﬀerential Equations, Inv. Math. 18 (1972), 1-118.
[KM] N. Katz and B. Mazur, Arithmetic Moduli of Elliptic Curves, Annals of Mathematics Studies 108,
Princeton University Press, 1985.
171

[Lang] S. Lang, Introduction to Modular Forms, Grundlehren der mathematischen Wissenschaften 222, Springer,
1976.
[Lehto] O. Lehto, Univalent Functions and Teichmüller Spaces, Graduate Texts in Mathematics 109, Springer,
1987.
[Lehto2] O. Lehto, Quasiconformal Homeomorphisms and Beltrami Equations, in Discrete Groups and Automorphic Functions, ed. W. J. Harvey, Academic Press (1977), 121-142.
[Marg] G. A. Margulis, Discrete Subgroups of Semisimple Lie Groups, Ergebnisse der Mathematik und ihrer
Grenzgebiete 17, Springer, 1990.
[McM] C. McMullen, Rational Maps and Kleinian Groups, Proc. International Congress of Mathematicians II,
Kyoto (1990), 889-899.
[Mess] W. Messing, The Crystals Associated to Barsotti-Tate Groups; with Applications to Abelian Schemes,
Lecture Notes in Mathematics 264, Springer, 1972.
[Mzk] S. Mochizuki, The Geometry of the Compactiﬁcation of the Hurwitz Scheme, Publ. of RIMS 31, No. 3
(1995), 355-441.
[Ogus] A. Ogus, F-Crystals, Griﬃths Transversality, and the Hodge Decomposition, Astérisque 221, Soc. Math.
de France, 1994.
[Royd] H. L. Royden, Intrinsic Metrics on Teichmüller Space, Proc. International Congress of Mathematicians
2, Vancouver (1974), 217-221.
[Schl] M. Schlessinger, Functors of Artin Rings, Trans. Amer. Math. Soc. 130 (1968), 208-222.
[Sesh] C. S. Seshadri, Fibrés vectoriels sur les courbes algébriques, Astérisque 96, Soc. Math. de France, 1982.
[SGA 1] A. Grothendieck et al., Revêtements étales et groupe fondamental, Lecture Notes in Mathematics 224,
Springer, 1971.
[Shi] G. Shimura, Introduction to the Arithmetic Theory of Automorphic Forms, Publ. Math. Soc. of Japan
11, Iwanami Shoten and Princeton University Press, 1971.
[Tate] J. Tate, p-divisible Groups, Proceedings of a Conference on Local Fields, NUFFIC Summer School held
at Driebergen in 1966, Springer, 1967.
[Wolp] S. Wolpert, The Fenchel-Nielsen Deformation, Ann. Math. 115 (1982), 501-528.
[ZT] P. G. Zograf and L. A. Takhtadzhyan, On Uniformization of Riemann Surfaces and the Weil-Petersson
Metric on Teichmüller and Schottky Spaces, Math. USSR Sbornik 60, No. 2 (1988), 297-313.

172

Index

Terminology

Note: The data following each term indicate the chapter and section where the term ﬁrst
appears.
admissible compactiﬁed Frobenius lifting
admissible Frobenius lifting
admissible indigenous bundle
associated Schwarz structure

IV.4
IV.4
II.2
I.1

Beltrami diﬀerential
Beltrami equation
Bers embedding
bianalytic constant
function
uniformizer
biformal function

Intro.1
Intro.1
Intro.1
I.1
I.1
I.1
I.1

canonical aﬃne parameter
canonical bilinear form
canonical class
canonical (crystalline) Galois representation
canonical curve
canonical Frobenius lifting (modular)
canonical Frobenius lifting (on a curve)
canonical Galois extension class
canonical height
canonical indigenous bundle
canonical lifting (point)
canonical local Hecke correspondence, nth
canonical local systems
canonical log p-divisible group
canonical multiplicative parameter

III.1
II.3,
III.3
III.3
IV.1,
V.2
III.3
III.2
IV.1,
V.2
III.1
I.2
Intro.2, V.2
III.1
IV.3
III.1, III.3
IV.2,
V.2
III.1, III.3

173

canonical p-divisible group
canonical pseudo-Hecke correspondence, nth
canonical representation (complex case)
canonical uniformization
compactiﬁcation of a Frobenius lifting
compactiﬁcation of the canonical Frobenius lifting
crystalline-induced Galois representation
crystalline induction
crystalline Schwarz structure
with nilpotent monodromy

III.1
IV.3
Intro.1, Intro.2
III.3
IV.4
V.2
V.1
V.0
I.1
I.1

diﬀerential local system
dilatation
divisor of marked points

III.1, III.3
Intro.1
I.1

elliptic Riemann surface

Intro.1

Fenchel-Nielsen coordinates
ﬁnite type (Riemann surface of)
F L-bundle
Frobenius conjugate curve
Frobenius lifting
Frobenius on R1 f∗ τX log /S log

Intro.1
Intro.1
II.1
V.2
III.1
II.2

generic uniformization number
global nth canonical Hecke correspondence
Green’s function (complex case)
Green’s function, p-adic

II.3
IV.3
Intro.1
IV.4,
V.2

Hasse invariant
Hecke operators
Hecke type
height of a Frobenius lifting
Hilbert transformation

II.2,
II.3
IV.3
IV.3
IV.4
Intro.1
174

Hodge section
hyperbolic metric
hyperbolic Riemann surface
hyperbolic volume

I.2
Intro.1
Intro.1
Intro.1

Igusa curve
indigenous bundle
of restrictable type
indigenous section
induced MF ∇ -object
inﬁnitesimal Verschiebung
intrinsic bundle

II.3
Intro.2,
I.2
III.2
V.1
II.2
I.2

Jacobson’s formula

II.2

Kähler metrics and Frobenius liftings
Kodaira-Spencer morphism

Intro.2
I.1,
I.2

local compactiﬁcation of a Frobenius lifting
local height of a Frobenius lifting
locally intrinsic bundle
locally stable of dimension one
log admissible covering
log p-divisible group

IV.4
IV.4
I.2
I.1
III.2
IV.2

marked
MF ∇ -object

I.1
II.2

naive compactiﬁcation of a Frobenius lifting
nilpotent indigenous bundle
normalized P1 -bundle with connection

IV.4
II.2
I.1

175

I.2

ordinary curve, hyperbolically
parabolically
ordinary Frobenius lifting
ordinary indigenous bundle
ordinary locus

II.3
II.3
III.1
II.3
IV.1

p-curvature
parabolic Riemann surface
parabolic structure
parabolic volume element
partition curves
pre-Schwarz structure
pseudo-uniformizer

II.1
Intro.1
I.1
Intro.1
Intro.1
I.1
I.1

quasiconformal equivalence class, p-adic
quasiconformal function
quasidisk

III.3
Intro.1
Intro.1

real Riemann surface
renormalized Frobenius pull-back
ring of additive periods

Intro.1
III.2
III.1

scheme of multiplicative periods
Schwarz structure
Schwarzian derivative
Serre-Tate parameter
singular
small aﬃne
small parameters
smooth and unmarked
stable curve
stack of multiplicative periods
supersingular divisor

V.2
I.1
I.1
IV.1
I.1
V.1
V.1
I.1
I.2
V.2
II.2

176

tangential local system
Teichmüller metric
Teichmüller uniformization
topological marking, p-adic
totally degenerate curve
trianalytic constant
function
triformal function

III.1, III.3
Intro.1
Intro.1
III.3
I.3
I.1
I.1
I.1

uniformizing Galois representation
uniformizing MF ∇ -object

III.1
III.1

Verschiebung of an indigenous bundle
log ⊗2
) (−D)
on f∗ (ωX/S
morphism

II.2
II.2
II.2

Weil-Petersson inner product
Weil-Petersson metric
Wolpert’s coordinates of degeneration

Intro.1
Intro.1
Intro.1

Major Notation

AΦ
B
Bμ
B + (−)
C

III.1
Intro.1, II.3
III.3
V.1
I.2, IV.4

(D, ∇D )
Δ
DE
(DE , RE )

III.2
V.1
II.2
V.2
177

dS
DS ; IS
DSGal
(Dy , Ry )
D0 (a, b)
(ED , ∇ED )
EE
Gal
EX
(EN , ∇EN )
ηΦ
E0
F∗

I.1
V.1
V.1
IV.3
IV.2
V.1
II.2
V.1
III.2
III.1
V.1
II.2, III.2

Gg,r ; GΔ
Glog
GL±
G[∞]
HE
HYlog
ht(Φ); htx (Φ)
Hx
ι(a,b);0

II.3
IV.2
I.1
V.2
II.2
IV.3
IV.4
IV.3
IV.2

J
κ
κA
κβ
LS ; L×
S

I.1
V.1
III.1
III.1, III.3
I.1

Mg,r

I.2,

ord
Mg,r

μ = (Δ, )
N g,r
ord

N g,r
Ωet
g,r
Ωet
N
Ωet
Φ
Ωlog
S

III.2

II.3
III.3
II.2
II.3, III.2
II.3
III.3
III.1
V.1
178

×
ωU
log /S log

I.1

OU#

I.1

P
(P, F · (P), ∇P , PΦ )
PE
Pet
ΦE
Φlog
N
Φlog
X
Φω
E
ΦτE
Π1 ; Π∞

P log
Ψ
Ψαβ
Ψx
Q
Qg,r
qω,α
qω,z
qθ
ρ
ρ∞

II.1
III.1
II.2
III.1
IV.1, V.1
III.2
IV.1, V.2
II.2
II.2
V.1
III.3
V.2
V.2
III.1
IV.3
Intro.1
II.2
III.3
II.1
IV.1
IV.1
V.2

S; S ×
S g,r

I.1
I.3

adm

S g,r
T
T 1/2
ΘE
Θet
g,r
Θet
N
Θet
Φ
ΘF∗
ΘV
E
U bi
U bi
U can

II.2
II.1, IV.1
IV.1
II.2
II.3
III.3
III.1
III.2
II.2
I.1
I.1
III.1, III.3
179

U tr
U tr

I.1
I.1

VE
V g,r
Vμ,β
X(a, b)ord
X ord ; (X log )ord
X0 (n)

II.2
II.2
III.3
IV.3
IV.1
IV.2

180

