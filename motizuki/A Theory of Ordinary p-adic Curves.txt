A THEORY OF ORDINARY P-ADIC CURVES

A Theory of Ordinary p-adic Curves
By

Shinichi MOCHIZUKI*

Table of Contents

Table of Contents

Introduction
Â§0. Statement of Main Results
Â§1. Review of the Complex Theory
Beltrami Diï¬€erentials
The Beltrami Equation
The Series Expansion of a Quasiconformal Function
Uniformization of Hyperbolic Riemann Surfaces
Uniformization of Moduli Stacks of Hyperbolic Riemann Surfaces
Quasidisks and the Bers Embedding
The Inï¬nitesimal Form of the Modular Uniformizations
Coordinates of Degeneration
The Parabolic Case
Real Curves
Â§2. Translation into the p-adic Case
Gunningâ€™s Theory of Indigenous Bundles
The Canonical Coordinates Associated to a KaÌˆhler Metric
The Weil-Petersson Metric from the Point of View of Indigenous Bundles
The Philosophy of KaÌˆhler Metrics as Frobenius Liftings
The Dictionary
Loose Ends
Received September 8, 1995. Revised October 2, 1996.
1991 Mathematics Subject Classiï¬cation: 14H10, 14F30

* Research Institute for Mathematical Sciences, Kyoto University, Kyoto 606, Japan
1

Chapter I: Crystalline Projective Structures
Â§0. Introduction
Â§1. Schwarz Structures
Notation and Basic Deï¬nitions
First Properties of Schwarz Structures
Crystalline Schwarz Structures and Monodromy
Correspondence with P1 -bundles
Schwarz Structures and Square Diï¬€erentials
Normalized P1 -bundles with Connection
The Schwarzian Derivative
Â§2. Indigenous Bundles
Basic Deï¬nitions and Examples
First Properties
Existence and de Rham Cohomology
Indigenous Bundles of Restrictable Type
Â§3. The Obstruction to Global Intrinsicity
Introduction of Cohomology Classes
Computation of the Second Chern Class
The Case of Dimension One
Appendix: Relation to the Complex Analytic Case

Chapter II: Indigenous Bundles in Characteristic p
Â§0. Introduction
Â§1. FL-Bundles
Deformations and FL-Bundles
The p-Curvature of an FL-Bundle
Â§2. The Verschiebung on Indigenous Bundles
The Deï¬nition of The Verschiebung
The p-Curvature of an Admissible Indigenous Bundle
The Inï¬nitesimal Verschiebung
Diï¬€erential Criterion for Admissibility
2

Â§3. Hyperbolically Ordinary Curves
Basic Deï¬nitions
The Totally Degenerate Case
The Case of Elliptic Curves: The Parabolic Picture
The Case of Elliptic Curves: The Hyperbolic Picture
The Generic Uniformization Number

Chapter III: Canonical Modular Frobenius Liftings
Â§0. Introduction
Â§1. Generalities on Ordinary Frobenius Liftings
Basic Deï¬nitions
The Uniformizing Galois Representation
The Canonical p-divisible Group
Logarithms of Periods
Compatibility of Diï¬€erentials
Canonical Liftings of Points in Characteristic p
Canonical Multiplicative Parameters
Canonical Aï¬ƒne Coordinates
The Relationship Between Aï¬ƒne and Multiplicative Parameters
Â§2. Construction of the Canonical Frobenius Lifting
Modular Frobenius Liftings
Indigenous Sections of D
Frobenius Invariant Indigenous Bundles
Â§3. Applications of the Canonical Frobenius Liftings
Canonical Liftings of Curves over Witt Vectors
Canonical Aï¬ƒne Coordinates on Mg,r
Topological Markings and Uniformization by Quadratic Diï¬€erentials
Canonical Multiplicative Parameters
The Case of Elliptic Curves

Chapter IV: Canonical Curves
Â§0. Introduction
3

Â§1. The Canonical Galois Representation
Construction and Global Properties
The Horizontal Section over the Ordinary Locus
The Canonical Frobenius Lifting over the Ordinary Locus
Â§2. The Canonical Log p-divisible Group
Log p-divisible Groups at Inï¬nity
Construction of the Canonical Log p-divisible Group
Review of the Theory of [Katz-Mazur]
Â§3. The Compactiï¬ed Canonical Frobenius Lifting
The Canonical Frobenius Lifting and the Canonical Log p-divisible Group
Local Analysis at Supersingular Points
Global Hecke Correspondences
Â§4. p-adic Greenâ€™s Functions
Compactiï¬ed Frobenius Liftings
The Height of a Frobenius Lifting
Admissible Frobenius Liftings
Geometric Criterion for Canonicality

Chapter V: Uniformizations of Ordinary Curves
Â§0. Introduction
Â§1. Crystalline Induction
The Crystalline-Induced MF âˆ‡ -object
The Ring of Additive Periods
The Crystalline-Induced Galois Representation
Relation to the Canonical Aï¬ƒne Coordinates
The Parabolic Case
Â§2. Canonical Objects over the Stack of Multiplicative Periods
The Stack of Multiplicative Periods
The Canonical Log p-divisible Group
The Canonical Frobenius Lifting

Bibliography
Index
4

Introduction
Â§0. Statement of Main Results
The goal of this paper is to present a theory of r-pointed stable curves of genus g over
p-adic schemes (for p odd), which, on the one hand, generalizes the Serre-Tate theory of
ordinary elliptic curves to the hyperbolic case (i.e., 2g âˆ’ 2 + r â‰¥ 1), and, on the other hand,
generalizes the complex uniformization theory of hyperbolic Riemann surfaces (reviewed in
Â§1 of this introductory Chapter) due to Ahlfors, Bers, et al. to the p-adic case. We begin by
setting up the necessary algebraic machinery: that is, the language of indigenous bundles
(due to Gunning, although we rephrase Gunningâ€™s results in a more algebraic form). An
indigenous bundle is a P1 -bundle over a curve, together with a connection, that satisfy
certain properties. One may think of an indigenous bundle as an algebraic way of encoding
uniformization data for a curve. We then study the p-curvature of indigenous bundles in
characteristic p, and show that a generic r-pointed stable curve of genus g has a ï¬nite,
nonzero number of distinguished indigenous bundles (P, âˆ‡P ), which are characterized by
the following two properties:
(1) the p-curvature of (P, âˆ‡P ) is nilpotent;
(2) the space of indigenous bundles with nilpotent p-curvature is eÌtale over
the moduli stack of curves at (P, âˆ‡P ).
We call such (P, âˆ‡P ) nilpotent and ordinary, and we call curves ordinary if they admit at
least one such nilpotent, ordinary indigenous bundle. If a curve is ordinary, then choosing any one of the ï¬nite number of nilpotent, ordinary indigenous bundles on the curve
completely determines the â€œuniformization theory of the curveâ€ â€“ to be described in the
following paragraphs. Because of this, we refer to this choice as the choice of a p-adic
quasiconformal equivalence class to which the curve belongs.
After studying various basic properties of ordinary curves and ordinary indigenous
bundles in characteristic p, we then consider the p-adic theory. Let Mg,r be the moduli
stack of r-pointed stable curves of genus g over Zp . Then we show that there exists a
ord

canonical p-adic (nonempty) formal stack N g,r together with an eÌtale morphism
ord

N g,r â†’ Mg,r
ord

such that modulo p, N g,r is the moduli stack of ordinary r-pointed curves of genus g,
together with a choice of p-adic quasiconformal equivalence class. Moreover, the generic
ord
degree of N g,r over Mg,r is > 1 (as long as 2g âˆ’ 2 + r â‰¥ 1 and p is suï¬ƒciently large). It is
ord

over N g,r that most of our theory will take place. Our ï¬rst main result is the following:
5

ord

Theorem 0.1. Let C log â†’ (N g,r )log (where the â€œlogâ€ refers to canonical log stack structures) be the tautological ordinary r-pointed stable curve of genus g. Then there exists a
ord log
, together with a canonical indigenous buncanonical Frobenius lifting Î¦log
N on (N g,r )
log
log
dle (P, âˆ‡P ) on C . Moreover, Î¦N and (P, âˆ‡P ) are uniquely characterized by the fact
(P, âˆ‡P ) is â€œFrobenius invariantâ€ (in some suitable sense) with respect to Î¦log
N .
Moreover, there is an open p-adic formal substack C ord âŠ† C of â€œordinary pointsâ€ of
ord
the curve. The open formal substack C ord âŠ† C is dense in every ï¬ber of C over N g,r . Also,
there is a unique canonical Frobenius lifting
log ord
) â†’ (C log )ord
Î¦log
C : (C

which is Î¦log
N -linear and compatible with the Hodge section of the canonical indigenous
log
bundle (P, âˆ‡P ). Finally, Î¦log
C and Î¦N have various functoriality properties, such as functoriality with respect to â€œlog admissible coverings of C log â€ and with respect to restriction to
the boundary of Mg,r .
This Theorem is an amalgamation of Theorem 2.8 of Chapter III and Theorem 2.6 of
Chapter V. In some sense all other results in this paper are formal consequences of the
above Theorem. For instance,
Corollary 0.2. The Frobenius lifting Î¦log
N allows one to deï¬ne canonical aï¬ƒne local
coordinates on Mg,r at an ordinary point Î± valued in k, a perfect ï¬eld of characteristic
p. These coordinates are well-deï¬ned as soon as one chooses a quasiconformal equivalence
class to which Î± belongs. Also, at a point Î± âˆˆ Mg,r (k) corresponding to a totally degenerate
curve, Î¦log
N deï¬nes canonical multiplicative local coordinates.
This Corollary follows from Chapter III, Theorem 3.8 and Deï¬nition 3.13.
ord

Let Î± âˆˆ N g,r (A), where A = W (k), the ring of Witt vectors with coeï¬ƒcients in a
ord

perfect ï¬eld of characteristic p. If Î± corresponds to a morphism Spec(A) â†’ N g,r which
is Frobenius equivariant (with respect to the natural Frobenius on A and the Frobenius
ord
lifting Î¦log
N on N g,r ), then we call the curve corresponding to Î± canonical. Let K be the
quotient ï¬eld of A. Let GLÂ±
2 (âˆ’) be the group scheme which is the quotient of GL2 (âˆ’) by
{Â±1}.
ord

Theorem 0.3. Once one ï¬xes a k-valued point Î±0 of N g,r , there is a unique canonical
ord

Î± âˆˆ N g,r (A) that lifts Î±0 . Moreover, if a curve X log â†’ Spec(A) is canonical, it admits
(1) A canonical dual crystalline (in the sense of [Falt], Â§2) Galois representation Ï : Ï€1 (XK ) â†’ GLÂ±
2 (Zp ) (which satisï¬es certain properties);
6

(2) A canonical log p-divisible group Glog (up to {Â±1}) on X log whose Tate
module deï¬nes the representation Ï;
log ord
(3) A canonical Frobenius lifting Î¦log
)
â†’ (X log )ord over the
X : (X
ordinary locus (which satisï¬es certain properties).

Moreover, if a lifting X log â†’ Spec(A) of Î±0 has any one of these objects (1) through (3)
(satisfying various properties), then it is canonical.
This Theorem results from Chapter III, Theorem 3.2, Corollary 3.4; Chapter IV, Theorem
1.1, Theorem 1.6, Deï¬nition 2.2, Proposition 2.3, Theorem 4.17.
The case of curves with ordinary reduction modulo p which are not canonical is more
ord
complicated. Let us consider the universal case. Thus, let S log = (N g,r )log ; let f log :
X log â†’ S log be the universal r-pointed stable curve of genus g. Let T log â†’ S log be
the ï¬nite covering (log eÌtale in characteristic zero) which is the Frobenius lifting Î¦log
N of
log
log
log
Theorem 0.1. Let P
â†’ S
be the inverse limit of the coverings of S
which are
log
log
log
log
log
log
iterates of the Frobenius lifting Î¦log
.
Let
X
=
X
Ã—
T
;
X
=
X
Ã—
.
log
S
S log P
N
T
P
We would like to consider the arithmetic fundamental groups
def

def

Î 1 = Ï€1 ((XTlog )Qp );

Î âˆ = Ï€1 ((XPlog )Qp )

Unlike the case of canonical curves, we do not get a canonical Galois representation of Î 1
into GLÂ±
2 (Zp ). Instead, we have the following
Theorem 0.4. There is a canonical Galois representation
Ïâˆ : Î âˆ â†’ GLÂ±
2 (Zp )
Moreover, the obstruction to extending Ïâˆ to Î 1 is nontrivial and is measured precisely by
the extent to which the canonical aï¬ƒne coordinates (of Corollary 0.2) are nonzero. Also,
log
there is a ring DSGal with a continuous action of Ï€1 (TQ
) such that we have a canonical
p
dual crystalline representation
Gal
Ï1 : Î 1 â†’ GLÂ±
2 (DS )

(i.e., this is a twisted homomorphism, with respect to the action of Î 1 (acting through
log
)) on DSGal ). Finally, the ring DSGal has an augmentation DSGal â†’ Zp which is
Ï€1 (TQ
p
Î âˆ -equivariant (for the trivial action on Zp ) and which is such that after restricting to
Î âˆ , and base changing by means of this augmentation, Ï1 reduces to Ïâˆ .
7

This follows from Chapter V, Theorems 1.4 and 1.7.
All along, we note that when one specializes the theory to the case of elliptic curves,
one recovers the familiar classical theory of Serre-Tate. For instance, the deï¬nitions of
â€œordinary curvesâ€ and â€œcanonical liftingsâ€ specialize to the objects with the same names
in Serre-Tate theory. The p-adic canonical coordinates on the moduli stack Mg,r (Corollary
0.2) specialize to the Serre-Tate parameter. The Galois obstruction to extending Ïâˆ to
a representation of Î 1 specializes to the obstruction to splitting the well-known exact
sequence of Galois modules that the p-adic Tate module of an ordinary elliptic curve ï¬ts
into.
For more detailed accounts of the results in each Chapter, we refer to the introductory
sections at the beginnings of each of the Chapters. In the rest of this introductory Chapter,
we explain the relationship between the p-adic case and the classically known complex case.
Acknowledgements: I would like to thank Prof. Barry Mazur of Harvard University for
providing the stimulating environment (during the Spring of 1994) in which this paper
was written. Also, I would like to thank both Prof. Mazur and Prof. Yasutaka Ihara
(of RIMS, Kyoto University) for their eï¬€orts in assisting me to publish this paper, and
for permitting me to hold lecture series at Harvard (Spring of 1994) and RIMS (Fall of
1994), respectively, during which I discussed the contents of this paper. Finally, I would
like to thank Prof. Ihara for informing me of the theory of [Ih], [Ih2], [Ih3], and [Ih4].
This theory anticipates many aspects of the theory of the present paper (especially, the
discussion of Frobenius liftings and pseudo-correspondences in Chapters III and IV). On
the other hand, the techniques and point of view of Prof. Iharaâ€™s theory diï¬€er substantially
from those of the present paper. Moreover, from a rigorous, mathematical point of view,
the main results of Prof. Iharaâ€™s theory neither imply nor are implied by the main results
of the present paper. However, it is the authorâ€™s subjective opinion that philosophically,
the motivation behind Prof. Iharaâ€™s theory was much the same as that of the authorâ€™s.
Â§1. Review of the Complex Theory
In order to explain the meaning of the main results of this paper, it is ï¬rst necessary
to review the complex theory of uniformization in a fashion that makes the generalization
to ï¬nite primes more natural. This is the goal of the present Section. Since all of the
material is â€œstandardâ€ and â€œwell-known,â€ we shall, of course, omit proofs, instead citing
references for major results. We shall say that a Riemann surface X is of ï¬nite type
if it can be obtained by removing a ï¬nite number of points p1 , . . . , pr from a compact
Riemann surface Y of genus g. Note that in this case, Y and {p1 , . . . , pr } are uniquely
determined up to isomorphism. We shall say that the Riemann surface of ï¬nite type X is
hyperbolic (respectively, parabolic; elliptic) if 2g âˆ’ 2 + r â‰¥ 1 (respectively, 2g âˆ’ 2 + r = 0;
2g âˆ’ 2 + r < 0). In this paper, we shall be concerned exclusively with Riemann surfaces
of ï¬nite type (and their uniformizations). This is because it is precisely these Riemann
surfaces which correspond to algebraic objects. Also, we shall mainly be concerned with
8

the hyperbolic case, since this is the most diï¬ƒcult. Indeed, from the point of view of
the theory of uniformization and moduli, the elliptic case is completely trivial, and the
parabolic case (although nontrivial) is relatively easy and explicit.
In some sense, the theme of our review of the classical complex theory is that in most
cases, there are two ways to approach results: the â€œclassicalâ€ and the â€œquasiconformal.â€
Typically, the classical approach was known earlier, and is more geometric and intuitive.
On the other hand, the classical approach has the drawback of producing theories and
results that are only real analytic, rather than holomorphic in nature. By contrast the
quasiconformal approach, which was pioneered by Ahlfors and Bers, tends to give rise to
holomorphic structures and results naturally. It is thus natural that the connection between
the â€œquasiconformal approachâ€ and the p-adic theory should be much more natural and
transparent.
Beltrami Diï¬€erentials
Let X be a Riemann surface (not necessarily of ï¬nite type). Let us consider the
complex line bundle Ï„X âŠ— Ï‰ X on X, where Ï‰ X is the complex conjugate bundle to the
canonical bundle Ï‰X , and Ï„X is the tangent bundle. Note that if s is a section of Ï„X âŠ— Ï‰ X
over X, then we can consider its Lâˆ -norm sâˆ , since the transition functions of Ï„X âŠ— Ï‰ X
have complex absolute value 1. A Beltrami diï¬€erential Î¼ on X is a measurable section of
the line bundle
Ï„X âŠ— Ï‰ X
such that Î¼âˆ < 1.
Why the bundle Ï„X âŠ— Ï‰ X ? The reason is that this bundle is closely connected with
the moduli of the Riemann surface X. Indeed, Let us consider an arbitrary C âˆ section Î¼
of Ï„X âŠ— Ï‰ X . Now since Ï„X has the structure of a holomorphic line bundle, we have a âˆ‚
operator on Ï„X . If we look at global C âˆ sections, this gives us a complex
âˆ‚

C âˆ (X, Ï„X ) âˆ’â†’

C âˆ (X, Ï„X âŠ— Ï‰ X )

which computes the analytic cohomology of Ï„X . If X is, for instance, compact, then this
analytic cohomology coincides with the cohomology in the Zariski topology of the algebraic
tangent bundle. Thus, for X compact and hyperbolic, the above complex has cohomology
groups H 0 = 0, and H 1 = H 1 (X, Ï„X ), which is well-known to be the space of inï¬nitesimal
deformations of X. Moreover, if X is compact of genus g â‰¥ 2, and Mg is the moduli stack
of curves of genus g, then H 1 (X, Ï„X ) is precisely the tangent space to Mg at the point
deï¬ned by X.
At any rate, (for X arbitrary) we have a natural surjection
9

C âˆ (X, Ï„X âŠ— Ï‰ X ) â†’ H 1 (X, Ï„X )
Thus, the image of Î¼ under this surjection deï¬nes an inï¬nitesimal deformation of the
complex structure of X. This establishes the relationship between sections of
Ï„X âŠ— Ï‰ X
and the moduli of X. The reason for considering measurable, rather than just C âˆ , sections is that it is easier to obtain solutions to a certain diï¬€erential equation, the Beltrami
equation, when one works in this greater generality.
The Beltrami Equation
Having established the relationship between sections of Ï„X âŠ— Ï‰ X and inï¬nitesimal
deformations, we now would like to integrate â€“ i.e., to â€œgive a reciprocity lawâ€ â€“ that
assigns to a section Î¼ of Ï„X âŠ— Ï‰ X not just an inï¬nitesimal deformation of X, but an actual
new Riemann surface, i.e., a new complex structure on the topological manifold underlying
X. To do this, we consider the Beltrami equation
âˆ‚f = Î¼ Â· âˆ‚f
which we regard as a diï¬€erential equation in the unknown function f . It is a nontrivial
result (proven, for instance, in [Lehto2]) that when Î¼ is a Beltrami diï¬€erential, there
exist local L2 solutions f to the Beltrami equation that are homeomorphisms (where they
are deï¬ned). Such functions f are called quasiconformal (with dilatation Î¼). If f and
g (deï¬ned on some open set U âŠ† X) are both quasiconformal with the same dilatation
Î¼, then it is easy to see that âˆ‚ applied to f â—¦ g âˆ’1 (in the distributional sense) is zero.
That is, f = h â—¦ g for some biholomorphic function h. Thus, up to composition with a
biholomorphic function, quasiconformal solutions to the Beltrami equation are unique.
With these observations, we can deï¬ne a new complex structure on X associated to
a Beltrami diï¬€erential Î¼ as follows. Let us call the resulting Riemann surface XÎ¼ . Thus,
the underlying topological manifold of XÎ¼ is the same as that of X. On an open set
U âŠ† X, we take a local quasiconformal function f of dilatation Î¼, and deï¬ne it to be
a holomorphic function on XÎ¼ . By the essential uniqueness of solutions to the Beltrami
equation, everything is well-deï¬ned, and so we obtain a new global Riemann surface XÎ¼ .
Thus, the assignment
Î¼ â†’ XÎ¼
is the fundamental â€œreciprocity lawâ€ that we are looking for.

10

The Series Expansion of a Quasiconformal Function
In order to really understand the Beltrami equation, it is useful to look at the explicit
representation of its solutions as series â€œin Î¼â€ (as in [Lehto], pp. 25-27). We begin by
considering Cauchyâ€™s integral formula:
1
f (z) =
2Ï€i



1
f (Î¶) dÎ¶
âˆ’
Î¶ âˆ’z
Ï€
âˆ‚D

 

âˆ‚f (Î¶) dÎ¾dÎ·
Î¶ âˆ’z
D

for a function f with L1 derivatives on an open disk D in the complex plane. Thus, if f
(and its L1 derivatives) are deï¬ned on all of C, and f (z) â†’ 0 as z â†’ âˆ, then we obtain
f (z) = T âˆ‚f
where T is the operator on C âˆ functions Ï‰ with compact support given by
1
(T Ï‰)(z) = âˆ’
Ï€

 

Ï‰(Î¶) dÎ¾dÎ·
Î¶ âˆ’z
C

Put another way, (from the point of view of the theory of pseudodiï¬€erential operators) T
is the parametrix for the elliptic diï¬€erential operator âˆ‚. If we deï¬ne the Hilbert transformation H by
 

Ï‰(Î¶) dÎ¾dÎ·
(Î¶ âˆ’ z)2
C

1
(H Ï‰)(z) = âˆ’
Ï€

then we obtain that âˆ‚T = H. Also, it can be shown that âˆ‚ and âˆ‚ commute with both T
and H.
Now let us suppose that Î¼ is a Beltrami diï¬€erential on C (say, with compact support),
and that f is quasiconformal on C with dilatation Î¼. Then f is holomorphic at inï¬nity,
and so, after normalization, in a neighborhood of inï¬nity, it looks like
f (z) = z +



bn z âˆ’n

nâ‰¥1

for some bn âˆˆ C. Thus, f (z) âˆ’ z goes to 0 as z â†’ âˆ, so we obtain that
âˆ‚f (z) = 1 + âˆ‚{f (z) âˆ’ z}
= 1 + âˆ‚T âˆ‚{f (z) âˆ’ z}
= 1 + Hâˆ‚f (z)
11

Thus, since âˆ‚f = Î¼ Â· âˆ‚f , it follows that
âˆ‚f = Î¼ + Î¼ Â· Hâˆ‚f
This integral equation has the formal solution
âˆ‚f =



(Î¼ Â· H)i Î¼

iâ‰¥0

which converges in L2 because
(1) it can be shown that H extends to an isometry L2 â†’ L2 ;
(2) since Î¼ is a Beltrami diï¬€erential, Î¼âˆ < 1 (which thus explains this
part of the deï¬nition of a Beltrami diï¬€erential).
Thus, applying the operator T , we get the series solution
f (z) = z + T {



(Î¼ Â· H)i Î¼}

iâ‰¥0

to the Beltrami equation.
From our point of view, this series solution has two important consequences. First of
all, the set of all possible Î¼ clearly form an open subset of a (rather large) complex vector
space (i.e., the space of measurable sections of Ï„X âŠ— Ï‰ X ). Thus, relative to the complex
structure of this complex vector space, the series solution makes it clear that f depends
holomorphically on Î¼. Second, it computes the inï¬nitesimal change in f as Î¼ varies to ï¬rst
def
order. Namely, this term is given by Ï† = T (Î¼). Note that
âˆ‚Ï† = Î¼
It turns out that this result â€“ that âˆ‚ applied to the inï¬nitesimal change Ï† in the solution to
the Beltrami equation gives us back Î¼ â€“ holds for arbitrary Beltrami diï¬€erentials Î¼. (See,
e.g., [Gard], p. 72).
The reason why this observation is interesting is as follows. Suppose, for simplicity,
that Î¼ is C âˆ . Let U be an open covering of X such that the intersection of any ï¬nite
collection of open sets in U is Stein. Then by considering the standard isomorphism
between the CÌŒech cohomology (with respect to U ) and the âˆ‚-cohomology of Ï„X , it thus
follows that the inï¬nitesimal deformation XÂ·Î¼ (where is â€œsmallâ€) in the complex structure
of X given by solving the Beltrami equation is precisely the same as the inï¬nitesimal
deformation given by mapping Î¼ to H 1 (X, Ï„X ) via the surjection
12

C âˆ (X, Ï„X âŠ— Ï‰ X ) â†’ H 1 (X, Ï„X )
considered previously. This completes the justiï¬cation of the claim that the assignment
Î¼ â†’ XÎ¼ is an â€œintegrated versionâ€ of the â€œinï¬nitesimal reciprocity lawâ€
C âˆ (X, Ï„X âŠ— Ï‰ X ) â†’ H 1 (X, Ï„X )
that follows just from the deï¬nition of the âˆ‚-cohomology of Ï„X .
Uniformization of Hyperbolic Riemann Surfaces
 be its universal covering space. Thus,
Let X be a hyperbolic Riemann surface. Let X

X inherits a natural complex structure from X. Then one of the most basic results in the
ï¬eld is that we have an isomorphism of Riemann surfaces
âˆ¼
X
=H
where H is the upper half plane. By considering the covering transformations of H â†’ X,
we get a homomorphism (well-deï¬ned up to conjugation)
Ï : Ï€1 (X) â†’ Aut(H) âŠ† PSL2 (R)
which we call the canonical representation of X.
There are (at least) two ways to prove this result. The ï¬rst approach is the classical
approach, and goes back to Koebeâ€™s work in the early twentieth century. It involves
 There is an intrinsic, a priori deï¬nition of
considering Greenâ€™s functions G(âˆ’, âˆ’) on X.
Greenâ€™s functions, which is not important for us here. A posteriori, that is, once one knows
âˆ¼
that X
= H, we can pull-back the hyperbolic metric
dx2 + dy 2
y2
 so that we obtain a hyperbolic distance function on X.
 Then G(x, y) (for
on H to X,
 is given by the logarithm of the hyperbolic distance between x and y. One can
x, y âˆˆ X)
ï¬nd a detailed exposition of this approach in [FK].
The second approach (which is more relevant to the p-adic case) is the approach of
Bers ([Bers]). Suppose that X is obtained by removing r points from a compact Riemann
surface Y of genus g. Then one ï¬rst observes that there exists a Riemann surface X 
which is obtained by removing r points from a compact Riemann surface of genus g and
  is isomorphic to H. Then one constructs (from purely
whose universal covering space X
13

elementary considerations) a quasiconformal homeomorphism X  âˆ¼
= X. This quasiconformal homeomorphism deï¬nes a Beltrami diï¬€erential Î¼ on X  , which we can pull back to
 âˆ¼
X
= H to obtain a Beltrami diï¬€erential Î¼H on H. By reï¬‚ection, one extends Î¼H to a
Beltrami diï¬€erential Î¼
 on C. Then we solve the Beltrami equation for Î¼
 on C so that we
obtain a quasiconformal homeomorphism
f
:Câ†’C
Î¼
which goes to inï¬nity at inï¬nity. Let Î“ be the group of MoÌˆbius transformation of H
  over X  . Thus, H/Î“ âˆ¼
deï¬ned by the covering transformations of X
= X  . Then it follows
from the uniqueness of solutions to the Beltrami equation that
Î“ = f
â—¦ Î“ â—¦ f âˆ’1
Î¼

Î¼
def

forms a group of MoÌˆbius transformations on C. Moreover, from the reï¬‚ection symmetry
of Î¼
, it follows that f
preserves the real axis, and hence so does Î“. It thus follows that
Î¼
H/Î“ is a Riemann surface of ï¬nite type, and, by the deï¬nition of Î¼, that H/Î“ âˆ¼
= X. This
completes the proof.
It turns out that it is this approach of uniformizing a single Riemann surface (for each
g, r) and then â€œparallel transportingâ€ the result over the rest of the moduli space that will
carry over to the p-adic case.
Uniformization of Moduli Stacks of Hyperbolic Riemann Surfaces
Let Mg,r be the moduli stack of r-pointed smooth algebraic curves of genus g over C.

Let Mg,r be its universal covering space. Then the problem of uniformization of moduli is
g,r . From the point of view of the Beltrami equation,
to give an explicit representation of M
this amounts to ï¬nding a small, ï¬nite-dimensional subspace T of the space of Beltrami
diï¬€erentials Î¼ such that the assignment Î¼ â†’ XÎ¼ deï¬nes a covering space map T â†’ Mg,r .
We begin by ï¬xing a â€œbase pointâ€ of Mg,r , which corresponds to a hyperbolic Riemann
surface X. Let M(X) be the space of Beltrami diï¬€erentials on X. Let Q be the space
of holomorphic quadratic diï¬€erentials on X with at most simple poles at the punctured
points. Then there are two approaches to deï¬ning morphisms from open subsets of Q
into spaces of Beltrami diï¬€erentials. The ï¬rst approach is that of TeichmuÌˆller. In this
approach, if Ï† âˆˆ Q, we deï¬ne a norm
def



Ï† =

|Ï†|
X

Let V âŠ† Q be the set of Ï† with Ï† â‰¤ 1. Then TeichmuÌˆllerâ€™s uniformization map, for
(nonzero) Ï† âˆˆ V , is given by
14

def

Ï† â†’ Î¼Ï† = (Ï†)

Ï†
|Ï†|

where Ï† âˆˆ Î“(X, Ï‰ âŠ—2
X ) is the complex conjugate of Ï†. It is easy to see that Î¼Ï† deï¬nes a
Beltrami diï¬€erential on X. Thus, we get a morphism V â†’ M(X). If we compose Ï† â†’ Î¼Ï†
with Î¼ â†’ XÎ¼ , we get a morphism
V â†’ Mg,r
The main result of TeichmuÌˆller theory (see, e.g., [Gard], Chapter 6) is that this morphism
g,r . One advantage of this approach is that it admits
induces an isomorphism of V onto M
a very satisfying geometric interpretation in terms of a foliation on X induced by Ï† and
deforming X into XÎ¼Ï† by deforming a canonical coordinate arising from the foliation. The
main disadvantage of this approach from our point of view, however, is that the morphism
Ï† â†’ Î¼Ï† is neither holomorphic nor anti-holomorphic. Thus, it seems hopeless to try to
ï¬nd an algebraic version of TeichmuÌˆllerâ€™s map.
On the other hand, Bersâ€™ approach is as follows. Since we now know that X can
be uniformized by the upper half plane, let vX be the hyperbolic volume element on X
induced by the hyperbolic volume element
vH =

dx âˆ§ dy
y2

on the upper half plane. Let X c be the conjugate Riemann surface to X. That is, the
underlying topological manifold of X c is the same as that of X, but the holomorphic
functions on X c are exactly the anti-holomorphic functions on X. Suppose that Ï† âˆˆ Q.
Then by conjugating the â€œinput variable,â€ we obtain that Ï† deï¬nes a section Ï†c of Ï‰ âŠ—2
Xc .
Now deï¬ne
def âˆ’2Ï†

Î¼Ï† =

c

vX c

Then for some appropriate (see [Gard], pp. 100-104) open set V âŠ† Q, this Î¼Ï† deï¬nes
a Beltrami diï¬€erential on X c . Integrating, we get a Riemann surface XÎ¼c . Then the
assignment Ï† â†’ XÎ¼c deï¬nes a morphism
V â†’ Mcg,r
where the superscript â€œcâ€ denotes the conjugate complex manifold. This morphism induces
cg,r ([Gard], p. 101). The important thing here is that the
an isomorphism of V onto M
correspondence Ï† â†’ Î¼Ï† is holomorphic. Since Î¼ â†’ XÎ¼c is always holomorphic, it thus
15

c is biholomorphic. Put another way, we have a
follows that the isomorphism V âˆ¼
= M
g,r
holomorphic embedding
g,r â†’ Qc
B:M
which is called the Bers embedding. This embedding will be central to our entire treatment
of the complex theory, and its p-adic analogue will be central to our treatment of the p-adic
theory.
Quasidisks and the Bers Embedding
One can also deï¬ne the Bers embedding in terms of Bersâ€™ simultaneous uniformization
and Schwarzian derivatives. For details, see [Gard], pp. 100-101. To do this, we ï¬x an
 with H. Let H c be the lower half plane. Thus, if H uniformizes X,
isomorphism of X
c
then H naturally uniformizes X c . Let Î“ be the group of MoÌˆbius transformiations of C
 â†’ X. Then we may think of the space
which are the covering transformations for H = X
M(X c ) of Beltrami diï¬€erentials on X c as the space of Beltrami diï¬€erentials on H c which
are invariant under Î“. Let Î¼ âˆˆ M(X c ). Let f Î¼ : C â†’ C be the unique quasiconformal
homeomorphism which ï¬xes 0 and 1, goes to inï¬nity at inï¬nity, has Beltrami coeï¬ƒcient Î¼
on H c and is conformal on H. Let Î“Î¼ = f Î¼ â—¦Î“â—¦(f Î¼ )âˆ’1 . Then it follows from the uniqueness
of solutions to the Beltrami equation that Î“Î¼ forms a group of MoÌˆbius transformations of
C. Moreover, we have conformal isomorphisms
f Î¼ (H c )/Î“Î¼ âˆ¼
= XÎ¼c ;

f Î¼ (H)/Î“Î¼ âˆ¼
=X

It follows that if we take the Schwarzian derivative of the conformal â€œquasidiskâ€ embedding
f Î¼ |H : H â†’ C
we get a Î“-invariant quadratic diï¬€erential on H, hence a quadratic diï¬€erential Ï† (with at
most simple poles at the punctures) on X. The content of the Lemma of Ahlfors-Weill
([Gard], p. 100) is that the assignment:
XÎ¼c â†’ Ï†
c â†’ Q. On the one hand, this description of the Bers embedding is
is equal to B c : M
g,r
geometrically more satisfying than the deï¬nition given in the previous subsection, but it
has the disadvantage that it obscures the relationship between the hyperbolic and parabolic
cases. So far we have been mainly discussing the hyperbolic case, but we shall discuss the
parabolic case later.
16

The Inï¬nitesimal Form of the Modular Uniformizations
Often it is useful to express these modular uniformizations in their inï¬nitesimal form,
as metrics. On the one hand, the global uniformizations can always be essentially recovered
by integrating the metrics, and on the other hand, metrics, being local in nature, can often
be studied more easily.
In the TeichmuÌˆller case, if K is deï¬ned by
Ï† =

K âˆ’1
K +1

g,r , given by
then one obtains a distance function on M
d(X, XÎ¼Ï† ) =

1
log(K)
2

which turns out to be equal to the general hyperbolic distance introduced by Kobayashi
for an arbitrary hyperbolic complex manifold (see [Gard], Chapter 7, for an exposition).
The inï¬nitesimal form of this distance is given by the norm Ï† = X |Ï†| on quadratic
diï¬€erentials (see [Royd]).
We shall be more interested in the case of the Bers embedding
g,r â†’ Qc
B:M
By using the hyperbolic volume form vX on X, we obtain the Weil-Petersson inner product:
def



Ï†, Ïˆ =

X

Ï†Â·Ïˆ
vX

for Ï†, Ïˆ âˆˆ Q. It is a result of Weil and Ahlfors that the resulting metric, called the WeilPetersson metric on Mg,r , is KaÌˆhler. Moreover, if we diï¬€erentiate B, we get, at X, a map
on tangent spaces
dB : Qâˆ¨ â†’ Qc
whose inverse is exactly the morphism Qc â†’ Qâˆ¨ deï¬ned by the Weil-Petersson inner product. Finally, the coordinates obtained from the Bers embedding are canonical coordinates
for the Weil-Petersson metric ([Royd]). (We shall review the general theory of canonical
coordinates associated to a real analytic KaÌˆhler metric in Â§2.)
It turns out that it is precisely the p-adic analogue of the Weil-Petersson metric that
will play a central role in this paper.
17

Coordinates of Degeneration
While the Bers coordinates are useful for understanding what happens in the interior
of Mg,r , they are not so useful for understanding what happens as one goes out to the
boundary, that is, as the Riemann surface degenerates to a Riemann surface with nodes.
To study this sort of degeneration, one ï¬xes a decomposition of the Riemann surface into
â€œpants,â€ which are topologically equivalent to an open disk with two smaller disks in the
interior removed. For a detailed description of the theory of pants and the coordinates they
deï¬ne, we refer to [Abikoï¬€], Chapter 2. In summary, what happens is the following. Let
X be a hyperbolic Riemann surface (of genus g with r punctures), with a decomposition
into pants. We shall call the curves on X which occur in the boundary of the pants
partition curves. There are exactly 3g âˆ’ 3 + r partition curves, Î±1 , . . . , Î±3gâˆ’3+r . We
assume that this decomposition is â€œmaximalâ€ in the sense that each partition curve is
a simple closed geodesic (in the hyperbolic metric on X). Then it turns out that the
isomorphism class of X as a Riemann surface is completely determined by 3g âˆ’ 3 + r
complex numbers Î¶i = li eiÎ¸ (i = 1, . . . , 3g âˆ’ 3 + r), one for each partition curve. Basically
li describes the circumference of the partition curve Î±i , while Î¸i describes the angle of
twisting involved in gluing together the boundary curves of two neighboring pants to form
Î±i . These coordinates Î¶i are called the Fenchel-Nielsen coordinates of X. The degeneration
corresponding to pinching Î±i to a node is given by li â†’ 0. This degeneration respects the
hyperbolic metrics involved: that is, if a family of smooth Xt degenerates to a nodal
Riemann surface Z, then the hyperbolic metrics on the Xt degenerate to the hyperbolic
metric on Z (given by taking the hyperbolic metric on the smooth subsurface of Z which
is the complement of the nodes). Thus, the Fenchel-Nielsen coordinates have the virtue
of admitting a very satisfying diï¬€erential-geometric description (as just summarized), but
the disadvantage of not being holomorphic.
On the other hand, one can deï¬ne holomorphic coordinates (as in [Wolp]), as follows.
Recall the quasidisk description of the Bers embedding. Thus, we had a Î¼ âˆˆ M(X c ),
and a quasiconformal homeomorphism f Î¼ : C â†’ C, together with a new group of MoÌˆbius
transformations Î“Î¼ . Then each Î±i deï¬nes (by integration) an element Ai âˆˆ Î“Î¼ . Up to
conjugation, Ai is of the form z â†’ mi Â· z for some mi âˆˆ C with |mi | > 1. This complex
number mi is uniquely deï¬ned. Then the coordinates
XÎ¼c â†’ (m1 , . . . , m3gâˆ’3+r )
are holomorphic in Î¼. In [Wolp], the relationship between these coordinates and the Bers
coordinates is studied. In these coordinates, the degeneration of XÎ¼c corresponding to the
case where the partition curve Î±i is pinched to a node is given by mi â†’ 1. It turns
out that these coordinates are probably the best complex analogue to the â€œmultiplicative
parameters at inï¬nityâ€ that we construct in the p-adic case.

18

The Parabolic Case
So far we have mainly been discussing the case of hyperbolic Riemann surfaces, since
this case is by far the most interesting. However, often it is very diï¬ƒcult to make explicit
computations for hyperbolic Riemann surfaces. Thus, in order to get oneâ€™s bearings, it
is sometimes useful to consider the analogous constructions in the parabolic case, where
explicit computations are much easier to carry out. Let X be a parabolic Riemann surface.
Then X is either compact of genus 1, or it is isomorphic to the projective line minus two
points. We shall mainly be interested in the compact case, where there are nontrivial
moduli.
Thus, let X be compact of genus 1. Then one can carry out TeichmuÌˆller theory in
this case (as in [Lehto], Chapter V, Â§6). One can also deï¬ne a parabolic analogue of the
Bers embedding, as follows. Namely, we simply copy the formula
def âˆ’2Ï†

Î¼Ï† =

c

vX c

of the hyperbolic case, except that we take vX c to be the
 parabolic volume element (as
opposed to the hyperbolic volume element) on X c , with X c vX c = 1. Then one sees (as
in [Lehto], p. 220) that one obtains a holomorphic embedding
1,0 â†’ Qc
B1,0 : M
whose image is an open disk D âŠ† Qc of some radius. One can also deï¬ne a Weil-Petersson
metric on M1,0 by simply replacing the hyperbolic volume element used before by the
parabolic volume element. A simple calculation then reveals that one obtains the standard
hyperbolic metric on the open disk D. In particular, (just as in the hyperbolic case), the
standard coordinate on D is normal at 0 for the Weil-Petersson metric.
One thing that is interesting about this parabolic case is that even though the complex
analytic stacks M1,0 and M1,1 are isomorphic, the â€œBers theoryâ€ diï¬€ers substantially in
1,1 is far from being an open disk.
the two cases. For instance, the Bers embedding of M
In fact, (as the author was told by C. McMullen) the boundary of this hyperbolic Bers
embedding has lots of cusps. A computer-generated illustration of this boundary appears in
[McM]. Also, it is not diï¬ƒcult to show that the Weil-Petersson metrics are quite diï¬€erent.
This contrasts considerably with the â€œTeichmuÌˆller theoryâ€ of M1,0 and M1,1 : Indeed,
since TeichmuÌˆllerâ€™s metric always coincides with Kobayashiâ€™s intrinsic hyperbolic metric,
it follows that the TeichmuÌˆller metrics of M1,0 and M1,1 coincide.
Real Curves
A Riemann surface X of ï¬nite type is called real if X âˆ¼
= X c . In other words, this means
that the C-valued point deï¬ned by X in the algebraic stack (Mg,r )R (over Spec(R)) is,
19

in fact, deï¬ned over R (up to perhaps reordering the marked points). Various interesting
properties of real Riemann surfaces (related to uniformization theory) are studied in [Falt2].
Many of these properties are obtained by looking at various one-dimensional real analytic
submanifolds of a real X.
From our point of view, however, the notable fact about real hyperbolic Riemann
surfaces X is the following. Let Ï† : X âˆ¼
= X c be a holomorphic isomorphism. For simplicity,
suppose that there exists a point x âˆˆ X such that Ï†(x) = xc , and that Ï†c â—¦ Ï† = idX . Fix
 âˆ¼
c âˆ¼
an isomorphism X
= H c . On the other hand, Ï†
= H. This induces an isomorphism X
c

induces a holomorphic isomorphism Ï† : H â†’ H . Let C : H c â†’ H be the conjugation
 Thus, Ïˆ is an anti-holomorphic automorphism of H. Now let
map. Let Ïˆ = C â—¦ Ï†.
Î C = Ï€1 (X, x). Since X c has the same underlying topological space as X, we have
Î C = Ï€1 (X c , xc ). Thus, Ï† induces an automorphism Ï†Î  of Î C of degree 2. Let Î R be the
extension
1 â†’ Î C â†’ Î R â†’ Gal(C/R) â†’ 1
which is the crossed product of Î C with Gal(C/R) given by letting the nontrivial element
of Gal(C/R) act on Î C by means of Ï†Î  . Now let us consider the Lie group
def

G(R) = {M âˆˆ GL2 (R)| det(M ) = Â±1}/{Â±1}
Thus, PSL2 (R) âŠ† G(R) âŠ† GLÂ±
2 (R), so we can write
ÏC : Î C â†’ GLÂ±
2 (R)
for the canonical representation of X (uniformized by the upper half 
plane H).
 Note that
a b
the full group GLÂ±
âˆˆ GLÂ±
2 (R) acts on the upper half plane as follows: if A =
2 (R),
c d
we let
A(z) =

aw + b
cw + d

where w = z (respectively, w = z) if det(A) is positive (respectively, negative). Thus,
the map deï¬ned by A is a holomorphic (respectively, anti-holomorphic) automorphism
of H if det(A) is positive (respectively, negative). In particular, the anti-holomorphic
automorphism Ïˆ : H â†’ H deï¬nes an element (which by abuse of notation we call) Ïˆ âˆˆ
G(R). Now note that if Î³ âˆˆ Î C , then Ïˆ Â· Ï(Î³) Â· Ïˆ âˆ’1 = Ï(Ï†Î  (Î³)). Thus, by mapping the
nontrivial element of Gal(C/R) in the crossed product deï¬nition of Î R to Ïˆ, we see that
we obtain a natural homomorphism
ÏR : Î R â†’ GLÂ±
2 (R)
20

which extends ÏC and is such that the composite with the determinant det : GLÂ±
2 (R) â†’
RÃ— is trivial on Î C and equal to the sign representation on Gal(C/R). It is this representation ÏR that will be relevant to our discussion of the p-adic case.
Â§2. Translation into the p-adic Case
In this Section, we discuss the dictionary for translating the complex analytic theory
of Â§1 into the p-adic results discussed in Â§0. Undoubtedly, the most fundamental tool,
which is, in fact, of an algebraic, not an arithmetic nature, is the systematic use of the
indigenous bundles of [Gunning]. This enables one to get rid of the upper half plane, and
thus to bring uniformization theory into a somewhat more algebraic setting. In any sort
of nontrivial arithmetic theory of this nature, however, algebraic manipulations alone can
never be enough. Thus, the fundamental arithmetic observation is the following:
KaÌˆhler metrics in the complex case correspond to Frobenius actions in
the p-adic case.
Since one typically gets a natural Frobenius action for free modulo p, a Frobenius action
typically means a canonical lifting of the natural Frobenius action modulo p. In fact,
in some sense, if one sorts through the complex analytic theory reviewed Â§1, one can
essentially distill everything down to two objects, both of which happen to be KaÌˆhler
metrics:
(1) the hyperbolic metric on a hyperbolic Riemann surface (which encodes
the upper half plane uniformization); and
(2) the Weil-Petersson metric on the moduli space (which encodes the Bers
uniformization).
Moreover, these two metrics are related to each other in the sense that the latter is essentially the push-forward of the former. In a similar way, the p-adic theory revolves around
two fundamental Frobenius liftings:
(1) the canonical Frobenius lifting on a canonical hyperbolic curve; and
(2) the canonical Frobenius lifting on a certain stack which is eÌtale over
the moduli stack.
The goal of this Section is to explain this analogy in greater detail.

21

Gunningâ€™s Theory of Indigenous Bundles
Let X be a compact hyperbolic Riemann surface. Let H â†’ X be its uniformization
by the upper half plane. Then by considering the covering transformations of H â†’ X, we
get a homomorphism (unique up to conjugation)
Ï : Ï€1 (X) â†’ Aut(H) âŠ† PSL2 (R)
which we call the canonical representation of X. If we regard Ï as deï¬ning a morphism
into PSL2 (C), then we obtain (in the usual fashion), a local system of P1 -bundles on X,
which thus gives us a holomorphic P1 -bundle with connection (P, âˆ‡P ) on X. By Serreâ€™s
GAGA, (P, âˆ‡P ) is necessarily algebraic. It turns out that P is always isomorphic to a
certain P1 -bundle of jets (which is also entirely algebraic). Thus, the upper half plane
uniformization may be thought of as just being a special choice of connection âˆ‡P . A pair
â€œlikeâ€ (P, âˆ‡P ) (satisfying certain technical properties discussed in Chapter I, Â§2) is called
an indigenous bundle. By working with log structures, one can also deï¬ne indigenous
bundles in a natural way for smooth X with punctures, as well as for nodal X.
As emphasized earlier, the point of dealing with indigenous bundles is that they allow
one to translate the upper half plane uniformization into the purely algebraic information
of a connection on P . Of course, how one chooses this particular special connection on P
is very nontrivial arithmetic issue. We shall call the pair (P, âˆ‡P ) consisting of P equipped
with this particular connection the canonical indigenous bundle on X. Universally, over
the moduli stack Mg,r (of stable r-pointed curves of genus g over C), the space of all
indigenous bundles forms a holomorphic torsor
S g,r â†’ Mg,r
over the logarithmic cotangent bundle Î©log
M

g,r /C

of Mg,r . In the holomorphic category,

we shall see (in Chapter I, Â§3) that this torsor is highly nontrivial. In the real analytic
category, however, the canonical indigenous bundle determines a trivializing section
sH : S g,r â†’ Mg,r
of this torsor.
In fact, indigenous bundles also allow us to translate such diï¬€erential-geometric information as the hyperbolic geometry of X into algebraic terms. For instance, consider
the degeneration of Riemann surfaces from the point of view of hyperbolic geometry. As
reviewed in Â§1, this may be thought of in terms of certain geodesic partition curves whose
lengths go to zero as a family of smooth Xt degenerates to a nodal Riemann surface Z.
From the complex theory, we know that the hyperbolic metric on Xt degenerates to the
hyperbolic metric on Z. Using indigenous bundles, we can translate this into a more algebraic statement as follows: We deï¬ne the canonical indigenous bundle on Z to be the
22

indigenous bundle obtained by gluing together the canonical indigenous bundles of the
pointed Riemann surfaces occurring in the normalization of Z. Then the statement is that
as Xt degenerates to Z, the canonical indigenous bundle on Xt degenerates to the canonical indigenous bundle on Z. The statement that the lengths of the partition geodesics
go to zero then takes the form that the monodromy of the limit indigenous bundle of the
canonical indigenous bundles of the Xt â€™s is nilpotent at the nodes.
The Canonical Coordinates Associated to a KaÌˆhler Metric
In this subsection we discuss how a KaÌˆhler metric on a complex manifold can be used to
deï¬ne canonical aï¬ƒne, holomorphic coordinates on the manifold locally in a neighborhood
of a given point. We believe that what is discussed here is well-known, but our point of
view is somewhat diï¬€erent from that usually taken in the literature.
Let M be a smooth complex manifold of complex dimension m. The complex analytic
structure on M deï¬nes, in particular, a real analytic structure on M . Let Î¼ be a real
analytic (1, 1)-form on M that deï¬nes a KaÌˆhler metric on M . In particular, Î¼ is a closed
diï¬€erential form. Let M c be the conjugate complex manifold to M : that is to say, we take
M c to be that complex manifold which has the same underlying real analytic manifold
structure as M , but whose holomorphic functions are the anti-holomorphic functions of
M . Let us ï¬x a point e âˆˆ M . Let N be the germ of a complex manifold obtained by
localizing the complex manifold M c Ã— M at (e, e) âˆˆ M c Ã— M (where this last expression
makes sense since M c has the same underlying set as M ). Let Î©hol (respectively, Î©ant ) be
the holomorphic vector bundle on N obtained by pulling back the bundle Î©M (respectively,
Î©M c ) of holomorphic diï¬€erentials on M (respectively, M c ) to M c Ã— M via the projection
M c Ã— M â†’ M (respectively, M c Ã— M â†’ M c ), and then restricting to N . Thus, in
summary, we have a 2m-dimensional germ of a complex manifold N , together with two
m-dimensional holomorphic vector bundles (locally free sheaves) Î©hol and Î©ant on N .
Note that locally at e âˆˆ M , the fact that Î¼ is real analytic means that we can write
Î¼ as a convergent power series in holomorphic and anti-holomorphic local coordinates at
e. In other words, if we restrict Î¼ to N , we may regard Î¼|N as deï¬ning a holomorphic
section of Î©hol âŠ—ON Î©ant (where ON is the sheaf of holomorphic functions on N ). Let dhol
(respectively, dant ) be the exterior derivative on N with respect to the variables coming
from M (respectively, M c ). Note that since Î©hol is constructed via pull-back from M , we
can apply dant to sections of Î©hol . We thus obtain a sort of de Rham complex with respect
to dant :

0 âˆ’â†’

Î©hol

dant

âˆ’â†’

Î©hol âŠ—ON Î©ant

dant

âˆ’â†’

Î©hol âŠ—ON (âˆ§2 Î©ant )

dant

âˆ’â†’

...

Relative to this complex, the section Î¼|N of Î©hol âŠ— Î©ant satisï¬es dant Î¼|N = 0 (since Î¼ is a
closed form). It thus follows from the PoincareÌ Lemma that there exists a (holomorphic)
section Î± of Î©hol that vanishes at (e, e) âˆˆ N and satisï¬es dant Î± = Î¼|N . Let Me be the
germ of a complex manifold obtained by localizing M at e âˆˆ M . Let
23

Î¹ : Mec â†’ N
be the inclusion induced by the map M c â†’ M c Ã—M that takes f âˆˆ M c to (f, e) âˆˆ M c Ã—M .
Then Î¹âˆ— (Î±) deï¬nes a holomorphic morphism Î² : Mec â†’ Î©M,e , where Î©M,e is the aï¬ƒne
complex analytic space deï¬ned by the cotangent space of M at e. Note, moreover, that
although Î± (as chosen above) is not unique, Î² is nonetheless independent of the choice
of Î±. Moreover, Î² is an immersion: Indeed, to see this, it suï¬ƒces to check that the map
induced by Î² on tangent spaces is an isomorphism, but this follows from the fact that
dant Î± = Î¼|N , and the fact that the Hermitian form deï¬ned by Î¼ is nondegenerate.
In summary, we see that from the KaÌˆhler metric Î¼, we obtain a canonical holomorphic
local aï¬ƒne uniformization
Î² c : Me â†’ Î©cM,e
Pulling back the standard aï¬ƒne coordinates on Î©cM,e gives us a canonical collection of
holomorphic coordinates on Me .
Deï¬nition 2.1. We shall refer to these coordinates as the canonical holomorphic local
coordinates of the KaÌˆhler manifold (M, Î¼) at e. We shall refer to Î² c as the canonical local
aï¬ƒne uniformization of the KaÌˆhler manifold (M, Î¼) at e.
Now let us consider some basic well-known examples:
Example 1. Let M = {z âˆˆ C| |z| < 1}, with the standard hyperbolic metric âˆš2dzâˆ§dz .
1âˆ’(zÂ·z)

hol

Then z is a canonical coordinate at 0. Indeed, to see this it suï¬ƒces to note that d (zÂ·dz) =
dz âˆ§ dz, which is equal to the metric modulo the ideal generated by z in ON . Note that by
the KoÌˆbe uniformization theorem, this example essentially covers all hyperbolic Riemann
surfaces.
Example 2. Let M be the TeichmuÌˆller space of Riemann surfaces of genus g with r
punctures, where 2g âˆ’ 2 + r â‰¥ 1. Then as stated earlier, it is known ([Royd]) that the
coordinates arising from the Bers embedding are canonical coordinates with respect to the
Weil-Petersson metric on M . In fact, in this case, by Theorem 2.3 (proven below) the real
analytic section sH deï¬ned by the canonical indigenous bundle essentially already serves
as an â€œÎ±â€ in the above discussion. Thus, in a very real sense, the section sH already is the
Bers embedding.

24

The Weil-Petersson Metric from the Point of View of Indigenous Bundles
Let X be a compact hyperbolic Riemann surface. Let (Ï€ : P â†’ X, âˆ‡P ) be the
canonical indigenous bundle on X. Let Ad(P ) = Ï€âˆ— Ï„P/X be the push-forward of the
relative tangent bundle of Ï€. Thus, Ad(P ) is a rank 3 vector bundle on X, equipped
with a simple Lie algebra structure, hence with a nondegenerate Killing form < âˆ’, âˆ’ >:
Ad(P ) âŠ—OX Ad(P ) â†’ OX . Moreover, âˆ‡P induces a connection âˆ‡Ad on Ad(P ). Moreover,
as an indigenous bundle, Ad(P ) comes equipped with a section Ïƒ : X â†’ P (the â€œHodge
sectionâ€) which deï¬nes a Hodge ï¬ltration F Â· (Ad(P )) on Ad(P ). (See Chapter I for more
1
(Ad(P ), âˆ‡Ad ) module
details.) At any rate, we can take the ï¬rst de Rham cohomology HDR
of (Ad(P ), âˆ‡Ad ). The Hodge ï¬ltration on Ad(P ) then deï¬nes a Hodge ï¬ltration on the de
Rham cohomology, hence an exact sequence:
âŠ—2
1
0 â†’ H 0 (X, Ï‰X
) â†’ HDR
(Ad(P ), âˆ‡Ad ) â†’ H 1 (X, Ï„X ) â†’ 0

On the other hand, recall the representation that we used to deï¬ne (P, âˆ‡P ):
Ï : Ï€1 (X) â†’ Aut(H) âŠ† PSL2 (R)
Let Ad(VR ) denote the Ï€1 (X)-module obtained by letting Ï€1 (X) act on the Lie algebra
def

sl2 (R) by applying Ï and then conjugating matrices. Let Ad(VC ) = Ad(VR ) âŠ—R C. Then
(it is elementary that) we have a â€œcomparison theoremâ€ that gives a natural isomorphism
between the de Rham cohomology module just considered and the group cohomology of
Ad(VC ):
1
HDR
(Ad(P ), âˆ‡Ad ) âˆ¼
= H 1 (Ï€1 (X), Ad(VC ))

On the other hand, we also have:
H 1 (Ï€1 (X), Ad(VC )) âˆ¼
= H 1 (Ï€1 (X), Ad(VR )) âŠ—R C
which, combined with the above comparison theorem, thus gives a real structure on
1
HDR
(Ad(P ), âˆ‡Ad ). One way to express this real structure is as an R-linear conjugation
1
1
(Ad(P ), âˆ‡Ad ) â†’ HDR
(Ad(P ), âˆ‡Ad ).
morphism (read: â€œFrobenius actionâ€) cDR : HDR
Now let us consider the relationship between cDR and the Hodge ï¬ltration. If we
âŠ—2
1
compose the natural inclusion H 0 (X, Ï‰X
) â†’ HDR
(Ad(P ), âˆ‡Ad ) with cDR followed by the
1
1
natural projection HDR (Ad(P ), âˆ‡Ad ) â†’ H (X, Ï„X ), we obtain a C-bilinear form
Î² : H 0 (X, Ï‰ âŠ—2 ) âŠ—C H 0 (X, Ï‰ âŠ—2 )c â†’ C
(where the superscript â€œcâ€ stands for the complex conjugate C-vector space).
25

Proposition 2.2. The form Î² is precisely the Weil-Petersson metric on quadratic diï¬€erentials deï¬ned in Â§1 by means of integration. In particular, Î² is nondegenerate.
Proof. In order to obtain Î², we implicitly used the special case of Serre duality given by
âŠ—2
). But in the complex analytic context, the pairing that deï¬nes
H 1 (X, Ï„X ) âˆ¼
= H 0 (X, Ï‰X
this sort of duality is given by integrating the product of ((0, 1)âˆ’ and (1, 0)âˆ’) forms. The
volume form vX appears for the sake of deï¬ning the duality between Ï‰X and Ï‰ X . With
these remarks, the claim of the Lemma becomes a tautology. 
Now let us recall the real analytic section sH : Mg,r â†’ S g,r . Since S g,r â†’ Mg,r is a
holomorphic torsor, we may form âˆ‚sH , which gives a section of Î©log
M

g,r /C

log

âŠ—Î©Mg,r /C . On the

other hand, the Weil-Petersson metric also deï¬nes a section Î¼WP of Î©log
M

g,r

log

âŠ— Î©Mg,r /C .
/C

Now we have the following result (stated in [ZT], but from a somewhat diï¬€erent point of
view):
Theorem 2.3. The form âˆ‚sH is equal to Î¼WP .
Proof. By introducing log structures, one can handle the general case; here, for simplicity,
we restrict our attention to the case of smooth compact Riemann surfaces. Let us consider
âŠ—2
1
) â†’ HDR
(Ad(P ), âˆ‡Ad ) with cDR followed
the composite of the natural inclusion H 0 (X, Ï‰X
1
1
by the natural projection HDR (Ad(P ), âˆ‡Ad ) â†’ H (X, Ï„X ); this composite gives a C-linear
morphism:
âŠ—2
) â†’ H 1 (X, Ï„X )c
H 0 (X, Ï‰X

which is invertible by Lemma 2.2. Taking its inverse, and dualizing, we obtain an element
âŠ—2
âŠ—2 c
Î´ âˆˆ H 0 (X, Ï‰X
) âŠ—C H 0 (X, Ï‰X
)

On the other hand, sorting through the deï¬nitions, it is a tautology in linear algebra that
the value of âˆ‚sH at the point [X] âˆˆ Mg is given by Î´. But, combining this with Lemma
2.2, we see that we have proven the Theorem. 
The important point here is that this Theorem shows that:
The Weil-Petersson metric, and hence the Bers embedding, is obtained
precisely by considering the extent to which â€œFrobeniusâ€ â€“ i.e., complex
conjugation â€“ is compatible with the canonical indigenous bundle section
sH .
26

Stated in this way, the classical complex theory becomes all the more formally analogous
to the p-adic theory to be discussed in this paper.
The Philosophy of KaÌˆhler Metrics as Frobenius Liftings
Before going into a detailed account of the correspondence between complex and padic results, we pause to explain some of the motivation for considering KaÌˆhler metrics as
Frobenius liftings. Let S be a smooth p-adic formal scheme over Zp . A Frobenius lifting on
S is a morphism Î¦ : S â†’ S whose reduction modulo p is equal to the Frobenius morphism
in characteristic p. Then the main point of the analogy is that just as (real analytic) KaÌˆhler
metrics deï¬ne canonical coordinates (as discussed above), Frobenius liftings Î¦ : S â†’ S
(that satisfy a certain technical condition called ordinariness â€“ see Chapter III, Â§1 for
details) also deï¬ne canonical coordinates, as follows:
The most basic example of an ordinary Frobenius lifting is the case when S is the
p-adic completion of Zp [T, T âˆ’1 ] (where T is an indeterminate), and Î¦âˆ’1 (T ) = T p . Then
the theory of ordinary Frobenius liftings (Chapter III, Â§1) states that by means of a certain
â€œintegrationâ€ procedure, every ordinary Frobenius lifting on an arbitrary S becomes (after
completing at a point of S) isomorphic to a product of copies of this basic example. This
â€œintegration procedureâ€ is thus analogous to the integration procedure just reviewed which
allowed us to construct canonical coordinates associated to real analytic KaÌˆhler metrics.
The Dictionary
The fundamental â€œnuts and boltsâ€ of the complex theory lies in the Beltrami equation. Suppose that we think of the Beltrami equation not as a diï¬€erential equation whose
unknown is the quasiconformal function fÎ¼ , but instead as an equation whose unknown
is the conformal quasidisk embedding function f Î¼ |H (in the discussion of quasidisks). A
quasidisk embedding of the universal covering space of a hyperbolic Riemann surface X
deï¬nes an indigenous bundle (P, âˆ‡P )Î¼ on X in a natural way. Thus, from this point of
view, we can think of the Beltrami equation as an equation whose unknown is (P, âˆ‡P )Î¼ .
Moreover, the Beltrami coeï¬ƒcient Î¼ deï¬nes the â€œshearingâ€ or distortion factor between
z and z. Thus, in summary, we may regard the Beltrami equation as an equation in the
unknown (P, âˆ‡P )Î¼ in terms of the distortion factor (eï¬€ected by the quasidisk embedding
f Î¼ |H ) between z and its â€œFrobenius conjugateâ€ z.
On the other hand, the â€œnuts and boltsâ€ of the p-adic theory lies in the study of the
Verschiebung on indigenous bundles, which occupies most of Chapter II. As a function
on the indigenous bundles of a hyperbolic curve in characteristic p, the Verschiebung â€“
which is essentially the determinant of the p-curvature â€“ measures the distortion factor
between applying Frobenius to an inï¬nitesimal on the curve and applying Frobenius to an
inï¬nitesimal motion in the (â€œquasidiskâ€) uniformization deï¬ned by the indigenous bundle.
Thus, for instance, when the p-curvature is nilpotent, there is no distortion factor, and so
the indigenous bundle provides the â€œrightâ€ uniformization for the curve. In this sense, we
27

feel that there is an analogy between the Beltrami equation in the complex theory and the
Verschiebung on indigenous bundles in the p-adic theory.
Relative to this analogy, the fundamental existence and uniqueness theorem for solutions to the Beltrami equation becomes the result (in Chapter II) that the Verschiebung on
indigenous bundles is ï¬nite and ï¬‚at. Since in the p-adic case, its degree is not one, we only
have uniqueness up to a ï¬nite number of possibilities. This is why we get several distinct
â€œquasiconformal equivalence classesâ€ in the p-adic case. Moreover, the important integral
operator â€œT â€ â€“ i.e., the parametrix to âˆ‚ â€“ which gives the ï¬rst term in the series expansion
for fÎ¼ may be regarded as having its analogue in the p-adic theory in the inï¬nitesimal
Verschiebung, which plays an important role throughout the paper.
More obvious is the analogy between the canonical representation ÏC : Ï€1 (X) â†’
PSL2 (R) of a hyperbolic Riemann surface (arising from the upper half plane uniformization), and the canonical representation Ïâˆ : Î âˆ â†’ GLÂ±
2 (Zp ) of an ordinary p-adic curve
(in Theorem 0.4). Of course in the p-adic case, Î âˆ has a substantial arithmetic part in
addition to its geometric part. Although generally in the complex case, there is not much
of a Galois group to work with, at least for real curves, we saw at the end of Â§1, that one
does get a natural representation ÏR of the full â€œarithmetic fundamental groupâ€ Î R into
GLÂ±
2 (R). Moreover, our approach to constructing Ïâˆ in the p-adic case is very much akin
to Bersâ€™ approach to constructing ÏC in the complex case: Namely, if one traces through
the proof (which lies in Chapters II through V), one sees that eï¬€ectively what we are doing
is noting that the result is true for totally degenerate curves, and then transporting this
result over the rest of the moduli stack of ordinary curves.
Next let us consider metrics and geometry. As we stated earlier, in some sense,
one can summarize the entire complex theory by saying: We start with the hyperbolic
(KaÌˆhler) metric on a hyperbolic curve, deï¬ne the Weil-Petersson (KaÌˆhler) metric on the
moduli stack precisely so as to be compatible with the hyperbolic metric on the curves
being parametrized; then our holomorphic uniformizations â€“ i.e., both the upper half plane
uniformization of the hyperbolic curve and the Bers uniformization of the moduli stack
â€“ are obtained by â€œintegratingâ€ the respective metrics. Similarly, the fundamental result
in the p-adic theory â€“ namely, Theorem 0.1 â€“ is a result about the existence of certain
Frobenius liftings on the universal hyperbolic curve and its moduli stack which are uniquely
characterized by the fact that they are compatible with each other. Here the compatibility
is expressed through the tool of the canonical indigenous bundle. Then, by â€œintegratingâ€
these Frobenius actions, we obtain canonical (p-adically holomorphic) coordinates (as in
ord
Corollary 0.2) on C ord and N g,r . This particular analogy lies at the heart of this work.
The Bers coordinates and the coordinates of Chapter III, Theorem 2.4, are appropriate
in the locus Mg,r of smooth curves. For totally degenerate curves, one has multiplicative
parameters (Chapter III, Deï¬nition 2.7) which we believe are analogous to the holomorphic
coordinates of degeneration of [Wolp], reviewed in Â§1. For instance, both sets of parameters
are holomorphic and naturally indexed by the nodes of the totally degenerate curve.
For elliptic curves â€“ regarded parabolically â€“ one has, on the one hand, the well-known
theory of the hyperbolic upper half plane, or unit disk, in the complex case, and Serre28

Tate theory in the p-adic case. It is interesting to note that at both types of primes
(complex and p-adic), the parabolic theory may be obtained in a very precise sense as
the parabolic specializations, respectively, of Bersâ€™ theory and of the hyperbolic p-adic
theory developed in this paper. In fact, this is one of our reasons for feeling that the
canonical p-adic coordinates of Corollary 0.2 are the p-adic analogue, not of TeichmuÌˆllerâ€™s
coordinates, but of Bersâ€™: Namely, in addition to the fact that TeichmuÌˆllerâ€™s coordinates are
not holomorphic, whereas Bersâ€™ are, TeichmuÌˆller obtains the same coordinates for 1-pointed
curves of genus 1 and parabolic elliptic curves. On the other hand, it is well-known that
Bersâ€™ coordinates are very diï¬€erent for 1-pointed curves of genus 1 and parabolic elliptic
curves, which is consistent with the fact that the canonical coordinates of Corollary 0.2
are also very diï¬€erent for 1-pointed curves of genus 1 and parabolic elliptic curves.
Loose Ends
We close by saying that although, as described above, there are (what the author
believes to be) very strong analogies between Bersâ€™ complex theory and the p-adic theory
presented here, the picture is by no means complete. For instance, one fundamental fact
in the complex case is that all r-pointed smooth curves of genus g are quasiconformally
equivalent, whereas in the p-adic case, the theory behaves as though there are several
diï¬€erent quasiconformal equivalence classes that are permuted around to each other by a
certain monodromy action in such a way that there seems to be no one quasiconformal
equivalence class â€œwhich is better than the others.â€ Ideally, one would like to have a much
more complete understanding of this phenomenon. In particular, one would like to know
precisely how many quasiconformal equivalence classes there are (at least generically), as
well as a more explicit description of the set of such classes.
Also, I still do not understand what the complex, or global, analogue of a â€œcanonical p-adic curveâ€ is. For ordinary elliptic curves, since Serre-Tate canonical liftings have
complex multiplication, one can ask what the hyperbolic analogue of having complex multiplication is. Since having complex multiplication for an elliptic curve means having lots
of isogenies, it is natural to ask if the proper hyperbolic analogue is having lots of correspondences, which are a sort of higher genus version of isogenies. If a hyperbolic curve
does have a lot of correspondences, then one knows ([Marg]) that the image of its canonical
representation is arithmetic. In Chapter IV, we prove that a canonical curve has lots of
â€œpseudo-correspondences,â€ but unfortunately, at the time of writing, I do not see how to
make these pseudo-correspondences into genuine correspondences, so that one could apply
Margulisâ€™ result. Another issue that arises in this connection is the question of whether one
can characterize â€œhyperbolic curves with complex multiplicationâ€ â€“ whatever the correct
deï¬nition should be for this term â€“ in terms of the Bers coordinates.
Finally, as the title implies, the present work deals exclusively with the case of ordinary
curves. In a complete theory, one would like to know what happens when one has a
nilpotent indigenous bundle which is not ordinary.

29

At any rate, in summary, with respect to these three issues of quasiconformal equivalence classes, canonical curves, and non-ordinary curves, much work remains to be done.
We hope to be able to address these issues in future papers.

30

Chapter I: Crystalline Projective Structures
Â§0. Introduction
The purpose of this Chapter is to study the algebraic analogue of projective structures
on a Riemann surface. In particular, we prove many of the analogues of results of [Gunning]
in a purely algebraic framework, often making use of the crystalline site where complex
analytically one would restrict to a simply connected neighborhood on which one can
integrate. Unlike Gunning, we make systematic use of the log structures of [Kato], which
enable us to work with a very general sort of â€œlog-curve,â€ that is, we can handle the case
of curves with marked points, as well as singular nodal curves on an equal footing to the
smooth case.
In Â§1, we discuss the notion of a Schwarz structure, which is the algebraic analogue of
[Gunning]â€™s projective structures. We relate Schwarz structures to projective bundles with
connections as well as to square diï¬€erentials, and we show that Schwarz structures naturally
give rise to a Schwarzian derivative. (Moreover, in the Appendix to this Chapter, we show
that for P1 , this abstract notion of a Schwarzian derivative essentially coincides with the
classical Schwarzian derivative.) The characterizing feature of Â§1 is that everything takes
place locally on the curve in question. In Â§2, we discuss indigenous bundles (the direct
algebraic analogue of [Gunning]â€™s indigenous bundles). What distinguishes Â§2 from Â§1 is
that in Â§2, we work mainly over stable curves, and thus global issues on the curve come
into play. In Â§2, we are still working locally, however, on the base. In Â§3, we perform
various intersection theory calculations that allow us to prove that in most cases, there
do exist any canonical indigenous bundles on the universal smooth curve over a moduli
stack. Thus, in Â§3, we are concerned with issues that are global not only on the curve, but
also on the base. It should be said that all the material in this Chapter is, in some sense,
â€œwell-known,â€ but I do not know of any modern reference that does things from this point
of view. In particular, all the references that I know of (with the exception of [Ih], which
is algebraic, but somewhat diï¬€erent in point of view) discuss things only in the complex
analytic case, and often work with â€œhÎ±Î² â€™sâ€ (i.e., cocycle classes) rather than with objects
that have an intrinsic meaning.

Â§1. Schwarz Structures
In this Section, we introduce the crystalline analogue of what Gunning calls â€œprojective
structures on a Riemann surface.â€ (We shall call them Schwarz structures (after the
Schwarzian derivative) to distinguish them from the analytic notion.) We begin by letting
S be a connected noetherian scheme. Often, we shall prove results about arbitrary stable
curves by working on various compactiï¬ed moduli stacks. Thus, even if one is ultimately
interested only in smooth curves, for certain proofs, we shall see that it is useful to develop
31

the machinery for arbitrary stable curves. To deal with singular curves, we shall use the
theory of log schemes of [Kato]. Thus, we assume that S has a given ï¬ne ([Kato], Â§2) log
structure, and denote the resulting log scheme by S log .
Notation and Basic Deï¬nitions
Deï¬nition 1.1. Let f log : U log â†’ S log be a morphism of log schemes whose underlying
morphism of schemes f : U â†’ S is of ï¬nite type, ï¬‚at and of relative dimension one. Then
we shall say that f log is locally stable of dimension one if, for every point u âˆˆ U , there
exist eÌtale morphisms T â†’ S and V â†’ U Ã—S T , together with v âˆˆ V mapping to u âˆˆ U
such that when we pull-back the log structure on S (respectively, U ) to T (respectively,
V ) to obtain log schemes V log and T log , one of the following holds:
(1) V â†’ T is smooth, and V log = V Ã—T T log (where V and T denote the
log schemes with trivial log structure); or
(2) V â†’ T is smooth, and there exists a section s : T â†’ V such that if we
denote by V s the log scheme deï¬ned by the relative divisor Im(s) on V ,
then V log = V s Ã—T T log ; or
(3) let Y = Spec(Z[t]); X = Y [x, y]/(xy âˆ’ t) (where x, y, and t are indeterminates) and endow Y (respectively, X) with the log structure arising
from the divisor t = 0 (respectively, xy = 0), so we get a morphism
X log â†’ Y log of log schemes; then there exists a morphism of log schemes
T log â†’ Y log , together with a morphism Î¶ log : V log â†’ T log Ã—Y log X log
such that the underlying scheme morphism Î¶ of Î¶ log is eÌtale, and the
log structure of V log on V is the pull-back via Î¶ of the log structure on
T log Ã—Y log X log .
In case (1) (respectively, (2); (3)), we shall say that f is smooth and unmarked (respectively,
marked; singular) at u.
Note that if f log : U log â†’ S log is locally stable of dimension one, then it is always log
smooth ([Kato], Â§3). Also, note that by eÌtale descent, the images in U of all the sections
s as in Case (2) above form a divisor in U which is eÌtale over S. We shall refer to this
divisor as the divisor of marked points in U .
Now let us suppose that there exists an odd prime p which is nilpotent on S. We also
suppose that we are given a closed subscheme S0 = V (I) âŠ† S, where the sheaf of ideals
I has a divided power structure Î³. We denote the log scheme S0 Ã—S S log (where S0 and
S denote the log schemes which are the respective schemes endowed with the trivial log
structure) by S0log . Let f log : U log â†’ S log be locally stable of dimension one. Then we
shall call a section of DÎ” (U log Ã—S log U log ) (the PD-envelope of the diagonal, as in [Kato],
32

Â§5) a bianalytic function over U log . Note that the bianalytic functions form a sheaf, which
we denote OU bi , on the eÌtale site of U . Let OU denote the sheaf on the eÌtale site of U
given by considering ordinary functions. Then the two projections U Ã—S U â†’ U give rise
to injections iL : OU â†’ OU bi and iR : OU â†’ OU bi whose images we shall call the left-sided
(respectively, right-sided) bianalytic functions on U log . We shall also refer to right-sided
bianalytic functions as constant bianalytic functions, or bianalytic constants. We denote
tensor products of an OU -module F over OU with OU bi via iL (respectively, iR ) by writing
F on the left (respectively, right). Finally, we have a multiplication morphism Î¼ : OU bi â†’
OU . We denote the ideal subsheaf of OU bi which is the kernel of Î¼ by J . We shall say
that a bianalytic function f over some eÌtale V â†’ U is a bianalytic uniformizer on V if f
is, in fact, a section of J which generates the line bundle J /J [2] âˆ¼
= Ï‰U log /S log as an OU module. Let OU bi be the completion of OU bi with respect to the divided powers J [i] , and
let J âŠ† OU bi be the closure of J in OU bi . We shall call sections of OU bi biformal functions,
and use similar terminology for biformal functions as we do for bianalytic functions.

Occasionally, we shall also need to make use of trianalytic (respectively, triformal)
functions, i.e., sections of DÎ” (U log Ã—S log U log Ã—S log U log ) (respectively, its completion with
respect to the divided powers of the diagonal ideal). We denote the sheaf of trianalytic
functions (respectively, triformal) on the eÌtale site of U by OU tr (respectively, OU tr ), and
we have left, right, and middle injections j1 , j2 , j3 : OU â†’ OU tr , as well as injections
j12 , j23 , j13 : OU bi â†’ OU tr . We shall apply similar terminology and notation to trianalytic
or triformal functions to that applied already to bianalytic functions. In particular, we
shall call trianalytic functions that are in the image of j23 trianalytic constants.
Deï¬nition 1.2. Let S âŠ† OU bi be a subsheaf in the category of sets. We shall call S a
Schwarz (respectively, pre-Schwarz) structure on U log if eÌtale locally on U (i.e., for some
eÌtale cover V â†’ U ), S has the following form: there exists some biformal uniformizer
z âˆˆ Î“(V, S) such that for every eÌtale W â†’ V , and every section f âˆˆ Î“(W, OU bi ), then
f âˆˆ Î“(W, S) if and only if (respectively, implies that) f can be written eÌtale locally (on W )
in the form (az + b)/(cz + d), where a, b, c, d are biformal constants and d is invertible.
It is clear that if S âŠ† OU bi is a pre-Schwarz structure on U log , then S is contained in a
unique Schwarz structure S a âŠ† OU bi on U log , which we refer to as the Schwarz structure
associated to S. If S is a Schwarz structure, then we shall denote by S Ã— âŠ† S (respectively,
LS ) the subsheaf consisting locally of functions of the form (az +b)/(cz
 +d),
 where: (1) z is
a b
a biformal uniformizer belonging to S; (2) d is invertible; and (3)
is an invertible
c d
S Ã— . Thus S Ã— , LS ,
matrix of biformal constants (respectively, b = 0). We let LÃ—
S = LS
Ã—
and LÃ—
S are all pre-Schwarz structures. We shall call LS (respectively, LS ) the sheaf of
biformal uniformizers (respectively, pseudo-uniformizers) of S.
Let G â†’ U be the group scheme PGL2 , and let B âŠ† G be the subgroup scheme which
is the standard Borel subgroup of PGL2 , i.e., the image of the lower triangular matrices.
33

First Properties of Schwarz Structures
Proposition 1.3. The subsheaf LÃ—
S âŠ† S consisting of biformal uniformizers of S forms a
B-torsor BS â†’ U .
Proof. This follows immediately from the deï¬nition of a Schwarz structure.

 The action of
a 0
B is given by associating to a biformal uniformizer z and a matrix
(where a, c, d
c d
are biformal constants, and a, d are invertible) the biformal uniformizer az/(cz + d). 
Note that every B-torsor T â†’ U naturally deï¬nes a P1 -bundle with a given section (by
taking the quotient of P1 Ã—U T modulo the diagonal action of B, where B acts on P1 by
means of aï¬ƒne transformations that ï¬x zero; the section is the image of the zero section
of P1 ). We shall refer to the P1 -bundle PS â†’ U associated to BS â†’ U as the P1 -bundle
associated to the Schwarz structure S. We denote by ÏƒS : U â†’ PS the natural section
(arising from the fact that the structure group is B rather than G).
Proposition 1.4. Let S be a Schwarz structure on U log . Then PS âˆ¼
= P(J /J [3] ), and
ÏƒSâˆ— Ï„PS /U âˆ¼
= (J /J [2] )âˆ¨ âˆ¼
= Ï„U log /S log . In particular, if U â†’ S is proper, then the height of
ÏƒS with respect to Ï„PS /U is âˆ’deg(Ï‰U log /S log ).
Proof. One sees by construction (e.g., by writing out transition functions) that the sheaf of
nonzero relative rational functions of relative degree one (as in [EGA IV], Â§20) for PS â†’ U
that vanish at Ïƒ is naturally isomorphic to LÃ—
S . Thus, by considering Taylor expansions
out to second order terms, we get an isomorphism OPS (âˆ’ÏƒS )/OPS (âˆ’3ÏƒS ) âˆ¼
= J /J [3] (here
we use that p is odd). On the other hand, by multiplying and then taking the residue at
Ïƒ, we obtain a natural duality between OPS (âˆ’ÏƒS )/OPS (âˆ’3ÏƒS ) and Ï€âˆ— Ï‰PS /U (3ÏƒS ), where
Ï€ : PS â†’ U is the natural projection. Also, note that via this duality, the ï¬ltration induced
by Ï€âˆ— Ï‰PS /U (2ÏƒS ) âŠ† Ï€âˆ— Ï‰PS /U (3ÏƒS ) on OPS (âˆ’ÏƒS )/OPS (âˆ’3ÏƒS ) is the ï¬ltration deï¬ned by
the submodule OPS (âˆ’2ÏƒS )/OPS (âˆ’3ÏƒS ). Since PS is clearly naturally isomorphic to the
projectivization of Ï€âˆ— Ï‰PS /U (3ÏƒS ), we thus obtain the result. 
Crystalline Schwarz Structures and Monodromy
Let S be a Schwarz structure on U log . We would like to associate to S a subsheaf (in
the category of sets) of OU tr , which we shall call S12 as follows. We work locally. Thus,
we assume that there exists a biformal uniformizer z âˆˆ Î“(U, S). We consider the triformal
function z12 deï¬ned by j12 (z), where j12 is the natural map OU bi â†’ OU tr given by inclusion
on the ï¬rst two factors. Then we let S12 be the sheaf of all functions which eÌtale locally
can be written in the form (az12 + b)/(cz12 + d), where a, b, c, d are triformal constants
and d is invertible. Note that the deï¬nition of S12 does not depend on the choice of z,
34

so everything glues together, and we obtain the subsheaf S12 of OU tr over our original U .
On the other hand, we also have a subsheaf S13 of OU tr deï¬ned in the same way as S12 ,
except with the roles of 2 and 3 reversed.
Deï¬nition 1.5. We shall say that the Schwarz structure S is a crystalline Schwarz
structure on U log if the two subsheaves S12 and S13 of OU tr coincide. Let S be a crystalline
Schwarz structure on U log . Then we shall say that S has nilpotent monodromy if for every
marked point s : T â†’ V (with V â†’ U eÌtale), there exists a biformal uniformizer z âˆˆ S(V )
and a section a âˆˆ Ï‰U log /S log (V ) such that the image of (dz) âˆ’ iR (a) (where â€œdâ€ is the
exterior derivative on the right) in OU bi âŠ—OU sâˆ— Ï‰U log /S log is zero.
Remark. Of course, one may also phrase the deï¬nition of a crystalline Schwarz structure
as follows. First, note that OU bi , together with its right-hand sided OU -algebra structure
and standard logarithmic connection, forms a quasi-coherent crystal of algebras A on the
crystalline site of U log /S log . Then a crystalline Schwarz structure is a subsheaf of the sheaf
A on the crystalline site of U log /S log satisfying certain properties. Since this point of view
is only formally diï¬€erent from the point of view of Deï¬nition 1.5, we shall use these two
points of view interchangeably in what follows.
log
Let us suppose that S is a Schwarz structure
on

 U . Let H âŠ† G be the open
a b
subscheme consisting of matrices of the form
, where d is invertible. Note that
c d
H is stable under the action by B from the right. Thus, we can take the quotient of
H Ã—U BS (by the diagonal action of B) to obtain a ï¬ber bundle HS â†’ U with ï¬bers
locally isomorphic to H â†’ U . Similarly, we also obtain a G-torsor GS â†’ U . It now
follows immediately from the deï¬nitions that the sheaf deï¬ned on the eÌtale site of U by
HS is naturally isomorphic to S Ã— . Thus, if we assume that the Schwarz structure S
is crystalline, we see that we get a natural isomorphism between the two pull-backs of
HS â†’ U via iL , iR : OU â†’ OU bi , i.e., we get a logarithmic connection âˆ‡HS on HS â†’ U .
By basic facts about ï¬ber bundles, this gives a logarithmic connection âˆ‡GS on GS â†’ U and
a logarithmic connection âˆ‡PS on PS â†’ U , as well. Thus, in summary, to every crystalline
Schwarz structure S, we have associated a natural P1 -bundle with section and logarithmic
connection (PS â†’ U ; ÏƒS : U â†’ PS ; âˆ‡PS ). Moreover, it follows from the deï¬nition of
the connection âˆ‡PS that by diï¬€erentiating ÏƒS by means of âˆ‡PS , we get an isomorphism
Ï„U log /S log âˆ¼
= ÏƒSâˆ— Ï„PS /U , which is called the Kodaira-Spencer morphism. Indeed, to see that
this morphism is, indeed, an isomorphism, it suï¬ƒces to realize that if, locally on U , one
takes a biformal uniformizer z, the diï¬€erence j12 (z) âˆ’ j13 (z) generates j23 (J )OU tr .

In addition to the fact that the Kodaira-Spencer morphism is an isomorphism, the
logarithmic connection âˆ‡PS has another special property: If S has nilpotent monodromy,
then we can make more explicit the way in which this monodromy acts. Indeed, let
us recall from [Kato], Â§6, that if s : S â†’ U is any marked point, then there exists a
unique subsheaf Ms of (OU bi âŠ—OU ,sâˆ’1 OS )/OS which is isomorphic to OS and annihilated
by the monodromy operator of the standard logarithmic connection on OU bi . (Locally,
35

this subsheaf is generated by log(1 âˆ’ Î´), where Î´ = 1 âˆ’ ( 1âŠ—t
tâŠ—1 ), and t is a local generator of
the ideal deï¬ning s.) This subsheaf Ms thus deï¬nes a section qs : S â†’ P(J /J [3] ) that
lies over s. Then it follows from these observations, plus Proposition 1.4, that
Proposition 1.6. If S is a crystalline Schwarz structure on U log with nilpotent monodromy, then under the isomorphism PS âˆ¼
= P(J /J [3] ) of Proposition 1.4, qs is ï¬xed by
the monodromy action on PS âˆ¼
= P(J /J [3] ) at s.
Correspondence with P1 -bundles
So far, from a crystalline Schwarz structure, we have constructed a P1 -bundle with
section and logarithmic connection (satisfying certain properties). We can go the other
way, as well. Suppose we are given a P1 -bundle with section and logarithmic connection
(Ï€ : P â†’ U ; Ïƒ : U â†’ P ; âˆ‡P ) such that the Kodaira-Spencer morphism obtained by
diï¬€erentiating Ïƒ via âˆ‡P gives an isomorphism Ï„U log /S log âˆ¼
= Ïƒ âˆ— Ï„P/U . Let P L and P R denote
the pull-backs of Ï€ : P â†’ U via iL , iR : OU â†’ OU bi , respectively. Then the connection âˆ‡P
deï¬nes an OU bi -linear isomorphism Î : P L âˆ¼
= P R . Thus, we have a commutative diagram:
Î

P L âˆ’â†’
â
â L
Ï€

U bi

id

âˆ’â†’

PR
â
â R
Ï€

U bi

Let Ïƒ L (respectively, Ïƒ R ) denote the result of base-changing Ïƒ via iL (respectively, iR ).
Then by applying (Ïƒ L )âˆ— , we can pull-back functions on P L to biformal functions on U log .
Let R denote the eÌtale sheaf of degree â‰¤ 1 relative rational functions (as in [EGA IV],
Â§20) on P relative to Ï€ : P â†’ U (i.e., the divisor of poles is ï¬‚at of degree â‰¤ 1 over U )
that are regular in a neighborhood of the image of Ïƒ. Let Î±R : P R â†’ P denote the
natural projection. Then it is easy to see that Îâˆ’1 (Î±R )âˆ’1 (R) deï¬nes a sheaf of functions
on P L that are regular in a neighborhood of Im(Ïƒ L ), so we can consider the subsheaf S
of biformal functions on U log which is the image of (Ïƒ L )âˆ’1 Îâˆ’1 (Î±R )âˆ’1 (R). One checks
immediately that S deï¬nes a Schwarz structure, and, moreover, that since the connection
âˆ‡P is necessarily integrable (since the dimension of U over S is one), S is automatically
crystalline. Thus, in summary, we have the crystalline analogue of Theorem 2 of [Gunning]:
Theorem 1.7. If f : U â†’ S is as above, then there is a natural one-to-one correspondence
between crystalline Schwarz structures on U log and isomorphism classes of P1 -bundles with
section and logarithmic connection (Ï€ : P â†’ U ; Ïƒ : U â†’ P ; âˆ‡P ) on U log whose associated
Kodaira-Spencer morphism is an isomorphism. Moreover, under this correspondence, the
crystalline Schwarz structures with nilpotent monodromy correpond precisely to the triples
such that âˆ‡P has nilpotent monodromy at the marked points.
36

Proof. We have already deï¬ned maps going in either direction. Thus, it suï¬ƒces to see
that these maps are inverse to each other. Now it is easy to see that if we start with
a P1 -bundle with section and logarithmic connection as above, construct the associated
crystalline Schwarz structure S, and then from that the associated P1 -bundle PS with
section ÏƒS and logarithmic connection âˆ‡PS , then we get back our original data. Thus, it
suï¬ƒces to show that the map that associates a P1 -bundle with section and connection to
a crystalline Schwarz structure is injective.
Let S and S  be crystalline Schwarz structures on U log . Suppose that we are given
a horizontal isomorphism Î± between PS and PS  that takes ÏƒS to ÏƒS  . Then Î± induces
an isomorphism Î±B of the B-torsors BS and BS  . Let A be the OU -algebra OU bi via
âˆ¼ Ã—
the morphism iR . Since as sheaves with B-action, BS âˆ¼
= LÃ—
S and BS  = LS  , we get an
Ã—
Ã—
isomorphism Î±L : LÃ—
S â†’ LS  , which, by mapping a biformal uniformizer z âˆˆ Î“(U, LS )
(where U â†’ X is eÌtale) to the biformal uniformizer Î±L (z) âˆˆ Î“(U, LÃ—
S  ) âŠ† Î“(U, A), deï¬nes
an automorphism Î±A of the PD-OU -algebra A that preserves the augmentation Î¼ : A â†’
OU . Moreover, it follows from the horizontality of Î± that Î±A is horizontal with respect
to the standard logarithmic connection on A. On the other hand, it is immediate that A
does admit any nontrivial horizontal automorphisms (as a PD-OU -algebra) that preserve
Î¼. Thus, Î±A is the identity, and hence, S and S  must be the same subsheaf of A. This
completes the proof of the ï¬rst statement. The last statement follows directly from the
deï¬nitions. 
Schwarz Structures and Square Diï¬€erentials
We would like to use Theorem 1.7 to exhibit the space of Schwarz structures as a
torsor over the square diï¬€erentials. Let Ï€ : P â†’ U be a P1 -bundle. Then we shall denote
by Ad(P ) the vector bundle on U (of rank three with trivial determinant) given by Ï€âˆ— Ï„P/U .
When we consider marked points, it is not enough just to deal with P1 -bundles; we must
deal with P1 -bundles equipped with parabolic structures, as in [Sesh]. Thus, if our divisor
D of marked points is given by sections p1 , . . . , pr : S â†’ U , we make the following
Deï¬nition 1.8. A P1 -bundle with parabolic structure on U log is deï¬ned to be a P1 -bundle
Ï€ : P â†’ U , together with sections qi : S â†’ P lying over pi . A rank two vector bundle
with parabolic structure on U log is a rank two vector bundle E, together with a parabolic
structure on P(E).
Let (Ï€ : P â†’ U ; q1 , . . . , qr ) be a P1 -bundle with parabolic structure on U log . Then
we deï¬ne the subsheaf Adq (P ) âŠ† Ad(P ) to be the sheaf of sections that vanish at the
qi â€™s. We deï¬ne Adc (P ) âŠ† Adq (P ) to be the subsheaf of sections that vanish to second
order (in the relative coordinate for Ï€) at the qi â€™s. Suppose that we are given a section
Ïƒ : U â†’ P that avoids all the qi . Let L = Ïƒ âˆ— Ï‰P/U . Then Ad(P ) gets a ï¬ltration
0 = F 2 (Ad(P )) âŠ† F 1 (Ad(P )) âŠ† F 0 (Ad(P )) âŠ† F âˆ’1 (Ad(P )) = Ad(P ) given by considering
sections of Ï„P/U that vanish to ï¬rst or second order at Ïƒ. Thus, for Ad(P ), we have:
37

F1 âˆ¼
= L; F 0 /F 1 âˆ¼
= OU ; F âˆ’1 /F 0 âˆ¼
= Lâˆ’1
This ï¬ltration induces ï¬ltrations on Adq (P ) and Adc (P ). The subquotients are easily seen
to be the following: For Adq (P ), we have:
F1 âˆ¼
= L(âˆ’D); F 0 /F 1 âˆ¼
= OU ; F âˆ’1 /F 0 âˆ¼
= Lâˆ’1
For Adc (P ), we have:
F1 âˆ¼
= L(âˆ’D); F 0 /F 1 âˆ¼
= OU (âˆ’D); F âˆ’1 /F 0 âˆ¼
= Lâˆ’1
log
Often, L âˆ¼
= Ï‰U/S .

Thus, for computational purposes, it is convenient to note that

log
Ï‰U/S
(âˆ’D) is none other than the relative dualizing sheaf of the morphism f : U â†’ S.

Now let us assume that Ï€ : P â†’ U is given by P(J /J [3] ), with the section Ïƒ given
by J /J [3] â†’ J /J [2] , and the qi given by the sections â€œqs â€ deï¬ned in the paragraph
preceding Proposition 1.6. Let âˆ‡P be a logarithmic connection whose Kodaira-Spencer
morphism at Ïƒ is the identity and whose monodromy at the marked points is nilpotent
and ï¬xes the qi . (It is not diï¬ƒcult to see that such âˆ‡P always exist eÌtale locally on U .)
Then any other such logarithmic connection âˆ‡P on P â†’ U is given by adding to âˆ‡P a
log
. On the other hand, the quadruples (Ï€; Ïƒ; qi ; âˆ‡P ) and
section of F 0 (Adc (P )) âŠ—OU Ï‰U/S

(Ï€; Ïƒ; qi ; âˆ‡P ) are isomorphic if and only if âˆ‡P can be obtained from âˆ‡P by applying an
automorphism Î± of (Ï€; Ïƒ; qi ) that preserves the conormal bundle to Ïƒ (since both KodairaSpencer morphisms are the identity). Such an automorphism Î± is given by a section
of F 1 (Adq (P )). The eï¬€ect of such an automorphism Î± on the connection âˆ‡P is given
log
obtained by applying the morphism
by adding to âˆ‡P the section of Adc (P ) âŠ—OU Ï‰U/S
log
Ad(âˆ‡P ) : F 1 (Adq (P )) â†’ F 0 (Adc (P )) âŠ—OU Ï‰U/S
(induced by the connection âˆ‡P ) to
Î±. Thus, we obtain that the set of isomorphism classes of quadruples (Ï€; Ïƒ; qi ; âˆ‡P ) that,
relative to the bijection of Theorem 1.7, correspond to crystalline Schwarz structures with
nilpotent monodromy are a torsor over the cokernel of Ad(âˆ‡P ). On the other hand, by
looking at the explicit representations of the subquotients of the ï¬ltrations on Adq (P ) and
Adc (P ) (given in the preceding paragraph), and using the fact that the Kodaira-Spencer
morphism for âˆ‡P at Ïƒ is an isomorphism, we obtain that
log
Coker(Ad(âˆ‡P )) âˆ¼
= (Ï‰U/S )âŠ—2 (âˆ’D)

(We remark that here one uses the fact that p is odd, for when one computes Ad(âˆ‡P ) from
âˆ‡P , certain factors of 2 appear, and in order to get the above isomorphism, one needs for
those factors of 2 to be invertible.)
In other words, we have proven the following result:
38

Theorem 1.9. The eÌtale sheaf of crystalline Schwarz structures on U log with nilpotent
log âŠ—2
) (âˆ’D).
monodromy is naturally a torsor over the sheaf (Ï‰U/S
Normalized P1 -bundles with Connection
Let us consider the P1 -bundle Ï€ : P = P(J /J [3] ) â†’ U , and section Ïƒ : U â†’ P
given by J /J [3] â†’ J /J [2] , without any connection. Now, just as in the proof of Proposition 1.4, by taking residues, we obtain a natural duality between OP (âˆ’Ïƒ)/OP (âˆ’3Ïƒ)
and Ï€âˆ— Ï‰P/U (3Ïƒ) that respects the natural ï¬ltrations on the two bundles. Let Q =
P((J /J [3] )âˆ¨ ). As U -schemes, we may identify Q and P . Let OQ (1) denote the line
bundle obtained from the deï¬nition of the projectivization; thus Ï€âˆ— OQ (1) = (J /J [3] )âˆ¨ .
Let L = Ï€âˆ— {OQ (1)âŠ—OQ Ï„P/U (âˆ’3Ïƒ)}. Then L is a line bundle on U and (J /J [3] )âˆ¨ = LâŠ—OU
Ï€âˆ— Ï‰P/U (3Ïƒ). Thus, we obtain a natural isomorphism OP (âˆ’Ïƒ)/OP (âˆ’3Ïƒ) âˆ¼
= (J /J [3] )âŠ—OU L
that respects ï¬ltrations. If we then look at the quotients of both sides by their respective
rank one subbundles (that make up the ï¬ltrations), we obtain an isomorphism between
log âˆ¼
log
Ï‰U/S
= (J /J [2] ) âŠ— L âˆ¼
= Ï‰U/S âŠ— L. That is, we get a natural trivial= OP (âˆ’Ïƒ)/OP (âˆ’2Ïƒ) âˆ¼
ization OU âˆ¼
= L of L. In summary, we see that without any connection, we have constructed
a natural ï¬ltration-preserving isomorphism:
Î³ : OP (âˆ’Ïƒ)/OP (âˆ’3Ïƒ) âˆ¼
= J /J [3]
Now let us suppose that we have a logarithmic connection âˆ‡P on Ï€ whose KodairaSpencer morphism at Ïƒ is an isomorphism. Then we get a commutative diagram like the
one preceding Theorem 1.7. Pulling back by Î±R , then Î, and ï¬nally by Ïƒ L , we thus see
that âˆ‡P induces an isomorphism:
Î¶(âˆ‡P ) : OP (âˆ’Ïƒ)/OP (âˆ’3Ïƒ) âˆ¼
= J /J [3]
Now we saw above (Theorem 1.7) that âˆ‡P deï¬nes a Schwarz structure. But one â€œloose
endâ€ relative to the statement of Theorem 1.7 is that although Schwarz structures have no
automorphisms, triples consisting of projective bundles with a section and a connection can
have automorphisms. These automorphisms were the cause of the phenomenon (observed
just before the statement of Theorem 1.9) that many diï¬€erent âˆ‡P can give rise to the same
Schwarz structure. Thus, it is convenient to have some sort of notion of a â€œnormalized
âˆ‡P â€ such that each Schwarz structure arises from a unique normalized âˆ‡P . We choose
the normalization as follows:
Deï¬nition 1.10. We say that âˆ‡P is normalized if Î³ and Î¶(âˆ‡P ) are inverse to each
other.
Now as a formal consequence of this deï¬nition, we observe that we obtain the following
normalized version of Theorem 1.7:
39

Theorem 1.11. If f : U â†’ S is as above, then there is a natural one-to-one correspondence between crystalline Schwarz structures on U log and normalized logarithmic connections on the P1 -bundle Ï€ : P(J /J [3] ) â†’ U whose associated Kodaira-Spencer morphism
at the section Ïƒ : U â†’ P (deï¬ned by J /J [3] â†’ J /J [2] ) is an isomorphism. Moreover,
under this correspondence, the crystalline Schwarz structures with nilpotent monodromy
correpond precisely to the triples such that âˆ‡P has nilpotent monodromy at the marked
points.
The Schwarzian Derivative
Before proceeding, it is interesting to note that, as the name suggests, a crystalline
Schwarz structure S allows one to deï¬ne a Schwarzian derivative dS , as follows. Let
Ã—
Ï‰U
log /S log âŠ† Ï‰U log /S log denote the subsheaf consisting of sections that locally generate
#
âŠ† OU be the subsheaf consisting of functions Ï† such
Ï‰U log /S log as an OU -module. Let OU
Ã—
that dÏ† is a section of Ï‰U log /S log âŠ† Ï‰U log /S log . Then our Schwarzian derivative will be a
morphism of sheaves of sets:
#
âŠ—2
dS : OU
â†’ Ï‰U
log /S log
#
Let Î¸ be a section of OU
over some eÌtale V â†’ U . Let us denote by jÎ¸ âˆˆ J /J [3] (V ) the 2jet of Î¸ (i.e., the Taylor expansion out to second order, modulo the constant term). By the
#
deï¬nition of OU
, the image of jÎ¸ in J /J [2] (V ) is a local generator of the sheaf J /J [2] . By
Proposition 1.6, jÎ¸ then deï¬nes a section sÎ¸ : V â†’ PS . Taking the Kodaira-Spencer map
of this section then deï¬nes an OV -linear morphism from Ï„U log /S log to the conormal bundle
to sÎ¸ , which is simply Ï‰U log /S log . This OV -linear morphism is thus given by multiplication
âŠ—2
by a section of Ï‰U
log /S log , which we take to be dS (Î¸). A simple calculation reveals that

Proposition 1.12. If (as in Theorem 1.9) one modiï¬es the Schwarz structure S by
log âŠ—2
) (âˆ’D)](U ) to obtain a Schwarz structure S  ,
adding the square diï¬€erential Î´ âˆˆ [(Ï‰U/S
then dS (Î¸) = dS  (Î¸) + Î´.
We also have a biformal version of the Schwarzian derivative. Namely, we let O #bi be
U
the subsheaf of OU bi consisting of biformal functions Ï† that are of the form u + c, where u
is a biformal uniformizer, and c is a biformal constant. Then we get a morphism of sheaves
of sets:
#
âŠ—2
âŠ—2
L
dbi
S : O bi â†’ (Ï‰U log /S log ) = Ï‰U log /S log âŠ—OU OU bi
def

U

deï¬ned as follows: If Î¸ is a section of O #bi over some eÌtale V â†’ U , we let jÎ¸ be the
U

section of J /J [3] âŠ—OU OU bi which is the 2-jet of Î¸. Thus, jÎ¸ deï¬nes a section of sÎ¸ of PSL
40

âŠ—2
L
whose Kodaira-Spencer map is given by multiplication by a section of (Ï‰U
log /S log ) , which
bi
we take as dbi
S (Î¸). Note that dS (iL (Î¸)) = iL (dS (Î¸)), and that if we modify the Schwarz
structure by adding a square diï¬€erential Î´, then

bi
dbi
S (Î¸) = dS  (Î¸) + iL (Î´)

Remark. In the Appendix to this Chapter, we show that the deï¬nition just given for the
Schwarzian derivative coincides with one-half the classical Schwarzian derivative, when U
is the projective line.
For the biformal version of the Schwarzian, we have an analogue of the classical
result that the Schwarzian vanishes exactly on the formal functions that make up the
projective structure of a Riemann surface. Indeed, let Î : PSL â†’ PSR be the isomorphism
deï¬ned by the connection âˆ‡PS ; let Î±R : PSR â†’ PS be the natural projection; and let
def

Î¶ : U bi = Spec(OU bi ) â†’ PS be the morphism obtained by composing ÏƒSL : U bi â†’ PSL with
Î and then Î±R . Since the deï¬nition of dS is functorial, dS applied to a function pulled back
by Î¶ is Î¶ âˆ’1 of the â€œdS â€ computed for projective bundles in the Appendix, i.e., one-half the
classical Schwarzian. Thus, if Î¸ is a section of S, then Î¸ is the pull-back by Î¶ of a (degree
â‰¤ 1) relative rational function for PS â†’ U , so dbi
S (Î¸) = 0.
bi
Conversely, suppose that dbi
S (Î¸) = 0. Then the statement that dS (Î¸) = 0 means
L
that sÎ¸ is a horizontal section of PS . Thus it follows from the deï¬nition of a connection,
together with the PoincareÌ Lemma in crystalline cohomology (see, e.g., [Kato], Â§6 for the
log version) that Î(sÎ¸ ) is the pull-back via Î±R of a section tÎ¸ of PS . Now (after possible
eÌtale localization), we can ï¬nd a (degree â‰¤ 1) relative rational function Ï† for PS â†’ U
whose 2-jet at ÏƒS is given by the section tÎ¸ . Since Î¶ maps the diagonal in U bi to ÏƒSR , and
def

the formation of 2-jets is functorial, it thus follows that the 2-jet of Ïˆ = Î¶ âˆ’1 (Ï†) deï¬nes
a section sÏˆ of PSL which is equal to sÎ¸ when restricted to the diagonal U âŠ† U bi . But
since both sÏˆ and sÎ¸ are horizontal, they must be equal. The biformal functions Ïˆ and
Î¸ thus have 2-jets that deï¬ne the same â€œlineâ€ in J /J [3] . Let z be a local coordinate on
U . Let us denote by successive primes the derivatives of biformal functions (i.e., taken on
the left) with respect to z. Then we obtain that Ïˆ  and Î¸  are both invertible biformal
functions such that Ïˆ  Â· Î¸  = Ïˆ  Â· Î¸  . It thus follows that (Ïˆ  /Î¸  ) = 0, so Î¸  = a Ïˆ  , where
a is an invertible biformal constant. Thus, Î¸ = a Ïˆ + b, where b is a biformal constant.
Since, by construction Ïˆ âˆˆ S(V ), it follows that Î¸ âˆˆ S(V ). Thus, we obtain the following
â€œcrystalline Schwarzian PoincareÌ Lemma:â€
Theorem 1.13. If Î¸ is a biformal function, then dbi
S (Î¸) = 0 if and only if Î¸ is a section
of S.

41

Â§2. Indigenous Bundles
In this Section, we globalize the local considerations of Â§1, and are thus led to introduce
â€œindigenous bundlesâ€ (as in [Gunning]). Let S log be a ï¬ne log scheme, whose underlying
scheme is connected noetherian. Let f log : X log â†’ S log be proper, geometrically connected,
and locally stable of dimension one. (Note that the ï¬rst two conditions are actually
conditions on the underlying scheme morphism f .) We assume that the ï¬bers of f : X â†’ S
have arithmetic genus g â‰¥ 0, and exactly r â‰¥ 0 marked points (as in Deï¬nition 1.1 â€“ note
that these may only be deï¬ned eÌtale locally, however).
Basic Deï¬nitions and Examples
If 2g âˆ’ 2 + r â‰¥ 1, then let Mg,r be the moduli stack of stable curves of genus g,
with r marked points, over Z, and let Î¶ : C â†’ Mg,r be the universal curve, with its r
marked points s1 , . . . , sr : Mg,r â†’ C. Note that Mg,r has a natural log structure given
log

by the divisor at inï¬nity. Denote the resulting log stack Mg,r . Also, by taking the divisor
which is union of the si and the pull-back of the divisor at inï¬nity of Mg,r , we get a log
structure on C; we call the resulting log stack C log . Also, Î¶ : C â†’ Mg,r extends naturally
log

to a morphism of log stacks Î¶ log : C log â†’ Mg,r .
Deï¬nition 2.1. We shall say that f log : X log â†’ S log is stable if there exists a classifying
log
morphism Ï†log : S log â†’ Mg,r such that X log âˆ¼
= S log Ã—Mlog C log .
g,r

Ultimately, we shall be concerned mainly with the case where f log is stable, but it is useful
to realize that the deï¬nition, as well as many of the ï¬rst properties, of indigenous bundles
can be made without these assumptions.
Let Ï€ : P â†’ X be a P1 -bundle. If Ïƒ : X â†’ P is a section, then we call the canonical
height of Ïƒ the number 12 degX/S (Ïƒ âˆ— Ï„P/X ), where degX/S denotes the relative degree over S
of a line bundle on X, and Ï„P/X is the relative tangent bundle of Ï€. If âˆ‡P is a logarithmic
connection on P , then we call the morphism Ï„X log /S log â†’ Ïƒ âˆ— Ï„P/X given by diï¬€erentiating
Ïƒ by means of âˆ‡P the Kodaira-Spencer morphism at Ïƒ relative to âˆ‡P . Often, instead of
dealing with P1 -bundles with logarithmic connections, it will be more convenient to deal
vector bundles: Thus, let E be a vector bundle equipped with a logarithmic connection
âˆ‡E , whose rank is two and whose determinant is trivial. Then Theorem 1.7 motivates the
following
Deï¬nition 2.2. We shall say that (Ï€ : P â†’ X, âˆ‡P ) is an indigenous bundle on X log if
the monodromy at the marked points (which exist eÌtale locally) is nilpotent, and there
exists a section Ïƒ : X â†’ P of Ï€ such that the Kodaira-Spencer morphism at Ïƒ with
respect to âˆ‡P is an isomorphism. We shall say that (E, âˆ‡E ) is an indigenous vector bundle
42

on X log if the associated P1 -bundle with logarithmic connection (P(E) â†’ X, âˆ‡P(E) ) is an
indigenous P1 -bundle. We shall say that P â†’ X (respectively, E) is intrinsic if there exists
a logarithmic connection âˆ‡P (respectively, âˆ‡E ) on P â†’ X (respectively, E) that makes
(P â†’ X, âˆ‡P ) (respectively, (E, âˆ‡E )) indigenous. We shall say that P â†’ X (respectively,
E) is locally intrinsic if it is intrinsic eÌtale locally on S.
Thus, in the vector bundle case, (E, âˆ‡E ) is indigenous if âˆ‡E has nilpotent monodromy
at the marked points, and there exists a rank one subbundle F 0 (E) âŠ† E such that the
Kodaira-Spencer morphism F 0 (E) â†’ Ï‰X log /S log âŠ—OX (E/F 0 (E)) (induced by âˆ‡E ) is an
isomorphism.
So far we have been discussing the hyperbolic case (2g âˆ’ 2 + r â‰¥ 1); however, one can
make the same deï¬nition for curves that are not hyperbolic.
Example 1.
Suppose that f : X â†’ S is smooth, with no marked points, and that
g = 0. Thus, f is a P1 -bundle. Then the P1 -bundle given by X Ã—S X â†’ X has a natural
trivial connection, together with a natural section, the diagonal section. It is trivial to see
that this triple satisï¬es the required properties for an indigenous bundle.
Example 2. Suppose that f log : X log â†’ S log has no marked points, and that its ï¬bers
all have arithmetic genus one. Then consider the bundle E = Ï‰X/S âŠ• OX (where Ï‰X/S
is the relative dualizing sheaf). Let L = fâˆ— Ï‰X/S . Thus, L is a line bundle on S, and
f âˆ—L âˆ¼
= Ï‰X/S . In particular, there exists on Ï‰X/S a â€œtrivial connectionâ€ âˆ‡Ï‰ obtained from
tensoring the trivial connection on OX with f âˆ— L. Let âˆ‡E be the connection on E which
is the direct sum of âˆ‡Ï‰ and the trivial connection on OX . Let âˆ‡E be the connection on
E given by adding to âˆ‡E the section of End(E) âŠ— Ï‰X/S given by projecting E â†’ Ï‰X/S âˆ¼
=
(0, OX ) âŠ— Ï‰X/S âŠ† E âŠ— Ï‰X/S . Then one checks easily that if we take (P, âˆ‡P ) = P(E, âˆ‡E ),
and Ïƒ : X â†’ P to be given by (Ï‰X/S , 0) âŠ† E, then we obtain an indigenous bundle on
X log .
Example 3.
Let S log = Spec(Z) (with the trivial log structure); X log = M1,1 (the
moduli stack of one-pointed curves of genus one over Z), with its natural log structure.
Let E be the vector bundle of rank two on X which is the ï¬rst de Rham cohomology
module of the universal one-pointed curve of genus one. Then E has a natural logarithmic
connection âˆ‡E , the so-called â€œGauss-Manin connection.â€ There is also a natural Hodge
def
ï¬ltration F 1 (E) âŠ† E, which deï¬nes a section Ïƒ : X â†’ P = P(E). The pair (E, âˆ‡E ) forms
the prototypical example of an indigenous bundle on X log .
First Properties
We now proceed to examine basic properties of such bundles.
43

Proposition 2.3. If f log : X log â†’ S log and hlog : Y log â†’ S log are as stipulated at the
beginning of the Section, and Î¶ log : Y log â†’ X log is a log eÌtale morphism of log schemes
over S log that sends marked points to marked points, then the pull-back via Î¶ log of any
indigenous bundle is again indigenous.
Proof. This follows from the deï¬nitions. 
Proposition 2.4. If Ï€ : P â†’ X is intrinsic, then the section Ïƒ : X â†’ P is of canonical
height 1 âˆ’ g âˆ’ 12 r. If X log â†’ S log is a stable curve (so, in particular, 2g âˆ’ 2 + r â‰¥ 1),
then Ïƒ is the unique section of Ï€ of canonical height 1 âˆ’ g âˆ’ 12 r. We shall refer to Ïƒ as the
Hodge section of Ï€ : P â†’ X.
Proof. The fact that the canonical height of Ïƒ is 1 âˆ’ g âˆ’ 12 r follows from the fact that the
Kodaira-Spencer morphism is an isomorphism. Now suppose that X log â†’ S log is stable.
Let us ï¬rst assume that S is the spectrum of an algebraically closed ï¬eld. Suppose that
Ïƒ  : X â†’ P also has canonical height 1âˆ’g âˆ’ 12 r. Then it follows that its restriction to some
irreducible component of X has negative canonical height. Since the restriction of Ïƒ âˆ— Ï„P/X
to any irreducible component has negative degree, it follows immediately from considering
intersection numbers on P , together with the deï¬nition of â€œcanonical height,â€ that there
cannot exist two distinct sections of negative canonical height over that irreducible component. Thus, Ïƒ and Ïƒ  must agree over that irreducible component. Now if there are
any other irreducible components in X, then Ïƒ  must have negative canonical height over
some other irreducible component of X, in order for its canonical height over all of X to
be 1 âˆ’ g âˆ’ 12 r. Thus, repeating this argument shows that Ïƒ = Ïƒ  . Finally, let us observe
that the space of deformations of Ïƒ is given by H 0 (X, Ïƒ âˆ— Ï„P/X ), which is zero, since Ïƒ âˆ— Ï„P/X
has negative degree on every irreducible component of X. The result for general S then
follows immediately from this by deformation theory. 
Now let us assume for the rest of the Section (unless stated otherwise) that there
exists an odd prime p which is nilpotent on S, together with a PD-ideal I âŠ† OS .
Proposition 2.5. If Ï€ : P â†’ X is intrinsic, then P âˆ¼
= P(J /J [3] ) (where J deï¬nes the
diagonal in X bi ). Moreover, for any connection on Ï€ that makes it indigenous, the monodromy at a marked point s : S â†’ X ï¬xes the section qs : S â†’ P(J /J [3] ) of Proposition
1.6.
Proof. This follows from Theorem 1.7 and Propositions 1.3 and 1.6. Note that the second
statement uses the fact that p is odd.
Proposition 2.6. Suppose that the number of marked point plus nodes on any geometric
irreducible component of a ï¬ber of X â†’ S is even. Let (Ï€ : P â†’ X, âˆ‡P ) be indigenous on
44

X log . Then eÌtale locally on S, there exists an indigenous vector bundle (E, âˆ‡E ) on X log
whose projectivization is (Ï€ : P â†’ X, âˆ‡P ). Moreover, such an (E, âˆ‡E ) is unique up to
tensor product with a line bundle with connection (L, âˆ‡L ) on X whose square is trivial.
Proof. Consider the relative anticanonical bundle Ï„P/X on P . By Proposition 2.5, (after
eÌtale localization on S) there exists a line bundle G on P whose square is Ï„P/X . Now
let us note that since the construction of the anticanonical bundle is canonical, it follows
that the connection âˆ‡P on the P1 -bundle induces a connection on the polarized P1 -bundle
(Ï€ : P â†’ X, Ï„P/X ). Moreover, since the â€œmoduli spaceâ€ of line bundles G whose square
is Ï„P/X is eÌtale over X, it follows that the connection âˆ‡P on the P1 -bundle Ï€ : P â†’ X
in fact induces a connection on the polarized P1 -bundle (Ï€ : P â†’ X, G). Thus, we
def

get a connection âˆ‡E on E = Ï€âˆ— G. Moreover, on P , we have a natural exact sequence
0 â†’ Ï‰P/X â†’ (Ï€ âˆ— E) âŠ— G âˆ’1 â†’ OP â†’ 0, which induces an isomorphism det(Ï€ âˆ— E) âˆ¼
= OP ,
hence an isomorphism det(E) âˆ¼
= OX , which is easily seen to be horizontal. Finally, it is
clear that the projectivization of (E, âˆ‡E ) is isomorphic to (Ï€ : P â†’ X, âˆ‡P ).
Now suppose that both (E, âˆ‡E ) and (E  , âˆ‡E  ) have the same projectivization (Ï€ : P â†’
X, âˆ‡P ). Then E deï¬nes a line bundle G on P whose square is Ï„P/X and such that âˆ‡P
induces a connection on the polarized P1 -bundle (Ï€ : P â†’ X, G). Similarly, E  deï¬nes a line
bundle G  on P . Since we have horizontal isomorphisms G âŠ—2 âˆ¼
= Ï„P/X and (G  )âŠ—2 âˆ¼
= Ï„P/X ,
 âˆ’1
it follows that if we let L = Ï€âˆ— ((G ) âŠ— G), then L gets a natural connection âˆ‡L such that
the square of (L, âˆ‡L ) is trivial. Moreover, (E, âˆ‡E ) âˆ¼
= (E  , âˆ‡E  ) âŠ— (L, âˆ‡L ). This completes
the proof. 
In summary, the above Proposition tells us that (under the evenness assumption) up to
eÌtale localization on the base, it is essentially the same thing to give an indigenous P1 bundle or an indigenous vector bundle. Thus, in the future, we shall frequently simply
speak of â€œindigenous bundles.â€ The same goes for intrinsic bundles.
Existence and de Rham Cohomology
The next step is to prove the existence of indigenous bundles, and to parametrize
them. We begin with the proof of existence. For the rest of this Section, we shall assume
that f log is stable. Thus, in particular, 2g âˆ’ 2 + r â‰¥ 1.
Theorem 2.7. For any r-pointed stable curve X log â†’ S log of genus g, the P1 -bundle
P(J /J [3] ) is locally intrinsic.
Proof. From Theorem 1.9, we know that the obstruction to the existence of a crystalline
Schwarz structure with nilpotent monodromy on X log (locally on S) is given by a section
log âŠ—2
log âŠ—2
of R1 fâˆ— (Ï‰X/S
) (âˆ’D) over S. On the other hand, by Serre duality, R1 fâˆ— (Ï‰X/S
) (âˆ’D)
45

is isomorphic to the dual of fâˆ— Ï„X log /S log = 0, since the curve is stable. The Theorem now
follows form Proposition 1.6 and Theorem 1.7. 
Next we wish to compute the de Rham cohomology of the P1 -bundle with parabolic
structure (Ï€; qi ). Note that the exterior diï¬€erential operator maps Ad(P ) (respectively,
Adq (P )) into Adq (P ) (respectively, Adc (P )). We deï¬ne the parabolic de Rham cohomology
(respectively, with compact supports) of Ad(P ) to be the hypercohomology of the complex
log
log
(respectively, Adq (P ) â†’ Adc (P ) âŠ— Ï‰X/S
).
Ad(P ) â†’ Adq (P ) âŠ— Ï‰X/S
Theorem 2.8. Let (P, âˆ‡P ) be an indigenous bundle on an r-pointed stable curve f log :
X log â†’ S log of genus g. Then the de Rham cohomology of Ad(P ) with its natural connection (induced by âˆ‡P ) is as follows:
(1) For cohomology without compact supports, we have (fDR )âˆ— (Ad(P )) =
R2 (fDR )âˆ— (Ad(P )) = 0; and we have a natural exact sequence
log âŠ—2
) (âˆ’D) â†’ R1 (fDR )âˆ— (Ad(P )) â†’ R1 fâˆ— Ï„X log /S log â†’ 0
0 â†’ fâˆ— (Ï‰X/S

(2) For cohomology with compact supports, we have (for all i â‰¥ 0) a natural
isomorphism
Ri (fDR )c,âˆ— (Ad(P )) âˆ¼
= Ri (fDR )âˆ— (Ad(P ))

In particular, (P ; âˆ‡P ) has no nontrivial automorphisms.
Proof. To compute the de Rham cohomology, one uses the long exact cohomology sequences induced by the ï¬ltrations considered above, plus the fact that the Kodaira-Spencer
morphism is an isomorphism. Now let Î± be an automorphism. Since (fDR )âˆ— (Ad(P )) = 0,
all inï¬nitesimal automorphisms must vanish, so we may work over an algebraically closed
ï¬eld. By passing to a tamely ramiï¬ed covering of X ramiï¬ed only at the marked points
and nodes, we may assume that the hypotheses of Proposition 2.6 are satisï¬ed. Then let
L be a line bundle on P whose square is Ï„P/X . Since L âˆ¼
= OP (Ïƒ) âŠ—OS M (for a line bundle
M on S), and Î± always preserves Ïƒ, it follows that Î± preserves L. Thus, Î± arises from a
horizontal section of End(Ï€âˆ— L) = OX âŠ• Ad(P ), hence is induced by multiplying Ï€âˆ— L by a
section of OS . Thus, Î± is the identity, as desired. 
Finally, combining what we have done in this Section with Theorem 1.7, we obtain:
Corollary 2.9. Let f log : X log â†’ S log be an r-pointed stable curve of genus g. Then
the set of crystalline Schwarz structures on X with nilpotent monodromy is in one-to-one
46

correspondence the set of isomorphism classes of indigenous P1 -bundles on X log . Moreover, the functor that assigns to T log â†’ S log the set of crystalline Schwarz structures with
log âŠ—2
) (âˆ’D).
nilpotent monodromy on XTlog = X log Ã—S log T log is a torsor over fâˆ— (Ï‰X/S
Indigenous Bundles of Restrictable Type
Let filog : Xilog â†’ S log (for i = 1, . . . , n) be an ri -pointed smooth curve of genus gi
(where 2gi âˆ’ 2 + ri â‰¥ 1 for all i). Suppose that we are given a graph Î“ consisting of n
vertices, numbered 1 through n. Let Ei be the set of edges of the ith vertex. Suppose
further that we are given an injection Î»i : Ei â†’ {1, . . . , ri }. Then we can glue together
the curves filog : Xilog â†’ S log to form an r-pointed stable curve f log : X log â†’ S log of genus
g in such a way that the dual graph of f log is given by Î“, that is:
(1) vertex i corresponds to filog : Xilog â†’ S log , an irreducible component of
X log ;
(2) if is an edge running from vertex i to vertex j such that Î»i ( ) = a
and Î»j ( ) = b, then corresponds to a node on X log obtained by gluing
together Xilog at the ath marked point to Xjlog at the bth marked point;
(3) g and r can be computed combinatorially from Î“, the gi â€™s, the ri â€™s and
the Î»i â€™s.
: Xilog â†’ X log be the inclusion of Xilog into X log as one of the irreducible
Let Î¼log
i
components.
Now let us suppose that we are given an indigenous bundle (Ï€ : P â†’ X; âˆ‡P ) on X log .
log
âˆ—
Then it is not necessarily the case that (Î¼log
i ) (Ï€ : P â†’ X; âˆ‡P ) will be indigenous on Xi .
The problem is that since in general, marked points of Xilog might be sent to nodes of X log
(and not to marked points), there is no reason why the monodromy at such marked points
of Xilog should be nilpotent. We therefore make the following
log
âˆ—
Deï¬nition 2.10. If the (Î¼log
for all i, then we
i ) (Ï€ : P â†’ X; âˆ‡P ) are indigenous on Xi
say that (Ï€ : P â†’ X; âˆ‡P ) is of restrictable type.

Now let us suppose that we are given indigenous bundles Î i = (Ï€i : Pi â†’ Xi ; âˆ‡Pi )
on Xilog . Note that for each marked point s : S â†’ Xi of an Xilog , sâˆ— Pi has a canonical
trivialization as a P1 -bundle given by considering:
(1) the Hodge section Ïƒi : Xi â†’ Pi (pulled-back by s);
(2) the trivialization of sâˆ— (Ïƒiâˆ— Ï‰Pi /Xi ) given by the residue map; and
(3) the section qs : S â†’ sâˆ— Pi of Proposition 1.6.
47

It thus follows that we can glue together the Î i â€™s by means of this canonical trivialization
at the marked points to obtain an indigenous bundle Î  = (Ï€ : P â†’ X; âˆ‡P ) on X log .
Moreover, by construction, Î  is of restrictable type.
Also, we can clearly reverse the procedure: Namely, if we start with an indigenous
bundle Î  on X log of restrictable type, we can reconstruct Î  by restricting to the Xilog â€™s,
and then regluing, in the fashion described in the preceding paragraph. Now let us deï¬ne
n

(fi )âˆ— Ï‰ âŠ—2log

def

E =

Xi

i=1

/S log

(âˆ’Di )

where Di is the divisor of marked points on Xi . Then we have the following result:
Proposition 2.11. The eÌtale sheaf on S of isomorphism classes of indigenous P1 -bundles
of restrictable type on X log is a torsor over the vector bundle E.
Note that the rank of E is given by
than 3g âˆ’ 3 + r.

n

i=1 (3gi âˆ’ 3 + ri ), which, in general, is strictly less

Â§3. The Obstruction to Global Intrinsicity
In Â§2, we saw that the P1 -bundle P(J /J [3] ) is locally intrinsic on Mg,r . In this
Section, we study the obstruction (which, in general, is nonzero) to it being globally
intrinsic over all of Mg,r . The main point is a computation in Hodge cohomology which,
in many respects, is similar to that of [Falt3], Lemma IV.4. Since, however, it is not
literally the same as [Falt3], and certain technical aspects of the computation are diï¬€erent,
we provide a complete proof here.
Introduction of Cohomology Classes
We shall work over a ï¬eld K of characteristic zero, say Qp , until we state otherwise.
Since we are only interested in certain intersection numbers, the base ï¬eld is essentially
irrelevant. Let us consider the universal r-pointed stable curve of genus g, Î¶ : C â†’ Mg,r
(over K). We would like to consider various cohomology classes on C and Mg,r . The
cohomology theory that we will use is Hodge theory, so all cohomology classes are to be
understood as being Hodge-theoretic. Let Ï€ : P = P(J /J [3] ) â†’ C be the P1 -bundle
which, as we saw in Â§2, is locally intrinsic. Let F = Ad(P ). Thus, F has a ï¬ltration whose
subquotients are given by:
F1 âˆ¼
= L; F 0 /F 1 âˆ¼
= OC ; F âˆ’1 /F 0 âˆ¼
= Lâˆ’1
48

where L = Ï‰C log /Mlog . Let Î· = c1 (L), the ï¬rst Chern class of L. Then we have: c1 (F) = 0.
g,r

On the other hand, the second Chern class of F is given by:
c2 (F) = âˆ’Î· 2

2
Let
r us compute Î¶âˆ— Î· . Let Di âŠ† C (where i = 1, . . . , r) be the marked points. Let
D = i=1 Di . We shall write [Di ]; [D] for the respective cohomology classes on C. Let
Î¾ = c1 (Ï‰C/Mg,r ). Thus, Î· = Î¾ + [D]. Since diï¬€erent Di â€™s do not intersect, we have
[Di ] Â· [Dj ] = 0 if i = j. Also, by â€œtaking the residue,â€ we see that
Î¶âˆ— {(Î¾ + [Di ]) Â· [Di ]} = 0,
r
for all i. Thus, Î¶âˆ— {(Î¾ + [D]) Â· [D]} = 0. Let Ïˆi = Î¶âˆ— (Î¾ Â· [Di ]); Ïˆ = i=1 Ïˆi ; Î¸ = Î¶âˆ— Î¾ 2 . Then
we obtain:

Î¶âˆ— Î· 2 = Î¶âˆ— {(Î¾ + [D]) Â· Î¾}
=Î¸+Ïˆ
Now one knows from [AC] that for g â‰¥ 3, the restrictions of the classes Î¸ and Ïˆ to Mg,r
are linearly independent. We summarize this in a Lemma:
Lemma 3.1. We have, on Mg,r , Î¶âˆ— Î· 2 = Î¸ + Ïˆ. In particular, if g â‰¥ 3, then (Î¶âˆ— Î· 2 )|Mg,r
is nonzero.
We shall see below that Î¶âˆ— c2 (F) can be related to the obstruction to the existence of a
global indigenous bundle on C. Thus, once we have done this, we will have proven that
this obstruction is given by the relatively computable cohomology class âˆ’Î¶âˆ— Î· 2 on Mg,r .
Computation of the Second Chern Class
Let us ï¬rst observe that P |D has a canonical trivialization as a P1 -bundle given by
using:
(1) the Hodge section Ïƒ : C â†’ P (restricted to D);
(2) the trivialization of (Ïƒ âˆ— Ï‰P/C )|D given by the residue map; and
(3) the section qs : D â†’ P Ã—C D of Proposition 1.6.
Let us denote by Cclog the log stack obtained by letting C be the underlying stack and
log
taking for the log structure the pull-back of the log structure of Mg,r via Î¶. Thus, we have
an exact sequence on C:
0 â†’ Î¶ âˆ— Î©Mlog â†’ Î©Cclog â†’ Ï‰C/Mg,r â†’ 0
g,r

49

where the ï¬rst two sheaves of diï¬€erentials are over K. In the future, we shall think of this
exact sequence as deï¬ning a one-step ï¬ltration on Î©Cclog . For i, j â‰¥ 0, let us deï¬ne for any
OC -module G:
def

Hci,j (C, G) = H i (C, G âŠ—OC âˆ§j Î©Cclog )
This cohomology is a sort of cohomology with compact supports outside D. Thus, by using
the canonical trivialization of P |D referred to above, we see that the global obstruction to
the existence of a logarithmic connection on Ï€ : P â†’ C (for the log structure of C log ) which
has normalized nilpotent monodromy at D deï¬nes a class Îº âˆˆ Hc1,1 (C, Ad(P )). Now, by
taking the trace of the square of Îº, we get a class in tr(Îº2 ) âˆˆ Hc2,2 (C, OC ). If we then apply
log

def

Î¶âˆ— , we get a class Î¶âˆ— tr(Îº2 ) âˆˆ H 1,1 (Mg,r ) = H 1 (Mg,r , Î©Mlog ). On the other hand, let us
g,r

denote by:
S g,r â†’ Mg,r
the Î©Mlog -torsor deï¬ned by looking at the crystalline Schwarz structures with nilpotent
g,r

log

monodromy on C (as in Corollary 2.9). This torsor thus deï¬nes a class Î£ âˆˆ H 1,1 (Mg,r ).
The goal of this subsection is to prove the following:
log

Lemma 3.2. We have the following equality of classes in H 1,1 (Mg,r ): Î£ = 12 Î¶âˆ— tr(Îº2 ).
Now let us note that Hc1,1 (C, Ad(P )) has two one-step ï¬ltrations: one arising from
the Leray-Serre spectral sequence applied to Î¶, and the other arising from the ï¬ltration
deï¬ned above on Î©Cclog . Thinking in these terms, we see that we get a morphism:
Ï†00 : Hc1,1 (C, Ad(P )) â†’ H 0 (Mg,r , R1 Î¶âˆ— (Ad(P ) âŠ— Ï‰C/Mg,r ))
Now since we know that P â†’ C admits a connection of the desired type on the ï¬bers of Î¶,
it follows that Ï†00 (Îº) = 0.
Next let us consider the natural morphism:
Ï†10 : Hc1,1 (C, Ad(P )) â†’ H 1 (C, Ad(P ) âŠ— Ï‰C/Mg,r )
Since Ï†00 (Îº) = 0, it follows from considering the Leray-Serre spectral sequence that Ï†10 (Îº)
lies in H 1 (Mg,r , Î¶âˆ— (Ad(P ) âŠ— Ï‰C/Mg,r )) â†’ H 1 (C, Ad(P ) âŠ— Ï‰C/Mg,r ). In fact, by considering only normalized connections (as in Deï¬nition 1.10), we can say more. Namely, it
follows that Ï†10 (Îº) is actually the image under the morphism H 1 (Mg,r , Î¶âˆ— (Ï‰C log /Mlog âŠ—
g,r

Ï‰C/Mg,r )) â†’ H (Mg,r , Î¶âˆ— (Ad(P ) âŠ— Ï‰C/Mg,r )) (induced by Ï‰C log /Mlog â†’ Ad(P )) of the
1

g,r

50

class Î£ (regarded as a class in H 1 (Mg,r , Î¶âˆ— (Ï‰C log /Mlog âŠ— Ï‰C/Mg,r )) by means of the tautog,r
logical isomorphism Î© log âˆ¼
)).
log âŠ— Ï‰
= Î¶âˆ— (Ï‰
Mg,r

C/Mg,r

C log /Mg,r

Now let us consider the natural morphism:
Ï†01 : Hc1,1 (C, Ad(P )) â†’ H 0 (Mg,r , R1 Î¶âˆ— (Ad(P ) âŠ— Î©Cclog ))
Since Ï†00 (Îº) = 0, it follows that the section Ï†01 (Îº) of R1 Î¶âˆ— (Ad(P ) âŠ— Î©Cclog ) lies in the
image of the natural map
Î¹ : R1 Î¶âˆ— (Ad(P ) âŠ— Î©Mlog ) â†’ R1 Î¶âˆ— (Ad(P ) âŠ— Î©Cclog )
g,r

In fact, we can say more. Since we are dealing with sheaves on Mg,r , we can compute
locally on Mg,r . Let U â†’ Mg,r be eÌtale. Let âˆ‡P be a logarithmic connection with
normalized nilpotent monodromy (relative to Î¶U : CU â†’ U ) on PU = P Ã—Mg,r U . Then the
obstruction to lifting âˆ‡P to a logarithmic connection relative to CU â†’ Spec(K) is giving by
subtracting the two pull backs of (PU â†’ U ; âˆ‡P ) to the ï¬rst inï¬nitesimal neighborhood Î”U
of the diagonal of U Ã—K U . Note that it only makes sense to compare these two pull-backs
because we have chosen a connection âˆ‡P , so that we can deal with crystals on Crys(CU /Î”U )
(where the structure morphism CU â†’ Î”U is given by composing Î¶U : CU â†’ U with the
diagonal embedding U â†’ Î”U ). Thus, the diï¬€erence between the pull-backs deï¬nes a
section Î´ (over U ) of Î©Mlog |U âŠ—R1 (Î¶U )DR,âˆ— (Ad(P ), âˆ‡P ). Now if we compose the projection
g,r

R1 (Î¶U )DR,âˆ— (Ad(P ), âˆ‡P ) â†’ R1 (Î¶U )âˆ— Ï„C log /U log with Î´, we get a morphism
U

(Î©Mlog )âˆ¨ |U = Î˜Mlog |U â†’ R1 (Î¶U )âˆ— Ï„C log /U log
g,r

U

g,r

Now it is a tautology that this morphism is none other than the isomorphism Î² derived
log
from deformation theory of the tangent space to Mg,r with the ï¬rst cohomology group
of the relative tangent bundle of Î¶ log . Thus, in summary, we have proven the following
statement:
(*) locally on Mg,r , Ï†10 (Îº) is the image under Î¹ of some local section
Î½ of R1 Î¶âˆ— (Ad(P ) âŠ— Î©Mlog ) whose image in R1 Î¶âˆ— (Ï„C log /Mg,r ) âŠ— Î©Mlog is
g,r

g,r

the tautological isomorphism Î².
We are now ready to consider Î¶âˆ— tr(Îº2 ). We begin by using the observations of the
preceding two paragraphs to compute what happens when we multiply various subquotients
of the two ï¬ltrations on Hc1,1 (C, Ad(P )) by each other:
(1) If we multiply two elements in the image of H 1 (Mg,r , Î¶âˆ— (Ad(P )) âŠ—
Î©Mlog ), and take the trace, we get a (2, 2)-Hodge cohomology class on
g,r

51

C which is the pull-back of such a class on Mg,r ; thus, if we apply Î¶âˆ— to
such a product, we get zero.
(2) If we multiply an element in the image of H 1 (Mg,r , Î¶âˆ— (Ad(P ))âŠ—Î©Mlog )
g,r

by an element in the image of H 0 (Mg,r , R1 Î¶âˆ— (Ad(P ))âŠ—Î©Mlog ), and take
g,r

the trace, we get a class in H 1 (Mg,r , R1 Î¶âˆ— OC âŠ— âˆ§2 Î©Mlog ); since there
g,r

are no factors of Ï‰C/Mg,r in the wedge product, applying Î¶âˆ— again gives
zero.
(3) If we multiply two elements of H 0 (Mg,r , R1 Î¶âˆ— (Ad(P )) âŠ— Î©Mlog ), we
g,r

get zero since Î¶ has relative dimension one.
(4) If we multiply an element in the image of H 1 (Mg,r , Î¶âˆ— (Ad(P ))âŠ—Î©Mlog )
g,r

by Ï†10 (Îº) âˆˆ H (Mg,r , Î¶âˆ— (Ad(P ) âŠ— Ï‰C/Mg,r )), and take the trace, we get
zero, since we are taking the trace of the product of a nilpotent section
of Ad(P ) with a section of the same Borel subalgebra of Ad(P ).
1

(5) If we square Ï†10 (Îº) âˆˆ H 1 (Mg,r , Î¶âˆ— (Ad(P )âŠ—Ï‰C/Mg,r )), we get zero since
we are, in eï¬€ect, squaring nilpotent sections of Ad(P ).
(6) If we multiply Ï†10 (Îº) âˆˆ H 1 (Mg,r , Î¶âˆ— (Ad(P ) âŠ— Ï‰C/Mg,r )) by Ï†01 (Îº) âˆˆ

H 0 (Mg,r , R1 Î¶âˆ— (Ad(P ) âŠ— Î©Cclog )), then we are, in eï¬€ect, multiplying the
class Î£ by the tautological isomorphism Î², so that we obtain Î£, regarded
as a class in H 1 (Mg,r , Î©Mlog ).
g,r

Thus, in summary, all of the possible contributions are zero, except for the last, which is
2Î£. This completes the proof of Lemma 3.2. On the other hand, by basic linear algebra,
c2 (Ad(P )) is âˆ’2 tr(Îº2 ), so we see that we have, in fact, proven the following:
Lemma 3.3. We have Î¶âˆ— c2 (Ad(P )) = âˆ’4Î£.
Finally, putting this together with Lemma 3.1, we see that we have explicitly computed
the class Î£ in terms of well-known ï¬rst Chern classes of line bundles:
Theorem 3.4. The torsor of Schwarz structures deï¬nes a class Î£ âˆˆ H 1 (Mg,r , Î©Mlog )
g,r

which is equal to 14 (Î¸ + Ïˆ), where Î¸ = Î¶âˆ— Î¾ 2 ; Ïˆ = Î¶âˆ— (Î¾ Â· [D]); Î¾ = c1 (Ï‰C/Mg,r ); and [D]
is the cohomology class of the divisor of marked points. In particular, if g â‰¥ 3, then (in
characteristic zero) Sg,r â†’ Mg,r does not admit any sections, i.e., there are no canonical
Schwarz structures on r-pointed smooth curves of genus g â‰¥ 3.
Remark. Ideally, it would be nice to have an equality of classes not in H 1 (Mg,r , Î©Mlog ),
g,r

but in some sort of cohomology with compact supports â€œHc1 (Mg,r , Î©Mlog )â€ (which should
g,r

52

be isomorphic to H 1 (Mg,r , Î©Mg,r )). In order to do this, one would have to deï¬ne some sort
of appropriate sense in which Î£ is compactly supported, i.e., one would have to deï¬ne some
sort of trivializations of S g,r â†’ Mg,r at inï¬nity. In fact, S g,r â†’ Mg,r does not (in general)
have a canonical section over the divisor at inï¬nity. However, by considering indigenous
bundles of restrictable type, one can show that, so to speak, â€œthe more singular a curve gets,
the more of a canonical trivialization one has for S g,r â†’ Mg,r .â€ For instance, if the curve
is totally degenerate, i.e., it can be constructed by gluing together (as at the end of Â§2) a
number of copies of P1 with three marked points, then S g,r â†’ Mg,r does have a canonical
trivialization, as follows immediately from Proposition 2.11 (since then the indigenous
bundles of restrictable type form a torsor over the zero sheaf). Thus, in some sort of
combinatorially complicated sense, by considering indigenous bundles of restrictable type,
one can exhibit Î£ as a cohomology class with compact supports. Unfortunately, however,
the combinatorics involved get rather complicated in general, so we shall not carry this
out explicitly, except in the case when the dimension of Mg,r is one, where things are not
so diï¬ƒcult.
The Case of Dimension One
In this case, either g = r = 1 or g = 0, r = 4. Let Dâˆ âŠ† Mg,r be the divisor at
inï¬nity. Since Dâˆ is zero-dimensional, in this case we do have a canonical trivialization tâˆ
of S g,r â†’ Mg,r over Dâˆ . Now we shall give a new deï¬nition of cohomology with compact
supports that takes into account this trivialization tâˆ . Let Ï‰C log (respectively, Ï‰(Mlog ) ) be
g,r !

!

the subsheaf Ï‰C/Mg,r (âˆ’Dâˆ ) (respectively, Ï‰Mlog (âˆ’Dâˆ )) of Ï‰C/Mg,r (respectively, Ï‰Mg,r ).
g,r

Let Î©C log be the inverse image of Ï‰C log âŠ† Ï‰C/Mg,r via the morphism Î©Cclog â†’ Ï‰C/Mg,r .
!
!
Thus, we have an exact sequence:
0 â†’ Î¶ âˆ— Î©Mlog â†’ Î©C log â†’ Ï‰C log â†’ 0
g,r

!

!

which deï¬nes a ï¬ltration on Î©C log . Then for i, j â‰¥ 0, let us deï¬ne for any OC -module G:
!

def

H!i,j (C, G) = H i (C, G âŠ—OC âˆ§j Î©C log )
!

and for any OMg,r -module H:
def

H!i,j (Mg,r , H) = H i (Mg,r , H âŠ—OM

g,r

âˆ§j Ï‰(Mlog ) )
g,r !

Note that the push forward map Î¶âˆ— naturally deï¬nes a morphism Î¶âˆ— : H!2,2 (C, OC ) â†’
H!1,1 (Mg,r , OMg,r ). Now the obstruction to putting a logarithmic connection on P â†’ C
with normalized nilpotent monodromy at the marked points and which is of restrictable
53

type at inï¬nity is given by a class Îº! âˆˆ H!1,1 (C, Ad(P )). On the other hand, the torsor
S g,r â†’ Mg,r together with the trivialization tâˆ deï¬nes a class Î£! âˆˆ H!1,1 (Mg,r , OMg,r ).
By the same proof as before, we have Î£! = 12 Î¶âˆ— tr(Îº2! ). (In the present case, however,
one might remark that in the six types of product considered previously, the ï¬rst two types
(numbered (1) and (2)) of product vanish all the more trivially since they involve âˆ§2 Ï‰Mlog ,
which is zero.) Also, just as before, we have c2 (Ad(P )) = âˆ’2 tr(Îº2! ). Thus, we obtain:

g,r

Theorem 3.5. In H!1,1 (Mg,r , OMg,r ) = K, we have
Î£! =

1
Î¶âˆ— Î· 2
4

where Î· = c1 (Ï‰C log /Mlog ).
g,r

Let us compute Î¶âˆ— Î· 2 in the case g = 1, r = 1. First we introduce the classes Î¸ = Î¶âˆ— Î¾ 2 ;
Ïˆ = Î¶âˆ— (Î¾ Â· [D]); and Î» = c1 (Î¶âˆ— Ï‰C/Mg,r ). By Grothendieck-Riemann-Roch, Î¸ = 0. On the
other hand, sorting through the deï¬nitions, one sees that Ïˆ = Î». Thus, we obtain that for
g = 1, r = 1:

Î£! =
log

1
Î»
4

log

log

Next let N log : M1,1 [2] â†’ M1,1 be the ï¬nite, log eÌtale covering such that M1,1 [2]
is the moduli stack that parametrizes elliptic curves with level structure on the 2-torsion
points. Let
log

log

Î›log : M1,1 [2] â†’ M0,4
be the log eÌtale morphism given by sending an elliptic curve with a trivialization of its
two torsion to the four-pointed curve of genus zero of which the elliptic curve is a double
covering (with ramiï¬cation exactly at the four marked points). Moreover, Î›log admits a
log
section over any double covering of M0,4 (since the obstruction to such a section lies in
2
(M0,4 , Z/2Z)). Note that both N log and Î›log are, in fact, deï¬ned over Z[ 12 ]. Also,
Het
note that (over Z[ 12 ]), we have an isomorphism Î›âˆ— S 0,4 âˆ¼
= N âˆ— S 1,1 obtained by pulling-back
and pushing forward indigenous bundles. We thus obtain the following result:
Theorem 3.6. When Mg,r is one-dimensional, the torsor S g,r â†’ Mg,r does not admit
any section which is equal to tâˆ over Dâˆ modulo any prime â‰¥ 5.
54

Proof.

We have (Î£! )1,1 = 14 Î»1,1 , and Î»1,1 = 12 c1 (Ï‰Mlog ), so (Î£! )1,1 = 18 c1 (Ï‰Mlog ). Thus,
1,1

âˆ—

log

1,1

âˆ—

is log eÌtale, and N (Î£! )1,1 is an invertible multiple of Î› (Î£! )0,4 , it suï¬ƒces to
since N
show that:
(1) in Hodge cohomology modulo p (for a prime p â‰¥ 5), Î›âˆ— c1 (Ï‰Mlog ) =
0,4

N âˆ— c1 (Ï‰Mlog ) is nonzero; in fact, since Î›log admits a section over any
1,1

log

double covering of M0,4 , it suï¬ƒces merely to show that c1 (Ï‰Mlog ) is
0,4

nonzero modulo p;
(2) the formation of H!1,1 (M0,4 , OM0,4 ) commutes with base change modulo
p (for p an odd prime).
But both (1) and (2) follow immediately from the fact that M0,4 is just P1 , with Dâˆ =
{0, 1, âˆ}. (Note that there is a slight subtlety here in that (2) is not immediately obvious
for M1,1 since it is a stack; this is why we choose to verify the assertions of the Theorem
by means of M0,4 .) 

Appendix: Relation to the Complex Analytic Case
In this Appendix, we make the connection between the theory of Schwarz structures
discussed here and the classical notion of the Schwarzian derivative in complex analysis.
Let K be an algebraically closed ï¬eld of characteristic zero (such as, for instance, the
complex numbers C). Let X â†’ Spec(K) be a smooth, proper, connected curve. Let
P = P(J /J [3] ) be the usual P1 -bundle on X, and let âˆ‡P be a connection on P â†’ X that
makes it indigenous. Then just as in Â§1, we can form the Schwarzian derivative:
#
2
D : OX
â†’ Ï‰X/K

Then the purpose of this Appendix is to show that when X = P1 ; z is the standard rational
2
is trivialized by (dz)2 , then D(Ï†) is given (up to a factor of
function on P1 ; and Ï‰X/K
two) by the classical formula for the Schwarzian derivative.
First, let us note that when X = P1 , there exists only one connection âˆ‡P on Ï€ : P â†’
X that makes it indigenous. Indeed, this follows from the fact that Ad(P ) âŠ—OX Ï‰X/K has
no sections for degree reasons, plus the fact that the extension
0 â†’ J [2] /J [3] â†’ J /J [3] â†’ J /J [2] â†’ 0
does not split (since the extension class is the Hodge-theoretic ï¬rst Chern class c1 (Ï‰X/K ),
which is nonzero). It thus follows that (P ; âˆ‡P ) is necessarily isomorphic to the indigenous
55

bundle constructed in Example 1 of Â§2. Thus, P âˆ¼
= X Ã—K X (where we regard the projection
to the second factor as the structure morphism to X); let us ï¬x such an isomorphism for
the rest of the discussion. Also, the Kodaira-Spencer morphism at the diagonal section
ÏƒÎ” : X â†’ X Ã—K X âˆ¼
= P is an isomorphism. Let z be the standard rational function
on X. Let U âŠ† X be the complement of inï¬nity. Thus, z is regular on U . We shall
work mainly on U . For i = 1, 2, let pi : P âˆ¼
= X Ã—K X â†’ X be the projection to the ith
factor. Let Î¶ be the relative rational function on P |U â†’ U given by pâˆ—1 (z) âˆ’ pâˆ—2 (z). Let us
d
. Then clearly,
simply denote by âˆ‡ the result of applying âˆ‡P in the tangent direction dz
2
âˆ‡(Î¶) = âˆ’1. Let Î· = 1/Î¶. Thus, âˆ‡(Î·) = Î· . Now if we regard P as P(J /J [3] ), and s is
a section given by [a dz, b (dz)2 ] (where a, b âˆˆ OX (V ), for some open V âŠ† U ), then we
have Î¶(s) = a/b. Indeed, both sides of this equation deï¬ne relative rational functions on
P |U â†’ U . The right-hand side has a simple pole at the section [dz, 0 Â· (dz)2 ], which, by
computing residues as in the deï¬nition of the isomorphism of Proposition 1.4, corresponds
to the section âˆ Ã— U . Thus, both sides of the equation have a simple pole at âˆ Ã— U , and
the same 1-jet at ÏƒÎ” , hence are equal. In particular, Î·(s) = b/a.
#
(V ). The 2-jet jÏ† of Ï† is given by Ï† dz + 12 Ï† (dz)2 .
Now suppose we are given Ï† âˆˆ OX
Ï†
Thus, if sÏ† is the section of P over V that is deï¬ned by jÏ† , we have Î·(sÏ† ) = 2Ï†
 . Thus,
we compute:

(

Ï† 
) = âˆ‡(Î·(sÏ† ))
2Ï†
= {âˆ‡(Î·)}(sÏ† ) + Î·(âˆ‡(sÏ† ))
= Î· 2 (sÎ¸ ) + D(Ï†) (dz)âˆ’2
=

(Ï† )2
+ D(Ï†) (dz)âˆ’2

2
4(Ï† )

Expanding the derivative on the left and rearranging terms, we get:
Ï†
(Ï† )2
(Ï† )2
âˆ’
âˆ’
} (dz)2
2Ï†
2(Ï† )2
4(Ï† )2
1 Ï†
3(Ï† )2
= {  âˆ’
} (dz)2
2 Ï†
2(Ï† )2

D(Ï†) = {

We have thus shown the following result:
Theorem A. On P1 , the Schwarzian derivative deï¬ned at the end of Â§1 is equal to
one-half the classical Schwarzian derivative.
For a treatment of the classical Schwarzian derivative, we refer to [Lehto].

56

Chapter II: Indigenous Bundles in Characteristic p
Â§0. Introduction
In this Chapter, we study indigenous bundles in characteristic p. In particular, we will
be concerned with how these bundles interact with Frobenius. Our main tool for studying
this interaction will be the p-curvature. We begin in Â§1 by studying FL-bundles, which
are a special kind of rank two vector bundle with connection on a curve that corresponds
to a lifting of the curve modulo p2 . In Â§2, we deï¬ne the Verschiebung map on indigenous
bundles to be the determinant of the p-curvature of the indigenous bundle. It turns out that
(essentially) indigenous bundles arise from FL-bundles precisely when their Verschiebung
vanishes. Since it is precisely this sort of indigenous bundle â€“ which (following [Katz]) we
call nilpotent â€“ that corresponds to an MF âˆ‡ -object in the sense of [Falt], it is worthwhile
deï¬ning and studying the moduli space N g,r of such bundles. In order to study N g,r , we
make two fundamental calculations (Theorems 2.3 and 2.13) concerning the Verschiebung.
The ï¬rst tells us that the Verschiebung is ï¬nite and ï¬‚at, of degree p3gâˆ’3+r , and the second
calculates the derivative the Verschiebung in terms of invariants of the indigenous bundle
which are easier to compute. In Â§3, we deï¬ne the hyperbolic (higher genus) analogue of an
ordinary elliptic curve: namely, we say that a hyperbolic curve is hyperbolically ordinary
if it admits a nilpotent indigenous bundle at which the derivative of the Verschiebung is
an isomorphism. Using the general machinery developed in Â§2, we then do a number of
computations involving totally degenerate curves and elliptic curves which reveal that:
(1) the hyperbolically ordinary locus of Mg,r is open and dense (Corollary
3.8);
(2) if one applies the deï¬nition of ordinariness in terms of indigenous bundles to the case of elliptic curves, one recovers the classical deï¬nition of
an ordinary elliptic curve (Theorem 3.11); and
(3) (at least if g â‰¥ 3, and p is suï¬ƒciently large then) each irreducible
component of N g,r that passes through a certain canonical nilpotent
indigenous bundle on a totally degenerate curve has degree â‰¥ 2 over
Mg,r ; thus, there is no canonical choice of a nilpotent indigenous bundle
on a generic r-pointed stable curve of genus g (Proposition 3.13).
We end the Chapter with the observation that (3) is interesting in the sense that it constitutes a deviation from the behavior that one might expect by analogy to the complex
case.

57

Â§1. FL-Bundles
In this Section, we develop the theory of a certain kind of rank two bundle, which we
call an FL-bundle, which arises from looking at the Cartier isomorphism of a curve. It
turns out that the space of such bundles can also be used to parametrize the inï¬nitesimal
deformations of a curve to Z/p2 Z. The material we present here is essentially â€œwell-knownâ€
(see, e.g., [Kato], Â§4), although our point of view is a little diï¬€erent. Let p be a prime. Let
S be a noetherian scheme over Fp . Let us assume that we are given a ï¬ne log structure on
S, and let us denote the resulting log scheme by S log . Let us denote the absolute Frobenius
([Kato], Â§4) of S log by Î¦S log : S log â†’ S log . Let f log : X log â†’ S log be an r-pointed stable
curve of genus g (as in Chapter I, Deï¬nition 2.1, so 2g âˆ’ 2 + r â‰¥ 1). In general, we
shall denote by means of a superscript â€œF â€ the result of base-changing by Î¦S log . Let
def
Î¦X log /S log : X log â†’ (X log )F = X log Ã—S log ,Î¦Slog S log be the relative Frobenius.
Deformations and FL-Bundles
We begin by reviewing the Cartier isomorphism (as in [Kato], Theorem 4.12). Since
a curve is one-dimensional, this amounts to the existence of an exact sequence of sheaves
on X:
log
log F
â†’ (Î¦X log /S log )âˆ’1 (Ï‰X/S
) â†’0
0 â†’ (Î¦X log /S log )âˆ’1 OX F â†’ OX â†’ Ï‰X/S
def

where the morphism in the middle is the exterior diï¬€erentiation operator d. Let Q =
log
. Then note that since the above exact sequence is functorial with to based(OX ) âŠ† Ï‰X/S
log
â†’ S log , the formation of Q is likewise functorial with respect to base-change.
change T
We would like to consider what happens to this exact sequence when it is tensored over
(Î¦X log /S log )âˆ’1 OX F with (Î¦X log /S log )âˆ’1 (Ï„X log /S log )F . Let T = (Î¦X log /S log )âˆ— (Ï„X log /S log )F .
We then obtain (by using the long exact cohomology sequence for higher direct images)
the following two exact sequences of sheaves on S:
log
0 â†’ OS â†’ R1 fâˆ— Q âŠ—OX T â†’ R1 fâˆ— Ï‰X/S
âŠ—OX T

0 â†’ R1 fâˆ— (Ï„X log /S log )F â†’ R1 fâˆ— T â†’ R1 fâˆ— Q âŠ—OX T â†’ 0
where we use the fact that fâˆ— (Q âŠ—Î¦âˆ’1

X log /S log

OX F

log
F
Ï„X
log /S log ) â†’ fâˆ— (Ï‰X/S âŠ—OX T ) = 0

by degree considerations. Now let us note that T has a natural logarithmic connection âˆ‡T obtained by declaring the sections of the subsheaf (Î¦X log /S log )âˆ’1 (Ï„X log /S log )F âŠ†
(Î¦X log /S log )âˆ— (Ï„X log /S log )F = T to be horizontal. Thus, by using the above exact sequences,
we can compute the ï¬rst de Rham cohomology module of T (where we always understand
T to be equipped with the connection âˆ‡T ).
58

Proposition 1.1. We have an exact sequence:
0 â†’ R1 fâˆ— (Ï„X log /S log )F â†’ R1 fDR,âˆ— (T ) â†’ OS â†’ 0
which is functorial with respect to base-change T log â†’ S log . In particular, R1 fDR,âˆ— (T ) is
a vector bundle of rank 3g âˆ’ 2 + r on S. Finally, R1 fDR,âˆ— (T ) âŠ† R1 fâˆ— (T ).
Let us denote by A the R1 fâˆ— (Ï„X log /S log )F -torsor on S deï¬ned by the above exact
sequence. Let Slog be a ï¬ne log scheme whose underlying scheme is ï¬‚at over Z/p2 Z,
 log â†’ Slog be an r-pointed stable curve of
and such that Slog âŠ— Z/pZ = S log . Let X
genus g lifting f log . Then for any r-pointed stable curve Y log â†’ Slog of genus g that lifts
(X log )F â†’ S log , we can associate a section Î¸Y of A as follows. Consider the obstruction
 log â†’ Y log .
to lifting the relative Frobenius Î¦X log /S log : X log â†’ (X log )F to a morphism X
This deï¬nes a section Î¸Y of R1 fâˆ— (T ). Observe that Î¸Y is independent of the choice of lifting
 log . Indeed, this follows from the fact that locally, if one changes the lifting X
 log , the
X
log
obstruction cocycle will change by a derivation of X
applied to a function pulled-back
log F
via Î¦X log /S log from (X ) . But this will always give zero. This proves that Î¸Y depends
only on Y log . Let us also observe that Î¸Y actually deï¬nes a section of R1 fDR,âˆ— (T ) âŠ†
R1 fâˆ— (T ). Indeed, to see this, we reason as follows. We work with bianalytic functions,
as in Chapter I, Â§1. Then the inverse image via the relative Frobenius of O(X bi )F in OX bi
coincides with both iL {(Î¦X log /S log )âˆ’1 OX F } and iR {(Î¦X log /S log )âˆ’1 OX F }. Thus, the two
pull-backs (from the right and left) of Î¸Y to OXbi both correspond to the obstruction to
lifting iL {(Î¦X log /S log )âˆ’1 OX F } = iR {(Î¦X log /S log )âˆ’1 OX F } to a OS-ï¬‚at subalgebra (with log
structure) of OXbi . This shows that Î¸Y is horizontal.
log â†’ Slog of (X log )F â†’ S log . Then
Now suppose that we consider another lifting Z
the diï¬€erence between the liftings Y log and Zlog naturally deï¬nes a section Î¸Y Z of the
vector bundle R1 fâˆ— (Ï„X log /S log )F . It follows immediately from the deï¬nition of an obstruc
tion class that Î¸Y = Î¸Z
+ Î¸Y Z . Thus, if there existed a lifting Y log such that Î¸Y is a
section of the subsheaf R1 fâˆ— (Ï„X log /S log )F âŠ† R1 fDR,âˆ— (T ), then it would follow that there

exists another lifting Zlog such that Î¸Z
= 0. Thus, the relative Frobenius would lift to a
log
log


morphism Î¨ : X â†’ Z . But then by pull-back, Î¨ would induce a nonzero morphism
log F
log
of (Î¦X log /S log )âˆ— (Ï‰X/S
) into Ï‰X/S
, which, by degree considerations, is absurd. Thus, we

1
conclude that no Î¸Y lies in R fâˆ— (Ï„X log /S log )F âŠ† R1 fDR,âˆ— (T ). In other words, for every
lifting Y log , Î¸Y deï¬nes a section of A. Let D be the R1 fâˆ— (Ï„X log /S log )F -torsor over S of
liftings of (X log )F â†’ S log to Slog . Then, we see that we have deï¬ned a canonical morphism
of R1 fâˆ— (Ï„X log /S log )F -torsors
F :Dâ†’A
Since any morphism of torsors is necessarily an isomorphism, we see that we have proven
the following result: ([Kato], Theorem 4.12 (2))
59

Proposition 1.2. The canonical morphism F : D â†’ A is an isomorphism.
Let (E, âˆ‡E ) be a rank two vector bundle on X with a connection âˆ‡E (relative to f log ).
Suppose that there exists a horizontal exact sequence
0 â†’ T â†’ E â†’ OX â†’ 0
Then this exact sequence deï¬nes a section Î· of R1 fDR,âˆ— (T ) over S.
Deï¬nition 1.3. We shall call (E, âˆ‡E ) an FL-(vector) bundle if Î· maps to OSÃ— âŠ† OS under
the map R1 fDR,âˆ— (T ) â†’ OS of Proposition 1.1. We shall call a P1 -bundle with connection
(P, âˆ‡P ) on X log an FL-(P1 )-bundle if it can be written eÌtale locally on S as the P1 -bundle
associated to an FL-vector bundle.
Remark. The letters â€œFLâ€ stand for Frobenius lifting. Since a FL-bundle deï¬nes a section
of the torsor A, it follows by Proposition 1.2 that it also deï¬nes a lifting Y log â†’ Slog of
(X log )F â†’ S log . Also, we shall see below (Corollary 1.5) that, at least if S is reduced, then
if a horizontal exact sequence as above exists, it is necessarily unique.
The p-Curvature of an FL-Bundle
Let us assume for the rest of the Section that p is odd. Throughout this Chapter
the notion of the p-curvature of a bundle with connection in characteristic p will play an
important role. We refer to [Katz], Â§5, 6; [Ogus], Â§1.2, 1.3 for basic facts concerning the
p-curvature. ([Katz], of course, does not handle the arbitrary â€œlog-smoothâ€ case, but the
deï¬nitions and proofs (of the properties that we will need) go through without change. At
any rate, on the sorts of curves that we are working with, the theory of [Katz], Â§5, 6, is
literally valid on an open, schematically dense subset, and many assertions can be checked
after restriction to such an open subset.) Let (E, âˆ‡E ) be an FL-bundle. We would like
to compute the p-curvature of (E, âˆ‡E ). The p-curvature P will be a horizontal section
of T âˆ¨ âŠ—OX Ad(E). Occasionally, we shall think of P as a morphism Ad(E) â†’ T âˆ¨ or a
morphism T â†’ Ad(E) (using the fact that Ad(E) is self-dual). By abuse of notation, we
shall also refer to these morphisms by the notation P. Now, ï¬rst of all, since âˆ‡E stabilizes
the ï¬ltration T âŠ† E, by functoriality, P also respects this ï¬ltration. Secondly, since T
and OX clearly have p-curvature zero, P not only respects the ï¬ltration, but is nilpotent,
i.e., P : T â†’ Ad(E) maps into the subbundle T âŠ† Ad(E) (given by endomorphisms of E
obtained by projecting E â†’ OX , mapping OX to T , and then injecting T â†’ E). Thus, P
basically amounts to a morphism from T to T , i.e., a section of fâˆ— OX = OS .
Proposition 1.4. Assume that p is odd. If (E, âˆ‡E ) is an FL-bundle on X log , then
P : T â†’ Ad(E) is given by multiplication T â†’ T by âˆ’1, followed by the inclusion
T â†’ Ad(E).
60

Proof. Since the universal example of an FL-bundle on an r-pointed stable curve of genus
g is given by the torsor A over Mg,r , which is smooth, it suï¬ƒces to check the assertion after
restriction to a closed point of this universal A. Thus, we can assume that S = Spec(k),
where k is a ï¬nite ï¬eld. Then S has a canonical lifting to a ï¬‚at scheme over Z/p2 Z, namely,
S = Spec(W (k)/p2 W (k)) (where W (k) is the ring of Witt vectors with coeï¬ƒcients in k),
 â†’ S,
 we may
and S has a natural Frobenius lifting Î¦S. Thus, for any smooth scheme U
 , that is, a S-linear

 â†’ U
F
speak of a Frobenius lifting (mod p2 ) on U
morphism Î¦ : U
def 
whose reduction modulo p is the relative Frobenius U â†’ U F of U = U
âŠ— Z/pZ.

Now let us take U to be an aï¬ƒne open subset U âŠ† X, at which f is smooth, and
 â†’ S be a smooth lifting of U , and let t be a
which contains no marked points. Let U
local coordinate on U . By the interpretation of FL-bundles in terms of obstructions to
Frobenius liftings, we may compute E by using as follows: Over U , E|U âˆ¼
= T |U âŠ• OU .
Let us write sections of E relative to the decomposition T |U âŠ• OU and the basis given
by (Î¦âˆ’1
( d )F , 0); (0, 1) ; and let us denote by âˆ‡ the connection âˆ‡E applied in the
X log /S log dt
d
. Then âˆ‡ is given by adding to the direct sum connection the matrix
direction dt



0

1 
pÎ¦

0

0

where the map Î¦ is the derivative (with respect to t) of some local Frobenius liï¬ng
 . Since tF â†’ (1 + t)p âˆ’ 1 is a Frobenius lifting, Î¦(tF ) must be of the form
Î¦ on U
(1+t)p âˆ’1+f (t), for some function f (t) on U . Therefore, p1 Î¦ is of the form (1+t)pâˆ’1 +f  (t).
This gives âˆ‡(1, 0) = 0; âˆ‡(0, 1) = ((1 + t)pâˆ’1 + f  , 0). Therefore, (âˆ‡)p (1, 0) = 0 and
d p
âˆ‡p (0, 1) = (p âˆ’ 1)!(1, 0) (since ( dt
) f = 0). Finally, it follows easily from using the fact
Ã—
that Fp is a cyclic group that (p âˆ’ 1)! = âˆ’1 (in Fp ). This completes the proof. 
Corollary 1.5. Assume that p is odd. Let (E, âˆ‡E ) be a rank two vector bundle with
logarithmic connection on X log (over S log ) deï¬ned by a section Î· of R1 fDR,âˆ— (T ). Then
(E, âˆ‡E ) is an FL-bundle if and only if its p-curvature is nonzero at some point of every
ï¬ber of f : X â†’ S.
Proof. The â€œonly ifâ€ part follows from Proposition 1.4. On the other hand, suppose that
the image of Î· under the map R1 fDR,âˆ— (T ) â†’ OS of Proposition 1.1 vanishes at a point.
By restricting to that point, we may assume that S is the spectrum of a ï¬eld, and that
the image of Î· in OS vanishes identically. But then, it follows from the exact sequence
of Proposition 1.1 that (E, âˆ‡E ) is the pull-back of a bundle under Frobenius. Then its
p-curvature must vanish identically, which contradicts our assumption. 
Corollary 1.6. Assume that p is odd and that S is reduced. Let (E, âˆ‡E ) be an FL-bundle.
Let U âŠ† X be an open subset; (L, âˆ‡L ) be a line bundle with logarithmic connection on U log ;
61

and Î¹ : L â†’ E|U be a horizontal morphism of OU -modules with logarithmic connections.
Then Î¹ factors through the injection T |U â†’ E|U in the deï¬nition of E as an FL-bundle.
Proof. By shrinking U , we may assume that f : X â†’ S is smooth on U , and that U
stays away from the marked points. We may also assume that the composite of Î¹ with the
projection E|U â†’ OU is an isomorphism. Thus, we obtain a horizontal isomorphism of
line bundles L â†’ OU . But this implies that (L, âˆ‡L ) has p-curvature zero. Thus, we get
a horizontal isomorphism L âŠ• T |U â†’ E|U . Since the left-hand side has p-curvature zero,
the same is true of the right-hand side. But this contradicts Proposition 1.4. 
Remark. It is not diï¬ƒcult to construct counterexamples to Corollary 1.6 if one does not
assume that S is reduced.
Â§2. The Verschiebung on Indigenous Bundles
In this Section, we deï¬ne a â€œVerschiebungâ€ morphism on the space S g,r of Schwarz
structures that takes values in the space of square diï¬€erentials (twisted by Frobenius). We
then prove various basic properties of this morphism, such as computing its derivative.
This computation reveals that the derivative looks rather like the Verschiebung morphism
for the Jacobian of the curve, thus justifying the terminology. On the other hand, as
we shall see in Â§3, unlike the Verschiebung of the Jacobian which only pertains to H 1
of the curve, the Verschiebung on indigenous bundles pertains to a nonabelian invariant
of the curve, namely, the nilpotent indigenous bundles on the curve. It turns out that
the study of nilpotent indigenous bundles, and thus of the Verschiebung on indigenous
bundles are central to understanding uniformization theory in the p-adic context. In this
Section, Mg,r (respectively, S g,r ) will denote the moduli stack of r-pointed curves of genus
g (respectively, equipped with a Schwarz structure) over Fp . We assume throughout this
Section that p is odd.
The Deï¬nition of the Verschiebung
Let S log be a ï¬ne noetherian log scheme over Fp . Let f log : X log â†’ S log be an rpointed stable curve of genus g. Let D âŠ† X be the divisor of marked points. Let (E, âˆ‡E )
be an indigenous bundle on X log (see Â§2 of Chapter I for more on such bundles). We
remark here that throughout this paper, when we do various manipulations with indigenous
bundles, it will be simpler to work with vector bundles, rather than P1 -bundles. Of course,
indigenous vector bundles only exist under certain conditions (cf. Proposition 2.6 of Chapter I), but this will not pose any problem, since we can always either Zariski localize on the
curve, or pass to some sort of covering of the curve, and then descend for the ï¬nal result.
Thus, in the future, for the rest of the paper, we shall act as if this problem does not exist,
and always work with indigenous vector bundles, when it is technically more comfortable
to do so.
62

We maintain the notation of Â§1 for the various Frobenius morphisms and for T =
(Î¦X log /S log )âˆ— (Ï„X log /S log )F . Let PE : T â†’ Ad(E) be the p-curvature of (E, âˆ‡E ). Consider
the composite of PE with its dual PEâˆ¨ . This composite is a horizontal morphism T â†’ T âˆ¨ ,
log âŠ—2 F
hence deï¬nes a section of (fâˆ— (Ï‰X/S
) ) . Let VE be âˆ’ 12 times this section. Another way
to put the deï¬nition of VE is as follows: We consider the square (PE )2 : (T )âŠ—2 â†’ End(E)
of PE , take the trace, and multiply by âˆ’ 12 . Yet another way to put the deï¬nition of VE is
that it is the determinant of PE (regarded as a map (T )âŠ—2 â†’ OX ).
Proposition 2.1. Assume that S is reduced. Then VE is zero if and only if the image of
PE consists of nilpotent endomorphisms of E.
Proof. Immediate from the deï¬nitions. 
Thus, we may think of VE as a measure of how nilpotent PE is. Note, in particular, that at
a marked point, by deï¬nition âˆ‡E has nilpotent monodromy, so the p-curvature is already
nilpotent there. Thus, VE has zeroes at all the marked points. By abuse of notation, we
log âŠ—2
) (âˆ’D))F .
shall denote by VE the resulting section of (fâˆ— (Ï‰X/S
log âŠ—2
Deï¬nition 2.2. We shall refer to the section VE of (fâˆ— (Ï‰X/S
) (âˆ’D))F as the Verschiebung of the indigenous bundle (E, âˆ‡E ).

log

Thus, in the universal case, when f log : C log â†’ Mg,r is the universal r-pointed stable curve
of genus g, we obtain a morphism of Mg,r -schemes:

V g,r : S g,r â†’ Qg,r
where Qg,r is the geometric vector bundle corresponding to (i.e., Spec of the symmetric
log âŠ—2
) (âˆ’D))F . Note that both S g,r and Qg,r are of dimension
algebra of the dual of) (fâˆ— (Ï‰X/S
3gâˆ’3+r over Mg,r . The rest of this Chapter will be devoted to studying this Verschiebung
morphism V g,r .
Let us begin with some observations concerning the degree of V g,r as a polynomial
map. Let âˆ‡E = âˆ‡E + Î¸ be a logarithmic connection on E that makes it an indigenous
bundle; here we may assume that Î¸ is an Ad(E)-valued diï¬€erential which deï¬nes a squarenilpotent endomorphism of E and which corresponds to a square diï¬€erential Î¸ SD . Thus,
Î¸ 2 = 0. If we then compute the p-curvature of (E, âˆ‡E ) by, say, working locally on U âŠ†
X where there is a local coordinate x, and letting âˆ‡ (respectively, âˆ‡ ; Î¸x ) denote âˆ‡E
def

d
(respectively, âˆ‡E ; Î¸) applied in the direction âˆ‚ = dx
, we note that because Î¸x2 = 0, all the
terms that involve Î¸x more than 12 (p + 1) times must vanish. Moreover, there is only one
term that involves Î¸x exactly 12 (p + 1) times, namely:

63

Î¸x âˆ‡ Î¸x âˆ‡ . . . âˆ‡ Î¸x
that is, alternating Î¸x â€™s and âˆ‡â€™s, with a total of 12 (p + 1) copies of Î¸x and 12 (p âˆ’ 1) copies
of âˆ‡. For future reference let us call this term Î¾. Note that since Î¸x2 = 0, any string
Î¸x âˆ‡ Î¸x can be rewritten Î¸x [âˆ‡, Î¸x ] (where the brackets denote the commutator), and
that this commutator [âˆ‡, Î¸x ] is a linear operator (that is, linear over OX ). Moreover, this
linear operator [âˆ‡, Î¸x ] preserves the Hodge ï¬ltration of E. Thus, Î¾ may be rewritten as Î¸x
times [âˆ‡, Î¸x ] to some power. Since [âˆ‡, Î¸x ] preserves the Hodge ï¬ltration, it thus follows
that Î¾ is a linear operator on E which is nilpotent with respect to the Hodge ï¬ltration. In
particular, Î¾ 2 = 0. At any rate, we may at least conclude that in the expression for the
trace of the square of the p-curvature of âˆ‡E , Î¸ occurs no more than p times in each term.
We thus obtain the following result:
(*) Relative to the aï¬ƒne structures of S g,r and Qg,r , the pull-backs of
the aï¬ƒne variables on Qg,r via the morphism V g,r are polynomials in
the aï¬ƒne variables of S g,r of degree â‰¤ p.
In fact, we would like to conclude a stronger result, namely that the degree is exactly
p. In order to do this, we need to enlist the aid of Jacobsonâ€™s formula (see, e.g., [Jac],
pp. 186-187): This formula states that if a and b are elements of an associative ring R of
characteristic p, then

p

p

p

(a + b) = a + b +

pâˆ’1


si (a, b)

i=1

where the si (a, b) are given by the formula:

pâˆ’1

(ad(ta + b))

(a) =

pâˆ’1


isi (a, b)tiâˆ’1

i=1

computed in the ring R[t], where t is an indeterminate. In our case, we let b = âˆ‡ and
a = Î¸x , and we wish to compute the sj (a, b), where j = 12 (p âˆ’ 1). Let Î· be the coeï¬ƒcient
multiplying tjâˆ’1 in the expression (ad(ta + b))pâˆ’1 (a). Let Î± = ad(a); Î² = ad(b). Then the
terms in Î· look like 12 (p âˆ’ 3) copies of Î± and 12 (p + 1) copies of Î² applied to a in some order.
Now ultimately, in order to compute the Verschiebung, we are interested in computing
tr(Î· Â· Î¾). Let Ï„ be one of the terms that make up Î·. Now we separate the analysis of Ï„ into
two cases: the case where Ï„ begins with an Î±, and the case where Ï„ begins with a Î².
Suppose that Ï„ begins with an Î±. Thus, Ï„ looks like
Î± Î³1 . . . Î³pâˆ’2 a
64

where each Î³i is either Î± or Î². Now let us note that when one applies Î± = ad(Î¸x ) or
Î² = ad(âˆ‡) to a linear operator on E, one gets back a linear operator. Moreover, Î± applied
to any linear operator on E yields a linear operator that preserves the Hodge ï¬ltration on
E. Thus, we conclude that Ï„ is a linear operator on E that preserves the Hodge ï¬ltration.
Since Î¾ is nilpotent with respect to the Hodge ï¬ltration, it thus follows that tr(Ï„ Â· Î¾) = 0.
Now suppose that Ï„ begins with a Î²:
Î² Î³1 . . . Î³pâˆ’2 a
Let us denote by Ïƒ the linear operator on E given by Î³1 . . . Î³pâˆ’2 a (i.e., we leave oï¬€ the
initial Î²). We would like to show that Ïƒ preserves the Hodge ï¬ltration on E. To see this,
ï¬rst note that among the Î³i â€™s, the number of Î²â€™s is exactly one greater than the number of
Î±â€™s. Also, note that (by Griï¬ƒths transversality) relative to the Hodge ï¬ltration on Ad(E),
applying Î² decreases the ï¬ltration index l (in F l (Ad(E))) by at most one, while applying
Î± always increases the ï¬ltration index l by one. Thus, since a = Î¸x âˆˆ F 1 (Ad(E)), it
follows that Ïƒ âˆˆ F 0 (Ad(E)), i.e., it ï¬xes the Hodge ï¬ltration on E, and so Ïƒ Â· Î¾ is nilpotent
with respect to the Hodge ï¬ltration. In particular, tr(Ïƒ Â· Î¾) = 0. Since the trace map is
horizontal, we thus obtain that tr([âˆ‡, Ïƒ Â· Î¾]) = 0. Therefore, when we multiply Ï„ = Î²(Ïƒ)
by Î¾ and take the trace, we get
tr(Ï„ Â· Î¾) = tr([âˆ‡, Ïƒ Â· Î¾]) âˆ’ tr(Ïƒ Â· [âˆ‡, Î¾])
= âˆ’tr(Ïƒ Â· [âˆ‡, Î¾])
In other words, tr(Ï„ Â· Î¾) depends only on the images of Ïƒ and [âˆ‡, Î¾] in F 0 /F 1 (Ad(E)).
To compute the image of Ïƒ in F 0 /F 1 (Ad(E)), we must analyze Ïƒ in greater detail.
Now we saw that when we compute Ïƒ by applying Î±â€™s and Î²â€™s to a, Î² decreases the ï¬ltration
index by at most one. The only time it fails to decrease the ï¬ltration index by one is when
it is applied to a linear operator which already has a nontrivial image in F âˆ’1 /F 0 (Ad(E)).
If this should occur even once, then the net change in the ï¬ltration index as a result of
applying all the Î³i â€™s (in the computation of Ïƒ) to a is â‰¤ 0. Thus, if this occurs even once,
Ïƒ âˆˆ F 1 (Ad(E)), so tr(Ïƒ Â· [âˆ‡, Î¾]) = 0. On the other hand, if, during the calculation of Ïƒ, we
apply Î± to a linear operator in F 1 (Ad(E)), we get zero. Let us call the case where neither
of these two phenomena ever occurs the nondegenerate case. Thus, only the nondegenerate
terms Ï„ will make a nonzero contribution.
Let us suppose that Ï„ is nondegenerate. Then in order to compute the image of Ïƒ in
F 0 /F 1 (Ad(E)), it suï¬ƒces to merely keep track of the leading term (relative to the Hodge
ï¬ltration on Ad(E)) as we apply the various Î³i â€™s. Now let us note that it follows from
the fact that the Kodaira-Spencer morphism for the Hodge ï¬ltration on E is the identity
that if l â‰¥ 1, then applying Î² to a linear operator L in F l (Ad(E)) yields a linear operator
in F lâˆ’1 (Ad(E)) whose image in F lâˆ’1 /F l (Ad(E)) is the image of L in F l /F l+1 (Ad(E))
times âˆ‚. On the other hand, if l â‰¤ 1, then applying Î± to a linear operator L in F l Ad(E)
yields a linear operator in F l+1 (Ad(E)) whose image in F l+1 /F l+2 (Ad(E)) is the image
65

of L in F l /F l+1 (Ad(E)) times Î¸ SD Â· âˆ‚. Thus, if Ï„ is nondegenerate, then its contribution
âˆ’tr(Ïƒ Â· [âˆ‡, Î¾]) is given by (Î¸ SD Â· âˆ‚)p Â· (âˆ‚)p .
It remains to compute the number of nondegenerate terms Ï„ . Let us call this number
Np , and regard it as an element of Fp . We are interested in whether or not Np âˆˆ Fp is
zero. Although one can presumably compute Np explicitly using some sort of combinatorial
argument, we prefer to take the following approach. Note that Np does not depend on
g or r or on the particular curve f log : X log â†’ S log , but only on p. Thus, it suï¬ƒces to
show that (for each odd prime p) Np = 0 for one particular curve (with g and r arbitrary).
We shall do this in Â§3 when we do various computations with elliptic curves. Thus, we
log âŠ—2
) (âˆ’D))F ), when applied to (âˆ‚ F )2 yields
obtain that VE (which is a section of (fâˆ— (Ï‰X/S
the function c Â· (Î¸ SD Â· âˆ‚)p Â· (âˆ‚)p , where c âˆˆ FÃ—
p . Put another way, the degree p component
of V g,r is a morphism:
[p]

log âŠ—2
log âŠ—2
V g,r : {(fâˆ— (Ï‰X/S
) (âˆ’D))âˆ¨ }F â†’ Sp (fâˆ— (Ï‰X/S
) (âˆ’D))âˆ¨

which is equal to c times the Frobenius morphism, i.e., the pth -power map. We shall see
later in our computations with elliptic curves that c = âˆ’1. Thus, we thus obtain the
following important result:
Theorem 2.3. Relative to the aï¬ƒne structures of S g,r and Qg,r , the pull-backs of the
aï¬ƒne variables on Qg,r via the morphism V g,r are polynomials in the aï¬ƒne variables of
[p]

S g,r of degree exactly p, with the leading term V g,r (i.e., the degree p component) given
by âˆ’1 times the pth -power map. In particular, V g,r is a ï¬nite, ï¬‚at morphism of degree
p3gâˆ’3+r .
Proof. It remains to verify the last assertion (that V g,r is ï¬nite and ï¬‚at of the right degree).
Let U = Spec(A) â†’ Mg,r be eÌtale. Then over U , we may choose aï¬ƒne coordinates Xi
and Yj of S g,r and Qg,r so that V g,r looks like (the map induced on Specâ€™s by):
def

def

B = A[Y1 , . . . , Y3gâˆ’3+r ] â†’ C = A[X1 , . . . , X3gâˆ’3+r ]
where Yi â†’ fi (X1 , . . . , X3gâˆ’3+r ), and fi is of the form â€œâˆ’Xip plus terms of lower degree.â€
Then it is easy to see that, as a B-module, C is generated by monomials of the form


3gâˆ’3+r

Xiei

i=1

where 0 â‰¤ ei â‰¤ p âˆ’ 1. In particular, C is a ï¬nite B-module, so V g,r is ï¬nite. Since V g,r is
a ï¬nite morphism between regular algebraic stacks of the same dimension, it follows from
commutative algebra that V g,r is ï¬‚at. To compute the degree of V g,r , let P = ProjA (C[T ])
66

(with the grading such that T and the Xi â€™s have degree one). Then Spec(C) âŠ† P is an
aï¬ƒne open subset. Let Si âŠ† P be the hypersurface which is the closure of the zero
locus of fi . Then the scheme-theoretic intersection V of all the Si â€™s has degree p3gâˆ’3+r
over Spec(A). Also, the intersection of V with P âˆ’ Spec(C) = V+ (T ) = Proj(C) is just
p
) âŠ† Proj(C), which is the empty set. Thus, V âŠ† Spec(C), and so
V+ (X1p , . . . , X3gâˆ’3+r
deg(V g,r ) = deg(V â†’ Spec(A)) = p3gâˆ’3+r . 
Before continuing, we introduce some more terminology that will be of use in the
future:
Deï¬nition 2.4. Let (E, âˆ‡E ) be an indigenous bundle on X log . Then, we will say that
(E, âˆ‡E ) is nilpotent if VE is zero. We will say that (E, âˆ‡E ) is admissible if PEâˆ¨ : Ad(E) â†’ T âˆ¨
is surjective.
Note that the terminology of a â€œnilpotent indigenous bundleâ€ that we have introduced
here is (by Proposition 2.1) consistent with that of [Katz]. Also, let us observe that the
nilpotent bundles form a closed subscheme
N g,r âŠ† S g,r
while the admissible bundles form an open subscheme
adm

S g,r âŠ† S g,r
adm

adm

We shall see later in this Chapter that S g,r
N g,r is nonempty and that neither S g,r nor
N g,r is contained in the other. Note, further, that Theorem 2.3 implies that the natural
morphism
N g,r â†’ Mg,r
is ï¬nite and ï¬‚at of degree p3gâˆ’3+r .
Finally, we observe that one thing which is interesting about nilpotent indigenous
bundles is that (if S is the spectrum of a perfect ï¬eld, then) by a result of [Falt] such
indigenous bundles arise as the crystalline DieudonneÌ modules of certain ï¬nite, ï¬‚at group
schemes on X log . This point of view will be pursued further in later chapters. This
observation is the main reason for studying N g,r and V g,r , which is the goal of the present
Chapter.

67

The p-Curvature of an Admissible Indigenous Bundle
As a preÌlude to ï¬nding out more about V g,r , it is worth looking at various basic
properties of the p-curvature of an admissible indigenous bundle.
Proposition 2.5. There is a bijective correspondence between nilpotent, admissible indigenous bundles (up to tensor product with a line bundle of order two) and FL-bundles
whose projectivizations are indigenous given as follows: If (E, âˆ‡E ) is a nilpotent, admissible indigenous bundle on X log , let PE : T â†’ Ad(E) be its p-curvature. Then the kernel of
PEâˆ¨ : Ad(E) â†’ T âˆ¨ is an FL-bundle.
Moreover, if (E, âˆ‡E ) is a nilpotent, admissible indigenous bundle on X log , there exists
a unique rank one subbundle M âŠ† E that is annihilated by the endomorphisms in the image
of PE . This subbundle M is stabilized by âˆ‡E . The induced connection âˆ‡M has p-curvature
zero, and we have a horizontal isomorphism MâŠ—2 âˆ¼
=T.
Finally, suppose that S is reduced, and (E, âˆ‡E ) is nilpotent, admissible, and indigenous. Let U âŠ† X be an open set, and (L, âˆ‡L ) a line bundle with logarithmic connection
(with respect to f log : X log â†’ S log ) on U . Let Î¹ : L â†’ E|U be a horizontal morphism.
Then Î¹ factors through M âŠ† E.
Proof. First of all, since (E, âˆ‡E ) is admissible, PEâˆ¨ is surjective, and thus its kernel is a
rank two vector bundle F which is stabilized by âˆ‡E , hence gets a connection âˆ‡F . Since
(E, âˆ‡E ) is nilpotent, it follows that T âˆ¼
= Im(PE ) âŠ† F, and that this inclusion T â†’ F
is locally split. Also, this inclusion T â†’ F is necessarily horizontal, and we also have a
horizontal isomorphism F/T âˆ¼
= OX . Thus, in order to show that (F, âˆ‡F ) is an FL-bundle,
it suï¬ƒces to show that the p-curvature of (F, âˆ‡F ) is nonzero generically on every ï¬ber of
f : X â†’ S (by Corollary 1.5). Thus, we may assume that S is the spectrum of a ï¬eld.
Now on some nonempty open set U âŠ† X, there is line bundle with connection (L, âˆ‡L )
and a horizontal surjection Î¼ : E â†’ L such that Im(PE |U ) is given by endomorphisms that
vanish on Ker(Î¼) and whose image is in Ker(Î¼). Then sorting through what we have done,
we see that we have a horizontal isomorphism F|U âˆ¼
= E|U âŠ— Lâˆ’1 . Since L has p-curvature
zero, the fact that E|U has nonzero p-curvature implies that the same is true of F|U . This
completes the proof that (F, âˆ‡F ) is an FL-bundle.
On the other hand, if we are given an FL-bundle (F, âˆ‡F ) whose projectivization
(P, âˆ‡P ) is indigenous, let (E, âˆ‡E ) be an indigenous vector bundle whose projectivization is
(P, âˆ‡P ). Then there exists a line bundle with connection (L, âˆ‡L ) (relative to f log : X log â†’
S log ) such that we have a horizontal isomorphism F âŠ—OX L âˆ¼
= E. Taking determinants,
âˆ¨
T
we thus get a horizontal isomorphism LâŠ—2 âˆ¼
,
so
the
p-curvature
of L must be zero.
=
Thus, under the natural identiï¬cation of Ad(F) with Ad(E), we see that the p-curvatures
of (E, âˆ‡E ) and (F, âˆ‡F ) coincide. Thus, by our computation in Proposition 1.4, (E, âˆ‡E ) is
admissible and nilpotent. Also, it is easy to see that these two procedures are inverse to
one another, thus proving the bijective correspondence. We take M âŠ† E to be T âŠ— L âŠ†
68

F âŠ—Lâˆ¼
= E. The remaining assertions follow immediately from what we have done so far,
plus Proposition 1.6. 
Proposition 2.6. Let (E, âˆ‡E ) be an indigenous bundle on X log . Let PE : T â†’ Ad(E) be
its p-curvature. Then:
(1) We shall call the composite HE : T â†’ Ï„X log /S log of PE with the projection E â†’ Ï„X log /S log arising from the Hodge ï¬ltration on E the square
Hasse invariant of (E, âˆ‡E ). If (E, âˆ‡E ) is admissible, then HE is nonzero.
(2) Suppose that (E, âˆ‡E ) is admissible. Then the zero locus V (HE ) âŠ† X is
a divisor DE which is ï¬nite, ï¬‚at, and of degree (p âˆ’ 1)(2g âˆ’ 2 + r) over
S. We shall call it the double supersingular divisor of (E, âˆ‡E ).
(3) Suppose that the indigenous bundle (E, âˆ‡E ) is admissible and nilpotent.
Then there exists a line bundle H on X whose square HâŠ—2 is isomorphic
to T âˆ¨ âŠ— Ï„X log /S log , together with a section Ï‡ of H over X whose square
is HE . We shall call Ï‡ the Hasse invariant of (E, âˆ‡E ). In particular,
there exists a divisor EE âŠ† X such that DE = 2 EE . We shall call EE
the supersingular divisor of (E, âˆ‡E ).
(4) Suppose that S is reduced. Then any two nilpotent, admissible indigenous bundles with the same supersingular locus are isomorphic.

Proof. For (1), it suï¬ƒces to prove the statement after we restrict to a ï¬ber of f : X â†’ S;
thus, we may assume that S is the spectrum of a ï¬eld. If HE were zero, then that would
mean that Im(PE ) lands in F 0 (Ad(E)). Now F 0 (Ad(E)) surjects onto OX . If the image
of PE in OX is nontrivial, we get a contradication as follows: On the one hand, Im(PE )
is stabilized by âˆ‡E . On the other hand, the fact that the Kodaira-Spencer morphism of
the Hodge ï¬ltration is an isomorphism means that âˆ‡E applied to Im(PE ) will not be in
log
F 0 (Ad(E)). If the image of PE in OX is trivial, then it must lie in F 1 (Ad(E)) âˆ¼
= Ï‰X/S .
Then, by using the fact that the Kodaira-Spencer morphism is an isomorphism, we again
get a contradiction. Assertion (2) follows immediately from (1).
Now suppose that (E, âˆ‡E ) is nilpotent, admissible, and indigenous. Let M âŠ† E be the
rank one subbundle of Proposition 2.5. Let E â†’ N be the surjection arising from the Hodge
ï¬ltration. Then composing the injection M â†’ E with this surjection, we get a morphism
Ï‡ : M â†’ N , whose square (under the identiï¬cations MâŠ—2 âˆ¼
= T ; N âŠ—2 âˆ¼
= Ï„X log /S log ) is equal
to the Hasse invariant. Thus, if we let EE be the zero locus of Ï‡, we have DE = 2 EE .
This proves (3).
To prove (4), we assume that S is the spectrum of a ï¬eld, and that we have two
connections âˆ‡E and âˆ‡E on E, both of which make E a nilpotent, admissible indigenous
bundle, and such that the respective supersingular divisors EE and EE coincide. Let us also
69

assume that âˆ‡E = âˆ‡E + Î¸, where Î¸ is a square diï¬€erential. Let Î¹ : M â†’ E and Î¹ : M â†’ E
be the respective inclusions, and Ï‡ : M â†’ N and Ï‡ : M â†’ N the respective composites
discussed in the preceding paragraph. We claim ï¬rst of all that M and M are isomorphic.
Indeed, this follows from the fact that N âŠ— Mâˆ’1 âˆ¼
= N âŠ— (M )âˆ’1 .
= OX (EE ) = OX (EE ) âˆ¼
Thus, we shall henceforth identify M and M . Now Ï‡ and Ï‡ diï¬€er by multiplication by
a section Î» of OS , that is, Ï‡ = Î» Â· Ï‡ . Let i1 : M â†’ E be Î¹, and let i2 : M â†’ E be Î¹
multiplied by Î». Then it follows that there exists a morphism Î± : M â†’ F 1 (E) such that
i1 = i2 + Î±. Now let s be a horizontal section of M (over some open set U âŠ† X). Since
the p-curvature is a horizontal morphism, âˆ‡E (i1 (s)) = 0 and âˆ‡E (i2 (s)) = 0. Thus, we
compute:
âˆ‡E (i2 (s)) = (âˆ‡E + Î¸)(i1 (s) + Î±(s))
= âˆ‡E (Î±(s)) + Î¸(i1 (s))
Suppose that Î± is nonzero. Then in the last line, the ï¬rst term has a nonzero image under
the surjection E â†’ N (since the Kodaira-Spencer morphism is an isomorphism), while
the second term lies in F 1 (E). Since the sum of these terms is zero, we thus obtain a
contradiction. Thus, Î± must be zero. Then we obtain that Î¸(i1 (s)) = 0, so (if Î¸ = 0, then)
i1 maps into F 1 (E) âŠ† E. But then Ï‡ = 0, so by (2), we again obtain a contradiction. This
completes the proof of (4). 
Proposition 2.7. Suppose that S is reduced. Let (E, âˆ‡E ) be admissible indigenous on
X log . Let PE : T â†’ Ad(E) be the p-curvature. Let U âŠ† X be open, and let (L, âˆ‡L ) be a
line bundle with logarithmic connection (relative to f log ) on U whose p-curvature is zero.
Let Î¹ : L â†’ Ad(E) be a horizontal morphism. Then Î¹ factors through T âˆ¼
= Im(PE ).
Proof. By shrinking U , we may assume that L and T |U have horizontal generating sections
s and t, respectively. We may assume that s and t generate a subbundle G âŠ† Ad(E)|U of
rank two. If we take their commutator in Ad(E), we see that [s, t] must be in G. Indeed, if
this were not the case, then the p-curvature of Ad(E) would be zero. But the p-curvature
of Ad(E) is given by Ad(PE ) which is nonzero everywhere since (E, âˆ‡E ) is admissible. This
proves the claim. Thus, G is a Lie subalgebra of Ad(E), stabilized by the connection on
Ad(E) and whose p-curvature is zero. Being of rank two, it is necessarily solvable, hence
contains a nilpotent subalgebra K âŠ† G which is stabilized by the connection on Ad(E)
and has p-curvature zero. Now K deï¬nes a horizontal ï¬ltration N âŠ† E|U with respect
to which it is nilpotent. Since (N )âŠ—2 âˆ¼
= K, it follows that N has p-curvature zero. Let
Î´ : End(E|U ) â†’ Ad(E)|U be the canonical projection given by quotienting out by the scalar
endomorphisms. Then clearly the image of N âŠ— E|U âŠ† End(E|U ) (i.e., the endomorphisms
that anihilate N âŠ† E|U ) under Î´ is equal to G. Since G and N have p-curvature zero,
it thus follows that E|U has p-curvature zero, which contradicts the fact that (E, âˆ‡E ) is
admissible. 
Proposition 2.8. Suppose that f log is obtained by gluing together various filog , as in
70

the last subsection of Chapter I, Â§2. Suppose that (E, âˆ‡E ) is nilpotent, admissible, and
indigenous on X log . Then it is automatically of restrictable type.
Proof. The subbundle M âŠ† E (of Proposition 2.5) is stabilized by E and has p-curvature
zero. Thus, if we restrict to an irreducible component Xilog , the monodromy at any marked
point of Xilog must be nilpotent with respect to the ï¬ltration deï¬ned by M âŠ† E. This
completes the proof. 
As mentioned earlier, the reason that we are interested in nilpotent, admissible indigenous bundles is that they deï¬ne MF âˆ‡ -objects in the sense of [Falt]. Let us suppose that
S = Spec(k), where k is a perfect ï¬eld, and that f : X â†’ S is smooth. Let S = Spec(A),
where A = W (k)/p2 W (k), and W (k) is the ring of Witt vectors with coeï¬ƒcients in k. Let
 We suppose that S and S are
us denote by Î¦A the canonical Frobenius morphism on S.
endowed with the trivial log structures, and call the resulting log schemes S log and Slog ,
 log â†’ Slog be a smooth r-pointed curve of genus g that lifts f log .
respectively. Let flog : X
 âŠ†X
 be
Let (E, âˆ‡E ) be an indigenous bundle on X log . Let E = F 1 (E) âŠ• (E/F 1 (E)). Let U
 log â†’ U
 log be a lifting of Frobenius. If e is a section of E,
an open subset, and let Î¦log : U
Î¦
âˆ—
1
let âˆ‡E (e) be the section of Î¦ (E/F (E)) âŠ— Ï‰U log /S log obtained by applying âˆ‡E to e (and
regarding the result modulo F 1 (E) âŠ— Ï‰U log /S log ) to get a section of (E/F 1 (E)) âŠ— Ï‰U log /S log ,
then pulling back by Î¦ on E and by p1 dÎ¦ on Ï‰U log /S log . Then we can deï¬ne a logarithmic
connection âˆ‡Î¦ on Î¦âˆ— (EF ) by letting âˆ‡Î¦ (Î¦âˆ’1 (0, eF )) = 0 (if e is a section of E/F 1 (E))
1
and âˆ‡Î¦ (Î¦âˆ’1 (eF , 0)) = (0, âˆ‡Î¦
E (e)) (if e is a section of F (E)). Then, it is easy to see (as
in [Falt], Â§2) that for diï¬€erent Î¦, the pairs (Î¦âˆ— (EF )|U , âˆ‡Î¦ ) glue together to form a bundle
with connection Fâˆ— (E, âˆ‡E ) on X log . Note that Fâˆ— (E, âˆ‡E ) depends on the choice of lifting
 log â†’ Slog .
X
Deï¬nition 2.9. We shall say that (E, âˆ‡E ) forms an MF âˆ‡ -object on X log if
(E, âˆ‡E ) âŠ— (L, âˆ‡L ) âˆ¼
= Fâˆ— (E, âˆ‡E )
 log â†’ Slog and some line bundle with connection (L, âˆ‡L ) whose
for some choice of lifting X
square is trivial.
Note that this deï¬nition is consistent (though slightly weaker, since we allow the ambiguity
of tensoring with (L, âˆ‡L )) with the notion of being an object of the category MF âˆ‡ of [Falt],
Â§2. It is shown in [Falt] (Theorem 6.2) that the de Rham cohomology of a semistable family
of varieties over X log equipped with the Hodge ï¬ltration and the Gauss-Manin connection
forms an object of MF âˆ‡ (as long as pâˆ’ 2 is greater than or equal to the relative dimension
of the family of varieties). The following result provides the link between what we are doing
here and [Falt], Â§2:
71

Proposition 2.10. Let (E, âˆ‡E ) be an indigenous bundle on X log . Then (E, âˆ‡E ) forms an
MF âˆ‡ -object on X log if and only if (E, âˆ‡E ) is admissible and nilpotent.
Proof. First, let us assume that (E, âˆ‡E ) forms an MF âˆ‡ -object on X log for the lifting
 log â†’ Slog . One computes easily from the deï¬nition of the connection âˆ‡Î¦ that the pX
 Also, (just
curvature is nilpotent (with respect to the ï¬ltration 0 âŠ• (Î¦âˆ— E/F 1 (E)) âŠ† Î¦âˆ— E).
1 
as in the proof of Proposition 1.4), the derivative p Î¦ is of the form (1 + t)pâˆ’1 + f  (t).
Thus, since the Kodaira-Spencer morphism is the identity, it follows that the p-curvature
def
(applied to âˆ‚ = d/dt) is obtained by multiplying a section of (Î¦âˆ— F 1 (E)) âŠ• 0 by Î¦âˆ’1 (âˆ‚ F )
times the (p âˆ’ 1)th derivative of (1 + t)pâˆ’1 + f  (t) (which is just âˆ’1) and regarding the
result of this multiplication as a section of 0 âŠ• (Î¦âˆ— E/F 1 (E)). In particular, we see that the
p-curvature is nonzero. Thus, (E, âˆ‡E ) is admissible and nilpotent.
On the other hand, suppose that (E, âˆ‡E ) is admissible and nilpotent. By the bijective
correspondence of Proposition 2.5, (E, âˆ‡E ) corresponds to an FL-bundle (G, âˆ‡G ). By
 log â†’ Slog . It remains to see
Proposition 1.2, this FL-bundle corresponds to a lifting X
âˆ—
that F (E, âˆ‡E ) taken with respect to this lifting is isomorphic to (E, âˆ‡E ) (up to tensoring
with an (L, âˆ‡L ) whose square is trivial). Let N = E/F 1 (E). Let M = Î¦âˆ—X/S (N F ).
Let âˆ‡M be the connection on M for which the sections of N F are horizontal. Thus,
the fact that the
(M, âˆ‡M )âŠ—2 âˆ¼
= (T , âˆ‡T ). Now, sorting through the deï¬nitions and using

Kodaira-Spencer morphism is the identity reveals that if X = U V (where U and V
are aï¬ƒne opens), then Fâˆ— (E, âˆ‡E ) âŠ— (M, âˆ‡M ) is just the extension of OX by T obtained
from the 1-cocycle which is the diï¬€erence between Frobenius liftings on U and V . It thus
follows from the deï¬nition of the canonical morphism F : D â†’ A of Proposition 1.2 that
Fâˆ— (E, âˆ‡E ) âŠ— (M, âˆ‡M ) is exactly the bundle (G, âˆ‡G ). Thus, it follows from the deï¬nition
of the bijective correspondence in Proposition 2.5 that Fâˆ— (E, âˆ‡E ) âˆ¼
= (E, âˆ‡E ) âŠ— (L, âˆ‡L ) for
some (L, âˆ‡L ) whose square is trivial. 
The Inï¬nitesimal Verschiebung
Let Ï‰X/S be the relative dualizing sheaf of f : X â†’ S. Thus, if D âŠ† X is the divisor of
log
marked points, we have Ï‰X/S (D) âˆ¼
= Ï‰X/S . Let Î¦X/S : X â†’ X F be the relative Frobenius
over S. Recall from duality theory (see, e.g., [Harts] for a treatment of duality theory) that
since f and Î¦X/S are local complete intersection morphisms, we have a trace morphism:
trÎ¦X/S : (Î¦X/S )âˆ— Ï‰X/S â†’ (Ï‰X/S )F
where we regard Ï‰X/S as RÎ¦!X/S (Ï‰X/S )F . On the other hand, let Y log be the log scheme
whose underlying scheme is X and whose log structure is the same as that of X log away
from the divisor D of marked points, and equal to the pull-back of the log structure of S log
on the open subscheme where f is smooth. Then we also have a morphism arising from
the log version of the Cartier isomorphism (applied to Y log â†’ S log ):
72

C : (Î¦X/S )âˆ— Ï‰X/S â†’ (Ï‰X/S )F
The following result is â€œwell-known,â€ but I do not know an adequate reference for it:
Lemma 2.11. The morphisms trÎ¦X/S and C are equal.
Proof. By a density argument, we reduce to the case where f is smooth. By naturality,
we reduce to the assertion that these two morphisms are the same when X = Spec(Fp [T ]);
S = Spec(Fp ) (where T is an indeterminate). Since trÎ¦X/S is the reduction modulo p of
a construction that holds in arbitrary or mixed characteristic, we can calculate trÎ¦X/S by
considering the trace map obtained from duality for the ï¬nite morphism Î¦ : Spec(Zp [T ]) â†’
Spec(Zp [T ]) given by T â†’ T p . Since trÎ¦ (Î¦âˆ— (dT )) = p dT , and Î¦âˆ— (dT ) = p T pâˆ’1 dT , it
follows that trÎ¦ (T pâˆ’1 dT ) = dT . By reducing this formula modulo p and comparing with
the construction in [Katz] of the Cartier isomorphism, we obtain the desired result. 
Let (E, âˆ‡E ) be an indigenous bundle on X log . Let HE : T â†’ Ï„X log /S log be the square
Hasse invariant of (E, âˆ‡E ). Then by pulling back via Î¦X log /S log and taking R1 fâˆ— of HE ,
we obtain a canonical morphism:
Î¦Ï„E : (R1 fâˆ— Ï„X log /S log )F â†’ R1 fâˆ— Ï„X log /S log
which we shall call the Frobenius on R1 fâˆ— Ï„X log /S log induced by (E, âˆ‡E ). On the other
log
â†’ T âˆ¨ . Note that
hand, let us consider the dual morphism to HE , that is, HEâˆ¨ : Ï‰X/S
log F
T âˆ¨ = Î¦âˆ—X/S (Ï‰X/S
) . Thus, if we tensor HEâˆ¨ with Ï‰X/S , we get a morphism
log âŠ—2
log F
) (âˆ’D) â†’ Ï‰X/S âŠ—OX Î¦âˆ—X/S (Ï‰X/S
)
(Ï‰X/S
log F
If we then compose this morphism with the trace morphism trÎ¦X/S tensored with (Ï‰X/S
) ,
log âŠ—2
log âŠ—2
we obtain a morphism (Î¦X/S )âˆ— (Ï‰X/S
) (âˆ’D) â†’ ((Ï‰X/S
) (âˆ’D))F . Then applying fâˆ— to
this morphism, we obtain:
log âŠ—2
log âŠ—2
(âˆ’D) â†’ (fâˆ— (Ï‰X/S
) (âˆ’D))F
Î¦Ï‰
E : fâˆ— (Ï‰X/S )
log âŠ—2
which we shall call the Verschiebung on fâˆ— (Ï‰X/S
) (âˆ’D) induced by (E, âˆ‡E ). Observe
that by Serre duality applied to the morphism f , we obtain that the vector bundles
log âŠ—2
) (âˆ’D) and R1 fâˆ— Ï„X log /S log on S are dual to one another. Then relative to this
fâˆ— (Ï‰X/S
duality, we have

Ï„
Proposition 2.12. The morphisms Î¦Ï‰
E and Î¦E are dual to one another.

73

Proof. This follows immediately from duality theory. Namely, the duality between
âŠ—2
(âˆ’D) and R1 fâˆ— Ï„X log /S log is obtained by cup product, followed by the trace morfâˆ— Ï‰X/S
phism trf : R1 fâˆ— Ï‰X/S â†’ OS . On the other hand, since trace morphisms behave well
under composition, we see that trf = (trf )F â—¦ trÎ¦X/S . This fact, combined with the fact
âˆ¨
that Î¦Ï„E (respectively, Î¦Ï‰
E ) is obtained from HE (respectively, HE ), implies the result. 
We are now ready to state and prove the second main result of this Section. Consider the
Verschiebung on indigenous bundles deï¬ned in the ï¬rst subsection of this Section. In the
universal case, it was a morphism
V g,r : S g,r â†’ Qg,r
over Mg,r . Thus, it induces a map on tangent bundles over Mg,r :
Î˜V g,r /Mg,r : Î˜S g,r /Mg,r â†’ Î˜Qg,r /Mg,r
If we pull-back to the point of S g,r deï¬ned by our particular (E, âˆ‡E ), we get a morphism
log âŠ—2
log âŠ—2
Î˜V
(âˆ’D) â†’ (fâˆ— (Ï‰X/S
) (âˆ’D))F
E : fâˆ— (Ï‰X/S )

Then we have the following result:
Theorem 2.13. Let (E, âˆ‡E ) be indigenous on X log . Then the inï¬nitesimal Verschiebung
Ï‰
morphism Î˜V
E is equal to Î¦E .
Proof. First, let us recall Jacobsonâ€™s formula (see, e.g., [Jac], pp. 186-187): This formula
states that if a and b are elements of an associative ring R of characteristic p, then

p

p

p

(a + b) = a + b +

pâˆ’1


si (a, b)

i=1

where the si (a, b) are given by the formula:

pâˆ’1

(ad(ta + b))

(a) =

pâˆ’1


isi (a, b)tiâˆ’1

i=1

computed in the ring R[t], where t is an indeterminate. In our case, we wish to apply this
formula in the case where a = Î±, Î± âˆˆ R, and is an element of the center of R such that
2
= 0. In this case, substitution yields:
74

(a + b)p = bp + (ad(b))pâˆ’1 a
Ï‰
To prove that Î˜V
E = Î¦E , it suï¬ƒces to do a local calculation on X to show that the
inï¬nitesimal change in the trace of the square of the p-curvature is given by âˆ’2 Î¦Ï‰
E . We
log âŠ—2
2

work over the base S[ ]/( ). Let âˆ‡E = âˆ‡E + Î¸, where Î¸ is a section of fâˆ— (Ï‰X/S ) (âˆ’D),
be a connection on E that makes it an indigenous bundle. Let U âŠ† X be an open subset
that avoids the marked points and at which f is smooth. Let x be a local coordinate on U .
def d
.
Write âˆ‡ (respectively, âˆ‡ ; Î¸x ) for âˆ‡E (respectively, âˆ‡E ; Î¸) applied in the direction âˆ‚ = dx
We wish to apply the above formula in the case where b = âˆ‡ and a = Î¸x . We thus
obtain that the inï¬nitesimal change in the p-curvature is given by (ad(âˆ‡))pâˆ’1 Î¸x . Now the
inï¬nitesimal Verschiebung is obtained by multiplying this term by the constant term and
then taking the trace (and multiplying by âˆ’1). Put another way, minus the inï¬nitesimal
Verschiebung is obtained by applying PEâˆ¨ to (ad(âˆ‡))pâˆ’1 Î¸x . Since PEâˆ¨ is horizontal, it
commutes with ad(âˆ‡), so we ï¬nd that:

(âˆ‚)pâˆ’1 (PEâˆ¨ Î¸x ) = (âˆ‚)pâˆ’1 ((PEâˆ¨ Î¸) Â· âˆ‚)
log F
) obtained by evaluating minus the inï¬nitesimal Verschiebung
is the section of Î¦âˆ—X/S (Ï‰X/S
log âŠ—2
(which is a section of Î¦âˆ—X/S {((Ï‰X/S
) )(âˆ’D)}F ) at âˆ‚ F . Thus, to complete the proof of
the Theorem, we must show that
âˆ¨
F
(âˆ‚)pâˆ’1 ((PEâˆ¨ Î¸) Â· âˆ‚) = âˆ’Î¦âˆ’1
X/S {(C âŠ— 1)(PE Î¸) Â· âˆ‚ }
log F
) . Write PEâˆ¨ Î¸ = Î½ Â· Î¶,
Now let Î¶ be a horizontal, locally generating section of Î¦âˆ—X/S (Ï‰X/S
where Î½ is a section of Ï‰X/S . Substituting, we see that it suï¬ƒces to show that:
F
(âˆ‚)pâˆ’1 (Î½ Â· âˆ‚) Â· Î¶ = âˆ’Î¦âˆ’1
X/S (C(Î½) Â· âˆ‚ ) Â· Î¶

If we then divide out the Î¶â€™s, we see that really (just as in [Katz2], (7.1.2.6)), we are
reduced to proving a simple identity concerning diï¬€erentiation in characteristic p. Indeed,
if we regard the equation as an identity in Î½, both sides are Î¦âˆ’1
X/S OX F -linear in Î½ and
vanish when Î½ is exact; thus, we are reduced to proving the identity:
(âˆ‚)pâˆ’1 (xpâˆ’1 ) = âˆ’C(xpâˆ’1 dx) Â· âˆ‚ F
which follows from the deï¬nition of C and the fact that (p âˆ’ 1)! = âˆ’1 in characteristic p.


75

Diï¬€erential Criterion for Admissibility
We maintain the notation of the previous subsection. In the previous subsection, we
computed the relative diï¬€erential map of the Verschiebung morphism V g,r over Mg,r . In
fact, however, with a little more preparation, the same calculation allows us to give an
explicit representation of the diï¬€erential map of the Verschiebung over Fp . Moreover, this
explicit representation allows us to give a diï¬€erential criterion for an indigenous bundle to
be admissible, which is also necessary if the bundle is nilpotent.
Consider the aï¬ƒne bundle Qg,r â†’ Mg,r . Since by deï¬nition, this bundle is the pull
back by the Frobenius morphism on Mg,r of a bundle over Mg,r , it follows that we get
log

a natural connection âˆ‡Q on this aï¬ƒne bundle Qg,r â†’ Mg,r . Let Qg,r be the log stack
log

obtained by pulling back to Qg,r the log structure of Mg,r . Next, let us consider the
canonical exact sequence of tangent bundles on Qg,r :
0 â†’ Î˜Qg,r /Mg,r â†’ Î˜Qlog â†’ Î˜Mlog |Qg,r â†’ 0
g,r

g,r

Thus, our connection âˆ‡Q induces a splitting
Î˜Qlog âˆ¼
= Î˜Qg,r /Mg,r âŠ• Î˜Mlog |Qg,r
g,r

g,r

Now let us consider the â€œfullâ€ inï¬nitesimal Verschiebung, i.e., the morphism induced on
tangent bundles by V g,r :
Î˜V g,r : Î˜S g,r â†’ Î˜Qg,r
On the one hand, we know what the projection of Î˜V g,r to Î˜Mlog |Qg,r is. Thus, we would
g,r

like to compute the projection of Î˜V g,r to Î˜Qg,r /Mg,r . We shall soon see that, in fact, we
have already computed this projection as well, in the course of proving Theorem 2.13.
Suppose (as in the previous subsection) we have a log scheme S log with an r-pointed
stable curve of genus g, f log : X log â†’ S log , and an indigenous bundle (E, âˆ‡E ) on X log .
Then the ï¬rst relative parabolic de Rham cohomology module R1 fDR,âˆ— (Ad(E)) (as in
Chapter I, Theorem 2.8) is naturally isomorphic to the pull-back to S log (via the classifying
morphism for {X log , (E, âˆ‡E )}) of Î˜S log . On R1 fDR,âˆ— (Ad(E)), we have a Hodge ï¬ltration
g,r

log âŠ—2
0 â†’ fâˆ— (Ï‰X/S
) (âˆ’D) â†’ R1 fDR,âˆ— (Ad(E)) â†’ R1 fâˆ— Ï„X log /S log â†’ 0

where the surjection in the above exact sequence is exactly the pull-back to S log of the
projection Î˜S log â†’ Î˜Mlog |S g,r .
g,r

g,r

76

On the other hand, consider the p-curvature of Ad(E): PE : T â†’ Ad(E). Then by
applying â€œR1 fDR,âˆ— â€ to the dual of PE , we get a morphism
R1 fDR,âˆ— (Ad(E)) â†’ R1 fDR,âˆ— (T âˆ¨ )
Now by PoincareÌ duality, we have
R1 fDR,âˆ— (T âˆ¨ ) âˆ¼
= {R1 fDR,âˆ— (T )}âˆ¨
Moreover, we computed R1 fDR,âˆ— (T ) in Proposition 1.1. In particular, we have a natural
inclusion R1 fâˆ— (Ï„X log /S log )F â†’ R1 fDR,âˆ— (T ). Thus, if we compose the above morphism
induced by PEâˆ¨ with the dual surjection to this natural inclusion, we obtain a natural
morphism
log âŠ—2
) (âˆ’D))F
Î˜E : R1 fDR,âˆ— (Ad(E)) â†’ (fâˆ— (Ï‰X/S

Then we have the following result:
Theorem 2.14. Let (E, âˆ‡E ) be indigenous on X log . Then the pull-back to S log of the
projection of Î˜V g,r to Î˜Mlog is given by the surjection in the Hodge ï¬ltration; the pullg,r

back to S log of the projection of Î˜V g,r to Î˜Qg,r /Mg,r is given by Î˜E .
Proof. It remains to prove the statement about the projection to Î˜Qg,r /Mg,r . To do this
we consider an inï¬nitesimal deformation of (E, âˆ‡E ) over S log [ ]/( 2 ). But the section of
log âŠ—2
) (âˆ’D))F that we obtain can be computed locally on X. Moreover, locally on
(fâˆ— (Ï‰X/S
X, this calculation is exactly the same as that of Theorem 2.13. This proves the result. 
Corollary 2.15. Let (E, âˆ‡E ) be indigenous on X log . If Î˜E is surjective, then (E, âˆ‡E ) is
log
log
log
admissible. In particular, if the morphism V g,r : S g,r â†’ Qg,r is log eÌtale at the image of
log

the classifying morphism S log â†’ S g,r for (E, âˆ‡E ), then (E, âˆ‡E ) is admissible.
Proof. Since being admissible is an open condition, it suï¬ƒces to prove the result when S
log
is the spectrum of an algebraically closed ï¬eld. If V g,r is log eÌtale, then by Theorem 2.14,
Î˜E must be surjective. Thus, it suï¬ƒces to prove the ï¬rst statement. Suppose that (E, âˆ‡E )
is not admissible. Thus, the morphism PEâˆ¨ : Ad(E) â†’ T âˆ¨ has a nonempty zero locus.
One can compute the p-curvature explicitly at a marked point (where the monodromy is
nonzero and nilpotent); it follows that the zero locus does not contain any marked points.
Now there are two possibilities: the zero locus either avoids the nodes or it does not.
Let us ï¬rst do the case where the zero locus of PEâˆ¨ avoids the nodes. Since PEâˆ¨ is
horizontal, its zero locus must be the pull-back of some closed subscheme via Î¦X/S . Thus,
77

in particular, there exists some point x âˆˆ X (which is neither a marked point nor a
F
node) such that PEâˆ¨ is zero at Î¦âˆ’1
X/S (x ) (the scheme-theoretic ï¬ber). By the deï¬nition of
log âŠ—2
) (âˆ’D))F
Î˜E , it follows that the image of Î˜E lands in the subspace Vx of H 0 (X, (Ï‰X/S
consisting of sections that vanish at xF . Now by Riemann-Roch on curves, Vx cannot be
log âŠ—2
all of H 0 (X, (Ï‰X/S
) (âˆ’D))F , unless g = 0 and r = 3, or g = 1 and r = 1. This completes
the proof (under the assumption that PEâˆ¨ avoids the nodes), except for these two special
cases. For g = 0, r = 3, we shall show in the subsection of Â§3 on totally degenerate curves
that the unique indigenous bundle on such a curve is necessarily admissible. (One checks
easily that there are no vicious circles in the reasoning.) For g = 1, r = 1, we note that
P(E, âˆ‡E ) is necessarily invariant with respect to the automorphism Î± given by multiplying
by âˆ’1. Thus, if we pull-back by the morphism X â†’ X given by multiplying by 2, it is
still invariant under Î±. Hence it descends to the four-pointed curve of genus zero Y log of
which X log is a log eÌtale double covering. Let us call this descended bundle P(F, âˆ‡F ).
Thus, P(F, âˆ‡F ) is indigenous on Y log . It is easy to see that Î˜E and Î˜F are the same
morphism; thus, the hypothesis holds for P(F, âˆ‡F ), as well. Thus, we reduce to the case
g = 0, r = 4, which has already been checked.

Now let us consider the case where PEâˆ¨ vanishes at a node Î½ âˆˆ X. Let Ï€ log : Z log â†’
X log be the partial normalization of X log at Î½ (where the log structure on Z log is such
def

that the points mapping to Î½ are marked points). Let (F, âˆ‡F ) = Ï€ âˆ— (E, âˆ‡E ). Now let us
consider the commutative diagram:

H 1 (X, Ï„X log /S log )F
â
â

âˆ’â†’

1
HDR
(X log , Ad(E))
â
â

âˆ’â†’ H 1 (X, Ï„X log /S log )
â
â

H 1 (Z, Ï„Z log /S log )F

âˆ’â†’

1
HDR
(Z log , Ad(F))

âˆ’â†’

H 1 (Z, Ï„Z log /S log )

where the vertical arrows are pull-backs via Ï€; the horizontal arrows on the left are induced
by PE ; and the horizontal arrows on the right are induced by the Hodge ï¬ltration. Finally,
the â€œprimeâ€ on the de Rham cohomology on the bottom row indicates that the we are
taking non-parabolic de Rham cohomology on Z log (since (F, âˆ‡F ) may not even have a
natural parabolic structure, if (E, âˆ‡E ) is not of restrictable type). Let Î· be a generator of
the kernel of H 1 (X, Ï„X log /S log ) â†’ H 1 (Z, Ï„Z log /S log ). Let us consider what happens to Î· F
as we move it around the above commutative diagram. Since PE is zero at Î½, if we move it
1
(X log , Ad(E)) lies in
along the top to H 1 (X, Ï„X log /S log ), we get zero. Thus, its image in HDR
log âŠ—2
1
1
) (âˆ’D)). But the pull-back map HDR
(X log , Ad(E)) â†’ HDR
(Z log , Ad(F))
H 0 (X, (Ï‰X/S
log âŠ—2
log âŠ—2
maps H 0 (X, (Ï‰X/S
) (âˆ’D)) injectively into H 0 (Z, (Ï‰Z/S
) ). Going around the other
way, however, (i.e., going down and then to the right), we see that the image of Î· F in
1
1
HDR
(Z log , Ad(F)) is zero. We thus conclude that the image of Î· F in HDR
(X log , Ad(E))
is zero. But this contradicts the surjectivity of Î˜E , since the upper horizontal morphism
on the left-hand side of the above diagram is dual to Î˜E . This completes the proof. 

78

Conversely, let us suppose that (E, âˆ‡E ) is nilpotent and admissible. Then we claim
that Î˜E is necessarily surjective. Indeed, for simplicity, it suï¬ƒces to prove this when S
is the spectrum of a ï¬eld. Let K be the kernel of PEâˆ¨ : Ad(E) â†’ T âˆ¨ . Note that the
connection on Ad(E) restricts to a connection âˆ‡K on K. Thus, (K, âˆ‡K ) is an FL-bundle.
Also, we have a horizontal exact sequence:
0 â†’ T â†’ K â†’ OX â†’ 0
in which the connecting morphism OS â†’ R1 fDR,âˆ— (T ) must be injective (since (K, âˆ‡K ) is
an FL-bundle). Moreover, it is a tautology that the composite of this morphism OS â†’
R1 fDR,âˆ— (T ) with the projection R1 fDR,âˆ— (T ) â†’ OS of Proposition 1.1 is the identity. Thus,
we see that the morphism R1 fâˆ— (Ï„X log /S log )F â†’ R1 fDR,âˆ— (T ) â†’ R1 fDR,âˆ— (K) is injective.
Now let C = Ad(E)/T . We have a connection âˆ‡C on C, induced by the connection on
Ad(E). Thus, we get a horizontal exact sequence:
0 â†’ OX â†’ C â†’ T âˆ¨ â†’ 0
log F
) â†’ R1 fDR,âˆ— (OX ) must be injective (since
in which the connecting morphism (fâˆ— Ï‰X/S
otherwise, C would admit two horizontal, generically linearly indendent sections, which
contradicts the fact that the p-curvature is nonzero). Lastly, we consider the horizontal
exact sequence:

0 â†’ K â†’ Ad(E) â†’ T âˆ¨ â†’ 0
log F
) â†’ R1 fDR,âˆ— (K) with the
in which the composite of the connecting morphism (fâˆ— Ï‰X/S
projection R1 fDR,âˆ— (K) â†’ R1 fDR,âˆ— (OX ) is injective, as we observed above. Since the
image of R1 fâˆ— (Ï„X log /S log )F âŠ† R1 fDR,âˆ— (K) under the map R1 fDR,âˆ— (K) â†’ R1 fDR,âˆ— (OX )
is zero, it thus follows that if we compose the inclusion R1 fâˆ— (Ï„X log /S log )F âŠ† R1 fDR,âˆ— (K)
with the morphism R1 fDR,âˆ— (K) â†’ R1 fDR,âˆ— (Ad(E)), the resulting morphism

R1 fâˆ— (Ï„X log /S log )F â†’ R1 fDR,âˆ— (Ad(E))
is injective. But this morphism is dual to Î˜E . Thus, Î˜E is surjective. This completes the
proof of the claim.
log

log

Let N g,r be the log stack obtained by pulling back the log structure on Mg,r to N g,r .
log

Since N g,r is the zero locus of the Verschiebung, it follows that N g,r is log smooth over
Fp at a point if and only if Î˜E is surjective. In other words:
Corollary 2.16. Suppose that (E, âˆ‡E ) is nilpotent indigenous. Then it is admissible if
log
and only if N g,r is smooth over Fp at the image of classifying morphism S log â†’ N g,r for
(E, âˆ‡E ).
79

Â§3. Hyperbolically Ordinary Curves
Often, in the literature, one speaks of a curve as being â€œordinaryâ€ if its Jacobian is
ordinary. In fact, however, since the Jacobian only represents the â€œabelian partâ€ of the
curve, it is in some sense more intrinsic to speak of a curve as ordinary if it is hyperbolically
ordinary in the sense deï¬ned below. Philosophically, this means that the Verschiebung on
indigenous bundles is a local isomorphism in a neighborhood of an indigenous bundle that
provides a â€œniceâ€ uniformization for the curve. Thus, relative to the analogy (explained in
the Introduction) between the Verschiebung on indigenous bundles and the Beltrami equation, to be hyperbolically ordinary means that the Verschiebung acts (at least locally) as
one might expect from this analogy, given the classical results on existence and uniqueness
of solutions to the Beltrami equation.
Basic Deï¬nitions
Let S log be a ï¬ne noetherian log scheme over Fp . Let f log : X log â†’ S log be an
r-pointed stable curve of genus g (so 2g âˆ’ 2 + r â‰¥ 1). Let D âŠ† X be the divisor of
marked points. Let (E, âˆ‡E ) be an indigenous bundle on X log . Let PE : T â†’ Ad(E) be its
p-curvature. Recall the Frobenius on R1 fâˆ— Ï„X log /S log induced by (E, âˆ‡E ):
Î¦Ï„E : (R1 fâˆ— Ï„X log /S log )F â†’ R1 fâˆ— Ï„X log /S log
that we deï¬ned in Â§2.
Deï¬nition 3.1. We shall call (E, âˆ‡E ) ordinary if Î¦Ï„E is an isomorphism.
Note that the condition of being ordinary is an open condition on S g,r . We shall denote
ord

this open set by S g,r .
Proposition 3.2. If (E, âˆ‡E ) is ordinary, then it is admissible.
Proof. This follows a fortiori from Corollary 2.15. 
The following deï¬nition is key to the entire paper:
Deï¬nition 3.3. We shall say that f log : X log â†’ S log is a hyperbolically ordinary curve if
there exists an eÌtale surjection T â†’ S and a nilpotent, ordinary indigenous bundle (E, âˆ‡E )
on X log Ã—S T .
80

When the context is clear, we shall simply say that f log is an â€œordinary curve.â€ The reason
for the descriptive â€œhyperbolicallyâ€ is that in the literature, the term â€œordinary curveâ€ is
frequently used to mean that its Jacobian is ordinary. In this paper, when f log has an
ordinary Jacobian, we shall say that f log is parabolically ordinary.
Proposition 3.4. If the ï¬ber of f log : X log â†’ S log over s âˆˆ S is hyperbolically ordinary,
then there exists an open set U âŠ† S with s âˆˆ U such that f log |U is hyperbolically ordinary.
In particular, f log : X log â†’ S log is hyperbolically ordinary if and only if all its ï¬bers are
hyperbolically ordinary.
Proof. Indeed, it suï¬ƒces to consider the universal example. Recall that N g,r âŠ† S g,r is the
locus of nilpotent indigenous bundles. Write Ï€ : N g,r â†’ Mg,r for the natural projection.
Let n âˆˆ N g,r ; let m âˆˆ Mg,r be the point Ï€(n). Then it follows from Theorem 2.13, plus
the deï¬nition of N g,r as the zero locus of V g,r that if n is ordinary, then Ï€ must be eÌtale
at n. Thus, Ï€ is open at n. This completes the proof. 
We shall denote the open subscheme of Mg,r (respectively, N g,r ) consisting of hyperord

bolically ordinary curves (respectively, nilpotent, ordinary indigenous bundles) by Mg,r
ord

(respectively, N g,r ). Thus, we have a natural eÌtale surjection
ord

ord

Ï€ : N g,r â†’ Mg,r
ord

Finally, let us note that over S g,r , we have an eÌtale local system in Fp -vector spaces
of dimension 3g âˆ’ 3 + r obtained by taking the sections of Î˜Mlog |S ord that are invariant
g,r

g,r

under the Frobenius action on Î˜Mlog |S ord given by âˆ’Î¦Ï„E . (Note the minus sign in front of
g,r

g,r

âˆ’Î¦Ï„E ! It will be important later in Chapter III.) Let us denote this local system by Î˜et
g,r ,
ord

and call it the tangential local system on S g,r . Similarly, by taking its dual Î©et
g,r we obtain
ord

ord

a local system on S g,r which we shall call the diï¬€erential local system on S g,r . Often, we
shall be interested in the restrictions of these local systems to N g,r .
The Totally Degenerate Case
In this subsection, we show that totally degenerate curves are hyperbolically ordinary.
ord
By Proposition 3.4, this will show that Mg,r is an open dense subscheme of Mg,r . Since
totally degenerate curves have no moduli, there is no loss of generality in assuming that
S = Spec(Fp ). We begin by considering the case g = 0, r = 3. Recall the morphisms
constructed at the end of Chapter I, Â§3:
log

N log : M1,1 [2] â†’ M1,1
81

(parametrizing elliptic curves with level structures on the two-torsion points) and
log

log

Î›log : M1,1 [2] â†’ M0,4
which takes an elliptic curve to the four-pointed curve of genus zero of which it is a
log
double covering. Then in this case, we have M0,4 = X log . Let us construct a nilpotent,
log

admissible indigenous bundle on M0,4 . Since X log has only one indigenous P1 -bundle
(up to isomorphism), this will complete the proof of Corollary 2.15. To do this, we note
that (as we saw in Example 3 of Chapter I, Â§2), the ï¬rst de Rham cohomology module of
log
the universal elliptic curve over M1,1 [2] deï¬nes an indigenous vector bundle (E, âˆ‡E ). Let
(P â†’ X, âˆ‡P ) be the associated P1 -bundle. Now since the map â€œmultiplication by âˆ’1â€ on
an elliptic curve induces the map â€œmultiplication by âˆ’1â€ on E, it follows that (E, âˆ‡E ) will
not descend via Î›. However, since â€œmultiplication by âˆ’1â€ induces the identity on P â†’ X,
we see that (P â†’ X, âˆ‡P ) does descend via Î›. This gives us an indigenous bundle on
X log . To see that it is nilpotent and admissible, it suï¬ƒces to see that (E, âˆ‡E ) is nilpotent
and admissible. But by (a rather trivial special case of) [Falt], Theorem 6.2, as a de
Rham cohomology module, (E, âˆ‡E ) necessarily forms an MF âˆ‡ -object (see Deï¬nition 2.9).
Thus, Proposition 2.10 tells us that (E, âˆ‡E ) is nilpotent and admissible. In particular, this
completes the proof of Corollary 2.15.
Now let us assume that f log : X log â†’ S log is formed by gluing together a number of
copies of the 3-pointed stable curve of genus zero (as in the last subsection of Chapter I,
Â§2). Then, as we saw in this ï¬nal subsection of Chapter I, Â§2, we can glue together the
nilpotent, admissible indigenous bundles that we constructed in the previous paragraph
to obtain a nilpotent, admissible indigenous bundle (P â†’ X, âˆ‡P ) on X log . On the other
hand, by Proposition 2.8, every nilpotent, admissible indigenous bundle on X log is of
restrictable type. Since there is (up to isomorphism) only one indigenous P1 -bundle of
restrictable type on X log , it thus follows that:
Proposition 3.5. Up to isomorphism, a totally degenerate r-pointed stable curve of genus
g admits one and only one nilpotent, admissible indigenous P1 -bundle.
Next, let us consider the cohomology group H 1 (X, Ï„X log /S log ) of our totally degenerate
curve. If X log is obtained by gluing together various copies Xilog of the 3-pointed stable
curve of genus zero, let Y log be the disjoint union of the Xilog , and let Î½ log : Y log â†’ X log
be the natural map. Let 0 â†’ Ï„X log /S log â†’ Î½ âˆ— Ï„Y log /S log â†’ C â†’ 0 be the natural exact
sequence (where C is deï¬ned so as to make the sequence exact). By considering the long
exact cohomology sequence associated to this exact sequence of sheaves, we see that we
obtain a natural isomorphism H 1 (X, Ï„X log /S log ) âˆ¼
= H 0 (X, C). On the other hand, C is
naturally isomorphic to the direct sum of the (Ï„X log /S log )|z , where z ranges over all the
nodes in X. Moreover, the residue map gives a natural isomorphism Ï„X log /S log |z âˆ¼
= OS
(well-deï¬ned up to sign). Let Î£ be the set of nodes of X. Then
82

C=

(OS )z
zâˆˆÎ£

where the subscript â€œzâ€ is just used as a marker, to indicate which copy of OS one is
referring to. Thus, we have a natural isomorphism (well-deï¬ned up to sign on each factor):
H 1 (X, Ï„X log /S log ) âˆ¼
=

(Fp )z
zâˆˆÎ£

In particular, since Fp has a natural bilinear form (given by ring multiplication Fp Ã— Fp â†’
Fp ), using this bilinear form on each factor (Fp )z gives a natural bilinear form:
B : H 1 (X, Ï„X log /S log ) Ã— H 1 (X, Ï„X log /S log ) â†’ Fp
which is now independent of all arbitrary choices of sign.
Proposition 3.6. For every totally degenerate r-pointed curve of genus g, there is a
natural nondegenerate bilinear form B on the OS -module R1 fâˆ— Ï„X log /S log which takes values
in OS .
Next we would like to show that the unique nilpotent, admissible indigenous bundle
(P â†’ X, âˆ‡P ) on X log is ordinary. To do this, we must compute the induced Frobenius
action on H 1 (X, Ï„X log /S log ). By using an isomorphism as above
H 1 (X, Ï„X log /S log ) âˆ¼
=

(Fp )z
zâˆˆÎ£

we see that it suï¬ƒces to compute the induced Frobenius action on the various (Fp )z â€™s.
Consider P |z . The Hodge section Ïƒ : X â†’ P deï¬nes a point Ïƒz âˆˆ P |z (Fp ). On the other
hand, there is a unique point ï¬xed by the monodromy action qz âˆˆ P |z (Fp ). If we think of
P as P(J /J [3] ) (as in Chapter I, Proposition 2.5), then (J /J [3] )z = VÏƒ âŠ• Vq , where VÏƒ
(respectively, Vq ) is the subspace deï¬ned by Ïƒz (respectively, qz ). Note that by the residue
map, we have natural isomorphisms VÏƒ âˆ¼
= Fp and Vq âˆ¼
= Fp . Thus, we obtain a basis
[3]
{(1, 0); (0, 1)} of (J /J )z . Let EÏƒ and Eq be the nilpotent endomorphisms of (J /J [3] )z
given, respectively, by the matrices


0 1





0

0

1

0



and
0 0

Thus, Eq is essentially the p-curvature of (Ï€ : P â†’ X, âˆ‡P ) restricted to z. Sorting through
all the deï¬nitions, it thus follows that the induced Frobenius action on (Fp )z is given by
multiplication by tr(EÏƒ Â· Eq ) = 1. We thus obtain the following result:
83

Proposition 3.7. On a totally degenerate r-pointed stable curve X log of genus g over Fp ,
the Frobenius action Î¦Ï„P on H 1 (X, Ï„X log /S log ) induced by the unique nilpotent, admissible
indigenous bundle on X log is the identity. In particular, this unique nilpotent, admissible
indigenous bundle is ordinary, and so is X log .
ord

ord

Corollary 3.8. The open subschemes Mg,r âŠ† Mg,r and N g,r âŠ† N g,r are nonempty.
The Case of Elliptic Curves: The Parabolic Picture
One can get a better feel for ordinariness for general r-pointed stable curves of genus
g by ï¬rst studying ordinariness for elliptic curves. In the case of elliptic curves, there are,
in fact, two possible theories of ordinary bundles and curves: the parabolic theory and
the hyperbolic theory. Indeed, let f log : X log â†’ S log be a 1-pointed stable curve of genus
1, with marked point : S â†’ X. Let Y log be the log scheme obtained from X log (as
in the subsection â€œThe Inï¬nitesimal Verschiebungâ€ of Â§2) by removing the marked point.
Then the parabolic theory (respectively, hyperbolic theory) is obtained by considering the
various properties of the p-curvature of indigenous bundles on Y log (respectively, X log ).
So far in this Chapter, of course, we have only been considering the hyperbolic theory.
However, since the notion of an indigenous bundle is deï¬ned for Y log , one can consider
its p-curvature, and deï¬ne the notions of a nilpotent indigenous bundle, or an admissible
indigenous bundle, just as before. Also, many of the results (though not all) such as
Theorem 2.3 (where we replace the â€œ3g âˆ’ 3 + râ€ by 1) continue to hold in the parabolic
context. The purpose of this subsection is to summarize what happens when one studies
elliptic curves from the parabolic point of view, and to show, in particular, that the notion
of ordinariness that we have deï¬ned in this paper (in terms of the p-curvature of indigenous
bundles) reduces to the classical notion of ordinariness of elliptic curves.
log

log

First, we introduce some notation. Let M1,0 = M1,1 . (The point here is that we
log

shall use the notation M1,0 when we are thinking about elliptic curves from the parabolic
point of view.) Let f : G â†’ M1,0 be the universal elliptic curve, with identity section
: M1,0 â†’ G. Let L = fâˆ— Ï‰G/M1,0 be the Hodge bundle. Let G log be the log stack whose
log

underlying stack is G and whose log structure is the pull-back of the log structure on M1,0 .
Let S 1,0 â†’ M1,0 be the torsor over LâŠ—2 of Schwarz structures on G log . Then just as before,
we can deï¬ne a Verschiebung:
V 1,0 : S 1,0 â†’ Q1,0
Just as before we have a closed subscheme N 1,0 âŠ† S 1,0 consisting of nilpotent indigenous
adm

bundles, and an open subscheme S 1,0 âŠ† S 1,0 consisting of admissible indigenous bundles.
Also, just as before, we deï¬ne an indigenous bundle to be ordinary if its inï¬nitesimal Verschiebung is an isomorphism, and we deï¬ne an elliptic curve to be (parabolically) ordinary
if it admits a nilpotent, ordinary indigenous bundle.
84

Now recall that in Example 2 of Chapter I, Â§2, we constructed a canonical indigenous
bundle on G log . This indigenous bundle thus deï¬nes a global section Ï„S : M1,0 â†’ S 1,0
which trivializes the LâŠ—2 -torsor S 1,0 â†’ M1,0 . Moreover, by [KM], p. 227, one knows that
if p â‰¥ 5, then H 0 (M1,0 , LâŠ—2 ) = 0, so this trivialization is unique. Let us also recall that,
in the deï¬nition of the indigenous bundle (E, âˆ‡E ) in Example 2 of Chapter I, Â§2, we had
a subbundle 0 âŠ• OG âŠ† Ï‰ âŠ• OG = E (where Ï‰ = Ï‰G/M1,0 ) which was stabilized by the
connection âˆ‡E . Moreover, the induced connection on OG was the trivial connection. Put
another way, E admits a nonzero horizontal section. It thus follows that the p-curvature
of âˆ‡E is nilpotent. Thus, Ï„S : M1,0 â†’ S 1,0 lands inside N 1,0 .
Let Î¸ be a section of LâŠ—2 over some eÌtale V â†’ M1,0 . Let âˆ‡Î¸E be the connection
formed by adding to âˆ‡E the endomorphism given by
E = Ï‰ âŠ• OG â†’ OG â†’ Ï‰ âŠ—2 âˆ¼
= (Ï‰ âŠ• 0) âŠ— Ï‰ âŠ† E âŠ— Ï‰
where the ï¬rst morphism is the natural projection; the second morphism is multiplication
by Î¸; and the ï¬nal inclusion is the natural one. Let Î´ be a section of L over V which is
everywhere nonzero. Thus, the sections Î´ and 1 deï¬ne a global trivialization of E = Ï‰ âŠ• OG
over GV . We shall write sections of E|V in terms of this basis, given by Î´ and 1. Write
Î¸ = Ï† Â· Î´ 2 , where Ï† is a function on V . Let âˆ‡Î¸ be the morphism E|V â†’ E|V given by
evaluating âˆ‡Î¸E on Î´ âˆ’1 . Then we see that âˆ‡Î¸ is given by the following matrix:


0

Ï†

1

0



To obtain the p-curvature of âˆ‡Î¸E , we must iterate this matrix p times. This yields the
matrix:

Ï†

1
2 (pâˆ’1)

Â·

0 Ï†
1



0

Now let us write Î´ âˆ’p = h Â· Î´ âˆ’1 (so h is the classical Hasse invariant). Thus, to compute
the p-curvature of âˆ‡Î¸E , we must subtract from the matrix just given the following matrix:

hÂ·

0 Ï†
1



0

Thus, we obtain that the p-curvature of âˆ‡Î¸E is given by:

(Ï†

1
2 (pâˆ’1)

âˆ’ h) Â·
85

0

Ï†

1

0



If we then take the determinant, we obtain our Verschiebung (applied to (Î´ F )2 ):
1

1

âˆ’Ï† Â· (Ï† 2 (pâˆ’1) âˆ’ h)2 = âˆ’Ï†p + 2h Â· Ï† 2 (p+1) âˆ’ h2 Â· Ï†
Let us rewrite this in invariant form. The trivialization Ï„S of S 1,0 â†’ M1,0 allows us to
write S 1,0 as Spec(âŠ•iâ‰¥0 LâŠ—âˆ’2i ). On the other hand, Q1,0 is given by Spec(âŠ•iâ‰¥0 LâŠ—âˆ’2pÂ·i ).
Thus, V 1,0 is determined by specifying the morphism of quasi-coherent sheaves:
Î“V : LâŠ—âˆ’2p â†’

LâŠ—âˆ’2i
iâ‰¥0

Let us denote the component of Î“V that maps into LâŠ—âˆ’2i by Î“V : LâŠ—âˆ’2p â†’ LâŠ—âˆ’2i . Since
[i]
L is ample, it follows that Î“V = 0 when i > p (as we saw already in the proof of Theorem
2.3). Let Ï‡ âˆˆ Î“(M1,0 , Lpâˆ’1 ) be the Hasse invariant (as in [KM], p. 353). Then we see
that we have proven the following result:
[i]

[i]

[i]

Theorem 3.9. If i = p, then Î“V is multiplication by âˆ’1. If i = 12 (p + 1), then Î“V
[i]
is multiplication by 2 Ï‡. If i = 1, then Î“V is multiplication by âˆ’Ï‡2 . For all other i,
[i]
Î“V = 0.
In particular, this completes the proof of Theorem 2.3.
Corollary 3.10. Geometrically, N 1,0 consists of two irreducible components I1 and I2 :
One, I1 , is the section Ï„S . The other, I2 , is nonreduced, and (I2 )red may be described as
follows: In [KM], p. 361, one ï¬nds a description of the Igusa curve Ig(p), with its canonical
(Z/pZ)Ã— -action. Then (I2 )red is the quotient of Ig(p) by the subgroup {Â±1} âŠ† (Z/pZ)Ã— .
In order to see which nilpotent bundles are ordinary, we must compute the derivative
of the Verschiebung map. In terms of the local objects we used in the computation above,
we obtain that â€œdV/dÏ†â€ is given by:
1

h(Ï† 2 (pâˆ’1) âˆ’ h)
In particular, if h = 0, then the inï¬nitesimal Verschiebung is identically zero, while if
h = 0, then the inï¬nitesimal Verschiebung at Ï„S is nonzero. Moreover, because of the
square factor in the expression for the Verschiebung, we see that if h = 0, then the only
nilpotent indigenous bundle at which the inï¬nitesimal Verschiebung will be nonzero is the
indigenous bundle given by Ï„S . We thus obtain the following:
Theorem 3.11. An elliptic curve is parabolically ordinary if and only if it is ordinary
in the classical sense (i.e., its Hasse invariant is nonzero). If it is ordinary, then the
indigenous bundle constructed in Example 2 of Chapter I, Â§2, is the unique nilpotent,
ordinary indigenous bundle on the curve.

86

The Case of Elliptic Curves: The Hyperbolic Picture
In this subsection, we consider 1-pointed stable curves of genus 1 as hyperbolic objects.
In particular, we shall highlight the numerous contrasts with the parabolic viewpoint
presented above. We begin by considering the torsor S 1,1 â†’ M1,1 . Recall that this
torsor has a canonical trivialization at inï¬nity, deï¬ned by the unique nilpotent, admissible
indigenous bundle on the singular 1-pointed stable curve of genus 1 (Proposition 3.5). Let
us suppose that our prime p is â‰¥ 5. Then it follows from Chapter I, Theorem 3.6, that
S 1,1 â†’ M1,1 does not admit a section which passes through the canonical trivialization
at inï¬nity. Now let us consider the closed subscheme N 1,1 âŠ† S 1,1 . By Theorem 2.3, the
natural morphism N 1,1 â†’ M1,1 is ï¬nite and ï¬‚at of degree p. Let us consider the irreducible
component I âŠ† N 1,1 which passes through the canonical trivialization at inï¬nity. Then
I is generically reduced. Moreover, the degree of I â†’ M1,1 must be â‰¥ 2. This behavior
already is substantially diï¬€erent from the parabolic case, where the irreducible component
passing through the unique nilpotent, ordinary indigenous bundle at inï¬nity has degree
one over M1,0 . Thus, in particular, N 1,1 (respectively, V 1,1 ) is not isomorphic to N 1,0
(respectively, V 1,0 ), despite the fact that as stacks, M1,1 âˆ¼
= M1,0 ; S 1,1 âˆ¼
= S 1,0 ; Q1,1 âˆ¼
= Q1,0 .
Since N 1,1 â†’ M1,1 has degree p, it follows that there exist points of N 1,1 over the inï¬nity
point of M1,1 at which N 1,1 â†’ M1,1 is not eÌtale. Such points correspond to nilpotent
indigenous bundles which are not admissible (by Proposition 3.5). This fulï¬lls our earlier
pledge to show the existence of such bundles. Of these various observations, we record the
following for later reference:
Proposition 3.12. If p â‰¥ 5, then the irreducible component of N 1,1 passing through the
canonical trivialization at inï¬nity is generically reduced and has degree â‰¥ 2 over M1,1 .
The Generic Uniformization Number
We return to the case of an r-pointed stable curve of genus g, where r and g are
arbitrary (but satisfy 2g âˆ’ 2 + r â‰¥ 1). Suppose we are given the combinatorial data Î” (as
at the end of Chapter I, Secion 2: consisting of a graph Î“, plus Î»i â€™s, etc.) for a totally
degenerate curve. We shall call two collections of such data Î” and Î” equivalent if they
deï¬ne isomorphic totally degenerate curves. Let us denote by Dg,r the equivalence classes
of such data Î”. Alternatively, one may think of Dg,r as the set of isomorphism classes of
totally degenerate r-pointed stable curves of genus g. Now let us consider the morphism:
N g,r â†’ Mg,r
We know that it is ï¬nite, ï¬‚at, and of degree p3gâˆ’3+r . If Î” âˆˆ Dg,r , consider the irreducible
component IÎ” of N g,r that passes through the unique nilpotent, admissible indigenous
bundle (as in Proposition 3.5) on the curve corresponding to Î”. Then IÎ” is generically
reduced. Let GÎ” be the degree of IÎ” over Mg,r . We shall refer to GÎ” as the generic
87

uniformization number for the data Î”. (The reason for attaching the term â€œuniformizationâ€
to this number will become apparent in later Chapters.) Let
Gg,r =



GÎ”

Î”âˆˆDg,r

Now let us suppose that p is suï¬ƒciently large so that the class Î£ (Chapter I, Theorem 3.4)
in H 1 (Mg,r , Î©Mlog ) is nonzero. Then we have the following rough result:
g,r

Proposition 3.13. For g â‰¥ 3 and p suï¬ƒciently large, the number GÎ” is between 2 and
p3gâˆ’3+r .
Proof. The upper bound follows from the fact that N g,r â†’ Mg,r has degree p3gâˆ’3+r . On
the other hand, since N g,r â†’ Mg,r is ï¬nite, and Mg,r is normal, it follows that if IÎ” had
degree 1 over Mg,r , it would, in fact, be isomorphic to Mg,r , hence deï¬ne a section of S g,r
over Mg,r . By Chapter I, Theorem 3.4, we know that this is impossible, for p suï¬ƒciently
large. 
It is not clear to the author how far these bounds are from being sharp. For instance,
it could be the case that N g,r is, in fact, irreducible. To compute the number GÎ” exactly
would involve understanding the monodromy around curves that are not hyperbolically
ordinary. That is to say, it would involve proving a sort of hyperbolic analogue of Igusaâ€™s
theorem on the monodromy around supersingular elliptic curves in the parabolic case.
It is interesting to know, however, that GÎ” = 1 because this constitutes a departure from the behavior of complex indigenous bundles. To see this, we must ï¬rst explain
certain aspects of the analogy between the complex case and the characteristic p case
treated here. First of all, the condition of being nilpotent (and ordinary) is analogous, in
the complex case, to having real monodromy. Indeed, to be nilpotent (and admissible)
is (by Proposition 2.10) the same as coming from an MF âˆ‡ -object in the sense of [Falt].
But to be an MF âˆ‡ -object means, essentially, that the bundle with connection admits a
Frobenius action, i.e., that the monodromy is Frobenius-invariant. Since the Frobenius
at the inï¬nite prime is complex conjugation, it is thus natural to regard nilpotent (and
admissible) bundles as the characteristic p analogue of complex indigenous bundles with
real monodromy. On the other hand, in the complex case, within the real-analytic space
of complex indigenous bundles with real monodromy, there is a canonical, topologically
isolated component, corresponding to the indigenous bundle arising from the uniformization by the upper half-plane. On the other hand, in the characteristic p case treated here,
the fact that IÎ” has degree â‰¥ 2 over Mg,r means that there is no canonical choice of a
nilpotent, ordinary indigenous bundle, even on a generic curve: since the monodromy at
the curves which are not hyperbolically ordinary is nontrivial, one such indigenous bundle
is always carried around to another.

88

Chapter III: Canonical Modular Frobenius Liftings
Â§0. Introduction
The present Chapter is central to the entire paper. In it, we construct a canonical
ord
Frobenius lifting on (N g,r )log , and a canonical indigenous bundle on the universal curve
ord

over (N g,r )log . This pair of a canonical Frobenius lifting and a canonical indigenous
bundle are uniquely characterized by the fact that, relative to this Frobenius lifting, the
renormalized Frobenius pull-back (Deï¬nition 1.4) of the canonical indigenous bundle is
equal to itself. In some sense, an ordinary (in the sense of Deï¬nition 1.1) Frobenius lifting
is like a p-adic analogue of a KaÌˆhler metric on a complex manifold in that it gives rise
to local canonical coordinates. Since there are a number of general properties of ordinary
Frobenius liftings that we will need throughout the rest of the paper, we give a basic
exposition of the properties of such Frobenius liftings in the ï¬rst Section of this Chapter.
The main result is that such a Frobenius lifting deï¬nes canonical aï¬ƒne and multiplicative
ord
coordinates. Thus, in particular, our canonical Frobenius lifting on (N g,r )log deï¬nes such
ord

ord

canonical coordinates on N g,r . Since N g,r is eÌtale over Mg,r , if one thinks of a point
ord

of N g,r as a point of Mg,r , together with a choice (from a ï¬nite number of possibilities)
of some added structure â€“ which we call a p-adic quasiconformal equivalence class â€“ then
we obtain the result that for every choice of a p-adic quasiconformal equivalence class, we
obtain a canonical local uniformization of Mg,r . The reason for the name â€œquasiconformal
equivalence class,â€ is that once one chooses this piece of data for a curve, we shall see
in this Chapter and in following Chapters that the uniformization theory of the curve is
entirely determined. This is reminiscent of Bersâ€™ approach (as in [Bers]) to proving that
hyperbolic curves can be uniformized by the upper half plane: Namely, he proves that (in
the complex case) all hyperbolic curves with the same genus and number of marked points
belong to the same quasiconformal equivalence class. Thus, once we choose this class in
the p-adic case, we obtain a â€œcovariantâ€ uniformization by the aï¬ƒne space modeled on
the tangent space to Mg,r at the curve in question. To obtain uniformizations by the
quadratic diï¬€erentials (as in the complex case), we need more information than just the
quasiconformal equivalence class. Namely, we need a topological marking of the curve.
Once we deï¬ne this, we obtain uniformizations by the quadratic diï¬€erentials.
The canonical Frobenius gives rise to another natural notion, for which I know no
parallel in the complex case: a canonical lifting of a curve over a perfect ï¬eld to the ring of
Witt vectors with coeï¬ƒcients in that ï¬eld. This is reminiscent of the canonical lifting of an
elliptic curve in Serre-Tate theory. In fact, this analogy is more than philosophical: Just
as in Chapter II, by using indigenous bundles on elliptic curves â€“ regarded parabolically â€“
one can obtain a similar uniformization theory, involving a canonical Frobenius lifting (on
the moduli stack of ordinary elliptic curves) and a canonical indigenous bundle. We then
compute that these canonical objects for elliptic curves are precisely the canonical objects
89

that one obtains from classical Serre-Tate theory. Thus, one may regard the theory of
uniformizations and canonical liftings discussed in this Chapter as the natural hyperbolic
analogue of Serre-Tate theory.
Â§1. Generalities on Ordinary Frobenius Liftings
Let k be a perfect ï¬eld of odd characteristic p. Let A = W (k), the ring of Witt
vectors with coeï¬ƒcients in k. Let S be a formally smooth, geometrically connected p-adic
formal scheme over A of constant relative dimension d. Let S log be a log formal scheme
whose underlying formal scheme is S and whose log structure is given by a relative divisor
with normal crossings D âŠ† S over A. Let Î¦A : A â†’ A be the Frobenius morphism on A.
Let us denote the result of base changing by Î¦A by means of a superscripted â€œF .â€ Let
Î¦log : S log â†’ S log be a Frobenius lifting, i.e., a morphism whose reduction modulo p is the
usual Frobenius morphism in characteristic p. In this Section, we shall study the case of
a certain kind of Frobenius lifting, called an ordinary Frobenius lifting. It turns out that
such Frobenius liftings deï¬ne various types of canonical parameters. It is these canonical
parameters that will constitute the various â€œuniformizationsâ€ that we obtain in this paper.
Basic Deï¬nitions
Let us consider the morphism
log
dÎ¦log : Î¦âˆ— Î©log
S/A â†’ Î©S/A

induced by Î¦log on logarithmic diï¬€erentials. It is always divisible by p.
Deï¬nition 1.1. We shall call Î¦log : S log â†’ S log an ordinary Frobenius lifting if p1 Â· dÎ¦log :
log
Î¦âˆ— Î©log
S/A â†’ Î©S/A is an isomorphism.

We shall use the notation
log
Î©Î¦ : Î¦âˆ— Î©log
S/A â†’ Î©S/A

to denote the isomorphism p1 Â· dÎ¦log . Note that by considering the sections of Î©log
S/A which
are invariant under Î©Î¦ , we obtain an eÌtale sheaf Î©et
Î¦ in free Zp -modules of rank d on S.
Deï¬nition 1.2. We shall call Î©et
Î¦ the canonical diï¬€erential local system on S associated
to Î¦log . We shall call its dual Î˜et
Î¦ the canonical tangential local system on S associated to
log
Î¦ .
90

Moreover, by taking the sections of Î©et
Î¦ to be horizontal, we obtain a natural connection
log
log
âˆ‡Î© on Î©S/A which is associated to Î¦ . Note that since Î©et
Î¦ is an eÌtale (not just log eÌtale)
local system on S, the connection âˆ‡Î© is a connection on S with respect to the trivial log
structure, i.e., it has no logarithmic poles at D.
The Uniformizing Galois Representation
Now we would like to associate to Î¦log a canonical â€œuniformizing MF âˆ‡ -objectâ€ (where
we use the category MF âˆ‡ in the sense of [Falt], Â§2) as follows. Let
P = Î©log
S/A âŠ• OS
We regard P as being ï¬ltered by taking the ï¬ltration
def

def

def

0
F 2 (P) = 0; F 1 (P) = Î©log
S/A âŠ• 0 âŠ† P; F (P) = P

Let âˆ‡P be the logarithmic connection on P obtained as follows: We start with the connection âˆ‡P on P which is the direct sum of the trivial connection on OS and the connection

âˆ‡Î© on Î©log
S/A . Then we add to âˆ‡P the End(P)-valued logarithmic diï¬€erential given by
log
log
âˆ¼
P â†’ Î©log
S/A = (0 âŠ• OS ) âŠ—OS Î©S/A âŠ† P âŠ—OS Î©S/A

where the ï¬rst morphism is the projection on the ï¬rst direct summand. The resulting
logarithmic connection on P will be called âˆ‡P . Note that the Kodaira-Spencer morphism
for F 1 (P) âŠ† P with respect to âˆ‡P is the identity map. Next, we deï¬ne the Frobenius
action on P as follows: We take the Frobenius action to be the morphism PÎ¦ : Î¦âˆ— P â†’ P
which is diagonal with respect to the direct sum decomposition P = Î©log
S/A âŠ• OS and is
equal to Î¦âˆ’1 on OS and to dÎ¦log on Î©log
S/A . One sees easily that this Frobenius action PÎ¦
is horizontal with respect to âˆ‡P . Note that this implies that âˆ‡P is integrable, since its
âˆ¨
2 log
log
acts
curvature would deï¬ne a Frobenius-invariant section of (Î©log
S/A ) âŠ—OS âˆ§ Î©S/A , but Î¦
on this bundle with slope 1, so any Frobenius-invariant section must necessarily vanish.
Thus,
(P, F Â· (P), âˆ‡P , PÎ¦ )
deï¬nes an MF âˆ‡ -object in the sense of [Falt], Â§2.
Deï¬nition 1.3. We shall call this MF âˆ‡ -object the uniformizing MF âˆ‡ -object on S log
associated to Î¦log .
91

log
Now choose a base point s : Spf(A) â†’ S that avoids D. Let Î S log = Ï€1 (SK
, sK ),
where K is the quotient ï¬eld of A, and by the fundamental group of â€œS log ,â€ we mean the
fundamental group of the open formal subscheme which is the complement of divisors that
deï¬ne the log structure. Then by the theory of [Falt], Â§2, the uniformizing MF âˆ‡ -object
on S log deï¬nes a dual crystalline Galois representation

Pet
of Î S log .
Deï¬nition 1.4. We shall call this Galois representation the uniformizing Galois representation on S log associated to Î¦log .
Note that OS âˆ¼
= (0 âŠ• OS ) âŠ† P is stabilized by âˆ‡P and PÎ¦ , and thus deï¬nes an MF âˆ‡ subobject of the uniformizing object which is equal to the trivial MF âˆ‡ -object. If we take
the quotient of the uniformizing MF âˆ‡ -object by this subobject, we obtain the MF âˆ‡ object corresponding to the eÌtale Galois representation Î˜et
Î¦ , Tate twisted once. Thus, we
have an exact sequence of Î S log -modules
0 â†’ Î˜et
Î¦ (1) â†’ Pet â†’ Zp â†’ 0
which thus deï¬nes an extension class:
Î·Î¦ âˆˆ H 1 (Î S log , Î˜et
Î¦ (1))
We remark relative to the analogy between Frobenius liftings and KaÌˆhler metrics, that the
class Î·Î¦ formally â€œlooksâ€ somewhat like the diï¬€erential form that deï¬nes a KaÌˆhler metric.
Also, we can deï¬ne a ring with Galois action which will be useful later. First consider
the symmetric algebra on Î©et
Î¦ (âˆ’1) over Zp :
SÂ·Zp Î©et
Î¦ (âˆ’1)
Let us consider the Galois action of Î S log on this symmetric algebra which diï¬€ers from
the direct sum of the actions on the Si (Î©et
Î¦ (âˆ’1)) by the class Î·Î¦ . Thus, in other words,
Spec of the symmetric algebra with this Galois action parametrizes sections of the exact
sequence
0 â†’ Î˜et
Î¦ (1) â†’ Pet â†’ Zp â†’ 0
If we then adjoin the divided powers of the augmentation ideal to this Zp [Î S log ]-algebra,
we obtain a Zp -algebra AÎ¦ . Let T log â†’ S log be the ï¬nite covering given by Î¦log (so
92

T log âˆ¼
= S log ). Since this ï¬nite covering is log eÌtale in characteristic zero, we may form the
subgroup Î T log âŠ† Î S log corresponding to this covering. Then one sees easily that we have
a natural Î T log -action on AÎ¦ , compatible with the Î S log -action on the symmetric algebra.
(We need to restrict to Î T log so that the Galois action respects the divided powers.)
Deï¬nition 1.5. We shall call Î·Î¦ the canonical Galois extension class associated to Î¦log .
We shall call AÎ¦ the ring of additive periods of Î¦log .
The Canonical p-divisible Group
Let us look at the uniformizing MF âˆ‡ -object
(P, F Â· (P), âˆ‡P , PÎ¦ )
again. Let U âŠ† S be the open formal subscheme which is the complement of the divisor
U . Then by [Falt], Theorem 7.1, this MF âˆ‡ -object deï¬nes a p-divisible group GÎ¦ over U .
Moreover, just as with the corresponding Galois representation discussed in the previous
subsection, we have an exact sequence of p-divisible groups over U :
0 â†’ Î˜et
Î¦ (1) âŠ—Zp Qp /Zp â†’ GÎ¦ â†’ Qp /Zp â†’ 0
Deï¬nition 1.6. We shall call GÎ¦ the canonical p-divisible group associated to Î¦log .
Now let Ï‰ âˆˆ Î©et
Î¦ be an element whose reduction modulo p is nonzero. Thus, Ï‰ deï¬nes
a Zp -linear morphism
Ï‰(âˆ’) : Î˜et
Î¦ â†’ Zp
Let Sn â†’ S be the eÌtale covering deï¬ned by taking the kernel of the morphism Î S log â†’
n
n
GL(Î˜et
Î¦ âŠ— Z/p Z). Let Un â†’ U be its restriction to U . Then over Un , Ï‰(âˆ’) âŠ— Z/p Z will
be Galois equivariant, so that, by pushing forward the above exact sequence by means of
Ï‰(âˆ’), we obtain an exact sequence of ï¬nite ï¬‚at group schemes:
0 â†’ Z/pn Z(1) â†’ GÏ‰,n â†’ Z/pn Z â†’ 0
which, by Kummer theory, deï¬nes an element
n

Ã—
Ã— p
uÏ‰,n âˆˆ Î“(Un , OU
)/Î“(Un , OU
)
n
n

and thus a diï¬€erential
93

Ï‰n = (duÏ‰,n )/uÏ‰,n âˆˆ Î“(Un , Î©Un /A âŠ— Z/pn Z)
def

Now let n â†’ âˆ. Let S be the p-adic completion of the inverse limit of the Sn . Since the
various Ï‰n are compatible, we thus obtain a diï¬€erential
, Î©
Ï‰  âˆˆ Î“(U
/A )
U
Now we would like to claim that Ï‰  is none other than the original diï¬€erential Ï‰ that we
started out with. In some sense, I believe that this fact is well-known, but I do not know
of a clear reference for this fact, so I will prove it explicitly here. First, however, we need
to make a few more general observations concerning GÎ¦ . The proof will be given in the
subsection after the next.
Logarithms of Periods
Suppose that k is algebraically closed, and let z : Spf(A) â†’ S be a rational point
whose reduction modulo p is equal to the base point s. In particular, it follows that z
 (since it coincides with the base point s
maps into U , and factors canonically through U
modulo p). Thus, we can restrict the GÏ‰,n to Spec(A) via z so as to obtain an extension
0 â†’ Qp /Zp (1) â†’ GÏ‰,z â†’ Qp /Zp â†’ 0
of p-divisible groups over Spec(A). By Kummer theory, this extension deï¬nes a unit
uÏ‰,z âˆˆ AÃ—
whose image in the residue ï¬eld k is 1.
On the other hand, we can consider the DieudonneÌ crystal EÏ‰ of GÏ‰,z . Thus, EÏ‰
is a free A-module of rank two with a ï¬ltration F 1 (EÏ‰ ) âŠ† EÏ‰ , and a Frobenius action
Î¦E : EÏ‰F â†’ EÏ‰ . This Frobenius action has a unique subspace EF âŠ† EÏ‰ (respectively,
EV âŠ† EÏ‰ ) on which Frobenius acts with slope zero (respectively, one). Also, EV and
F 1 (EÏ‰ ) deï¬ne the same subspace modulo p. Since F 1 (EÏ‰ ) and E/F 1 (EÏ‰ ) are naturally
isomorphic to A, in the future, we shall identify them with A. Thus, by projection EF â†’
EÏ‰ â†’ EÏ‰ /F 1 (EÏ‰ ) = A, we obtain a natural isomorphism of EF with A, and, dually,
a natural isomorphism of EV with A. Finally, since EÏ‰ = EF âŠ• EV , we may regard
F 1 (EÏ‰ ) âŠ† EÏ‰ as the graph of an A-linear morphism A = EV â†’ A = EF , which, by means
of the various canonical trivializations, gives us an element LÏ‰,z âˆˆ p Â· A.
Theorem 1.7. We have LÏ‰,z = log(uÏ‰,z ).
94

Proof. Let us denote the sequence of Galois modules which are the p-adic Tate modules
of the above exact sequence of p-divisible groups by 0 â†’ W 0 â†’ W â†’ W 1 â†’ 0. Recall the
exponential map of [BK], p. 359, Deï¬nition 3.10,
1
exp : F 1 (EÏ‰ )âŠ—âˆ’2 âˆ¼
(Zp (1))
= A â†’ AÃ— = HGal
1
where the ï¬rst isomorphism is the trivialization referred to above, and HGal
denotes Galois
cohomology with respect to Gal(K/K), where K is the quotient ï¬eld of K. By [BK], p. 359,
Example 3.10.1, one knows that this exponential map is equal to the ordinary exponential
map deï¬ned by the exponential series. Let Î·2 = log(uÏ‰,z ); Î·1 = exp(Î·2 ).

Now we diagram-chase. Let us denote by P the (inï¬nite dimensional) Galois module
Bcrys f =1 âŠ• BDR + (notation of [BK]). Applying the exact sequence (1.17.1) of [BK] to the
exact sequence of Galois modules 0 â†’ W 0 â†’ W â†’ W 1 â†’ 0, we obtain the following
commutative diagram:
0
(W 0 )
HGal
â
â

âˆ’â†’

0
HGal
(W )
â
â

âˆ’â†’

0
HGal
(W 1 )
â
â

âˆ’â†’

1
HGal
(W 0 )
â
â

0
(W 0 âŠ— P)
HGal
â
â

âˆ’â†’

0
HGal
(W âŠ— P)
â
â

âˆ’â†’

0
HGal
(W 1 âŠ— P)
â
â

âˆ’â†’

1
HGal
(W 0 âŠ— P)
â
â

0
HGal
(W 0 âŠ— BDR )

âˆ’â†’

0
HGal
(W âŠ— BDR )

0
âˆ’â†’ HGal
(W 1 âŠ— BDR ) âˆ’â†’

1
HGal
(W 0 âŠ— BDR )

0
(W 1 ) which maps via the connecting homomorphism to
Now we have an element 1 âˆˆ HGal
1
0
1
Î·1 âˆˆ HGal (W ); since the image of Î·1 in HGal
(W 0 âŠ—P) is zero, we can consider log(Î·1 ) = Î·2 .
0
0
On the other hand, 1 âˆˆ HGal
(W 1 ) maps to an element Î·3 âˆˆ HGal
(W 1 âŠ— P) that dies when
1
(W 0 âŠ— P). Thus we see that Î·3 comes from
hit with the connecting homomorphism to HGal
0
0
an element Î·4 âˆˆ HGal (W âŠ— P) which is unique modulo HGal
(W 0 âŠ— P). Mapping Î·4 down
0
0
0
one step to HGal
(W âŠ— BDR ), we get Î·5 âˆˆ HGal
(W âŠ— BDR ) that dies in HGal
(W 1 âŠ— BDR ),
0
0
0
0
hence comes from a unique Î·6 âˆˆ HGal (W âŠ— BDR )/HGal (W âŠ— P) = T V . Now it follows
from the explicit deï¬nitions of the maps in the sequence (1.17.1) of [BK] that Î·6 is precisely
LÏ‰,z . On the other hand, it follows from general principles of homological algebra that
Î·6 = Î·2 . This completes the proof. 

Compatibility of Diï¬€erentials
Now we return to the issue of showing that Ï‰  = Ï‰. Let us begin by observing that Ï‰
 , we
can also be deï¬ned as follows. By taking the direct limit of the GÏ‰,n â€™s restricted to U
obtain an extension of p-divisible groups
0 â†’ Qp /Zp (1) â†’ GÏ‰ â†’ Qp /Zp â†’ 0
95

 . This, moreover, deï¬nes a DieudonneÌ crystal (E, âˆ‡E ) with a ï¬ltration F 1 (E) âŠ† E,
over U
and Frobenius action. In fact, (E, âˆ‡E ) is obtained from (P, âˆ‡P ) simply by pulling back
0 â†’ OS â†’ P â†’ Î©S/A â†’ 0 via Ï‰Â· : OU â†’ Î©S/A |U . Now F 1 (E) and E/F 1 (E) may
be identiï¬ed with OU . Thus, Ï‰ is precisely the diï¬€erential obtained by considering the
Kodaira-Spencer morphism
F 1 (E) = OU â†’ Î©U/A âŠ— (E/F 1 (E)) = Î©U/A
Now let Rz be the complete local ring which is the completion at z of U . Let RzPD be
the p-adic completion of the PD-envelope of Rz at the augmentation ideal Rz â†’ A deï¬ned
by z. Now taking the inverse limit of the uÏ‰,n â€™s deï¬nes a unit
uÏ‰ âˆˆ (RzPD )Ã—
whose image in the residue ï¬eld k is 1. Thus, we can consider log(uÏ‰ ) âˆˆ RzPD .
On the other hand, let Pz = P(z âˆ— E) = P(EÏ‰ ). Let ÏƒF : S â†’ Pz (respectively, ÏƒV :
S â†’ Pz ) denote the section determined by the subspace EF âŠ† EÏ‰ (respectively, EV âŠ† EÏ‰ ).
The trivializations discussed previously deï¬ne an isomorphism of the tangent space to Pz
at ÏƒF with A. Thus, in summary, we get an isomorphism Ïˆ : Pz âˆ¼
= P1 by sending ÏƒF
(respectively, ÏƒV ) to inï¬nity (respectively, zero) and using the trivialization of tangent
space to ÏƒF to remove the remaining multiplicative ambiguity. Let PRzPD = P(E)|Spf(RzPD ) .
Then âˆ‡E gives an isomorphism
ÎP : PRzPD âˆ¼
= RzPD âŠ—A Pz
which, when composed with Ïˆ, gives an isomorphism Î¼ : PRzPD âˆ¼
= P1RzPD . Now by Theorem
1.7, it follows that the Hodge section (deï¬ned by F 1 (E) â†’ E)
Ïƒ : Spf(RzPD ) â†’ PRzPD âˆ¼
= P1RzPD
is (in terms of the standard coordinate t on P1 , which vanishes at zero and has a pole at
inï¬nity) simply log(uÏ‰ ). (Indeed, Theorem 1.7 tells us that this is true after restriction
to any A-valued point of RzPD ; hence it must be true over RzPD .) It thus follows that the
def

pull-back of the diï¬€erential dt on P1 via Ïƒ is simply Ï‰  = duÏ‰ /uÏ‰ . But, tracing through
all the deï¬nitions, the pull-back of dt via the Hodge section is exactly the Kodaira-Spencer
morphism of the Hodge ï¬ltration. Thus, we conclude that Ï‰ = Ï‰  over RzPD . On the other
 (since O â†’ RPD is injective).
hand, it is clear that this implies that Ï‰ = Ï‰  over all of U
z

U
Thus, we have proven the following
.
Theorem 1.8. We have Ï‰ = duÏ‰ /uÏ‰ = Ï‰  over U
96

Note that this holds (by descent) without the assumption that k is algebraically closed.
Canonical Liftings of Points in Characteristic p
Let Î±1 âˆˆ S(A) be an A-valued point of S. Suppose we apply Î¦ to Î±1 to obtain an
A-valued point Î²1 âˆˆ S(A). Then since Î¦ is a Frobenius lifting, it induces zero on the
morphism on cotangent spaces modulo p. Thus, Î²1 (mod p2 ) depends only on Î±1 (mod p).
Let Î±2 = Î¦âˆ’1
A (Î²1 ). Thus, Î±2 â‰¡ Î±1 (mod p), and Î±2 depends only on Î±1 (mod p). If we then
continue in this fashion, deï¬ning
Î±i+1 = Î¦âˆ’1
A Î¦(Î±i )
def

it is clear that Î±i â‰¡ Î±1 (mod p) for all i â‰¥ 1, and that the sequence {Î±i } of points in S(A)
converges p-adically. Let Î±âˆ âˆˆ S(A) be the limit of this sequence. Let Î±0 âˆˆ S(k) be the
reduction of Î±1 modulo p. Note that we have
F
Î¦(Î±âˆ ) = Î±âˆ

and that, moreover, Î±âˆ is the unique A-valued point of S which has this property and is
equal to Î±0 modulo p.
Deï¬nition 1.9. We shall call Î±âˆ the canonical lifting of Î±0 . We shall call an A-valued
point of S which is a canonical lifting of some k-valued point a canonical A-valued point
of S.
All the canonical extensions that we have deï¬ned become trivial when restricted to Î±âˆ .
More precisely,
Proposition 1.10. If Î±0 âˆˆ U (k), then the restriction of uÏ‰ to Î±âˆ is 1.
Proof. Indeed, the Hodge ï¬ltration of P is invariant under Î¦, so its restriction to Î±âˆ
is still Frobenius invariant. By the theory of ï¬ltered DieudonneÌ modules with Frobenius
action over A = W (k), it thus follows that the extension of p-divisible groups that one
obtains is trivial. Thus, by Kummer theory, uÏ‰ |Î±âˆ = 1. 
Canonical Multiplicative Parameters
Let us assume just in this subsection that k is algebraically closed. Let z âˆˆ S(k) be
a k-valued point of S. Let Szlog be the completion of S log at z. Thus, Szlog is Spf of a
complete local ring Rz which is noncanonically isomorphic to
97

A[[t1 , . . . , td ]]
with the restriction of the divisor D deï¬ned by t1 Â· t2 Â· . . . Â· ti (where i may be zero). Then
log
if we restrict Î©et
Î¦ to Sz , we obtain the trivial local system.
Let Ï‰ âˆˆ Î©et
Î¦ have integral residues at all the irreducible components of D, and nonzero
reduction modulo p. Thus, Ï‰ deï¬nes a surjection
Ï‰(âˆ’) : Î˜et
Î¦ â†’ Zp
If we apply Ï‰(âˆ’) to our canonical extension of p-divisible groups
0 â†’ Î˜et
Î¦ (1) âŠ—Zp Qp /Zp â†’ GÎ¦ â†’ Qp /Zp â†’ 0
def

we obtain an extension of Qp /Zp by Qp /Zp (1) over Uz = Sz |U . By Kummer theory, we
thus obtain a â€œlogarithmic unitâ€
qÏ‰,z âˆˆ Rz [

1
1
, . . . , ]Ã—
t1
ti

which is well-deï¬ned up to multiplication by a TeichmuÌˆller representative of an element of
k. If Ï‰ has residue ej at the component of D deï¬ned by tj , then the valuation of qÏ‰,z at
(tj ) is equal to ej . Indeed, this follows from the formula dqÏ‰,z /qÏ‰,z = Ï‰ (of Theorem 1.8).
Next, let us consider Î¦âˆ’1 (qÏ‰,z ). Since Î¦âˆ’1 multiplies dqÏ‰,z /qÏ‰,z = Ï‰, as well as the
p
, for some
canonical extension of p-divisible groups by p, it follows that Î¦âˆ’1 (qÏ‰,z ) = Î» Â· qÏ‰,z
Î» âˆˆ [kÃ— ] (where the brackets mean â€œthe TeichmuÌˆller representative ofâ€). On the other
hand, because Î¦ is a Frobenius lifting, reducing modulo p shows that Î» = 1. Thus, we
have that
p
Î¦âˆ’1 (qÏ‰,z ) = qÏ‰,z

Deï¬nition 1.11. We shall call qÏ‰,z for such an Ï‰ a canonical multiplicative parameter
associated to Î¦log .
Canonical Aï¬ƒne Coordinates
In this subsection, k need not be algebraically closed. Let Î± âˆˆ U (A) be canonical.
Let AÎ± be the p-adic completion of the PD-envelope of S at the subscheme Im(Î±). Let
Î±
â†’ A be the augmentation that deï¬nes the point Î±. Let I = Ker( Î± ). The
Î± : A
A-algebra structure, together with the augmentation Î± deï¬ne a splitting
98

AÎ± = A âŠ• I
which we shall call the augmentation splitting of AÎ± . Note that we have an A-linear
Frobenius action
Î¦A : (AÎ± )F â†’ AÎ±
induced by the Frobenius lifting Î¦. Moreover, Î¦A preserves the augmentation splitting,
as well as the ring structure of AÎ± .
Let us consider the slopes of this Frobenius action Î¦A . Clearly, Î¦A acts on AâŠ•0 âŠ† AÎ±
as Î¦A . Next, we note that since Î¦A is a Frobenius lifting, it maps I into p Â· I. Thus, we
have
Î¦A (I [j] ) âŠ† pj Â· I [j]
where the superscript in brackets denotes the divided power. By the deï¬nition of an
def
ordinary Frobenius lifting, Î©Î± = I/I [2] has constant slope one. Thus, if we divide Î¦A
restricted to Î©Î± by p, we obtain an isomorphism
(Î©Î± )F â†’ Î©Î±
Next, let us consider the A-submodule Î©can âŠ† I which is the closure (in the p-adic
topology) of the intersection of the images of ( 1p Â· Î¦A |I )N (for all N â‰¥ 1). Since I/I [2] has
slope 1, it is clear that the projection Î©can â†’ Î©Î± is surjective. Now let us consider the
intersection of Î©can with I [2] . Let Ï† = ( p1 Â· Î¦A |I )N (Ïˆ), where Ïˆ âˆˆ I. If Ï† is contained in
I [2] modulo pN , then since I/I [2] has slope 1, it follows that Ïˆ must also be contained in
I [2] modulo pN . But then Ï† = ( p1 Â·Î¦A |I )N (Ïˆ) must be zero modulo pN . Thus, we conclude
that the projection Î©can â†’ Î©Î± must be an isomorphism. Inverting this isomorphism, we
thus get a canonical morphism
Îº A : Î© Î± â†’ AÎ±
Let S Î± be the formal scheme which is the p-adic completion of the PD-envelope in S of
the image of Î± âˆˆ U (A). Let Î˜Î± be the dual A-module to Î©Î± . Let Î˜aï¬€
Î± be the p-adic
completion of the PD-envelope at the origin of the aï¬ƒne space modeled on Î˜Î± . Thus, Î˜aï¬€
Î±
is Spf of the p-adic completion of the PD-envelope of the symmetric algebra (over A) of
Î©Î± at the augmentation ideal. We may then reinterpret the canonical morphism ÎºA as an
isomorphism
Î±
U can : Î˜aï¬€
Î± â†’S

99

We thus see that we have proven the following result:
Theorem 1.12. For every choice of a canonical Î± âˆˆ U (A), we obtain a local uniformization (canonically associated to Î¦)
âˆ¼ Î±
U can : Î˜aï¬€
Î± = S
of S by the aï¬ƒne space modeled on Î˜Î± .
Deï¬nition 1.13. We shall call the elements of the image of ÎºA canonical aï¬ƒne parameters
associated to Î¦ at Î±.
Now let (B, mB ) be a local ring with residue ï¬eld k which is p-adically complete and
has a topologically nilpotent PD-structure on mB . Let Î² âˆˆ S(B) be such that Î²(mod mB ) âˆˆ
S(k) is equal to Î±(mod p) âˆˆ S(k). Let S Î² be the p-adic completion of the PD-envelope of
S âŠ—A B at the image of Î² in S(B). Thus, S Î² âˆ¼
= S Î± âŠ—A B. Let B Î² = AÎ± âŠ—A B. By tensoring
the canonical morphism ÎºA constructed above with B, we thus obtain a morphism
def

ÎºB : (Î©Î± )B = (Î©Î± ) âŠ—A B â†’ B Î²
Let Î² : B Î² â†’ B be the augmentation corresponding to the point Î² âˆˆ S(B). Let IÎ² =
Ker(Î²). Let
B Î² = B âŠ• IÎ²
be the splitting deï¬ned by Î² and the B-algebra structure on B Î² . Let us consider the
projections of ÎºB on these two factors:
Îº0B : (Î©Î± )B â†’ B;

Îº1B : (Î©Î± )B â†’ IÎ²

[2]

Let Î©Î² = IÎ² /IÎ² . If we compose Îº1B with the projection to Î©Î² , we thus obtain a morphism
Î¨Î±Î² : (Î©Î± )B â†’ Î©Î²
which is an isomorphism, since it is an isomorphism modulo mB , where Î² coincides with
Î±(mod p). Let Î˜Î² the dual B-module to Î©Î² . Now we may regard Îº0B as an element
âˆ’1
of (Î˜Î± )B ; if we apply (Î¨âˆ¨
, then we get an element of ÎºÎ² âˆˆ Î˜Î² , hence âˆˆ mB Â· Î˜Î²
Î±Î² )
(since Î² â‰¡ ( Î± )B modulo mB ). On the other hand, if we compose Îº1B with Î¨âˆ’1
Î±Î² , we get a
Î²
morphism Î©Î² â†’ B which gives us an isomorphism
100

Î²
U Î² : Î˜aï¬€
Î² â†’S

In summary, we have proven the following result:
Theorem 1.14. For every Î² âˆˆ S(B) as above, we obtain a canonical class ÎºÎ² âˆˆ mB Â· Î˜Î² ,
as well as a local uniformization
âˆ¼ Î²
U Î² : Î˜aï¬€
Î² =S
of S by the aï¬ƒne space modeled on Î˜Î² . Moreover, this uniformization is related to the
canonical uniformization by tensoring over A with B, applying the isomorphism
âˆ’1
: (Î˜Î± )B â†’ Î˜Î²
(Î¨âˆ¨
Î±Î² )

and then translating by ÎºÎ² . Finally, for all Î² âˆˆ S(B) whose reductions modulo mB are
equal to Î±(mod p), the correspondence Î² â†’ ÎºÎ² is a bijection of such Î² onto mB Â· Î˜Î² .
Proof. All the statements except the last follow from the way we constructed the objects involved. The last statement about the bijection follows from simply evaluating the
canonical uniformization of Theorem 1.12 on B-valued points. 
Finally, we remark (relative to the analogy between Frobenius liftings and KaÌˆhler
metrics) that these canonical aï¬ƒne parameters are like canonical coordinates for a real
analytic KaÌˆhler metric.
The Relationship Between Aï¬ƒne and Multiplicative Parameters
Let us continue with the notation of the preceding subsection, but let us assume in
addition that k is algebraically closed, so that the canonical multiplicative parameters are
deï¬ned. Let Ï‰ âˆˆ Î©et
Î¦ have integral residues at all the irreducible components of D, and
nonzero reduction modulo p. Since Î©et
Î¦ âŠ† Î©Î± , we may also regard Ï‰ as an element of
Î©Î± . Then we would like to establish the relationship between the canonical multiplicative
parameter qÏ‰,Î± and the canonical aï¬ƒne parameter ÎºA (Ï‰).
First note that by Proposition 1.10, qÏ‰,Î± evaluated at Î± is a TeichmuÌˆller representative.
Thus, log(qÏ‰,Î± ) âˆˆ AÎ± is zero at Î±, as is ÎºA (Ï‰) âˆˆ AÎ± . Moreover, d log(qÏ‰,Î± ) = Ï‰, by
Theorem 1.8. On the other hand, the fact that d ÎºA (Ï‰) = Ï‰ is a tautology. Thus,
log(qÏ‰,Î± ) and ÎºA (Ï‰) have the same derivative and both vanish at Î±. We thus obtain the
following result:
101

Theorem 1.15. We have ÎºA (Ï‰) = log(qÏ‰,Î± ) in AÎ± .

Â§2. Construction of the Canonical Frobenius Lifting
log

In this Chapter, we shall denote by Mg,r the p-adic formal stack of r-pointed stable
curves of genus g over Zp . We shall denote the reductions of objects over Zp to Fp or Z/p2 Z
ord

by means of a subscripted Fp or Z/p2 Z. Let (N g,r )Fp â†’ (Mg,r )Fp be the eÌtale morphism
ord

in characteristic p of Chapter II, Â§3. Thus, (N g,r )Fp parametrizes pairs consisting of an
r-pointed stable curve of genus g in characteristic p, together with an ordinary, nilpotent
ord
indigenous bundle. Let N g,r â†’ Mg,r be the unique eÌtale morphism of p-adic formal
ord

ord

schemes that lifts (N g,r )Fp â†’ (Mg,r )Fp . Thus, N g,r is a smooth p-adic formal scheme
ord

over Zp whose reduction modulo p is (N g,r )Fp . Our goal in this Section is to construct a
ord

canonical ordinary lifting of Frobenius on N g,r .
Modular Frobenius Liftings
In this subsection, we reinterpret certain constructions from Chapter II, Â§1, in terms of
liftings of the Frobenius morphism on (Mg,r )Fp . Let S â†’ (Mg,r )Fp be eÌtale, and let S log
log

be the log scheme obtained by pulling back the log structure of Mg,r . Thus, in particular,
S is smooth over Fp . Let Î¦S log : S log â†’ S log be the absolute Frobenius morphism.
Since (Mg,r )Fp âŠ† (Mg,r )Z/p2 Z is deï¬ned by a nilpotent ideal, the eÌtale morphism S â†’
(Mg,r )Fp lifts naturally to an eÌtale morphism S â†’ (Mg,r )Z/p2 Z . We let Slog be the
log scheme obtained by pulling back the log structure of (Mg,r )Z/p2 Z . We shall call a
Frobenius lifting on Slog a log morphism Slog â†’ Slog whose reduction modulo p is equal
to Î¦S log . Note that by assigning to eÌtale morphisms U â†’ S the set of Frobenius liftings
 log , we obtain a sheaf L on the eÌtale site of S, with the natural structure of a torsor
on U
def
âˆ—
over Î˜Î¦
S log = Î¦S Î˜S log , where Î˜S log is the dual vector bundle to the sheaf of logarithmic
diï¬€erentials on S log . Moreover, this torsor naturally admits a connection âˆ‡L as follows:
Consider the sheaf of bianalytic functions OS bi on S log . The image IÎ¦S of the Frobenius
âˆ’1
morphism Î¦S bi : OS bi â†’ OS bi is equal to iL (Î¦âˆ’1
S OS ), as well as to iR (Î¦S OS ) (where
iL , iR : OS â†’ OS bi are the left and right injections). Thus, the pull-back of the sheaf
L by either iL or iR is equal to the sheaf of liftings of IÎ¦S to a Z/p2 Z-ï¬‚at subalgebra of
OSbi . This gives a connection âˆ‡L on the Î˜Î¦
S log -torsor L â†’ S which is compatible with
Î¦
the natural connection on Î˜S log (for which sections of Î¦âˆ’1
S Î˜S log are horizontal); also, one
checks easily that âˆ‡L is integrable.
Now let us recall the Î˜Î¦
S log -torsor D â†’ S that we deï¬ned in Chapter II, Â§1. Let
log

f log : X log â†’ S log be the pull-back to S log of the universal curve over (Mg,r )Fp . Recall
102

log F
then that D is the Î˜Î¦
) = X log Ã—S log ,Î¦Slog
S log -torsor consisting of liftings of the curve (X

S log â†’ S log to an S-ï¬‚at
curve Y log â†’ Slog . Note that it follows immediately from the
log

deï¬nition of the classifying log stack Mg,r (plus the fact that S â†’ Mg,r is eÌtale) that we
have an isomorphism
Î±:Dâ†’L
 log â†’ Slog (which
of Î˜Î¦
S log -torsors given by considering the classifying map of the lifting Y
is, by deï¬nition, a Frobenius lifting on Slog ). On the other hand, the theory of Chapter II, Â§1, gives a natural connection âˆ‡D on D â†’ S as follows. Recall the line bundle
def
T = (Î¦X log /S log )âˆ— (Ï„X log /S log )F on X log . By declaring the sections of the Ï„X log /S log inside
the deï¬nition of T to be horizontal, we see that T gets a natural connection âˆ‡T over X log
(i.e., not just in the relative sense for f log : X log â†’ S log ). Thus, the de Rham cohomology
module R1 fDR,âˆ— (T ) has a Gauss-Manin connection âˆ‡GM on S log . By Chapter II, Proposition 1.1, we have a natural surjection R1 fDR,âˆ— (T ) â†’ OS , which one veriï¬es easily to be
horizontal. Since, by Chapter II, Proposition 1.2, D is just the sheaf of sections of this
surjection R1 fDR,âˆ— (T ) â†’ OS , it thus follows that, as such, D gets a natural connection
(induced by âˆ‡GM ), which we shall call âˆ‡D .
Proposition 2.1. The isomorphism Î± is horizontal with respect to âˆ‡D and âˆ‡L .
Proof. Let us denote by X L (respectively, X R ) the pull-back of f log : X log â†’ S log via
iL : OS â†’ OS bi (respectively, iR : OS â†’ OS bi ) to S bi . Thus, we obtain a diagram over
S bi :
X L â† X bi â†’ X R
Let us denote the left-pointing (respectively, right-pointing) arrow by Ï€L (respectively, Ï€R ).
Similarly, we have an analogous diagram with tildes, for the various objects over Z/p2 Z.
Now consider the image of Frobenius IÎ¦S âŠ† OS bi . We also have the image of the absolute
Frobenius on X, which we denote by IÎ¦X âŠ† OX bi . Note that IÎ¦X actually sits inside both
OX L and OX R .
Suppose next that we are given a Z/p2 Z-ï¬‚at subalgebra IÎ¦S âŠ† OSbi that lifts IÎ¦S . This
corresponds to a section Î· of LL = LR . (Here the superscript â€œLâ€â€™s and â€œRâ€â€™s denote
left and right pull-backs to S bi , respectively.) The obstruction to lifting IÎ¦X to a Z/p2 Z1 L
L
S
ï¬‚at subalgebra of OX
L compatible with IÎ¦ deï¬nes a class in R (f )âˆ— (T ), which is, by
def

def

deï¬nition, equal to Î¾[L] = (Î±L )âˆ’1 (Î·). Similarly, we obtain a class Î¾[R] = (Î±R )âˆ’1 (Î·).
Note that (Ï€L )âˆ’1 (Î¾[L]) = (Ï€R )âˆ’1 (Î¾[R]), since both classes are the obstruction to lifting
IÎ¦X to a Z/p2 Z-ï¬‚at subalgebra of OX bi compatible with IÎ¦S . Let us call this common class
Î¾[bi].
103

Now suppose that (I )SÎ¦ âŠ† OS is a Z/p2 Z-ï¬‚at lifting of IÎ¦S . Suppose that this lifting corresponds to a section Î¶ of L. If we then take Î· = Î¶ L (in the previous paragraph), we get Î¾[bi] = (Ï€L )âˆ’1 {(Î±âˆ’1 (Î¶))L }, and, similarly, if we take Î· = Î¶ R , we get
Î¾[bi] = (Ï€R )âˆ’1 {(Î±âˆ’1 (Î¶))R }. On the one hand, âˆ‡D (Î±âˆ’1 (Î¶)) is computed by subtracting
these two Î¾[bi]â€™s. On the other hand, (by the deï¬nition of the Î˜Î¦
S log -torsor structure on
D) the diï¬€erence between these two Î¾[bi]â€™s is the diï¬€erence between the two classifying
morphisms given by the subalgebras {(I )SÎ¦ }L and {(I )SÎ¦ }R of OS bi . But this diï¬€erence
is, by deï¬nition, âˆ‡L (Î¶). This completes the proof. 
Henceforth, we shall identify (D, âˆ‡D ) with (L, âˆ‡L ), and call the resulting torsor with
connection (D, âˆ‡D ) (since the notation L is more natural for line bundles).
Indigenous Sections of D
We continue with the notation of the previous subsection. Thus, S â†’ Mg,r is eÌtale,
and we have the Î˜Î¦
S log -torsor D â†’ S, with its connection âˆ‡D . Let Ï€ : D â†’ S be the
scheme corresponding to this torsor. Thus, D is a twisted version of Spec of the symmetric
algebra of the dual of Î˜Î¦
S log . We endow D with the log structure pulled back from S; this
log
gives us a log stack D . On D, taking the dual to the second fundamental exact sequence
for diï¬€erentials gives a sequence of tangent bundles:
0 â†’ Î˜Î¦
S log |D â†’ Î˜Dlog â†’ Î˜S log |D â†’ 0
where Î˜Dlog is the logarithmic tangent bundle on D log . We shall denote the surjection
Î˜Dlog â†’ Î˜S log |D by Î˜Ï€ . The connection âˆ‡D then deï¬nes a connection âˆ‡D on the ï¬ber
bundle Ï€ : D â†’ S, hence a section âˆ‡Î˜ : Î˜S log |D â†’ Î˜Dlog of Î˜Ï€ .
Now let us suppose that we are given a section Ïƒ : S â†’ D of Ï€. Then Ïƒ induces a
section of Ïƒ âˆ— Î˜Ï€ , which we denote by Î˜Ïƒ : Î˜S log â†’ Ïƒ âˆ— Î˜Dlog . Also, Ïƒ deï¬nes an FL-bundle
(E, âˆ‡E ) (see Chapter II, Â§1) on the curve X log .
Deï¬nition 2.2. We shall call the section Ïƒ indigenous if the projectivization of the
FL-bundle on X log deï¬ned by Ïƒ is an indigenous bundle on X log .
Let us assume that Ïƒ is indigenous. Then we obtain, for i = 1, 2, canonical morphisms of
vector bundles
Ï†i : Ïƒ âˆ— Î˜Dlog â†’ Î˜S log
deï¬ned functorially as follows. By means of the eÌtale morphism S â†’ Mg,r , we can think
of the geometric vector bundle Ïƒ âˆ— Î˜Dlog on S as parametrizing inï¬nitesimal deformations
Î·  = {(X log ) , (E  , âˆ‡E  )} of the curve plus FL-bundle pair given by Î· = {X log , (E, âˆ‡E )}.
104

Then the obstruction to lifting the Hodge ï¬ltration of (E  , âˆ‡E  )|X = (E, âˆ‡E ) (which exists
since Ïƒ is indigenous) to a ï¬ltration of E  over X  deï¬nes a section of Î˜S log , which we take
for Ï†2 (Î·  ). On the other hand, if we think in terms of crystals, then (E  , âˆ‡E  ) also deï¬nes
a deformation (E  , âˆ‡E  ) of (E, âˆ‡E ) on X[ ]/( 2 ). The obstruction to lifting the Hodge
ï¬ltration of (E, âˆ‡E ) to a ï¬ltration of E  on X[ ]/( 2 ) deï¬nes a section of Î˜S log , which we
take for Ï†1 (Î·  ). Since, Ïƒ âˆ— Î˜Ï€ (Î·  ) is simply the diï¬€erence between (X log ) and the trivial
deformation of X log , we thus see that
Ïƒ âˆ— Î˜Ï€ = Ï†2 âˆ’ Ï†1
We also have that
Ï† 1 â—¦ Ïƒ âˆ— âˆ‡Î˜ = 0
Indeed, sorting through the deï¬nitions, one sees that the image of âˆ‡Î˜ consists of the
Î·  = {(X log ) , (E  , âˆ‡E  )} obtained by letting (E  , âˆ‡E  ) be the FL-bundle given by regarding
(E, âˆ‡E ) as a crystal and taking the bundle with connection that this crystal induces on the
deformation (X log ) . Thus, (E  , âˆ‡E  ) is simply the trivial deformation of (E, âˆ‡E ), hence
is indigenous on X log by assumption. Putting the above two formulas together, we thus
obtain that
Ï†2 â—¦ Ïƒ âˆ— âˆ‡Î˜ = idÎ˜Slog
Also, let us note that
Ï†2 â—¦ Î˜Ïƒ = 0
since if it were nonzero, it would measure exactly the extent to which Ïƒ fails to stay within
the indigenous locus of D, but, by assumption, Ïƒ does stay within the indigenous locus.
Next, let us recall the morphism Î¦Ï„E : Î˜Î¦
S log â†’ Î˜S log , i.e., the dual to the â€œinï¬nitesimal
Verschiebungâ€ of Chapter II, Â§2. Recall that this morphism was constructed by applying
R1 fâˆ— to the morphism T â†’ Ï„X log /S log given by composing the p-curvature P : T â†’ Ad(E)
of E with the projection Ad(E) â†’ Ï„X log /S log arising from the Hodge ï¬ltration. It thus
follows immediately from the deï¬nitions (by thinking about how one deï¬nes the obstruction
âˆ—
that Ï†1 measures) that if we restrict Ï†1 : Ïƒ âˆ— Î˜Dlog â†’ Î˜S log to Î˜Î¦
S log âŠ† Ïƒ Î˜Dlog , we get
Ï†1 |Î˜Î¦

S log

= Î¦Ï„E

So far we have been thinking about morphisms that one can obtain from Ïƒ by thinking
about the indigenous FL-bundle (E, âˆ‡E ) that it deï¬nes. But by what we did in the previous
subsection, Ïƒ also deï¬nes a Frobenius lifting Î¦Ïƒ : Slog â†’ Slog . Let us consider the
105

morphism Î˜Î¦Ïƒ : Î˜S log â†’ Î˜Î¦
S log obtained by looking at the morphism induced by Î¦Ïƒ on
the tangent bundles, and then dividing by p. On the other hand, the morphism Î˜Ïƒ âˆ’Ïƒ âˆ— âˆ‡Î˜ :
âˆ—
Î˜S log â†’ Ïƒ âˆ— Î˜Dlog maps into Î˜Î¦
S log âŠ† Ïƒ Î˜Dlog . Thus, by abuse of notation, we shall regard
âˆ—
Î˜Ïƒ âˆ’ Ïƒ âˆ‡Î˜ as a morphism Î˜S log â†’ Î˜Î¦
S log . Then we claim that
Î˜Î¦Ïƒ = Î˜Ïƒ âˆ’ Ïƒ âˆ— âˆ‡Î˜
Indeed, if we think of Ïƒ âˆ— âˆ‡Î˜ as deï¬ning a direct sum splitting of Ïƒ âˆ— Î˜Dlog , then Î˜Ïƒ âˆ’ Ïƒ âˆ— âˆ‡Î˜
âˆ—
is just the component of Î˜Ïƒ that sits in the vertical subspace Î˜Î¦
S log âŠ† Ïƒ Î˜Dlog . Put another
âˆ—
Î¦
way, Î˜Ïƒ âˆ’Ïƒ âˆ‡Î˜ : Î˜S log â†’ Î˜S log is the Kodaira-Spencer morphism for the section Ïƒ relative
to the connection âˆ‡D . Thus, it follows from the deï¬nition of the connection called âˆ‡L in
the previous subsection in terms of subalgebras of OS bi that Î˜Î¦Ïƒ = Î˜Ïƒ âˆ’ Ïƒ âˆ— âˆ‡Î˜ .
We are now ready to prove the main technical result of this subsection:
Proposition 2.3. If Ïƒ : S â†’ D is an indigenous section, then âˆ’Î¦Ï„E is inverse to Î˜Î¦Ïƒ . In
particular, the indigenous bundle associated to (E, âˆ‡E ) is ordinary.
Proof. Indeed, using the various observations made above, we simply compute:
Î¦Ï„E â—¦ Î˜Î¦Ïƒ = Ï†1 â—¦ (Î˜Ïƒ âˆ’ Ïƒ âˆ— âˆ‡Î˜ )
= Ï†1 â—¦ Î˜Ïƒ
= (Ï†1 âˆ’ Ï†2 ) â—¦ Î˜Ïƒ
= âˆ’(Ïƒ âˆ— Î˜Ï€ ) â—¦ Î˜Ïƒ
= âˆ’idÎ˜Slog
Thus, in particular Î¦Ï„E is an isomorphism, and so (E, âˆ‡E ) deï¬nes an ordinary nilpotent
indigenous bundle. 
Frobenius Invariant Indigenous Bundles
ord

In this subsection, we change notation slightly. Let S â†’ N g,r be an eÌtale morphism
ord

of a p-adic formal scheme S into N g,r . Thus, S is formally smooth over Zp . Also, one may
ord

ord

think of S â†’ N g,r as the unique eÌtale lifting of its reduction SFp â†’ (N g,r )Fp modulo
p. For convenience, we assume that SFp is aï¬ƒne. Endow S with the log structure pulled
log

back from Mg,r . Thus, we get a p-adic formal log scheme S log . Pulling back the universal
curve over Mg,r , we get a morphism f log : X log â†’ S log . Let hlog : Y log â†’ S log be an
log
r-pointed curve of genus g whose reduction modulo p is equal to (X log )F
Fp â†’ SFp , i.e., the
Frobenius transform of fFlog
. We shall denote the divisor of marked points on Y by E âŠ† Y .
p
106

Let n â‰¥ 2 be a natural number. Suppose that we have a coherent sheaf with connection (F, âˆ‡F ) on Y log , where F is killed by pn and ï¬‚at over Z/pn Z, and the connection
âˆ‡F is relative to the morphism hlog : Y log â†’ S log . Suppose, moreover, that we are given
a ï¬ltration F 1 (F)Fp âŠ† FFp of the reduction of F modulo p. We shall call this ï¬ltration
the Hodge ï¬ltration. Then, relative to this data, we deï¬ne the coherent sheaf with con/S log ).
nection Fâˆ— (F, âˆ‡F ) as follows. First, we regard (F, âˆ‡F ) as a crystal on Crys(YFlog
p
Thus, if we apply the relative Frobenius morphism Î¦X log /S log to this crystal (F, âˆ‡F ), we
def

obtain a crystal (F, âˆ‡F ) = Î¦âˆ—X log /S log (F, âˆ‡F ) on Crys(XFlog
/S log ). Next, we consider
p
the subsheaf Î¦âˆ—X log /S log F 1 (F)Fp âŠ† FF p . If we then consider the subsheaf of (F, âˆ‡F )
on Crys(XFlog
/S log ) consisting of sections whose reduction modulo p is contained in the
p

subsheaf Î¦âˆ—X log /S log F 1 (F)Fp , we obtain a crystal (F, âˆ‡F ) on Crys(XFlog
/S log ). We then
p
let
Fâˆ— (E, âˆ‡E ) = (F, âˆ‡F ) âŠ—Zp Z/pnâˆ’1 Z
def

Deï¬nition 2.4. We shall call Fâˆ— (F, âˆ‡F ) the renormalized Frobenius pull-back of (F, âˆ‡F ).

Note that if F is a vector bundle on YZ/pn Z , and F 1 (F)Fp is a vector bundle on YFp , with
the injection F 1 (F)Fp â†’ FFp locally split, it follows immediately from the deï¬nitions that
the coherent sheaf Fâˆ— (F) appearing in Fâˆ— (F, âˆ‡F ) is a vector bundle on XZ/pnâˆ’1 Z . Note
also that, if we think of the â€œinput variableâ€ (F, âˆ‡F ) as a crystal on Crys(YFlog
/S log ), then
p
.
Fâˆ— (F, âˆ‡F ) does not depend on the choice of the deformation hlog : Y log â†’ S log of YFlog
p

log
log
n
Often, we will be given a Frobenius lifting Î¦log : SZ/p
n Z â†’ SZ/pn Z modulo p , and we
log
log
log
log
will take YZ/p
n Z â†’ SZ/pn Z (respectively, (F, âˆ‡F )) to be the pull-back of XZ/pn Z â†’ SZ/pn Z
(respectively, some (E, âˆ‡E ) on X log ) by Î¦log . If S were the spectrum of the ring of Witt
vectors of a perfect ï¬eld k, and n = 2, then the Fâˆ— (E, âˆ‡E )F that we have deï¬ned here
would coincide with the Fâˆ— (E, âˆ‡E ) of Chapter II, Deï¬nition 2.9.
log
Now let (F, âˆ‡F ) be a vector bundle with connection on YZ/p
n Z whose determinant
nâˆ’1
is trivial and which is indigenous modulo p
. We will denote its Hodge ï¬ltration by
F 1 (F)Z/pnâˆ’1 Z âŠ† FZ/pnâˆ’1 Z . Let us denote by (G, âˆ‡G ) the vector bundle with connection
on XZ/pnâˆ’1 Z which is the renormalized Frobenius pull-back of (F, âˆ‡F ). Suppose, moreâˆ¼
over, that (G, âˆ‡G )F
Fp = (F, âˆ‡F )Fp . Thus, one sees (as in the proof of Chapter II, Proposition 2.10) that (F, âˆ‡F )Fp is nilpotent and admissible (hence corresponds, by Chapter II,
Proposition 2.5, to some FL-bundle).

Lemma 2.5. Let n â‰¥ 3. If we modify the connection âˆ‡F by some pnâˆ’2 Î¸, where Î¸ is a
section of hâˆ— (Ï‰Ylog/S )âŠ—2 (âˆ’E), then the vector bundle Fâˆ— (F) (on XZ/pnâˆ’1 Z ), along with its
connection Fâˆ— (âˆ‡F ), remain unchanged.
107

Proof. Looking at the deï¬nition of the renormalized Frobenius pull-back, one sees that
the pair (Fâˆ— (F), Fâˆ— (âˆ‡F )) is constructed by pulling back F (and âˆ‡F ) via various local
liftings of Î¦X log /S log , and then gluing together by means of gluing morphisms deï¬ned
by the connection âˆ‡F . Moreover, these gluing morphisms are obtained from the Taylor
expansion (cf. [Falt], Â§2, Theorem 2.3), which involves applying the connection âˆ‡F to
tangent vectors pushed forward from the Frobenius lifting. Since such tangent vectors are
necessarily divisible by p (as well as being annihilated, of course, by pn ), it follows that
a knowledge of (âˆ‡F )Z/pnâˆ’1 Z suï¬ƒces to compute these Taylor expansions. Thus, certainly
Fâˆ— (F) depends at most on (âˆ‡F )Z/pnâˆ’1 Z . On the other hand, since at the end of the
construction of Fâˆ— (F), we mod out by pnâˆ’1 Â· Î¦âˆ—X log /S log F 1 (F)Fp âŠ† pnâˆ’1 Â· Î¦âˆ—X log /S log FFp ,
we see that modifying âˆ‡F by an endomorphism-valued diï¬€erential whose image lies inside
pnâˆ’2 Â· F 1 (F) (where we have pnâˆ’2 rather than pnâˆ’1 since we always get an extra factor
of p from the fact that we are applying the connection to tangent vectors divisible by p)
does not aï¬€ect the result. This completes the proof. 
Now let us assume that (F, âˆ‡F ) is a rank two vector bundle on YZ/pn Z with a connection (relative to hlog : Y log â†’ S log ), whose determinant is trivial. Let us suppose,
moreover, that (F, âˆ‡F )Z/pnâˆ’1 Z is indigenous. Let (G, âˆ‡G ) = Fâˆ— (F, âˆ‡F ). As before, we
âˆ—
âˆ¼
assume that (G, âˆ‡G )F
Fp = (F, âˆ‡F )Fp . Then by considering the result of applying F to various deformations (F, âˆ‡F ) of (F, âˆ‡F ) (i.e., such that (F, âˆ‡F )Z/pnâˆ’1 Z = (F, âˆ‡F )Z/pnâˆ’1 Z )
to obtain various deformations (G, âˆ‡G ) of (G, âˆ‡G ), we obtain a morphism:
(R1 fDR,âˆ— Ad(E)Fp )F â†’ R1 fDR,âˆ— Ad(G)Fp âˆ¼
= R1 fDR,âˆ— Ad(E)Fp
If we then compose this morphism with the projection
R1 fDR,âˆ— Ad(E)Fp â†’ R1 fâˆ— (Ï„X log /S log )Fp
arising from the Hodge ï¬ltration, we obtain a morphism
(R1 fDR,âˆ— Ad(E)Fp )F â†’ R1 fâˆ— (Ï„X log /S log )Fp
which, by Lemma 2.5, vanishes on the subbundle
log âŠ—2
1
F
) (âˆ’D))F
(fâˆ— (Ï‰X/S
Fp âŠ† (R fDR,âˆ— Ad(E)Fp )

arising from the Hodge ï¬ltration. Thus, we obtain a morphism of vector bundles
Î˜Fâˆ— : (R1 fâˆ— (Ï„X log /S log )Fp )F â†’ R1 fâˆ— (Ï„X log /S log )Fp
Note that by Lemma 2.5, this morphism remains unchanged if one adds some pnâˆ’2 Î¸ to
the connection âˆ‡F .
108

Lemma 2.6. The morphism Î˜Fâˆ— is equal to âˆ’Î¦Ï„E .
Proof. In the gluing process referred to in the proof of Lemma 2.5, the deforming
nâˆ’1
cocycle in (Ï„X log /S log )F
(Ï„X log /S log )F (mod pn ) only aï¬€ects the Taylor expanFp = p
sion to ï¬rst order. Moreover, this cocycle in (Ï„X log /S log )F
Fp is mapped to a cocycle in
âˆ—
F
Î¦X log /S log (Ï„X log /S log )Fp â†’ Ad(G)Fp âˆ¼
= Ad(E)Fp , and hence to a cocyle in Ad(E)Fp . If
we then further project this cocycle via Ad(E)Fp â†’ (Ï„X log /S log )Fp , we obtain Î˜Fâˆ— of the
original cocycle. On the other hand, let us note that by Chapter II, Proposition 1.4, the
inclusion Î¦âˆ—X log /S log (Ï„X log /S log )F
Fp â†’ Ad(G)Fp = Ad(E)Fp is âˆ’1 times the p-curvature of
Ï„
(E, âˆ‡E )Fp . Since Î¦E is deï¬ned by applying R1 fâˆ— to the p-curvature composed with the
projection Ad(E)Fp â†’ (Ï„X log /S log )Fp , we thus obtain the result. 
We are now ready to begin deï¬ning a canonical Frobenius lifting on S log , which will
be fundamental to the entire paper. First, note that since (N g,r )Fp âŠ† (S g,r )Fp , we have a
ord

tautological trivialization (Ï„N )Fp : (N g,r )ord
Fp â†’ (S g,r )Fp of the torsor S g,r over (N g,r )Fp .
If we pull this trivialization back to S, we get a trivialization (Ï„S )Fp : SFp â†’ (S g,r )Fp ,
. This indigewhich thus deï¬nes a nilpotent, ordinary indigenous bundle (E, âˆ‡E )1 on XFlog
p
nous bundle thus corresponds to an FL-bundle, hence a section of the torsor D (of the
log
log
previous subsection) over SFp , and hence a Frobenius lifting Î¦log
2 : SZ/p2 Z â†’ SZ/p2 Z . Now

log
let (E, âˆ‡E )2 be any indigenous bundle on XZ/p
2 Z that lifts (E, âˆ‡E )1 . (Such a lifting exists
log
log
log
since SFp is aï¬ƒne.) We shall deï¬ne Y log inductively. Let YZ/p
.
2 Z = XZ/p2 Z Ã—S log ,Î¦log S
2

âˆ—

âˆ—

Let (F, âˆ‡F )2 = (Î¦log
2 ) (E, âˆ‡E )2 . Then it is a tautology that if we take F (F, âˆ‡F )2 , we
obtain (E, âˆ‡E )1 (up to tensor product with a line bundle with connection whose square
is trivial; as usual, for the sake of simplicity, we shall ignore this). So far, to summarize,
log
of the objects constructed so far, Î¦log
2 ; YZ/p2 Z ; and (E, âˆ‡E )1 are canonical. The primed
objects are not canonical.
log
Let (F, âˆ‡F )3 be any rank two bundle with connection on YZ/p
3 Z whose determinant
is trivial, and whose reduction modulo p2 is equal to (F, âˆ‡F )2 . That is, (F, âˆ‡F )3 is a
deformation of (F, âˆ‡F )2 . Now by Lemma 2.6, and the fact that (E, âˆ‡E )1 is ordinary, it
follows that, among all possible deformations (F, âˆ‡F )3 of (F, âˆ‡F )2 , there exists a unique
(up to changing the connection by some p2 Â· Î¸) such deformation (F, âˆ‡F )3 such that
log
log
log
Fâˆ— (F, âˆ‡F )3 is indigenous on XZ/p
2 Z . Let YZ/p3 Z be the unique deformation of YZ/p2 Z
log
such that when one evaluates the crystal (F, âˆ‡F )3 on YZ/p
3 Z , it becomes indigenous.
âˆ—

Let (E, âˆ‡E )2 = F (F, âˆ‡F )3 . By Lemma 2.5, (E, âˆ‡E )2 is independent of the choice of
log
log
log
âˆ—
: SZ/p
(E, âˆ‡E )2 or (F, âˆ‡F )3 . Let (F, âˆ‡F )2 = (Î¦log
3 Z â†’ SZ/p3 Z be
2 ) (E, âˆ‡E )2 . Let Î¦3

log
log
the classifying morphism of the r-pointed stable curve of genus g given by YZ/p
3 Z â†’ SZ/p3 Z .
log
log
log
Thus, Î¦log
3 lifts Î¦2 . Again, to summarize, the objects Î¦3 ; YZ/p3 Z ; and (E, âˆ‡E )2 (as well

log
as (F, âˆ‡F )2 ) are canonical. If we now let (E, âˆ‡E )3 be an indigenous bundle on XZ/p
3Z

109

âˆ—

that lifts (E, âˆ‡E )2 , and (F, âˆ‡F )3 = (Î¦log
3 ) (E, âˆ‡E )3 (where the primed bundles are newly
chosen here, hence diï¬€erent from the temporary ones we chose before), it follows from
Lemma 2.5 that (E, âˆ‡E )2 âˆ¼
= Fâˆ— (F, âˆ‡F )3 .

Continuing in this fashion (making repeated use of Lemmas 2.5 and 2.6, as well as
the fact that (E, âˆ‡E )1 is ordinary), we thus obtain a canonical Frobenius lifting Î¦log :
S log â†’ S log (of p-adic formal schemes), as well as a canonical indigenous bundle (E, âˆ‡E )
on X log such that Fâˆ— (Î¦log )âˆ— (E, âˆ‡E ) âˆ¼
= (E, âˆ‡E ) (up to tensor product with a line bundle
with connection whose square is trivial). Moreover, note that by Proposition 2.3, this
Frobenius lifting Î¦log is ordinary.
Deï¬nition 2.7. Let Î¨log : S log â†’ S log be a Frobenius lifting. We shall call an indigenous
bundle (G, âˆ‡G ) on X log Frobenius invariant for Î¨log if (G, âˆ‡G ) âˆ¼
= Fâˆ— (Î¨log )âˆ— (G, âˆ‡G ) (up to
tensor product with a line bundle with connection whose square is trivial).
So far, we have been working over our aï¬ƒne scheme S, which is eÌtale over Mg,r . However,
since the objects that we have constructed (namely, Î¦log and (E, âˆ‡E )) are canonical, i.e.
uniquely characterized by certain properties that have nothing special to do with S, it is
ord
clear that they all descend to (N g,r )log . We thus see that we have proven the following
key result:
ord

Theorem 2.8. On (N g,r )log , there exists a canonical ordinary Frobenius lifting
ord

ord

log
Î¦log
â†’ (N g,r )log
N : (N g,r )
ord

together with a canonical indigenous bundle (EN , âˆ‡EN ) on C log (where C log â†’ N g,r is the
universal r-pointed curve of genus g) whose reduction modulo p is equal to the nilpotent,
ordinary indigenous bundle deï¬ned by the tautological trivialization (Ï„N )Fp of S g,r over
ord

N g,r . Moreover, the pair {Î¦log
N ; (EN , âˆ‡EN )} is uniquely characterized by the following
properties:
ord

ord

log
â†’ (N g,r )log is a lifting of Frobenius;
(1) Î¦log
N : (N g,r )

(2) the reduction of (EN , âˆ‡EN ) modulo p is the bundle deï¬ned by (Ï„N )Fp ;
(3) (EN , âˆ‡EN ) is Frobenius invariant for Î¦log
N .
Moreover, the formation of Î¦log
N and (EN , âˆ‡EN ) is compatible with restriction to products
ord

ord

of N g,r â€™s for smaller gâ€™s and râ€™s that map into the boundary of our original N g,r via the
gluing procedure described at the end of Chapter I, Â§2.
110

Proof. We have proven everything except the last statement about restriction. To see
ord
this, note ï¬rst of all that Î¦log
N respects such products of smaller N g,r since it respects the
ord

log structure of the original N g,r . Thus, we may restrict Î¦log
N and (EN , âˆ‡EN ) to these
products, and the result follows by uniqueness. 
Remark. This result is the central result of this paper. In some sense, the rest of the paper
is just devoted to making explicit a number of formal consequences of Theorem 2.8. In
particular, since this canonical Frobenius lifting is ordinary, it follows that we can apply
the theory of Â§1. We shall proceed to do this in the remainder of this Chapter.
Finally, it is useful to know that the formation of the canonical Frobenius and indigeord
nous bundle are compatible with ï¬nite coverings. Suppose that S log â†’ (N g,r )log is log
eÌtale, with S formally smooth over Zp , and the log structure given by a relative divisor
with normal crossings over Zp . Let f log : X log â†’ S log be the pull-back of the universal
log

curve over Mg,r . Let q, s â‰¥ 0 be such that 2q âˆ’ 2 + s â‰¥ 1. Let Y log â†’ S log be an s-pointed
stable curve of genus q. Suppose that we are given a morphism over S log :
Y log

Ï†log

âˆ’â†’ X log

Now we make the following:
Deï¬nition 2.9. We shall say that Ï†log is log admissible if it is ï¬nite, log eÌtale, and takes
marked points to marked points.
A typical example of a log admissible morphism may be obtained by considering the
â€œadmissible coveringsâ€ of [HM]. Indeed, it is not diï¬ƒcult to see that by endowing the
curves involved (as well as the base) with appropriate log structures, one may obtain a log
admissible covering (cf. [Mzk], Â§3). (Note, however, that the deï¬nition of â€œlog admissibleâ€
given here diï¬€ers from that of [Mzk], Â§3.)
Let (E, âˆ‡E ) be the restriction of the canonical indigenous bundle (EN , âˆ‡EN ) to X log .
log
(which exists
Let Î¦log : S log â†’ S log be the pull-back of the Frobenius lifting Î¦log
N to S
ord

because S log â†’ (N g,r )log is log eÌtale). Let (F, âˆ‡F ) = Ï†âˆ— (E, âˆ‡E ). Observe that (F, âˆ‡F )Fp
is a nilpotent, admissible indigenous bundle on Y log . Let us assume that:
(*) (F, âˆ‡F )Fp is ordinary.

log

Then (F, âˆ‡F )Fp determines a factorization of the classifying morphism S log â†’ Mq,s
ord

through (N q,s )log . Thus, we get a morphism
ord

Îºlog : S log â†’ (N q,s )log
111

ord

For simplicity, let us write T log for (N q,s )log . Let us denote by Î¨log the canonical Frobenius
ord

on (N q,s )log , and by (G, âˆ‡G ) the canonical indigenous bundle on the universal s-pointed
ord

stable curve of genus q over (N q,s )log . Then we have the following compatibility result:
Theorem 2.10. We have a commutative diagram:
Î¦log

S log âˆ’â†’
â
â log
Îº

T log

log

Î¨

âˆ’â†’

S log
â
â log
Îº

T log

and an isomorphism Îºâˆ— (G, âˆ‡G ) âˆ¼
= (F, âˆ‡F ).
Proof. We shall apply induction on i to the proposition â€œthe Theorem is true when the
objects in it are reduced modulo pi .â€ The case i = 1 is clear. Thus, it suï¬ƒces to prove the
induction step. Let us consider the crystals (F, âˆ‡F )Î¦ and Îºâˆ— (G, âˆ‡G )Î¨ on Crys(XFlog
/S log ).
p
Suppose that they agree modulo pi . If we apply Fâˆ— (the renormalized Frobenius pullback) to them, we get the same crystal modulo pi , by the induction hypothesis and the
deï¬nition of the canonical Frobenii and indigenous bundles. Thus, by Lemma 2.6, it follows
that the underlying vector bundles of (F, âˆ‡F )Î¦ and Îºâˆ— (G, âˆ‡G )Î¨ must agree modulo pi+1 .
Since (F, âˆ‡F )Î¦ is indigenous on (Y log )Î¦ , and Îºâˆ— (G, âˆ‡G )Î¨ is indigenous on the s-pointed
stable curve of genus q given by pulling back the universal one by Î¨log â—¦ Îºlog , we thus
obtain that the diagram in the Theorem commutes modulo pi+1 . Then since (F, âˆ‡F ) and
Îºâˆ— (G, âˆ‡G ) agree modulo pi , it follows that their underlying vector bundles agree modulo
pi+1 . By a similar argument, their underlying vector bundles also agree modulo pi+2 , and
the diagram commutes modulo pi+2 . Then, by Lemma 2.5, since (F, âˆ‡F ) âˆ¼
= Fâˆ— (F, âˆ‡F )Î¦
âˆ—
âˆ— âˆ—
Î¨
âˆ—
âˆ¼
and Îº (G, âˆ‡G ) = Îº F (G, âˆ‡G ) , it follows that (F, âˆ‡F ) and Îº (G, âˆ‡G ) agree modulo pi+1 .
This completes the proof of the induction step. 

Â§3. Applications of the Canonical Frobenius Lifting
In this Section, we apply the general theory of Â§1 to the canonical modular Frobenius
lifting constructed in Â§2. In particular, we deï¬ne the notion of a p-adic quasiconformal
equivalence class, and show how the choice of such a class allows one to construct both
aï¬ƒne and multiplicative uniformizations of Mg,r . We will also deï¬ne the notion of a padic topological marking, which will allow us to construct a local uniformization of Mg,r
by means of the aï¬ƒne space of quadratic diï¬€erentials. As we make these constructions,
we will compare them to various classical constructions in the complex case. Finally, we
will specialize what we have done in this Chapter to the case of elliptic curves (regarded
112

parabolically) to see that in this case, the canonical Frobenius lifting corresponds to a
well-known Frobenius lifting from Serre-Tate theory, and that, consequently, the various
objects constructed from it â€“ i.e., canonical curves, modular uniformizations, etc. â€“ reduce
to the corresponding objects of classical Serre-Tate theory.
Canonical Liftings of Curves over Witt Vectors
ord

Let N g,r ; Î¦log
N be as in the last subsection of Â§2. Let k be a perfect ï¬eld of characteristic
p. Let A = W (k), the ring of Witt vectors with coeï¬ƒcients in k; let S = Spec(A). Thus,
we have a natural Frobenius automorphism Î¦A : A â†’ A on A. Recall the notion of a
ord
canonical liftings of A-valued points in N g,r (Deï¬nition 1.9).
ord

Deï¬nition 3.1. We shall call a point Î±0 âˆˆ N g,r (k) a (p-adic) quasiconformal equivalence
class (valued in k). We shall call an r-pointed stable curve of genus g the canonical curve
in the class Î±0 if it admits an indigenous bundle such that the pair consisting of the curve
ord
and this indigenous bundle deï¬nes a canonical A-valued point of N g,r whose reduction
modulo p is Î±0 .
Remark. Thus, a p-adic quasiconformal equivalence class consists of a hyperbolically ordinary r-pointed stable curve (X0 â†’ Spec(k); p1 , . . . , pr : Spec(k) â†’ X0 ) of genus g, together
with a choice of a nilpotent, ordinary indigenous bundle (E, âˆ‡E )0 on X0log . Recall from
Chapter II, Proposition 3.13, that for a given ordinary X0log , there are at most p3gâˆ’3+r
possible choices for (E, âˆ‡E )0 . The reason for attaching the term â€œquasiconformalâ€ to this
data will become more and more apparent as we continue: Namely, unlike the complex case
in which, once g and r are determined, all curves belong to the same quasiconformal equivalence class, the uniformization theory that we shall develop in this paper in the p-adic
setting acts (by comparison to the classical complex case) as if there are many diï¬€erent
quasiconformal equivalence classes (for a given g and r), and moreover, this equivalence
ord
class is determined exactly by the datum of a point in N g,r .
Specializing the theory of Â§1, we obtain:
ord

Theorem 3.2. For every p-adic quasiconformal equivalence class Î±0 âˆˆ N g,r (k), there
ord

exists a canonical lifting Î±âˆ âˆˆ N g,r (A), i.e., more concretely, an r-pointed stable curve
(X â†’ Spec(A); p1 , . . . , pr : Spec(A) â†’ X) of genus g, together with an indigenous (E, âˆ‡E )
on X log . This canonical lifting Î±âˆ is uniquely characterized by the fact that it is ï¬xed
log
log
under Î¦âˆ’1
A Î¦N , where Î¦N is the canonical Frobenius lifting of Theorem 2.8.
Corollary 3.3. Suppose that the pair
113

{(X â†’ Spec(A); p1 , . . . , pr : Spec(A) â†’ X); (E, âˆ‡E )}
is canonical (i.e., for (E, âˆ‡E ), this means that it is the restriction of the (EN , âˆ‡EN ) of
Theorem 2.8). Then
(1) If X â†’ Spec(A) is smooth, then (E, âˆ‡E ) deï¬nes an MF âˆ‡ -object on
X log in the sense of [Falt], Â§2 (up to tensor product with a line bundle
whose square is trivial).
(2) More generally, if X â†’ Spec(A) is not smooth, then the pair is obtained
by gluing together (as at the end of Chapter I, Â§2) a collection of smooth
canonical pairs.

Proof. The two statements follow by specializing Theorem 2.8. 
Corollary 3.4. A pair
{(X â†’ Spec(A); p1 , . . . , pr : Spec(A) â†’ X); (E, âˆ‡E )}
consisting of a smooth r-pointed curve of genus g and an indigenous bundle on X log is
canonical if and only if
(1) the indigenous bundle (E, âˆ‡E )Fp is ordinary;
(2) (E, âˆ‡E ) deï¬nes an MF âˆ‡ -object on X log in the sense of [Falt], Â§2 (up
to tensor product with a line bundle whose square is trivial).
More generally, a pair consisting of an r-pointed stable curve of genus g and an indigenous
bundle on X log is canonical if and only if it is obtained by gluing together canonical pairs
as at the end of Chapter I, Â§2.
Proof. Let us ï¬rst consider the smooth case. By the previous Corollary, it suï¬ƒces to prove
the â€œifâ€ part. Since (E, âˆ‡E ) is an MF âˆ‡ -object, we know (by Chapter II, Proposition 2.10)
that (E, âˆ‡E )Fp is nilpotent. Thus, there exists a canonical pair which is equal to our given
pair modulo p. On the other hand, it follows by the analogues of Lemmas 2.5 and 2.6 for
Fâˆ— over S = Spec(A) that there is only one lifting of our pair modulo p that admits an
indigenous bundle which is an MF âˆ‡ -object. Thus, our pair must be the canonical pair.
Next, we consider the stable case. Again, by the previous Corollary, it suï¬ƒces to prove
the â€œifâ€ part. As before, we note that there exists a canonical pair which is equal to our
given pair modulo p. By the previous Corollary, the canonical pair is obtained by gluing
together smooth canonical pairs. Since a smooth canonical lifting is unique, it thus follows
that our pair must be the canonical pair. 
114

Corollary 3.5. Suppose that we have an r-pointed (respectively, s-pointed) stable curve
X log (respectively, Y log ) of genus g (respectively, q) over S log (for some appropriate choice
of log structure on S log ). Let (E, âˆ‡E ) (respectively, (F, âˆ‡F )) be an indigenous bundle on
X log (respectively, Y log ). Suppose that (F, âˆ‡F )Fp is ordinary. Let Ï†log : Y log â†’ X log be
log admissible, and suppose that (F, âˆ‡F ) = Ï†âˆ— (E, âˆ‡E ). Then the pair {X log ; (E, âˆ‡E )} is
canonical if and only if the pair {Y log ; (F, âˆ‡F )} is canonical.
Ï‰
Proof. First note that, by pulling back square diï¬€erentials and considering Î¦Ï‰
E and Î¦F , the
ordinariness of (F, âˆ‡F )Fp implies the ordinariness of (E, âˆ‡E )Fp . The stipulated conditions
on Ï†log imply that X log is obtained by gluing if and only if Y log is obtained by gluing.
We thus reduce to the smooth case. But this follows immediately, by the criterion of the
previous Corollary (about the indigenous bundle being an MF âˆ‡ -object) and the fact that
Fâˆ— commutes with log eÌtale coverings. 

Canonical Aï¬ƒne Coordinates on Mg,r
We maintain the notation of the preceding subsection. Thus, S = Spec(A); A = W (k);
ord
and k is a perfect ï¬eld of characteristic p. Let Î± âˆˆ N g,r (A) be canonical. Since giving
ord

a canonical Î± âˆˆ N g,r (A) is equivalent to giving the p-adic quasiconformal equivalence
ord

class Î±(mod p) âˆˆ N g,r (k), we shall frequently abuse notation and speak of â€œthe p-adic
quasiconformal equivalence class Î±.â€
Let us assume that Î± corresponds to a smooth curve. Then applying Theorems 1.12
and 1.14 to the canonical Frobenius lifting of Theorem 2.8 gives the following results:
Theorem 3.6. For every choice of a p-adic quasiconformal equivalence class Î±, we obtain
a local canonical uniformization
âˆ¼ Î±
U can : Î˜aï¬€
Î± = Mg,r
of Mg,r by the aï¬ƒne space modeled on Î˜Î± .
Let (B, mB ) be a local ring with residue ï¬eld k which is p-adically complete and has a
topologically nilpotent PD-structure on mB .
ord

Deï¬nition 3.7. We shall say that Î² âˆˆ N g,r (B) is in the (p-adic) quasiconformal equivaord

ord

lence class Î± if the point Î²(mod mB ) âˆˆ N g,r (k) is equal to Î±(mod p) âˆˆ N g,r (k).
In summary, we have proven the following result:
115

ord

Theorem 3.8. For every Î² âˆˆ N g,r (B) in the quasiconformal equivalence class Î±, we
obtain a canonical class ÎºÎ² âˆˆ mB Â· Î˜Î² , as well as a local uniformization
âˆ¼ Î²
U Î² : Î˜aï¬€
Î² = Mg,r
of Mg,r by the aï¬ƒne space modeled on Î˜Î² . Moreover, this uniformization is related to the
canonical uniformization by tensoring over A with B, applying the isomorphism
âˆ’1
: (Î˜Î± )B â†’ Î˜Î²
(Î¨âˆ¨
Î±Î² )
ord

and then translating by ÎºÎ² . Finally, for all Î² âˆˆ N g,r (B) that lie in the quasiconformal
equivalence class Î±, the correspondence Î² â†’ ÎºÎ² is a bijection of such Î² onto mB Â· Î˜Î² .
Remark. In considering the uniformizations just obtained, it is tempting to compare them
with the local uniformization by the aï¬ƒne space modeled on the tangent space to Mg,r
given in the complex case by considering geodesics for the TeichmuÌˆller metric. We believe,
however, that if there is any proper complex analogue to the uniformizations of Theorems
3.6 and 3.8 at all, then it is the uniformization obtained by Bers coordinates. Indeed,
unlike the TeichmuÌˆller coordinates, which are real, but not complex analytic, the Bers
coordinates are (complex) analytic, just as the aï¬ƒne coordinates of Theorems 3.6 and
3.8. Also, (perhaps more crucially) the TeichmuÌˆller coordinates are the same for elliptic
curves regarded either hyperbolically or parabolically. We shall soon see, however, that
the uniformizations analogous to those of Theorems 3.6 and 3.8 for elliptic curves treated
parabolically are diï¬€erent from those in the hyperbolic case. One diï¬€erence between the
Bers uniformization and the uniformizations of Theorems 3.6 and 3.8 is that the Bers
uniformization is by the aï¬ƒne space of quadratic diï¬€erentials (of the complex conjugate
curve), not by the tangent space to Mg,r . On the other hand, (even in the complex
case) one cannot have a holomorphic local canonical uniformization by the aï¬ƒne space of
quadratic diï¬€erentials, as one can see easily by considering a one-pointed curve of genus
one with an automorphism of degree three. Thus, to obtain a uniformization by quadratic
diï¬€erentials, we need more â€œrigidifyingâ€ information. In our case, the information will take
the form of a topological marking of the curve.
Topological Markings and Uniformization by Quadratic Diï¬€erentials
We maintain the notation of the previous subsection. Let us consider the canonical
ord
ord
Frobenius lifting Î¦N : N g,r â†’ N g,r of Theorem 2.8. Just as in Deï¬nition 1.2, Î¦N deï¬nes
ord

canonical eÌtale local systems on N g,r in free Zp -modules of rank 3g âˆ’ 3 + r:
ord

Deï¬nition 3.9. We shall refer to Î˜et
N as the tangential local system on N g,r . We shall
ord

call its dual, Î©et
N , the diï¬€erential local system on N g,r .
116

Note that if one tensors over Zp with Fp , then these local systems become the local systems
(with the same names) considered in Chapter II, Â§3, following Proposition 3.4.
ord

Now let us assume that k is algebraically closed. Let Î± âˆˆ N g,r (A) be a p-adic quasiconformal equivalence class. In this subsection, however, we assume that Î± corresponds to
ord
a smooth curve. We would like to consider the fundamental groupoid of N g,r in the sense
of [SGA 1], ExposeÌ V, p. 130. Recall that this fundamental groupoid is the category of
ord
ï¬ber functors from the category of ï¬nite eÌtale coverings of N g,r to the category of sets.
ord

Moreover, if x âˆˆ N g,r (k), then x deï¬nes a ï¬ber functor Fx of this type by simply restrictord

ord

ing eÌtale coverings of N g,r to Spec(k) via pull-back by x. Thus, if x, y âˆˆ N g,r (k), then we
shall call a path from x to y a natural transformation from Fx to Fy .
On the other hand, recall from the last subsection of Chapter II, Â§3, the set Dg,r of
isomorphism classes of totally degenerate r-pointed stable curves of genus g. If Î” âˆˆ Dg,r ,
ord

then, by abuse of notation, we shall also write Î” âˆˆ N g,r (A) for the totally degenerate
curve over A represented by Î”. Now we make the following important
Deï¬nition 3.10. We shall call a pair Î¼ = (Î”; ) a (p-adic) topological marking for the
ord
quasiconformal equivalence class Î± if Î” âˆˆ Dg,r and  is a path from Î±(mod p) âˆˆ N g,r (k)
ord

to Î” âˆˆ N g,r (k).
Let Î¼ = (Î”; ) be a topological marking for Î±. Then let us note that Î¼ deï¬nes
a canonical nondegenerate bilinear form BÎ¼ on Î˜Î± as follows. First note that by the
construction in Proposition 3.6 of Chapter II, Â§3 (which is carried out there over Fp , but
et
clearly works just as well over Zp ), we have a canonical nondegenerate bilinear form BÎ”
et âˆ¼
et
on Î˜et
Î” . Now the path  deï¬nes an isomorphism Î˜ : Î˜Î± = Î˜Î” . Thus, if we pull-back
et
by means of Î˜ , we get a canonical nondegenerate bilinear form BÎ¼et on Î˜et
BÎ”
Î± . Since
Î˜Î± = (Î˜et
)
âŠ—
A,
we
thus
obtain
(by
tensoring)
a
canonical
nondegenerate
bilinear
form
Zp
Î±
BÎ¼ on Î˜Î± .
Now let (B, mB ) be a local ring with residue ï¬eld k which is p-adically complete and has
ord
a topologically nilpotent PD-structure on mB . Let Î² âˆˆ N g,r (B) be in the quasiconformal
equivalence class Î±. Recall the canonical isomorphism
âˆ’1
: (Î˜Î± )B â†’ Î˜Î²
(Î¨âˆ¨
Î±Î² )

implicit in Theorem 3.8. This isomorphism allows us to transport BÎ¼ to Î˜Î² so as to obtain
a canonical nondegenerate bilinear form BÎ¼Î² on Î˜Î² . We summarize this as follows:
Proposition 3.11. The choice of a topological marking Î¼ on a quasiconformal equivalence
class Î± allows one to deï¬ne a canonical nondegenerate bilinear form BÎ¼Î² on Î˜Î² for every
ord

Î² âˆˆ N g,r (B) in the quasiconformal equivalence class Î±.
117

This ï¬nally allows us to give local uniformizations of Mg,r by means of quadratic diï¬€erentials: Namely, we compose the aï¬ƒne uniformization of Theorem 3.8 with the isomorphism
Î˜Î² âˆ¼
= Î©Î² given by the nondegenerate bilinear form BÎ¼Î² :
Theorem 3.12. The choice of a topological marking Î¼ on a quasiconformal equivalence
class Î± that corresponds to a smooth curve allows one to deï¬ne a canonical class Îºâˆ¨
Î¼,Î² âˆˆ
mB Â· Î©Î² , as well as a local uniformization
âˆ¼ Î²
VÎ¼,Î² : Î©aï¬€
Î² = Mg,r
ord

of Mg,r by the aï¬ƒne space modeled on Î©Î² , for every Î² âˆˆ N g,r (B) in the quasiconformal
ord

equivalence class Î±. Finally, for all Î² âˆˆ N g,r (B) that lie in the quasiconformal equivalence
class Î±, the correspondence Î² â†’ ÎºÎ¼,Î² is a bijection of such Î² onto mB Â· Î©Î² .
Remark. Thus, we have obtained a canonical uniformization of Mg,r by quadratic diï¬€erentials for every choice of a topological marking on Î±. In the complex case, a topological
marking of a Riemann surface is given by ï¬xing the underlying topological manifold, up
to homeomorphisms homotopic to the identity. Thus, the analogy between topological
markings in the p-adic and complex cases lies in the fact that a p-adic topological marking
gives one a canonical basis for Î˜et
Î² , hence for Î˜Î² , corresponding to a collection of partition curves (see Introduction, Â§2) of a Riemann surface. This speciï¬cation of partition
curves determines a topological marking, by gluing together â€œpantsâ€ along the partition
curves. Thus, instead of uniformizing by the aï¬ƒne space modeled on Î©Î² , we could also
have uniformized by the aï¬ƒne space modeled on a direct product of aï¬ƒne lines, one for
each â€œpartition curve.â€ Whichever choice of coordinates (i.e., quadratic diï¬€erentials or
partition curves) is more useful depends on oneâ€™s tastes or the applications one has in
mind.
Canonical Multiplicative Parameters
So far we have only been working with smooth curves. In order to ï¬nd canonical
parameters at singular curves, we need to work with multiplicative parameters (like the
q-parameter in the case of elliptic curves), as opposed to aï¬ƒne parameters, as in Theorems
3.6 and 3.8.
ord

Let Î± âˆˆ N g,r (A) be a p-adic quasiconformal equivalence class (corresponding to a
curve which is not necessarily smooth). Let us assume, for the rest of this subsection,
that k is algebraically closed. Let Î©log
Î± be the restriction of Î©Mlog to Î±, and let Î˜Î± be
g,r

the dual A-module to Î©log
Î± . Then the Frobenius invariant subsections of Î˜Î± form a free
et
log
Zp -submodule Î˜et
âŠ†
Î˜
Î± of rank 3g âˆ’ 3 + r. Similarly, we have Î©Î± âŠ† Î©Î± . Let (Mg,r )Î± be
Î±
the completion of Mg,r âŠ—Zp A at the image of Î±. Let Ï‰ âˆˆ Î©et
Î± have residues equal to zero
118

or one at all the irreducible components of the divisor at inï¬nity of Mg,r , and nonzero
reduction modulo p. Then, just as in Deï¬nition 1.11, we have a parameter
qÏ‰,Î±
on (Mg,r )Î± , which is well-deï¬ned up to multiplication by a TeichmuÌˆller representative
[kÃ— ]. This parameter is a unit at all the divisors where the residue of Ï‰ is zero and has
valuation one at all the divisors where the residue of Ï‰ is one. Moreover,
p
Î¦âˆ’1
N (qÏ‰,z ) = qÏ‰,z

Deï¬nition 3.13. We shall call such a parameter qÏ‰,Î± a canonical multiplicative parameter
on (Mg,r )Î± .
The Case of Elliptic Curves
Just as in previous Chapters, it is useful to look at the case of elliptic curves (regarded
parabolically) since the calculations are usually much easier in this case. As before, we let
log
log
M1,0 be the log stack of elliptic curves, and f log : G log â†’ M1,0 be the universal elliptic
curve (with the log structure deï¬ned by the pull-back to G of the divisor at inï¬nity of
ord
M1,0 ). Let M1,0 âŠ† M1,0 be the open p-adic formal substack parametrizing ordinary
ord

ord

elliptic curves. Recall that we computed in Chapter II, Theorem 3.11, that N 1,0 = M1,0 ,
ord

and that the section of S 1,0 over (M1,0 )Fp corresponding to the unique nilpotent, ordinary
indigenous bundle on an elliptic curve was given explicitly in Example 2 of Chapter I,
Â§2. Now it is easy to see that, although nominally everything in this Chapter was done
for hyperbolic curves, much of the theory goes through for elliptic curves, as well. In
ord
particular, the construction of the canonical Frobenius lifting Î¦N on M1,0 goes through
just as before. Since everything else in the Chapter is essentially a formal consequence of
the existence of Î¦N , in this subsection, we would like to compute the lifting Î¦N explicitly
for elliptic curves, and identify the resulting concepts (i.e., canonical curves, uniformization,
topological marking, etc.) with the well-known objects of classical Serre-Tate theory. For
a treatment of classical Serre-Tate theory, we refer to [Mess] and [KM] (p. 260).
ord

Let us begin by recalling a certain Frobenius lifting Î¦M on M1,0 which is fundamental
to Serre-Tate theory. Ultimately, we shall show that Î¦M = Î¦N . First recall that the
eÌtale quotient of the (log) p-divisible group P associated to the universal elliptic curve
ord
ord
G ord â†’ M1,0 deï¬nes a local system L on M1,0 in free Zp -modules of rank one. Also, since
P is self-dual, taking Cartier duals gives us an inclusion Lâˆ¨ (1) âŠ— (Qp /Zp ) â†’ P (where
the â€œ1â€ in parentheses denotes a Tate twist). Let PÎ¦ âŠ† P be the subgroup scheme given
by Lâˆ¨ (1) âŠ— ( p1 Zp /Zp ). Thus, taking the quotient by this subgroup scheme PÎ¦ gives us an
isogeny:
119

Î¦G : G ord â†’ H
ord

ord

ord

to some elliptic curve H over M1,0 . Let Î¦M : M1,0 â†’ M1,0 be the classifying morphism
of H. Thus, H = Î¦âˆ—M G ord . Since considered modulo p, the subgroup scheme PÎ¦ is nothing
but the kernel of Frobenius, it follows that Î¦M is a Frobenius lifting, and that (Î¦G )Fp is
ord
just the relative Frobenius on GF
. For convenience, we shall denote objects pulled back
p
via Î¦M with a superscript â€œF .â€
Now let us consider the eï¬€ect of pulling back the indigenous bundle (E, âˆ‡E )F on
(G ) , where (E, âˆ‡E ) is the indigenous bundle on G ord given in Example 2 of Chapter
I, Â§2. Let (F, âˆ‡F ) = Î¦âˆ—G (E, âˆ‡E )F . Let us denote by Ï‰ the relative dualizing sheaf of
ord F

ord

G ord â†’ M1,0 . Then as a vector bundle,
F = Î¦âˆ—G (Ï‰)F âŠ• OG
âˆ—
F
Now let Î¦Ï‰
G : Î¦G (Ï‰) â†’ Ï‰ denote the morphism on diï¬€erentials induced by Î¦G , divided
by p. Then I claim that Î¦Ï‰
G is an isomorphism. Indeed, since we are dealing with ordinary
elliptic curves, the local group structure near the origin is isomorphic to that of Gm (the
multiplicative group scheme), and the Frobenius lifting Î¦G just amounts to the pth power
map on Gm . This proves the claim. Since E = Ï‰ âŠ• OG , Î¦Ï‰
G thus gives us an isomorphism:

Eâˆ¼
=F
by taking the direct sum of Î¦Ï‰
G with the identity on OG . Next, we consider connections.
Recall that âˆ‡E diï¬€ers from the trivial connection by the tautological Ad(E)-valued differential form given by mapping the ï¬rst factor Ï‰ to the second factor OG âŠ— Ï‰. Thus,
when we pull-back by Î¦G , we get a similar nilpotent endomorphism-valued diï¬€erential
form, this time given by the map from Î¦âˆ—G (Ï‰)F (the ï¬rst factor) to OG âŠ— Ï‰ (the second
factor) given by p Â· Î¦Ï‰
G . On the other hand, when we compute the renormalized Frobenius
pull-back of (E, âˆ‡E ), we divide out by this factor of p. It thus follows that under the isomorphism E âˆ¼
= F considered above, the renormalized Frobenius pull-back gives a connection
on F which corresponds precisely to the connection âˆ‡E on E. Since Î¦N and (EN , âˆ‡EN )
are uniquely characterized by the property that the renormalized Frobenius pull-back of
Î¦âˆ—N (EN , âˆ‡EN ) is isomorphic to (EN , âˆ‡EN ), we thus see that we have proven the following
result.
Theorem 3.14. The canonical Frobenius lifting Î¦N for elliptic curves (regarded parabolically) is equal to the Frobenius lifting Î¦M . Moreover, the canonical indigenous bundle
(EN , âˆ‡EN ) is the indigenous bundle constructed in Example 2 in Chapter I, Â§2.
Remark. In other words, what we have constructed here is just a relative version of the
uniformizing MF âˆ‡ -object of Deï¬nition 1.3.
120

Now let k be a perfect ï¬eld of characteristic p. Then it is well-known from Serre-Tate
theory that an elliptic curve E â†’ Spec(W (k)) is canonical in the sense of Serre-Tate theory if and only if the point in Î± âˆˆ M1,0 (W (k)) that it deï¬nes is ï¬xed by Î¦M . We thus
obtain that the deï¬nition of a canonical curve given in Deï¬nition 3.1 is consistent with the
deï¬nition arising from Serre-Tate theory. Suppose we ï¬x a trivialization of LâŠ—2 |Î± . Then
Serre-Tate theory gives a local uniformization of M1,0 near this point Î± by the completion Gm of the multiplicative group at the identity. Relative to this uniformization, Î¦M
becomes the pth power map on Gm . It thus follows immediately that the canonical aï¬ƒne
parameters that we constructed before (in the general case) correspond to the logarithm
of the Serre-Tate parameter (up to multiplication by a unit of W (k)). Moreover, one sees
âŠ—2
.
easily that the local system Î©et
M corresponding to the Frobenius lifting Î¦M is simply L
Thus, a topological marking (in the sense of Deï¬nition 3.10) deï¬nes a trivialization of
LâŠ—2 |Î± , and so the Serre-Tate parameter itself is a canonical multiplicative parameter in
the sense of Deï¬nition 3.13. We summarize this as follows:
Theorem 3.15. Canonical liftings for elliptic curves (as deï¬ned in Deï¬nition 3.1 relative
to Î¦N ) are the same as canonical liftings in the sense of Serre-Tate theory. Moreover, the
uniformization of Theorem 3.12 in the case of elliptic curves (regarded parabolically) is the
same as the uniformization of Mord
1,0 given by Serre-Tate theory.
Remark. It appears that the case discussed here in Theorem 3.15, i.e., the case g = 1, r = 0,
is the only case of the theory of this paper that is essentially a reformulation of a classically
known theory. For instance, already in the case g = 1, r = 1, despite the fact that
ord
ord
and N1,1
are quite diï¬€erent.
M1,0 = M1,1 (as stacks), it is not diï¬ƒcult to show that N1,0
ord
Indeed, in general, there exist connected components of N1,1 that are of degree > 1 over
M1,1 (cf. Proposition 3.12 of Chapter II). This implies, in particular, that Î¦N in the case
g = 1, r = 1 is quite diï¬€erent from Î¦N in the case g = 1, r = 0.
Finally, we observe that the term â€œtopological markingâ€ is apt in this case in the
sense that a topological marking deï¬nes a trivialization of L|Î± , which is analogous in the
complex case to specifying a particular pair of generators for the fundamental group of an
elliptic curve.

121

Chapter IV: Canonical Curves
Â§0. Introduction
Because canonical curves (as deï¬ned in Chapter III, Deï¬nition 3.1) admit Frobenius
invariant indigenous bundles, they possess a number of special arithmetic and geometric
properties. In this Chapter, we study a number of these properties, foremost among which
are the existence of a canonical Frobenius lifting, and the construction of a canonical pdivisible group. In particular, the canonical Frobenius lifting allows us to give a geometric
characterization of canonical curves which may be regarded as the hyperbolic analogue of
the statement in Serre-Tate theory that a lifting of an ordinary elliptic curve is canonical if
and only if it admits a lifting of Frobenius. From the point of view of comparison with the
complex case, this canonical Frobenius lifting may be regarded as a sort of p-adic Greenâ€™s
function. In the complex case, the Greenâ€™s function plays a central role in the development
of uniformization theory from the classical (as opposed to Bersâ€™ quasiconformal) point of
view. In this context, the Greenâ€™s function is essentially the logarithm of the hyperbolic
distance function between two points. We shall see that the Frobenius lifting also gives us
a sort of p-adic notion of distance. Also, we shall see that we can construct â€œpseudo-Hecke
correspondencesâ€ which in some sense geometrically codify this notion of distance.
On the other hand, in the canonical case, we can also construct a certain Galois representation (arising from the torsion points of the canonical log p-divisible group) which is
the p-adic analogue of the canonical representation in the complex case of the fundamental
group into PSL2 (R) (deï¬ned by the covering transformations of the upper half plane).
Thus, in some sense, we see that at least in the canonical case, we are able to obtain analogues of most of the fundamental objects that appear in classical complex uniformization
theory.
This brings us to the ï¬nal reason for wanting to study the canonical case: namely,
the fact that the universal hyperbolically ordinary curve (over the moduli stack) is itself
(essentially) a canonical curve. Thus, in Chapter V, by restricting these canonical objects
over the universal curve to a given (not necessarily canonical) curve, we will be able to
obtain Greenâ€™s functions, canonical Galois representations, and so on for noncanonical
curves, as well.

Â§1. The Canonical Galois Representation
In this Section, we construct a certain canonical Galois representation of the arithmetic fundamental group of a canonical curve. After studying some of the basic global
properties of such representations, we then consider what happens on the ordinary locus
of the curve. In particular, we construct a canonical ordinary Frobenius lifting over the
ordinary locus. This allows us to apply the general theory of Chapter III, Â§1. We will
122

refer to the multiplicative parameters obtained from this general theory as the Serre-Tate
parameters. We will make use of the Serre-Tate parameter quite often in this Chapter.
Throughout this Section, we will work over A = W (k), where k is a perfect ï¬eld of
odd characteristic. The quotient ï¬eld of A will be denoted by K. Let g, r be nonnegative
ord
integers such that 2g âˆ’ 2 + r â‰¥ 1. Also, we will deal with a ï¬xed Î± âˆˆ N g,r (A), which
corresponds to a smooth canonical curve f log : X log â†’ S log , where S log is Spec(A) with the
trivial log structure. Since singular canonical curves are just obtained by gluing together
smooth canonical curves, we shall concentrate mainly on the smooth case.
Construction and Global Properties
Let (E, âˆ‡E ) be the canonical indigenous bundle on X log (whose existence is stated in
Chapter III, Theorem 2.8). In fact, unless the number r of marked points is even, such
a vector bundle will not exist. However, one can always pass to an eÌtale double cover
of X on which it will exist, and then descend. For simplicity, we will just act as though
this problem does not exist, except when we state ï¬nal results in Theorems, in which
case our representations will be into GLÂ± (that is, the general linear group GL modulo
the subgroup {Â±1}). Now, we would also like to say that the renormalized Frobenius
pull-back Fâˆ— (E, âˆ‡E )F is isomorphic to (E, âˆ‡E ). In general, this may only be true up to
tensoring with a line bundle with connection whose square is trivial, but this may also be
ignored, provided we remember that ultimately our representations will be into GLÂ± , not
GL. Let us choose an isomorphism Î¦E : (E, âˆ‡E ) âˆ¼
= Fâˆ— (E, âˆ‡E )F which is the identity on
determinants. We shall call Î¦E the canonical Frobenius action on (E, âˆ‡E ).
Now let us assume that there exists a rational point x : S â†’ X on X which avoids
log
the marked points. Let us denote by Î  the proï¬nite group Ï€1 (XK
, xK ). Then Theorem
2.6 of [Falt] implies that
Theorem 1.1. There exists a unique dual crystalline (in the sense of [Falt], Â§2) representation
Ï : Î  â†’ GLÂ± (V )
(where V is a free Zp -module of rank two) that corresponds (under the functor D(âˆ’) of
[Falt], Â§2) to (E, âˆ‡E , Î¦E ). Moreover, the determinant representation of Ï is the cyclotomic
character. We shall refer to Ï as the canonical crystalline representation associated to
X log .
Remark. In the complex case, a hyperbolic Riemann surface can be uniformized by the
upper half plane. Then the fundamental group of the Riemann surface acts on the upper
half plane via covering transformations, and so we get a representation of the fundamental
123

group into PSL2 (R), which is canonically determined up to conjugation. The representation Ï of Theorem 1.1 is the p-adic analogue of this complex representation.
def

Now let Î” = Ï€1 (XK , xK ) be the geometric subgroup of Î , so Î“ = Î /Î” is the Galois
group of K over K. Then by â€œthe comparison theoremâ€ (Theorem 5.3 of [Falt]), we get:
Theorem 1.2. Let p â‰¥ 5. Then the group cohomology modules H i (Î”, Ad(V )(1)) (where
the â€œ(1)â€ is a Tate twist) are zero, except when i = 1. Let U = H 1 (Î”, Ad(V )(1)). Then
U is a crystalline Zp -Î“-module, which, as a Zp -module is free of rank 6(g âˆ’ 1) + 2r. It
corresponds under the functor D(âˆ’) to an MF-object (in the sense of Fontaine-Laï¬€aille)
(N ; F i (N ); Ï†i ) over A, where N is a free A-module of rank 6(g âˆ’ 1) + 2r; F i (N ) = 0 if
log âŠ—2
i â‰¥ 4; F i (N ) = N if i â‰¤ 0; F i (N ) is naturally isomorphic to H 0 (X, (Ï‰X/S
) (âˆ’D)), if
1
1
i = 1, 2, 3; and N/F (N ) is naturally isomorphic to H (X, Ï„X log /S log ).
Remark. Some mathematicians have raised questions concerning that the validity of the
proof in [Falt], Theorem 5.3. However, in this one-dimensional case, one can give ad hoc
proofs of this result, and, moreover, (at least in the closed case, when r = 0) T. Tsuji has
orally informed the author that he has obtained a diï¬€erent proof of Theorem 5.3 of [Falt].
One interesting fact about the canonical representation Ï is that it is possible to
characterize it â€“ as well as the canonicality of X log â€“ solely in terms of the properties of Ï
as a Galois representation:
Theorem 1.3. Suppose that p â‰¥ 5. Let X log â†’ Spec(A) be any (not necessarily canonical)
r-pointed smooth curve of genus g over A. Assume that we are not in the cases (g = 0; r =
3) or (g = 1; r = 1). Let Ï„ : Î  â†’ GLÂ± (W ) be any dual crystalline representation of
log
Î  = Ï€1 (XK
, xK ) on a free Zp -module W of rank two such that
(1) HPi (Î”, Ad(W )(1)) = 0 if i = 1; H 1 (Î”, Ad(W )(1)) is crystalline, and
corresponds to an MF-object M = (M ; F i (M ); Ïˆ i ) such that F i (M ) =
0 if i â‰¥ 4; F i (M ) = M if i â‰¤ 0; and F i (M ) is a free A-module of rank
3(g âˆ’ 1) + r if i = 1, 2, 3;
(2) the Frobenius endomorphism of (M/F 1 (M ))Fp (arising from the MFobject of (1)) is an isomorphism;
(3) det(Ï„ ) is the cyclotomic character.
Then X log is canonical, and Ï„ is isomorphic to the representation Ï of Theorem 1.1.
Proof. Since Ï„ is asserted to be dual crystalline, it corresponds to some vector bundle with
connection (G, âˆ‡G ) on X log , together with a ï¬ltration F i (G) on G. Let i1 (respectively,
i2 ) be the largest i such that F i (G) = 0 (respectively, F i (G) = G). Thus, i1 â‰¥ i2 . The
124

condition that det(Ï„ ) be cyclotomic implies that i1 + i2 = 1. If the rank of F i1 (G) is not
one, then i1 = i2 , and det(Ï„ ) could not be cyclotomic, so F i1 (G) must be of rank one, and
i1 > i2 . Let L = F i1 (G). Thus, L is a line bundle.
Let j1 be the largest j such that F j (M ) = 0. Now we claim that L can not be stable
under âˆ‡G . Indeed, if it were, then the monodromy at the marked points of âˆ‡G on L,
being nilpotent and one-dimensional, must be zero. Thus, the induced connection on L
has no poles at the marked points. But this would imply that deg(L) = 0. Hence the
rank over A of F j1 (M ) would be â‰¤ h0 (X, LâŠ—2 âŠ— Ï‰X/S ) â‰¤ g < 3g âˆ’ 3 + r (by Cliï¬€ordâ€™s
Theorem), which contradicts our hypotheses. This proves the claim. On the other hand,
by Griï¬ƒths transversality, if i1 âˆ’ i2 â‰¥ 2, then F i1 (G) would have to be stable under âˆ‡G .
Thus, i1 = i2 + 1, so i1 + i2 = 1 implies that i1 = 1 and i2 = 0.
Now rankA (F 3 (M )) = 3g âˆ’ 3 + r â‰¤ h0 (X, LâŠ—2 âŠ— Ï‰X/S ), so the line bundle LâŠ—2 âŠ— Ï‰X/S
must be nonspecial, by Cliï¬€ordâ€™s Theorem. It thus follows that deg(LâŠ—2 ) â‰¥ 2gâˆ’2+r. Since
the Kodaira-Spencer morphism for the ï¬ltration is nonzero, we cannot have deg(LâŠ—2 ) >
2g âˆ’ 2 + r. Thus, we see that (G, âˆ‡G ) must be indigenous. Since it is also carried to itself
by the renormalized Frobenius, it follows from Chapter III, Corollary 3.4, that X log is
canonical, and that (G, âˆ‡G ) must be the canonical indigenous bundle of Theorem 1.1. 
Remark. For the reader who is interested in handling the cases g = 0; r = 3 and g = 1;
r = 1, as well, we remark that by considering conditions (similar to those imposed on
H i (Î”, Ad(W )(1))) on higher symmetric powers of W , one can characterize the canonical
representations in these cases as well solely in terms of their properties as Galois representations.
Remark. Really, the substantive missing element here is that it is not clear to the author
how to characterize the property of being â€œdual crystallineâ€ solely in terms of properties of the representation relative to the triple (Î ; Î” âŠ† Î ; Î /Î” âˆ¼
= Gal(K/K)). Thus,
log
is always present in the background of this
ultimately, a knowledge of the curve X
â€œGalois representation-theoreticâ€ characterization of the canonical representation. For instance, if the property of being â€œdual crystallineâ€ were known to depend only on the triple
(Î ; Î” âŠ† Î ; Î /Î” âˆ¼
= Gal(K/K)), then one could obtain the result that whether or not a
curve is canonical depends only on that triple.
In the following, we return to the assumption that X log is canonical.
The Horizontal Section over the Ordinary Locus
We maintain the notation of the previous subsection. Let X ord be the p-adic formal
scheme which is the open sub-formal scheme of X given by the complement of the supersingular divisor (Chapter II, Proposition 2.6). Let us endow X ord with the log structure
induced by X log , and call the resulting log formal scheme (X log )ord . We shall refer to
125

(X log )ord as the ordinary locus of X log . The purpose of this subsection is to prove and
interpret the following result:
1

Theorem 1.4. There exists a unique subbundle T 2 âŠ† E|X ord of rank one with the following
properties:
1

(1) T 2 is horizontal, and moreover, for any n, the reduced line bundle
1

2
TZ/p
n Z has a nonempty subsheaf (in the category of sets) consisting of
1

2
horizontal sections that generate TZ/p
n Z as an OX ord -module;
1

(2) T 2 is taken to itself by Î¦E .
Finally, (T 2 )âŠ—2 is naturally isomorphic to Ï„X log /S log |X ord .
1

1

Proof. Let us prove that there exists a unique Î¦E -invariant horizontal subbundle T 2 âŠ†
E|X ord with horizontal generating sections. We prove this by induction on n, where the nth
1
step is the construction of such a T 2 modulo pn . For n = 1, recall that (up to tensoring
with a line bundle) EFp is an FL-bundle (Chapter II, Proposition 2.5). Then under the
1

correspondence of that Proposition, we take our subbundle TF2p to be the subbundle of
E corresponding to the subbundle that we called â€œT â€ in our discussion of FL-bundles in
Chapter II, Â§1. This subbundle is clearly horizontal, and has local generating sections
that are horizontal. In this case, uniqueness follows from the fact that the p-curvature is
nonzero.
Now we assume that n â‰¥ 2, and that the result is known for nâˆ’1. Let U log = (X log )ord ,
and let Î¦log : U log â†’ (U log )F be a Frobenius lifting. Let us consider the quotient Q
(respectively, P) of EZ/pn Z by pnâˆ’1 Â· F 1 (E) (respectively, pnâˆ’1 Â· E). Thus, P is a quotient
of Q, and P = EZ/pnâˆ’1 Z . Let T  âŠ† P be the subbundle given us by the induction
hypothesis. Let T  âŠ† Q be the the inverse image of T  âŠ† P via the surjection Q â†’ P.
1
âˆ—
F
2
Then Î¦âˆ— (T  )F âŠ† Î¦âˆ— QF deï¬nes a subbundle TZ/p
n Z of F (E)Z/pn Z . It follows from the
1

1

2
deï¬nition of TF2p and the fact that we are on the ordinary locus that TZ/p
n Z is ï¬‚at over
1

2
Z/pn Z. The existence of local horizontal generating sections for TZ/p
n Z follows by taking


such a section of T , lifting it to T , and then pulling back this lifted section of T  to a
1
âˆ—
2
section of TZ/p
n Z via Î¦ . That the connection vanishes on this section follows from the
deï¬nitions, plus the fact that pulling back by Î¦ adds an extra factor of p. Since T  is Î¦E 1
1
nâˆ’1
2
2
Z = T  . Thus, by the construction of TZ/p
invariant, it follows that TZ/p
n Z âŠ— Z/p
nZ,
1


2
it is clear that TZ/p
by Î¦E will
n Z is Î¦E -invariant, since pulling back any lifting of T
1

2
give TZ/p
n Z . Also, this same observation (coupled with the induction hypothesis) proves
uniqueness. This completes the proof of the induction step. The last statement about
1
1
(T 2 )âŠ—2 follows from considering the splitting of the Hodge ï¬ltration that T 2 deï¬nes. 

126

Now suppose that our basepoint x : S â†’ X maps into the ordinary locus X ord . Let
Î ord = Ï€1 ((X log )ord
K , xK ). Thus, we have a natural morphism:
Î ord â†’ Î 
Let us denote the restriction of Ï to Î ord via this natural morphism by
Ïord : Î ord â†’ GLÂ± (V ord )
Then if we apply the theory of [Falt], Â§2 to interpret Theorem 1.4, we see that the subbundle
1
T 2 âŠ† E|X ord in fact deï¬nes a sub-MF âˆ‡ -object corresponding to an eÌtale representation
(Ïord )et : Î ord â†’ GLÂ± (Vet ) of Î ord , for some rank one free Zp -quotient module V ord â†’ Vet .
Here, by â€œeÌtale,â€ we mean that the kernel of (Ïord )et deï¬nes an eÌtale covering of X ord . In
other words, we have an exact sequence of (â€œup to {Â±1}â€) representations of Î ord :
0 â†’ Vetâˆ¨ (1) â†’ V ord â†’ Vet â†’ 0
where the â€œ1â€ in parentheses is a Tate twist. We state this as a Corollary:
Corollary 1.5. The restriction Ïord of Ï to Î ord deï¬nes an (â€œup to {Â±1}â€) module V ord
of Î ord , which ï¬ts into an exact sequence:
0 â†’ Vetâˆ¨ (1) â†’ V ord â†’ Vet â†’ 0
where Vet is eÌtale and of rank one over Zp .
The Canonical Frobenius Lifting over the Ordinary Locus
In this subsection, we construct the generalized analogue (for an arbitrary canonical
X ) of the p-adic endomorphism of the ordinary locus of the moduli stack of elliptic curves
obtained by sending an elliptic curve with ordinary reduction to its quotient modulo its
unique subgroup scheme which is eÌtale locally isomorphic to Î¼p . In many respects, the
construction is similar to (although not literally a logical consequence of) the construction
ord
of the Frobenius lifting on N g,r constructed in Chapter III, Â§2.
log

Consider the canonical indigenous bundle (E, âˆ‡E ) (of Theorem 1.1) on the canonical
curve X log â†’ S log . By Chapter II, Proposition 2.5, (E, âˆ‡E )Fp corresponds to an FL-bundle
0 â†’ TFp â†’ F â†’ OXFp â†’ 0
127

on XFlog
. By the material directly preceding Chapter II, Proposition 1.2, splittings of this
p
log
exact sequence correspond to Frobenius liftings on XZ/p
2 Z . Now, over the ordinary locus
log
of X , the Hodge ï¬ltration deï¬nes such a splitting. Let us denote the resulting Frobenius
lifting on the ordinary locus by

log ord F
Î¦2 : (X log )ord
) )Z/p2 Z
Z/p2 Z â†’ ((X

Let us denote by E the vector bundle which is the inductive limit of the following diagram:
F 1 (E)
â
âpÂ·

âˆ’â†’

E

F 1 (E)
where the horizontal arrow is the natural inclusion. Note that EZ/pn Z depends only on
F
EZ/pn Z . By the deï¬nition of the renormalized Frobenius pull-back, Î¦âˆ—2 EZ/p
2 Z is naturally
isomorphic to EZ/p2 Z . We shall identify these two sheaves in the following discussion. On
the other hand, by considering the object in the upper right-hand corner of the diagram
 we obtain a morphism
deï¬ning E,
F
Î¦âˆ—2 EZ/p
2 Z â†’ EZ/p2 Z
âˆ— 1
F
âˆ— 1
F
whose restriction to Î¦âˆ—2 F 1 (E)F
Z/p2 Z vanishes on p Â· Î¦2 F (E)Z/p2 Z and maps Î¦2 F (E)Z/p2 Z
into p Â· F 1 (E)Z/p2 Z (by the deï¬nition of the correspondence between Frobenius liftings and
splittings of the FL-bundle F).
log ord F
Now let Î¨3 : (X log )ord
) )Z/p3 Z be any lifting of Î¦2 . Then, again from
Z/p3 Z â†’ ((X
the deï¬nition of the renormalized Frobenius pull-back, we obtain a morphism

F
Î¨âˆ—3 EZ/p
3 Z â†’ EZ/p3 Z

which vanishes on p2 Â· Î¨âˆ—3 F 1 (E)F
Z/p3 Z . However, if Î¨3 is an arbitrary lifting of Î¦2 , then we
âˆ— 1
F
donâ€™t know that Î¨3 F (E)Z/p3 Z is mapped into F 1 (E)Z/p3 Z .
Now suppose that we modify Î¨3 by a section Î´ âˆˆ Î“(X ord , TFp ). Let HT : TFp â†’
(Ï„X log /S log )Fp |X ord be the isomorphism deï¬ned by projecting to the Hodge ï¬ltration. Then
the subsheaf of EZ/p3 Z given by the image of F 1 (E)F
Z/p3 Z under Î¨3 + Î´ diï¬€ers from the
corresponding image subsheaf under Î¨3 by the amount HT (Î´) âˆˆ Î“(X ord , (Ï„X log /S log )Fp ).
Indeed, this follows from the deï¬nitions, plus the fact that the Kodaira-Spencer morphism
for E is the identity. Since HT is an isomorphism, it thus follows that there exists a unique
Frobenius lifting
128

log ord F
Î¦3 : (X log )ord
) )Z/p3 Z
Z/p3 Z â†’ ((X
1
that lifts Î¦2 such that Î¦âˆ—3 maps F 1 (E)F
Z/p3 Z into F (E).

Clearly, we may repeat this procedure modulo pn for arbitrary n â‰¥ 3, so as to obtain
a unique
log ord
) â†’ ((X log )ord )F
Î¦log
X : (X

such that under the natural morphism
Î¦âˆ—X E F â†’ E
the Hodge ï¬ltration is preserved. Note, moreover, that it follows from the fact that the
Kodaira-Spencer morphism at the Hodge section is an isomorphism plus the interpretation
of the FL-bundle F in terms of Frobenius liftings that this Frobenius lifting Î¦log
X is ordinary
in the sense of Chapter III, Deï¬nition 1.1. In summary, we have proven the following result:
Theorem 1.6. Let X log be a canonical curve; (E, âˆ‡E ) the canonical indigenous bundle on
X log . Then there exists a unique ordinary Frobenius lifting (called canonical)
log ord
Î¦log
) â†’ ((X log )ord )F
X : (X

over the ordinary locus that preserves the Hodge ï¬ltration.
In particular, we can apply the theory of Chapter III, Â§1, to the Frobenius liftâˆ‡
ing Î¦log
X . Note that it follows immediately from the deï¬nitions that the MF -object
(E, F 1 (E), âˆ‡E , Î¦E )|(X log )ord is precisely the uniformizing MF âˆ‡ -object associated to Î¦log
X
(as in Chapter III, Deï¬nition 1.3). Let us write
T = (T 2 )âŠ—2
1

Thus, âˆ‡E (respectively, Î¦E ) induces a natural connection (respectively, Frobenius action)
on T , which deï¬nes the canonical tangential local system of Chapter III, Deï¬nition 1.2.
Since T is a line bundle, it is the same to give (over an eÌtale covering of X ord ) a generating
Frobenius invariant section of it, or a generating Frobenius invariant section of its dual.
Thus, (just as in Chapter III, Deï¬nition 1.11) if Î¸ is such a section of T , then Î¸ deï¬nes, at
every z âˆˆ X ord (A) that avoids the marked points, a unique multiplicative parameter
qÎ¸ âˆˆ RzÃ—
129

(where Rz is the completion of X ord at z). If the residue of Î¸ is equal to one at a marked
point z âˆˆ X ord (A), then we get a multiplicative parameter
q âˆˆ Rz
(with valuation one at the divisor Im(z)) which is unique up to multiplication by a TeichmuÌˆller representative [kÃ— ].
Deï¬nition 1.7. We shall call q (respectively, qÎ¸ ) the Serre-Tate parameter (respectively,
relative to Î¸) at z.
Note, in particular, that by the theory of Chapter III, Â§1, Î¦âˆ’1
X maps q (respectively, qÎ¸ ) to
p
p
q (respectively, qÎ¸ ).
Remark. In some sense, it would be more aesthetically pleasing if one could obtain the
Frobenius lifting of Theorem 1.6 in the following way. We consider the universal curve
ord
C â†’ N g,r . Then C parametrizes (r + 1)-pointed stable curves of genus g, so we have a
Frobenius lifting on some stack which is eÌtale over C. If we could prove that this Frobenius
ord
lifting is compatible with the canonical Frobenius lifting on N g,r , then we could obtain a
canonical Frobenius lifting on C (or at least some stack eÌtale over C) simply by using the
ord
canonical Frobenius on N g,r+1 .
The problem with this approach is that despite the fact that the canonical modular
Frobenius liftings of Chapter III do have many interesting functorial relations (i.e., relative to restriction to the boundary and log admissible coverings), in general, the sort of
compatibility of Frobenius liftings necessary to make the above sketch of a proof work â€“
namely, compatibility with â€œforgetting a marked pointâ€ â€“ simply does not hold. Indeed,
one can already see this in the case of the morphism
M1,1 â†’ M1,0
which is the identity on the underlying stacks, but which we think of as assigning to a onepointed curve of genus one the underlying elliptic curve. Here, the canonical Frobenius on
ord
ord
N 1,1 cannot be compatible with the canonical Frobenius on N 1,0 for the following reason.
ord

Since N 1,0 â†’ M1,0 is an open immersion, it would follow that the canonical Frobenius
ord

on N 1,1 would descend to an open formal subscheme of M1,1 . But this would mean that
even if a one-pointed curve of genus one in characteristic p belongs to several distinct
quasiconformal equivalence classes (a phenomenon which by Chapter II, Proposition 3.13,
does occur), the canonical liftings of that curve would be the same for all quasiconformal
equivalence classes. But this would mean that we have several diï¬€erent ordinary indigenous
bundles on a single hyperbolic curve, all of which are Frobenius invariant. By Chapter III,
Lemma 2.6, this is absurd.
130

Â§2. The Canonical Log p-divisible Group
Although the existence of the canonical Galois representation of Â§1 is, in and of itself,
of some interest, one technical drawback that it has is that it is diï¬ƒcult to relate the
log
that it
properties of the Galois representation or the characteristic zero coverings of XQ
p
log
determines to XZ/p
n Z . Thus, in this Section, we shall construct a log p-divisible group
log
on X which gives us back the canonical Galois representation (by looking at the Galois
action on torsion points), but which has the advantage that one can study and understand
its reductions modulo pn in a similar fashion to the elliptic modular case (which is studied
in [KM]).

Log p-divisible Groups at Inï¬nity
We maintain the notation of the previous Section (although k need not be algebraically
closed, just perfect). For basic facts about log schemes, we refer to [Kato] and [Kato2].
In [Kato2], certain ï¬nite, log ï¬‚at group objects over the compactiï¬ed moduli stack of
elliptic curves are introduced which are supposed to be the analogue at inï¬nity of the
usual ï¬nite, ï¬‚at group schemes that one gets from elliptic curves by considering the kernel
of multiplication by a power of p. Since we will use such objects (as well as the p-divisible
group objects obtained by taking direct limits thereof) later in this Section, we take the
time out in the present subsection to review explicitly the construction of these ï¬nite, log
ï¬‚at group objects.
Let R = A[[q]] be a complete local ring which is formally smooth of dimension one
over A. If one inverts q, then by taking the (pn )th root of q, one obtains an extension of
ï¬nite ï¬‚at group schemes
0 â†’ Z/pn Z(1) â†’ Gn â†’ Z/pn Z â†’ 0
over R[1/q]. Because q is not a unit in R, it is impossible to extend this extension of ï¬nite
ï¬‚at group schemes over R[1/q] to an extension of ï¬nite ï¬‚at group schemes over R. Our goal
in this subsection, however, is to exhibit a natural extension of the above exact sequence
to an exact sequence deï¬ned over R by working with group objects in the category of
ï¬nite, log ï¬‚at log schemes over Spec(R)log . (In this subsection, we will regard Spec(R) as
endowed with the log structure arising from the divisor deï¬ned by q.)
For nonnegative integers a, b, let Ma,b be the monoid given by taking the quotient of
N (where N is the monoid of nonnegative integers) by the equivalence relation generated
by (pa , 0) âˆ¼ (0, b). Let e1 âˆˆ Ma,b (respectively, e2 âˆˆ Ma,b ) be the image of (1, 0) (respectively, (0, 1)) in Ma,b . Then it follows from the theory of [Kato2] (especially, Â§4.1, 5.1) that
we can construct the desired extension
2

log

0 â†’ Z/pn Z(1) â†’ Gn â†’ Z/pn Z â†’ 0
131

n

as follows: For j âˆˆ {0, . . . , pn âˆ’ 1}, consider the scheme Gn,j given by R[x]/(xp âˆ’ q j ),
with the log structure given by the chart ([Kato], Â§2) Mn,j with e1 â†’ x; e2 â†’ q. Denote
log
the resulting log scheme by (G )log
n,j . Let Gn,j be the universal valuative log space ([Kato2],
log

Â§1.3.1) (which, in this case, will still be a log scheme) associated to (G )log
n,j . Let Gn be
log

log

the union of the Glog
n,j . Note that when we invert q, Gn becomes Gn . Endow Gn with
log

the unique structure of group object that extends the group structure on Gn . Then Gn
is a group object in the category of ï¬nite, log ï¬‚at log schemes over Spec(R)log , and it ï¬ts
into an exact sequence as above.
log

log

As we allow n to vary, we get morphisms Gn â†’ Gn+1 . Thus, we obtain an ind-group
object G over Spec(R)log .
Deï¬nition 2.1. We shall refer to G as the log p-divisible group over Spec(R)log obtained
by taking pth power roots of q âˆˆ R.
Finally, we remark that, although what we are doing here is, in some sense, just
â€œtrivial general nonsense,â€ its utility lies in the fact that by using it, we can obtain p-adic
ï¬nite coverings of X log that are deï¬ned over all of X log , thus allowing us to algebrize.
Construction of the Canonical Log p-divisible Group
We now turn to the construction of the canonical log p-divisible group on X log . Consider the MF âˆ‡ -object (E, âˆ‡E , Î¦E ), deï¬ned by the canonical indigenous bundle. Let n â‰¥ 1.
Let U âŠ† X be the open p-adic subscheme deï¬ned by removing the marked points. Then
the reduction modulo pn of (E, âˆ‡E , Î¦E )|U deï¬nes, by [Falt], Theorem 7.1, a ï¬nite, ï¬‚at
group scheme (annihilated by pn ), which we denote by Gn |U â†’ U . On the other hand, let
R be the complete local ring at any one of the marked points. Then (E, âˆ‡E , Î¦E ) deï¬nes a
Serre-Tate parameter (as in Deï¬nition 1.7) q âˆˆ R/[kÃ— ]. Let q âˆˆ R be any representative
of q. Then R = A[[
q ]]. Let Glog
n |R be the log scheme constructed in the previous subn th
section by taking a (p ) -root of q. Observe that diï¬€erent choices of q give us naturally
isomorphic Glog
, then Glog
n |R â€™s. Also, note that if we invert q
n |R becomes (Gn |U )|R . Thus,
log
we see that Gn |U and the various Gn |R at the marked points glue together naturally to
log
form a ï¬nite, log ï¬‚at group object Glog
, which a priori is just p-adic, but may be
n â†’ X
algebrized since X is proper over A. Also, as n varies, we obtain natural morphisms
log
. . . â†’ Glog
n â†’ Gn+1 â†’ . . .

which thus form an inductive system of group objects.
Deï¬nition 2.2. We shall call this inductive system of group objects the canonical log
p-divisible group on X log .
132

Remark. As usual, strictly speaking we really have only deï¬ned a â€œgroup up to {Â±1}.â€
That is, we really only have a group object over (perhaps) a ï¬nite eÌtale covering of X
of degree 4, plus descent data (satisfying the cocycle condition up to {Â±1}) down to the
original X. We could, of course, develop the general nonsense of such â€œgroups up to {Â±1},â€
but we choose not to, since it seems to serve no real purpose.
If we invert p, then this log p-divisible group Glog on X log deï¬nes a local system on
log
) in free Zp -modules of rank two. Thus, we get a Galois representation
the eÌtale site (XQ
p et
on the Tate module T of characteristic zero torsion points of Glog :
ÏGlog : Î  â†’ GLÂ± (T )
Then we have the following result (which is immediate from the theory of [Falt], especially
the construction in the proof of Theorem 7.1):
Proposition 2.3. The representation ÏGlog is isomorphic to the canonical Galois representation Ï of Theorem 1.1.
Review of the Theory of [Katz-Mazur]
In this subsection, we apply to the log p-divisible group Glog the theory of [KM],
which is exposed in [KM] solely in the case of the canonical log p-divisible on the compactiï¬ed moduli stack of elliptic curves, but whose proofs go through without change for the
canonical log p-divisible group Glog on any canonical curve X log .
First of all, because Glog is a logarithmic p-divisible group, it follows from [Mess],
Chapter II, Theorem 3.3.13, that if we consider the formal neighborhood of the identity
section : X â†’ G, we obtain a formally smooth formal scheme G( ) over X, which is easily
seen to have relative dimension 1 over X. We would like to use this observation to apply
the theory of [KM], Chapter 1, on â€œA-generatorsâ€ and â€œA-structuresâ€ to Glog . The theory
there goes through just as in the modular case since the only technical assumption needed
on the ï¬nite, ï¬‚at (logarithmic) group schemes whose A-generators we wish to parametrize
is that they be closed subschemes of some smooth one-dimensional scheme. However,
looking at the proofs of [KM], one sees that in fact, it suï¬ƒces to have the ï¬nite, ï¬‚at (log)
group schemes be closed subschemes of a formally smooth formal scheme (such as G( ))
of relative dimension one. Thus, we can deï¬ne various moduli problems, just as in [KM],
Chapter 3, by means of various structures:
(1) a Î“(n)-structure, which consists of giving a Drinfeld basis for Glog
n ;
(2) a Î“1 (n)-structure, which consists of giving a point â€œof exact order pn â€
in Glog
n ;
133

(3) a Î“0 (n)-structure, which consists of giving an isogeny Glog â†’ H log
(where H log is also a log p-divisible group) whose kernel is cyclic of
order pn .
Moreover, just as in [KM], one proves that these various moduli problems are representable
by schemes X(n); X1 (n); X0 (n) that are ï¬nite over X. Finally, all of these schemes X(n);
X1 (n); and X0 (n) are, in fact, regular. Indeed, away from the marked points, the proofs
of regularity in [KM], Chapters 5 and 6, boil down to general nonsense plus two technical
results (Proposition 5.3.4 and Theorem 6.1.1). Since these technical results are proven,
respectively, for arbitrary formal groups and arbitrary ï¬nite group schemes, it is immediate
that the regularity proofs of [KM] in the modular case go through without change for X(n);
X1 (n); and X0 (n). At the marked points, the combinatorial descriptions of the situation at
the cusps in [KM], Chapter 10, go through without change for the above moduli problems.
We thus obtain the following Theorem:
Theorem 2.4. The schemes X(n); X1 (n); and X0 (n) that represent the moduli problems
listed above are all regular, and hence equal to the normalizations of X in the ï¬nite coverings of XK deï¬ned by the appropriate composites of Ï : Î  â†’ GLÂ± (V ) with ï¬nite quotients
GLÂ± (V ) â†’ G, just as in the classical modular case.
Fix a positive integer n. We shall also need to analyze X0 (n) modulo p, in a fashion
similar to what is done in the modular case in [KM], Chapter 13. Let us (for the rest of
the Section) denote X0 (n) by Y , and let us use a subscript m on X, Y , etc., to denote
reduction modulo pm+1 . Let us denote by Î¦A : A â†’ A, Î¦k : k â†’ k the respective absolute
Frobenius morphisms, and by a superscript F m the result of base-changing an object by the
mth power of Frobenius, and by Î¦X0 : X0 â†’ X0F the relative Frobenius of X0 . Essentially,
the description of Y0 = Y âŠ—Zp Fp given in [KM], Chapter 13, goes through in our situation
here, but we need to do things with a little bit more care, since [KM] often falls back on
the â€œcrutchâ€ of using the modular interpretation of their â€œX,â€ which we lack in this more
general situation.
For each ordered pair of nonnegative integers (a, b) such that a + b = n, we would
like to deï¬ne a k-scheme X0 (a, b) of â€œ(a, b)-cyclic isogeniesâ€ together with a k-morphism
Î¹(a,b);0 : X0 (a, b) â†’ Y0 . We do this as follows. If a, b â‰¥ 1, then we let X0 (a, b) be
the schematic inverse image of Inf pâˆ’1 (Î”) (the (p âˆ’ 1)st inï¬nitesimal neighborhood of the
diagonal) via
bâˆ’1
F
Î¦aâˆ’1
X 0 Ã— Î¦ X 0 : X0 Ã— X 0

aâˆ’b

â†’ X0F

aâˆ’1

Ã— X0F

aâˆ’1

If a or b is zero, then we let X0 (a, b) be the schematic inverse image of the diagonal Î” via
Î¦aX0 Ã— Î¦bX0 : X0 Ã— X0F
134

aâˆ’b

a

â†’ X0F Ã— X0F

a

Observe that in either case, (X0 (a, b))red is smooth over k; Î¦aX0 Ã— Î¦bX0 maps X0 (a, b) âŠ†
aâˆ’b
a
a
into Î” âŠ† X0F Ã— X0F ; and X0 (a, b) comes equipped with a ï¬nite, ï¬‚at, radicial
X0 Ã— X0F
morphism
D0 (a, b) : X0 (a, b) â†’ X0
To deï¬ne
Î¹(a,b);0 : X0 (a, b) â†’ Y0
we must specify a cyclic subgroup of order pn of D0 (a, b)âˆ— Glog
0 . Now on the one hand,
by composing the ath power of Frobenius with the bth -power of the Verschiebung (as in
[KM], Theorem 13.3.5), we get some subgroup object of order pn of D0 (a, b)âˆ— Glog
0 , and by
the same argument as that given in [KM], Theorem 13.3.5, one sees that this subgroup
must be cyclic (in the Drinfeldian sense). Thus, by the modular deï¬nition of Y0 , we get a
morphism Î¹(a,b);0 : X0 (a, b) â†’ Y0 .
In order to apply the theory of [KM], Chapter 13, we must verify the conditions (1)
through (8) listed at the beginning of that Chapter. (Caution: The letters X and Y
in [KM], Chapter 13, are used in the reverse way to the way that they are used here.)
Conditions (1), (2), (4), (5), and (6) are trivial. Condition (3) follows from the regularity
of Y and the fact that over a supersingular point, there is only one A-generator valued in
k for a cyclic group, namely the identity element. Note that at ordinary points, one can
do the same analysis of pth power isogenies of log p-divisible groups as is done in [KM],
Chapter 13, Â§3. Thus, Condition (7) (that Î¹(a,b);0 is a closed immersion) and Condition (8)
(that the Î¹(a,b);0 â€™s deï¬ne an isomorphism of the disjoint union of X0 (a, b)â€™s with Y0 over
the ordinary locus) follow at the level of topological spaces from this analysis, and at the
level of complete local rings by considering the deformation parameters for the domain
and range log p-divisible groups of the isogeny. We thus get a result analogous to [KM],
Theorem 13.4.7:
Theorem 2.5. The k-scheme Y0 is the disjoint union, with crossings at the supersingular
points (in the terminology of [KM], Chapter 13, Â§1), of the n + 1 schemes X0 (a, b) (where
a + b = n). Let f(a,b) âˆˆ k[[x, y]] be the equation
aâˆ’1

(xp
a

bâˆ’1

âˆ’ yp

)pâˆ’1

b

if a, b â‰¥ 1, and let it be xp âˆ’ y p if a or b is zero. Then the completed local ring at a
k-rational supersingular point of Y0 is isomorphic to
k[[x, y]]/(



(a,b)

135

f(a,b) )

with the closed subscheme X0 (a, b) âŠ† Y0 given by the equation f(a,b) .

Â§3. The Compactiï¬ed Canonical Frobenius Lifting
In this Section, we study the canonical Frobenius lifting on the ordinary locus of
a canonical curve (deï¬ned in Theorem 1.6). In particular, we study its behavior at supersingular points, and â€œcompactify itâ€ in some sense, so as to obtain â€œpseudo-Hecke
correspondences.â€ It is by abstracting the main properties of this compactiï¬ed Frobenius
in the canonical case that we shall obtain a geometric criterion for a curve to be canonical
in Â§4.
The Canonical Frobenius Lifting and the Canonical Log p-divisible Group
Let us denote by
log ord
Î¦log
) â†’ ((X log )ord )F
X : (X

the canonical Frobenius lifting of Theorem 1.6. Let Glog be the canonical log p-divisible
group on X log of Deï¬nition 2.2. Then we rephrase Theorem 1.6 in terms of Glog as follows:
Theorem 3.1. The canonical Frobenius lifting of Theorem 1.6
log ord
Î¦log
) â†’ ((X log )ord )F
X : (X

induces an isogeny of degree p
Î¦âˆ—X (Glog )F |(X log )ord â†’ Glog |(X log )ord
between the canonical log p-divisible groups that lifts the Frobenius morphism modulo p.
log ord
)
that has this property.
Moreover, Î¦log
X is the unique Frobenius lifting over (X
Proof. The existence of the isogeny follows from the fact that we have deï¬ned a morphism
between the respective DieudonneÌ crystals that respects the Hodge ï¬ltrations. This induces
the isogeny (see [BBM] and [Mess]). On the other hand, the uniqueness statement follows
from the uniqueness statement in Theorem 1.6, together with the fact that if a Frobenius
lifting induces such an isogeny, it automatically preserves the Hodge ï¬ltrations on the
DieudonneÌ crystals. 
136

Let n â‰¥ 0. Let Y = X0 (n). Let Y ord âŠ† Y be the p-adic open formal subscheme
consisting of points lying over X ord . Now the Frobenius lifting of Theorem 3.1 allows us
to extend the decomposition in characteristic p of YFp into components corresponding to
(a, b)-cyclic isogenies to a decomposition over A = W (k), on the ordinary locus. To obtain
this decomposition, we deï¬ne closed p-adic subschemes
X(a, b)ord âŠ† X ord Ã—A (X ord )F

aâˆ’b

via the same recipe as we did for X0 (a, b), except using our canonical Frobenius lifting
log ord
Î¦log
)
â†’ ((X log )ord )F instead of Î¦X0 . Then, just as before, we get a natural
X : (X
embedding Î¹(a,b) : X(a, b)ord â†’ Y ord (analogous to Î¹(a,b);0 ) which induces an isomorphism
Y ord âˆ¼
=



X(a, b)ord

(disjoint union)

a+b=n

Finally, over Y ord , we have a tautological isogeny
Glog
â†’ HYlogord
Y ord
(where Glog
is the pull-back of Glog to Y ord ) such that over X(a, b)ord , HYlogord is naturally
Y ord
aâˆ’b
aâˆ’b
isomorphic to the pull-back of (Glog )F
via the projection X(a, b)ord â†’ (X ord )F
to
the second factor.
Local Analysis at Supersingular Points
We now exploit the existence of the isogeny of Theorem 3.1 to understand the behavior of the canonical Frobenius lifting at the supersingular points. Let x âˆˆ X(k) be
a supersingular point. In studying x, we will often need to involve its various Frobenius
i
conjugates xF âˆˆ X(k) (which may be inï¬nite in number if the perfect ï¬eld k is not ï¬nite).
We begin our analysis by considering the double iterate of the Frobenius morphism over
some inï¬nitesimal neighborhood V âŠ† XFp at x:
Î¦2V : Glog |V â†’ Glog |V F 2
Thus, V is the spectrum of a local artinian ring, with residue ï¬eld k. Let us assume that
V is contained in the supersingular divisor (Chapter II, Proposition 2.6) of the canonical
indigenous bundle. By deï¬nition, this means that over V , the Hodge ï¬ltration coincides
with the FL-bundle ï¬ltration. It thus follows that over V , the kernels of the Verschiebung
and Frobenius morphisms coincide. Since the kernel of the composite of the Verschiebung
and the Frobenius is just the kernel of multiplication by p, it follows that the morphism
Î¦2V is isomorphic to the morphism â€œmultiplication on p.â€ In particular, it follows that
137

Glog |V F 2 âˆ¼
= Glog |V
By iterating this isomorphism, we obtain that Glog |V is isomorphic to the pull-back to V
of a p-divisible group over k. Since the Kodaira-Spencer morphism of the Hodge ï¬ltration
of (E, âˆ‡E ) is an isomorphism, this implies that V must be Spec(k). Thus, the assumption
that V lies inside the supersingular divisor implies that V is reduced. Put another way, we
see that we have proven (in this general context) the analogue of Igusaâ€™s theorem ([KM],
p. 355):
Proposition 3.2. The supersingular divisor of the canonical indigenous bundle (E, âˆ‡E )
is eÌtale over k.
Next, let us observe that for any x âˆˆ X(k), the completed local ring Rx of X at x
(which is formally smooth of dimension one over A) is naturally isomorphic to the universal
deformation space of the p-divisible group Glog |x . Indeed, it follows from the theory of
[Mess] that deformations of Glog |x are given by deformations of the Hodge ï¬ltration; thus,
our observation follows from the fact that the Kodaira-Spencer morphism of the Hodge
ï¬ltration of (E, âˆ‡E ) is an isomorphism. Now suppose that x âˆˆ X(k) is supersingular. Then
the isomorphism
Glog |xF 2 âˆ¼
= Glog |x
obtained above from the double iterate of Frobenius induces a natural isomorphism of
complete local rings
Î¨x : RxF 2 âˆ¼
= Rx
which will play an important role in the sequel.
Now ï¬x a number n â‰¥ 1, and let Y = X0 (n). If x âˆˆ X(k), let us denote by Xx the
formal spectrum of X at x, i.e., Spf(Rx ). We will use similar notation for Y . Over Y , we
have a tautological cyclic isogeny of order pn :
log
Glog
Y â†’ HY

Fix a supersingular x âˆˆ X(k). By the analysis of [KM], reviewed in Â§2, there exists a
unique y âˆˆ Y (k) lying over x. Now by thinking of the completed local rings of X as
universal classifying spaces, we obtain a morphism:
(Dy , Ry ) : Yy â†’ Xx Ã—A XxF n
138

where Dy is the classifying morphism for the â€œdomain p-divisible groupâ€ Glog
Y , and Ry is
log
the classifying morphism for the â€œrange p-divisible groupâ€ HY . Here we use the fact that
restricted to x, the tautological isogeny is just the nth iterate of the Frobenius morphism, so
HYlog |y = Glog
. Also, note that by the deformation theory of [Mess], a deformation of the
xF n
tautological isogeny is uniquely determined by the induced deformations of the domain and
range p-divisible groups. It thus follows that the morphism (Dy , Ry ) is formally unramiï¬ed,
hence a closed immersion. Thus, henceforth, we shall think of Yy as a formal divisor inside
Xx Ã— XxF n by means of the closed immersion (Dy , Ry ).
One of the most important properties of this divisor Yy is its symmetry. More precisely,
given Yy , one can obtain a divisor in XxF n Ã— Xx in two ways:
(1) by applying the isomorphism Xx Ã— XxF n âˆ¼
= XxF n Ã— Xx given by switching the two factors;
(2) by conjugating ï¬rst by the nth power of Frobenius, so as to obtain a
divisor in XxF n Ã— XxF 2n and then applying the isomorphism Spf(Î¨x )âˆ’n
to the second factor.
Then we claim that these two divisors in XxF n Ã— Xx are the same. Indeed, to see this,
it suï¬ƒces to trace what happens to the tautological isogeny. Let us consider the second
procedure stated above. First, we conjugate the tautological isogeny by Frobenius:
n

F
â†’ (HYlog
)F
(Glog
Yy )
y

n

Since at y, this isogeny is just the nth iterate of the Frobenius morphism, by looking at
DieudonneÌ modules, it follows that the kernel of this isogeny is contained in the kernel of
multiplication by pn . Thus, we get a morphism
n

F
(HYlog
)F â†’ (Glog
Yy )
y
n

n

2n

F
Since (Hylog )F = (Glog
, we thus see that the divisor in XxF n Ã— Xx obtained this
y )
way is just the divisor of isogenies (lifting the nth iterate of Frobenius) from the universal
deformation of Glog
x (pulled back from the second factor) to the universal deformation of
log F n
(Gx )
(pulled back from the ï¬rst factor). On the other hand, it we look at the divisor
obtained from the ï¬rst procedure stated above, it admits exactly the same description.
This proves the claim.

The next important property of this divisor Yy âŠ† Xx Ã— XxF n is that if we restrict it
to the ordinary locus, it becomes equal to the union of the â€œlocal versionsâ€ of the schemes
X(a, b)ord (described at the end of the preceding subsection). More precisely, X(a, b)ord
aâˆ’b
is deï¬ned as a closed subscheme of X ord Ã— (X ord )F . Thus, we obtain X(a, b)ord |Xx âŠ†
aâˆ’b
(X ord Ã— (X ord )F )Xx by restricting to the formal scheme Xx . Since a âˆ’ b â‰¡ a + b =
139

n(mod 2), by applying the appropriate power of Î¨x , we thus obtain a subscheme, which
we shall call
n

ord
X(a, b)ord
Ã— (X ord )F )Xx
x âŠ† (X

Then it follows from the functorial deï¬nition of Y (in terms of parametrizing isogenies)
that


Yy |X ord =

X(a, b)ord
x

(disjoint union)

a+b=n

Let us denote the supersingular divisor of X by X ss . We are now ready to summarize
what we have done:
Deï¬nition 3.3. We shall call the pair
def

Hx = (Yy ; Î¨x )
consisting of the divisor Yy âŠ† Xx Ã— XxF n and the isomorphism Î¨x the nth canonical local
Hecke correspondence of X log at x. We shall call the triple
(Y â†’ X; Î¦log
X ; {Hx }xâˆˆX ss )
the nth canonical pseudo-Hecke correspondence of X log .
Of course ideally, the local Hecke correspondences Hx would glue together to form a
n
global Hecke correspondence, i.e., a morphism Y â†’ X Ã— X F , just as in the classical case
with modular curves. We shall investigate this issue in the next subsection, but (unfortunately) what we shall ï¬nd is that the existence of such global Hecke correspondences is a
rather rare phenomenon.
Global Hecke Correspondences
We maintain the notation of the previous subsection.
Deï¬nition 3.4. We shall say that the canonical curve X log admits a global nth canonical
Hecke correspondence if there exists a morphism
(D, R) : Y â†’ X Ã— X F
140

n

that is equal to the local morphisms (Dy , Ry ) of the preceding subsection for every y âˆˆ Y
lying over a supersingular point of X. We say that X log is of Hecke type if it admits a
global nth canonical Hecke correspondence for every n â‰¥ 1.
2

Proposition 3.5. Suppose that there exists an isomorphism Î¨log : X log â†’ (X log )F that
induces the morphism Spf(Î¨x ) when localized at every supersingular x âˆˆ X. Then X log is
of Hecke type.
Proof. This follows immediately from gluing together Y ord with the various Yy â€™s by means
of Î¨log . 
Corollary 3.6. Suppose that X log , along with all of its supersingular points are deï¬ned
over Fp2 . Then X log is of Hecke type.
Proof. Over Fp2 , one can take Î¨log to be the identity, for (by functoriality) the Î¨x â€™s must
all be the identity. 
The classical example of a case where X log is of Hecke type is the case where X log =
log
M1,0 , the compactiï¬ed moduli stack of elliptic curves (over Zp ). This case is studied in
detail in [Shi], Chapter 3. To see that the supersingular points are deï¬ned over Fp2 , one
2
repeats the argument preceding Proposition 3.2, to obtain an isomorphism E F âˆ¼
= E for
every supersingular elliptic curve E.
Suppose that X log is canonical of Hecke type. Then we remark that just as in the
log âŠ—N
classical case, one can deï¬ne Hecke operators on H 0 (X, (Ï‰X/S
) )Qp (as well as one the
log
eÌtale cohomology of XQ
, etc.). Moreover, (by the same proofs as in the classical case)
p
the eï¬€ect on q-expansions (where q is the Serre-Tate parameter at a marked point) is the
same as in the classical case. (See, e.g., [Lang] for more details.)

Next, we justify the assertion (made in the preceding subsection) that, in some sense,
being of Hecke type is a rather rare phenomenon. Indeed, if X log admits a global ï¬rst
canonical Hecke correspondence, consider its reduction modulo p:
(D, R)Fp : YFp â†’ XFp Ã— XFFp

Let Z = YFp . Then Z = Z  Z  , with Z  mapping isomorphically to XFp via DFp , and
âˆ’1
DFp |Z  isomorphic to the Frobenius morphism from Z  âˆ¼
= XFFp to XFp . On the other
âˆ’1

hand, RFp must map Z  isomorphically to XFFp . Thus, Z  is isomorphic to both XFFp
2
and XFFp . In particular, XFp âˆ¼
= XFFp , i.e., the moduli of XFp are deï¬ned over Fp2 , which
is a very rare phenomenon.
141

Remark. At the present time, the author does not know of any canonical X log of
Hecke type, except for those that arise directly from the modular case.
Â§4. p-adic Greenâ€™s Functions
In this Section, we give a geometric criterion for a curve to be canonical: namely, the
existence of a Frobenius lifting of the right height, over an open p-adic formal subscheme
of the curve, with â€œnice behaviorâ€ at the points where it is not deï¬ned. We will make
these terms precise below, but the point of interest is that this criterion does not depend
ord
on knowing the action of the canonical Frobenius Î¦N on N g,r â€“ that is, it is intrinsic
to the curve â€“ and, moreover, it is not phrased in terms of indigenous bundles. Now in
the case of elliptic curves (regarded parabolically), the canonical lifting deï¬ned in terms
of indigenous bundles is the same as the canonical lifting deï¬ned in Serre-Tate theory
(one of the deï¬nitions of which is the existence of a global Frobenius lifting). Thus, it is
interesting to note that the existence of an â€œadmissible Frobenius liftingâ€ amounts to just
the existence of a Frobenius lifting (in the case of elliptic curves). In other words, one
may regard the geometric criterion given here as the proper hyperbolic generalization of
the statement that an elliptic curve (whose reduction modulo p is ordinary) is Serre-Tate
canonical if and only if it admits a Frobenius lifting.
Compactiï¬ed Frobenius Liftings
In this subsection, motivated by the construction of the pseudo-Hecke correspondences
in the previous Section, we deï¬ne the general notion of a â€œcompactiï¬ed Frobenius lifting.â€
Let X log â†’ S log be a smooth r-pointed curve of genus g. Let
Ï†log : Y log â†’ X log
be a ï¬nite, ï¬‚at morphism such that Y is regular (necessarily of dimension two), and the
log structure on Y log is deï¬ned by a divisor on Y which is eÌtale over A and equal to the
set-theoretic inverse image of the divisor of marked points of X. Let U âŠ† X be an open
formal subscheme that contains all the marked points. We endow U with the log structure
pulled back from X log , and call the resulting log formal scheme U log . We shall use the
notation Xx , Yy , etc. (as in the previous subsection) to denote the formal schemes which
are the formal neighborhoods of the closed points x, y, etc. Suppose that
Î¦log : U log â†’ (U log )F
is a Frobenius lifting.
Deï¬nition 4.1. We shall say that (Ï†log : Y log â†’ X log ; Î¹) is a naive compactiï¬cation of the
Frobenius lifting Î¦log if, when we take V = Ï†âˆ’1 (U ), the following conditions are satisï¬ed:
142

(1) V log splits as a disjoint union (V log )



(V log ) ;

(2) Ï†log |V  : (V log ) â†’ U log is an isomorphism;
(3) Î¹log : (V log ) â†’ (U log )F

âˆ’1

(4) Ï†log |V  â—¦ (Î¹log )âˆ’1 : (U log )F

is an isomorphism;
âˆ’1

â†’ U log is the morphism (Î¦log )F

We shall frequently identify V  and U , and V  and U F

âˆ’1

âˆ’1

.

.

Suppose that (Ï†log ; Î¹log ) is a naive compactiï¬cation for Î¦log . Note that Ï† is necessarily
of degree p + 1. Also, note that V  admits a canonical embedding
Î¹(1,0) : V  â†’ U Ã— U F
where we take Î¹(1,0) = (id, Î¦), while V  admits an embedding
Î¹(0,1) : V  â†’ U Ã— U F
where we take Î¹(0,1) = ((Î¦)F

âˆ’1

âˆ’1

, id).

Let x âˆˆ X(k). Let
Î¨x : RxF 2 âˆ¼
= Rx
be an isomorphism. Suppose that y âˆˆ Y (k) maps to x. Let
(Dy , Ry ) : Yy â†’ Xx Ã— XxF
be a closed embedding, where Dy is obtained by restricting Ï†.
def

Deï¬nition 4.2. We shall say that Hx = (Î¨x ; (Dy , Ry )) is a local compactiï¬cation for the
Frobenius lifting Î¦log at x (relative to (Ï†log ; Î¹log )) if
(1) y is the unique closed point of Y lying over x;
(2) the divisor Yy â†’ Xx Ã— XxF is symmetric in the sense that the two
divisors that it induces in XxF Ã— Xx (by switching and by Frobeniusconjugating, then applying Î¨x ) are the same;
(3) the restriction of (Dy , Ry ) to V is the union of Î¹(1,0) , and (Î¹(0,1) )F
composed with Spf(Î¨x )âˆ’1 Ã— (id).
143

2

Note that by the ï¬rst condition, x cannot lie in U . Now let us consider (Yy )Z/p2 Z . Since
Yy âŠ† Xx Ã— XxF , it follows that (Yy )Z/p2 Z is Spf of a local ring of the form:
def

R = (A/p2 A)[[Î¾, Î·]]/Ïˆ(Î¾, Î·)
where Î¾ is a local parameter for (Xx )Z/p2 Z , and Î· = Î¾ F is the Frobenius-conjugate local
parameter for (XxF )Z/p2 Z . Since Yy â†’ Xx is ï¬‚at, the last condition implies that (Yy )Fp
has exactly two irreducible components, both of which are reduced. Thus, if we denote by
a â€œbarâ€ the reduction of functions modulo p, we see that Ïˆ is a product of two distinct
prime elements of k[[Î¾, Î·]]. In fact, we can say more. Outside the special point of (Yy )Fp ,
p

these two primes deï¬ne the closed subschemes Î¾ âˆ’ Î· and Î· p âˆ’ Î¨x (Î¾
f = Î¾ p âˆ’ Î·;

F2

). Let

2

g = Î· p âˆ’ Î¨x (Î¾ F )

Thus, we may assume that Ïˆ = f Â· g. In other words, we can write
Ïˆ =f Â·g+Ï€
where Ï€ âˆˆ p Â· k[[Î¾, Î·]]. In fact, Ï€ is actually p times a unit in k[[Î¾, Î·]], since Yy is regular.
So far we have been working with functions on (Yy )Z/p2 Z . Now let us restrict to
functions on the open formal subscheme D(g) âŠ† (Yy )Z/p2 Z (i.e., where g is invertible).
Thus, we are in eï¬€ect restricting to the graph of Î¦. Let us denote the restriction morphism
on functions by Î¶ : R â†’ R[1/g]. Then we obtain, in R[1/g],
Î¶(Î·) = Î¶(Î¾)p + Î¶(Ï€) Â· Î¶(g)âˆ’1
By interpreting this open formal subscheme D(g) as the graph of Î¦, this tells us that
Î¦âˆ’1 (Î¾ F ) is a function which is not regular at x, but has a pole of order one (since g has a
zero of order one). In particular, it tells us that the Frobenius lifting Î¦ does not admit a
regular extension to any neighborhood of x. We summarize this as follows:
Proposition 4.3. If Hx is a local compactiï¬cation of Î¦log at x, then (Yy )Fp is a node,
and x âˆˆ
/ U . Also, the Frobenius lifting Î¦ does not admit an extension to any neighborhood
of x.
Deï¬nition 4.4. We shall call
C = (Ï†log ; Î¹log ; {Hx }xâˆˆU
/ )
144

a compactiï¬cation of the Frobenius lifting Î¦log if (Ï†; Î¹) is a naive compactiï¬cation of Î¦log ,
and for each x âˆˆ
/ U , we are given a local compactiï¬cation Hx of Î¦log relative to (Ï†; Î¹)
(where k in the deï¬nition above is replaced by the ï¬eld of rationality of x).
Thus, in particular, by what we did in the last two subsections,
Proposition 4.5. Suppose that X log is a canonical curve. Then its ï¬rst canonical
pseudo-Hecke correspondence is a compactiï¬cation of the canonical Frobenius lifting on
(X log )ord .
def

log
Suppose that (Ï†log ; Î¹log ; {Hx }xâˆˆU
. Let us consider Z =
/ ) is a compactiï¬cation of Î¦
YFp . It follows from the above deï¬nition that Z is reduced and has exactly two irreducible
components Z  and Z  with VF p âŠ† Z  ; VFp âŠ† Z  . Since Z  is geometrically connected,
smooth, proper, and birationally equivalent to XFp over k, it follows that Z  âˆ¼
= XF p .
 âˆ¼
F âˆ’1


Similarly, Z = XFp . Moreover, except at the points of intersection of Z and Z (which
are nodes), Z is smooth over k.

Proposition 4.6. (Assuming that X log is hyperbolic) Y must be connected.
Proof. It suï¬ƒces to prove that Z is connected. Suppose that Z is not connected. Then
Ï†Z  : Z  â†’ XFp is ï¬nite and birational, hence an isomorphism. It thus follows that Z 
lifts to a connected component Y  of Y such that Ï†Y  : Y  â†’ X is an isomorphism.
âˆ’1
On the other hand, Z  is proper and smooth over k, and birational to XFFp , hence
âˆ’1
Z  âˆ¼
= X F , and Ï†|Z  : Z  â†’ XF is the Frobenius morphism. Moreover, Z  lifts to a
Fp

p

connected component Y  of Y . Thus, Ï†|Y  : Y  â†’ X is a Frobenius lifting. But if X log is
hyperbolic, such Frobenius liftings cannot exist, for the nonzero morphism of line bundles
log
â†’ Ï‰Ylog /S violates degree restrictions. 
(Ï†|Y  )âˆ— Ï‰X/S
The Height of a Frobenius Lifting
Finally, we note that often it is useful to have a precise measure of how far a Frobenius
lifting fails to extend over all of X. For this, we introduce the notion of the height of a
Frobenius lifting, as follows.
Let F â†’ XFp be the TFp -torsor of Frobenius liftings on open sub-log schemes of
Thus, if Î¦log : U log â†’ (U log )F is a Frobenius lifting, its reduction modulo p2
deï¬nes a section ÏƒÎ¦ : UFp â†’ F of this torsor. Let P be the projective bundle that
canonically compactiï¬es F. Thus, P â†’ XFp is a P1 -bundle. Recall the notion of the
canonical height of a section of P â†’ XFp , introduced at the beginning of Chapter I, Â§2.
Since XFp is proper over k, it follows that ÏƒÎ¦ extends uniquely to a section Ïƒ Î¦ : XFp â†’ P .
We now make the following
log
XZ/p
2Z.

145

Deï¬nition 4.7. We deï¬ne the height ht(Î¦) of the Frobenius lifting Î¦log to be the canonical
height of the section Ïƒ Î¦ of P â†’ XFp .
More concretely, the height of Î¦log can be deï¬ned as follows. If x âˆˆ XFlog
, then let t be a
p
log
local parameter of X at x. Let Îx be a local Frobenius lifting deï¬ned in a neighborhood
âˆ’1
of x. Then p1 (Îâˆ’1
(t)) is a rational function Î´x on XFlog
. Let us say that the local
x (t) âˆ’ Î¦
p
log
height htx (Î¦) of Î¦ at x is:
(1) equal to 0 if this function Î´x is regular at x;
(2) equal to the order of the pole of Î´x at x otherwise.
Then we have the formula:
Proposition 4.8. We have

p
[k(x) : k] htx (Î¦)
ht(Î¦) + (2g âˆ’ 2 + r) =
2
log
xâˆˆXF

p

Proof. This follows immediately from considering the intersection number of Ïƒ Î¦ with the
â€œsection at inï¬nityâ€ given by the complement of F in P . 
Corollary 4.9. If Î¦log admits a compactiï¬cation, then the local heights at points outside
U are all one. Thus,
p
ht(Î¦) = âˆ’ (2g âˆ’ 2 + r) + degk (X âˆ’ U )Fp
2
where we regard (X âˆ’ U )Fp as having the reduced, induced scheme structure.
Proof. The statement about local heights follows from the explicit computation preceding
Proposition 4.3. 
The following is the main result of this subsection:
Proposition 4.10. If Î¦log has height â‰¤ 1âˆ’gâˆ’ 12 r, then P (with its connection âˆ‡P induced
by that of F) is a nilpotent, admissible indigenous bundle. In particular, if (P, âˆ‡P ) is also
ordinary, then X log is isomorphic to a canonical curve modulo p2 , and Î¦log is equal to the
canonical Frobenius lifting (of Theorem 3.1) modulo p2 .
146

Proof. Indeed, suppose that ht(Î¦) â‰¤ 1 âˆ’ g âˆ’ 12 r. Consider the Kodaira-Spencer morphism
of the section Ïƒ Î¦ of P â†’ X. By the general properties of FL-bundles (Chapter II, Â§1),
we know that the Kodaira-Spencer morphism cannot vanish (for the section at inï¬nity of
P â†’ X is the unique horizontal section). But by degree considerations (i.e., the assumption
on ht(Î¦)), once the Kodaira-Spencer morphism is nonzero, it must be an isomorphism. It
thus follows that P (with its connection induced by that of F) is a nilpotent, admissible
indigenous bundle. The last statement follows from the construction of the canonical lifting
and the canonical Frobenius. 
Thus, we see that the compactiï¬ed Frobenius liftings that we are really interested in
are the ones that â€œlook nice modulo p:â€
Deï¬nition 4.11. A compactiï¬ed Frobenius lifting
C = (Ï†log ; Î¹log ; {Hx }xâˆˆU
/ )
is called admissible if
(1) ht(Î¦) = g âˆ’ 1 + 12 r;
(2) the associated (P, âˆ‡P ) (as in Proposition 4.10) is ordinary;
(3) the reductions modulo p of the isomorphisms Î¨x (that make up Hx )
are equal to the canonical â€œÎ¨x â€ of Deï¬nition 3.3.

Note that for an admissible compactiï¬ed Frobenius C, all the objects involved (that is,
Î¦log ; Ï†log : Y log â†’ X log ; Î¹log ; Î¨x ; (Dy , Ry )) are completely determined modulo p (up to
isomorphism) once one ï¬xes the supersingular divisor (X âˆ’ U )Fp . Or, in other words,
Proposition 4.12. An admissible compactiï¬ed Frobenius C on X log determines a p-adic
quasiconformal equivalence class Î± to which X log belongs. If two admissible compactiï¬ed
Frobenii C and C  on X log determine the same Î±, then, modulo p, all the objects that make
up C are isomorphic to those that make up C  .
Admissible Frobenius Liftings
Since an admissible compactiï¬ed Frobenius is determined modulo p by the p-adic
quasiconformal equivalence class Î±, the next step is to understand what the possible deformations looks like. Let C be an admissible compactiï¬ed Frobenius, and let us consider
CZ/p2 Z , i.e., the reductions modulo p2 of all the objects involved. Suppose we start with
147

the data (Î¦log )Z/p2 Z ; (Î¨x )Z/p2 Z (for all supersingular x). Now it is easy to see (by looking
at points valued in an arbitrary scheme) that the symmetry condition on the divisor Yy
amounts to the statement that (Î¨x )Z/p2 Z restricted to the ordinary locus commutes with
Î¦Z/p2 Z .
Let Î² be an automorphism of (Xx )Z/p2 Z which is equal to the identity modulo p. Then
we claim that if Î¦Z/p2 Z commutes with Î², then Î² is the identity. Indeed, since derivations
on XFp act trivially on functions that are pth powers, we get that
Î¦Z/p2 Z â—¦ Î² = Î¦Z/p2 Z
Thus,
Î² F â—¦ Î¦Z/p2 Z = Î¦Z/p2 Z
which implies that Î² is the identity, since Î¦Z/p2 Z is faithfully ï¬‚at. Thus, in summary, the
(Î¨x )Z/p2 Z are determined uniquely by the condition that they commute with Î¦Z/p2 Z .
Next, we consider Y log . We can break Y log up into three parts: (V log ) ; (V log ) ; and
the Yy â€™s. Since (V log ) and (V log ) are determined up to natural isomorphism by X log , it
remains to determine the Yy â€™s, and the gluing morphisms. But Yy and its gluing morphisms
to (V log ) and (V log ) are completely speciï¬ed once one knows the divisor Yy in Xx Ã—XX F .
Moreover, it follows from the condition (3) of Deï¬nition 4.2, that this divisor is determined
by Î¦ and Î¨x . But we just saw that (Î¨x )Z/p2 Z is determined by Î¦Z/p2 Z . Thus, we conclude
2
that (Hx )Z/p2 Z and Ï†log
Z/p2 Z are completely determined by Î¦Z/p Z . Sorting through all the
deï¬nitions, we thus see that we have proven that CZ/p2 Z is entirely determined by the
p-adic quasiconformal equivalence class Î± and the deformation Î¦Z/p2 Z . Moreover, there is
nothing special about working modulo p2 : the same arguments can be made modulo an
arbitrary power of p. Thus, we see that we have proven the following result:
Lemma 4.13. Let C be an admissible compactiï¬ed Frobenius lifting on X log . Then CZ/pn Z
is completely determined by Î¦log
Z/pn Z .
This Lemma suggests the following deï¬nition:
Deï¬nition 4.14. Let Î± be a p-adic quasiconformal equivalence class to which X log
belongs. Let U âŠ† X be the ordinary locus for Î±. Let Î¦log : U log â†’ (U log )F be a Frobenius
lifting over U log . Then we shall say that Î¦log is an admissible Frobenius lifting for (X log , Î±)
if it arises from a (necessarily unique) admissible compactiï¬ed Frobenius C.
Thus, we can can regard admissible Frobenius liftings as being Frobenius liftings (over the
ordinary locus) that happen to have special behavior near the supersingular points.
148

Next let us consider two admissible Frobenius liftings Î¦log and (Î¦log ) on the same
curve X log . Let us suppose that they are equal modulo pn (where n â‰¥ 2). In this discussion,
we shall always be working modulo pn+1 , so (by abuse of notation) we shall use Î¦log and
(Î¦log ) to denote the respective reductions modulo pn+1 . Now just as in the discussion
preceding Proposition 4.3, for Î¦log , (Yy )Z/pn+1 Z is Spf of a local ring of the form:
def

R = (A/pn+1 A)[[Î¾, Î·]]/Ïˆ(Î¾, Î·)
where Î¾ is a local parameter for (Xx )Z/pn+1 Z , and Î· = Î¾ F is the Frobenius-conjugate local
parameter for (XxF )Z/pn+1 Z . Moreover, we may assume that
Ïˆ =f Â·g+Ï€
where
f = Î¾ p âˆ’ Î·;

2

g = Î· p âˆ’ Î¨x (Î¾ F )

and Ï€ âˆˆ p Â· (A/pn A)[[Î¾, Î·]]. In fact, Ï€ is actually p times a unit, since Yy is regular.
Similarly, for (Î¦log ) , we have
R = (A/pn+1 A)[[Î¾, Î·]]/Ïˆ  (Î¾, Î·)
def

with Ïˆ  = f Â· g  + Ï€  , and g  = Î· p âˆ’ Î¨x (Î¾ F ). Thus,
2

g â‰¡ g  (mod pn );

Ï€ â‰¡ Ï€  (mod pn )

So far we have been working with functions on (Yy )Z/pn+1 Z . Now let us restrict to
the open subscheme corresponding to the graph of Î¦ (or Î¦ ). Let us denote the restriction
morphism on functions by Î¶. Then we obtain, on this open subscheme, in the unprimed
case:
Î¶(Î·) = Î¶(Î¾)p + Î¶(Ï€) Â· Î¶(g)âˆ’1
and, in the primed case:
Î¶(Î·) = Î¶(Î¾)p + Î¶(Ï€  ) Â· Î¶(g  )âˆ’1
= Î¶(Î¾)p + Î¶(Ï€  ) Â· Î¶(g)âˆ’1
since the diï¬€erence between g and g  becomes zero when multiplied by p. Ultimately, we
are interested in computing the diï¬€erence between the two Frobenius liftings Î¦ and Î¦ .
149

That is, we wish to understand the diï¬€erence between where Î· is taken by the two liftings.
But by the above formulas, the diï¬€erence is of the form:
{Î¶(Ï€) âˆ’ Î¶(Ï€  )}(Î¶(g))âˆ’1
Moreover, because the diï¬€erence in brackets is divisible by pn , only the residue of g modulo
p is involved in the above expression. Since this residue has a zero of order exactly one at
x, it follows that the diï¬€erence between the two Frobenius liftings â€“ which forms a section
of TFp over X ord â€“ has poles of order at most one at the supersingular points. Since the
morphism
HTFp : TFp â†’ (Ï„X log /S log )Fp
(given by composing the p-curvature of (P, âˆ‡P ) with the projection given by the Hodge
ï¬ltration) has zeroes at the supersingular points, it thus follows that the diï¬€erence between
Î¦log and (Î¦log ) deï¬nes a global section of (Ï„X log /S log )Fp . Since we are dealing with hyperbolic curves, though, (Ï„X log /S log )Fp has negative degree, hence has no global sections.
Thus, Î¦log = (Î¦log ) . In summary, we have proven the following strengthened form of
Lemma 4.13:
Lemma 4.15. If there exists an admissible Frobenius lifting of (X log , Î±), then it is unique,
and contains no nontrivial deformations modulo any power of p.
Geometric Criterion for Canonicality
Let us ï¬x X log â†’ S log , a smooth r-pointed curve of genus g, and a p-adic quasiconformal equivalence class Î± to which X log belongs. Let Î¦log be an admissible Frobenius
lifting for (X log , Î±).
 log â†’ S log is also a smooth r-pointed curve of genus g such that
Now suppose that X
log
(X )Fp = XFp . The following â€œRigidity Lemmaâ€ is fundamental to this subsection:
 log

 log , Î±) admits an admissible Frobenius lifting (Î¦log ) . Then
Lemma 4.16. Suppose that (X
 log = X log .
X
Proof. We propose to prove inductively (on n) the following statement:
 log , (Î¦log ) ) coincides with (X log , Î¦log ) modulo pn+1 .
(*) (X
We know that this statement holds for n = 0. Assume that it holds for n âˆ’ 1. Consider
log
log
 log
the diï¬€erence between the deformations XZ/p
n+1 Z and XZ/pn+1 Z of XZ/pn Z . It deï¬nes a
class
150

Î¼ âˆˆ H 1 (XFp , (Ï„X log /S log )Fp )
Let C (respectively, C  ) be the compactiï¬ed Frobenius corresponding to Î¦log (respectively,
log
log 
)Z/pn Z , we can consider the diï¬€erence between the defor(Î¦log ) ). Since YZ/p
n Z = (Y
log
log
log 
mations YZ/p
)Z/pn+1 Z of YZ/p
n Z . This gives us a class
n+1 Z and (Y

Î½ âˆˆ Ext1YFp (Î©Y log /k , OYFp )
Fp

Since Ï†Z/pn Z = Ï†Z/pn Z , the pull-back map deï¬ned by either of these morphisms gives us

log
a map Ï†âˆ’1 : Ï†âˆ— (Ï‰X/S
)Fp â†’ Î©Y log /k , which is generically zero over the component of YFp
Fp

that we called Z  in the proof of Proposition 4.6. Now Ï†âˆ’1 induces a pull-back morphism
on global Extâ€™s
Ïˆ : Ext1YFp (Î©Y log /k , OYFp ) â†’ H 1 (YFp , Ï†âˆ— (Ï„X log /S log )Fp )
Fp

The condition that the morphism Ï†Z/pn+1 Z deform compatibly with the deformation of
 log , (Y  )log )Z/pn+1 Z to a morphism Ï† n+1 is exactly that
(X log , Y log )Z/pn+1 Z to (X
Z
Z/p
Ïˆ(Î½) = Î¼|YFp
Note that this condition, as well as the cohomology modules in which Î¼ and Î½ live,
log
log
are independent of n. Thus, by adding Î¼ and Î½ to Ï†log
Z/p2 Z : YZ/p2 Z â†’ XZ/p2 Z , we obtain
a new morphism Ï†log : Y log â†’ X log (of Z/p2 Z-ï¬‚at schemes). Then, by restricting Ï†log to
the open subscheme of Y log deï¬ned by the ordinary locus of Z  , we obtain a Frobenius
lifting Îlog on the ordinary locus of X log . The only points at which Î is not deï¬ned are
the supersingular points (determined by Î±). Moreover, by the calculation of the discussion
preceding Proposition 4.3, it follows that the local height of Îlog at a supersingular point
is â‰¤ 1. Indeed, in the notation of loc. cit., â€œÏ€â€ is equal to p times an element of k[[Î¾, Î·]],
which, this time, might not be a unit since Y log might not be the reduction modulo p2 of
a regular scheme; hence the inequality â‰¤ 1, rather than the sharp equality = 1. At any
rate, it thus follows that ht(Î) â‰¤ ht(Î¦Z/p2 Z ). But then, by Proposition 4.10, X log is equal
to some canonical curve reduced modulo p2 , and, by Proposition 2.6, (4), of Chapter II, it
log
thus follows that this canonical curve is the one determined by Î±. Thus, X log = XZ/p
2Z.
log
log
n+1

and X
coincide modulo p
. By Lemma 4.15
But this means that Î¼ = 0, so X
log
(the rigidity of an admissible Frobenius lifting), it thus follows that Î¦ and (Î¦log ) also
coincide modulo pn+1 . This proves the induction step, and hence the Lemma. 
Putting everything together, we see that we have proven the following geometric
criterion for a curve to be canonical:
151

Theorem 4.17. Let X log â†’ S log be a smooth r-pointed curve of genus g. Let Î± be a
p-adic quasiconformal equivalence to which X log belongs. Then X log is canonical if and
only if (X log , Î±) admits an admissible Frobenius lifting.
Proof. We saw in Â§3 that a canonical curve admits an admissible Frobenius lifting. On the
other hand, given an (X log , Î±) which admits an admissible Frobenius lifting, there exists
 log â‰¡ X log modulo p) which is canonical, hence admits an admissible
 log , Î±) (with X
an (X
 log . 
Frobenius lifting. Thus, by Lemma 4.16, it follows that X log = X
Deï¬nition 4.18. Suppose that (X log , Î±) admits an admissible Frobenius lifting Î¦log .
Then we shall call Î¦log the p-adic Greenâ€™s function.
Remark. The justiï¬cation for this terminology is as follows. In the classical complex case,
one of the main approaches to proving that hyperbolic curves can be uniformized by the
upper half plane is given by constructing a Greenâ€™s function on the universal covering
space of the Riemann surface (see, e.g., [FK]). Once one proves that the universal covering
space is just the upper half plane, then one sees that this Greenâ€™s function is really just
the logarithm of the hyperbolic distance between two points. On the other hand, the
canonical Frobenius lifting Î¦log may also be regarded as giving us a notion of distance
on X log . Indeed, in the classical modular case, where X log parametrizes elliptic curves, if
one can get from point a to point b by applying Î¦log a total of N times, then it means
that the corresponding elliptic curves are isogenous via a cyclic isogeny of order pN . Thus,
the analogy between Î¦log and the classical complex Greenâ€™s function (which is just the
logartihm of the hyperbolic distance) will be established once one accepts that isogeny
is the proper analogue of distance. But to see this, one need merely think of lattices in
Q2p , which one can draw schematically as a graph. Then two lattices are related by an
isogeny of order pN if and only if they are N edges apart on this graph. This establishes
the relationship between isogeny and distance.
Remark. We also observe that for elliptic curves (regarded parabolically), the same deï¬nition of compactiï¬ed Frobenius liftings, and admissible Frobenius liftings goes through,
but everything is trivial, since there are no supersingular points to contend with. Thus, we
(trivially) obtain the analogue of Theorem 4.17: that an elliptic curve over A with ordinary
reduction is canonical if and only if it admits a Frobenius lifting deï¬ned everywhere on the
curve.

152

Chapter V: Uniformizations of Ordinary Curves
Â§0. Introduction
Having studied the case of canonical curves in the previous Chapter, in this Chapter
we turn to the case of arbitrary curves with ordinary reduction modulo p. We do this by
working with the universal case: i.e., the universal curve over the moduli stack. Unlike
the canonical case, one does not quite obtain such objects as the canonical Galois representation or the canonical log p-divisible group over the given base. Instead, one must
pass to various â€œschemes of multiplicative periodsâ€ â€“ i.e., certain inï¬nite coverings of the
original base â€“ in order to obtain such objects. On the other hand, since these objects
are canonically associated to the curve over the given base, it is natural to guess that they
should descend from the scheme of multiplicative periods back down to the original base in
some appropriate sense. The key idea here is that, for instance in the case of the canonical
Galois representation (which is fundamental to the construction of all the other objects),
if one works with modules of rank two, not over Zp , but over some appropriate ring of
p-adic periods D Gal , then one can in fact construct a canonical Galois representation over
the original base. Thus, one obtains a representation of the entire arithmetic fundamental
Gal
group into GLÂ±
), which in some sense extends the representation of the geometric
2 (D
fundamental group into GLÂ±
2 (Zp ). Moreover, (in the hyperbolic case) this representation
Gal
) is canonical, and dual crystalline in
of the arithmetic fundamental group into GLÂ±
2 (D
some appropriate sense, despite the fact that (unlike the case handled in [Falt], Â§2), it is
on a space of inï¬nite rank over Zp . The process of passing from the canonical representation of the geometric fundamental group into GLÂ±
2 (Zp ) to the canonical representation of
Gal
the arithmetic fundamental group into GLÂ±
(D
) is a sort of crystalline analogue of the
2
notion of an induced representation in group theory. We therefore refer to this process as
the process of crystalline induction.
Once one has this canonical dual crystalline representation of the arithmetic fundaGal
mental group into GLÂ±
), one can linearize the obstruction to extending the repre2 (D
sentation of the geometric fundamental group into GLÂ±
2 (Zp ) to the full arithmetic fundamental group. This linearization tells one, for instance, that as soon as one can extend
the representation of the geometric fundamental group into GLÂ±
2 (Zp ) at all to the arithmetic fundamental group, this extension is automatically dual crystalline. This procedure
of linearizing the obstruction also allows one to see that this obstruction is precisely the
hyperbolic analogue of the obstruction to splitting a certain exact sequence of p-adic local
systems on the moduli stack of ordinary elliptic curves (in the parabolic case).
Â§1. Crystalline Induction
In Chapter III, we constructed a Frobenius-invariant indigenous bundle on the univerord
sal curve over N g,r . Unfortunately, unlike the case of a canonical curve, such information
153

does not immediately constitute an object of the category MF âˆ‡ (see [Falt], Â§2), so we
cannot immediately convert it into a Galois representation. The problem is that our connection on the indigenous bundle is only a relative connection (for the universal curve over
ord
N g,r ), not a full connection on the total space of the universal curve. Also, the obstruction
to extending it to a full connection on the total space of the universal curve is nonzero.
Thus, in order to obtain a Galois representation, we must replace the indigenous bundle
by a certain natural â€œthickeningâ€ of the indigenous bundle. This thickening formally carries the structure of an object of the category MF âˆ‡ , but has the disadvantage of being
of inï¬nite rank, so that we cannot immediately apply the theory of [Falt] to this object.
Fortunately, it is not diï¬ƒcult to extend the theory of [Falt] so as to handle such objects of
inï¬nite rank. We thus obtain a Galois representation, as desired, which turns out to be a
sort of crystalline analogue of the notion of an â€œinduced representationâ€ in group theory.
The Crystalline-Induced MF âˆ‡ -object
def

Let p be an odd prime. Let S be formally smooth over A = W (k), where k is a perfect
ï¬eld of characteristic p. Let us assume that S is endowed with a log structure induced by
a relative divisor with normal crossings over W (k). Let S log be the resulting log formal
scheme. Let f log : X log â†’ S log be an r-pointed stable curve of genus g. Also, let us assume
that the classifying morphism S â†’ Mg,r deï¬ned by f log is eÌtale. Let Î¦log : S log â†’ S log
be an ordinary Frobenius lifting.
Now let us suppose that our indigenous bundle (E, âˆ‡E ) on X log is invariant under the
renormalized Frobenius (Chapter III, Deï¬nition 1.4): that is,
Î¦E : (E, âˆ‡E ) âˆ¼
= Fâˆ—S log (E, âˆ‡E )Î¦
where the superscript â€œÎ¦â€ denotes pull-back by Î¦, and the subscript â€œS log â€ denotes that we
are considering the relative renormalized Frobenius pull-back over S log . (We shall denote
by Fâˆ—A the renormalized Frobenius pull-back over A.)
Let DS be the quasi-coherent OS -algebra (with the OS -action from the right) which is
obtained by taking the p-adic completion of the PD-envelope of the diagonal embedding of
S log in S log Ã—A S log (see, e.g., [Kato], Â§5.8). Thus, DS has an ideal IS âŠ† DS with DS /IS =
log
log
OS , and IS /IS2 âˆ¼
= Î©S/A = Î©S . Note that DS has a natural logarithmic connection
âˆ‡DS . We shall regard DS as a ï¬ltered object with connection, whose ï¬ltration is given by
[i]
F i (DS ) = IS (i.e., divided powers of IS ). Thus, the Kodaira-Spencer morphism for the
log
subquotient of the ï¬ltration given by F 1 (DS )/F 2 (DS ) = IS /IS2 âˆ¼
= Î©S is the identity map.
Note that the Frobenius lifting Î¦log on S log induces a morphism Î¦DS : Î¦âˆ— DS â†’ DS which
preserves the Hodge ï¬ltration. Finally, let us denote by ((DS )X , âˆ‡(DS )X ) the pull-back of
(DS , âˆ‡DS ) to X log .
Next, let us consider the obstruction to deï¬ning a full logarthmic connection âˆ‡ on E
(i.e., relative to X log â†’ Spec(A)) with the following properties:
154

(1) âˆ‡ has trivial determinant;
(2) the restriction of âˆ‡ to a relative connection (for X log â†’ S log ) is âˆ‡E ;
(i.e., the
(3) the curvature of âˆ‡ is an Ad(E)-valued section of âˆ§2 Î©log
S
log
log
Ï‰X/S âŠ—OS Î©S -part of the curvature vanishes).
It is easy to see that the obstruction class to deï¬ning such a connection is a section Î·E of
log
0
1
R1 fDR,âˆ— Ad(E) âŠ—OS Î©log
S = F (R fDR,âˆ— Ad(E) âŠ—OS Î©S )
log
and Î¦E
whose projection to R1 fâˆ— Ï„X log /S log âŠ—OS Î©log
S is the identity. Also, note that Î¦
log
1
induce a Frobenius action on R fDR,âˆ— Ad(E) âŠ—OS Î©S , which, by naturality, preserves Î·E .
Thus, in particular, we see that unless we modify E in some way, there is no hope of
constructing a full connection âˆ‡ as speciï¬ed above.
PD

Thus, we make the following construction. Let us write S log Ã— S log for Spf(DS )
(where we take â€œSpfâ€ with respect to the p-adic topology). Similarly, we shall write
PD

PD

PD

S log Ã— S log Ã— S log , X log Ã— X log , etc. for the obvious p-adic completions of PDPD

envelopes at the respective diagonals. Also, we have two projections Ï€R , Ï€L : S log Ã—
S log â†’ S log to the left and right by which we can pull-back X log â†’ S log to obtain curves
PD

PD

(X log )L â†’ S log Ã— S log , and (X log )R â†’ S log Ã— S log . Moreover, both of these curves
PD

form PD-thickenings of X log â†’ S log â†’ S log Ã— S log (where the second morphism is the
diagonal embedding). It thus follows that if we pull-back (E, âˆ‡E ) to obtain an indigenous
PD

bundle on the curve (X log )L â†’ S log Ã— S log , this indigenous bundle deï¬nes a crystal
PD

on Crys(X log /(S log Ã— S log )) which we can then evaluate on the thickening (X log )R to
obtain a rank two vector bundle E  (on X R ). If we then push this sheaf E  forward via the
projection X R â†’ X, we obtain a quasi-coherent sheaf ED on X. Moreover, ED has the
structure of a DS -module, hence of a (DS )X -module. In fact, ED is a locally free (DS )X module of rank two. Moreover, ED is equipped with a natural Hodge ï¬ltration compatible
with that of (DS )X .
Next, we would like to equip ED with a full logarithmic connection that is compatible
with its structure as a (DS )X -module and the connection on (DS )X . First, note that
PD

PD

PD

PD

X log Ã— S log Ã— S log â†’ S log Ã— S log Ã— S log is a PD-thickening of X log â†’ S log â†’
PD

PD

S log Ã— S log Ã— S log (where the second morphism is the diagonal embedding). Thus, if we
PD

PD

PD

pull-back (E, âˆ‡E ) to X log Ã— S log Ã— S log , we obtain a crystal E  on Crys(X log /(S log Ã—
PD

PD

PD

PD

PD

S log Ã— S log )). On the other hand, S log Ã— X log Ã— X log â†’ S log Ã— S log Ã— S log is also
PD

PD

a PD-thickening of X log â†’ S log â†’ S log Ã— S log Ã— S log . Thus, if we evaluate E  on
PD

PD

PD

PD

S log Ã— X log Ã— X log , and then push forward via the projection S log Ã— X log Ã— X log â†’
155

PD

PD

X log Ã— X log , we obtain a sheaf E  on X log Ã— X log . Now since (DS )X is equipped
PD

with a connection, the two pull-backs of (DS )X to X log Ã— X log via the two projections
PD

X
Ï€R
, Ï€LX : X log Ã— X log â†’ X log can be identiï¬ed; we denote the resulting sheaf of algebras
PD

on X log Ã— X log by (DS )

PD

X log Ã— X log

. Then E  is equipped with the structure of a locally free

-module of rank two. On the other hand, from the deï¬nition of ED , it follows
PD
X log Ã— X log
X âˆ—
that both (Ï€LX )âˆ— ED and (Ï€R
) ED are naturally isomorphic (as (DS )
-modules) to
PD
X log Ã— X log
PD
X âˆ—
E  , hence to each other. This isomorphism (Ï€LX )âˆ— ED âˆ¼
) ED on X log Ã— X log deï¬nes
= (Ï€R
a full logarithmic connection âˆ‡ED on ED (with respect to X log â†’ Spec(A)). Moreover,
(DS )

one checks easily that this connection is integral.
Finally, we have a Frobenius action
Î¦ED : Fâˆ—S log (ED âŠ—DS ,Î¦DS DS ) âˆ¼
= ED
Here, in the deï¬nition of Fâˆ—S log , we ï¬rst pull back the relevant crystal by means of relative
Frobenius, and then consider the subsheaf consisting of sections whose reduction modulo
p is contained in the subsheaf of
Î¦âˆ—XFp (ED âŠ—DS ,Î¦DS DS )Fp âˆ¼
= (Î¦âˆ—XFp EFp ) âŠ—OS DS
given by
(Î¦âˆ—XFp F 1 (E)Fp ) âŠ—OS DS âŠ† (Î¦âˆ—XFp EFp ) âŠ—OS DS
Theorem 1.1. Over X log , there exists a natural, locally free, rank two (DS )X -module ED
equipped with a Hodge ï¬ltration, a full integrable logarithmic connection âˆ‡ED (relative to
X log â†’ Spec(A)), and a Frobenius action
Î¦ED : Fâˆ—S log (ED âŠ—DS ,Î¦DS DS ) âˆ¼
= ED
such that ED âŠ—DS (DS /IS ) = E.
The Ring of Additive Periods
Before we can convert the induced object of Theorem 1.1 into a Galois representation,
we must ï¬rst study the Galois representation associated to DS , with its natural ï¬ltration,
connection, and Frobenius action. Once we have done this, since ED is of ï¬nite rank over
156

DS , converting ED into a Galois representation will be no more diï¬ƒcult than the â€œclassical
caseâ€ discussed in [Falt], Â§2.
Let us ï¬rst note that, just as when we constructed â€œcanonical aï¬ƒne coordinatesâ€ in
Chapter III, Â§1, by considering the slopes of the Frobenius action Î¦DS , we obtain a unique
Frobenius-equivariant embedding of OS -modules
Î©log
S â†’ IS
whose composite with the projection IS â†’ IS /IS2 = Î©log
S is the identity. It is here that
we use the divided powers of IS âŠ† DS . Let us write Geo(DS ) for the subbundle of DS
generated by Î©log
S and OS . Note that Geo(DS ) is stabilized by âˆ‡DS and by Frobenius.
Moreover, the Hodge ï¬ltration on DS induces a Hodge ï¬ltration on Geo(DS ). Observe
that with this extra data, Geo(DS ) becomes isomorphic to the uniformizing MF âˆ‡ -object
associated to Î¦log (of Deï¬nition 1.3 of Chapter III).
Now we want to pass to Galois representations. Let us assume that we have chosen
(once and for all) a base-point of S that avoids the divisors deï¬ning the log structure. In
the following, our fundamental groups will be with respect to this base-point. Since our
construction will be canonical, we can work eÌtale locally on S. Thus, we can assume that
S is aï¬ƒne. We may also assume that S log is small (in the sense of [Falt], Â§2): that is, S log
is log eÌtale over A[T1 , . . . , Td ] (with the log structure given by the divisor T1 Â· . . . Â· Td ). We
shall call these parameters T1 , . . . , Td small parameters. Then we would like to consider
the ring B + (S log ) of [Falt], Â§2. We will not review the deï¬nition of this ring here, since it
is rather involved, but roughly speaking, it is obtained by
log
(1) taking the normalization S of S log in the maximal covering of SK
which is eÌtale in characteristic zero;

(2) reducing S modulo p and taking its perfection;
(3) taking the Witt ring with coeï¬ƒcients in this perfection;
(4) adjoining the divided powers of a certain ideal to this Witt ring; and
(5) ï¬nally, completing with respect to a certain topology.
In particular,
(1) B + (S log ) is obtained as the inverse limit of a projective system of PDthickenings of the OSFp -algebra SFp ;
(2) B + (S log ) has an ideal I + âŠ† B + (S log ) which is Galois-invariant and

such that B + (S log )/I + âˆ¼
= Sâˆ§ (i.e., the p-adic completion of S).
157

Moreover, B + (S log ) comes equipped with a natural Frobenius action (which we shall denote
log
by means of a superscripted â€œF â€), as well as a continuous Ï€1 (SK
)-action, which commutes
+
log
with the Frobenius. The Frobenius invariants of B (S ) are given by Zp âŠ† B + (S log ).
There is a Galois equivariant injection Î² : Zp (1) â†’ B + (S log ). Frequently, we shall abuse
notation and write Î² âˆˆ B + (S log ) for the element of B + (S log ) obtained by applying Î² to
some generator of Zp (1). Then the Frobenius action on Î² takes Î² to p Â· Î². We will denote
by B(S log ) the ring obtained from B + (S log ) by inverting Î² and p. This completes our
review of B + (âˆ’).
Now let us return to the speciï¬c situation we have at hand. By thinking of (DS , âˆ‡DS )
as a crystal, and using the fact that B + (S log ) is an inverse limit of PD-thickenings of a
certain OSFp -algebra, one can evaluate this crystal on B + (S log ) (and complete p-adically)
to obtain a B + (S log )-module which we shall denote by
DS âŠ—OS B + (S log )
(where the â€œhatâ€ denotes p-adic completion). Alternatively, one can embed OS into
B + (S log ) by means of a choice of small parameters, and then take the literal tensor product, as described in [Falt], Â§2. In our situation, however, since we are given a Frobenius
lifting Î¦log , the most useful point of view will be to embed
OS â†’ B + (S log )
OS into B + (S log ) by means of the Frobenius lifting Î¦log . Indeed, the choice of Frobenius
lifting gives us an embedding of OS into the ring of Witt vectors that appears in the
construction (reviewed above) of B + (S log ). Then, we may regard the module considered
above as obtained via the literal tensor product with respect to this particular embedding
of OS into B + (S log ). At any rate, DS âŠ—OS B + (S log ) has a natural ï¬ltration and Frobenius
action. Let T log â†’ S log be the ï¬nite covering deï¬ned by Î¦log . (Thus, T log âˆ¼
= S log .) Then
log
DS âŠ—OS B + (S log ) also has a natural action by Ï€1 (TK ). The reason why we must restrict
log
), is that the way the Galois action is deï¬ned
to T log , rather than considering all of Ï€1 (SK
(see [Falt], Â§2) involves exponentiating the connection âˆ‡DS , so in order for the exponential
series to converge, one must be in a situation where the connection acts in a suï¬ƒciently
log
)
nilpotent fashion. For convenience, let us write Î T log (respectively, Î S log ) for Ï€1 (TK
log
(respectively, Ï€1 (SK )).
Let us recall the uniformizing Galois representation Pet (Deï¬nition 1.4 of Chapter
III) associated to the ordinary Frobenius lifting Î¦log . Recall that Pet ï¬ts into an exact
sequence of Î T log -modules
0 â†’ Î˜et
Î¦ (1) â†’ Pet â†’ Zp â†’ 0
The space of splittings of this sequence then forms an aï¬ƒne Zp -scheme, which is the
âˆ¨
âˆ¨
). More concretely, Aï¬€(Pet
) is a polynomial ring over Zp in
spectrum of some ring Aï¬€(Pet
158

3g âˆ’ 3 + r variables which is equipped with an action by Î T log . Moreover, the submodule
âˆ¨
âˆ¨
âˆ¨
â†’ Aï¬€(Pet
). We shall refer to Aï¬€(Pet
) as the
of polynomials of degree â‰¤ 1 is given by Pet
âˆ¨
aï¬ƒnization of Pet .
âˆ¨
âˆ¨
Note that Aï¬€(Pet
) has a natural Î T log -invariant augmentation Aï¬€(Pet
) â†’ Fp . Let
Gal
âˆ¨
DS be the p-adic completion of the PD-envelope of Aï¬€(Pet ) at this augmentation. Thus,
DSGal is equipped with a natural structure of Î T log -algebra, and, moreover, we have a

Î T log -invariant inclusion
âˆ¨
â†’ DSGal
Pet

In other words, DS may be identiï¬ed with the ring of additive periods (of Deï¬nition 1.5
of Chapter III). On the other hand, since Pet is the Galois representation contravariantly
associated to Geo(DS ), it follows that we have a morphism
Pet â†’ Geo(DS )âˆ¨ âŠ—OS B + (S log )
which respects the Hodge ï¬ltrations, Frobenius actions (where PÎ· is endowed with the
trivial Hodge ï¬ltration and Frobenius action), and Galois actions (by Î T log ). â€œSwitching
duals,â€ we thus see that we have a morphism
âˆ¨
Geo(DS ) â†’ Pet
âŠ—Zp B + (S log ) â†’ DSGal âŠ—Zp B + (S log )

which respects Hodge, Frobenius, and Galois. Next, since Geo(DS ) generates DS as a
â€œPD-polynomial algebraâ€ with no relations, it thus follows that we obtain a morphism
DS â†’ DSGal âŠ—Zp B + (S log )
which respects Hodge, Frobenius, and Galois. Finally, tensoring with B + (S log ), we obtain
the following result:
Proposition 1.2. We have a morphism
DS âŠ—OS B + (S log ) â†’ DSGal âŠ—Zp B + (S log )
which respects Hodge ï¬ltrations, Frobenius actions, and Galois actions (by Î T log ).
The Crystalline-Induced Galois Representation
Let U log âŠ† X log be a small aï¬ƒne open subset. Choose a Frobenius lifting Î¨log on
U log that is compatible with Î¦log on S log . Thus, Î¨log gives us an embedding of OU into
B + (U log ) which ï¬ts into a commutative diagram
159

OS
â
â

âˆ’â†’

B + (S log )
â
â

OU

âˆ’â†’

B + (U log )

We would like to consider
âˆ¨
âŠ—OU B + (U log )
GU = ED
def

where the â€œâˆ¨â€ denotes the dual as a DS -module. The problem is to show that GU has
enough Frobenius-invariant sections in the zeroth step of its ï¬ltration. The reason that we
cannot apply the theory of [Falt], Â§2 directly is that the relevant theorem (Theorem 2.4
of loc. cit.) assumes a bound on the number of steps in the ï¬ltration of the MF âˆ‡ -object
under consideration. On the other hand, ED has inï¬nitely many steps,
What we can do is base-change GU by the morphism of Proposition 1.2. We then
obtain a free (DSGal âŠ—Zp B + (U log ))-module
GU
of rank two. Moreover, GU is equipped with a Galois action, a Hodge ï¬ltration, and a
Frobenius action
Fâˆ— ((GU )F ) âˆ¼
= GU
(where the superscripted â€œF â€ denotes base-change by the Frobenius on B + (U log )).
Proposition 1.3. The submodule
(F 0 (GU ))F =1
(consisting of Frobenius-invariant elements of F 0 (GU )) forms a free DSGal -module EUGal of
rank two.
Proof. The proof is entirely the same as that of Theorem 2.4 of [Falt], Â§2. The point
of base-changing by the morphism of Proposition 1.2 is that this enables us to replace
âˆ¨
whose Hodge ï¬ltrations have inï¬nitely many steps by objects like GU
objects like ED
whose Hodge ï¬ltration has essentially only two steps. In fact, over T log , the relative
connection âˆ‡E on E actually extends to a full connection âˆ‡ modulo p, so (EFp , âˆ‡ ) deï¬nes
a Galois representation onto some Fp -vector space E  (âŠ† EFâˆ¨p âŠ— B + (U log )Fp ) of dimension
two. Moreover, GU has a ï¬ltration (deï¬ned by taking divided powers of the augmentation
160

ideal of DSGal â†’ Fp ) whose subquotients are tensor products of EFâˆ¨p âŠ— B + (U log )Fp with
symmetric powers of Î©et (âˆ’1)Fp . That is to say, we know that F 0 (âˆ’)F =1 for all of these
subquotients is as desired, so next we want to consider the issue of whether the various
extensions involved split over B + (U log ). But this issue is precisely that discussed in the
proof of Theorem 2.4 of [Falt], Â§2. Thus, we see that we have enough Frobenius invariants,
at least over the PD-completion of DSGal . But it is a simple exercise to see that the fact that
the original Frobenius action is deï¬ned over DSGal (i.e., not just over the PD-completion
of DSGal ) implies that the Frobenius invariants will also be deï¬ned over DSGal itself. This
completes the proof. 
def

Let XTlog = X log Ã—S log T log . Similarly, we have UTlog âŠ† XTlog . Now we have a natural
Ï€1 ((UTlog )K )-action on GU Since this action preserves the ï¬ltration and commutes with
Frobenius, we thus get an action of Ï€1 ((UTlog )K ) on EUGal , which is compatible with multiplication by elements of DSGal and the Î T log -action on DSGal . Moreover, as we vary the
open subset U âŠ† X, the resulting EUGal â€™s are clearly compatible. Thus, they glue together
to form a Ï€1 ((XTlog )K )-DSGal -module
Gal
EX

We state this as a Theorem:
Theorem 1.4. The crystalline-induced MF âˆ‡ -object
(ED ; F i (ED ); Î¦ED ; âˆ‡ED )
of Theorem 1.1 has associated to it an (up to Â±1) Ï€1 ((XTlog )K )-DSGal -module
Gal
EX
Gal
which is a free DSGal -module of rank two. We shall refer to EX
as the crystalline-induced
âˆ‡
Galois representation associated to the induced MF -object of Theorem 1.1.

Remark. Unlike the case of canonical curves, where one actually has a dual crystalline
representation (in the sense of [Falt], Â§2) into GLÂ±
2 (Zp ), in the case of noncanonical curves,
Gal
EX is as close a p-adic analogue as one can get to the canonical representation in the
complex case. In the following subsection, we shall make the phrase â€œas close as one can
getâ€ more precise.

161

Relation to the Canonical Aï¬ƒne Coordinates
log
Let Tâˆ
â†’ S log be the inverse limit of the coverings obtained by iterating Î¦log . Let
log
log
log
be the pull-back to Tâˆ
of X log â†’ S log . Let us choose base-points once and
XTâˆ â†’ Tâˆ

for all, and let

def

Î 1 = Ï€1 ((XTlog )K );

def

Î âˆ = Ï€1 ((XTlog
) )
âˆ K

Thus, Î âˆ âŠ† Î 1 is a closed subgroup. In the preceding subsection, we constructed a DSGal Gal
Î 1 -module which we called EX
. If we restrict our Galois representations from Î 1 to Î âˆ ,
then we obtain a Î âˆ -equivariant surjection
Ï€S : DSGal â†’ Zp
whose kernel is the augmentation ideal ISGal , i.e., the PD-ideal generated by Î©Gal
S . Thus, if
Gal
we base change EX
by Ï€S , we obtain a rank two Zp -module with a continuous Î âˆ -action
which we denote by:
def

Gal
âŠ—DGal ,Ï€S Zp
E0 = EX
S

Thus, in summary, E0 has the advantage that it is of rank two over Zp , but the disadvantage
Gal
that it only has a Î âˆ - (as opposed to a full Î 1 -) action, while EX
has the advantage
that is has a natural Î 1 -action, but the disadvantage that it is of rank two over the rather
large ring of additive periods DSGal . In this subsection, we show that the canonical aï¬ƒne
coordinates (of Chapter III, Theorem 3.6) measure precisely the degree to which the Î âˆ
action on E0 cannot be extended to a full action of Î 1 .
We begin with the following fundamental observation. Let Î” âŠ† Î âˆ âŠ† Î 1 be the
log
). Let
geometric fundamental group, i.e., the kernel of the natural morphism Î 1 â†’ Ï€1 (TK
us consider the exact sequence of Î âˆ -modules
Gal
âŠ—DGal DSGal /(ISGal )2 â†’ E0 â†’ 0
0 â†’ E0 âŠ—Zp ISGal /(ISGal )2 â†’ EX
S

By considering the underlying Î”-module structures, we obtain that the above exact sequence deï¬nes an extension class
Î· Gal âˆˆ H 1 (Î”, Ad(E0 )) âŠ—Zp ISGal /(ISGal )2 = H 1 (Î”, Ad(E0 )) âŠ—Zp Î©Gal
S
log
which is ï¬xed by the natural action of Ï€1 ((Tâˆ
)K ) on this cohomology group. On the
other hand, because our original indigenous bundle is ordinary, we see that we have a
log
)K )-equivariant inclusion
Ï€1 ((Tâˆ

162

âˆ¨
1
(Î©Gal
S ) â†’ H (Î”, Ad(E0 ))

Then we claim that Î· Gal is precisely the class in H 1 (Î”, Ad(E0 )) âŠ—Zp Î©Gal
that corresponds
S
to this inclusion. Indeed, this follows immediately from observing that Î· Gal is essentially
the Galois version of the class Î·E (the obstruction to the existence of a full connection on
E) that we encountered on our way to constructing ED . It then follows immediately from
the way one passes from MF âˆ‡ -objects to Galois representations that Î· Gal is the above
inclusion, as claimed. This observation concerning Î· Gal will be the fundamental â€œhard
factâ€ underlying what we do in this subsection; the rest will be general nonsense.
The general nonsense that we will use is the theory of [Schl]. Let us denote the
Î âˆ -module E0 âŠ—Zp Fp by (E0 )Fp . Note that since over T log , the obstruction to putting
a full connection on EFp vanishes, so we get a genuine MF âˆ‡ -object (whose underlying
vector bundle is (ED âŠ— DS /IS )Fp ) modulo p. Thus, the Î âˆ -action on (E0 )Fp extends to
a natural (dual crystalline) action of Î 1 on (E0 )Fp . We apply Schlessingerâ€™s theory to the
functor on artinian rings B with residue ï¬eld Fp that assigns to such a ring B the set of
isomorphism classes of continuous representations of Î” on a free B-module EB of rank
two such that (EB ) âŠ—B Fp = (E0 )Fp . Since H i (Î”, Ad((E0 )Fp )) is zero if i = 1, and of
dimension 6g âˆ’ 6 + 2r over Fp if i = 1, it follows easily from [Schl] that this functor is
prorepresented by a formal scheme R over Zp . Moreover, R is formally smooth over Zp ,
of relative dimension 6g âˆ’ 6 + 2r.
Now we claim that there is a natural continuous action of Ï€1 ((T log )K ) on R. Indeed,
let Î± âˆˆ Î 1 . Since Î” âŠ† Î 1 is a normal subgroup, for any representation of Î” on some EB
as above, we obtain a new representation by conjugating elements of Î” by Î±, and then
acting on EB in the original fashion. Since the original Î”-action on EB extends to a full
Î 1 -action on (EB ) âŠ—B Fp , it follows that this new representation is isomorphic to the old
after base change by B â†’ Fp . Thus, the new representation deï¬nes a new B-valued point
of R. This deï¬nes an action of Î 1 on R which is clearly trivial on Î” âŠ† Î 1 . Thus, we
obtain a natural action of Ï€1 ((T log )K ) on R.
Gal
Let us now turn to applying R to understanding the Î 1 -module EX
. Let DSGal be
Gal
the p-adic completion of DSGal . The underlying Î”-module structure on EX
deï¬nes a
classifying morphism

Îº : Spf(DSGal ) â†’ R
(This is O.K. despite the fact that DSGal âŠ—Zp Z/pN Z is not artinian, since Î” is topologically
ï¬nitely generated.) Let
Ïƒ0 : Spf(Zp ) â†’ R
be the composite of Spf(Ï€S ) with Îº. Let RPD be the p-adic completion of the PD-envelope
of R at Ïƒ0 . Let
163

ÎºPD : Spf(DSGal ) â†’ RPD
be the morphism induced by Îº. Then the morphism induced by ÎºPD on the Zariski tangent
spaces at Ïƒ0 is precisely the injection corresponding to the class Î· Gal considered above.
Thus, we have the following:
Lemma 1.5. The morphism ÎºPD is a closed immersion of formal schemes.
Gal
actually comes from
Now let us consider the fact that the Î”-module structure on EX
Gal
a Î 1 -module structure which is DS -semilinear (with respect to the Î 1 -action on DSGal
log
through Ï€1 (TK
)). If we translate this statement by means of the functorial interpretation
of R, we obtain the following:
log
log
)-equivariant with respect to the natural Ï€1 (TK
)Lemma 1.6. The morphism Îº is Ï€1 (TK
Gal
actions on DS and R.
log
Now let Ï† : Î“ â†’ Ï€1 (TK
) be a continuous homomorphism of topological groups. Let

1 â†’ Î” â†’ Î Î“ â†’ Î“ â†’ 1
be the pull-back of the group extension
log
1 â†’ Î” â†’ Î 1 â†’ Ï€1 (TK
)â†’1

by means of Ï†. Then one can consider the issue of whether or not the Î”-action on E0
extends to a continuous, Zp -linear action of Î Î“ on E0 . Note that since H 0 (Î”, Ad(E0 )) = 0,
as long as we require that the associated determinant representation of Î Î“ is the cyclotomic
character, such an extension will always be unique (up to Â±1). On the other hand, by the
same reasoning as that used in Lemma 1.6, the Î”-action on E0 will extend to a Î Î“ -action
on E0 if and only if the Zp -valued point Ïƒ0 of R is ï¬xed by Î“ (acting through Ï†). Moreover,
by the preceding two lemmas, we see that Ïƒ0 is ï¬xed by Î“ if and only if the Zp -valued point
of DSGal deï¬ned by Ï€S is stabilized by Î“. But this, in turn, is equivalent to the statement
that the restriction of the canonical extension class Î·Î¦ (discussed just before Deï¬nition 1.5
of Chapter III) becomes trivial when restricted to Î“.
Now let us suppose that (B, mB ) is a local ring with residue ï¬eld k which is p-adically
complete, Zp -ï¬‚at, and has a topologically nilpotent PD-structure on mB . (Note that for
such a ring B, log : (1+mB ) â†’ mB and exp : mB â†’ (1+mB ) deï¬ne inverse isomorphisms.)
Let Î“ = Ï€1 (Spf(B)K ). Suppose further that
Ïˆ : Spf(B) â†’ S
164

is a morphism whose image avoids the divisor deï¬ning the log structure on S log . Then for
log
) which is
some closed subgroup Î“ âŠ† Î“ of ï¬nite index, we have a morphism Ï† : Î“ â†’ Ï€1 (TK
compatible with the morphism induced on fundamental groups by Ïˆ. Recall from Chapter
III, Theorem 3.8, the canonical aï¬ƒne coordinates corresponding to Ïˆ. These coordinates
are valued in B (or, more precisely, in mB ). Moreover, they are zero if and only if the
class Î·Î¦ becomes zero when restricted to Î“ . It is easy to see that Î·Î¦ |Î“ = 0 if and only
if Î·Î¦ |Î“ = 0. Also, we know from Chapter III that Ïˆ corresponds to a canonical curve if
and only if the canonical aï¬ƒne coordinates are zero. Thus, putting everything together,
we obtain the following result:
Theorem 1.7. The morphism Ïˆ corresponds to a canonical curve if and only if the
Î”-action on E0 extends to a Zp -linear, continuous action of Î Î“ on E0 .
More generally, but less precisely, we see that:
(*) The canonical aï¬ƒne coordinates in mB associated to Ïˆ are a measure of the obstruction to extending the Î”-action on E0 to a Zp -linear,
continuous action of Î Î“ on E0 .
Since the class Î·Î¦ is â€œas nonzero as it can beâ€ on S log , we thus see that we have justiï¬ed
Gal
the statement made at the end of the preceding subsection that the Î 1 -module EX
is â€œas
close as one can getâ€ to extending the Î”-action on E0 to a full Î 1 -action.
Remark. In some sense, we can describe what we have done in this subsection as follows.
Consider the obstruction to extending the Î”-action on E0 to an action of Î Î“ . A priori,
this obstruction is highly nonlinear and diï¬ƒcult to get oneâ€™s hands on explicitly. Note that
this nonlinearity exists despite the fact that we already have a Î âˆ -action on E0 , and the
discrepancy between Î 1 and Î âˆ is â€œessentiallyâ€ a linear Zp -space of rank 3gâˆ’3+r. Rather,
the nonlinearity arises fundamentally from the fact that we are considering representations
into GLÂ±
2 , which is not an abelian (or even solvable) group. In particular, the moduli space
R of representations of Î” into GLÂ±
2 has no natural linear structure. Thus, the point of
Gal
Gal
constructing EX and reinterpreting the existence of EX
in terms of R, as we have done
in this subsection, was to linearize this obstruction by means of the uniformization of (the
relevant part of) RPD by means ÎºPD .
Remark. For the reader interested in pursuing analogies with the complex case, we also
make the following observation. Since R is the local moduli space of deformations of the
canonical representation Î” â†’ GLÂ±
2 (Zp ) of the geometric fundamental group, it is natural
to regard R as a sort of local p-adic analogue of the space RC of isomorphism classes of
representations of the geometric fundamental group into PSL2 (C) in the complex case.
Thus, RC has complex dimension 6g âˆ’ 6 + 2r. Inside RC , one has Fricke space RR ,
with real dimension 6r âˆ’ 6 + 2r, corresponding to the representations into PSL2 (R). In a
neighborhood of the canonical representation of a curve, RR maps diï¬€eomorphically onto
165

Mg,r . Thus, one can regard the subspace Spf(DSGal ) â†’ RPD as analogous to Fricke space
RR âŠ† RC in the complex case.
The Parabolic Case
Before proceeding, we pause to take a brief look at what happens for elliptic curves
(regarded parabolically). Although there are many similarities between the parabolic and
hyperbolic cases, there are also certain diï¬€erences. This is not so surprising if one considers
the canonical representations arising from uniformizations in the complex case. Indeed,
in the complex context, for hyperbolic curves, the canonical representation of the fundamental group into PSL2 (R) is completely well-deï¬ned up to conjugation by an element of
PSL2 (R), while for elliptic curves, the morphism (induced by deck transformations on the
uniformization by C) gives a representation of the fundamental group into the group of
translations Ga (C) of the complex plane, but this representation is not well-deï¬ned up to
conjugation by an element of Ga (C). Rather, there is an ambiguity of multiplication by a
complex number.
On the other hand, this same phenomenon of â€œlack of rigidityâ€ ultimately is a consequence of the overall linearity of the situation, which has positive aspects, as well. For
instance, one can carry out the construction of the induced MF âˆ‡ -object (Theorem 1.1) for
elliptic curves just as in the hyperbolic case. However, precisely because the obstruction
to deï¬ning an MF âˆ‡ -object is entirely linear from the outset, this approach is a sort of
overkill. Thus, in the following we propose to examine the obstruction to deï¬ning a â€œfullâ€
MF âˆ‡ -object (i.e., the same obstruction as the one we examined in the hyperbolic case)
directly, at the level of Galois representations, without resorting to the tool of crystalline
induction.
Thus, let us assume that f log : X log â†’ S log is an ordinary zero pointed curve of
genus one such that the classifying morphism S â†’ M1,0 is eÌtale. Since the canonical
representation should be an extension of a rank one eÌtale representation by its dual Tate
log
log
twisted once, we consider the local system R1 (fK
)et,âˆ— Zp (1) on SK
. Let us denote the
def

log
)-module corresponding to this local system by H 1 . Then there exists a
Î S = Ï€1 (SK
rank one Î S -submodule E(1) âŠ† H 1 such that the action of Î S on E is unramiï¬ed, and
we have an exact sequence:

0 â†’ E(1) â†’ H 1 â†’ E âˆ¨ â†’ 0
Suppose that E  is an eÌtale Î S -module such that (E  )âŠ—2 = E âˆ¨ . Then, the canonical
representation of the universal elliptic curve should be an extension of E  by (E  )âˆ¨ (1). If
we tensor the above exact sequence by E, we get an exact sequence of Î S -modules
0 â†’ E âŠ—2 (1) â†’ H 1 âŠ— E â†’ Zp â†’ 0
Thus, the obstruction to the existence of such a canonical representation is precisely the
obstruction to lifting 1 âˆˆ Zp in the above exact sequence. This obstruction class lies in
166

H 1 (Î S , E âŠ—2 (1))
and coincides with the class Î·Î¦ deï¬ned by the canonical Frobenius lifting Î¦log on S log . That
is to say, we end up with essentially the same conclusion as in the hyperbolic case: Namely,
that the obstruction to the existence of a â€œcanonical representationâ€ for the universal
log
)) is given precisely by the class Î·Î¦ deï¬ned
ordinary elliptic curve (deï¬ned on all of Ï€1 (XK
by the canonical Frobenius lifting.
Â§2. Canonical Objects Over the Stack of Multiplicative Periods
In this Section, we note that by working over the stack of multiplicative periods, we
can construct all the objects that we are familiar with from the case of canonical curves.
The Stack of Multiplicative Periods
ord

Let S log = (N g,r )log . Let Î¦log be the canonical Frobenius lifting on S log (as in Chapter
III, Theorem 2.8). If, for some N â‰¥ 1, we take the N th iterate of Î¦log , we get a ï¬nite, ï¬‚at
covering
(Î¦log )N : S log â†’ S log
of S log . Let P log be the inductive limit of these coverings (as N goes to inï¬nity). Let P log
be the p-adic completion of P log .
Deï¬nition 2.1. We shall call P log (respectively, P log ) the universal (respectively, complete) stack of multiplicative periods.
Unlike the rings of additive periods considered earlier, which, roughly speaking, are generated by adjoining the logarithms of the multiplicative parameters to Zp , the structure
sheaf of the stack of multiplicative periods is obtained essentially by adjoining all p-power
roots of the multiplicative parameters to the structure sheaf of the original base scheme
(or stack).
More generally, let T log be a formal log scheme, whose underlying scheme T is padically complete and ï¬‚at over Zp . Let hlog : Y log â†’ T log be an r-pointed stable curve
of genus g that arises from some classifying morphism T log â†’ S log . Then if we pull back
the morphism P log â†’ S log via the classifying morphism T log â†’ S log for hlog , we obtain
an object
PTlog â†’ T log
167

over T log . Let PTlog be the p-adic completion of PTlog . We shall always assume that:
log
(*) The log structure of TQ
is trivial over an open dense set.
p

For instance, typically T log will be the normalization of Zp in a ï¬nite ï¬eld extension of Qp
with a log structure that is trivial in characteristic zero.
Deï¬nition 2.2. We shall call PTlog (respectively, PTlog ) the (respectively, completed) formal
scheme of multiplicative periods associated to the curve hlog : Y log â†’ T log .
Note that PTlog depends on the choice of classifying morphism T log â†’ S log for the curve
log

that lifts the morphism T log â†’ Mg,r deï¬ned by the curve itself. That is, PTlog depends on
a choice of quasiconformal equivalence class for hlog : Y log â†’ T log .
Remark. Often in what follows we shall work in the universal case, that is, over S log , and
thus obtain objects over P log (or P log ). However, one should always remember that the
objects constructed deï¬ne (by restriction) objects over PTlog (or PTlog ) for any r-pointed
stable curve of genus g over T log satisfying the hypotheses just stated.
The Canonical Log p-divisible Group
ord log
Let S log = (Ng,r
) : that is, the locus of smooth ordinary curves (with a choice of
quasiconformal equivalence class). Thus, the log structure on S log is trivial. Let f log :
X log â†’ S log be the universal curve. Let f log [N ] : X log [N ] â†’ S log be the pull-back of
f log by the N th iterate of the canonical Frobenius. Thus, if we pull (E, âˆ‡E ) back to
X log [N ] and reduce modulo pN , the obstruction to deï¬ning a full connection (relative
to X log [N ] â†’ Spec(A)) vanishes, and so, we obtain an MF âˆ‡ -object, which we shall
call E[N ]. Alternatively, this MF âˆ‡ -object can be obtained taking the MF âˆ‡ -object in
Theorem 1.1, pulling back to X log [N ], reducing modulo pN , and then reducing modulo
ISN . By [Falt], Theorem 7.1, away from the divisor at inï¬nity, and the method of Chapter
IV, Â§2 (following [Kato2]) at the divisor at inï¬nity, E[N ] deï¬nes a ï¬nite, ï¬‚at log group
object G[N ] on X log [N ]. Let P log â†’ S log be the stack of multiplicative periods. Let
f log [âˆ] : X log [âˆ] â†’ P log be the pull-back of f log to P log . Then by restricting from
X log [N ] to X log [âˆ] and then taking the inductive limit, we obtain an (up to Â±1) log
p-divisible group

G[âˆ] = lim G[N ]|X log [âˆ]
âˆ’â†’

on X log [âˆ].
Deï¬nition 2.3. We shall call G[âˆ] the canonical log p-divisible group on X log [âˆ].
168

If we invert p, and pass to p-adic Tate modules, then we obtain an eÌtale local system of
Zp âŠ• Zp â€™s (up to Â±1) on X log [âˆ]Qp . Now in the notation of Â§1, we have
Î âˆ = Ï€1 (X log [âˆ]Qp )
Thus, the p-adic Tate module of G[âˆ]Qp is given by the representation of Î âˆ on E0 which
was discussed in Â§1. Let us denote this representation by
Ïâˆ : Î âˆ â†’ GLÂ± (E0 )
Deï¬nition 2.4. We shall call Ïâˆ the canonical Galois representation of Î âˆ .
ord
Remark. If T is any p-adically complete formal scheme which is Zp -ï¬‚at, and Ï† : T â†’ Ng,r
is a morphism, then even though the canonical log p-divisible group and the canonical
Galois representation are not deï¬ned until one goes up to the scheme of multiplicative
ord
periods, one can nonetheless pull-back the canonical indigenous bundle (E, âˆ‡E )N on Ng,r
to obtain an indigenous bundle (E, âˆ‡E )T on XTlog â†’ T . This indigenous bundle is deï¬ned
over T , i.e., one neednâ€™t pass to the scheme of multiplicative periods.

Deï¬nition 2.5. We shall call (E, âˆ‡E )T the canonical indigenous bundle on XTlog .
One should always remember that one only obtains the canonical indigenous bundle after
ord
(i.e., a quasiconformal equivalence class) of the classifying
choosing a lifting Ï† : T â†’ Ng,r
morphism T â†’ Mg,r of the curve.
The Canonical Frobenius Lifting
We continue with the notation of the preceding subsection. It follows from Chapter
IV, Proposition 3.2, that the supersingular divisor D âŠ† XFp (where f log : X log â†’ S log
is the universal curve) is eÌtale over SFp . We shall denote its complement in X, the
ordinary locus of X log , by X ord . Now it is immediate that the construction of the canonical
Frobenius lifting over the ordinary locus (preceding Theorem 1.6 of Chapter IV) carries
over immediately to the present case (where the base is S, as opposed to the ring of Witt
vectors with coeï¬ƒcients in a perfect ï¬eld). Thus, if we denote base-change by Î¦log (the
canonical Frobenius) by means of a superscript â€œF ,â€ we obtain the universal analogue of
Theorem 1.6 of Chapter IV:
Theorem 2.6. There exists a unique ordinary Frobenius lifting (called canonical)
log ord
) â†’ ((X log )ord )F
Î¦log
X : (X

169

over the ordinary locus such that we get a horizontal morphism Î¦âˆ—X E F â†’ E which preserves
the Hodge ï¬ltration.
Now let T be any p-adically complete formal scheme which is Zp -ï¬‚at, and let Ï† : T â†’
ord
Ng,r be a morphism. Let XTlog â†’ T be the pull-back of the universal curve by Ï†. Write
XTlog
F for the pull-back of the universal curve by Î¦ â—¦ Ï†. Then by restricting the morphism
log
Î¦X of Theorem 2.7, we obtain a T -morphism
log ord
)T â†’ (X log )ord
Î¦log
TF
XT : (X

Thus, in the spirit of Deï¬nition 4.18 of Chapter IV, we make the following:
log
Deï¬nition 2.7. We shall call XTlog
F the Frobenius conjugate curve to XT . We shall call
log
Î¦log
XT the p-adic Greenâ€™s function of the curve XT â†’ T .

Next, we consider compactiï¬cations of this canonical Frobenius lifting. Let D[âˆ] âŠ†
X[âˆ]Fp be the result of base-changing to P . Let D[âˆ] âŠ† X[âˆ] be the respective p-adic
completions. Let XD [âˆ] be the completion of X[âˆ] at D[âˆ]. Then just as in Â§3 of
Chapter IV, by looking at the universal deformation spaces of the canonical log p-divisible
group and its double Frobenius conjugate, we obtain an isomorphism
Î¨ : XDF 2 [âˆ] âˆ¼
= XD [âˆ]
Let Y [âˆ] â†’ X[âˆ] be the ï¬nite, ï¬‚at covering (of degree p + 1) parametrizing cyclic
subgroups (in the Drinfeldian sense) of the canonical log p-divisible group. Then, just as
before, there exists a divisor E âŠ† Y [âˆ]Fp that maps isomorphically onto D[âˆ]Fp . Let
YE [âˆ] be the completion of Y [âˆ] at E. Then we obtain an embedding
(DE , RE ) : YE [âˆ] â†’ XD [âˆ] Ã—P XDF 2 [âˆ]
The image of this embedding is a divisor, which, when restricted to the ordinary locus,
is equal to the union of the graph of the canonical Frobenius on (X log )ord with its â€œÎ¨transpose,â€ as in Chapter IV, Â§3 (see the discussion preceding Deï¬nition 3.3).
Deï¬nition 2.8. We shall call Y [âˆ] â†’ X[âˆ], together with Î¨ and (DE , RE ) the compactiï¬cation of the canonical Frobenius lifting Î¦log
X .
Thus, although the canonical Frobenius lifting Î¦log
X is deï¬ned over S (without passing to
the stack of multiplicative periods), the compactiï¬cation is only deï¬ned over the completed
stack of multiplicative periods.
170

Bibliography
[Abikoï¬€] W. Abikoï¬€, The Real Analytic Theory of TeichmuÌˆller Space, Lecture Notes in Mathematics 820,
Springer, 1980.
[AC] E. Arbarello and M. Cornalba, The Picard Groups of the Moduli Space of Curves, Topology 26, No. 2
(1987), 153-171.
[BBM] P. Berthelot, L. Breen, and W. Messing, TheÌorie de DieudonneÌ cristalline II, Lecture Notes in Mathematics 930, Springer, 1982.
[Bers] L. Bers, Uniformization by Beltrami Equations, Comm. Pure Appl. Math. 14 (1961), 215-228.
[BK] S. Bloch and K. Kato, L-Functions and Tamagawa Numbers in The Grothendieck Festschrift I, BirkhaÌˆuser
(1990), 333-400.
[EGA IV] A. Grothendieck and J. DieudonneÌ, EÌleÌments de GeÌometrie AlgeÌbrique IV, Publ. Math. IHES 32 (1967).
[Falt] G. Faltings, Crystalline Cohomology and p-adic Galois Representations, JAMI Conference, Johns Hopkins Univ. Press (1990), 25-79.
[Falt2] G. Faltings, Real Projective Structures on Riemann Surfaces, Compositio Mathematica 48, Fasc. 2
(1983), 223-269.
[Falt3] G. Faltings, Stable G-Bundles and Projective Connections, Journal of Algebraic Geometry 2, No. 3
(1993), 507-568.
[FK] H. Farkas and I. Kra, Riemann Surfaces, Graduate Texts in Mathematics 71, Springer, 1980.
[Gard] F. Gardiner, TeichmuÌˆller Theory and Quadratic Diï¬€erentials, John Wiley and Sons, 1987.
[Gunning] R. C. Gunning, Special Coordinate Coverings of Riemann Surfaces, Math. Annalen 170 (1967), 67-86.
[Harts] R. Hartshorne, Residues and Duality, Lecture Notes in Mathematics 20, Springer, 1966.
[HM] J. Harris and D. Mumford, On the Kodaira Dimension of the Moduli Space of Curves, Inv. Math. 67
(1982), 23-86.
[Ih] Y. Ihara, Schwarzian Equations, Jour. Fac. Sci. Univ. Tokyo, Sect IA Math. 21 (1974), 97-118.
[Ih2] Y. Ihara, On the Diï¬€erentials Associated to Congruence Relations and the Schwarzian Equations Deï¬ning Uniformizations, Jour. Fac. Sci. Univ. Tokyo, Sect. IA Math. 21 (1974), 309-332.
[Ih3] Y. Ihara, On the Frobenius Correspondences of Algebraic Curves, in Algebraic Number Theory, papers
contributed for the International Symposium, Kyoto, 1976, Japan Soc. Prom. Sci., Tokyo, 1977.
[Ih4] Y. Ihara, Lifting Curves over Finite Fields Together with the Characteristic Correspondence Î  + Î  ,
Jour. of Algebra 75, No. 2 (1982), 452-483.
[Jac] N. Jacobson, Lie Algebras, Interscience Tracts 10, John Wiley and Sons, 1962.
[Kato] K. Kato, Logarithmic Structures of Fontaine-Illusie, Proceedings of the First JAMI Conference, JohnsHopkins University Press (1990), pp. 191-224.
[Kato2] K. Kato, Logarithmic Degeneration and DieudonneÌ Theory, preprint.
[Katz] N. Katz, Nilpotent Connections and the Monodromy Theorem: Applications of a Result of Turritin,
Publ. Math. IHES 39 (1970), 355-412.
[Katz2] N. Katz, Algebraic Solutions of Diï¬€erential Equations, Inv. Math. 18 (1972), 1-118.
[KM] N. Katz and B. Mazur, Arithmetic Moduli of Elliptic Curves, Annals of Mathematics Studies 108,
Princeton University Press, 1985.
171

[Lang] S. Lang, Introduction to Modular Forms, Grundlehren der mathematischen Wissenschaften 222, Springer,
1976.
[Lehto] O. Lehto, Univalent Functions and TeichmuÌˆller Spaces, Graduate Texts in Mathematics 109, Springer,
1987.
[Lehto2] O. Lehto, Quasiconformal Homeomorphisms and Beltrami Equations, in Discrete Groups and Automorphic Functions, ed. W. J. Harvey, Academic Press (1977), 121-142.
[Marg] G. A. Margulis, Discrete Subgroups of Semisimple Lie Groups, Ergebnisse der Mathematik und ihrer
Grenzgebiete 17, Springer, 1990.
[McM] C. McMullen, Rational Maps and Kleinian Groups, Proc. International Congress of Mathematicians II,
Kyoto (1990), 889-899.
[Mess] W. Messing, The Crystals Associated to Barsotti-Tate Groups; with Applications to Abelian Schemes,
Lecture Notes in Mathematics 264, Springer, 1972.
[Mzk] S. Mochizuki, The Geometry of the Compactiï¬cation of the Hurwitz Scheme, Publ. of RIMS 31, No. 3
(1995), 355-441.
[Ogus] A. Ogus, F-Crystals, Griï¬ƒths Transversality, and the Hodge Decomposition, AsteÌrisque 221, Soc. Math.
de France, 1994.
[Royd] H. L. Royden, Intrinsic Metrics on TeichmuÌˆller Space, Proc. International Congress of Mathematicians
2, Vancouver (1974), 217-221.
[Schl] M. Schlessinger, Functors of Artin Rings, Trans. Amer. Math. Soc. 130 (1968), 208-222.
[Sesh] C. S. Seshadri, FibreÌs vectoriels sur les courbes algeÌbriques, AsteÌrisque 96, Soc. Math. de France, 1982.
[SGA 1] A. Grothendieck et al., ReveÌ‚tements eÌtales et groupe fondamental, Lecture Notes in Mathematics 224,
Springer, 1971.
[Shi] G. Shimura, Introduction to the Arithmetic Theory of Automorphic Forms, Publ. Math. Soc. of Japan
11, Iwanami Shoten and Princeton University Press, 1971.
[Tate] J. Tate, p-divisible Groups, Proceedings of a Conference on Local Fields, NUFFIC Summer School held
at Driebergen in 1966, Springer, 1967.
[Wolp] S. Wolpert, The Fenchel-Nielsen Deformation, Ann. Math. 115 (1982), 501-528.
[ZT] P. G. Zograf and L. A. Takhtadzhyan, On Uniformization of Riemann Surfaces and the Weil-Petersson
Metric on TeichmuÌˆller and Schottky Spaces, Math. USSR Sbornik 60, No. 2 (1988), 297-313.

172

Index

Terminology

Note: The data following each term indicate the chapter and section where the term ï¬rst
appears.
admissible compactiï¬ed Frobenius lifting
admissible Frobenius lifting
admissible indigenous bundle
associated Schwarz structure

IV.4
IV.4
II.2
I.1

Beltrami diï¬€erential
Beltrami equation
Bers embedding
bianalytic constant
function
uniformizer
biformal function

Intro.1
Intro.1
Intro.1
I.1
I.1
I.1
I.1

canonical aï¬ƒne parameter
canonical bilinear form
canonical class
canonical (crystalline) Galois representation
canonical curve
canonical Frobenius lifting (modular)
canonical Frobenius lifting (on a curve)
canonical Galois extension class
canonical height
canonical indigenous bundle
canonical lifting (point)
canonical local Hecke correspondence, nth
canonical local systems
canonical log p-divisible group
canonical multiplicative parameter

III.1
II.3,
III.3
III.3
IV.1,
V.2
III.3
III.2
IV.1,
V.2
III.1
I.2
Intro.2, V.2
III.1
IV.3
III.1, III.3
IV.2,
V.2
III.1, III.3

173

canonical p-divisible group
canonical pseudo-Hecke correspondence, nth
canonical representation (complex case)
canonical uniformization
compactiï¬cation of a Frobenius lifting
compactiï¬cation of the canonical Frobenius lifting
crystalline-induced Galois representation
crystalline induction
crystalline Schwarz structure
with nilpotent monodromy

III.1
IV.3
Intro.1, Intro.2
III.3
IV.4
V.2
V.1
V.0
I.1
I.1

diï¬€erential local system
dilatation
divisor of marked points

III.1, III.3
Intro.1
I.1

elliptic Riemann surface

Intro.1

Fenchel-Nielsen coordinates
ï¬nite type (Riemann surface of)
F L-bundle
Frobenius conjugate curve
Frobenius lifting
Frobenius on R1 fâˆ— Ï„X log /S log

Intro.1
Intro.1
II.1
V.2
III.1
II.2

generic uniformization number
global nth canonical Hecke correspondence
Greenâ€™s function (complex case)
Greenâ€™s function, p-adic

II.3
IV.3
Intro.1
IV.4,
V.2

Hasse invariant
Hecke operators
Hecke type
height of a Frobenius lifting
Hilbert transformation

II.2,
II.3
IV.3
IV.3
IV.4
Intro.1
174

Hodge section
hyperbolic metric
hyperbolic Riemann surface
hyperbolic volume

I.2
Intro.1
Intro.1
Intro.1

Igusa curve
indigenous bundle
of restrictable type
indigenous section
induced MF âˆ‡ -object
inï¬nitesimal Verschiebung
intrinsic bundle

II.3
Intro.2,
I.2
III.2
V.1
II.2
I.2

Jacobsonâ€™s formula

II.2

KaÌˆhler metrics and Frobenius liftings
Kodaira-Spencer morphism

Intro.2
I.1,
I.2

local compactiï¬cation of a Frobenius lifting
local height of a Frobenius lifting
locally intrinsic bundle
locally stable of dimension one
log admissible covering
log p-divisible group

IV.4
IV.4
I.2
I.1
III.2
IV.2

marked
MF âˆ‡ -object

I.1
II.2

naive compactiï¬cation of a Frobenius lifting
nilpotent indigenous bundle
normalized P1 -bundle with connection

IV.4
II.2
I.1

175

I.2

ordinary curve, hyperbolically
parabolically
ordinary Frobenius lifting
ordinary indigenous bundle
ordinary locus

II.3
II.3
III.1
II.3
IV.1

p-curvature
parabolic Riemann surface
parabolic structure
parabolic volume element
partition curves
pre-Schwarz structure
pseudo-uniformizer

II.1
Intro.1
I.1
Intro.1
Intro.1
I.1
I.1

quasiconformal equivalence class, p-adic
quasiconformal function
quasidisk

III.3
Intro.1
Intro.1

real Riemann surface
renormalized Frobenius pull-back
ring of additive periods

Intro.1
III.2
III.1

scheme of multiplicative periods
Schwarz structure
Schwarzian derivative
Serre-Tate parameter
singular
small aï¬ƒne
small parameters
smooth and unmarked
stable curve
stack of multiplicative periods
supersingular divisor

V.2
I.1
I.1
IV.1
I.1
V.1
V.1
I.1
I.2
V.2
II.2

176

tangential local system
TeichmuÌˆller metric
TeichmuÌˆller uniformization
topological marking, p-adic
totally degenerate curve
trianalytic constant
function
triformal function

III.1, III.3
Intro.1
Intro.1
III.3
I.3
I.1
I.1
I.1

uniformizing Galois representation
uniformizing MF âˆ‡ -object

III.1
III.1

Verschiebung of an indigenous bundle
log âŠ—2
) (âˆ’D)
on fâˆ— (Ï‰X/S
morphism

II.2
II.2
II.2

Weil-Petersson inner product
Weil-Petersson metric
Wolpertâ€™s coordinates of degeneration

Intro.1
Intro.1
Intro.1

Major Notation

AÎ¦
B
BÎ¼
B + (âˆ’)
C

III.1
Intro.1, II.3
III.3
V.1
I.2, IV.4

(D, âˆ‡D )
Î”
DE
(DE , RE )

III.2
V.1
II.2
V.2
177

dS
DS ; IS
DSGal
(Dy , Ry )
D0 (a, b)
(ED , âˆ‡ED )
EE
Gal
EX
(EN , âˆ‡EN )
Î·Î¦
E0
Fâˆ—

I.1
V.1
V.1
IV.3
IV.2
V.1
II.2
V.1
III.2
III.1
V.1
II.2, III.2

Gg,r ; GÎ”
Glog
GLÂ±
G[âˆ]
HE
HYlog
ht(Î¦); htx (Î¦)
Hx
Î¹(a,b);0

II.3
IV.2
I.1
V.2
II.2
IV.3
IV.4
IV.3
IV.2

J
Îº
ÎºA
ÎºÎ²
LS ; LÃ—
S

I.1
V.1
III.1
III.1, III.3
I.1

Mg,r

I.2,

ord
Mg,r

Î¼ = (Î”, )
N g,r
ord

N g,r
Î©et
g,r
Î©et
N
Î©et
Î¦
Î©log
S

III.2

II.3
III.3
II.2
II.3, III.2
II.3
III.3
III.1
V.1
178

Ã—
Ï‰U
log /S log

I.1

OU#

I.1

P
(P, F Â· (P), âˆ‡P , PÎ¦ )
PE
Pet
Î¦E
Î¦log
N
Î¦log
X
Î¦Ï‰
E
Î¦Ï„E
Î 1 ; Î âˆ

P log
Î¨
Î¨Î±Î²
Î¨x
Q
Qg,r
qÏ‰,Î±
qÏ‰,z
qÎ¸
Ï
Ïâˆ

II.1
III.1
II.2
III.1
IV.1, V.1
III.2
IV.1, V.2
II.2
II.2
V.1
III.3
V.2
V.2
III.1
IV.3
Intro.1
II.2
III.3
II.1
IV.1
IV.1
V.2

S; S Ã—
S g,r

I.1
I.3

adm

S g,r
T
T 1/2
Î˜E
Î˜et
g,r
Î˜et
N
Î˜et
Î¦
Î˜Fâˆ—
Î˜V
E
U bi
U bi
U can

II.2
II.1, IV.1
IV.1
II.2
II.3
III.3
III.1
III.2
II.2
I.1
I.1
III.1, III.3
179

U tr
U tr

I.1
I.1

VE
V g,r
VÎ¼,Î²
X(a, b)ord
X ord ; (X log )ord
X0 (n)

II.2
II.2
III.3
IV.3
IV.1
IV.2

180

