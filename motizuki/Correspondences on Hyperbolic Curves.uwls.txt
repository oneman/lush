Correspondences
on
Hyperbolic
Curves
by
Shinichi
Mochizuki
§0.
Introduction
The
purpose
of
this
paper
is
to
prove
several
theorems
concerning
the
ﬁniteness
and,
more
generally,
the
scarcity
of
correspondences
on
hyperbolic
curves
in
characteristic
zero
and
to
comment
on
the
meaning
of
these
results,
especially
relative
to
the
analogy
with
abelian
varieties.
We
consider
hyperbolic
curves
over
an
algebraically
closed
ﬁeld
k
of
characteristic
zero.
We
call
two
such
curves
X,
Y
isogenous
if
there
exists
a
nonempty
scheme
C,
together
with
ﬁnite
étale
morphisms
C
→
X,
C
→
Y
.
(We
refer
to
such
a
pair
(C
→
X,
C
→
Y
)
as
a
correspondence
from
X
to
Y
.)
It
is
easy
to
see
that
the
relation
of
isogeny
is
an
equivalence
relation
on
the
set
of
isomorphism
classes
of
hyperbolic
curves
over
k.
Then
the
ﬁrst
main
result
of
this
paper
(cf.
Lemma
4.1
and
Theorem
4.2
in
the
text)
is
the
following:
Theorem
A.
Let
k
be
an
algebraically
closed
ﬁeld
of
characteristic
zero.
Let
X
be
a
hyperbolic
curve
over
k.
Let
(g

,
r
)
be
a
pair
of
nonnegative
integers
satisfying
2g

−2+r
>
0.
Then
(up
to
isomorphism)
there
are
only
ﬁnitely
many
hyperbolic
curves
over
k
of
type
(g

,
r
)
that
are
isogenous
to
X.
Moreover,
if
K
is
an
algebraically
closed
ﬁeld
extension
of
k,
then
any
curve
which
is
isogenous
to
X
over
K
is
deﬁned
over
k
and
already
isogenous
to
X
over
k.
This
result
is,
technically
speaking,
a
rather
trivial
consequence
of
highly
nontrivial
results
of
Margulis
and
Takeuchi
([Marg],
[Take]).
Moreover,
it
is
possible
that
Theorem
A
has
been
known
to
many
experts
for
some
time,
but
that
they
simply
never
bothered
to
write
it
down.
As
for
the
author,
I
was
dimly
aware
of
Theorem
A
for
some
time,
without
having
checked
the
details
of
the
proof
of
it,
until
I
was
asked
explicitly
about
the
ﬁniteness
stated
in
Theorem
A
by
Prof.
Frans
Oort
during
my
stay
at
Utrecht
University
in
November
1996.
I
was
then
encouraged
by
Prof.
Oort
to
write
down
the
details;
whence
the
present
paper.
In
fact,
for
general
curves,
we
can
say
more:
Indeed,
let
(Mg,r
)k
denote
the
moduli
stack
of
r-pointed
smooth
(proper)
curves
of
genus
g.
Here,
the
r
marked
points
are
unordered.
(Note
that
this
diﬀers
slightly
from
the
usual
convention.)
The
complement
of
the
divisor
of
marked
points
of
such
a
curve
will
be
a
hyperbolic
curve
of
type
(g,
r).
Thus,
we
shall
also
refer
(by
slight
abuse
of
terminology)
to
(Mg,r
)k
as
the
moduli
stack
of
hyperbolic
curves
of
type
(g,
r).
1
Theorem
B.
Let
k
be
an
algebraically
closed
ﬁeld
of
characteristic
zero.
Let
(g,
r)
be
a
pair
of
nonnegative
integers
such
that
2g
−
2
+
r
≥
3.
Let
(Mg,r
)k
be
the
moduli
stack
of
(hyperbolic)
curves
of
type
(g,
r).
Then
there
exists
a
dense
open
substack
U
⊆
(Mg,r
)k
with
the
following
property:
If
X
is
a
hyperbolic
curve
over
some
algebraically
closed
extension
ﬁeld
K
of
k
that
deﬁnes
a
point
of
U(K),
then
every
correspondence
(α
:
C
→
X,
β
:
C
→
X

)
from
X
to
another
hyperbolic
curve
X

is
trivial
in
the
sense
that
there
exists
a
ﬁnite
étale
morphism
γ
:
X

→
X
such
that
α
=
γ
◦
β.
In
particular,
for
such
an
X,
every
X

isogenous
to
X
can
be
realized
as
a
ﬁnite
étale
covering
of
X.
Theorem
B
follows
from
Theorem
5.3
in
the
text.
Moreover,
in
the
exceptional
cases
ruled
out
in
the
statement
of
Theorem
B,
a
general
curve
always
admits
nontrivial
correspondences
(see
Theorem
5.7
and
the
Remark
following
it).
One
aspect
of
the
signiﬁcance
of
Theorem
A
is
that
it
shows
that
although
“isogeny”
of
hyperbolic
curves
is
a
natural
analogue
of
the
notion
of
isogeny
for
abelian
varieties,
the
behavior
of
hyperbolic
curves
with
respect
to
isogeny
is
somewhat
diﬀerent
from
the
behavior
of
abelian
varieties
with
respect
to
isogeny.
For
instance,
if
one
starts
with
a
(principally
polarized)
abelian
variety,
and
considers
all
the
principally
polarized
abelian
varieties
isogenous
to
it
–
i.e.,
a
so-called
“Hecke
orbit”
–
such
orbits
(far
from
being
ﬁnite)
are
dense
in
the
moduli
stack
of
principally
polarized
abelian
varieties
in
characteristic
zero
Ag
.
Indeed,
one
can
see
this
density
in
the
classical
complex
topology
by
using
the
uniformization
of
Ag
by
Sp2g
(R)
(modulo
a
maximal
compact
subgroup),
and
the
fact
that
Sp2g
(Q)
is
dense
in
Sp2g
(R).
One
way
to
describe
why
such
“Hecke
orbits”
tend
to
be
so
big
is
to
regard
this
phenomenon
as
a
consequence
of
the
existence
of
various
natural
nontrivial
correspondences
on
Ag
,
the
so-called
Hecke
correspondences.
“Acting
on”
some
initial
point
with
these
correspondences
gives
a
natural
way
of
constructing
lots
of
abelian
varieties
isogenous
to
the
abelian
variety
corresponding
to
the
initial
point.
Given
these
circumstances,
Theorem
A
then
leads
one
to
suspect
that
unlike
Ag
,
the
moduli
stack
Mg,r
of
hyperbolic
curves
of
type
(g,
r)
will
not
have
very
many
correspondences.
In
fact,
one
has
the
following
result
(given
as
Theorem
6.1
in
the
text):
Theorem
C.
Suppose
that
2g
−
2
+
r
≥
3.
Then
Mg,r
is
generically
a
scheme,
and
moreover,
does
not
admit
any
nontrivial
automorphisms
or
correspondences.
Technically
speaking,
this
is
a
trivial
consequence
of
a
theorem
of
Royden,
although
I
have
not
seen
Royden’s
theorem
interpreted
in
this
way
–
i.e.,
as
implying
a
statement
about
correspondences
on
Mg,r
–
elsewhere.
It
is
intriguing
that
the
exceptional
cases
ruled
out
in
Theorems
B
and
C
(i.e.,
the
cases
where
2g
−
2
+
r
≤
2)
are
precisely
the
same.
That
is
to
say,
the
existence
of
nontrivial
correspondences
on
a
general
curve
appears
to
be
related
to
irregularities
in
the
2
holomorphic
automorphism
group
of
Teichmüller
space.
Unfortunately,
I
do
not
have
any
theoretical
explanation
for
this
phenomenon
at
the
time
of
writing.
Finally,
another
interesting
aspect
of
this
circle
of
ideas
is
the
following:
In
the
case
of
Ag
,
the
algebraic
Hecke
correspondences
may
be
constructed
p-adically
using
the
SerreTate
parameters,
or,
equivalently,
by
means
of
certain
canonical
Frobenius
lifting
over
the
ordinary
locus
of
the
p-adic
completion
of
Ag
.
(This
Frobenius
lifting
is
the
Frobenius
lifting
given
by
assigning
to
an
abelian
variety
with
ordinary
reduction
modulo
p,
the
quotient
of
this
abelian
variety
by
the
multiplicative
portion
of
the
kernel
of
multiplication
by
p.
For
g
=
1,
this
Frobenius
lifting
is
known
as
the
“Deligne-Tate
map.”)
Put
another
way,
although
this
canonical
Frobenius
lifting
is
essentially
p-adic
in
nature,
and
cannot
be
algebraized,
by
combining
it
with
its
transpose,
we
obtain
a
correspondence
which
can
be
algebraized
–
namely,
into
a
Hecke
correspondence.
On
the
other
hand,
in
the
case
of
Mg,r
,
there
does
exist
a
direct
analogue
of
the
canonical
Frobenius
lifting
on
(the
ordinary
locus
of
the
p-adic
completion
of)
Ag
–
namely,
the
theory
of
[Mzk1],
[Mzk2],
[Mzk3].
Thus,
it
is
natural
to
ask
whether
the
canonical
modular
Frobenius
lifting
on
Mg,r
can
be
algebraized
in
a
similar
fashion
by
forming
a
correspondence
from
the
union
of
the
Frobenius
lifting
and
its
transpose.
Theorem
C
tells
us,
however,
that
the
answer
is
no.
Thus,
although
Theorems
A,
B,
and
C
are
technically
just
concatenations
of
known
results,
their
signiﬁcance
in
the
context
of
the
theory
of
[Mzk1],
[Mzk2],
[Mzk3],
appears
not
to
have
been
noticed
by
previous
authors.
Acknowledgements:
I
would
like
to
thank
Prof.
Frans
Oort
for
proposing
the
ﬁniteness
question
answered
in
Theorem
A
to
me
during
my
stay
at
Utrecht
University
in
November
1996,
and
for
making
various
useful
comments
concerning
both
the
substance
and
the
expository
style
of
this
paper.
Also,
I
would
like
to
thank
the
University
for
its
generosity
and
hospitality
during
my
stay,
and
the
Nederlandse
Organizatie
voor
Wetenschappelijk
Onderzoek
for
ﬁnancial
support.
Finally,
I
would
like
to
thank
Prof.
Y.
Ihara
for
informing
me
of
the
paper
[Take]
in
the
Spring
of
1995.
§1.
Basic
Deﬁnitions
Let
k
be
an
algebraically
closed
ﬁeld
of
characteristic
zero.
Let
X
be
a
hyperbolic
curve
over
k.
By
this,
we
mean
that
X
is
an
open
subset
of
a
proper,
smooth,
connected,
onedimensional
k-scheme
X
such
that
if
g
is
the
genus
of
X
(i.e.,
the
dimension
of
H
1
(X,
OX
)
over
k),
and
r
is
the
number
of
points
in
X
−
X,
then
we
have
2g
−
2
+
r
>
0.
We
shall
refer
to
(g,
r)
as
the
type
of
X.
Suppose
that
Y
and
Z
are
also
hyperbolic
curves
over
k.
Then
we
make
the
following
Deﬁnition
1.1.
We
shall
refer
to
as
a
correspondence
from
X
to
Y
any
(ordered)
pair
of
ﬁnite,
étale
morphisms
α
:
C
→
X,
β
:
C
→
Y
,
where
we
assume
that
C
is
nonempty.
3
Thus,
C
will
necessarily
be
a
ﬁnite
disjoint
union
of
hyperbolic
curves
over
k.
Note
that
we
do
not
assume
that
C
is
connected.
Deﬁnition
1.2.
We
shall
refer
to
a
correspondence
(α
:
C
→
X,
β
:
C
→
Y
)
from
X
to
Y
as
trivial
if
there
exists
a
ﬁnite
étale
morphism
γ
:
Y
→
X
such
that
α
=
γ
◦
β.
Deﬁnition
1.3.
Given
a
correspondence
(α,
β)
from
X
to
Y
,
we
shall
refer
to
as
the
transpose
correspondence
to
(α,
β)
the
correspondence
(from
Y
to
X)
given
by
the
pair
(β,
α).
Deﬁnition
1.4.
Let
(α1
:
C1
→
X,
β1
:
C1
→
Y
)
(respectively,
(α2
:
C2
→
Y,
β2
:
C2
→
Z))
be
a
correspondence
from
X
to
Y
(respectively,
Y
to
Z).
Then
we
shall
refer
to
as
the
composite
of
these
two
correspondences
the
correspondence
given
by
the
following
pair
of
morphisms:
the
ﬁrst
morphism
C1
×Y
C2
→
X
is
given
by
composing
the
projection
to
C1
with
α1
;
the
second
morphism
C1
×Y
C2
→
Z
is
given
by
composing
the
projection
to
C2
with
β2
.
Thus,
the
composite
correspondence
is
a
correspondence
from
X
to
Z.
As
the
terminology
“from
X
to
Y
”
implies,
we
want
to
regard
correspondences
from
X
to
Y
as
a
sort
of
hyperbolic
analogue
of
isogenies
between
abelian
varieties.
Deﬁnition
1.5.
We
shall
call
two
hyperbolic
curves
X
and
Y
over
k
isogenous
if
there
exists
a
corresondence
from
X
to
Y
.
Note
that
by
taking
transposes
and
composites
of
correspondences,
one
sees
immediately
that
the
relation
of
isogeny
is
an
equivalence
relation.
§2.
Review
of
Results
of
Margulis
and
Takeuchi
In
this
Section,
we
assume
that
k
is
C,
the
ﬁeld
of
complex
numbers.
Let
X
be
a
hyperbolic
curve
over
k.
Let
X
be
the
Riemann
surface
associated
to
X.
Thus,
the
underlying
set
of
X
is
X(C).
Let
X
be
the
universal
covering
space
of
X
.
Thus,
X
is
a
Riemann
surface.
From
elementary
complex
analysis,
one
knows
that
X
is
holomorphidef
cally
isomorphic
to
H
=
{z
∈
C|
Im(z)
>
0}.
Let
us
choose
a
holomorphic
identiﬁcation
of
X
with
H.
Recall
also
from
elementary
complex
analysis
that
the
group
of
holomorphic
automorphisms
of
H
may
be
identiﬁed
with
PSL2
(R)0
(acting
via
linear
fractional
transformations).
(Here,
the
superscripted
“0”
denotes
the
connected
component
of
the
identity.)
Let
us
write
Π
for
the
(topological)
fundamental
group
of
X
(for
some
choice
of
base-point).
Then
the
action
of
Π
on
X
by
deck
transformations
deﬁnes
an
injection
Π
→
Aut(H)
=
PSL2
(R)0
.
Let
us
denote
the
image
of
this
injection
by
Γ
⊆
PSL2
(R)0
.
In
the
following,
we
will
always
think
of
Γ
as
a
subgroup
of
PSL2
(R)0
.
4
Next,
if
Γ1
and
Γ2
are
twosubgroups
of
PSL2
(R)0
,
let
us
write
Γ1
∼
Γ2
(read
“Γ1
is
commensurable
with
Γ2
”)
if
Γ1
Γ2
has
ﬁnite
index
in
both
Γ1
and
Γ2
.
Also,
let
us
write
Comm(Γ)
=
{γ
∈
PSL2
(R)0
|
(γ
·
Γ
·
γ
−1
)
∼
Γ}
def
Note
that
Γ
⊆
Comm(Γ).
Then
we
make
the
following
Deﬁnition
2.1.
We
shall
say
that
X,
X
,
or
Γ
has
inﬁnitely
many
correspondences
if
Γ
has
inﬁnite
index
in
Comm(Γ).
By
a
theorem
of
[Marg]
(see
Theorem
2.5
below),
X
is
“arithmetic”
if
and
only
if
it
has
inﬁnitely
many
correspondences.
We
would
like
to
review
this
result
below,
but
before
we
can
do
this,
we
need
to
review
what
it
means
for
X
to
be
“arithmetic.”
Unfortunately,
for
hyperbolic
curves,
there
(at
least)
two
diﬀerent
ways
to
deﬁne
arithmeticity.
In
this
paper,
we
will
need
to
use
both
deﬁnitions,
so
in
the
following,
we
shall
review
both
deﬁnitions,
and
then
show
that
they
are
equivalent.
We
begin
with
the
deﬁnition
of
[Marg],
Chapter
IX,
§1.5:
To
do
this,
ﬁrst
we
need
to
recall
some
basic
terminology.
If
F
is
a
ﬁeld
of
characteristic
zero,
and
G
is
an
algebraic
group
over
F
,
then
we
shall
say
that
G
is
almost
F
-simple
if
any
proper,
closed,
normal
algebraic
subgroup
of
G
deﬁned
over
F
is
ﬁnite.
Also,
we
shall
denote
by
(PSL2
)R
the
algebraic
group
“PSL2
”
over
R.
Deﬁnition
2.2.
We
shall
call
X,
X
,
or
Γ
Margulis-arithmetic
if
there
exists
a
connected
non-commutative
almost
Q-simple
algebraic
group
G
over
Q,
together
with
a
surjection
τ
:
def
GR
=
G
⊗Q
R
→
(PSL2
)R
of
algebraic
groups
over
R
such
that
the
Lie
group
(Ker
τ
)(R)
is
compact,
and
the
subgroups
τ
(G(Z))
and
Γ
(of
PSL2
(R)0
)
are
commensurable.
(Here,
by
the
notation
G(Z),
we
mean
the
Z-valued
points
of
GLN
that
lie
inside
G
for
some
embedding
of
Q-algebraic
groups
G
→
(GLN
)Q
.
Thus,
properly
speaking,
“G(Z)”
is
an
equivalence
class
of
commensurable
subgroups
of
G(Q)
(see
[Marg],
p.
60,
Lemma
3.1.1
(iv)
and
the
following
discussion
for
more
details).)
Next,
we
review
the
deﬁnition
of
arithmeticity
given
in
[Take]:
Deﬁnition
2.3.
We
shall
call
X,
X
,
or
Γ
Shimura-arithmetic
if
the
following
data
exist:
(1)
a
totally
real
algebraic
number
ﬁeld
F
;
(2)
a
quaternion
algebra
A
over
F
which
is
trivial
at
one
of
the
inﬁnite
places
of
F
and
nontrivial
at
all
the
other
inﬁnite
places;
(3)
a
trivialization
of
A
at
the
inﬁnite
place
of
F
at
which
A
is
trivial;
this
trivialization
will
be
used
to
regard
A
as
a
subalgebra
of
M2
(R);
5
(4)
an
order
OA
⊆
A
such
that
the
intersection
of
OA
⊆
A
⊆
M2
(R)
with
SL2
(R)
⊆
M2
(R)
has
image
in
PSL2
(R)0
commensurable
with
Γ.
(The
reason
for
this
terminology
is
that
the
situation
described
in
this
deﬁnition
(used
in
[Take])
was
studied
extensively
by
Shimura
in,
for
instance,
[Shi],
Chapter
8.)
The
following
result
is
well-known,
but
I
don’t
know
of
an
adequate
reference:
Proposition
2.4.
The
Riemann
surface
X
is
Margulis-arithmetic
if
and
only
if
it
is
Shimura-arithmetic.
Proof.
That
Shimura-arithmeticity
implies
Margulis-arithmeticity
is
clear.
Thus,
let
us
assume
that
Γ
is
Margulis-arithmetic,
and
prove
that
it
is
also
Shimura-arithmetic.
Let
us
suppose
that
we
have
a
G
and
a
τ
:
GR
→
(PSL2
)R
as
in
Deﬁnition
2.2.
First,
let
us
observe
that
the
fact
that
G
is
almost
Q-simple
implies
that
GQ
is
the
almost
direct
product
of
its
almost
simple
factors
Hi
⊆
GQ
(where
i
=
1,
.
.
.
,
n)
–
see,
e.g.,
[Marg],
p.
21.
Moreover,
since
the
almost
simple
factors
are
canonical,
it
follows
that
the
action
of
Gal(Q/Q)
on
GQ
(given
by
the
fact
that
GQ
is
deﬁned
over
G)
permutes
these
almost
simple
factors.
Since
G
is
almost
Q-simple,
it
even
follows
that
Gal(Q/Q)
acts
transitively
on
the
almost
simple
factors
of
GQ
.
Thus,
the
stabilizer
of,
for
instance,
H1
in
Gal(Q/Q)
is
Gal(Q/F
),
for
some
ﬁnite
extension
F
of
Q.
Moreover,
the
action
of
Gal(Q/F
)
on
H1
(which
is
an
algebraic
group
over
Q)
deﬁnes
an
F
-rational
structure
on
H1
,
i.e.,
there
is
some
F
-algebraic
group
HF
such
that
H1
=
(HF
)
⊗F
Q.
In
fact,
it
follows
from
the
deﬁnitions
that
the
other
Hi
’s
are
just
the
Galois
conjugates
of
H1
,
hence
that
the
inclusion
def
(HF
)Q
=
H1
→
GQ
induces
an
isogeny
of
G
=
RestF/Q
(HF
)
(where
“RestF/Q
”
denotes
“Weil
restriction
of
scalars
from
F
to
Q”)
onto
G.
Next,
we
would
like
to
observe
that
Lie(HF
)C
is
isomorphic
to
sl2
(C).
To
see
this,
we
argue
as
follows.
First,
note
that
τ
⊗R
C
induces
a
surjection
of
Lie
algebras
from
Lie(GC
)
onto
sl2
(C).
Since
sl2
(C)
is
a
simple
Lie
algebra,
it
thus
follows
that
at
least
one
of
the
Lie(Hi
)C
’s
is
isomorphic
to
sl2
(C).
But
this
implies
that
Lie(HF
)C
∼
=
sl2
(C),
as
desired.
Now
let
HF∗
be
the
quotient
of
HF
by
its
center.
Then
it
follows
from
the
elementary
theory
of
algebraic
groups,
plus
what
we
did
in
the
preceding
paragraph,
that
HF∗
is
some
twisted
from
of
(PGL2
)Q
over
F
.
In
other
words,
HF∗
deﬁnes
a
class
in
the
non-abelian
Galois
cohomology
set
H
1
(F,
PGL2
),
hence
an
element
of
the
Brauer
group
of
F
of
order
two.
Put
another
way,
there
exists
a
quaternion
algebra
A
over
F
such
that
HF∗
may
be
identiﬁed
with
(the
F
-algebraic
group
corresponding
to)
A×
/F
×
.
Next,
we
would
like
to
show
that
F
is
totally
real,
and
that
A
is
the
sort
of
quaternion
algebra
that
appears
in
Deﬁnition
2.3.
To
do
this,
we
consider
G(R).
The
above
analysis
of
G
and
HF∗
shows
that
for
each
complex
inﬁnite
place
of
F
,
there
appears
in
GR
an
almost
R-simple
factor
which
is
isogenous
to
RestC/R
(PGL2
)C
.
If
τ
were
trivial
on
this
factor,
then
(Ker
τ
)(R)
would
contain
SL2
(C)
or
PSL2
(C),
hence
would
be
noncompact.
Thus,
6
we
obtain
that
τ
is
nontrivial
on
such
a
factor.
On
the
other
hand,
this
implies
that
there
exists
a
nontrivial
morphism
PGL2
(C)
→
PGL2
(R)0
of
real
Lie
groups.
Moreover,
since
PGL2
(R)0
has
an
R-simple
Lie
algebra,
it
follows
that
such
a
morphism
is
surjective.
But
since
the
kernel
of
this
morphism
is
compact
and
of
real
dimension
three,
this
implies
that
the
maximal
compact
subgroup
of
PGL2
(C)
is
normal,
which
is
absurd.
This
contradiction
implies
that
F
has
no
complex
places.
Similarly,
if
the
quaternion
algebra
A
were
trivial
at
two
real
places
of
F
,
then
we
would
get
a
surjection
PGL2
(R)0
×
PGL2
(R)0
→
PGL2
(R)0
(of
real
Lie
groups)
with
compact
kernel.
But
since
the
kernel
of
such
a
surjection
is
necessarily
isomorphic
to
PGL2
(R)0
,
this
is
absurd.
Thus,
we
see
that
A
is
as
in
Deﬁnition
2.3.
Now
one
sees
easily
that
τ
deﬁnes
a
trivialization
(datum
(3)
of
Deﬁnition
2.3),
and
that
there
exist
representatives
of
the
equivalence
class
“G(Z)”
that
arise
in
the
fashion
described
in
(4)
of
Deﬁnition
2.3.
This
shows
that
Γ
is
Shimura-arithmetic,
thus
completing
the
proof
of
the
Proposition.
In
the
future,
we
shall
refer
to
X,
X
,
or
Γ
as
arithmetic
if
it
is
either
Margulis-arithmetic
or
Shimura-arithmetic
(since
we
now
know
that
these
two
notions
of
arithmeticity
are
equivalent).
Now
we
are
ready
to
state
the
main
results
that
we
wanted
to
review
in
this
Section:
Theorem
2.5.
([Marg],
p.
337,
Theorem
27;
p.
60,
Lemma
3.1.1,
(v))
The
hyperbolic
Riemann
surface
X
is
arithmetic
if
and
only
if
it
has
inﬁnitely
many
correspondences
(in
the
sense
of
Deﬁnition
2.1).
Theorem
2.6.
([Take],
Theorem
2.1)
There
are
only
ﬁnitely
many
arithmetic
X
over
C
of
a
given
type
(g,
r).
The
ﬁrst
main
result
of
this
paper
will
essentially
be
a
consequence
of
the
above
two
results,
plus
various
elementary
manipulations,
to
be
discussed
in
the
following
Section.
§3.
The
Non-arithmetic
Case
We
maintain
the
notation
of
Section
2.
Moreover,
in
this
Section,
we
assume
that
X
is
not
arithmetic.
Thus,
we
have
Γ
⊆
Comm(Γ)
⊆
PSL2
(R)0
,
and
Γ
is
of
ﬁnite
index
in
Comm(Γ).
Now
we
would
like
to
form
the
quotient
of
H
by
Comm(Γ)
in
the
sense
of
stacks.
(We
refer
to
Chapter
1,
§4
of
[FC]
for
generalities
on
stacks.)
Let
us
denote
this
quotient
by
Y.
Note
that
since
Γ
has
ﬁnite
index
in
Comm(Γ),
it
follows
that
we
get
a
ﬁnite
étale
morphism
X
→
Y.
Moreover,
this
ﬁnite
étale
morphism
gives
the
analytic
stack
Y
an
algebraic
structure,
so
we
obtain
an
algebraic
stack
Y
together
with
a
ﬁnite
étale
morphism
X
→
Y
corresponding
to
X
→
Y.
7
Deﬁnition
3.1.
Suppose
that
X
is
not
arithmetic.
Then
we
shall
refer
to
Y
(respectively,
Y)
as
the
hyperbolic
core
of
X
(respectively,
X
).
Next,
we
would
like
to
suppose
that
we
have
been
given
a
correspondence
(α
:
C
→
X,
β
:
C
→
Z)
from
X
to
some
other
hyperbolic
curve
Z;
we
assume
here,
for
simplicity,
that
C
is
connected.
This
gives
rise
to
corresponding
analytic
morphisms
C
→
X
,
C
→
Z.
Moreover,
these
two
morphisms
induce
isomorphisms
between
the
respective
universal
covering
spaces.
Also,
we
get
various
groups
of
deck
transformations
ΓX
,
ΓC
,
ΓZ
⊆
Aut(H)
=
PSL2
(R)0
,
together
with
various
inclusion
relations:
ΓC
⊆
ΓX
;
ΓC
⊆
ΓZ
.
(Note
that
the
object
that
we
have
been
referring
to
up
till
now
by
the
notation
“Γ”
will
now
be
referred
to
as
“ΓX
.”)
Now
we
have
the
following
result:
Proposition
3.2.
We
have
ΓZ
⊆
Comm(ΓX
).
Proof.
First
observe
that
for
the
purpose
of
proving
this
Proposition,
we
may
assume
that
C
is

Galois
over
Z.
Thus,
ΓC
is
normal
(and
of
ﬁnite
index)
in
ΓZ
.
Now
let
γ
∈
ΓZ
.

−1
)
contains
ΓC
(γ
·
ΓC
·
γ
−1
)
=
ΓC
.
In
particular,
it
follows
that
Then
X
·γ

ΓX
(γ
·
Γ
−1
ΓX
(γ
·
ΓX
·
γ
)
is
of
ﬁnite
index
in
ΓX
(and
hence
also
–
by
replacing
γ
by
γ
−1
–
of
ﬁnite
index
in
γ
·
ΓX
·
γ
−1
).
This
completes
the
proof
of
the
Proposition.
Interpreting
this
Proposition
in
terms
of
Riemann
surfaces,
we
see
that
there
exists
a
unique
ﬁnite
étale
morphism
Z
→
Y
such
that
the
following
diagram
commutes:
C
⏐
⏐

−→
Z
⏐
⏐

X
−→
Y
(Here,
the
upper
horizontal
and
left-hand
vertical
morphisms
are
the
analytic
morphisms
associated
to
β
and
α,
respectively,
and
the
lower
horizontal
morphism
is
the
morphism
that
appeared
in
the
construction
of
the
hyperbolic
core
of
X
.)
Moreover,
this
diagram
can
be
algebraized.
Thus,
in
particular,
we
obtain
an
(algebraic)
ﬁnite
étale
morphism
Z
→Y.
Write
(gZ
,
rZ
)
for
the
type
of
Z.
Observe
from
the
Riemann-Hurwitz
formula
that
there
exists
a
positive
rational
number
eY
∈
Q
such
that
if
T
is
any
hyperbolic
curve,
of
type
(gT
,
rT
),
and
f
:
T
→
Y
is
ﬁnite
étale
of
degree
d,
then
2gT
−
2
+
rT
=
eY
·
d.
Now
we
are
ready
to
prove
the
following
result:
Theorem
3.3.
Suppose
that
X
is
not
arithmetic.
Fix
a
pair
of
nonnegative
integers
(g

,
r
)
such
that
2g

−
2
+
r
>
0.
Then
there
exist
(up
to
isomorphism)
only
ﬁnitely
many
hyperbolic
curves
Z
of
type
(g

,
r
)
that
are
isogenous
to
Z.
8
Proof.
Indeed,
by
the
above
discussion,
we
see
that
we
get
(for
such
Z)
a
ﬁnite
étale
morphism
Z
→
Y
.
Moreover,
the
degree
of
this
morphism
(and
hence
also
of
the
corresponding
analytic
morphism
Z
→
Y)
is
bounded
by
a
number
that
depends
only
on
g

,
r
,
and
eY
(i.e.,
X).
On
the
other
hand,
note
that
since
Comm(ΓX
)
has
a
ﬁnite
index
subgroup
which
is
ﬁnitely
generated
–
namely,
ΓX
–
it
follows
that
Comm(ΓX
)
is
itself
ﬁnitely
generated.
Moreover,
since
one
may
think
of
Comm(ΓX
)
as
the
fundamental
group
of
Y,
the
fact
that
this
group
is
ﬁnitely
generated
implies
that
there
are
(up
to
isomorphism)
only
ﬁnitely
many
ﬁnite
étale
coverings
of
Y
of
degree
less
than
some
ﬁxed
number.
This
observation
completes
the
proof
of
the
Theorem.
Remark.
Let
X
be
nonarithmetic.
Then
let
us
observe
that
if
the
automorphism
group
def
G
=
Aut(X)
of
X
is
nontrivial,
then
X
is
not
equal
to
its
hyperbolic
core.
Indeed,
since
it
is
clear
that
the
morphism
X
→
Y
that
deﬁnes
Y
as
the
hyperbolic
core
of
X
is
natural,
it
follows
that
this
morphism
is
equivariant
with
respect
to
the
given
action
of
G
on
X
and
the
trivial
action
of
G
on
Y
.
Thus,
X
→
Y
necessarily
factors
through
the
quotient
(in
the
sense
of
stacks)
X
→
X/G,
which
implies
that
X
→
Y
has
degree
>
1,
as
claimed.
On
the
other
hand,
the
converse
to
this
statement,
i.e.,
that
“if
the
degree
of
X
→
Y
is
>
1,
then
X
admits
nontrivial
automorphisms,”
is
false
in
general.
Indeed,
one
can
construct
such
an
X
as
follows:
Let
X

be
a
nonarithmetic
aﬃne
hyperbolic
curve
which
is
equal
to
its
hyperbolic
core
(such
X

exist
by
Theorem
5.3
below).
Then
the
fundamental
group
of
X

will
be
a
nonabelian
ﬁnitely
generated
free
group,
so
it
is
easy
to
see
that
it
admits
a
ﬁnite
étale
covering
X
→
X

(where
X
is
connected,
and
X
→
X

has
degree
>
1)
such
that
there
are
no
intermediate
Galois
coverings
X
→
X

(except
X
=
X).
(For
instance,
take
X
→
X

to
be
non-Galois
of
prime
degree.)
Then
I
claim
that
X
→
X

exhibits
X

as
the
hyperbolic
core
of
X.
Indeed,
if
X
→
Y
is
the
morphism
deﬁning
Y
as
the
hyperbolic
core
of
X,
then
X
→
Y
must
factor
through
X
→
X

;
but
this
gives
us
a
ﬁnite
étale
morphism
X

→
Y
which
must
be
an
isomorphism
(cf.
the
discussion
preceding
Theorem
3.3)
since
X

is
equal
to
its
own
hyperbolic
core.
This
proves
the
claim.
Thus,
X
has
no
automorphisms
(for
if
it
did,
then
by
the
argument
of
the
preceding
paragraph,
X
→
X

would
admit
a
nontrivial
intermediate
Galois
covering
X
→
X

),
but
is
not
equal
to
its
hyperbolic
core.
§4.
The
Main
Theorem
Now
we
return
to
the
situation
where
k
is
any
algebraically
closed
ﬁeld
of
characteristic
zero.
Let
X
be
a
hyperbolic
curve
over
k.
Let
K
be
an
algebraically
closed
ﬁeld
of
characteristic
zero
that
contains
k.
Write
XK
for
X
⊗k
K.
Lemma
4.1.
Suppose
that
XK
is
isogenous
to
some
hyperbolic
curve
ZK
over
K.
Then
ZK
is
the
result
of
base-extending
some
hyperbolic
curve
Z
over
k
from
k
to
K,
and,
moreover,
any
correspondence
from
XK
to
ZK
descends
to
a
correspondence
from
X
to
Z.
9
Proof.
Indeed,
since
it
only
takes
“ﬁnitely
many
equations”
to
deﬁne
a
curve
or
a
correspondence,
it
follows
that
any
αK
:
CK
→
XK
,
βK
:
CK
→
ZK
descends
to
a
pair
of
ﬁnite
étale
morphisms
αR
:
CR
→
XR
,
βR
:
CR
→
ZR
of
curves
over
R,
where
R
is
a
ﬁnitely
generated
k-subalgebra
of
K.
Now
observe
that
since
αR
is
ﬁnite
étale,
and
the
étale
site
of
a
scheme
is
rigid
with
respect
to
deformations,
it
follows
that
αR
descends
to
a
ﬁnite
étale
morphism
α
:
C
→
X.
Moreover,
if
we
restrict
βR
to
a
closed
point
s
of
Spec(R),
the
tangent
space
to
the
space
of
deformations
of
βs
:
Cs
=
C
→
Zs
is
given
by
the
kernel
of
the
pull-back
map
H
1
(Zs
,
τZs
)
→
H
1
(C,
τC
=
τZs
|C
)
(where
“τ
”
denotes
“tangent
bundle”).
But
I
claim
that
this
pull-back
map
is
injective:
Indeed,
this
follows
from
the
existence
of
the
trace
map
which
gives
a
one-sided
inverse
of
the
pull-back
map.
(Note
that
here
we
use
the
fact
that
the
degree
of
βs
is
invertible
in
k
–
a
consequence
of
the
assumption
that
k
is
of
characteristic
zero.)
Thus,
there
are
no
nontrivial
deformations
of
βs
,
so
again
we
conclude
that
βR
=
βs
⊗k
R.
This
completes
the
proof
of
the
Lemma.
Now
we
are
ready
to
prove
the
ﬁrst
main
result
of
the
paper:
Theorem
4.2.
Let
k
be
an
algebraically
closed
ﬁeld
of
characteristic
zero.
Let
X
be
a
hyperbolic
curve
over
k.
Let
(g

,
r
)
be
a
pair
of
nonnegative
integers
satisfying
2g

−2+r
>
0.
Then
(up
to
isomorphism)
there
are
only
ﬁnitely
many
hyperbolic
curves
over
k
of
type
(g

,
r
)
that
are
isogenous
to
X.
Proof.
First,
observe
that
given
any
ﬁnite
set
of
curves
isogenous
to
X,
there
exists
a
subﬁeld
k

of
k
which
is
ﬁnitely
generated
over
Q
over
which
all
the
curves
of
that
ﬁnite
set,
together
with
X
itself,
are
deﬁned.
Thus,
it
suﬃces
to
show
that
the
number
of
curves
of
type
(g

,
r
)
that
are
isogenous
to
X
over
k

(i.e.,
the
algebraic
closure
of
k

)
is
bounded
by
a
number
independent
of
the
choice
of
subﬁeld
k

.
On
the
other
hand,
since
there
always
exists
an
embedding
k

⊆
C,
the
uniform
boundedness
statement
of
the
preceding
sentence
will
be
proven
if
we
can
prove
the
ﬁniteness
statement
of
the
Theorem
in
the
case
k
=
C.
Thus,
we
may
assume
k
=
C.
Then
either
X
is
arithmetic
or
it
is
not
arithmetic.
If
X
is
arithmetic,
it
follows
easily
from
the
deﬁnitions
that
any
curve
isogenous
to
X
will
also
be
arithmetic.
Thus,
in
this
case,
the
Theorem
follows
from
Theorem
2.6.
If
X
is
not
arithmetic,
then
the
Theorem
is
simply
Theorem
3.3.
§5.
Isogenies
of
General
Curves
In
this
Section,
we
show
that
(if
one
rules
out
certain
exceptional
cases,
then)
the
only
curves
isogenous
to
a
general
hyperbolic
curve
are
the
ﬁnite
étale
coverings
of
the
curve.
This
essentially
amounts
to
a
straightforward
elementary
calculation
involving
the
Riemann-Hurwitz
formula,
but
nevertheless
we
give
full
details
below.
We
remark
that
although
the
statement
proven
below
(Theorem
5.3)
that
a
general
curve
(of
all
but
a
few
10
exceptional
types)
is
equal
to
its
hyperbolic
core
is
strictly
stronger
than
the
statement
that
such
a
curve
has
no
nontrivial
automorphisms
(cf.
the
Remark
at
the
end
of
§3),
this
calculation
involving
the
Riemann-Hurwitz
formula
is
exactly
the
same
as
in
the
proof
that
such
a
curve
has
no
nontrivial
automorphisms.
Thus,
in
principle,
this
calculation
is
“wellknown.”
Nevertheless,
I
have
chosen
to
give
full
details
below
partly
for
the
convenience
of
the
reader,
and
partly
because
of
the
following
set
of
circumstances:
In
the
case
r
=
0,
the
calculation
is
much
simpler
and
is
contained,
for
instance,
in
[Baily].
Moreover,
the
result
on
automorphisms
of
a
general
curve
for
r
=
0
immediately
implies
the
result
on
automorphisms
of
a
general
curve
for
r
>
0.
Thus,
if
one
is
only
interested
in
automorphisms,
there
is
no
need
to
carry
out
this
calculation
in
the
more
diﬃcult
case
r
>
0.
On
the
other
hand,
the
result
that
a
general
curve
is
equal
to
its
hyperbolic
core
when
r
=
0
does
not
formally
imply
the
corresponding
result
when
r
>
0.
Thus,
to
obtain
the
result
on
the
hyperbolic
core,
one
must
carry
out
this
calculation
in
complete
generality
(i.e.,
allowing
that
r
might
be
nonzero).
Since
I
do
not
know
of
a
reference
that
gives
this
calculation
in
this
generality,
I
decided
to
give
full
details
here.
Lemma
5.1.
Let
k
be
algebraically
closed
of
characteristic
zero.
Suppose
that
k
is
a
def
subﬁeld
of
C.
Let
X
be
a
hyperbolic
curve
over
k.
Suppose
that
XC
=
X
⊗k
C
is
not
arithmetic.
Then
the
morphism
XC
→
YC
appearing
in
the
discussion
of
the
hyperbolic
core
of
XC
(see
Deﬁnition
3.1)
descends
to
some
morphism
X
→
Y
over
k.
Moreover,
X
→
Y
has
the
universal
property
that
any
correspondence
(C
→
X,
C
→
Z)
over
k,
ﬁts
uniquely
into
a
commutative
diagram:
C
⏐
⏐

−→
Z
⏐
⏐

X
−→
Y
Finally,
the
morphism
X
→
Y
is
independent
(up
to
canonical
isomorphism)
of
the
embedding
of
k
into
C.
Proof.
Observe
that
(from
the
deﬁnition
of
XC
→
YC
)
there
exists
a
ﬁnite
étale
Galois



covering
XC
→
XC
such
that
XC
→
YC
is
Galois.
Since
étale
coverings
are
rigid,
XC
→

XC
descends
to
some
X
→
X
over
k.
Moreover,
since
automorphisms
of
hyperbolic
curves
def


)
=
Autk
(X

).
Thus,
G
=
Gal(XC
/YC
)
acts
on
X

,
so
that
we
may
are
rigid,
AutC
(XC
def
form
the
quotient
(in
the
sense
of
stacks)
X

→
Y
=
X

/G.
Moreover,
this
quotient
clearly
factors
through
X,
so
we
obtain
a
morphism
X
→
Y
that
descends
XC
→
YC
,
as
desired.
The
universal
property
follows
immediately
by
descending
(cf.
the
argument
of
Lemma
4.1)
from
C
to
k
the
corresponding
analytic
universal
property
discussed
in
11
the
paragraph
following
Proposition
3.2.
The
fact
that
X
→
Y
does
not
depend
on
the
embedding
of
k
into
C
follows
from
the
existence/uniqueness
assertion
inherent
in
the
statement
of
the
universal
property.
Deﬁnition
5.2.
Suppose
that
we
are
in
the
situation
of
Lemma
5.1.
Then
we
shall
refer
to
the
stack
Y
constructed
in
Lemma
5.1
as
the
hyperbolic
core
Y
of
X.
Notation.
Let
Y
be
a
smooth,
one-dimensional
algebraic
stack
over
a
ﬁeld
k.
Suppose
further
that
Y
is
generically
a
scheme.
Then
we
shall
use
the
following
notation
for
objects
related
to
Y
:
Let
us
write
Y
c
for
the
“course
moduli
space”
associated
to
Y
(see,
e.g.,
[FC],
Chapter
I,
§4.10,
for
a
discussion
of
the
course
moduli
space
associated
to
a
stack).
Thus,
Y
c
is
a
smooth,
connected,
one-dimensional
scheme
over
k,
and
we
have
a
natural
morphism
Y
→
Y
c
.
Let
us
write
gY
for
the
genus
of
the
compactiﬁcation
of
Y
c
,
and
rY
for
the
number
of
points
that
need
to
be
added
to
Y
c
to
compactify
it.
Let
us
write
ΣY
for
the
set
of
points
of
Y
c
over
which
Y
→
Y
c
is
not
étale.
For
σ
∈
ΣY
,
let
iσ
be
the
def
.
ramiﬁcation
index
of
Y
→
Y
c
at
σ.
Thus,
iσ
will
always
be
an
integer
≥
2.
Let
jσ
=
iσi−1
σ
1
Thus,
jσ
is
a
rational
number
≥
2
and
<
1.
We
shall
refer
to
the
data
(gY
;
rY
;
{iσ
}σ∈ΣY
)
as
the
type
of
the
stack
Y
.
Finally,
we
deﬁne
def
eY
=
2gY
−
2
+
rY
+

jσ
σ∈ΣY
Thus,
one
may
think
of
eY
as
the
Euler
characteristic
of
Y
.
Theorem
5.3.
Let
k
be
algebraically
closed
of
characteristic
zero.
Suppose
that
k
is
a
subﬁeld
of
C.
Fix
nonnegative
integers
g
and
r
such
that
2g
−
2
+
r
≥
3.
Then
there
exists
an
open
dense
substack
U
⊆
(Mg,r
)k
(where
(Mg,r
)k
is
the
moduli
stack
of
(hyperbolic)
curves
of
type
(g,
r)
over
k)
with
the
following
property:
If
X
is
a
hyperbolic
curve
over
some
extension
algebraically
closed
ﬁeld
K
of
k
corresponding
to
a
point
∈
U(K),
then
the
hyperbolic
core
of
X
is
equal
to
X.
Thus,
in
particular,
(if
K
is
algebraically
closed,
then)
for
such
an
X,
every
hyperbolic
curve
isogenous
to
X
can
be
realized
as
a
ﬁnite
étale
covering
of
X.
Remark.
The
exceptional
cases
ruled
out
by
the
assumption
that
2g
−
2
+
r
≥
3
are
precisely
the
cases
where
(g,
r)
is
equal
to
(0,
3),
(0,
4),
(1,
1),
(1,
2),
or
(2,
0).
Proof.
It
suﬃces
to
ﬁnd
some
U
as
in
the
statement
of
the
Theorem
with
the
property
that
for
X
corresponding
to
a
K-valued
point
of
U
(where
K
is
an
algebraically
closed
extension
ﬁeld
of
k),
the
hyperbolic
core
(Deﬁnition
3.1)
of
X
is
equal
to
X
itself.
To
do
this,
let
us
consider
the
case
of
an
X
which
is
non-arithmetic
and
whose
natural
morphism
X
→
Y
to
its
hyperbolic
core
Y
has
degree
d
>
1.
From
the
Riemann-Hurwitz
formula,
we
have
that:
12
2g
−
2
+
r
=
d(2gY
−
2
+
rY
+

jσ
)
σ∈ΣY
Since
2g
−
2
+
r
>
0,
it
follows
that
the
expression
in
parentheses,
which
is
simply
eY
,
is
also
>
0.
Now
we
have
the
following
(well-known):
Lemma
5.4.
The
expression
in
parentheses
eY
is
bounded
below
by
an
absolute
positive
constant,
independent
of
X,
g,
and
r.
Proof
of
Lemma
5.4.
This
is
a
simple
combinatorial
exercise.
If
2gY
−
2
+
rY
≥
1,
then
eY
≥
1.
If
2g
−
2
+
rY
=
0,
then
eY
≥
12
.
If
2gY
−
2
+
rY
=
−1,
then
either
ΣY
has
at
least
three
elements,
in
which
case
eY
≥
12
,
or
ΣY
has
precisely
two
elements,
in
which
case
eY
≥
16
.
If
2gY
−
2
+
rY
=
−2
(so
gY
=
rY
=
0),
then
we
have
the
following
possibilities:
If
ΣY
has
at
least
ﬁve
elements,
then
eY
≥
12
.
If
ΣY
has
precisely
four
elements,
then
eY
≥
16
.
Otherwise,
ΣY
has
precisely
three
elements.
In
this
last
case,
observe
that:
it
is
never
the
case
that
two
iσ
’s
are
=
2.
This
observation
implies
that
if
the
largest
iσ
is
≥
7,
then
eY
≥
16
−
17
>
0.
But
there
are
only
ﬁnitely
many
possibilities
for
ΣY
for
which
the
largest
iσ
is
≤
6.
This
completes
the
proof.
Lemma
5.5.
If
g
and
r
are
ﬁxed,
then
there
is
only
a
ﬁnite
number
of
possibilities
for
d,
gY
,
rY
,
and
ΣY
.
Proof
of
Lemma
5.5.
Since
2g
−
2
+
r
=
d
·
eY
,
and
(by
Lemma
5.4)
eY
is
bounded
below
by
positive
constant,
it
follows
that
d
is
bounded
above.
Since
d
is
a
positive
integer,
it
thus
follows
that
there
is
only
a
ﬁnite
number
of
possibilities
for
d.
Thus,
there
is
only
a
ﬁnite
number
of
possibilities
for
eY
.
Since
2gY
−
2
+
rY
+
12
|ΣY
|
≤
eY
(where
|ΣY
|
is
the
cardinality
of
ΣY
),
it
thus
follows
that
there
is
only
a
ﬁnite
number
of
possibilities
for
gY
,
rY
,
and
|ΣY
|.
But
since
each
iσ
≤
d,
it
thus
follows
that
there
is
only
a
ﬁnite
number
of
possibilities
for
ΣY
.
This
completes
the
proof.
Lemma
5.6.
The
locus
(inside
(Mg,r
)k
)
of
nonarithmetic
curves
that
are
not
equal
to
their
own
hyperbolic
cores
is
constructible
(in
(Mg,r
)k
).
Proof
of
Lemma
5.6.
Indeed,
for
each
possible
d,
gY
,
rY
,
ΣY
,
one
considers
the
moduli
stack
N
of
smooth,
one-dimensional
hyperbolic
stacks
Y
with
invariants
gY
,
rY
,
ΣY
.
(Note
–
for
later
use
–
that
the
dimension
of
this
moduli
stack
is
equal
to
3gY
−
3
+
rY
+
|ΣY
|.)
Then
the
moduli
stack
N

of
pairs
consisting
of
such
Y
together
with
a
ﬁnite
étale
covering
X
→
Y
of
degree
d
(where
X
is
of
type
(g,
r))
forms
a
ﬁnite
étale
covering
N

→
N
over
N
.
Moreover,
the
morphism
that
assigns
to
such
a
covering
X
→
Y
the
curve
X
deﬁnes
a
morphism
N

→
(Mg,r
)k
.
Thus,
the
locus
in
question
is
the
image
of
a
ﬁnite
(by
Lemma
5.5)
number
of
such
N

→
(Mg,r
)k
,
hence
is
constructible.
13
Thus,
it
follows
from
the
proof
of
Lemma
5.6
that
in
order
to
prove
Theorem
5.3,
it
suﬃces
to
prove
that
for
all
possible
gY
,
rY
,
and
ΣY
,
we
have
3g−3+r
>
3gY
−3+rY
+|ΣY
|
(at
least
under
the
hypotheses
placed
on
(g,
r)
in
the
statement
of
the
Theorem).
We
proceed
to
do
this
in
the
paragraphs
that
follow:
First,
let
us
consider
the
case
gY
≥
1.
In
this
case,
if
we
multiply
the
formula
2g
−
2
+
r
=
d
·
eY
by
32
and
then
subtract
12
r,
we
obtain:
3
3

1
jσ
}
−
r
3g
−
3
+
r
=
d{3(gY
−
1)
+
rY
+
2
2
2
σ∈ΣY
3d

1
1
=
3d(gY
−
1)
+
(
jσ
)
+
d
·
rY
+
(
d
·
rY
−
r)
2
2
2
σ∈ΣY
3d

≥
3(gY
−
1)
+
(
jσ
)
+
d
·
rY
2
σ∈ΣY
3·2
1
·
·
|ΣY
|
+
d
·
rY
≥
3gY
−
3
+
2
2
≥
3gY
−
3
+
rY
+
|ΣY
|
(Here
we
use
that
d
·
rY
≥
r,
d
≥
2,
jσ
≥
12
.)
Moreover,
if
gY
≥
2,
then
the
ﬁrst
“≥”
may
be
replaced
with
a
“>,”
while
if
gY
=
1
(so
that
rY
+
|ΣY
|
≥
1),
then
the
third
“≥”
may
be
replaced
with
a
“>.”
Thus,
either
way,
we
obtain
that
as
long
as
gY
≥
1,
we
have
3g
−
3
+
r
>
3gY
−
3
+
rY
+
|ΣY
|,
as
desired.
Now,
we
consider
the
case
gY
=
0.
First
of
all,
just
as
above,
we
obtain
that
3g−3+r
≥
3

d(−3
+
rY
+
2
σ
jσ
).
Since
we
wish
to
show
that
3g
−
3
+
r
>
−3
+
rY
+
|ΣY
|,
it
suﬃces
to
show
that
the
quantity
def
QY
=
(d
−
1)(rY
−
3)
+
(
3d
−
1)|ΣY
|
4
is
positive.
(Here
we
use
that
jσ
≥
12
.)
Next,
let
us
observe
that
if
|ΣY
|
≥
7,
then
9d
1
QY
≥
−3d
+
3
+
21d
4
−
7
=
4
−
4
≥
2
>
0.
Thus,
it
suﬃces
to
consider
the
case
|ΣY
|
≤
6.
Note
that
at
this
point,
we
still
have
not
used
the
assumption
that
2g
−
2
+
r
≥
3.
Now
note
that
if
r
=
0
and
the
desired
inequality
is
false,
then
rY
=
0,
so
3g
−
3
≤
−3
+
rY
+
|ΣY
|
≤
3,
so
(g,
r)
=
(2,
0),
but
this
case
was
ruled
out
in
the
hypothesis
of
the
Theorem.
This
completes
the
proof
of
the
Theorem
when
r
=
0.
Thus,
for
the
rest
of
the
proof,
we
assume
that
r
=
0.
Then
rY
=
0.
Now
if
|ΣY
|
≥
5,
1
then
QY
≥
−2d
+
2
+
15d
4
−
5
≥
2
>
0.
Thus,
we
obtain
that
|ΣY
|
≤
4.
Now
if
rY
≥
3,
and
the
desired
inequality
is
false,
then
we
obtain
(under
the
assumption
that
(g,
r)
=
(0,
3))
that
0
<
3g
−
3
+
r
≤
(rY
−
3)
+
|ΣY
|,
so
it
follows
immediately
that
QY
>
0;
thus,
rY
≤
2.
Thus,
in
summary,
we
have
that
|ΣY
|
≤
4,
rY
≤
2.
Moreover,
if
|ΣY
|
∈
{3,
4}
and
rY
=
2,
5d
1
then
QY
≥
1
−
d
+
9d
4
−
3
=
4
−
2
≥
2
>
0.
Thus,
in
summary
we
see
that
|ΣY
|
+
rY
≤
5,
14
(|ΣY
|,
rY
)
=
(3,
2).
Note
that
at
this
point
(in
our
treatment
of
the
case
r
=
0),
the
only
assumption
that
we
have
used
concerning
(g,
r)
is
that
it
is
not
equal
to
(0,
3).
Now
we
invoke
the
assumption
that
2g
−
2
+
r
≥
3.
If
the
desired
inequality
is
false,
then
3g
−
3
+
r
≤
−3
+
rY
+
|ΣY
|
≤
2,
so
the
only
(g,
r)
that
is
still
possible
(and
which
is
not
ruled
out
in
the
hypothesis
of
the
Theorem)
is
(g,
r)
=
(0,
5).
Thus,
for
the
rest
of
the
proof,
we
assume
that
(g,
r)
=
(0,
5).
It
remains
only
to
examine
the
case
|ΣY
|
=
4,
rY
=
1.
In
this
case,
QY
=
d
−
2,
so
QY
≤
0
implies
d
=
2.
Thus,
5
=
r
≤
d
·
rY
=
2,
which
is
absurd.
This
completes
the
proof
of
Theorem
5.3.
Remark.
It
is
not
diﬃcult
to
check
that
in
the
exceptional
cases
(i.e.,
the
cases
where
2g
−
2
+
r
≤
2)
ruled
out
in
Theorem
5.3,
the
hyperbolic
core
of
a
general
curve
is
not
equal
to
the
core
itself.
Indeed,
we
have
the
following:
Theorem
5.7.
For
a
“general”
(in
the
same
sense
as
in
the
statement
of
Theorem
5.3)
hyperbolic
curve
X
of
type
(g,
r),
the
canonical
morphism
X
→
Y
to
the
hyperbolic
core
of
X
may
be
described
as
follows:
gY
=
0
and
(1)
If
(g,
r)
=
(0,
4),
then
X
→
Y
has
degree
4,
rY
=
1,
|ΣY
|
=
3,
all
the
iσ
are
2,
and
the
ramiﬁcation
index
at
the
point
at
inﬁnity
of
Y
is
1.
(2)
If
(g,
r)
=
(1,
1),
then
X
→
Y
has
degree
2,
rY
=
1,
|ΣY
|
=
3,
all
the
iσ
are
2,
and
the
ramiﬁcation
index
at
the
point
at
inﬁnity
of
Y
is
2.
(3)
If
(g,
r)
=
(1,
2),
then
X
→
Y
has
degree
2,
rY
=
1,
|ΣY
|
=
4,
all
the
iσ
are
2,
and
the
ramiﬁcation
index
at
the
point
at
inﬁnity
of
Y
is
1.
(4)
If
(g,
r)
=
(2,
0),
then
X
→
Y
has
degree
2,
rY
=
0,
|ΣY
|
=
6,
and
all
the
iσ
are
2.
Finally,
if
(g,
r)
=
(0,
3),
then
X
is
arithmetic,
so
the
hyperbolic
core
is
not
deﬁned.
Proof.
We
continue
computing
with
the
notation
at
the
end
of
the
proof
of
Theorem
5.3.
Thus,
ﬁrst
of
all,
we
have
that
3g
−
3
+
r
=
rY
+
|ΣY
|
−
3.
We
begin
with
the
case
(g,
r)
=
(2,
0).
In
this
case,
rY
=
0
and
|ΣY
|
=
6.
Thus,
QY
=
32
d
−
3,
so
QY
≤
0
implies
d
=
2.
Since
a
general
proper
curve
of
genus
2
is
well-known
to
be
hyperelliptic,
this
completes
the
case
of
(g,
r)
=
(2,
0).
Thus,
it
remains
to
consider
those
(g,
r)
for
which
r
=
0.
Let
us
also
assume
(until
the
second
to
last
paragraph
of
the
proof)
that
(g,
r)
=
(0,
3).
Then
it
follows
from
the
proof
of
Theorem
5.3
that
gY
=
0
and
rY
is
either
1
or
2.
Moreover,
if
rY
=
2,
then
|ΣY
|
=
2,
while
if
rY
=
1,
then
|ΣY
|
is
3
or
4.
15
If
rY
=
2
and
|ΣY
|
=
2,
then
QY
=
12
d
−
1,
so
QY
≤
0
implies
d
=
2.
Thus,
2g
−
2
+
r
=
d
·
eY
=
2,
while
3g
−
3
+
r
=
rY
+
|ΣY
|
−
3
=
1,
i.e.,
(g,
r)
=
(0,
4).
We
shall
see
later
that
in
fact,
this
case
cannot
arise
under
the
assumption
that
X
→
Y
is
the
canonical
map
deﬁning
Y
as
the
hyperbolic
core
of
X.
From
now
on,
we
assume
that
rY
=
1.
If
|ΣY
|
=
4,
then
QY
=
d
−
2,
so
QY
≤
0
implies
d
=
2.
Thus,
2g
−
2
+
r
=
d
·
eY
=
2,
while
3g
−
3
+
r
=
rY
+
|ΣY
|
−
3
=
2,
i.e.,
(g,
r)
=
(1,
2).
If
|ΣY
|
=
3,
then
QY
=
d4
−
1,
so
QY
≤
0
implies
d
∈
{2,
3,
4}.
Since
3g
−
3
+
r
=
rY
+
|ΣY
|
−
3
=
1,
it
follows
that
2g
−
2
+
r
is
1
or
2.
I
claim
that
d
=
3.
Indeed,
if
d
were
3,
then
all
the
iσ
would
be
=
3,
so
we
would
get
2g
−
2
+
r
=
d
·
eY
=
3,
which
is
absurd.
This
proves
the
claim.
Now
observe
that
all
the
iσ
are
equal
to
2.
Indeed,
since
the
only
possibilities
for
each
iσ
are
2
and
4,
if
there
were
even
one
iσ
=
2,
then
we
would
have
d
=
4,
eY
≥
34
,
so
3
≤
d
·
eY
=
2g
−
2
+
r
∈
{1,
2},
which
is
absurd.
Thus,
all
the
iσ
=
2,
as
claimed.
Moreover,
eY
=
12
,
and
d
=
2(2g
−
2
+
r).
In
other
words,
either
(g,
r)
=
(0,
4),
in
which
case
d
=
4,
or
(g,
r)
=
(1,
1),
in
which
case
d
=
2.
Next,
we
pause
to
remark
that
it
is
not
diﬃcult
to
show
that
a
general
curve
of
type
(0,
4)
can
actually
be
obtained
as
a
degree
four
covering
of
a
stack
Y
with
gY
=
0,
rY
=
1,
|ΣY
|
=
3,
and
all
the
iσ
=
2.
Indeed,
consider
the
covering
of
P1
minus
four
points
deﬁned
by
the
permutations
(12)(34);
(13)(24);
(14)(23);
id.
(Note
that
the
product
of
these
permutations
is
the
identity.)
Here
we
think
of
the
points
corresponding
to
the
ﬁrst
three
permutations
as
the
points
at
which
Y
is
not
a
scheme,
and
the
point
corresponding
to
the
last
permutation
as
the
point
at
inﬁnity
of
Y
.
Thus,
the
existence
of
such
a
covering
shows
that
the
case
rY
=
2,
|ΣY
|
=
2
(where
the
degree
is
necessarily
2,
which
is
<
4)
could
not
arise
under
the
assumption
that
the
map
X
→
Y
is
the
canonical
map
deﬁning
Y
as
the
hyperbolic
core
of
X.
The
only
remaining
case
to
consider
is
the
case
(g,
r)
=
(0,
3).
In
this
case,
it
is
well
known
that
X
is
arithmetic.
(In
fact,
it
appears
as
a
ﬁnite
étale
covering
of
the
moduli
stack
of
elliptic
curves.)
Thus,
the
hyperbolic
core
is
not
deﬁned.
Finally,
we
observe
that
it
is
easy
to
see
that
morphisms
X
→
Y
as
stated
in
the
Theorem
always
exist.
Thus,
the
above
case
analysis
shows
that
such
morphisms
are
necessarily
the
hyperbolic
cores
in
each
of
the
respective
cases.
This
completes
the
proof
of
the
Theorem.
Remark.
It
is
not
diﬃcult
to
see
that
all
the
exceptional
cases
listed
in
Theorem
5.7
have
the
following
property:
A
general
curve
X
admits
a
correspondence
(α
:
Z
→
X,
β
:
Z
→
X

)
which
is
nontrivial
in
the
sense
that
there
does
not
exist
a
ﬁnite
étale
γ
:
X

→
X
such
that
α
=
γ
◦β
(cf.
Deﬁnition
1.2).
Indeed,
in
the
cases
(g,
r)
=
(0,
4),
(1,
1),
since
the
hyperbolic
cores
are
of
the
same
type,
(0,
4)-curves
and
(1,
1)-curves
provide
“X”’s/“X

”’s
for
each
other.
Next,
we
consider
the
case
(g,
r)
=
(1,
2).
If
X
→
Y
is
the
hyperbolic
core
of
a
general
curve
X
of
type
(1,
2),
then
let
X

→
Y
be
the
covering
of
Y
of
degree
4
deﬁned
by
the
permutations:
(12)(34),
(13)(24),
(14)(23),
(12)(34),
(12)(34).
(Here,
one
thinks
of
the
ﬁrst
four
permutations
as
describing
the
ramiﬁcation
over
the
four
points
of
Y
c
at
which
Y
16
is
not
a
scheme,
and
the
last
permutation
as
describing
the
ramiﬁcation
over
the
point
at
inﬁnity
of
Y
.)
Then
consideration
of
the
inertia
groups
at
the
various
points
of
X

shows
def
that
X
→
Y
and
X

→
Y
are
linearly
disjoint,
so
(Z
=
X
×Y
X

→
X,
Z
→
X

)
gives
the
desired
nontrivial
correspondence.
Finally,
we
consider
the
case
(g,
r)
=
(2,
0).
In
this
case,
we
take
for
X

→
Y
the
covering
of
degree
4
deﬁned
by
the
permutations:
(12)(34),
(13)(24),
(14)(23),
(12)(34),
(13)(24),
(14)(23).
(Here,
one
thinks
of
these
permutations
as
describing
the
ramiﬁcation
over
the
six
points
of
Y
c
at
which
Y
is
not
a
scheme.)
Then
consideration
of
the
inertia
groups
at
the
various
points
of
X

shows
that
X
→
Y
def
and
X

→
Y
are
linearly
disjoint,
so
(Z
=
X
×Y
X

→
X,
Z
→
X

)
gives
the
desired
nontrivial
correspondence.
§6.
Interpretation
of
a
Theorem
of
Royden
Let
(g,
r)
be
a
pair
of
nonnegative
integers
such
that
2g
−
2
+
r
>
0.
let
Mg,r
denote
the
moduli
stack
of
r-pointed
smooth
(proper)
curves
of
genus
g.
Here,
the
r
marked
points
are
unordered.
(Note
that
this
diﬀers
slightly
from
the
usual
convention.)
The
complement
of
the
divisor
of
marked
points
of
such
a
curve
will
be
a
hyperbolic
curve
of
type
(g,
r).
Thus,
we
shall
also
refer
(by
slight
abuse
of
terminology)
to
(Mg,r
)k
as
the
moduli
stack
of
(hyperbolic)
curves
of
type
(g,
r).
Let
us
refer
to
as
a
correspondence
on
Mg,r
an
(ordered)
pair
of
ﬁnite
étale
morphisms
α
:
E
→
Mg,r
,
β
:
E
→
Mg,r
,
where
E
is
nonempty.
We
shall
call
a
correspondence
(α,
β)
on
Mg,r
trivial
if
α
=
β.
Note
that
this
deﬁnition
of
what
it
means
for
a
“correspondence
on
a
(single)
object”
to
be
trivial
is
a
bit
diﬀerent
from
the
deﬁnition
(Deﬁnition
1.2)
that
we
gave
earlier
for
what
it
means
for
a
“correspondence
from
one
object
to
another
object”
to
be
trivial.
Then
we
have
the
following
result
(essentially
a
consequence
of
a
theorem
of
Royden):
Theorem
6.1.
Suppose
that
2g
−
2
+
r
≥
3.
Then
Mg,r
is
generically
a
scheme,
and
moreover,
does
not
admit
any
nontrivial
automorphisms
or
correspondences.
Proof.
Write
T
for
the
universal
covering
space
of
the
analytic
stack
associated
to
the
algebraic
stack
Mg,r
.
Thus,
T
is
what
is
usually
referred
to
as
“Teichmüller
space.”
Let
us
write
Aut(T
)
for
the
group
of
holomorphic
automorphisms
of
T
,
and
Γ
for
the
fundamental
group
of
the
analytic
stack
associated
to
Mg,r
.
Thus,
we
have
a
natural
morphism
Γ
→
Aut(T
).
According
to
a
theorem
of
Royden
([Gard],
§9.2,
p.
169,
Theorem
2),
this
morphism
is,
in
fact,
an
isomorphism
(under
the
given
hypotheses
on
(g,
r)).
The
injectivity
of
this
morphism
implies
that
Mg,r
is
generically
a
scheme;
the
surjectivity
of
this
morphism
implies
that
Mg,r
has
no
nontrivial
automorphisms.
Moreover,
it
is
a
matter
of
well-known
general
nonsense
(see,
e.g.,
the
discussion
of
[Marg],
p.
337)
that
the
existence
of
a
nontrivial
correspondence
on
Mg,r
would
imply
the
existence
of
an
element

−1
of
Aut(T
)
−
Γ
such
that
Γ
(γ
·
Γ
·
γ
)
has
ﬁnite
index
in
Γ
and
in
γ
·
Γ
·
γ
−1
.
Thus,
we
17
see
that
there
are
no
nontrivial
correspondences
on
Mg,r
.
This
completes
the
proof
of
the
result.
Remark:
Note
that
the
conclusion
of
the
Theorem
is
false
in
the
exceptional
cases
ruled
out
in
the
hypothesis
of
the
Theorem.
Bibliography
[Baily]
W.
L.
Baily,
Jr.,
On
the
Automorphism
Group
of
a
Generic
Curve
of
Genus
>
2,
Journ.
Math.
Kyoto
Univ.
1,
pp.
101-108
(correction
p.
325)
(1961/2).
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer
(1990).
[Gard]
F.
Gardiner,
Teichmüller
Theory
and
Quadratic
Diﬀerentials,
John
Wiley
and
Sons
(1987).
[Marg]
G.
A.
Margulis,
Discrete
Subgroups
of
Semisimple
Lie
Groups,
Ergebnisse
der
Mathematik
under
ihrer
Grenzgebiete
17,
Springer
(1990).
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
to
appear
in
Publ.
RIMS,
Kyoto
Univ.
[Mzk2]
S.
Mochizuki,
The
Generalized
Ordinary
Moduli
of
p-adic
Hyperbolic
Curves,
RIMS
Preprint
1051
(1995).
[Mzk3]
S.
Mochizuki,
Combinatorialization
of
p-adic
Teichmüller
Theory,
RIMS
Preprint
1076
(1996).
[Shi]
G.
Shimura,
Introduction
to
the
Arithmetic
Theory
of
Automorphic
Forms,
Publ.
Math.
Soc.
of
Japan
11,
Iwanami
Shoten
and
Princeton
University
Press
(1971).
[Take]
K.
Takeuchi,
Arithmetic
Fuchsian
Groups
with
Signature
(1;
e),
Journ.
Math.
Soc.
Japan
35,
No.
3,
pp.
381-407
(1983).
18
