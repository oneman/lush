The
Scheme-Theoretic
Theta
Convolution
by
Shinichi
Mochizuki
September
1999
Contents:
Â§0.
Introduction
Â§1.
The
Scheme-Theoretic
Fourier
Transform
Â§2.
Discrete
Gaussians
and
Gauss
Sums
Â§3.
Review
of
Degree
Computations
in
[HAT]
Â§4.
The
Fourier
Transform
of
an
Algebraic
Theta
Function:
The
Case
of
an
EÌtale
Lagrangian
Subgroup
Â§5.
The
Fourier
Transform
of
an
Algebraic
Theta
Function:
The
Case
of
a
Lagrangian
Subgroup
with
Nontrivial
Multiplicative
Part
Â§6.
Generic
Properties
of
the
Norm
Â§7.
Some
Elementary
Computational
Lemmas
Â§8.
The
Various
Contributions
at
Inï¬nity
Â§9.
The
Main
Theorem
Â§10.
The
Theta
Convolution
Â§0.
Introduction
In
this
paper,
we
continue
our
development
of
the
theory
of
the
Hodge-Arakelov
Comparison
Isomorphism
of
[HAT].
Our
main
result
concerns
the
invertibility
of
the
coeï¬ƒcients
of
the
Fourier
transform
of
an
algebraic
theta
function.
Using
this
result,
we
obtain
a
modiï¬ed
version
of
the
Hodge-Arakelov
Comparison
Isomorphism
of
[HAT],
which
we
refer
to
as
the
Theta-Convoluted
Comparison
Isomorphism.
The
signiï¬cance
of
this
modiï¬ed
version
is
that
the
principle
obstruction
to
the
application
of
the
theory
of
[HAT]
to
diophantine
geometry
â€”
namely,
the
Gaussian
poles
â€”
partially
vanishes
in
the
theta-convoluted
context.
Thus,
the
results
of
this
paper
bring
the
theory
of
[HAT]
one
step
closer
to
possible
application
to
diophantine
geometry.
Perhaps
the
simplest
way
to
explain
the
main
idea
of
the
present
paper
is
the
following:
The
theory
of
[HAT]
may
be
thought
of
as
a
sort
of
discrete,
scheme-theoretic
version
of
1
the
theory
of
the
classical
Gaussian
eâˆ’x
(on
the
real
line)
and
its
derivatives
(cf.
[HAT],
Introduction,
Â§2).
The
reason
for
the
appearance
of
the
â€œGaussian
polesâ€
â€”
which,
as
remarked
above,
constitute
the
principle
obstruction
to
the
application
of
the
theory
of
[HAT]
to
diophantine
geometry
â€”
is
that,
if,
for
instance,
P
(âˆ’)
is
a
polynomial
with
constant
coeï¬ƒcients,
then,
at
its
most
fundamental
combinatorial
level,
the
â€œcomparison
isomorphismâ€
of
[HAT]
may
be
thought
of
as
the
mapping
2
P
(âˆ’)
â†’
P
(
2
2
âˆ‚
)
eâˆ’x
=
P
(âˆ’2x)
Â·
eâˆ’x
âˆ‚x
from
a
certain
space
of
polynomials
â€”
which
constitutes
the
de
Rham
side
of
the
comparison
isomorphism
â€”
to
a
certain
space
of
set-theoretic
functions
â€”
which
constitutes
the
eÌtale
side
of
the
comparison
isomorphism.
Roughly
speaking,
in
order
to
make
this
2
morphism
into
an
isomorphism,
it
is
necessary
to
eliminate
the
extra
factor
of
eâˆ’x
on
the
right.
Once
this
extra
factor
is
eliminated,
the
mapping
P
(âˆ’)
â†’
P
(âˆ’2x)
is
â€œmanifestlyâ€
an
isomorphism.
The
approach
of
[HAT]
to
making
this
mapping
into
an
isomorphism
is
to
introduce
poles
into
the
de
Rham
side
of
the
morphism
(i.e.,
the
â€œGaussian
polesâ€),
which
amounts
(relative
to
the
above
discussion)
to
artiï¬cially
tensoring
the
left-hand
side
of
the
morphism
2
2
with
the
â€œsymbolâ€
ex
,
which
then
is
to
map
to
the
â€œfunctionâ€
ex
.
Once
this
operation
2
2
is
performed,
the
right-hand
side
becomes
P
(âˆ’2x)eâˆ’x
Â·
ex
=
P
(âˆ’2x),
so
we
get
an
isomorphism
P
(âˆ’)
â†’
P
(âˆ’2x)
as
desired.
The
problem
with
this
approach
of
[HAT]
is
that
for
diophantine
applications,
one
wishes
to
leave
the
de
Rham
side
of
the
comparison
isomorphism
untouched.
On
the
other
hand,
although
one
wishes
to
modify
the
eÌtale
side,
one
wants
to
modify
it
in
such
a
way
that
the
resulting
modiï¬ed
eÌtale
side
still
admits
a
natural
Galois
action,
which
is
necessary
in
order
to
construct
the
arithmetic
Kodaira-Spencer
morphism
(cf.
[HAT],
Chapter
IX,
Â§3,
as
well
as
Remark
2
following
Theorem
10.1
in
the
present
paper).
In
the
present
paper,
the
approach
that
we
take
may
be
explained
in
terms
of
the
above
discussion
as
follows:
Instead
of
modifying
the
de
Rham
side
of
the
comparison
morphism,
we
modify
the
eÌtale
side
by
â€œtensoring
it
with
the
inverse
of
the
line
bundle
deï¬ned
by
the
image
on
the
eÌtale
side
of
the
element
â€˜1â€™
(on
the
de
Rham
side).â€
Of
course
2
2
this
image
is
simply
eâˆ’x
,
so
dividing
by
this
image
amounts
to
multiplying
by
ex
on
the
eÌtale
side,
thus
giving
us
the
desired
isomorphism
P
(âˆ’)
â†’
P
(âˆ’2x).
Of
course,
in
the
theory
of
[HAT]
and
the
present
paper,
we
are
not
working
literally
with
the
Gaussian
or
even
classical
theta
functions,
but
rather
their
discrete
algebraic
analogues.
Thus,
it
is
not
surprising
that
many
of
the
technical
computations
of
this
paper
involve
certain
discrete
analogues
of
the
classical
Gaussian
on
the
real
line
(cf.
Â§2).
Since
the
correspondence
between
theta
functions
and
Gaussian
is,
in
essence,
that
the
Gaussian
represents
the
Fourier
transform
of
a
theta
function,
multiplying
by
a
Gaussian
corresponds,
at
the
level
of
theta
functions,
to
the
operation
of
convolution.
Thus,
the
operation
which
we
wish
to
perform
(cf.
the
preceding
paragraph)
on
the
eÌtale
side
of
the
comparison
isomorphism
is
to
apply
the
inverse
of
convolution
with
the
theta
function.
In
2
the
present
paper,
we
refer
to
the
operation
of
convolution
with
the
theta
function
as
the
â€œtheta
convolution.â€
Thus,
the
key
technical
result
that
is
necessary
in
order
to
realize
the
philosophical
idea
explained
above
is
a
result
concerning
the
invertibility
of
the
theta
convolution.
Put
another
way,
since
our
theta
functions
(in
the
theory
of
[HAT]
and
the
present
paper)
are
the
algebraic
theta
functions
of
Mumford
(cf.
[Mumf1,2,3]),
we
thus
see
that
the
result
that
we
need
is
a
result
concerning
the
invertibility
of
the
coeï¬ƒcients
of
the
Fourier
transform
of
certain
algebraic
theta
functions.
This
result
is
the
ï¬rst
main
result
of
this
paper
(Theorem
9.1).
We
refer
to
Â§9
for
explicit
technical
details
concerning
its
statement.
In
a
word,
this
result
states
that
the
coeï¬ƒcients
of
the
Fourier
transform
of
certain
algebraic
theta
functions
are
invertible
in
characteristic
0
away
from
the
divisor
at
inï¬nity
(i.e.,
the
locus
where
the
elliptic
curve
in
question
degenerates).
Moreover,
in
mixed
characteristic
and
near
the
divisor
at
inï¬nity,
we
analyze
explicitly
the
extent
to
which
these
coeï¬ƒcients
fail
to
be
invertible.
In
fact,
the
proof
of
this
result
proceeds
precisely
by
comparing
the
degree
of
the
line
bundle
(on
the
moduli
stack
of
elliptic
curves)
of
which
the
norm
of
the
Fourier
transform
(i.e.,
the
product
of
its
coeï¬ƒcients)
is
a
section
to
the
degree
of
the
zero
locus
of
this
norm
in
a
neighborhood
of
the
divisor
at
inï¬nity.
A
rather
complicated
calculation
reveals
that
these
two
degrees
coincide.
This
coincidence
of
degrees
implies
that
the
norm
is
therefore
invertible
(in
characteristic
0)
away
from
the
divisor
at
inï¬nity.
Finally,
we
apply
our
ï¬rst
main
result
to
prove
our
second
main
result,
i.e.,
the
theta-convoluted
comparison
isomorphism
(Theorem
10.1).
Before
proceeding,
we
would
like
to
explain
several
ways
to
think
about
the
contents
of
this
paper.
First
of
all,
the
fact
that
the
coeï¬ƒcients
of
the
Fourier
transform
of
certain
algebraic
theta
functions
are
invertible
away
from
the
divisor
at
inï¬nity
appears
(to
the
knowledge
of
the
author)
to
be
new
(i.e.,
it
does
not
seem
to
appear
in
the
classical
theory
of
theta
functions).
Thus,
one
way
to
interpret
Theorem
9.1
is
as
a
result
which
implies
the
existence
of
certain
interesting,
new
modular
units.
It
would
be
interesting
to
see
if
this
point
of
view
can
be
pursued
further
(cf.
the
Remark
following
Theorem
9.1).
Another
way
to
think
about
the
contents
of
this
paper
is
the
following.
The
classical
representation
of
the
Fourier
expansion
of
a
theta
function
â€”
i.e.,
the
representation
which
states
that
the
Fourier
coeï¬ƒcients
are
essentially
a
â€œGaussianâ€
â€”
arises
from
the
Fourier
expansion
of
the
restriction
of
a
theta
function
to
a
certain
particular
cycle
(or
copy
of
the
circle
S1
)
on
the
elliptic
curve
E
in
question.
More
explicitly,
if
one
thinks
of
this
elliptic
curve
E
as
being
E
=
CÃ—
/q
Z
then
this
special
cycle
is
the
image
of
the
natural
copy
of
S1
âŠ†
CÃ—
.
In
the
present
context,
we
are
considering
discrete
analogues
of
this
classical
complex
theory,
so
instead
of
working
with
this
S1
,
we
work
with
its
d-torsion
points
(for
some
ï¬xed
positive
integer
d),
i.e.,
Î¼d
âŠ†
S1
âŠ†
CÃ—
.
On
the
other
hand,
in
order
to
obtain
a
theory
valid
over
the
entire
moduli
stack
of
elliptic
curves,
we
must
consider
Fourier
expansions
of
theta
functions
restricted
not
just
3
to
this
special
cyclic
subgroup
of
order
d,
i.e.,
Î¼d
âŠ†
E,
(with
respect
to
which
the
Fourier
expansion
is
particularly
simply
and
easy
to
understand),
but
rather
with
respect
to
an
arbitrary
cyclic
subgroup
of
order
d.
Viewed
from
the
classical
complex
theory,
considering
Fourier
expansions
arising
from
more
general
restriction
subgroups
amounts
to
considering
the
functional
equation
of
the
theta
function.
In
the
classical
complex
theory,
Gauss
sums
arise
naturally
in
the
functional
equation
of
the
theta
function.
Thus,
it
is
not
surprising
that
Gauss
sums
(and,
in
particular,
their
invertibility)
also
play
an
important
role
in
the
theory
of
the
present
paper.
In
fact,
returning
to
the
theory
of
the
Gaussian
on
the
real
line,
one
may
recall
that
one
â€œimportant
numberâ€
that
arises
in
this
theory
âˆš
is
the
integral
of
the
Gaussian
(over
the
real
line).
This
integral
is
(roughly
speaking)
Ï€.
On
the
other
hand,
in
the
theory
of
this
paper,
Gaussians
correspond
to
â€œdiscrete
Gaussiansâ€
(cf.
Â§2),
so
integrals
of
Gaussians
correspond
to
â€œGauss
âˆš
sums.â€
That
is
to
say,
Gauss
sums
may
be
thought
of
as
a
sort
of
discrete
analogue
of
Ï€.
Thus,
the
appearance
of
Gauss
sums
in
the
theory
of
this
paper
is
also
natural
from
the
point
of
view
of
the
above
discussion
of
the
â€œmain
ideaâ€
involving
Gaussians.
âˆš
Indeed,
this
discussion
of
discrete
analogues
of
Gaussians
and
Ï€
leads
one
to
suspect
that
there
is
also
a
natural
p-adic
analogue
of
the
theory
of
this
paper
involving
the
p-adic
ring
of
periods
Bcrys
.
Since
this
ring
of
periods
contains
a
certain
copy
of
Zp
(1)
which
may
be
thought
of
as
a
â€œp-adic
analogue
of
Ï€,â€
it
is
thus
natural
to
suspect
that
in
a
p-adic
analogue
of
the
theory
of
this
paper
some
â€œsquare
root
of
this
copy
of
Zp
(1)â€
â€”
and,
in
particular,
its
invertibility
â€”
should
play
an
analogously
important
role
to
the
role
played
by
the
invertibility
of
Gauss
sums
in
the
present
paper.
We
hope
to
develop
such
a
p-adic
theory
in
a
future
paper
(cf.
also
[HAT],
Introduction,
Â§5.1).
Finally,
we
explain
the
contents
of
the
various
Â§â€™s
of
this
paper.
In
Â§1,
we
deï¬ne
and
discuss
the
elementary
properties
of
the
Fourier
transform
of
a
ï¬nite
ï¬‚at
group
scheme.
In
Â§2,
we
discuss
the
â€œdiscrete
Gaussiansâ€
and
their
â€œintegralsâ€
(Gauss
sums)
that
arise
in
the
computations
of
this
paper.
In
Â§3,
we
formalize
the
necessary
technical
details
concerning
the
Fourier
transform
of
an
algebraic
theta
function.
This
formalization
results
in
the
appearance
of
various
degrees
of
line
bundles
and
divisors
on
the
moduli
stack
of
elliptic
curves
which
were
computed
in
[HAT];
in
Â§3,
we
review
these
computations.
In
Â§4,
5,
we
estimate
the
degree
of
vanishing
of
the
norm
of
the
Fourier
transform
of
an
algebraic
theta
function
in
a
neighborhood
of
inï¬nity.
It
turns
out
that
these
computations
diï¬€er
somewhat
depending
on
the
â€œpositionâ€
of
certain
auxiliary
torsion
subgroups
of
the
elliptic
curve
that
are
necessary
in
order
to
deï¬ne
our
Fourier
transform.
Roughly
speaking,
the
necesssary
computations
may
be
separated
into
two
cases
or
parts,
depending
on
the
position
of
these
auxiliary
torsion
subgroups.
The
two
cases
constitute,
respectively,
the
content
of
Â§4,
5.
In
Â§6,
we
investigate
when
the
norm
of
the
Fourier
transform
is
generically
zero.
In
Â§7,
we
perform
certain
complicated
but
elementary
computations
that
we
use
in
Â§8.
These
computations
are
at
the
level
of
high-school
mathematics
and,
in
particular,
have
nothing
to
do
with
arithmetic
geometry.
In
Â§8,
we
combine
the
estimates
of
Â§4,
5,
with
the
computations
of
Â§7
to
show
the
important
â€œcoincidence
of
degreesâ€
discussed
above.
In
Â§9,
we
record
the
consequences
of
this
coincidence
of
degrees,
i.e.,
our
ï¬rst
main
4
result
(Theorem
9.1).
In
Â§10,
we
apply
Theorem
9.1
to
construct
the
theta-convoluted
comparison
isomorphism
(whose
realization
was,
as
explained
above,
the
main
motivation
for
the
theory
of
this
paper).
Â§1.
The
Scheme-Theoretic
Fourier
Transform
In
this
Â§,
we
extend
the
well-known
theory
of
Fourier
analysis
on
ï¬nite
abelian
groups
to
its
â€œschematic
analogue,â€
Fourier
analysis
on
ï¬nite,
ï¬‚at
commutative
group
schemes.
Let
S
be
a
scheme.
Let
Gâ†’S

â†’
S
for
the
Cartier
dual
of
G
be
a
ï¬nite,
ï¬‚at
commutative
group
scheme
over
S.
Write
G

are
the
homomorphisms
([Shz],
Â§4).
Thus,
if
T
is
an
S-scheme,
the
T
-valued
points
of
G
def
GT
(
=
G
Ã—S
T
)
â†’
(Gm
)T
.
Let
f
âˆˆ
Î“(G,
OG
)
be
a
function
on
G.
Then
we
deï¬ne
its
Fourier
transform
f
âˆˆ

)
(where
T
is
an
S
O
)
as
follows:
The
value
of
f
on
a
T
-valued
point
Î³
âˆˆ
G(T
Î“(G,

G
scheme)
is
given
by:
def
f(
Î³)
=

f
Â·
(
Î³
)âˆ’1
GT
/T

Here,
we
think
of

Î³
as
an
(invertible)
function
on
GT
,
and
denote
by
â€œ
GT
/T
â€
the
trace
morphism
OGT
â†’
OT
(which
is
well-deï¬ned
since
G
â†’
S
is
ï¬nite
and
ï¬‚at).
Since
this

O
).
This
deï¬nition
is
functorial
in
T
,
we
thus
obtain
a
well-deï¬ned
element
f
âˆˆ
Î“(G,

G
completes
the
deï¬nition
of
the
Fourier
transform
of
f.
In
the
following,
we
shall
also
write
FG
(f)
(or
F
(f),
when
the
choice
of
G
is
clear)
for
f.
Next,
let
f,
g
âˆˆ
Î“(G,
OG
)
be
two
functions
on
G.
Then
in
addition
to
the
usual
product
f
Â·
g
âˆˆ
Î“(G,
OG
),
we
also
have
the
convolution
(product)
f
âˆ—
g
âˆˆ
Î“(G,
OG
)
of
f,
g,
deï¬ned
by:
def
(f
âˆ—
g)(Î³)
=

f(Î³
Â·
(Î³

)âˆ’1
)
Â·
g(Î³

)
Î³

âˆˆG
5
(for
T
-valued
points
Î³
âˆˆ
G(T
)).
Finally,
let
us
write
I(f)
for
the
function
obtained
by
pulling
f
back
via
the
inversion
morphism
[âˆ’1]
:
G
â†’
G
on
G.
Proposition
1.1.
Suppose
that
G
â†’
S
is
of
constant
rank
|G|,
and
that
the
integer
|G|
is
a
nonzero
divisor
on
S.
Then
we
have:
(i.)
|G|
Â·
I(f)
=
FG
(FG
(f)).
(ii.)
|G|
Â·
FG
(f
Â·
g)
=
FG
(f)
âˆ—
FG
(g).
(iii.)
FG
(f
âˆ—
g)
=
FG
(f)
Â·
FG
(g).
for
any
f
âˆˆ
Î“(G,
OG
).
Proof.
Since
|G|
is
a
nonzero
divisor
on
S,
we
may
assume
without
loss
of
generality
that
|G|
is
invertible
on
S,
and
hence
that
G
â†’
S
is
eÌtale
([Shz],
Â§4,
Corollary
3).
Then
by
replacing
S
by
a
ï¬nite
eÌtale
cover
of
S,
we
may
assume
that
G
â†’
S
is
of
the
form
Î“
Ã—
S,
where
Î“
is
a
ï¬nite
abelian
group
(in
the
category
of
sets).
In
this
case,
the
stated
identities
are
well-known
(cf.,
e.g.,
[DyMc],
Â§4.5).

Now
let
us
suppose
that
we
have
an
exact
sequence
0â†’H
â†’Gâ†’K
â†’0
of
ï¬nite,
ï¬‚at
commutative
group
schemes
over
S.
Taking
Cartier
duals,
we
obtain
an
exact
sequence

â†’G
â†’H

â†’0
0â†’K
If
f
âˆˆ
Î“(K,
OK
)
is
a
function
on
K,
then
by
pull-back,
we
obtain
a
function
f|G
âˆˆ
Î“(G,
OG
),
which
we
also
denote
by
ResG
K
(f).
Now
suppose
that
K
â†’
S
is
of
constant
rank
|K|,
and
that
the
integer
|K|
is
a
nonzero
def
divisor
on
S.
Then
it
follows
that
over
SK
=
S[|K|âˆ’1
],
K|SK
â†’
SK
is
eÌtale,
hence
that
H|SK
is
open
and
closed
in
GSK
.
Now
suppose
that
f
âˆˆ
Î“(H,
OH
)
is
a
function
on
H,
and
that
f
âˆˆ
Î“(G,
OG
)
is
a
function
on
G
such
that
f|H
=
f,
and,
moreover,
that
f|SK
vanishes
on
the
open
and
closed
subscheme
GSK
\HSK
âŠ†
GSK
.
Then
we
shall
write
IndG
H
(f)

Thus,
IndG
(f)
is
the
result
of
â€œextending
f
by
zeroâ€
to
a
function
on
G.
Note
that
for
f.
H
such
an
f
is
necessarily
unique
(since
SK
is
schematically
dense
in
S,
and
f
is
uniquely
determined
on
HSK
and
GSK
\HSK
).
6
Proposition
1.2.
Suppose
that
G
â†’
S
is
of
constant
rank
|G|,
and
that
the
integer
|G|
is
a
nonzero
divisor
on
S.
Then:

(F
(f)).
G
(i.)
For
any
f
âˆˆ
Î“(K,
OK
),
we
have:
FG
(ResG
K
(f))
=
|H|
Â·
IndK

K
G
(ii.)
For
any
f
âˆˆ
Î“(H,
OH
)
such
that
IndG
H
(f)
exists,
we
have:
FG
(IndH
(f))
=

(F
(f)).
ResG

H
H
(iii.)
In
particular,
if
1G
is
the
constant
function
1
on
G,
and
Î´0,G
is
the
â€œdelta
distribution
at
the
originâ€
(i.e.,
the
function
â€“
deï¬ned
after
one
inverts
|G|
â€“
which
is
1
at
the
origin
and
0
elsewhere),
then
FG
(1G
)
=
|G|
Â·
Î´0,G
.
,
and
FG
(Î´0,G
)
=
1G
Proof.
Just
as
in
the
proof
of
Proposition
1.1,
it
suï¬ƒces
to
verify
the
result
under
the
assumption
that
G
is
of
the
form
Î“Ã—
S,
where
Î“
is
a
ï¬nite
abelian
group
of
order
invertible
on
S.
But
in
this
case,
the
result
is
well-known
(cf.,
e.g.,
[DyMc],
Â§4.5).

Â§2.
Discrete
Gaussians
and
Gauss
Sums
One
of
the
key
fundamental
results
in
classical
Fourier
analysis
on
the
real
line
âˆš
is
that
the
Fourier
transform
of
a
Gaussian
is
(up
to
a
factor
which
typically
involves
Ï€)
a
Gaussian.
In
this
Â§,
we
examine
the
discrete
analogue
of
this
phenomenon.
Here,
the
discrete
analogue
of
a
classical
Gaussian
is
a
â€œdiscrete
Gaussian,â€
while
the
discrete
analogue
of
the
factor
that
appears
when
one
applies
the
Fourier
transform
is
a
Gauss
sum.
We
maintain
the
notations
of
Â§1.
Here,
we
assume
further
that
the
group
scheme
G
is
(noncanonically)
isomorphic
to
Z/N
Z,
for
some
positive
integer
N
which
is
invertible
on
S.
In
the
following,
we
assume
that
some
particular
isomorphism
Gâˆ¼
=
(Z/NZ)
Ã—
S
has
been
chosen.
Note
that
the
choice
of
such
an
isomorphism
endows
G
with
a
structure
of
â€œring
schemeâ€
(i.e.,
arising
from
the
ring
structure
of
Z/N
Z).
In
particular,
if
Î³
âˆˆ
G(S),
then
we
shall
write
(for
i
âˆˆ
Zâ‰¥1
)
iÂ·Î³
(respectively,
Î³
i
)
for
the
result
of
adding
(respectively,
multiplying)
â€”
i.e.,
relative
to
this
ring
scheme
structure
â€”
Î³
to
(respectively,
by)
itself
a
total
of
i
times.
Often,
by
abuse
of
notation,
we
shall
simply
write
Î³
âˆˆ
G
for
the
N
elements
of
G(S)
deï¬ned
by
Z/N
Z.
Let
Ï‡
:
G
â†’
Gm
be
a
faithful
character
of
the
group
scheme
G.
Then
consider
the
function
7
Ïˆ
:
G
â†’
Gm
def
deï¬ned
by
Ïˆ(Î³)
=
Ï‡(Î³
2
).
Deï¬nition
2.1.
Such
a
function
Ïˆ
on
G
(deï¬ned
for
some
Ï‡
as
above)
will
be
referred
to
as
a
discrete
Gaussian
(on
G).
In
the
following,
we
would
like
to
consider
the
Fourier
transform
of
a
discrete
Gaussian
and
show
that
this
Fourier
transform
is
essentially
another
discrete
Gaussian
(times
a
certain
Gauss
sum).
Let
us
ï¬rst
observe
that
since
Ï‡
is
faithful,
the
characters
of
G
are
all
of
the
form
Î³
â†’
Ï‡(c
Â·
Î³),
for
some
c
âˆˆ
Z/N
Z.
Let
us
then
compute
the
Fourier
coeï¬ƒcient
of
Ïˆ
for
the
character
Ï‡c
corresponding
to
an
even
c
=
2c
(where
c
âˆˆ
Z/N
Z):


Ï‡(Î³
2
âˆ’
2c
Â·
Î³)
Î³âˆˆG


2
Ï‡((Î³
âˆ’
c
)2
)
=
Ï‡(âˆ’(c
)
)
Â·
Î³âˆˆG

=
Ï‡(âˆ’(c
)2
)
Â·
Ï‡(Î³
2
)
Ïˆ(Î³)
Â·
Ï‡(âˆ’c
Â·
Î³)
=
Î³âˆˆG
Î³âˆˆG
Write
def

G(Ï‡,
N)
=
Ï‡(Î³
2
)
Î³âˆˆG
for
the
Gauss
sum
deï¬ned
by
Ï‡.
Then
the
above
calculation
shows
in
particular
that
for
N
odd
(in
which
case
all
c
may
be
written
as
c
=
2c
),
the
Fourier
transform
F
(Ïˆ)
is
the
function
Ï‡c
â†’
G(Ï‡,
N)Â·
Ï‡(âˆ’
14
Â·
c2
).
This
function
is
clearly
a
constant
(=
G(Ï‡,
N))
multiple
of
a
discrete
Gaussian.
Next,
we
consider
the
more
complicated
case
when
N
is
even.
When
N
is
even,
we
shall
write
N
=
2M.
First,
let
us
suppose
that
N
is
divisible
by
4.
In
this
case,
every
Î³
âˆˆ
Z/N
Z
satisï¬es:
(Î³
+
M)2
â‰¡
Î³
2
+
2M
Â·
Î³
+
M
2
â‰¡
Î³
2
(modulo
N
).
Thus,
it
follows
that
the
function
Ïˆ
on
G
âˆ¼
=
Z/N
Z
is
obtained
by
pulling
back
a
function
on
G/M
Â·
G
âˆ¼
Z/MZ
via
the
natural
projection
G
â†’
G/M
Â·
G.
In
particular,
it
=
follows
from
Proposition
1.2,
(i.),
that
the
Fourier
coeï¬ƒcients
of
Ïˆ
are
zero
for
odd
c
(i.e.,
c
which
cannot
be
written
in
the
form
c
=
2c
).
Thus,
we
see
that
the
above
calculation
8
implies
that
the
Fourier
transform
F
(Ïˆ)
in
this
case
is
the
result
of
extending
by
zero
a

âŠ†G

whose
pull-back
to
constant
(=
G(Ï‡,
N))
multiple
of
a
function
on
Z/MZ
âˆ¼
=
2Â·G
Z/N
Z
is
a
discrete
Gaussian
on
Z/N
Z.
Deï¬nition
2.2.
If
N
is
divisible
by
4,
and
Ïˆ
is
a
function
on
G/MG
whose
pull-back
to
G
is
a
discrete
Gaussian
Ïˆ
on
G,
then
we
shall
refer
to
Ïˆ
as
a
reduced
discrete
Gaussian
on
G/MG.
If
N
is
odd,
then
we
will
also
refer
to
arbitrary
discrete
Gaussians
(as
in
Deï¬nition
2.1)
as
reduced
discrete
Gaussians.
Finally,
we
consider
the
case
of
odd
M.
In
this
case,
every
Î³
âˆˆ
Z/N
Z
satisï¬es:
(Î³
+
M)2
â‰¡
Î³
2
+
2M
Â·
Î³
+
M
2
â‰¡
Î³
2
+
M
(modulo
N
).
In
particular,
it
follows
from
Proposition
1.2,
(i.),
that
the
Fourier
coeï¬ƒcients
of
Ïˆ
are
zero
for
even
c
(i.e.,
c
which
can
be
written
in
the
form
c
=
2c
).
Thus,
we
must
compute
the
coeï¬ƒcients
for
odd
c
=
2c
+
M
(where
we
note
that
since
M
is
odd,
we
may
take
c
to
be
even):


Ï‡(Î³
2
âˆ’
2c
Â·
Î³
âˆ’
M
Â·
Î³)
Î³âˆˆG


2
Ï‡((Î³
âˆ’
c
)2
+
M
Â·
Î³)
=
Ï‡(âˆ’(c
)
)
Â·
Î³âˆˆG

Ï‡(Î³
2
+
M
Â·
Î³)
=
Ï‡(âˆ’(c
)2
)
Â·
Ïˆ(Î³)
Â·
Ï‡(âˆ’c
Â·
Î³)
=
Î³âˆˆG
Î³âˆˆG
Moreover,



Ï‡(Î³
+
M
Â·
Î³)
=
Ï‡(Î³
)
âˆ’
2
Î³âˆˆG
2
Î³âˆˆ2Â·G
Ï‡((Î³
+
M)2
)


Î³âˆˆ2Â·G
Ï‡(Î³
2
)
âˆ’
=
Î³âˆˆ2Â·G
Î³âˆˆ2Â·G

=2Â·
Ï‡(Î³
2
+
2M
Â·
Î³
+
M
2
)
Ï‡(Î³
2
)
Î³âˆˆ2Â·G
2
=
2
Â·
G(Ï‡
,
M)
(where
we
note
that
since
Ï‡
is
faithful,
we
have
Ï‡(M
2
)
=
Ï‡(M)
=
âˆ’1).
Next,
let
us
recall
from
the
computations
of
Gauss
sums
in
[Lang],
pp.
86-87,
that
we
have
G(Ï‡2
,
M)
=
Ï‡2
,M
Â·
9
âˆš
M
=0
where
4Ï‡2
,M
=
1.
Similarly,
if
N
is
odd,
then
we
have
G(Ï‡,
N)
=
Ï‡,N
Â·
âˆš
N
=0
where
4Ï‡,N
=
1.
Finally,
if
N
is
even,
then
we
have
G(Ï‡,
N)
=
Ï‡,N
Â·
(1
+
i)
Â·
where
4Ï‡,N
=
1,
i
=
âˆš
âˆš
N
=0
âˆ’1.
Thus,
we
see
that
we
have
proven
the
following
result:
def
Proposition
2.3.
Let
Ï‡
:
G
â†’
Gm
be
a
faithful
character.
Let
Ïˆ(Î³)
=
Ï‡(Î³
2
)
be
the
discrete
Gaussian
on
G
associated
to
Ï‡.
For
c
âˆˆ
Z/N
Z,
write
Ï‡c
for
the
character
def
G
â†’
Gm
deï¬ned
by
Ï‡c
(Î³)
=
Ï‡(c
Â·
Î³).
Then:
(i.)
Suppose
that
N
is
odd.
Then
1
{F
(Ïˆ)}(Ï‡c
)
=
G(Ï‡,
N)
Â·
Ï‡(âˆ’
Â·
c2)
4
âˆš
N
=
0
(and
4Ï‡,N
=
1).
Thus,
F
(Ïˆ)
is
equal
to

a
nonzero
multiple
of
a
discrete
Gaussian
on
G.
def

where
G(Ï‡,
N)
=
Î³âˆˆG
Ï‡(Î³
2
)
=
Ï‡,N
Â·
(ii.)
Suppose
that
N
=
2M
is
even,
but
M
is
odd.
Then
{F
(Ïˆ)}(Ï‡c
)
=
0
if
c
âˆˆ
2Z/N
Z.
If
c
=
2c
+
M
for
c
âˆˆ
2Z/N
Z,
then
{F
(Ïˆ)}(Ï‡c
)
=
2
Â·
G(Ï‡2
,
M)
Â·
Ï‡(âˆ’(c
)2
)
âˆš
M
=
0
(and
4Ï‡2
,M
=
1).
Thus,
F
(Ïˆ)
is

of
the
extension
by
zero
of
equal
to
a
nonzero
multiple
of
the
translate
by
M
âˆˆ
Z/N
Z
âˆ¼
=G

(âŠ†
G).

a
discrete
Gaussian
on
2
Â·
G
def

where
G(Ï‡2
,
M)
=
2
Î³âˆˆ2Z/N
Z
Ï‡(Î³
)
=
Ï‡2
,M
Â·
(iii.)
Suppose
that
N
=
2M
and
M
are
even.
Then
{F
(Ïˆ)}(Ï‡c
)
=
0
if
c
âˆˆ
(2Z
+
M)/NZ.
If
c
=
2c
for
c
âˆˆ
Z/N
Z,
then
{F
(Ïˆ)}(Ï‡c
)
=
G(Ï‡,
N)
Â·
Ï‡(âˆ’(c
)2
)
âˆš
âˆš
2
4
Ï‡(Î³
)
=

Â·
(1
+
i)
N
=
0
(and

=
1,
i
=
âˆ’1).
Thus,
Ï‡,N
Ï‡,N
Î³âˆˆG
âˆ¼
F
(Ïˆ)
is
equal
to
a
nonzero
multiple
of
the
extension
by
zero
of
a
function
on
2
Â·
G
=
Z/MZ
whose
pull-back
to
Z/N
Z
is
a
discrete
Gaussian
on
Z/N
Z.
def

where
G(Ï‡,
N)
=
Thus,
in
summary,
â€œthe
Fourier
transform
of
a
reduced
discrete
Gaussian
is
itself
a
nonzero
multiple
(i.e.,
by
a
certain
Gauss
sum)
of
a
reduced
discrete
Gaussian.â€
10
Remark.
Frequently,
we
will
work
with
ï¬nite,
ï¬‚at
group
schemes
G
of
order
N
over
bases
where
N
is
not
necessarily
invertible,
or
with
ï¬nite,
eÌtale
group
schemes
which
are
eÌtale
locally,
but
not
necessarily
globally,
isomorphic
to
Z/N
Z.
In
these
cases,
we
shall
also
refer
to
functions
on
G
as
(reduced)
discrete
Gaussians
if
they
become
(reduced)
discrete
Gaussians
as
in
Deï¬nition
2.2
after
N
is
inverted,
and
a
suitable
isomorphism
with
Z/N
Z
is
chosen
over
some
eÌtale
covering
of
the
original
base.
Â§3.
Review
of
Degree
Computations
in
[HAT]
The
purpose
of
this
Â§
is
to
review
various
aspects
of
the
theory
of
[HAT]
in
characteristic
0,
and
to
explain
the
fundamental
set-up
of
the
theory
of
the
present
paper.
Let
S
log
be
a
Z-ï¬‚at
ï¬ne
noetherian
log
scheme.
Let
us
assume
that
we
are
given
a
log
elliptic
curve
(cf.
[HAT],
Chapter
III,
Â§1.1)
C
log
â†’
S
log
over
S
log
which
is
smooth
over
a
schematically
dense
open
subscheme
of
S.
It
thus
follows
that
the
â€œdivisor
at
inï¬nityâ€
(i.e.,
the
pull-back
via
the
associated
classifying
morphism
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
)
is
a
Cartier
divisor
D
âŠ†
S.
Thus,
just
as
in
[HAT],
Chapter
IV,
Â§4,5,
we
have
a
stack
Sâˆ
obtained
from
S
by
adjoining
the
roots
of
the
qparameters
at
the
locus
D
âŠ†
S
over
which
C
log
â†’
S
log
degenerates.
Over
Sâˆ,
we
have
the
smooth
group
scheme
f
:
Eâˆ,S
â†’
Sâˆ
whose
connected
components
at
the
points
of
bad
reduction
are
in
natural
one-to-one
correspondence
with
Q/Z.
The
metrized
line
bundles
of
[Zh]
may
be
thought
of
as
living
on
Eâˆ,S
.
Let
m,
d
be
positive
integers
such
that
m
does
not
divide
d.
Let
Î·
âˆˆ
Eâˆ,S
(Sâˆ
)
be
a
torsion
point
of
order
m.
Then
in
[HAT],
Chapter
V,
Â§1,
we
associated
to
this
data
certain
metrized
line
bundles
Lst,Î·
,
In
the
following
discussion,
we
will
denote
by
11
ev
Lst,Î·
L
ev
the
metrized
line
bundle
Lst,Î·
(respectively,
Lst,Î·
)
if
d
is
odd
(respectively,
even).
Note
that
the
push-forward
fâˆ—
L
of
this
metrized
line
bundle
to
Sâˆ
deï¬nes
a
metrized
vector
bundle
on
Sâˆ
.
Moreover,
this
metrized
line
bundle
admits
the
action
of
a
certain
natural
theta
group
scheme
GL
(cf.
[HAT],
Chapter
IV,
Â§5).
Next,
let
us
assume
that
we
are
given
ï¬nite,
ï¬‚at
(i.e.,
over
Sâˆ)
subgroup
schemes
G,
H
âŠ†
Eâˆ,S
which
are
eÌtale
locally
isomorphic
to
Z/dZ
in
characteristic
0
(i.e.,
after
tensoring
with
Q),
and
which
satisfy
H
Ã—
G
=
d
Eâˆ,S
âŠ†
Eâˆ,S
(where
d
Eâˆ,S
is
the
kernel
of
multiplication
by
d
on
Eâˆ,S
).
We
shall
refer
to
G
as
the
restriction
subgroup
(since
its
principal
use
will
be
as
a
collection
of
points
to
which
we
will
restrict
sections
of
L),
and
H
as
the
Lagrangian
subgroup
(since
its
primary
use
will
be
to
descend
L
â€”
cf.
[HAT],
Chapter
IV,
Theorem
1.4).
In
the
following
discussion,
we
would
like
to
consider
the
Fourier
transforms
of
restrictions
of
sections
of
L
to
G.
If
d
is
odd,
then
the
datum
of
G
is
suï¬ƒcient
for
this
purpose.
If,
however,
d
is
even,
then
in
order
to
take
the
Fourier
transform
of
a
restricted
section,
we
need
a
canonical
trivialization
of
the
restriction
L|G
.
Recall,
however,
from
[HAT],
Chapter
IV,
Theorem
1.6,
that
we
only
have
such
a
canonical
trivialization
over
2
Â·
G,
not
over
all
of
G.
Thus,
in
the
case
that
d
is
even,
we
must
assume
that
we
are
also
given
the
def
âˆ,S
def
=
Eâˆ,S
/(d0
Â·
G),
where
d0
=
12
d.
Thus,
following
data:
First
of
all,
let
us
write
E
âˆ,S
factors
into
a
composite
of
two
morphisms
of
the
multiplication
by
2
morphism
on
E
degree
2:
âˆ,S
=
Eâˆ,S
/(d0
Â·
G)
âˆ,S
â†’
Eâˆ,S
â†’
E
E
âˆ,S
surjects
onto
d0
Â·G
âŠ†
Eâˆ,S
.
Thus,
it
follows
by
elementary
Moreover,
the
2-torsion
of
E
group
theory
that
G
âŠ†
Eâˆ,S
is
contained
in
the
image
of
the
d-torsion
of
Eâˆ,S
.
Write
def

âŠ†
E
âˆ,S
for
the
inverse
image
of
G
âŠ†
Eâˆ,S
in
E
âˆ,S
,
and
G
âˆ,S
â†’
G
=
Ker(E

E/E
âˆ,S
.
Then
we
have
an
exact
sequence
Eâˆ,S
)
âŠ†
E

0
â†’
GE/E

â†’Gâ†’Gâ†’0
of
ï¬nite,
ï¬‚at
group
schemes
over
Sâˆ
which
are
annihilated
by
d.
Then
in
the
even
case,
we
assume
that
we
given
the
following
additional
data:
12

that
splits
the
above
exact
sequence
(i.e.,
a
subgroup
scheme
Gspl
âŠ†
G
maps
isomorphically
onto
G).
âˆ,S
,
the
resulting
metrized
line
bundle
If
we
pull
the
metrized
line
bundle
L
back
to
E
L|E
has
degree
2d,
hence
admits
(by
[HAT],
Chapter
IV,
Theorem
1.6)
a
canonical
âˆ,S
âˆ,S
annihilated
by
d
â€”
in
particular,
over
trivialization
over
any
subgroup
scheme
of
E
Gspl
.
Moreover,
it
follows
(from
[HAT],
Chapter
IV,
Theorem
1.6,
(2))
that
if
we
modify
the
splitting
Gspl
by
some
homomorphism
Î±
:
G
â†’
GE/E

,
then
the
resulting
trivialization
diï¬€ers
from
the
trivialization
corresponding
to
the
given
Gspl
by
a
factor
given
by
the
â†’
Î¼2
(which
is
function
Î²
â—¦
Î±
:
G
â†’
Î¼2
,
for
some
ï¬xed
homomorphism
Î²
:
GE/E

independent
of
Î±).
Remark.
Suppose
just
for
the
remainder
of
this
Remark
that
S
is
of
characteristic
0.
Since
GE/E

is
a
ï¬nite
eÌtale
group
scheme
of
rank
2
over
Sâˆ
,
GE/E

is
abstractly
isomorphic
to
{Â±1}
âˆ¼
=â€
holds
since
we
are
in
characteristic
zero).
Moreover,
I
claim
=
Î¼2
(where
the
â€œâˆ¼
that
Î²
is
the
unique
isomorphism
between
GE/E

and
Î¼2
.
Indeed,
if
this
were
not
the
case,
then
Î²
would
be
trivial,
and
we
would
obtain
that
the
trivialization
of
L|Gspl
=
L|G
is
independent
of
the
choice
of
splitting
Gspl
.
Moreover,
if
the
trivialization
is
independent
of
the
splitting
for
this
particular
choice
of
G,
then
it
follows
(by
considering
the
action
of
Galois
on
G
in
the
universal
case,
i.e.,
ï¬nite
eÌtale
coverings
of
the
moduli
stack
(M1,0
)Q
)
that
this
holds
for
all
G.
On
the
other
hand,
if
this
holds
for
all
G,
then
it
would
follow
that
the
canonical
section
of
[HAT],
Chapter
IV,
Theorem
1.6,
extends
to
a
section
deï¬ned
over
KL
(i.e.,
not
just
2
Â·
KL
)
whose
image
is
contained
in
the
subscheme
SL
of
symmetric
elements.
Also,
let
us
observe
that
since
the
image
of
this
extended
section
lies
in
SL
,
it
follows
(by
the
same
argument
as
that
used
to
prove
the
latter
part
of
[HAT],
Chapter
IV,
Theorem
1.6,
(2))
that
the
formula
â€œ{Ïƒ(a+b)Â·Ïƒ(a)âˆ’1
Â·Ïƒ(b)âˆ’1
}2
=
[a,
b]â€
of
[HAT],
Chapter
IV,
Theorem
1.6,
(2),
also
applies
to
this
extended
section.
But
this
implies
that
the
Weil
pairing
[âˆ’,
âˆ’]
on
d-torsion
points
of
the
universal
elliptic
curve
over
(M1,0
)Q
admits
a
square
root,
which
is
absurd.
(Indeed,
the
ï¬eld
of
constants
in
(i.e.,
algebraic
closure
of
Q
in)
the
ï¬eld
of
deï¬nition
of
these
d-torsion
points
in
the
universal
case
is
Q(e2Ï€i/d
),
but
the
existence
of
such
a
square
root
would
imply
that
Q(e2Ï€i/2d
)
âŠ†
Q(e2Ï€i/d
),
which
is
false,
since
d
is
even.)
This
completes
the
proof
of
the
claim.
The
purpose
of
the
above
Remark
was
to
convince
the
reader
that
the
introduction
of
the
splitting
Gspl
is,
in
fact,
unavoidable.
Thus,
one
way
to
summarize
the
above
discussion
in
a
fashion
which
is
independent
of
the
choice
of
splitting
Gspl
is
the
following:
There
is
a
natural
Hom(G,
Î¼2
)-torsor
T2
â†’
Sâˆ
13
determined
by
Eâˆ,S
,
G,
which
is
nontrivial
in
general.
Moreover,
over
T2
,
the
restriction
L|G
admits
a
canonical
trivialization.
Thus,
at
any
rate,
if
we
assume
that
we
are
given
a
splitting
Gspl
whenever
d
is
even,
then
regardless
of
the
parity
of
d,
we
obtain
(cf.
[HAT],
Chapter
IX,
Â§3)
a
natural
isomorphism
L|G
âˆ¼
=
OG
âŠ—OSâˆ
K
def
where
K
=
L|e
is
the
restriction
of
L
to
the
identity
section
âˆˆ
Eâˆ,S
(Sâˆ
).
Similarly,
(since
our
assumptions
on
G
and
H
are
identical)
if
we
assume
that
we
are
given
a
splitting
Hspl
of
the
analogous
exact
sequence
for
H

0
â†’
HE/E

â†’Hâ†’Hâ†’0
whenever
d
is
even,
then
regardless
of
the
parity
of
d,
we
obtain
(cf.
[HAT],
Chapter
IX,
Â§3)
a
natural
subgroup
scheme
H
âŠ†
GL
which
is
Lagrangian
in
the
sense
of
[MB],
Chapitre
V,
DeÌï¬nition
2.5.1.
Note
that:
(1)
After
possibly
replacing
S
by
a
ï¬nite
ï¬‚at
cover,
such
an
Hspl
always
exists.
(2)
Unlike
in
[HAT],
Chapter
IV,
Â§1,
we
do
not
assume
that
H
is
isomorphic
either
to
Z/dZ
or
Î¼d
over
S.
Let
us
write
def
EâˆH
,S
=
Eâˆ,S
/H
for
the
quotient
of
Eâˆ,S
by
H.
Thus,
we
have
a
natural
isogeny
Eâˆ,S
â†’
EâˆH
,S
.
Moreover,
since
we
have
a
lifting
H
âŠ†
GL
of
H,
we
also
get
a
natural
metrized
line
bundle
LH
on
EâˆH
,S
that
descends
L.
Write
fH
:
EâˆH
,S
â†’
Sâˆ
for
the
structure
morphism
of
EâˆH
,S
.
Note
that
the
relative
degree
(i.e.,
with
respect
to
fH
)
of
LH
is
1.
Thus,
it
follows
that
(fH
)âˆ—
LH
is
a
metrized
line
bundle
on
Sâˆ
.
Write
M
=
{(fH
)âˆ—
LH
}âˆ’1
def
Next,
let
us
observe
that
if
we
compose
the
Fourier
transform
FG
(tensored
with
K)
discussed
in
Â§1
with
the
trivialization
isomorphism
L|G
âˆ¼
=
OG
âŠ—OSâˆ
K
reviewed
above,
we
get
a
morphism
14
L|G
â†’
OG

âŠ—OSâˆ
K
If
we
then
compose
this
morphism
with
the
morphism
obtained
by
restricting
sections
of
LH
(ï¬rst
to
Eâˆ,S
and
then)
to
G,
we
obtain
a
morphism
E
:
Mâˆ’1
â†’
OG

âŠ—OSâˆ
K
which
maps
a
section
of
LH
to
the
Fourier
expansion
of
the
corresponding
algebraic
theta
function.
This
â€œtheta
Fourier
expansion
morphismâ€
is
the
main
topic
of
the
present
paper.
Note
that
since
OG

has
a
natural
OSâˆ
-algebra
structure,
it
makes
sense
to
speak
of
the
norm
of
a
section
of
OG
.
Thus,
this
norm
will
form
a
section
of
OSâˆ
.
In
particular,
if
we
take
the
norm
of
E,
we
obtain
a
section
Î½
âˆˆ
Î“(Sâˆ
,
MâŠ—d
âŠ—
KâŠ—d
)
The
main
technical
goal
of
the
present
paper
is
to
show
that
Î½
is
invertible
on
the
interior
US
âŠ†
Sâˆ
of
Sâˆ
(i.e.,
the
open
subscheme
where
the
log
structure
is
trivial).
This
goal
will
be
achieved
by
computing
the
order
of
the
zeroes
of
Î½
at
the
points
at
inï¬nity,
and
comparing
the
sum
of
these
orders
to
the
degree
of
the
metrized
line
bundle
MâŠ—d
âŠ—
KâŠ—d
(in
the
universal
case,
i.e.,
when
the
base
is
given
by
the
moduli
stack
of
log
elliptic
curves
â€”
note
that
over
such
a
base,
the
notion
of
â€œdegreeâ€
makes
sense),
which
is
given
by
Propositions
3.1,
3.2,
below.
It
turns
out
that
these
two
numbers
coincide.
This
will
def
suï¬ƒce
to
show
that
Î½
is
invertible
on
the
interior
US
=
S
âˆ’
D.
Remark.
If
we
change
the
choice
of
splitting
Gspl
,
then
the
resulting
trivialization
gets
multiplied
(cf.
the
above
discussion)
by
some
character
G
â†’
Î¼2
.
The
eï¬€ect
of
such
a
multiplication
on
the
Fourier
transform
(cf.
Proposition
1.1,
(ii.))
is
given
by
the
automorphism
of
OG

induced
by
translation
by
this
character
G
â†’
Î¼2
(regarded
as

=
Hom(G,
Gm
)).
Clearly,
the
norm
is
unaï¬€ected
by
such
automoran
element
of
G
phisms.
In
particular,
the
norm
Î½
is
independent
of
the
choice
of
splitting.
One
way
to
summarize
this
observation
in
a
way
that
does
not
involve
Gspl
explicitly
is
the
following:
The
Hom(G,
Î¼2
)-torsor
T2
â†’
Sâˆ
discussed
above
deï¬nes
(via
the
natural
inclusion

a
natural
G-torsor

Hom(G,
Î¼2
)
â†’
Hom(G,
Gm
)
=
G)
TG

â†’
Sâˆ
Moreover,
the
Fourier
transform
of
a
section
of
L|G
is
naturally
given
by
an
element
of
OT
âŠ—OSâˆ
K.
G

For
the
remainder
of
this
Â§,
let
us
assume
that
S
is
a
smooth,
proper
(not
necessarily
connected)
one-dimensional
scheme
over
C
(the
complex
number
ï¬eld
â€”
in
fact,
any
ï¬eld
15
of
characteristic
zero
will
do).
Also,
let
us
assume
that
the
log
structure
of
S
log
arises
from
a
ï¬nite
number
of
points.
For
simplicity,
we
assume
that
C
log
â†’
S
log
degenerates
at
all
the
points
at
which
the
log
structure
of
S
log
is
nontrivial.
Recall
from
[HAT],
Chapter
IV,
Â§5,
that,
under
these
assumptions,
it
makes
sense
to
consider
the
degree
of
a
metrized
vector
bundle
on
Sâˆ
,
and
from
[HAT],
Chapter
V,
Proposition
1.1,
that:
1
Proposition
3.1.
We
have:
deg(M)
=
24d
(d
âˆ’
1)
Â·
log(q).
Remark.
Just
as
in
[HAT],
degrees
will
always
be
expressed
in
â€œlog(q)â€
units,
i.e.,
those
units
for
which
the
divisor
at
inï¬nity
of
the
moduli
stack
(M1,0
)C
has
degree
1.
Proof.
Since
we
are
working
here
with
â€œH-invariantsâ€
(cf.
[HAT],
Chapter
IV,
Theorem
1.4)
of
the
push-forward
that
appears
in
[HAT],
Chapter
V,
Proposition
1.1,
the
degree
of
Mâˆ’1
is
1d
times
the
degree
appearing
in
loc.
cit.

1
Proposition
3.2.
We
have:
deg(MâŠ—d
âŠ—
KâŠ—d
)
=
24
(d
âˆ’
1)
Â·
log(q)
+
d
Â·
[L
Â·
e].
Moreover,
[L
Â·
e]
=
0
if
d
is
odd,
and
1
1
1

1

=âˆ’
Â·
{Ï†1
(âˆ’d
Â·
Î·Î¹
+
)
Â·
log(q)
=
âˆ’
Â·
{Ï†1
(âˆ’d
Â·
Î·Î¹
+
)
âˆ’
Ï†1
(âˆ’d
Â·
Î·Î¹
)}
Â·
log(q)
d
Î¹
2
d
Î¹
2
if
d
is
even.
(Here,
Î·Î¹
denotes
the
element
of
Q/Z
(i.e.,
the
connected
component
of
the
special
ï¬ber
of
Eâˆ,S
â†’
Sâˆ)
deï¬ned
at
the
point
at
inï¬nity
Î¹
by
the
torsion
point
1
Î·
âˆˆ
Eâˆ,S
(Sâˆ
),
and
Ï†1
(Î¸)
=
12
Î¸2
âˆ’
12
|Î¸|
+
12
(for
|Î¸|
â‰¤
12
)
is
the
function
of
[HAT],
Chapter
IV,
Proposition
4.4.)
Proof.
It
remains
only
to
remark
that
the
computation
of
[L
Â·
e]
follows
from
[HAT],
Chapter
V,
Proposition
1.2.

The
computation
underlying
the
coincidence
of
degrees
referred
to
above
is
quite
complicated
and
forms
the
topic
of
Â§4-8.
One
of
the
ingredients
that
we
will
need
in
this
computation
is
(a
certain
consequence
of)
the
rather
complicated
degree
computation
carried
out
in
[HAT],
Chapter
VI,
Â§3.
For
d
a
positive
integer
â‰¤
d,
let
us
consider
the
sums
(cf.
the
computation
in
the
proof
of
[HAT],
Chapter
VI,
Theorem
3.1,
which
corresponds
to
the
case
d
=
d)


def
Z(d,
d
,
m)
=
d


1
Î¹
j=1
d
Â·
cj
(Case
XÎ¹
)
Â·
log(q)
(where,
just
as
in
[HAT],
sums
over
Î¹
are
to
be
interpreted
as
averages,
in
keeping
with
the
principle
that
everything
is
to
be
in
â€œlog(q)
unitsâ€).
Put
another
way,
this
number
is
the
16
sum
of
the
d
smallest
exponents
of
q
that
appear
in
the
q-expansion
of
the
theta
functions
that
arise
at
the
various
points
Î¹
at
inï¬nity.
It
is
not
diï¬ƒcult
to
see
that
this
number
is
determined
uniquely
by
d,
d
,
and
m.
Proposition
3.3.
If
d
is
odd,
then
Z(d,
d
,
m)
=
d
((d
)2
âˆ’
1)
Â·
log(q)
24d
If
d,
d
are
even,
then
d
d

1
((d
)2
âˆ’
1)
Â·
log(q)
âˆ’
Â·
Ï†1
(âˆ’d
Â·
Î·Î¹
+
)
Â·
log(q)
24d
d
2
Î¹
d
d

1
=
{Ï†1
(âˆ’d
Â·
Î·Î¹
+
)
âˆ’
Ï†1
(âˆ’d
Â·
Î·Î¹
)}
Â·
log(q)
((d
)2
âˆ’
1)
Â·
log(q)
âˆ’
Â·
24d
d
2
Î¹
Z(d,
d
,
m)
=
Here,
Î·Î¹
denotes
the
element
of
Q/Z
(i.e.,
the
connected
component
of
the
special
ï¬ber
of
Eâˆ,S
â†’
Sâˆ)
deï¬ned
at
the
point
at
inï¬nity
Î¹
by
the
torsion
point
Î·
âˆˆ
Eâˆ,S
(Sâˆ
),
and
1
Ï†1
(Î¸)
=
12
Î¸2
âˆ’
12
|Î¸|
+
12
(for
|Î¸|
â‰¤
12
)
is
the
function
of
[HAT],
Chapter
IV,
Proposition
4.4.
Proof.
For
d
odd,
the
result
follows
(even
when
d
is
even)
from
the
computations
in
[HAT],
Chapter
VI,
the
portion
of
the
proof
of
Theorem
3.1
entitled
â€œComputation
of
the
Degree
in
the
Odd
Caseâ€
(which
reduce,
essentially,
to
[HAT],
Chapter
V,
Lemma
4.2).
For
d,
d
even,
the
result
follows
from
the
computations
in
[HAT],
Chapter
VI,
the
portion
of
the
proof
of
Theorem
3.1
entitled
â€œComputation
of
the
Degree
in
the
Even
Case.â€

Remark.
Often,
when
the
entire
discussion
consists
of
degrees
â€œin
log(q)
units,â€
we
will
omit
the
symbol
â€œlog(q),â€
as
in
[HAT].
Finally,
before
proceeding,
we
would
like
to
introduce
some
more
notation.
Let
us
write
m
=
def
m
(m,
d)
Thus,
put
another
way,
m
is
the
order
of
the
torsion
point
d
Â·
Î·.
Note
that
Z(d,
d
,
m)
depends
only
on
d,
d
,
and
m
,
i.e.,
it
may
be
thought
of
as
a
function
of
these
three
variables.
When
we
wish
to
think
of
it
that
way,
we
shall
write:
Z

(d,
d
,
m
)
for
Z(d,
d
,
m).
17
Â§4.
The
Fourier
Transform
of
an
Algebraic
Theta
Function:
The
Case
of
an
EÌtale
Lagrangian
Subgroup
In
this
Â§,
we
would
like
to
estimate
the
order
of
vanishing
of
the
section
Î½
of
Â§3
at
those
points
at
inï¬nity
where
the
Lagrangian
subgroup
H
âŠ†
Eâˆ,S
is
â€œof
eÌtale
type,â€
i.e.,
maps
injectively
into
the
group
of
connected
components
Q/Z
in
the
special
ï¬ber.
We
maintain
the
notation
of
Â§3,
except
that
in
the
present
Â§,
we
work
in
a
neighborhood
of
inï¬nity,
i.e.,
we
assume
that
def
1
S
=
Spec(C[[q
2md
]])
1
(equipped
with
the
log
structure
deï¬ned
by
the
divisor
V
(q
2md
))
and
that
the
onedimensional
semi-abelian
scheme
in
question
E
â†’
S
(i.e.,
the
one-dimensional
semi-abelian
scheme
whose
logarithmic
compactiï¬cation
is
C
log
â†’
S
log
)
is
the
Tate
curve
â€œGm
/q
Z
.â€
Write
U
for
the
standard
multiplicative
coordinate
on
the
Gm
that
uniformizes
E.
Since
we
chose
the
base
S
so
that
q
admits
a
2d-th
root
in
OS
,
it
follows
that
our
Lagrangian
âˆ,S
when
d
and
restriction
subgroups
H,
G
âŠ†
Eâˆ,S
,
as
well
as
the
splittings
Gspl
,
Hspl
âŠ†
E
is
even,
are
all
deï¬ned
over
S
(i.e.,
not
just
over
Sâˆ
).
Let
us
denote
the
unique
â€œpoint
at
def
inï¬nityâ€
(i.e.,
the
special
point
of
S)
by
âˆS
.
Also,
we
set
n
=
2m
(as
in
[HAT],
Chapter
IV,
Â§2,3).

Let
us
denote
by
Eâˆ,S
another
copy
of
Eâˆ,S
.
In
the
following,
we
would
like
to

think
of
Eâˆ,S
as
a
covering
of
Eâˆ,S
,
by
means
of
the
isogeny
given
by
the
morphism
â€œmultiplication
by
nâ€:

Eâˆ,S

def
[n]
âˆ’â†’
Eâˆ,S


Write
L
=
L|Eâˆ,S
.
Note
that
since
L
has
degree
n2
Â·
d,
it
follows
that

KL
=
n2
Â·d
Eâˆ,S

We
would
like
to
think
of
Eâˆ,S
as
admitting
a
Schottky
uniformization
by
â€œanother
copy
of
Gm
,â€
which
we
shall
denote
by
Gm
.
The
standard
multiplicative
coordinate
on
Gm
will
be
denoted
by
U

.
Thus,
(U

)n
=
U.
Also,
for
various
natural
numbers
N
,
we
shall
denote
the
copy
of
Î¼N
that
sits
naturally
inside
Gm
by
Î¼N
.
Next,
let
us
observe
that
the
natural
action
of
Gm
on
the
Schottky
uniformization
of


,
L
)
(cf.,
e.g.,
the
discussion
of
[HAT],
Chapter
IV,
Â§2,3)
induces
a
natural
action
(Eâˆ,S

of
Î¼n2
Â·d
on
L
(cf.,
e.g.,
the
discussion
at
the
beginning
of
[HAT],
Chapter
IV,
Â§2)
â€”
that
is,
we
get
a
homomorphism:
iSch
:
Î¼n2
Â·d
â†’
GL
18
On
the
other
hand,
let
us
observe
that
since
L
is
deï¬ned
by
translating
a
symmetric
line
bundle
by
a
torsion
point
of
order
m
(and
then
readjusting
the
integral
structure/metric
ev
â€”
cf.
the
deï¬nitions
of
Lst,Î·
,
Lst,Î·
in
[HAT],
Chapter
V,
Â§1),
it
follows
that
if
we
forget

about
the
adjustment
of
the
metric,
then
L
is
totally
symmetric
(i.e.,
equal
to
the
square
of
a
symmetric
line
bundle).
Moreover,
it
follows
from
the
discussion
preceding
[HAT],


Chapter
V,
Proposition
1.1,
that
the
curvature
of
L
is
symmetric,
which
implies
that
L
is,
in
fact,
totally
symmetric
as
a
metrized
line
bundle.
Thus,
since
n
is
even,
it
follows
from
[HAT],
Chapter
IV,
Theorem
1.6,
that
the
canonical
section
â€œÏƒâ€
of
loc.
cit.
deï¬nes
a
homomorphism:
iÏƒ
:
Î¼nÂ·d
â†’
GL
(the
fact
that
the
content
of
[HAT],
Chapter
IV,
Theorem
1.6,
is
still
valid
when
we
consider
metrics
follows
as
in
the
discussion
of
[HAT],
Chapter
IX,
Â§3).
Thus,
it
is
natural
to
ask
whether
or
not
these
two
homomorphisms
coincide
on
Î¼nÂ·d
:
Lemma
4.1.
We
have:
iÏƒ
=
iSch
|Î¼nÂ·d
.

Proof.
Recall
that
L
is
totally
symmetric
as
a
metrized
line
bundle,
and
that
the
action


of
Gm
on
the
Schottky
uniformization
of
the
pair
(Eâˆ,S
,
L
)
is
also
symmetric
(cf.
[HAT],
Chapter
IV,
Â§2).
Thus,
it
follows
that
iSch
maps
into
SL
.
Then
it
follows
from
the
deï¬nition
of
the
canonical
section
â€œÏƒâ€
in
[HAT],
Chapter
IV,
Â§1,
(together
with
the
fact
that
iSch
is
a
homomorphism)
that
iSch
|Î¼nÂ·d
=
iÏƒ
,
as
desired.

Next,
let
us
recall
that
the
push-forward
(fH
)âˆ—
(LH
)
is
generated
by
a
section
whose
corresponding
theta
function
is
given
by
(cf.
[HAT],
Chapter
V,
Theorem
4.8;
[HAT],
Chapter
VII,
Â§6):

q
d
(
2
Â·k
+(iÏ‡/n)Â·k)
Â·
U
k
Â·
(U

)iÏ‡
Â·
Ï‡(k)
Â·
Î¸m
1
1
2
kâˆˆZ
def
for
some
character
Ï‡
:
Z
â†’
Î¼n
(where
n
=
2m),
and
some
integer
iÏ‡
âˆˆ
{âˆ’m,
âˆ’m
+
1,
.
.
.
,
âˆ’1,
0,
1,
.
.
.
,
m
âˆ’
1}.
Since
â€œ(U

)iÏ‡
Â·
Î¸m
â€
essentially
amounts
to
the
trivialization
in
question,
we
see
that
the
â€œactual
theta
functionâ€
is
given
by:
def
Î˜
=

q
d
(
2
Â·k
+(iÏ‡
/n)Â·k)
Â·
U
k
Â·
Ï‡(k)
1
1
2
kâˆˆZ
Let
us
ï¬rst
consider
the
case
where
G
is
of
multiplicative
type,
i.e.,
G
=
Î¼d
âŠ†
Gm
.
This
is
in
some
sense
the
most
fundamental
and
important
case
of
the
various
cases
(relative
to
the
â€œpositionâ€
of
G,
H
inside
d
Eâˆ,S
)
that
will
be
considered
in
this
and
the
following
Â§.
19
(As
we
saw
in
the
Remark
following
Proposition
3.2,
the
norm
Î½
is
independent
of
the
choice
âˆ,S
â†’
Eâˆ,S
of
Gspl
.
Moreover,
let
us
note
that
since
d0
Â·
G
is
multiplicative,
the
isogeny
E
of
Â§3
is
â€œof
eÌtale
type,â€
i.e.,
it
lies
between
Eâˆ,S
and
its
Schottky
uniformization.
Put
âˆ,S
is
Schottky-uniformized
by
the
same
Gm
as
Eâˆ,S
.
another
way,
this
means
that
E
def
Thus,
it
makes
sense
to
stipulate
that
we
take
Gspl
=
Î¼d
âŠ†
Gm
.)
In
this
case,
restriction

to
G
amounts
to
identifying
U
k
and
U
k
whenever
k
â‰¡
k
modulo
d.
Now
according
to
the
theory
of
[HAT],
Chapter
VIII,
Â§2,3,4,
there
is
a
certain
special
set
of
d
consecutive
integers
KCrit
such
that
the
result
of
restricting
the
above
theta
function
to
G
=
Î¼d
is
given
by:
def
Î˜Î¼
=

(U|Î¼d
)k0
Â·
k0
âˆˆZ/dZ
=



q
d
(
2
Â·k
+(iÏ‡/n)Â·k)
Â·
Ï‡(k)
1
1
2
kâˆˆZ,
kâ‰¡k0
(mod
d)
2
q
d
(
2
Â·k
+(iÏ‡/n)Â·k)
Â·
(U|Î¼d
)k
Â·
(Ï‡(k)
+
k
)
Â·
{1
+
(smaller
powers
of
q)}
1
1
kâˆˆKCrit
where
k
is
a
certain
n-th
root
of
unity
if
k
is
exceptional
(cf.
[HAT],
Chapter
VIII,
Lemmas
4.3,
4.4),
and
k
=
0
otherwise
(i.e.,
if
k
is
not
exceptional).
There
is
at
most
one
exceptional
k
in
the
set
KCrit
.
Moreover,
the
exponents
of
q
appearing
in
the
above
sum
are
precisely
the
d
numbers
1d
Â·cj
(for
j
=
1,
.
.
.
,
d)
appearing
in
the
deï¬nition
of
Z(d,
d,
m).
Moreover,
since
the
set
KCrit
consists
of
k
consecutive
integers,
it
follows
that
the
above
function
on
Î¼d
is
essentially
the
Fourier
expansion
of
the
restriction
of
the
theta
function
in
question
to
G
=
Î¼d
.
Thus,
we
obtain
that
the
degree
of
vanishing
at
âˆS
of
the
norm
Î½
constructed
in
Â§3
â€”
which
we
shall
denote
by
deg(Î½)
â€”
is
â‰¥
the
â€œÎ¹
portionâ€
of
the
sum
in
the
deï¬nition
of
Z(d,
d,
m),
where
Î¹
corresponds
to
the
point
at
inï¬nity
âˆS
where
we
have
localized
in
the
present
discussion.
(Here,
we
say
â€œâ‰¥,â€
rather
than
â€œ=â€
since
we
dot
know
whether
or
not
the
coeï¬ƒcient
Ï‡(k)
+
k
which
appeared
above
is
nonzero.)
In
particular,
if
we
average
over
all
the
possible
Î¹â€™s
(which
corresponds
to
all
possible
torsion
points
Î·
of
order
precisely
m,
weighted
in
the
proper
fashion),
we
obtain
that
the
resulting
average
AvgÎ·
(deg(Î½))
satisï¬es
the
following:
Lemma
4.2.
We
have:
AvgÎ·
(deg(Î½))
â‰¥
Z(d,
d,
m)
for
any
G
of
multiplicative
type
(i.e.,
for
which
G
=
Î¼d
âŠ†
Gm
).
Thus,
it
remains
to
consider
the
case
when
G
is
not
necessarily
of
multiplicative
type.
Let
us
ï¬rst
observe
that
since
Im(G)
=
Im(d
Eâˆ,S
)
âŠ†
EâˆH
,S
is
independent
of
G,
it
follows
that
even
in
the
case
where
G
is
not
necessarily
of
multiplicative
type,
we
are
in
eï¬€ect
restricting
the
sections
of
(fH
)âˆ—
LH
to
the
same
points
as
in
the
case
where
G
is
of
multiplicative
type.
The
eï¬€ect
of
using
a
diï¬€erent
(e.g.,
a
non-multiplicative)
G
is
that
20
a
diï¬€erent
G
results
in
a
diï¬€erent
trivialization
at
those
points.
Thus,
in
particular,
the
resulting
theta
functions
diï¬€er
by
a
factor
given
by
some
function
Ïˆ
:
Î¼d
â†’
Gm
.
Since
ultimately
we
are
interested
in
Fourier
transforms
of
theta
functions,
we
thus
see
that:
The
net
eï¬€ect
(of
using
a
non-multiplicative
G)
on
the
Fourier
transform
of
the
theta
function
in
question
is
to
convolute
by
dâˆ’1
Â·
F
(Ïˆ)
(cf.
Proposition
1.1,
(ii.)).
Thus,
in
the
following,
we
propose
to
compute
Ïˆ
and
its
Fourier
transform
F
(Ïˆ),
and
then
consider
the
degree
of
the
zero
locus
at
inï¬nity
of
the
convolution
of
dâˆ’1
Â·
F
(Ïˆ)
with
the
Fourier
transform
of
the
theta
function
considered
above.
To
compute
the
diï¬€erence
Ïˆ
in
trivializations
arising
from
G,
we
must
introduce
some
def
new
notation,
as
follows.
First,
we
write
GÎ¼
=
Î¼d
âŠ†
Gm
.
Since
H
is
of
eÌtale
type,
it
follows
that
GÎ¼
Ã—
H
=
d
Eâˆ,S
.
Note
that
since
H
injects
into
the
group
of
connected
components
of
the
special
ï¬ber
of
Eâˆ,S
,
we
get
a
natural
identiï¬cation
H
=
Z/dZ
Thus,
we
shall
think
of
d
Eâˆ,S
as
GÎ¼
Ã—H
=
Î¼d
Ã—Z/dZ.
Then
relative
to
this
decomposition,
G
may
be
written
as
the
graph
of
some
homomorphism
Î±G
:
Î¼d
â†’
Z/dZ.

.
In
fact,
in
order
to
calculate
Ïˆ,
we
will
need
to
lift
the
above
data
on
Eâˆ,S
to
Eâˆ,S

Of
course,
many
of
the
lifted
data
on
Eâˆ,S
will
not
be
uniquely
determined
by
the
original
data
on
Eâˆ,S
,
but
this
will
not
matter,
since
diï¬€erent
choices
of
lifts
will
not
aï¬€ect
the
end
result.
Thus,
write
def
GÎ¼
=
Î¼n2
Â·d
(so
n
Â·
GÎ¼
lifts
GÎ¼
)
and
choose
an

H

=
Z/n2
Â·
dZ
âŠ†
Eâˆ,S
(where
the
identiï¬cation
of
H

with
Z/n2
Â·
dZ
is
assumed
to
be
given
by
the
natural

)
homomorphism
of
H

into
the
group
of
connected
components
of
the
special
ï¬ber
of
Eâˆ,S



such
that
nÂ·H
lifts
H.
Finally,
we
choose
a
G
âŠ†
n2
Â·d
Eâˆ,S
deï¬ned
by
some
homomorphism
Î±G
:
Î¼n2
Â·d
â†’
Z/n2
Â·
dZ
such
that
n
Â·
G
lifts
G.
Let
us
write
Ïƒ

:
2
Â·
KL
â†’
GL
21
for
the
canonical
section
of
[HAT],
Chapter
IV,
Theorem
1.6.
We
are
now
ready
to
compute
Ïˆ
:
Î¼d
â†’
Gm
.
Let
a
âˆˆ
Î¼d
=
GÎ¼
.
Select
a
lifting
def
def
a
âˆˆ
n
Â·
GÎ¼
of
a.
Let
a1
âˆˆ
m
Â·
GÎ¼
be
such
that
2
Â·
a1
=
a
.
Write
b1
=
Î±G
(a1
);
b
=
2b1
;
b
for
the
image
of
b
in
Eâˆ,S
(i.e.,
b
=
Î±G
(a)).
Then
it
essentially
follows
from
the
deï¬nitions
that:
Ïˆ(Î±)
=
Ïƒ

((a
,
b
))
Â·
Ïƒ

(b
)âˆ’1
Â·
Ïƒ

(a
)âˆ’1
Â·
Ï‡ex
(a
)
where
Ï‡ex
:
n
Â·
GÎ¼
â†’
Gm
is
a
character.
(Indeed,
this
essentially
follows
from
the
fact
that
Ïƒ

,
as
well
as
the
sections
of
GL
used
in
Â§3
to
deï¬ne
the
trivialization
of
L|G
and
the
subgroup
H
âŠ†
GL
are
all
homomorphisms
on
n
Â·
H

,
n
Â·
G
,
G,
and
H.
Thus,
the
restrictions
of
two
such
sections
to
the
same
subgroup
diï¬€er
from
one
another
by
various
characters.
This
is
what
leads
to
the
â€œextra
factorâ€
Ï‡ex
.)
On
the
other
hand,
by
[HAT],
Chapter
IV,
Theorem
1.6,
(2),
we
have
Ïƒ

((a
,
b
))
Â·
Ïƒ

(b
)âˆ’1
Â·
Ïƒ

(a
)âˆ’1
=
([b1
,
a1
]
)2

(where
[âˆ’,
âˆ’]
is
the
pairing
associated
to
L
).
Clearly,
the
right-hand
side
of
this
equality
is
a
2d-th
root
of
unity.
Thus,
(since
Ïˆ(âˆ’)d
=
1)
we
obtain
that
Ï‡ex
(âˆ’)2d
=
1.
Now
suppose
that
d
is
odd.
In
this
case,
we
may
choose
a
and
a1
to
be
of
odd
order.
This
implies
that
b
and
and
b1
are
also
of
odd
order.
Since
it
makes
sense
to
multiply
elements
of
odd
order
by
12
,
we
thus
obtain:
([b1
,
a1
]
)2
=
([b
,
a
]
)
2
=
[b,
a]
2
1
1
(where
[âˆ’,
âˆ’]
is
the
pairing
associated
to
L).
In
particular,
we
get
Ï‡ex
(âˆ’)d
=
1.
By
abuse
of
notation,
let
us
write
Ï‡ex
(a)
for
Ï‡ex
(a
).
That
is,
we
have:
Ïˆ(a)
=
[a,
Î±G
(a)]âˆ’
2
Â·
Ï‡ex
(a)
1
for
some
Ï‡ex
:
GÎ¼
â†’
Î¼d
.
This
completes
the
case
when
d
is
odd.
Now
suppose
that
d
is
even.
In
this
case,
we
obtain:
Ïˆ(a)
=
([a1
,
Î±G
(2a1
)]
)âˆ’1
Â·
Ï‡ex
(a
)
Note
that
a1
is
well-deï¬ned
up
to
the
addition
of
an
element
a
âˆˆ
m
Â·
d
Â·
GÎ¼
=
Î¼2n
.
Moreover,
one
checks
easily
that
the
pairing
(x,
y)
â†’
[x,
Î±G
(y)]
on
GÎ¼
Ã—GÎ¼
is
symmetric.
Thus,
22
[a1
+
a
,
Î±G
(2a1
+
2a
)]
=
[a1
,
Î±G
(2a1
)]
Â·
[a
,
Î±G
(2a1
)]
Â·
[a1
,
Î±G
(2a
)]
Â·
[a
,
Î±G
(2a
)]
=
[a1
,
Î±G
(2a1
)]
Â·
[a
,
Î±G
(a
)]
Â·
[a
,
Î±G
(a
)]
Â·
[a
,
Î±G
(2a
)]
=
[a1
,
Î±G
(2a1
)]
Â·
[a
,
Î±G
(2a
)]
Â·
[a
,
Î±G
(2a
)]
=
[a1
,
Î±G
(2a1
)]
Â·
[??,
n
Â·
d
Â·
Î±G
(a
+
a
)]
=
[a1
,
Î±G
(2a1
)]
where
we
use
that
n
Â·
d
Â·
a
=
0;
(since
d
is
even)
n
Â·
d
Â·
a
=
0.
Thus,
it
follows
that
([a1
,
Î±G
(2a1
)]
)âˆ’1
depends
only
on
a
(i.e.,
not
on
the
choice
of
lifting
a1
).
In
particular,
(since
Ïˆ(a)
manifestly
only
depends
on
a)
we
obtain
that
Ï‡ex
(a
)
depends
only
on
a.
By
abuse
of
notation,
we
will
write
Ï‡ex
(a)
for
Ï‡ex
(a
).
Thus,
in
summary:
Lemma
4.3.
Let
a
âˆˆ
GÎ¼
=
Î¼d
.
Then
if
d
is
odd,
then
Ïˆ(a)
=
[a,
Î±G
(a)]âˆ’
2
Â·
Ï‡ex
(a)
1
for
some
character
Ï‡ex
:
GÎ¼
â†’
Î¼d
.
If
d
is
even,
and
a1
âˆˆ
m
Â·
GÎ¼
satisï¬es
2a1
â†’
a,
then
Ïˆ(a)
=
([a1
,
Î±G
(2a1
)]
)âˆ’1
Â·
Ï‡ex
(a)
for
some
character
Ï‡ex
:
GÎ¼
â†’
Î¼d
.
In
particular,
if
the
homomomorphism
Î±G
:
Î¼d
â†’
Z/dZ
is
of
order
dord
,
then
it
follows
that
(regardless
of
the
parity
of
d)
Ïˆ
:
Î¼d
â†’
Gm
is
â€”
up
to
a
factor
given
by
the
character
Ï‡ex
â€”
the
pull-back
to
Î¼d
via
the
natural
projection
Î¼d
â†’
Î¼dord
(arising
from
the
fact
that
dord
divides
d)
of
a
reduced
discrete
Gaussian
(cf.
Deï¬nition
2.2)
on
Î¼dord
.
Proof.
It
remains
only
to
verify
that
the
bracketed
portions
of
the
expressions
that
we
obtained
above
for
Ïˆ(a)
are
indeed
pull-backs
of
reduced
discrete
Gaussians
as
described.
But
this
follows
immediately
from
the
deï¬nitions.
Note
that
we
use
here
the
well-known
fact
that
the
pairings
[âˆ’,
âˆ’];
[âˆ’,
âˆ’]
are
nondegenerate.
(Indeed,
if
they
were
degenerate,

then
the
theory
of
theta
groups
would
imply
that
that
L
descends
to
some
quotient
of


Eâˆ,S
by
a
ï¬nite
group
scheme
of
order
>
n2
Â·
d,
which
is
absurd,
since
deg(L
)
=
n2
Â·
d.)

Thus,
by
Proposition
1.1,
(ii.);
Proposition
1.2,
(i.);
and
Proposition
2.3,
it
follows
that
The
eï¬€ect
on
the
Fourier
expansion
of
the
theta
function
of
the
trivializa
(determined
tion
deï¬ned
by
G
is
given
by
translation
by
an
element
of
G

of
the
by
the
character
Ï‡ex
),
followed
by
convolution
by
a
function
on
G
form:
1
Z/dZ

Â·
dord
âˆ’
2
Â·
IndZ/dord
Z
Î¾
23
âˆš
where

is
a
4-th
root
of
unity
(respectively,
2
times
an
8-th
root
of
unity)
if
dord
is
odd
(respectively,
even),
and
Î¾
is
a
reduced
discrete
Gaussian
on
Z/dord
Z.
Let
us
denote
the
function
Ïˆ
Â·
Î˜Î¼
on
Î¼d
(whose
Fourier
expansion
is
discussed
above)
by:
def
Î˜G
=
Ïˆ
Â·
Î˜Î¼
Then
if
we
assume
(so
that
we
do
not
have
to
deal
in
the
expression
below
with
â€œexceptional
kâ€)
that
dord
=
1
(note:
the
case
dord
=
1
was
dealt
with
above
in
Lemma
4.2),
then
since
the
values
of
Î¾
are
all
âˆˆ
Î¼2dord
,
we
obtain
that
(for
k0
âˆˆ
Z/dZ)
the
coeï¬ƒcient
of
(U|Î¼d
)k0
+kex
(where
kex
âˆˆ
Z/dZ
is
a
ï¬xed
element
determined
by
Ï‡ex
)
in
the
Fourier
expansion
of
Î˜G
is
of
the
following
form:
Coeï¬€
(U
|Î¼
)k0
+kex
(Î˜G
)
d
=

Â·
dord
âˆ’
2
Â·
1
=

Â·
dord
âˆ’
12
Â·


0
q
d
(
2
Â·k
+(iÏ‡/n)Â·k)
Â·
Ï‡(k)
Â·
Î¾(
kâˆ’k
deff
)
1
kâˆˆZ,
kâ‰¡k0
(mod
deff
)
2
1
a
Î¼nÂ·dord
-linear
combination
of
those
q
d
(
2
Â·k
+(iÏ‡/n)Â·k)
1
1
2
for
which
k
âˆˆ
KCrit
,
k
â‰¡
k0
(modulo
deï¬€
),
+
smaller
powers
of
q
def
where
deï¬€
=
d/dord
.
Since
the
power
of
q
that
appears
in
the
coeï¬ƒcient
of
(U|Î¼d
)k0
+kex
for
Î˜Î¼
is
precisely
the
smallest
exponent
of
q
that
appears
in
the
q-expansion
of
the
original
theta
function
Î˜
among
those
terms
indexed
by
a
k
such
that
k
â‰¡
k0
(modulo
d),
it
thus
follows
that
the
smallest
power
of
q
that
appears
in
the
coeï¬ƒcient
of
(U|Î¼d
)k0
+kex
for
Î˜G
is
precisely
the
smallest
exponent
of
q
that
appears
in
the
q-expansion
of
the
original
theta
function
Î˜
among
those
terms
indexed
by
a
k
such
that
k
â‰¡
k0
(modulo
deï¬€
).
Moreover,
this
smallest
power
either
appears
precisely
once
in
Coeï¬€
(U
|Î¼
)k0
+kex
(Î˜G
),
in
which
case
d
its
coeï¬ƒcient
(i.e.,
in
the
â€œÎ¼nÂ·dord
-linear
combinationâ€
discussed
above)
is
âˆˆ
Î¼nÂ·dord
,
or
(cf.
the
â€œexceptional
caseâ€
of
[HAT],
Chapter
VIII,
Lemmas
4.3,
4.4)
it
appears
twice
in
Coeï¬€
(U
|Î¼
)k0
+kex
(Î˜G
),
in
which
case
its
coeï¬ƒcient
is
the
sum
of
two
elements
âˆˆ
Î¼nÂ·dord
.
d
Thus,
by
the
same
reasoning
as
that
used
to
prove
Lemma
4.2,
we
obtain
the
following,
which
is
the
main
result
of
this
Â§:
Theorem
4.4.
Assume
that
the
Lagrangian
subgroup
H
is
of
eÌtale
type.
Then
for
any
restriction
subgroup
G
âŠ†
d
Eâˆ,S
,
we
have:
AvgÎ·
(deg(Î½))
â‰¥
dord
Â·
Z(d,
deï¬€
,
m)
24
where
d
=
deï¬€
Â·
dord
,
and
dord
is
the
order
of
the
diï¬€erence
between
G
and
the
multiplicative
subgroup
GÎ¼
=
Î¼d
.
Moreover,
the
coeï¬ƒcient
of
the
smallest
power
of
q
in
Coeï¬€
(U
|Î¼
)k0
+kex
(Î˜G
)
is
of
the
d
form:
1

Â·
dord
âˆ’
2
Â·
(an
element
âˆˆ
Î¼nÂ·dord
)
âˆš
(where

is
a
4-th
root
of
unity
(respectively,
2
times
an
8-th
root
of
unity)
if
dord
is
odd
(respectively,
even)),
with
at
most
one
possible
exceptional
class
of
k0
â€™s
in
Z/deï¬€
Z.
If
this
exception
occurs,
and
the
above
inequality
is
an
equality,
then
the
coeï¬ƒcient
of
the
smallest
power
of
q
in
Coeï¬€
(U
|Î¼
)k0
+kex
(Î˜G
)
in
this
case
is
of
the
form:
d

Â·
dord
âˆ’
2
Â·
(a
nonzero
sum
of
two
elements
âˆˆ
Î¼nÂ·dord
)
1
(where

is
a
4-th
root
of
unity
(respectively,
(respectively,
even)).
âˆš
2
times
an
8-th
root
of
unity)
if
dord
is
odd
Proof.
Note
that
here,
we
only
obtain
an
inequality
AvgÎ·
(deg(Î½))
â‰¥
dord
Â·
Z(d,
deï¬€
,
m)
because
we
do
not
know
whether
or
not
(in
the
â€œexceptional
caseâ€
for
dord
=
1)
the
sum
of
the
two
(n
Â·
dord
)-th
roots
of
unity
is
nonzero.
The
factor
of
dord
that
appears
on
the
right-hand
side
of
this
inequality
arises
because
since
the
coeï¬ƒcient
Coeï¬€
(U
|Î¼
)k0
+kex
(Î˜G
)
d
depends
only
on
the
class
of
k0
in
Z/deï¬€
Z,
zeroes
occur
with
multiplicity
d/deï¬€
=
dord
.

Â§5.
The
Fourier
Transform
of
an
Algebraic
Theta
Function:
The
Case
of
a
Lagrangian
Subgroup
with
Nontrivial
Multiplicative
Part
In
this
Â§,
we
would
like
to
estimate
the
order
of
vanishing
of
the
section
Î½
of
Â§3
at
those
points
at
inï¬nity
where
the
Lagrangian
subgroup
H
âŠ†
Eâˆ,S
is
â€œnot
necessarily
of
eÌtale
type,â€
i.e.,
does
not
necessarily
map
injectively
into
the
group
of
connected
components
Q/Z
in
the
special
ï¬ber.
In
essence,
our
strategy
will
be
to
reduce
to
the
case
where
H
is
of
eÌtale
type,
which
was
already
dealt
with
in
Â§4.
In
this
Â§,
we
maintain
the
notation
of
Â§4.
However,
unlike
the
situation
of
Â§4,
we
do
not
assume
that
H
is
of
eÌtale
type.
Write
def
HÎ¼
=
H
25
Î¼d
(where
Î¼d
âŠ†
Gm
sits
inside
the
copy
of
Gm
that
uniformizes
E).
Note
that
the
subgroup
HÎ¼
âŠ†
H
denotes
the
portion
of
the
Lagrangian
subgroup
H
which
is
purely
of
multiplicative
type.
Write
Het
for
the
image
of
H
in
the
group
of
connected
components
in
the
special
ï¬ber
of
Eâˆ,S
(a
group
which
may
be
identiï¬ed
with
Q/Z).
Thus,
we
have
an
exact
sequence:
0
â†’
HÎ¼
â†’
H
â†’
Het
â†’
0
def
def
We
denote
the
orders
of
HÎ¼
,
Het
by:
hÎ¼
=
|HÎ¼
|;
het
=
|Het
|.
Thus,
hÎ¼
Â·
het
=
d.
Also,
let
us
write
def
Get
=
Ker([hÎ¼
]
:
G
â†’
G)
for
the
kernel
of
multiplication
by
hÎ¼
on
G.
Thus,
|Get
|
=
het
.
Next,
let
us
set:
def
EâˆÎ¼
,S
=
Eâˆ,S
/HÎ¼
def
On
the
other
hand,
let
us
recall
the
quotient
EâˆH
,S
=
Eâˆ,S
/H
of
Â§3.
Since
HÎ¼
âŠ†
H,
it
follows
that
the
isogeny
Eâˆ,S
â†’
EâˆH
,S
factors
into
a
composite
of
isogenies:
Eâˆ,S
HÎ¼
âˆ’â†’
H
et
âˆ’â†’
EâˆH
,S
EâˆÎ¼
,S
where
HÎ¼
=
Î¼(hÎ¼
)
;
Het
=
Z/het
Z;
and
the
groups
above
the
arrows
denote
the
kernels
of
the
homomorphisms
corresponding
to
the
arrows.
If
we
denote
the
respective
â€œq-parametersâ€
and
â€œstandard
multiplicative
coordinates
on
the
respective
Schottky
uniformizationsâ€
by
q,
qÎ¼
,
qH
,
and
U,
UÎ¼
,
and
UH
,
respectively,
then
we
have:
q
Î¼
=
qÎ¼
;
h
het
qÎ¼
=
qH
;
U
Î¼
=
UÎ¼
;
h
UÎ¼
=
UH
In
the
following,
we
will
also
write
Gm
,
(Gm
)Î¼
,
(Gm
)H
for
the
copies
of
â€œGm
â€
that
Schottky
uniformize
Eâˆ,S
,
EâˆÎ¼
,S
,
and
EâˆH
,S
,
respectively,
(so,
in
particular,
(Gm
)Î¼
=
Î¼
(Gm
)H
)
and
Î¼N
âŠ†
Gm
;
Î¼N
âŠ†
(Gm
)Î¼
;
Î¼H
N
âŠ†
(Gm
)H
for
the
copies
of
â€œÎ¼N
â€
lying
inside
these
copies
of
Gm
.
Finally,
observe
that
since
we
are
given
a
lifting
H
âŠ†
GL
of
H,
we
also
get
natural
metrized
line
bundles
LÎ¼
and
LH
on
EâˆÎ¼
,S
and
EâˆH
,S
,
respectively,
that
descend
L.
Note
that
since
H
and
G
generate
d
Eâˆ,S
,
it
follows
that
G
â†’
EâˆÎ¼
,S
.
Thus,
we
obtain
subgroup
schemes
26
Het
,
Get
â†’
EâˆÎ¼
,S
Note
that
Het
is
tautologically
of
eÌtale
type.
Thus,
it
follows
that
the
image
ImEâˆH
,S
(Get
)
of
Get
in
EâˆH
,S
is
of
multiplicative
type.
(Indeed,
since
EâˆH
,S
is
obtained
from
EâˆÎ¼
,S
by
forming
the
quotient
by
Het
,
which
is
of
eÌtale
type,
it
follows
that
the
entire
image
Î¼
ImEâˆH
,S
(het
EâˆÎ¼
,S
)
=
ImEâˆH
,S
(Î¼het
)
in
EâˆH
,S
is
of
multiplicative
type.)
Next,
write
def
GÎ¼
=
G/Get
Note
that
|GÎ¼
|
=
hÎ¼
,
and
that
(since
the
image
ImEâˆH
,S
(Get
)
of
Get
in
EâˆH
,S
is
of
multiplicative
type)
GÎ¼
maps
naturally
into
the
group
of
connected
components
in
the
special
ï¬ber
of
EâˆH
,S
.
Moreover,
this
map
is
injective.
(Indeed,
this
injectivity
may
be
veriï¬ed
for
each
of
the
p-primary
portions
(where
p
is
a
prime
number)
of
GÎ¼
independently;
thus,
it
suï¬ƒces
to
verify
this
injectivity
in
the
case
where
d
is
a
prime
power.
But
then,
if
injectivÎ¼
Î¼
ity
did
not
hold,
then
it
would
follow
that
(ImEâˆ
,S
(G)+Het
)
Î¼d
âŠ†
Î¼het
,
which
implies
Î¼
Î¼
(by
multiplying
both
sides
of
this
non-inclusion
by
het
)
that
ImEâˆ
,S
(G)
Î¼d
=
{1}
(so,
Î¼
in
particular,
G
Î¼d
=
{1},
hence
(since
G
and
H
generate
d
Eâˆ,S
)
that
hÎ¼
=
|HÎ¼
|
=
1,
so
GÎ¼
=
{1}
â€”
which
implies
that
injectivity
holds
trivially.)
Thus,
in
summary,
this
injection
induces
a
natural
identiï¬cation
1
Z/Z
hÎ¼
GÎ¼
=
Next,
let
us
deï¬ne
def
heï¬€
=
|ImEâˆ
Î¼
,S
(Get
)
Î¼
Î¼d
|
Note
that
since
H
and
G
generate
d
Eâˆ,S
,
it
follows
that
(heï¬€
,
hÎ¼
)
=
1.
Since
heï¬€
divides
het
,
let
us
write
het
=
heï¬€
Â·
hord
.
Write
Heï¬€
âŠ†
Het
;
Geï¬€
âŠ†
Get
for
the
respective
subgroups
given
by
the
kernel
of
multiplication
by
hord
.
Thus,
|Heï¬€
|
=
|Geï¬€
|
=
heï¬€
.
The
main
theme
of
this
Â§
is
the
following:
We
would
like
to
apply
the
theory
of
Â§4
to
the
data
(EâˆÎ¼
,S
;
LÎ¼
;
Het
,
Get
â†’
EâˆÎ¼
,S
)
27
where
we
take
the
point
â€œÎ·â€
of
Â§4
to
be
the
given
Î·
plus
a
collection
of
representatives
of
the
various
classes
of
GÎ¼
=
G/Get
.
Next,
we
consider
metrized
line
bundles.
Note
that
the
metrized
line
bundle
LH
on
EâˆH
,S
has
degree
1
and
curvature
(cf.
[HAT],
Chapter
V,
Â§1)
given
by:
(hÎ¼
)âˆ’1

1
Â·
Î´[i/hÎ¼
]
hÎ¼
i=0
(where
Î´[i/hÎ¼
]
denotes
the
delta
distribution
on
S1
concentrated
at
the
point
[i/hÎ¼
]
âŠ†
S1
).
Let

def
LH
=
LH
(Ïˆ)

where
Ïˆ
:
S1
â†’
R
is
the
unique
piecewise
smooth
function
such
that
the
curvature
of
LH


is
equal
to
Î´[0]
,
and
S1
Ïˆ
=
0.
Then,
as
reviewed
in
Â§4,
LH
is
generated
by
the
section
deï¬ned
by
the
theta
function:
def
âˆ’
1
k2

Î˜H
=
qH
2
Î·
1
(k+kÎ·
)2
qH2
k
Â·
UH
Â·
Ï‡(k)
kâˆˆZ
def
where
we
write
kÎ·
=
iÏ‡
/n
(so
|kÎ·
|
â‰¤
12
).
Observe
that
as
a
function
on
Z,
the
function
k
â†’
12
(k
+
kÎ·
)2
assumes
its
minimum
at
k
=
0.
Moreover,
if
we
restrict
Î˜H
to
Î¼H
het
,
then
k0
the
highest
power
of
qH
appearing
in
the
coeï¬ƒcient
of
(UH
|Î¼H
)
is
given
by:
het
1
1
âˆ’
kÎ·2
+
Minkâ‰¡k0
mod
het
{
(k
+
kÎ·
)2
}
2
2
1
1
=
âˆ’MinkâˆˆZ
{
(k
+
kÎ·
)2
}
+
Minkâ‰¡k0
mod
het
{
(k
+
kÎ·
)2
}
2
2
Now
to
consider
such
coeï¬ƒcients
of
(UH
|Î¼H
)k0
amounts
to
considering
the
Fourier
transhet
form
of
the
restriction
of
the
theta
function
in
question
to
Î¼H
het
.
More
generally
â€”
cf.
the
theory
of
Â§4,
which
we
think
of
as
being
applied
to
the
data
(EâˆÎ¼
,S
;
LÎ¼
;
Het
,
Get
â†’
EâˆÎ¼
,S
)
â€”
we
would
like
to
consider
the
Fourier
coeï¬ƒcients
of
the
convolution
of
Î˜H
|Î¼H
with
het
some
reduced
discrete
Gaussian
(times
a
character)
on
Î¼H
hord
(regarded
as
a
quotient
of
Î¼
Î¼d
|.)
Then
Î¼H
het
).
(Note
that
hord
=
het
/heï¬€
appears
here
since
heï¬€
=
|ImEâˆÎ¼
,S
(Get
)
28
the
highest
power
of
qH
appearing
in
the
coeï¬ƒcient
of
(UH
|Î¼H
)k0
+kex
(for
such
a
convohet
lution,
where
kex
is
a
constant
determined
by
the
character)
is
given
by:
1
1
âˆ’
kÎ·2
+
Minkâ‰¡k0
mod
heff
{
(k
+
kÎ·
)2
}
2
2
1
1
=
âˆ’MinkâˆˆZ
{
(k
+
kÎ·
)2
}
+
Minkâ‰¡k0
mod
heff
{
(k
+
kÎ·
)2
}
2
2
Note
that
for
an
appropriate
choice
of
reduced
discrete
Gaussian,
this
convolution
amounts
precisely
to
the
restriction
of
the
theta
function
in
question
to
Get
.
Of
course,
ultimately,
we
wish
to
consider
the
Fourier
coeï¬ƒcients
of
the
restriction
of
the
theta
function
in
question
to
G.
This
amounts
to
restricting
Î˜H
to
Get
+
Î³,
for
various
Î³
âˆˆ
GÎ¼
=
G/Get
.
Write
kÎ³
âˆˆ
h1
Z
for
a
representative
of
Î³
âˆˆ
GÎ¼
=
h1
Z/Z.
Also,
let
us
Î¼
Î¼
deï¬ne
a
metrized
line
bundle
on
EâˆH
,S

def
LH
=
LH
(Ïˆ(0))


(where
Ïˆ
:
S1
â†’
R
is
the
function
appearing
in
the
deï¬nition
of
LH
).
Thus,
LH
,
LH
,
and


LH
have
the
same
restriction
to
the
generic
ï¬ber
of
EâˆH
,S
;
LH
and
LH
have
the
same


curvature;
and
LH
and
LH
have
the
same
metric
structure
at
the
connected
component

m
for
the
q-adic
formal
of
the
identity
(in
the
special
ï¬ber
of
EâˆH
,S
).
Let
us
write
G
completion
of
(Gm
)Sâˆ
.
Then
it
follows
from
the
determination
of
the
metric
given
in,
e.g.,
[HAT],
Chapter
VII,
Lemma
6.4
(cf.
also
the
discussion
following
this
lemma),
together
(1/(hÎ¼
Â·n))Â·Z
with
the
well-known
explicit
form
of
theta
functions
on
(Gm
)H
/qH
(cf.
[HAT],

Chapter
V,
Theorem
4.8),
that
if
we
regard
Î˜H
as
a
section
of
LH
,
then
its
restriction
to

m
corresponding
to
Î³
will
be
given
(up
to
a
possible
factor
âˆˆ
Î¼
)
by:
the
copy
of
G
âˆ
def
âˆ’
1
k2
Î˜H
[Î³]
=
qH
2
Î·
Â·

1
(k+kÎ·
+kÎ³
)2
k+kÎ³
Â·
UH
qH2
Â·
Ï‡(k)
kâˆˆZ
k
(where,
in
the
above
expression,
the
factor
UHÎ³
may
be
thought
of
as
part
of
the
trivialization
in
use;
moreover,
since
this
same
factor
multiplies
all
the
terms
in
the
above
expression,
it
may
be
ignored
â€”
i.e.,
we
essentially
have
a
function
in
integral
powers
of
UH
).
Thus,
if
we
write
1
1
2
def
1
kH
=
MinkâˆˆZ,
Î³âˆˆGÎ¼
{
(k
+
kÎ·
+
kÎ³
)2
}
â‰¤
kÎ·2
2
2
2
then
def
1
2
k2
âˆ’
12
kH
Î˜H
[Î³]
=
qH2
Î·
âˆ’
1
k2
Â·
Î˜H
[Î³]
=
qH
2
H
Â·

kâˆˆZ
29
1
(k+kÎ·
+kÎ³
)2
qH2
k+kÎ³
Â·
UH
Â·
Ï‡(k)
is
the
theta
function
associated
to
a
generator
of
(fH
)âˆ—
LH
.
Moreover,
if
we
then
convolute
Î˜H
[Î³]|Î¼H
with
some
reduced
discrete
Gaussian
(times
a
character)
pulled
back
from
het
H
the
quotient
Î¼H
het
â†’
Î¼hord
,
then
it
follows
that
the
highest
power
of
qH
appearing
in
the
coeï¬ƒcient
of
(UH
|Î¼H
)k0
+kex
(where
k0
âˆˆ
Z)
for
such
a
convolution
is
given
by:
het
1
2
1
âˆ’
kH
+
Minkâ‰¡k0
âˆ’kÎ³
mod
heff
{
(k
+
kÎ·
+
kÎ³
)2
}
2
2
(where
k
âˆˆ
Z,
and
the
congruence
symbol
â€œâ‰¡â€
is
well-deï¬ned
since,
as
remarked
above,
(heï¬€
,
hÎ¼
)
=
1).
Thus,
if
we
allow
Î³
to
vary,
then
we
obtain
that
the
highest
power
of
qH
appearing
in
the
coeï¬ƒcient
of
(UH
|Î¼H
)k0
+kex
(where
k0
âˆˆ
Z)
for
such
a
convolution
is
het
given
by:
1
1
2
+
Minj/hÎ¼
â‰¡k0
mod
heff
{
((j/hÎ¼
)
+
kÎ·
)2
}
âˆ’
kH
2
2
1
1
1
2
=
âˆ’
kH
+
2
Â·
Minjâ‰¡hÎ¼
Â·k0
mod
heff
{
(j
+
hÎ¼
Â·
kÎ·
)2
}
2
hÎ¼
2
(where
j
âˆˆ
Z,
and
the
congruence
symbol
â€œâ‰¡â€
is
well-deï¬ned
since,
as
remarked
above,
(heï¬€
,
hÎ¼
)
=
1).
The
above
analysis
thus
implies
â€”
by
the
same
reasoning
as
that
used
to
derive
Theorem
4.4
in
Â§4
â€”
the
following
generalization
of
Theorem
4.4,
which
is
the
main
result
of
this
Â§:
Theorem
5.1.
For
any
Lagrangian
subgroup
H
and
any
restriction
subgroup
G
âŠ†
d
Eâˆ,S
,
we
have:
AvgÎ·
(deg(Î½))
â‰¥
(d/heï¬€
)
Â·
Z

(d,
heï¬€
,
m
)
where
heï¬€
=
|ImEâˆ
Î¼
,S
(Get
)
Î¼
Î¼d
|.
Proof.
The
sums
Z

(âˆ’,
âˆ’,
âˆ’)
are
deï¬ned
as
sums
of
minima
such
as
1
Minjâ‰¡hÎ¼
Â·k0
mod
heff
{
(j
+
hÎ¼
Â·
kÎ·
)2
}
2
1/h2Î¼
1
regarded
as
powers
of
q
d
.
Here,
we
wish
to
regard
such
minima
as
powers
of
qH
1/hÎ¼
het
/hÎ¼
het
implies
q
=
qH
,
hence
in
fact,
q
=
qÎ¼
,
qÎ¼
=
qH
1
d
q
=q
1/(het
Â·hÎ¼
)
30
1/h2Î¼
=
qH
.
But
so
we
see
that
we
do
not
need
to
multiply
the
Z

(âˆ’,
âˆ’,
âˆ’)â€™s
by
any
factor
in
our
estimate
of
the
degree
of
vanishing
of
the
product
of
the
Fourier
coeï¬ƒcients
corresponding
to
a
single
collection
of
representatives
in
Z/dZ
of
the
set
of
â€œequivalence
classesâ€
(Z/dZ)/heï¬€
Â·
(Z/dZ)
=
Z/heï¬€
Z.
Since,
for
a
given
class
of
Z/dZ
modulo
heï¬€
,
we
must
contend
with
a
total
of
d/heï¬€
Fourier
coeï¬ƒcients,
we
thus
obtain
a
factor
of
d/heï¬€
in
our
ï¬nal
estimate.
Finally,
note
that
the
term
hÎ¼
Â·kÎ·
appearing
in
the
minima
above
corresponds
precisely
to
the
image
â€œd
Â·
Î·Î¹
â€
of
Î·Î¹
âˆˆ
S1
(where
this
S1
is
the
S1
corresponding
to
the
special
ï¬ber
of
the
original
Eâˆ,S
)
in
S1
/(
1d
Z/Z).
Indeed,
kÎ·
corresponds
to
the
image
of
Î·Î¹
in
S1
/(
h1et
Z/Z)
=
(S1
)H
(i.e.,
the
S1
corresponding
to
the
special
ï¬ber
of
EâˆH
,S
),
so
the
image
â€œd
Â·
Î·Î¹â€
of
Î·Î¹
in
S1
/(
1d
Z/Z)
is
given
by
multiplying
kÎ·
by
d/het
=
hÎ¼
,
as
desired.

def
Theorem
5.2.
In
the
situation
of
Theorem
5.1,
write
hÎ¼
=
|H
Î¼d
|;
d
=
hÎ¼
Â·
het
;
het
=
heï¬€
Â·
hord
.
Then
the
coeï¬ƒcient
of
the
smallest
power
of
q
in
the
Fourier
coeï¬ƒcients
of
the
algebraic
theta
function
in
question
on
G
(cf.
the
discussion
of
Â§3)
are
of
the
form:

Â·
hord
âˆ’
2
Â·
(an
element
âˆˆ
Î¼nÂ·hÎ¼
Â·hord
)
1
âˆš
(where

is
a
4-th
root
of
unity
(respectively,
2
times
an
8-th
root
of
unity)
if
hord
is
odd
(respectively,
even)),
with
at
most
one
possible
exceptional
class
of
coeï¬ƒcients
in

If
this
exception
occurs,
and
the
inequality
of
Theorem
5.1
is
an
equality,
then

eï¬€
Â·
G.
G/h
the
coeï¬ƒcient
of
the
smallest
power
of
q
in
this
coeï¬ƒcient
is
of
the
form:

Â·
hord
âˆ’
2
Â·
(a
nonzero
sum
of
two
elements
âˆˆ
Î¼nÂ·hÎ¼
Â·hord
)
1
(where

is
a
4-th
root
of
unity
(respectively,
(respectively,
even)).
âˆš
2
times
an
8-th
root
of
unity)
if
hord
is
odd
Proof.
This
follows
essentially
from
the
above
analysis,
together
with
the
following
remarks:
First
of
all,
it
follows
from
the
fact
that
the
function
j
â†’
(j
+
hÎ¼
Â·
kÎ·
)2
(on
integers
j
such
that
j
â‰¡
hÎ¼
Â·
k0
mod
heï¬€
)
is
â€œessentiallyâ€
injective
(i.e.,
either
injective
or,
if
it
is
not
injective,
then
the
ï¬ber
consists
of
two
elements)
that
the
minima
discussed
above
are
achieved
for
â€œessentiallyâ€
only
one
value
of
j
(where
â€œessentiallyâ€
means
that
there
is
at
most
one
exception,
in
which
case
the
minimum
is
achieved
for
precisely
of
two
values
of
j).
Thus,
by
considering
the
class
of
this
j
modulo
hÎ¼
,
we
see
that
we
need
only
consider
the
restriction
of
Î˜H
to
Get
+
Î³,
for
ï¬xed
Î³
âˆˆ
GÎ¼
.
But
since
(by
deï¬nition)
GÎ¼
=
G/Get
,
it
follows
that
then
we
are
essentially
in
the
situation
of
Â§4,
applied
to
the
data
(EâˆÎ¼
,S
;
LÎ¼
;
Het
,
Get
â†’
EâˆÎ¼
,S
)
31
(so
â€œdord
â€
of
Â§4
becomes
het
/heï¬€
=
hord
in
the
notation
of
the
present
discussion).
Thus,
Theorem
5.2
follows
from
Theorem
4.4.
Note
that
here,
when
we
apply
Theorem
4.4,
the
â€œnâ€
of
Theorem
4.4
becomes
n
Â·
hÎ¼
(in
the
notation
of
the
present
discussion)
since
in
addition
to
translating
by
Î·,
we
are
also
translating
by
Î³
whose
order
in
G/Get
divides
hÎ¼
.
This
completes
the
proof
of
Theorem
5.2.

Â§6.
Generic
Properties
of
the
Norm
In
this
Â§,
we
maintain
the
notation
of
Â§4.
(In
particular,
we
continue
to
assume
that
the
Lagrangian
subgroup
is
of
eÌtale
type.)
The
goal
of
the
present
Â§
is
to
determine
in
which
cases
the
norm
Î½
(of
the
Fourier
transform
of
an
algebraic
theta
function)
is
generically
nonzero
(on
the
moduli
space
of
elliptic
curves
in
characteristic
zero).
Recall
the
notation
m
=
def
m
(m,
d)
Thus,
put
another
way,
m
is
the
order
of
the
torsion
point
d
Â·
Î·.
Deï¬nition
6.1.
If
our
data
satisï¬es
the
conditions:
(1)
d
is
even;
(2)
m
=
2;
(3)
d
Â·
Î·
âˆˆ
G
(where
G
is
the
restriction
subgroup);
then
we
shall
say
that
our
data
is
of
null
type.
If
our
data
is
not
of
null
type,
then
we
shall
say
that
it
is
of
general
type.
Remark.
In
fact,
condition
(1)
of
Deï¬nition
6.1
is
implied
by
conditions
(2)
and
(3).
The
main
result
of
this
Â§
is
the
following:
Proposition
6.2.
The
norm
Î½
(introduced
in
Â§3)
is
generically
zero
on
S
if
and
only
if
our
data
is
of
null
type.
32
Proof.
If
we
work
over
a
global
S
as
in
Â§3,
then
it
is
immediate
that
every
connected
component
of
S
contains
points
at
inï¬nity
at
which
the
restriction
subgroup
G
is
of
multiplicative
type
(cf.
Â§4).
Thus,
it
suï¬ƒces
to
prove
Proposition
6.2
in
the
case
where
G
is
of
multiplicative
type.
Now
we
return
to
a
local
S
(as
in
Â§4,
5).
Since
G
is
of
multiplicative
type,
we
know
the
explicit
form
of
the
restriction
to
G
of
the
theta
function
in
question
(cf.
Â§4):
def
Î˜Î¼
=

k0
(U|Î¼d
)
k0
âˆˆZ/dZ
=

Â·


q
d
(
2
Â·k
+(iÏ‡/n)Â·k)
Â·
Ï‡(k)
1
1
2
kâˆˆZ,
kâ‰¡k0
(mod
d)
q
d
(
2
Â·k
+(iÏ‡/n)Â·k)
Â·
(U|Î¼d
)k
Â·
(Ï‡(k)
+
k
)
Â·
{1
+
(smaller
powers
of
q)}
1
1
2
kâˆˆKCrit
Thus,
if
Î½
is
generically
zero,
then
it
follows
that
we
are
â€œin
the
exceptional
case,â€
and
that
â€œÏ‡(k)
+
k
â€
is
zero.
In
this
case,
Ï‡(k)
+
k
is
equal
(up
to
a
possible
factor
âˆˆ
Î¼âˆ
)
to
Ï‡(d)
+
1.
Thus,
we
obtain:
Ï‡(d)
=
âˆ’1
In
particular,
Ï‡(d)2
=
1.
Now,
relative
to
the
notation
of
[HAT],
Chapter
V,
Â§4,
the
character
Ï‡
may
be
identiï¬ed
with
a
character
â€œÏ‡M
,â€
and
â€œÏ‡M
â€
is
related
to
another
character
Ï‡L
by:
Ï‡M
=
Ï‡L
Â·
Ï‡Î¸
(where
Ï‡Î¸
is
a
ï¬xed
character
which
is
independent
of
the
particulars
of
the
data
under
consideration).
Note
that
all
of
these
characters
are
characters
Î¼n
Ã—
Zet
â†’
Î¼n
.
Next,
recall
that
Ï‡L
,
Ï‡M
(cf.
the
discussion
at
the
beginning
of
[HAT],
Chapter
V,
Â§4)
faithfully
capture
the
twist
induced
on
L
by
translation
by
Î·.
More
precisely,
If
d
is
odd
(respectively,
even),
then
the
order
of
Ï‡L
(respectively,
Ï‡M
)
restricted
to
Î¼n
Ã—
(d
Â·
Zet
)
is
equal
to
the
order
of
d
Â·
Î·,
i.e.,
to
m
.
(Here
the
factor
of
d
arises
since
the
discussion
of
[HAT],
Chapter
V,
concerns,
in
eï¬€ect,
degree
one
line
bundles
on
the
eÌtale
quotient
Eâˆ,S
â†’
Eâˆ,S
/(Z/dZ),
relative
to
our
notation
in
the
present
discussion.)
Thus,
in
summary,
we
obtain
that
Ï‡M
2
|Î¼n
Ã—(dÂ·Zet)
=
Ï‡L
2
|Î¼n
Ã—(dÂ·Zet)
=
1
33
(where
we
use
the
fact
that
since
we
are
in
the
â€œexceptional
caseâ€
(cf.
[HAT],
Chapter
VIII,
Lemma
4.3),
we
are
in
â€œCases
I
or
IIâ€
of
[HAT],
Chapter
V,
Â§4,
which
implies
that
the
restriction
of
Ï‡L
2
,
Ï‡M
2
to
Î¼n
is
trivial).
Thus,
we
obtain
that:
2
Â·
(d
Â·
Î·)
=
1
i.e.,
that
m
=
2.
Also,
since
we
are
â€œin
the
exceptional
caseâ€
(cf.
[HAT],
Chapter
VIII,
proof
of
Lemma
4.3),
it
follows
that
either
we
are
in
â€œCase
Iâ€
(cf.
[HAT],
Chapter
V,
Â§4)
and
d
is
odd,
or
we
are
in
â€œCase
IIâ€
(cf.
[HAT],
Chapter
V,
Â§4)
and
d
is
even.
Suppose
that
we
are
in
â€œCase
Iâ€
(cf.
[HAT],
Chapter
V,
Â§4)
and
d
is
odd.
First,
observe
that
since
m
=
2
and
d
is
odd,
it
follows
that
we
may
assume
that
m
=
2.
Since
we
are
in
â€œCase
I,â€
it
follows
that
Ï‡L
|Î¼n
=
1.
Also,
since
d
is
odd,
and
n
=
4,
it
follows
(from
Ï‡(d)
=
âˆ’1)
that
Ï‡M
2
|Zet
=
1
(but
Ï‡M
|Zet
=
1,
since
Ï‡M
(d)
=
Ï‡(d)
=
âˆ’1),
hence
(by
the
explicit
description
of
Ï‡Î¸
in
[HAT],
Chapter
IV,
Theorem
2.1)
that
Ï‡M
|Zet
=
Ï‡Î¸
|Zet
,
so
Ï‡L
|Zet
=
1.
Thus,
we
obtain
that
Ï‡L
is
trivial.
But
since,
as
remarked
above,
the
order
of
Ï‡L
is
equal
to
m
,
we
thus
obtain
that
m
=
1,
which
is
absurd.
Thus,
we
conclude
that
the
hypothesis
that
Î½
is
generically
zero
implies
that
we
are
in
â€œCase
IIâ€
(cf.
[HAT],
Chapter
V,
Â§4);
that
d
is
even;
and
that
m
=
2.
I
claim
that
d
Â·
Î·
lies
in
G.
Indeed,
this
follows
from
the
fact
that
the
portion
of
Ï‡M
which
governs
the
â€œeÌtale
portionâ€
of
d
Â·
Î·
(i.e.,
the
connected
component
of
the
special
ï¬ber
of
Eâˆ,S
in
which
d
Â·
Î·
lies),
namely,
Ï‡M
|Î¼n
,
is
trivial
(since
we
are
in
â€œCase
IIâ€).
Thus,
the
image
in
the
special
of
Eâˆ,S
of
the
point
d
Â·
Î·
lies
in
the
connected
component
of
the
identity,
so
d
Â·
Î·
âˆˆ
G
(recall
that
we
have
assumed
in
this
discussion
that
G
is
â€œof
multiplicative
typeâ€!),
as
claimed.
This
completes
the
proof
of
the
assertion
that
if
Î½
is
generically
zero,
then
our
data
is
of
null
type.
Thus,
it
remains
to
show
that:
if
our
data
is
of
null
type,
then
Î½
is
generically
zero.
But
this
follows
immediately
from
substitution
into
the
explicit
expression
for
Î˜Î¼
given
above
(i.e.,
one
uses
the
fact
that
Ï‡(âˆ’)
of
any
odd
multiple
of
d
is
equal
to
âˆ’1
to
show
d
that
the
coeï¬ƒcient
of
(U|Î¼d
)
2
vanishes).
This
completes
the
proof
of
Proposition
6.2.

Â§7.
Some
Elementary
Computational
Lemmas
In
the
following
discussion,
we
assume
that
we
are
given
a
ï¬nite
collection
p1
,
p2
,
.
.
.
,
pr
(where
r
â‰¥
1)
of
(distinct)
prime
numbers,
together
with
a
collection
of
positive
integers
e1
,
e2
,
.
.
.
,
er
.
Write
34
def
d
=
pe11
Â·
pe22
Â·
.
.
.
Â·
perr
If
A
âŠ†
{1,
2,
.
.
.
,
r}
is
a
nonempty
subset,
let
us
write
F
(A)
for
the
set
of
functions
Ïˆ
:
A
â†’
Z
(whose
value
at
j
âˆˆ
A
we
write
Ïˆj
)
such
that
for
each
j
âˆˆ
A,
we
have
1
â‰¤
Ïˆj
â‰¤
ej
.
Lemma
7.1.
We
have:


dâˆ’1=
AâŠ†{1,...,r}
{(

2Ïˆ
pj
j
)
âˆ’
1}Â·
jâˆˆA
ÏˆâˆˆF
(A)

(
j
âˆˆA
pj
)
r
/
{
j=1
(pj
+
1)}

âˆ’Ïˆ
pj
j
Â·
(pj
âˆ’
1
+
Î´Ïˆj
,ej
)
Â·
jâˆˆA
where
Î´x,y
is
1
if
x
=
y
and
0
otherwise.
Proof.
It
is
immediate
that
it
is
equivalent
to
verify:
(pe11
Â·
.
.
.
Â·
perr
âˆ’
1)
Â·

âˆ…=AâŠ†{1,...,r}
r

(pj
+
1)
=
j=1
(


pj
)
Â·
j
âˆˆA
/
{(

2Ïˆ
pj
j
)
âˆ’
1}
Â·
jâˆˆA
ÏˆâˆˆF
(A)

âˆ’Ïˆj
pj
Â·
(pj
âˆ’
1
+
Î´Ïˆj
,ej
)
jâˆˆA
Let
us
ï¬rst
ï¬x
A,
and
consider
the
sum
over
Ïˆ
âˆˆ
F
(A).
This
sum
may
be
thought
of
as

2Ïˆ
consisting
of
two
sums,
corresponding
to
the
two
terms
â€œ
jâˆˆA
pj
j
â€
and
â€œâˆ’1.â€
The
ï¬rst
sum
may
be
evaluated
as
follows:

ÏˆâˆˆF
(A)
{
2Ïˆ



ÏˆâˆˆF
(A)
jâˆˆA

jâˆˆA
=
=
=
pj
j
}
Â·
Â·
(pj
âˆ’
1
+
Î´Ïˆj
,ej
)
jâˆˆA
Ïˆ
pj
j
Â·
(pj
âˆ’
1
+
Î´Ïˆj
,ej
)

ej

jâˆˆA
Ïˆj
=1

(pj
j
âˆ’
1)
e
+1
pj
(pj
âˆ’
1)
Â·
+
pj
j
(pj
âˆ’
1)

e
e
+1
pj
j
âˆ’
pj
+
pj
j
=
Î¨j
jâˆˆA
=
âˆ’Ïˆj
pj

Ïˆ
pj
j
Â·
(pj
âˆ’
1
+
Î´Ïˆj
,ej
)
e
âˆ’1
jâˆˆA
jâˆˆA
35
def
e
+1
e
where
we
write
Î¨j
=
pj
j
âˆ’
pj
+
pj
j


ÏˆâˆˆF
(A)
jâˆˆA
âˆ’
âˆ’Ïˆj
pj
.
On
the
other
hand,
Â·
(pj
âˆ’
1
+
Î´Ïˆj
,ej
)

ej

jâˆˆA
Ïˆj
=1
=âˆ’
Â·
(pj
âˆ’
1
+
Î´Ïˆj
,ej
)
âˆ’e
+1

=âˆ’
âˆ’Ïˆj
pj
pâˆ’1
j
Â·
(pj
âˆ’
1)
Â·
(1
âˆ’
pj
j
)
âˆ’e
+1
=
âˆ’1
(1
âˆ’
pâˆ’1
j
)
jâˆˆA

=âˆ’
âˆ’e
+1
(1
âˆ’
pj
j
)
+
pj
j
âˆ’e
+1
+
pj
j
jâˆˆA
Thus,
in
summary,
it
suï¬ƒces
to
show
that:
(pe11
Â·
.
.
.
Â·
perr
âˆ’
1)
Â·
r


(pj
+
1)
=
(
âˆ…=AâŠ†{1,...,r}
j=1

pj
)
Â·

j
âˆˆA
/
Î¨j
âˆ’
1
jâˆˆA
To
do
this,
we
use
induction
on
r.
The
result
is
clear
for
r
=
1.
Thus,
let
us
prove
it
for
r
â‰¥
2,
assuming
the
result
known
for
strictly
smaller
r.
First,
let
us
note
that
the
above
sum
over
A
=
âˆ…
may
be
split
into
three
sums:
the
ï¬rst
(respectively,
second;
third)
corresponding
to
the
case
where
A
=
{1}
(respectively,
1
âˆˆ
A
(but
A
=
{1});
1
âˆˆ
/
A).
Note
that
there
is
a
natural
bijective
correspondence
between
the
second
and
third
types
of
A
given
by
appending/deleting
the
element
â€œ1.â€
Thus,
we
obtain:

(
âˆ…=AâŠ†{1,...,r}
=âˆ’

pj
)
Â·

j
âˆˆA
/
Î¨j
âˆ’
1
jâˆˆA

(


pj
)
+
(
âˆ…=AâŠ†{1,...,r}
j
âˆˆA
/
âˆ…=AâŠ†{1,...,r}


r

=âˆ’
(
âˆ…=AâŠ†{1,...,r}
+

pj
)
+
(
j
âˆˆA
/
1âˆˆAâŠ†{1,...,r},
|A|â‰¥2
(

j
âˆˆA
/
j=2
pj
)
Â·

j
âˆˆA
/

pj
)
Â·
Î¨j
jâˆˆA
pj
)
Â·
Î¨1

jâˆˆA
36
Î¨j
+

âˆ…=A
âŠ†{2,...,r}
(

j
âˆˆA
/

pj
)
Â·

jâˆˆA
Î¨j

=âˆ’
(
âˆ…=AâŠ†{1,...,r}

+

j
âˆˆA
/

AâŠ†{1,...,r}
(

j=2
pj
)
Â·
(Î¨1
+
p1
)
Â·
pj
)
+
(
j
âˆˆA
/
r

(pj
+
1)
+
(
j=1
(

Î¨j

pj
)
Â·
Î¨j
jâˆˆA
1=j
âˆˆA
/

pj
)
Â·
pe11
Â·
(p1
+
1)
j=2

+
(p1
+
1)
Â·
pe11
Â·

pj
)
Â·
pe11
Â·
(p1
+
1)
j=2

r

pj
)
Â·
pe11
Â·
(p1
+
1)
jâˆˆA
âˆ…=A
âŠ†{2,...,r}
=âˆ’
r

1=j
âˆˆA
/

+
(p1
+
1)
Â·
pe11
Â·
r

pj
)
+
(
j=1

(
âˆ…=A
âŠ†{2,...,r}
=âˆ’
pj
)
âˆ’
(
r

(
âˆ…=A
âŠ†{2,...,r}


pj
)
Â·
Î¨j
jâˆˆA
1=j
âˆˆA
/

Next,
let
us
write
d
=
pe22
Â·
.
.
.
Â·
perr
def
so
d
=
pe11
Â·
d
.
Then
we
have
(d
âˆ’
1)
Â·
r

(pj
+
1)
=
(d
âˆ’
pe11
+
pe11
âˆ’
1)
Â·
j=1
r

(pj
+
1)
j=1
=
pe11
(d
âˆ’
1)
Â·
r

(pj
+
1)
+
(pe11
âˆ’
1)
Â·
j=1
r

(pj
+
1)
j=1
Thus,
by
dividing
by
(p1
+
1),
we
see
that
it
suï¬ƒces
to
show
that:
(pe11
âˆ’
1)
Â·
=âˆ’
r

(pj
+
1)
+
pe11
(d
âˆ’
1)
Â·
j=2
r

j=2
r

(pj
+
1)
j=2
(pj
+
1)
r

e1
+
p1
Â·
(
j=2
pj
)
+
pe11
Â·

âˆ…=A
âŠ†{2,...,r}
But
by
the
induction
hypothesis
on
r,
we
have
37
(

1=j
âˆˆA
/

pj
)
Â·

jâˆˆA
Î¨j
âˆ’
r

r

e1
+
p1
Â·
(
j=2
(pj
+
1)
j=2
=âˆ’
r

(pj
+
1)
j=2
r

e1
+
p1
Â·
(
j=2
=âˆ’
(pj
+
1)
+
pe11
Â·
j=2
=
(pe11
âˆ’
1)
Â·
r


(
âˆ…=A
âŠ†{2,...,r}
+
pe11
Â·
(d
âˆ’
1)
Â·
r


pj
)
+
pe11
Â·
pj
)
Â·
(
âˆ…=A
âŠ†{2,...,r}
(pj
+
1)

pj
)
1=j
âˆˆA
/

(pj
+
1)
j=2
r

(pj
+
1)
+
pe11
Â·
(d
âˆ’
1)
Â·
j=2
r

Î¨j
jâˆˆA
1=j
âˆˆA
/


pj
)
+
pe11
Â·

r

(pj
+
1)
j=2
+
pe11
Â·
(d
âˆ’
1)
Â·
j=2
r

(pj
+
1)
j=2
as
desired.
This
completes
the
proof
of
Lemma
7.1.

Next,
we
shift
gears
and
write
S1
for
the
unit
circle
R/Z,
equipped
with
the
standard
coordinate
Î¸
(arising
from
the
standard
coordinate
on
R).
Write
f
:
S1
â†’
R
for
the
unique
continuous,
piecewise
linear
function
on
S1
which
is
linear
except
at
Î¸
=
0,
12
,
and
satisï¬es:
1
f(
)
=
âˆ’1
2
f(0)
=
+1;
Note
that
f
satisï¬es
the
property:
1
f(Î¸
+
)
=
âˆ’f(Î¸)
2
df
df
and
that
dÎ¸
=
âˆ’4
for
Î¸
âˆˆ
[0,
12
]
and
dÎ¸
=
4
for
Î¸
âˆˆ
[
21
,
1].
Next,
let
us
deï¬ne,
for
N
a
positive
integer:
def
Î¦(N)
=
N
Â·
N
âˆ’1

f(
i=0
def
i
)âˆˆR
N
and
(by
induction
on
N
,
starting
with
Î¦exact
(1)
=
Î¦(1))
38

def
Î¦exact
(N)
=
Î¦(N)
âˆ’
Î¦exact
(a)
a|N,
a<N
where
in
the
sum,
a
ranges
over
all
positive
integers
<
N
which
divide
N
.
In
the
following,
we
would
like
to
compute
Î¦(N)
and
Î¦exact
(N)
explicitly.
Lemma
7.2.
If
N
is
an
odd
positive
integer,
then
Î¦(N)
=
1.
If
N
is
an
even
positive
integer,
then
Î¦(N)
=
0.
Proof.
First,
assume
that
N
is
odd.
Write
def
(S1
)
=
S1
/(
1
Z/Z)
N
for
the
quotient
of
S1
by
the
subgroup
N1
Z/Z
âŠ†
S1
.
Thus,
(S1
)
is
also
naturally
isomorphic
to
a
copy
of
S1
.
Write
Î¸
for
the
standard
coordinate
on
(S1
)
.
Thus,
Î¸
=
N
Â·
Î¸.
Let
def

g(Î¸
)
=
N
âˆ’1

f(Î¸
+
i=0
i
)
N
for
the
â€œpush-forwardâ€
of
f
to
(S1
)
.
(Thus,
g
:
(S1
)
â†’
R.)
Note
that
g
is
itself
continuous
and
piecewise
linear
on
(S1
)
.
Moreover,


f=
g=0
S1
(S1
)
Finally,
the
derivative
of
g
for
â€œgenericâ€
(i.e.,
all
but
ï¬nitely
many
exceptional
values)
Î¸
may
be
computed
as
follows:

df
i
dg
dg

(Î¸
)
=
N
Â·

(Î¸
)
=
(
)(Î¸
+
)
dÎ¸
dÎ¸
dÎ¸
N
N
âˆ’1
i=0
=4Â·
N
âˆ’1

Ï‡[
12
,1]
(Î¸
+
i=0
i
i
)
âˆ’
Ï‡[0,
12
]
(Î¸
+
)
N
N
=
4
Â·
{Ï‡[
12
,1]
(Î¸
)
âˆ’
Ï‡[0,
12
]
(Î¸
)}
where
(for
an
interval
[a,
b]
âŠ†
R)
Ï‡[a,b]
denotes
the
indicator
function
on
this
interval
(i.e.,
it
is
=
1
on
[a,
b]
and
=
0
outside
of
[a,
b]),
and,
in
the
ï¬nal
equality,
we
make
essential
use
of
the
fact
that
N
is
odd.
39
But
note
that
these
properties
imply
that
N
Â·
g
on
(S1
)
â€œlooks
just
likeâ€
f
on
S1
.
Thus,
in
particular,
it
follows
that
Î¦(N)
=
N
Â·
g(0)
=
f(0)
=
1
as
desired.
Now
assume
that
N
is
even.
Then
observe
that
Î¦(N)
is
deï¬ned
as
(essentially)
the
sum
of
the
values
of
the
function
f
over
a
certain
ï¬nite
set
of
points
of
S1
.
Moreover,
since
N
is
even,
it
follows
that
this
set
is
invariant
with
respect
to
the
automorphism
of
S1
given
by
Î¸
â†’
Î¸
+
12
.
Since
f(Î¸
+
12
)
=
âˆ’f(Î¸),
we
thus
obtain
Î¦(N)
=
0,
as
desired.

Lemma
7.3.
We
have:
Î¦exact
(1)
=
1,
Î¦exact
(2)
=
âˆ’1.
Moreover,
if
N
is
any
positive
integer
=
1,
2,
then
Î¦exact
(N)
=
0.
Proof.
By
deï¬nition
Î¦exact
(1)
=
Î¦(1)
=
1,
and
Î¦exact
(2)
=
Î¦(2)
âˆ’
Î¦(1)
=
0
âˆ’
1
(by
Lemma
7.2).
The
ï¬nal
assertion
is
proven
by
induction
on
N
.
This
assertion
is
vacuous
for
N
=
1,
2.
Thus,
assume
that
N
â‰¥
3,
and
that
the
assertion
in
question
is
known
for
strictly
smaller
N
.
We
begin
with
the
case
of
N
odd.
In
this
case,
2
does
not
divide
N
,
so,
by
the
induction
hypothesis,
we
obtain
(from
the
deï¬nition
of
Î¦exact
(N)):
Î¦exact
(N)
=
Î¦(N)
âˆ’
Î¦(1)
=
1
âˆ’
1
=
0
(by
Lemma
7.2).
This
completes
the
case
when
N
is
odd.
Now
assume
that
N
is
even.
In
this
case,
for
all
a
as
in
the
sum
appearing
in
the
deï¬nition
of
Î¦exact
(N),
we
have
Î¦exact
(a)
=
0,
unless
a
=
1,
2.
Moreover,
in
this
case,
a
=
1,
2
both
appear,
so
we
get:
Î¦exact
(N)
=
Î¦(N)
âˆ’
{Î¦exact
(1)
+
Î¦exact
(2)}
=
0
âˆ’
{1
âˆ’
1}
=
0
(by
Lemma
7.2),
as
desired.

Â§8.
The
Various
Contributions
at
Inï¬nity
In
this
Â§,
we
piece
together
the
results
of
Â§5,
6,
and
7,
to
obtain
the
main
result
of
this
paper
concerning
degrees.
This
result
concerning
degrees
is
the
main
technical
result
underlying
the
theory
of
this
paper.
In
particular,
the
theorems
of
Â§9,
10,
below,
will
essentially
be
formal
consequences
of
this
result
concerning
degrees.
40
The
main
point
is
that
the
various
computations
performed
in
Â§5,
6,
and
7
are
suï¬ƒcient
to
compute
the
total
degree
of
vanishing
of
the
norm
Î½
of
Â§3,
as
follows.
In
this
Â§,
we
use
the
notation
of
the
latter
part
of
Â§3
(i.e.,
we
assume
that
S
is
a
curve
in
characteristic
0).
As
usual,
degrees
will
always
be
expressed
in
log(q)
units.
The
total
degree
of
vanishing
of
Î½
will
be
a
weighted
sum/average
over
all
the
possibilities
for
H
(the
Lagrangian
subgroup)
and
G
(the
restriction
subgroup).
In
the
following
discussion,
we
shall
write
(cf.
Â§7)
def
d
=
pe11
Â·
pe22
Â·
.
.
.
Â·
perr
(where
p1
,
.
.
.
,
pr
are
distinct
prime
numbers;
and
e1
,
.
.
.
,
er
are
positive
integers).
First,
let
us
observe
that
the
estimate
(from
below)
for
deg(Î½)
in
Theorem
5.1
(as
a
function
of
G,
H)
depends
only
on
heï¬€
.
For
a
given
G,
H,
we
shall
refer
to
the
primes
Î¼
that
divide
heï¬€
=
|ImEâˆ
,S
(Get
)
Î¼d
|
(cf.
Theorem
5.1)
as
active
primes.
Thus,
the
set
Î¼
of
active
primes
forms
a
subset
A
âŠ†
{1,
.
.
.
,
r}
For
each
active
prime
pj
,
the
pj
-primary
part
of
the
resulting
heï¬€
(cf.
Â§5)
is
equal
to
some
Ïˆ
pj
j
.
Thus,
we
obtain
a
function
Ïˆ:Aâ†’Z
given
by
j
â†’
Ïˆj
,
and
(by
deï¬nition)
we
have:
heï¬€
=

Ïˆ
pj
j
jâˆˆA
Next,
let
us
observe
that
the
probability
that,
at
a
given
point
at
inï¬nity,
the
pj
Ïˆ
primary
part
of
heï¬€
has
order
pj
j
for
all
j
âˆˆ
A,
and
order
1
for
all
j
âˆˆ
/
A,
is
given
by:


pj
âˆ’
1
+
Î´Ïˆj
,ej
Ïˆ
jâˆˆA
(pj
+
1)pj
j
Â·


pj
pj
+
1
j
âˆˆA
/
Indeed,
clearly
what
happens
for
one
pj
is
independent
of
what
happens
for
the
other
pj
â€™s.
Thus,
the
probability
in
question
is
equal
to
the
product
of
the
probabilities
for
each
individual
pj
.
On
the
other
hand,
to
compute
the
probability
for
a
given
pj
,
we
make
use
of
the
following
lemma
(where
we
think
of
â€œMâ€
as
the
module
of
d-torsion
points
in
the
Tate
curve;
â€œ(Z/pe
Z)
âŠ•
0â€
as
the
submodule
deï¬ned
by
â€œÎ¼pej
â€;
â€œN
â€
as
the
submodule
j
deï¬ned
by
the
restriction
subgroup
G;
â€œpâ€
as
pj
;
â€œeâ€
as
ej
;
and
â€œe
â€
as
Ïˆj
):
41
Lemma
8.1.
Let
p
be
a
prime
number,
and
e,
e
positive
integers
such
that
e
â‰¤
e.
def
Write
M
=
(Z/pe
Z)
âŠ•
(Z/pe
Z).
Then
the
fraction
of
rank
one
free
Z/pe
Z-submodules


N
âŠ†
M
which
are
equal
to
the
module
(Z/pe
Z)
âŠ•
0
modulo
pe
but
not
modulo
pe
+1
(if
e
<
e)
is
given
by:
p
âˆ’
1
+
Î´e
,e
(p
+
1)pe
On
the
other
hand,
the
fraction
of
rank
one
free
Z/pe
Z-submodules
N
âŠ†
M
which
are
not
p
equal
to
the
module
(Z/pe
Z)
âŠ•
0
modulo
p
is
given
by
p+1
.
Proof.
Indeed,
the
computation
of
the
second
fraction
is
immediate,
so
let
us
concentrate
on
the
computation
of
the
ï¬rst
fraction.
First
of
all,
the
fraction
of
rank
one
free
Z/pe
Zsubmodules
N
âŠ†
M
which
are
equal
to
the
module
(Z/pe
Z)
âŠ•
0
modulo
p
is
given
by
1
p+1
Such
N
admit
a
unique
generator
of
the
form
Î³
=
(1,
aÎ³
),
where
aÎ³
âˆˆ
pZ/pe
Z.
Thus,
the
1
ï¬rst
fraction
in
the
statement
of
Lemma
8.1
is
equal
to
p+1
times
the
fraction
of
aÎ³
which


are
â‰¡
0
modulo
pe
but
not
modulo
pe
+1
(if
e
<
e).
The
fraction
of
such
aÎ³
is
given
by:




peâˆ’e
âˆ’
peâˆ’e
âˆ’1
|pe
Z/pe
Z|
âˆ’
|pe
+1
Z/pe
Z|
=
|pZ/pe
Z|
peâˆ’1

peâˆ’e
(1
âˆ’
pâˆ’1
)
=
peâˆ’1


pâˆ’e
(1
âˆ’
pâˆ’1
)
=
=
pâˆ’e
(p
âˆ’
1)
âˆ’1
p
if
e
<
e,
and



|pe
Z/pe
Z|
peâˆ’e
=
p1âˆ’e
=
e
eâˆ’1
|pZ/p
Z|
p
1
if
e
=
e.
Thus,
multiplying
by
p+1
gives
the
desired
result.

Now
let
us
recall
the
estimate
(for
a
ï¬xed
G,
H)
of
Theorem
5.1:
AvgÎ·
(deg(Î½))
â‰¥
(d/heï¬€
)
Â·
Z

(d,
heï¬€
,
m
)
On
the
other
hand,
Z

(d,
heï¬€
,
m
)
has
been
computed
in
Proposition
3.3.
Note,
moreover,
that
by
Lemma
7.3,
the
â€œÏ†1
(âˆ’)â€
term
in
the
expressions
of
Proposition
3.3
vanishes
if
42
d
is
odd
or
m
=
2.
(Indeed,
up
to
a
nonzero
factor,
one
computes
that
the
diï¬€erences
Ï†1
(Î¸
+
12
)
âˆ’
Ï†1
(Î¸)
are
equal
(as
functions
on
S1
)
to
the
function
â€œfâ€
studied
in
the
latter
portion
of
Â§7.
Thus,
the
asserted
vanishing
follows
from
the
equality
Î¦exact
(m
)
=
0
proven
in
Lemma
7.3.)
Thus,
in
the
following,
we
shall
assume
ï¬rst
that
either
d
is
odd,
or
(if
d
is
even,
then)
m
=
2.
We
will
return
later
to
the
exceptional
case
where
d
is
even
and
m
=
2.
Thus,
under
the
present
assumptions
on
d
and
m
,
we
obtain
(by
Proposition
3.3):
(d/heï¬€
)
Â·
Z

(d,
heï¬€
,
m
)
=
1
((heï¬€
)2
âˆ’
1)
24
(where
we
omit
the
â€œlog(q)â€
since
we
will
always
work
in
log(q)
units).
Thus,
substituting
the
expression
for
heï¬€
given
above,
and
then
taking
the
weighted
sum
(relative
to
the
probabilities
for
various
types
of
G,
H
computed
above),
we
obtain
the
following
estimate
for
the
total
degree
of
vanishing
degtot
(Î½)
of
the
norm
Î½
at
the
various
points
at
inï¬nity
of
S:
degtot
(Î½)
â‰¥


AâŠ†{1,...,r}
ÏˆâˆˆF
(A)
1

2Ïˆj
pj
)
âˆ’
1}Â·
{(
24
jâˆˆA


pj
âˆ’
1
+
Î´Ïˆj
,ej
Ïˆ
jâˆˆA
(pj
+
1)pj
j
Â·


pj
pj
+
1
j
âˆˆA
/
1
(d
âˆ’
1)
24
=
deg(MâŠ—d
âŠ—
KâŠ—d
)
âˆ’
d
Â·
[L
Â·
e]
=
=
deg(MâŠ—d
âŠ—
KâŠ—d
)
where
in
the
ï¬rst
equality
(respectively,
second;
third),
we
apply
Lemma
7.1
(respectively,
Proposition
3.2;
Proposition
3.2
and
the
above
discussion
concerning
Ï†1
(âˆ’)).
On
the
other
hand,
since
Î½
is,
by
deï¬nition,
a
section
of
the
line
bundle
MâŠ—d
âŠ—
KâŠ—d
(cf.
Â§3),
we
thus
conclude
that
all
the
zeroes
of
Î½
have
been
accounted
for
in
the
estimates
of
Theorem
5.1,
i.e.,
that
(under
the
assumption
that
d
is
odd
or
m
=
2):
The
norm
Î½
is
invertible
away
from
the
points
at
inï¬nity,
and,
moreover,
the
inequalities
of
Theorem
5.1
are
all
equalities.
Note
that
we
make
use
here
of
the
fact
that
(since
d
is
odd
or
m
=
2)
Î½
is
nonzero
on
a
dense
open
subset
of
S,
by
Proposition
6.2.
It
remains
to
examine
the
case
where
d
is
even,
and
m
=
2.
By
the
theory
of
Â§6,
if
our
data
is
of
null
type
(cf.
Deï¬nition
6.1),
then
Î½
will
be
generically
zero
(cf.
Proposition
6.2).
Thus,
we
assume
that
our
data
is
of
general
type
(cf.
Deï¬nition
6.1).
Note
that
the
43
estimate
from
below
for
degtot
(Î½)
will
essentially
be
the
same
as
before,
except
that
we
obtain
an
additional
term
(cf.
Proposition
3.3)
1
âˆ’Ï†1
(âˆ’d
Â·
Î·Î¹
+
)
+
Ï†1
(âˆ’d
Â·
Î·Î¹
)
2
at
those
points
at
inï¬nity
Î¹
where
2
is
an
active
prime
(i.e.,
2
âˆˆ
A).
Note
that
here,
since
we
are
not
summing
over
all
Î¹,
but
only
certain
special
Î¹,
it
is
important
that
we
keep
both
of
the
two
terms
â€œÏ†1
(âˆ’)â€
in
the
above
expression
(i.e.,
it
is
not
the
same,
in
this
case,
to
just
compute
the
sum
of
the
âˆ’Ï†1
(âˆ’d
Â·
Î·Î¹
+
12
)
over
the
speciï¬c
Î¹
in
question)
â€”
cf.
the
computations
of
[HAT],
Chapter
VI,
proof
of
Theorem
3.1,
in
the
even
case.
1
=
13
.
Moreover,
at
such
Î¹,
we
have:
Next,
note
that
the
probability
that
2
âˆˆ
A
is
2+1
d
Â·
Î·Î¹
âˆˆ
/
G
(since
our
data
is
of
general
type).
But
the
fact
that
2
âˆˆ
A
implies
that
2
G
=
Î¼2
,
so
we
thus
obtain
that
at
such
Î¹,
d
Â·
Î·Î¹
=
12
.
Thus,
the
net
contribution
to
the
estimate
from
below
for
degtot
(Î½)
is:
1
1
1
1
1
1
1
1
1
1
(âˆ’Ï†1
(âˆ’
+
)
+
Ï†1
(âˆ’
))
=
(âˆ’Ï†1
(0)
+
Ï†1
(âˆ’
))
=
(âˆ’
âˆ’
)
=
âˆ’
3
2
2
2
3
2
3
12
24
24
Let
us
refer
to
this
contribution
as
the
ï¬rst
new
contribution.
On
the
other
hand,
in
the
present
context
(where
d
is
even
and
m
=
2),
the
degree
1
(d
âˆ’
1),
since
âˆ’d
Â·
[L
Â·
e]
is
of
the
line
bundle
deg(MâŠ—d
âŠ—
KâŠ—d
)
is
no
longer
equal
to
24
not
necessarily
zero
(cf.
Proposition
3.2).
The
resulting
contribution
of
this
new
term
â€”
which
we
shall
refer
to
as
the
second
new
contribution
â€”
is
given
by:
âˆ’d
Â·
[L
Â·
e]
=

Î¹
2
1
1
1
1
1
Ï†1
(âˆ’d
Â·
Î·Î¹
+
)
=
Ï†1
(âˆ’
+
)
+
Ï†1
(0
+
)
2
3
2
2
3
2
2
1
1
1
1
2
1
1
âˆ’
Â·
=
=
Ï†1
(0)
+
Ï†1
(
)
=
Â·
3
3
2
3
12
3
24
24
where
we
note
the
following:
(1)
In
the
ï¬rst
equality,
since
this
time
we
are
summing
over
all
points
at
inï¬nity
Î¹,
we
are
free
to
use
just
the
single
term
â€œÏ†1
(âˆ’d
Â·
Î·Î¹
+
12
)â€
(instead
of
the
diï¬€erence
â€œÏ†1
(âˆ’d
Â·
Î·Î¹
+
12
)
âˆ’
Ï†1
(âˆ’d
Â·
Î·Î¹
)â€).
(2)
In
the
second
equality,
we
use
the
fact
that
the
probability
that
dÂ·Î·Î¹
=
12
(respectively,
d
Â·
Î·Î¹
=
0)
is
23
(respectively,
13
)
â€”
cf.
Lemma
8.1
in
the
case
p
=
2.
Note,
in
particular,
that
the
ï¬rst
and
second
new
contributions
cancel
one
another
out
in
our
estimate
from
below
for
degtot
(Î½).
Thus,
by
the
same
reasoning
as
in
the
case
where
44
d
is
odd
or
m
=
2,
we
conclude
the
following
result,
which
is
the
main
technical
result
of
this
paper:
Theorem
8.2.
If
the
given
data
(i.e.,
d,
m
,
and
Î·)
are
of
general
type
(cf.
Deï¬nition
6.1),
then
the
norm
Î½
of
Â§3
is
invertible
away
from
the
points
at
inï¬nity,
and,
moreover,
the
inequalities
of
Theorem
5.1
are
all
equalities.
If
the
given
data
(i.e.,
d,
m
,
and
Î·)
are
of
null
type
(cf.
Deï¬nition
6.1),
then
the
norm
Î½
of
Â§3
is
identically
zero.
Â§9.
The
Main
Theorem
So
far,
our
discussion
has
mainly
been
in
characteristic
zero.
In
this
present
Â§,
we
observe
that
what
we
have
done
so
far
extends
immediately
to
mixed
characteristic.
This
observation
allows
us
to
state
and
prove
the
main
theorem
of
this
paper,
concerning
the
invertibility
of
the
coeï¬ƒcients
of
the
Fourier
transform
of
an
algebraic
theta
function
in
mixed
characteristic.
Our
notation
is
as
at
the
beginning
of
Â§3.
To
review
(cf.
Â§3
for
more
details):
S
log
is
a
Z-ï¬‚at
ï¬ne
noetherian
log
scheme;
C
log
â†’
S
log
is
a
log
elliptic
curve
which
is
smooth
over
a
schematically
dense
open
subscheme
of
S,
hence
deï¬nes
a
â€œdivisor
at
inï¬nityâ€
(i.e.,
the
pull-back
via
the
associated
classifying
morphism
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
)
D
âŠ†
S.
Moreover,
we
have
a
stack
Sâˆ
obtained
from
S
by
adjoining
the
roots
of
the
q-parameters
at
the
locus
D
âŠ†
S
over
which
C
log
â†’
S
log
degenerates,
together
with
a
smooth
group
scheme
f
:
Eâˆ,S
â†’
Sâˆ
(which
is
useful
for
carrying
out
the
constructions
of
[Zh]).
Let
m,
d
be
positive
integers
such
that
m
does
not
divide
d,
and
Î·
âˆˆ
Eâˆ,S
(Sâˆ
)
be
a
torsion
point
of
order
m.
Then
Î·
deï¬nes
a
certain
natural
metrized
line
bundle
L
which
ev
â€”
in
the
notation
of
[HAT],
Chapter
V,
Â§1
â€”
is
equal
to
Lst,Î·
(respectively,
Lst,Î·
)
if
d
is
odd
(respectively,
even).
The
push-forward
fâˆ—
L
of
this
metrized
line
bundle
to
Sâˆ
deï¬nes
a
metrized
vector
bundle
on
Sâˆ,
equipped
with
the
action
of
a
certain
natural
theta
group
scheme
GL
(cf.
[HAT],
Chapter
IV,
Â§5).
Next,
we
assume
that
we
are
given
ï¬nite,
ï¬‚at
(i.e.,
over
Sâˆ
)
subgroup
schemes
G,
H
âŠ†
Eâˆ,S
which
are
eÌtale
locally
isomorphic
to
Z/dZ
in
characteristic
0
(i.e.,
after
tensoring
with
Q),
and
which
satisfy
H
Ã—
G
=
d
Eâˆ,S
âŠ†
Eâˆ,S
.
(where
d
Eâˆ,S
is
the
kernel
of
multiplication
by
d
on
Eâˆ,S
).
We
shall
refer
to
G
as
the
restriction
subgroup
(since
its
principal
use
will
be
as
a
collection
of
points
to
which
we
will
restrict
sections
of
L),
and
H
as
the
Lagrangian
subgroup
(since
its
primary
use
will
be
to
descend
L).
When
d
is
even,
we
also
assume
that
we
are
given
splittings
Gspl
,
Hspl
of
certain
natural
surjections

â†’
G,
H

â†’
H
(cf.
Â§3
for
more
details).
With
this
data,
we
obtain
(regardless
of
the
G
parity
of
d)
liftings
G,
H
âŠ†
GL
of
G,
H
âŠ†
d
Eâˆ,S
.
Using
H
âŠ†
GL
,
we
may
descend
L
to
a
def
line
bundle
LH
on
EâˆH
,S
=
Eâˆ,S
/H.
45
We
are
now
ready
to
give
the
ï¬rst
main
result
of
this
paper:
Theorem
9.1.
(Invertibility
of
the
Coeï¬ƒcients
of
the
Fourier
Transform
of
an
Algebraic
Theta
Function)
Suppose
that
we
are
given
C
log
â†’
S
log
,
m,
d,
Î·,
G,
Gspl
,
H,
and
Hspl
,
as
above.
Let
us
regard
the
Fourier
expansion
morphism
E
:
(fH
)âˆ—
LH
â†’
OG

âŠ—OSâˆ
K
def
(where
K
=
L|e
is
the
restriction
of
L
to
the
identity
section
e
of
Eâˆ,S
)
for
the
algebraic
theta
functions
obtained
by
restricting
global
sections
of
LH
to
G
as
a
â€œsectionâ€
of
the
OSâˆ
-algebra
OG

which
is
well-deï¬ned
up
to
scalar
multiples.
If
our
data
is
of
null
type
(a
condition
on
d,
m,
Î·,
and
G
â€”
cf.
Deï¬nition
6.1),
then
the
norm
Î½
of
E
is
generically
zero.
If
our
data
is
of
general
type
(a
condition
on
d,
m,
Î·,
and
G
â€”
cf.
Deï¬nition
6.1),
then
E
satisï¬es
the
following
invertibility
properties:
def
(1)
E
is
invertible
over
(US
)Q
(where
US
=
S
âˆ’
D;
the
subscripted
Q
denotes
â€œâŠ—ZQâ€).
(2)
Let
Î¹
âˆˆ
D
be
a
point
at
inï¬nity.
Let
def
hÎ¼
=
|H
Î¼d
|;
def
het
=
d/hÎ¼
;
def
heï¬€
=
|ImEâˆ
Î¼
,S
(Get
)
Î¼
Î¼d
|;
def
hord
=
het
/heï¬€
be
the
local
invariants
at
Î¹
deï¬ned
in
Â§5.
Then
in
a
neighborhood
of
Î¹,
the
endomorphisms
of
the
OSâˆ
-algebra
OG

deï¬ned
by
multiplying
by
local
generators
of
the
image
of
E
may
be
written
(for
an
appropriate
basis)
as
diagonal
matrices
whose
diagonal
entries
are
of
the
form
d
Â·

Â·
hord
âˆ’
2
Â·
Ï‰
Â·
q
d
Â·cRem(j,heff
)
(Case
XÎ¹
)
Â·
(a
unit
â‰¡
1
modulo
q
(>0)
)
1
1
âˆš
where

is
a
4-th
root
of
unity
(respectively,
2
times
an
8-th
root
of
unity)
if
hord
is
odd
(respectively,
even);
Ï‰
is
a
sum
of
either
one
or
two
elements
of
Î¼nÂ·hÎ¼
Â·hord
(in
fact,
in
all
but
one
exceptional
case,
Ï‰
âˆˆ
Î¼nÂ·hÎ¼
Â·hord
);
the
notation
cj
(Case
XÎ¹
)
is
as
in
Â§3
(cf.
[HAT],
Chapter
V,
Â§4,
for
more
details);
j
ranges
from
1
to
d;
and
Rem(j,
heï¬€
)
denotes
the
unique
positive
integer
â‰¤
heï¬€
which
is
â‰¡
j
modulo
heï¬€
.
Proof.
The
statement
of
Theorem
9.1
is
essentially
an
amalgamation
of
Theorems
5.2
and
Theorem
8.2.
Note,
in
(2),
that
the
extra
factor
of
d
(relative
to
the
expressions
in
Theorem
5.2)
arises
from
the
fact
that
when
we
take
Fourier
expansions
(i.e.,
apply
the
operator
F
of
Â§1),
the
coeï¬ƒcients
of
the
various
characters
of
G
get
multiplied
by
d.
Also,
46
we
observe
that
although
our
computations
in
Â§4,
5,
were
in
a
characteristic
0
setting,
the
assertions
of
(2)
still
hold,
since
the
various
bases
of
function
spaces
â€”
i.e.,
in
essence,
q-expansions
â€”
that
were
used
in
Â§4,
5,
all
still
form
bases
of
the
corresponding
mixed
characterstic
spaces
â€”
cf.,
e.g.,
[HAT],
Chapter
IV,
Â§2,3,
where
everything
is
done
in
mixed
characteristic.
This
completes
the
proof.

Remark.
The
invertibility
of
the
coeï¬ƒcients
of
the
Fourier
expansion
of
an
algebraic
theta
function
may
be
interpreted
as
the
statement
that
certain
modular
functions
are,
in
fact,
modular
units.
It
would
thus
be
interesting
to
consider
the
meaning
of
Theorem
9.1
from
the
point
of
view
of
the
theory
of
modular
units,
e.g.,
to
see
if
one
can
write
these
new
modular
units
explicitly
in
terms
of
classical
modular
units
such
as
the
Siegel
modular
units
(cf.,
for
instance,
[KL],
Chapter
4).
Â§10.
The
Theta
Convolution
We
maintain
the
notation
of
Â§9.
In
this
Â§,
we
apply
Theorem
9.1
to
study
a
morphism
which
we
call
the
theta
convolution.
This
morphism
is
(essentially)
the
endomorphism
of
the
space
of
functions
on
the
restriction
subgroup
G
given
by
convoluting
with
the
algebraic
theta
function
in
question.
In
particular,
we
observe
that
the
theory
of
the
present
paper
implies
that
this
theta
convolution
satisï¬es
certain
compatibility
properties
relative
to
the
evaluation
morphism
studied
in
[HAT].
In
this
Â§,
let
us
write
Î˜CV
:
Mâˆ’1
âŠ—
OG
â†’
OG
âŠ—
K
def
def
(where
all
tensor
products
are
over
OSâˆ
;
M
=
{(fH
)âˆ—
LH
}âˆ’1
;
K
=
L|e
;
e
âˆˆ
Eâˆ,S
(Sâˆ
)
is
the
identity
section)
for
the
morphism
deï¬ned
as
follows:
First,
recall
that
restricting
sections
of
LH
to
G
deï¬nes
a
morphism
Mâˆ’1
â†’
L|G
âˆ¼
=
OG
âŠ—
K
On
the
other
hand,
the
convolution
operator
âˆ—
(cf.
Â§1)
deï¬nes
a
morphism
OG
âŠ—
OG
â†’
OG
Thus,
if
we
compose
this
convolution
morphism
(tensored
with
K)
with
the
restriction
morphism
Mâˆ’1
â†’
OG
âŠ—
K
(tensored
with
OG
),
we
get
a
morphism
Î˜CV
as
above.
This
morphism
will
be
referred
to
as
the
theta
convolution.
By
Proposition
1.1,
(iii.),
and
Theorem
9.1,
(1),
it
follows
that
Î˜CV
is
invertible
over
(US
)Q
.
Since
Î˜CV
is
generically
invertible,
we
thus
obtain
that
the
image
of
Î˜CV
in
OG
âŠ—
K
âˆ¼
=
L|G
,
which
we
denote
by
47
L|Î˜
G
âŠ†
L|G
is
a
metrized
vector
bundle
on
Sâˆ
which
satisï¬es
âˆ¼
âˆ’1
âŠ—
OG
L|Î˜
G
=M
Note,
moreover,
that
the
inclusion
L|Î˜
G
âŠ†
L|G
is
an
isomorphism
over
(US
)Q
.
On
the
other
hand,
let
us
recall
the
object
â€ 
Eâˆ,[d]
of
[HAT],
Chapter
V,
Â§2.
Over
(US
)Q
,
this
object
is
isomorphic
to
the
universal
extension
of
the
elliptic
curve
E|(US
)Q
â†’
(US
)Q
under
consideration.
Thus,
in
general,
one
may
â€ 
think
of
Eâˆ,[d]
as
a
certain
extension
of
this
universal
extension
over
the
divisor
at
inï¬nity
and
the
points
of
positive
characteristic.
Let
us
write
fâˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{et}
â€ 
for
the
push-forward
consisting
of
sections
of
L
over
Eâˆ,[d]
whose
torsorial
degree
(i.e.,
â€ 
relative
degree
for
the
morphism
Eâˆ,[d]
â†’
Eâˆ,S
)
is
<
d,
equipped
with
the
eÌtale-integral
structure
(cf.
[HAT],
Chapter
V,
Â§3)
at
the
ï¬nite
primes.
Note
that
this
push-forward
forms
a
metrized
vector
bundle
on
Sâˆ
of
rank
d2
.
Since
we
are
given
a
subgroup
scheme
H
âˆ¼
=
H
âŠ†
GL
,
we
thus
obtain
a
natural
action
of
H
on
this
push-forward.
Let
us
denote
by
fâˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{et}H
the
metrized
vector
bundle
on
Sâˆ
of
rank
d
consisting
of
sections
that
are
ï¬xed
by
H.
Then
it
follows
from
[HAT],
Chapter
VI,
Theorem
3.1,
(1),
(2),
that
we
have
a
natural
evaluation
map
ÎG
:
fâˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{et}H
â†’
L|G
which
is
an
isomorphism
over
(US
)Q
.
Now
we
have
the
following
important
application
of
the
theory
of
this
paper
(our
second
main
result):
48
Theorem
10.1.
(The
Theta-Convoluted
Scheme-Theoretic
Comparison
Isomorphism)
Suppose
that
we
are
in
the
situation
of
Theorem
9.1.
Let
us
denote
by
ÎG
:
fâˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{et}H
â†’
L|G
the
evaluation
map
derived
from
[HAT],
Chapter
VI,
Theorem
3.1,
(1).
Write
C
for
the
product
of
all
the
prime
numbers
that
divide
d
or
n.
Then
2d
Â·
C
Â·
ÎG
factors
through
L|Î˜
G
âŠ†
L|G
.
Moreover,
the
resulting
morphism
ÎÎ˜
G
:
fâˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{et}H
â†’
L|Î˜
G
satisï¬es
the
following
properties:
Î˜
(1)
ÎÎ˜
G
is
invertible
over
(US
)Q
.
Moreover,
the
poles
of
the
inverse
of
ÎG
over
US
are
annihilated
by
2d
Â·
C
2.
(2)
There
exists
a
natural
modiï¬cation
of
the
integral
structure
at
inï¬nity
of
fâˆ—
(L|
â€ 
)<d
{et}H
analogous
to
the
new
integral
structure
at
inï¬nity
of
[HAT],
ChapEâˆ,[d]
ter
VI,
Â§1,
with
respect
to
which
ÎÎ˜
G
is
both
integral
and
invertible
over
SQ
.
(Thus,
in
particular,
relative
to
this
modiï¬ed
integral
structure,
ÎÎ˜
G
will
be
integral
over
all
of
S,
and
invertible
over
S,
except
for
poles
annihilated
by
2d
Â·
C
2
.)
Moreover,
just
as
the
new
integral
structure
at
inï¬nity
of
[HAT],
Chapter
VI,
Â§1,
is
given
by
allowing
poles
on
the
1
F
j
/F
jâˆ’1
-portion
of
the
push-forward
of
the
form
q
âˆ’
d
cj
(Case
XÎ¹
)
(cf.
[HAT],
Chapter
VI,
Theorem
3.1,
(3)),
in
the
present
context,
the
new
integral
structure
at
inï¬nity
is
given
by
allowing
poles
on
the
F
j
/F
jâˆ’1
-portion
of
the
push-forward
of
the
form
q
âˆ’
d
{cj
(Case
XÎ¹
)âˆ’cRem(j,heff
)
(Case
XÎ¹)}
1
(where
Rem(j,
heï¬€
)
is
as
in
Theorem
9.1).
Proof.
Over
(US
)Q
,
everthing
is
immediate.
Let
us
prove
that
2d
Â·
C
Â·
ÎG
factors
through
L|Î˜
G
âŠ†
L|G
.
First,
observe
that
2d
Â·
C
is
suï¬ƒcient
to
cancel
the
poles
of
the
inverse
of
1
the
expression
â€œd
Â·

Â·
hord
âˆ’
2
Â·
Ï‰â€
appearing
in
Theorem
9.1.
This
proves
the
existence
of
the
desired
factorization
over
US
.
Thus,
(by
working
over
various
appropriate
ï¬nite,
ï¬‚at
coverings
of
the
moduli
stack
(M1,0
)Z
)
one
sees
that
to
prove
the
existence
of
the
desired
factorization
over
S,
it
suï¬ƒces
to
prove
its
existence
at
the
points
of
DQ
.
To
this
end,
we
recall
from
the
theory
of
[HAT]
(cf.,
especially,
[HAT],
Chapter
V,
Â§4,
Theorem
4.8;
[HAT],
Chapter
VI,
Â§4,
proof
of
Theorem
4.1)
that
to
consider
the
49
restriction
of
sections
of
fâˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{et}H
(as
opposed
to
just
(fH
)âˆ—
LH
)
to
G
amounts
to
considering
the
various
derivatives
of
the
theta
function
in
question.
In
our
case,
this
âˆ‚
j
essentially
amounts
to
considering
the
various
derivatives
(U
Â·
âˆ‚U
)
Î˜
(where
Î˜
is
as
in
Â§4;
j
=
0,
.
.
.
,
d
âˆ’
1).
If
we
then
restrict
such
derivatives
to
G
and
apply
the
appropriate
trivializations
(as
discussed
in
Â§4,
5),
we
see
that
we
obtain
similar
expressions
to
those
obtained
in
Â§4,
5
in
the
case
of
Î˜
itself.
The
only
diï¬€erence
is
that,
in
the
case
of
the
various
derivatives
of
Î˜,
the
leading
terms
(i.e.,
terms
involving
the
smallest
powers
of
q)
as
in
the
statement
of
Theorem
5.2
will
be
multiplied
by
various
constant
factors.
The
point
here,
however,
is
that
the
smallest
power
of
q
for
these
derivatives
of
Î˜
will
always
be
â‰¤
the
smallest
power
of
q
that
arises
in
the
case
of
the
original
Î˜.
Thus,
even
if
we
divide
the
Fourier
coeï¬ƒcients
of
the
restrictions
of
the
derivatives
of
Î˜
by
the
Fourier
coeï¬ƒcients
of
the
corresponding
restrictions
of
Î˜
itself,
the
result
will
remain
integral.
This
implies
the
existence
of
the
factorization
stated
in
Theorem
10.1.
Next,
we
consider
the
invertibility
of
ÎÎ˜
G
over
US
.
The
fact
that
the
the
poles
of
the
inverse
of
ÎÎ˜
over
U
are
annihilated
by
2d
Â·
C
2
follows
formally
from
the
fact
that
the
S
G
poles
of
the
inverse
of
ÎG
are
annihilated
by
C
(cf.
[HAT],
Chapter
VI,
Theorem
4.1,
(2)),
together
with
the
fact
that
2d
Â·
C
Â·
ÎG
is
(by
deï¬nition)
the
composite
of
ÎÎ˜
G
with
another
morphism.
Finally,
we
consider
the
invertibility
of
ÎÎ˜
G
at
the
points
of
DQ
.
The
argument
is
essentially
the
same
as
in
the
proof
above
of
the
existence
of
the
factorization
ÎÎ˜
G
.
Indeed,
just
as
in
the
situation
of
[HAT]
(cf.,
especially,
[HAT],
Chapter
V,
Theorem
4.8;
[HAT],
Chapter
VI,
Theorem
4.1,
(3)),
a
collection
of
local
generators
for
the
new
integral
structure
is
given
by
the
CG
q
âˆ’
d
cj
(Case
XÎ¹)
Â·
Î¶jâˆ’1
1
(for
j
=
1,
.
.
.
,
d),
in
the
present
context,
a
collection
of
local
generators
for
the
new
integral
structure
is
given
by
the
CG
q
âˆ’
d
{cj
(Case
XÎ¹
)âˆ’cRem(j,heff
)
(Case
XÎ¹
)}
Â·
Î¶jâˆ’1
1
1
(for
j
=
1,
.
.
.
,
d).
That
is
to
say,
the
â€œwork
done
by
dividing
by
q
d
cj
(Case
XÎ¹
)
â€
is
partially
absorbed
by
the
inverse
of
the
theta
convolution,
which
results
in
division
by
1
q
d
cRem(j,heff
)
(Case
XÎ¹
)
(cf.
the
theory
of
Â§4,
5;
Theorem
9.1).
Thus,
in
the
present
â€œthetaconvoluted
case,â€
the
desired
integral
structure
at
inï¬nity
is
obtained
by
dividing
by
â€œwhatâ€™s
left.â€
This
completes
the
proof
of
Theorem
10.1.

Remark
1.
In
particular,
we
obtain
that
at
points
at
inï¬nity
Î¹
where
heï¬€
=
d
â€”
i.e.,
when
the
restriction
subgroup
G
is
of
multiplicative
type
â€”
no
modiï¬cation
of
the
integral
structure
at
inï¬nity
is
necessary.
Put
another
way,
at
such
Î¹:
50
The
â€œGaussian
polesâ€
of
the
â€œcomparison
isomorphismâ€
deï¬ned
by
the
theta-convoluted
evaluation
map
ÎÎ˜
G
vanish.
(cf.
the
discussion
of
[HAT],
Introduction,
Â§5.1).
It
is
this
fact/observation
that
formed
the
fundamental
motivation
for
the
author
to
develop
the
theory
of
the
present
paper.
Remark
2.
Just
as
in
[HAT],
Chapter
IX,
Â§3,
we
constructed
an
â€œarithmetic
KodairaSpencer
morphismâ€
from
the
â€œHodge-Arakelov
Comparison
Isomorphismâ€
([HAT],
Chapter
VIII,
Theorem
A)
of
[HAT],
one
can
now
construct
a
theta-convoluted
arithmetic
Kodaira-Spencer
morphism
from
the
theta-convoluted
comparison
isomorphism
of
Theorem
10.1.
The
procedure
is
entirely
formally
analogous
to
what
was
done
in
[HAT],
Chapter
IX,
Â§3,
i.e.,
one
simply
transports
the
natural
Galois
action
on
the
â€œeÌtale
sideâ€
(i.e.,
the
right-hand
side)
of
the
comparison
isomorphism
to
the
â€œde
Rham-theoretic
sideâ€
(i.e.,
the
left-hand
side)
of
the
comparison
isomorphism,
and
considers
the
extent
to
which
this
Galois
action
preserves
the
Hodge
ï¬ltration.
We
leave
the
entirely
routine
details
to
the
reader.
Note
that
the
key
technical
point
here
is
that:
The
range
of
the
theta-convoluted
comparison
isomorphism,
i.e.,
âˆ¼
âˆ’1
âŠ—
OG
L|Î˜
G
=M
admits
a
natural
Galois
action
(arising
from
the
Galois
action
on
G).
Moreover,
we
would
like
to
emphasize
â€”
relative
to
the
context
of
the
theory
of
[HAT]
(cf.,
especially,
the
discussion
at
the
end
of
[HAT],
Chapter
IX,
Â§3)
â€”
that:
The
construction
of
an
arithmetic
Kodaira-Spencer
morphism
in
which
the
Gaussian
poles
have
been
at
least
partially
eliminated
brings
us
one
step
closer
to
the
possibility
of
applying
the
theory
of
[HAT]
and
the
present
paper
to
diophantine
geometry,
as
discussed
in
[HAT],
Introduction,
Â§5.1,
and
[HAT],
Chapter
IX,
Â§3.
Remark
3.
Of
course,
in
order
to
complete
the
analogy
with
the
theory
of
[HAT],
one
must
also
study
the
properties
of
the
theta
convolution
at
archimedean
primes.
Just
as
in
the
theory
of
[HAT],
by
pulling
back
the
natural
metric
on
the
eÌtale
side
of
the
thetaconvoluted
comparison
isomorphism
one
obtains
an
eÌtale
metric
on
the
de
Rham
side
of
the
theta-convoluted
comparison
isomorphism.
The
theta-convoluted
arithmetic
KodairaSpencer
morphism
of
Remark
2
will
have
natural
integrality
properties
with
respect
to
this
eÌtale
metric.
Of
course,
in
order
to
make
use
of
this
machinery,
one
would
like
to
have
more
explicit
information
about
the
eÌtale
metric,
in
particular,
concerning
the
metrics
induced
by
the
eÌtale
metric
on
the
various
subquotients
of
the
Hodge
ï¬ltration
(on
the
de
Rham
side
of
the
theta-convoluted
comparison
isomorphism).
For
the
Hodge-Arakelov
Comparison
Isomorphism
of
[HAT],
this
sort
of
computation
was
carried
out
in
[HAT],
Chapters
VII
51
and
VIII.
It
is
not
diï¬ƒcult
to
compute
what
happens
to
the
â€œHermite,
Legendre,
and
Binomial
Modelsâ€
of
the
theory
of
[HAT]
when
one
introduces
the
theta-convolution.
It
is
the
hope
of
the
author
to
give
an
explicit
exposition
of
this
computation
in
a
future
paper.
Bibliography
[DyMc]
H.
Dym
and
H.
P.
McKean,
Fourier
Series
and
Integrals,
Academic
Press
(1972).
[HAT]
S.
Mochizuki,
The
Hodge-Arakelov
Theory
of
Elliptic
Curves:
Global
Discretization
of
Local
Hodge
Theories,
manuscript.
[KL]
D.
S.
Kubert
and
S.
Lang,
Modular
Units,
Grundlehren
der
mathematischen
Wissenschaften
244,
Springer-Verlag
(1981).
[Lang]
S.
Lang,
Algebraic
Number
Theory,
Graduate
Texts
in
Mathematics
110,
SpringerVerlag
(1986).
[MB]
L.
Moret-Bailly,
Pinceaux
de
varieÌteÌs
abeÌliennes,
AsteÌrisque
129,
Soc.
Math.
France
(1985).
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deï¬ning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
2
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
[Shz]
S.
S.
Shatz,
Group
Schemes,
Formal
Groups,
and
p-divisible
Groups
in
Arithmetic
Geometry,
edited
by
G.
Cornell
and
J.
H.
Silverman,
Springer-Verlag
(1986).
[Zh]
S.
Zhang,
Admissible
pairing
on
a
curve,
Invent.
Math.
112
(1993),
pp.
171-193.
52
