The
Hodge-Arakelov
Theory
of
Elliptic
Curves:
Global
Discretization
of
Local
Hodge
Theories
by
Shinichi
Mochizuki
September
1999
Table
of
Contents
Introduction
§1.
Statement
of
the
Main
Results
§2.
Technical
Roots:
the
Work
of
Mumford
and
Zhang
§3.
Conceptual
Roots:
the
Search
for
a
Global
Hodge
Theory
§3.1.
From
Absolute
Diﬀerentiation
to
Comparison
Isomorphisms
§3.2.
A
Function-Theoretic
Comparison
Isomorphism
§3.3.
The
Meaning
of
Nonlinearity
§3.4.
Hodge
Theory
at
Finite
Resolution
§3.5.
Relationship
to
Ordinary
Frobenius
Liftings
and
Anabelian
Varieties
§4.
Guide
to
the
Text
§5.
Future
Directions
§5.1.
Gaussian
Poles
and
the
Theta
Convolution
§5.2.
Higher
Dimensional
Abelian
Varieties
and
Hyperbolic
Curves
Chapter
I:
Torsors
in
Arakelov
Theory
§0.
Introduction
§1.
Arakelov
Theory
in
Geometric
Dimension
Zero
§2.
Deﬁnition
and
First
Properties
of
Torsors
§3.
Splittings
with
Bounded
Denominators
§4.
Examples
from
Geometry
Chapter
II:
The
Galois
Action
on
Torsion
Points
§0.
Introduction
§1.
Some
Elementary
Group
Theory
§2.
The
Height
of
an
Elliptic
Curve
§3.
The
Galois
Action
on
the
Torsion
of
a
Tate
Curve
§4.
An
Eﬀective
Estimate
of
the
Image
of
Galois
1
Chapter
III:
The
Universal
Extension
of
a
Log
Elliptic
Curve
§0.
Introduction
§1.
Deﬁnition
of
the
Universal
Extension
§2.
Canonical
Splitting
at
Inﬁnity
§3.
Canonical
Splittings
in
the
Complex
Case
§4.
Hodge-Theoretic
Interpretation
of
the
Universal
Extension
§5.
Analytic
Continuation
of
the
Canonical
Splitting
§6.
Higher
Schottky-Weierstrass
Zeta
Functions
§7.
Canonical
Schottky-Weierstrass
Zeta
Functions
Chapter
IV:
Theta
Groups
and
Theta
Functions
§0.
Introduction
§1.
Mumford’s
Algebraic
Theta
Functions
§2.
Theta
Actions
and
the
Schottky
Uniformization
§3.
Twisted
Schottky-Weierstrass
Zeta
Functions
§4.
Zhang’s
Theory
of
Metrized
Line
Bundles
§5.
Theta
Groups
and
Metrized
Line
Bundles
Chapter
V:
The
Evaluation
Map
§0.
Introduction
§1.
Construction
of
Certain
Metrized
Line
Bundles
§2.
The
Deﬁnition
of
the
Evaluation
Map
§3.
Extension
of
the
Etale-Integral
Structure
§4.
Linear
Relations
Among
Higher
Schottky-Weierstrass
Zeta
Functions
§5.
The
Determinant
of
the
Evaluation
Map
§6.
The
Generic
Case
Chapter
VI:
The
Scheme-Theoretic
Comparison
Theorem
§0.
Introduction
§1.
Deﬁnition
of
a
New
Integral
Structure
at
Inﬁnity
§2.
Compatibility
with
Base-Change
§3.
The
Comparison
Isomorphism
in
Characteristic
Zero
§4.
The
Comparison
Isomorphism
in
Mixed
Characteristic
Chapter
VII:
The
Geometry
of
Function
Spaces:
Systems
of
Orthogonal
Functions
§0.
Introduction
§1.
The
Orthogonalization
Problem
§2.
Review
of
Legendre
and
Hermite
Polynomials
§3.
Discrete
Tchebycheﬀ
Polynomials
and
the
Fundamental
Combinatorial
Model
§4.
The
Kähler
Geometry
of
a
Polarized
Elliptic
Curve
§5.
The
Relationship
Between
de
Rham
and
Canonical
Schottky-Weierstrass
Zeta
Functions
§6.
Diﬀerential
Calculus
on
the
Theta-Weighted
Circle
2
Chapter
VIII:
The
Hodge-Arakelov
Comparison
Theorem
§0.
Introduction
§1.
Averages
of
Metrics
§2.
The
Legendre
Model
§3.
The
Truncated
Binomial
Model
§4.
The
Combinatorics
of
the
Full
Binomial
Model
§5.
The
Full
Binomial
Model
§6.
Relations
Among
Various
Norms
and
Zeta
Functions
§7.
The
Comparison
Isomorphism
at
the
Inﬁnite
Prime
Chapter
IX:
The
Arithmetic
Kodaira-Spencer
Morphism
§0.
Introduction
§1.
The
Complex
Case:
The
Classical
“Modular
Theory”
of
the
Upper
Half-Plane
§2.
The
p-adic
Case:
The
Hodge-Tate
Decomposition
as
an
Evaluation
Map
§3.
The
Global
Arithmetic
Case:
Application
of
the
Hodge-Arakelov
Comparison
Isomorphism
Appendix:
Formal
Uniformization
of
Smooth
Abelian
Group
Schemes
3
Introduction
§1.
Statement
of
the
Main
Results
The
main
result
of
this
paper
is
a
Comparison
Theorem
(cf.
Theorem
A
below)
for
elliptic
curves,
which
states
roughly
that:
The
space
of
“polynomial
functions”
of
degree
(roughly)
<
d
on
the
universal
extension
of
an
elliptic
curve
maps
isomorphically
via
restriction
to
the
space
of
(set-theoretic)
functions
on
the
d-torsion
points
of
the
universal
extension.
This
rough
statement
is
essentially
precise
for
(smooth)
elliptic
curves
over
ﬁelds
of
characteristic
zero.
For
elliptic
curves
in
mixed
characteristic
and
degenerating
elliptic
curves,
this
statement
may
be
made
precise
(i.e.,
the
restriction
map
becomes
an
isomorphism)
if
one
modiﬁes
the
“integral
structure”
on
the
space
of
polynomial
functions
in
an
appropriate
fashion.
Similarly,
in
the
case
of
elliptic
curves
over
the
complex
numbers,
one
can
ask
whether
or
not
one
obtains
an
isometry
if
one
puts
natural
archimedean
metrics
on
the
spaces
involved.
In
this
paper,
we
also
compute
precisely
what
modiﬁcation
to
the
integral
structure/metrics
in
all
of
these
cases
(i.e.,
at
p-adic
and
archimedean
primes,
and
for
degenerating
elliptic
curves)
is
necessary
to
obtain
an
isomorphism
(or
something
very
close
to
an
isomorphism).
In
characteristic
zero,
the
universal
extension
of
an
elliptic
curve
may
be
regarded
as
the
de
Rham
cohomology
of
the
elliptic
curve,
with
coeﬃcients
in
the
sheaf
of
invertible
functions
on
the
curve.
On
the
other
hand,
the
torsion
points
of
the
elliptic
curve
may
be
regarded
as
a
portion
of
the
étale
cohomology
of
the
elliptic
curve.
Thus,
one
may
regard
this
Comparison
Theorem
as
a
sort
of
isomorphism
between
the
de
Rham
and
étale
cohomologies
of
the
elliptic
curve,
given
by
considering
functions
on
each
of
the
respective
cohomology
spaces.
When
regarded
from
this
point
of
view,
this
Comparison
Theorem
may
be
thought
of
as
a
sort
of
discrete
or
Arakelov-theoretic
analogue
of
the
usual
comparison
theorems
between
de
Rham
and
étale/singular
cohomology
in
the
complex
and
p-adic
cases.
This
analogy
with
the
“classical”
local
comparison
theorems
can
be
made
very
precise,
and
is
one
of
the
main
topics
of
Chapter
IX.
Using
this
point
of
view,
we
apply
the
Comparison
Theorem
to
construct
a
global/Arakelov-theoretic
analogue
for
elliptic
curves
over
number
ﬁelds
of
the
Kodaira-Spencer
morphism
of
a
family
of
elliptic
curves
over
a
geometric
base.
This
arithmetic
Kodaira-Spencer
morphism
is
studied
in
Chapter
IX.
4
Suppose
that
E
is
an
elliptic
curve
over
a
ﬁeld
K
of
characteristic
zero.
Let
d
be
a
positive
integer,
and
η
∈
E(K)
a
torsion
point
of
order
not
dividing
d.
Write
def
L
=
OE
(d
·
[η])
for
the
line
bundle
on
E
corresponding
to
the
divisor
of
multiplicity
d
with
support
at
the
point
η.
Write
E†
→
E
for
the
universal
extension
of
the
elliptic
curve,
i.e.,
the
moduli
space
of
pairs
(M,
∇M
)
consisting
of
a
degree
zero
line
bundle
M
on
E,
together
with
a
connection
∇M
.
Thus,
E
†
is
an
aﬃne
torsor
on
E
under
the
module
ωE
of
invariant
diﬀerentials
on
E.
In
particular,
since
E
†
is
(Zariski
locally
over
E)
the
spectrum
of
a
polynomial
algebra
in
one
variable
with
coeﬃcients
in
the
sheaf
of
functions
on
E,
it
makes
sense
to
speak
of
the
“relative
degree
over
E”
–
which
we
refer
to
in
this
paper
as
the
torsorial
degree
–
of
a
function
on
E
†
.
Note
that
(since
we
are
in
characteristic
zero)
the
subscheme
d
E
†
⊆
E
†
of
d-torsion
points
of
E
†
maps
isomorphically
to
the
subscheme
d
E
⊆
E
of
d-torsion
points
of
E.
Then
in
its
simplest
form,
the
main
result
of
this
paper
states
the
following:
Theorem
Asimple
.
Let
E
be
an
elliptic
curve
over
a
ﬁeld
K
of
characteristic
zero.
Write
E
†
→
E
for
its
universal
extension.
Let
d
be
a
positive
integer,
and
η
∈
E(K)
a
torsion
def
point
whose
order
does
not
divide
d.
Write
L
=
OE
(d
·
[η]).
Then
the
natural
map
Γ(E
†
,
L)<d
→
L|
dE
†
given
by
restricting
sections
of
L
over
E
†
whose
torsorial
degree
is
<
d
to
the
d-torsion
points
of
E
†
is
a
bijection
between
K-vector
spaces
of
dimension
d2
.
The
remainder
of
the
main
theorem
essentially
consists
of
specifying
precisely
how
one
must
modify
the
integral
structure
of
Γ(E
†
,
L)<d
over
more
general
bases
in
order
to
obtain
an
isomorphism
at
the
ﬁnite
and
inﬁnite
primes
of
a
number
ﬁeld,
as
well
as
for
degenerating
elliptic
curves.
To
state
the
main
theorem
in
its
more
general
form,
it
is
natural
to
work
over
a
ﬁne
noetherian
log
scheme
S
log
(cf.
[Kato]).
Over
the
base
S
log
,
we
consider
what
we
call
a
log
elliptic
curve
C
log
→
S
log
(cf.
Chapter
III,
Deﬁnition
1.1),
i.e.,
the
result
of
pulling
back,
via
some
morphism
S
log
→
log
log
log
(M1,0
)Z
,
the
universal
log
curve
C
log
→
(M1,0
)Z
.
Here,
(M1,0
)Z
is
the
log
moduli
stack
5
of
elliptic
curves
over
Z,
equipped
with
its
natural
log
structure
deﬁned
by
the
divisor
at
inﬁnity,
and
C
→
(M1,0
)Z
is
the
unique
(proper)
semi-stable
curve
of
genus
1,
which
we
equip
with
the
log
structure
deﬁned
by
the
divisor
in
C
which
is
the
pull-back
of
the
divisor
at
inﬁnity
of
(M1,0
)Z
.
In
the
general
version
of
the
main
theorem,
we
must
use
line
bundles
–
which
play
the
role
of
the
line
bundle
L
in
Theorem
Asimple
–
equipped
with
a
metric
as
in
[Zh]
in
a
neighborhood
of
the
divisor
at
inﬁnity
D
⊆
S.
These
metrized
line
bundles
“L”
live
on
a
“Zhang-theoretic
version”
E∞,S
→
S∞
of
C
log
→
S
log
(cf.
Chapter
IV,
§4,5),
and
are
discussed
in
detail
in
Chapter
V,
§1.
For
smooth
elliptic
curves,
these
line
bundles
are
exactly
the
same
as
the
line
bundle
“L”
of
Theorem
Asimple
.
Next,
it
turns
out
that
at
ﬁnite
primes
the
universal
extension
E
†
→
E
is
not
quite
adequate;
instead,
one
must
modify
it
by
multiplying
the
ωE
-portion
of
E
†
by
a
factor
of
†
d
(cf.
Chapter
V,
§2).
The
resulting
object
E[d]
→
E
is
an
ωE
-torsor
which
coincides
with
E
†
over
bases
on
which
d
is
invertible.
In
a
neighborhood
of
the
divisor
at
inﬁnity,
one
†
must
consider
a
version
of
E[d]
which
is
compatible
with
Zhang’s
theory
of
metrized
line
†
bundles.
This
version
of
E[d]
is
denoted
by
†
E∞,[d]
†
(cf.
Chapter
V,
§2).
For
smooth
elliptic
curves
in
characteristic
zero,
E∞,[d]
is
the
same
as
E
†
.
In
the
general
form
of
Theorem
A,
we
would
like
to
consider
sections
of
the
metrized
†
line
bundle
L
over
E∞,[d]
of
torsorial
degree
<
d.
It
turns
out,
however,
that
if
one
just
considers
the
usual
global
section
or
push-forward
functor
in
the
naive
sense,
then
one
does
not
get
the
desired
isomorphism
at
ﬁnite
or
degenerating
primes.
In
order
to
get
the
desired
isomorphism
at
such
primes,
one
must
modify
the
integral
structure
at
those
primes.
The
resulting
push-forward
functor
is
denoted
(fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et}
(cf.
Chapter
VI,
Deﬁnition
1.3).
For
smooth
elliptic
curves
in
characteristic
zero,
this
push-forward
is
the
same
as
the
usual
one.
Finally,
by
restricting
such
sections
of
L
over
†
†
†
E∞,[d]
to
the
d-torsion
points
d
E∞
in
E∞,[d]
,
one
obtains
an
evaluation
map
Ξ{∞,
et}
:
(fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et}
→
(fS
)∗
(L|
†
)
(d
E∞
)
(cf.
Chapter
V,
Proposition
2.2;
Chapter
VI,
Theorem
3.1
(1)).
For
smooth
elliptic
curves
in
characteristic
zero,
this
is
the
same
as
the
map
considered
in
Theorem
Asimple
.
6
We
are
now
ready
to
state
the
main
theorem
of
this
paper
(cf.
Chapter
VIII,
§0,
Theorem
A):
Theorem
A.
(The
Hodge-Arakelov
Comparison
Isomorphism)
Let
d,
m
≥
1
be
integers
such
that
m
does
not
divide
d.
Suppose
that
S
log
is
a
ﬁne
noetherian
log
scheme,
and
let
C
log
→
S
log
be
a
log
elliptic
curve
over
S
log
such
that
the
divisor
at
inﬁnity
D
⊆
S
(i.e.,
the
pullback
of
the
divisor
at
inﬁnity
of
(M1,0
)Z
via
the
classifying
morphism
S
→
(M1,0
)Z
)
is
a
Cartier
divisor
on
S.
Also,
let
us
assume
that
étale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root,
and
that
we
are
given
a
torsion
point
η
∈
E∞,S
(S∞
)
ev
of
order
precisely
m
which
deﬁnes
line
bundles
Lst,η
,
Lst,η
(cf.
Chapter
V,
§1).
If
d
is
def
ev
def
odd
(respectively,
even),
then
let
L
=
Lst,η
(respectively,
L
=
Lst,η
).
Then:
(1)
(Compatibility
with
Base-Change)
The
formation
of
the
push-forward
(cf.
Chapter
VI,
Deﬁnition
1.3)
(fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et}
(along
with
its
natural
ﬁltration
by
torsorial
degree)
commutes
with
base-change
(among
bases
S
log
satisfying
the
hypotheses
given
above).
(2)
(Zero
Locus
of
the
Determinant)
Assume
that
S
is
Z-ﬂat.
The
schemetheoretic
zero
locus
of
the
determinant
det(Ξ{∞,
et}),
i.e.,
the
determinant
of
the
evaluation
map
(cf.
Chapter
V,
Proposition
2.2;
Chapter
VI,
Theorem
3.1,
(1))
Ξ{∞,
et}
:
(fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et}
→
(fS
)∗
(L|
is
given
by
the
divisor
d
·
[η
†
)
(d
E∞
)

7
(d
E)]
(where
d
E
is
the
kernel
of
multiplication
by
d
on
Ed
).
In
fact,
the
divisor
of
poles

of
the
inverse
morphism
to
Ξ{∞,
et}
is
contained
in
the
divisor
[η
(d
E)].
(3)
(Analytic
Torsion
at
the
Divisor
at
Inﬁnity)
For
each
ι,
there
is
a
sequence
of
elements
aι
=
{(aι
)0
,
.
.
.
,
(aι
)d−1
};
(aι
)j
≈
j2
8d
2
j
of
Q≥0
·
log(q),
where
(aι
)j
goes
roughly
(as
a
function
of
j)
as
8d
(cf.
Chapter
VI,
Theorem
3.1,
(2)),
such
that
the
subquotients
of
the
natural
ﬁltration
on
the
domain
of
Ξ{∞,
et}
admits
natural
isomorphisms:
(F
j+1
/F
j
)((fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et})
−→
1
·
exp(−(aι
)j
)
·
(fS
)∗
(L|E∞,S
)
⊗OS
τE⊗j
j!
(where
τE
is
the
dual
of
ωE
)
for
j
=
0,
.
.
.
,
d−1.
Moreover,
the
sections
of
L|
†
E∞,[d]
that
realize
these
bijections
have
q-expansions
in
a
neighborhood
of
inﬁnity
that
are
given
explicitly
in
Chapter
V,
Theorem
4.8.
(4)
(Integrality
Properties
at
the
Inﬁnite
Prime)
Suppose
that
D
=
∅,
and
S
†
†
is
of
ﬁnite
type
over
C.
Let
us
then
write
L,
Ξ,
E
†
,
E
for
L,
Ξ{∞,
et},
E∞
,
d
d
[d]
†
E∞,[d]
.
Then
one
may
equip
L
with
a
(smooth,
i.e.,
C
∞
)
metric
|
∼
|L
whose
curvature
is
translation-invariant
on
the
ﬁbers
of
E
→
S.
Moreover,
such
a
metric
is
unique
up
to
multiplication
by
a
(smooth)
positive
function
on
S(C).
Then
|
∼
|L
deﬁnes
a
metric
on
the
vector
bundle
(fS
)∗
(L|
†
)
(i.e.,
the
range
dE
of
Ξ),
namely,
the
L
-metric
for
“L-valued
functions
on
d
E
†
”
(where
we
assume
that
the
total
mass
of
d
E
†
is
1).
Since
Ξ
is
an
isomorphism,
this
metric
thus
induces
a
metric
on
(fS
)∗
(L|
†
)<d
(i.e.,
the
domain
of
Ξ),
which
we
denote
by
2
E[d]
||
∼
||et
and
refer
to
as
the
étale
metric.
On
the
other
hand,
by
using
the
canonical
real
†
analytic
splitting
of
E[d]
(C)
→
E(C)
(i.e.,
the
unique
splitting
which
is
a
continuous
homomorphism),
we
may
split
sections
of
(fS
)∗
(L|
†
)<d
into
components
E[d]
⊗r
which
are
real
analytic
sections
of
L
⊗
τE
(where
r
<
d)
over
E(C).
Since
τE
gets
a
natural
metric
by
square
integration
over
E,
these
components
have
natural
8
L2
-norms
determined
by
integrating
their
|
∼
|2L
over
the
ﬁbers
of
E(C)
→
S(C).
This
deﬁnes
what
we
refer
to
as
the
de
Rham
metric
||
∼
||DR
on
(fS
)∗
(L|
†
)<d
.
The
relationship
between
the
étale
and
de
Rham
metrics
may
E[d]
be
described
using
three
“models”:
(A.)
The
Hermite
Model:
This
model
states
that
if
we
ﬁx
r
<
d,
and
let
d
→
∞,
then
over
any
compact
subset
of
S(C),
the
étale
metric
||
∼
||et
on
F
r
((fS
)∗
(L|
†
)<d
)
converges
(up
to
a
factor
≤
eπ+r
,
≥
1)
E[d]
to
the
metric
||
∼
||DR
,
as
well
as
to
a
certain
metric
“||
∼
||HMd
”
deﬁned
by
considering
Hermite
polynomials
scaled
by
a
factor
of
√
(constant)·
d
in
the
derivatives
of
the
theta
functions
∈
(fS
)∗
(L|E
)
=
F
1
((fS
)∗
(L|
†
)<d
).
E[d]
(B.)
The
Legendre
Model:
This
model
states
(roughly)
that
over
any
compact
subset
of
S(C),
a
certain
average
–
which
we
denote
||
∼
||w,μa
–
of
translates
of
the
étale
metric
||
∼
||et
on
(fS
)∗
(L|
†
)<d
E[d]
is
equal
(provided
d
≥
25),
up
to
a
factor
of
(constant)
,
to
the
de
Rham
metric
||
∼
||DR
,
as
well
as
to
a
certain
metric
“||
∼
||Tch
”
deﬁned
by
considering
discrete
Tchebycheﬀ
polynomials
scaled
by
a
factor
of
d
in
the
derivatives
of
the
theta
functions
∈
(fS
)∗
(L|E
)
=
F
1
((fS
)∗
(L|
†
)<d
).
These
discrete
Tchebycheﬀ
polynomials
are
disd
E[d]
crete
versions
of
the
Legendre
polynomials,
and
in
fact,
if
we
let
d
→
∞
with
the
said
scaling
by
d,
then
the
discrete
Tchebycheﬀ
polynomials
converge
uniformly
to
the
Legendre
polynomials.
(C.)
The
Binomial
Model:
This
model
involves
the
explicit
q-expansions
(where
we
write
E
=
Gm
/q
Z
,
and
q
is
a
holomorphic
function
which
is
deﬁned,
at
least
locally,
on
S(C))
referred
to
in
(3)
above,
which
are
essentially
binomial
coeﬃcient
polynomials
(scaled
by
1)
in
the
derivatives
of
the
theta
functions
∈
(fS
)∗
(L|E
)
=
F
1
((fS
)∗
(L|
†
)<d
).
E[d]
If
we
divide
these
functions
by
appropriate
powers
of
q,
then
the
norm
||
∼
||qCG
for
which
these
functions
divided
by
powers
of
q
are
orthonormal
satisﬁes
the
following
property:
If
d
≥
12,
and
Im(τ
)
≥
200{log2
(d)
+
n
·
log(d)
+
n
·
log(n)}
(where
q
=
exp(2πiτ
)),
then:
n−1
·
e−32d
·
||
∼
||qCG
≤
||
∼
||et
≤
e4d
·
||
∼
||qCG
9
Here,
the
factor
of
n−1
that
appears
is
the
exact
archimedean
analogue
of
the
poles
that
appeared
at
ﬁnite
primes
in
(2)
above.
Finally,
for
each
of
these
three
models,
the
combinatorial/arithmetic
portion
of
the
analytic
torsion
(i.e.,
the
portion
not
arising
from
letting
the
elliptic
curve
E
degenerate
–
cf.
(3)
above
for
the
portion
arising
from
degeneration
of
the
elliptic
curve)
induced
on
(F
r+1
/F
r
)((fS
)∗
(L|
†
)<d
)
by
the
metrics
||
∼
||DR
;
||
∼
||HMd
;
||
∼
||Tch
;
||
∼
||w,μa
;
E[d]
||
∼
||qCG
(in
their
respective
domains
of
applicability)
as
r
→
d,
goes
(modulo
factors
of
the
order
(constant)d
)
as
≈
(r!)−1
≈
(d!)−1
which
is
precisely
what
you
would
expect
by
applying
the
product
formula
to
the
computation
of
the
“analytic
torsion”
in
the
ﬁnite
prime
case,
which
consists
of
a
factor
of
precisely
(r!)−1
(cf.
Chapter
V,
Theorem
3.1;
Chapter
VI,
Theorem
4.1;
Chapter
VII,
Proposition
3.4).
In
particular,
Theorem
A,
(3),
tells
us
that
the
necessary
modiﬁcation
to
the
integral
structure
of
the
degree
j
portion
of
the
push-forward
at
the
p-adic
and
degenerating
primes
is
a
factor
of
−j
2
1
·
q
8d
j!
−j
2
The
factor
q
8d
involving
the
q-parameter
is
of
fundamental
importance
in
the
theory
of
this
paper.
Because
(as
a
function
of
j)
this
factor
varies
like
a
“Gaussian
exp(−x2
)”
and
gives
rise
to
poles
(relative
to
the
usual
push-forward)
in
the
modiﬁed
push-forward
that
we
consider
in
Theorem
A,
we
refer
to
the
modiﬁcation
in
integral
structure
arising
from
1
in
the
exponent
may
be
justiﬁed
by
the
this
factor
as
the
Gaussian
poles.
The
factor
of
8d
following
calculation:
On
the
one
hand,
if
one
thinks
in
terms
of
degrees
of
vector
bundles
on
(M1,0
)C
,
the
degree
of
the
usual
push-forward
goes
roughly
as
d−1

j=0
deg(τE⊗j
)
=
d−1

j
·
deg(τE
)
≈
j=0
d2
1
2
1
1
d
·
deg(τE
)
=
−
d2
·
log(q)
=
−
·
log(q)
2
2
12
24
where
“log(q)”
is
a
symbol
that
stands
for
the
element
in
Pic((M1,0
)C
)
deﬁned
by
the
divisor
at
inﬁnity.
(It
turns
out
that
the
contribution
to
the
degree
by
the
line
bundle
L
is
negligible.)
On
the
other
hand,
the
sum
of
the
degrees
resulting
from
the
Gaussian
poles
is
d−1
2

j
j=0
8d
·
log(q)
≈
1
3
1
d2
d
·
·
log(q)
=
·
log(q)
3
8d
24
10
1
In
other
words,
the
factor
of
8d
is
just
enough
to
make
the
total
degree
0.
Since
the
restriction
of
L
to
the
torsion
points
is
(essentially)
a
“torsion
line
bundle”
(i.e.,
some
tensor
power
of
it
is
trivial),
the
degree
of
the
range
of
the
evaluation
map
is
zero
–
i.e.,
the
1
is
just
enough
to
make
the
degrees
of
the
domain
and
range
of
the
evaluation
factor
of
8d
map
of
Theorem
A
equal
(which
is
natural,
since
we
want
this
evaluation
map
to
be
an
isomorphism).
In
fact,
It
turns
out
that
the
proof
of
the
scheme-theoretic
portion
of
Theorem
A
in
Chapter
VI,
§3,4,
is
based
on
precisely
this
sort
of
“summation
of
degrees”
argument.
In
this
proof,
however,
in
order
to
get
an
exact
isomorphism,
it
is
necessary
to
compute
all
the
degrees
involved
precisely.
This
computation
requires
a
substantial
amount
of
work
(involving,
for
instance,
the
theory
of
[Zh])
and
is
carried
out
in
Chapters
IV,
V,
VI.
On
the
other
hand,
the
key
point
of
the
archimedean
portion
of
Theorem
A
is
the
comparison
of
the
étale
and
de
Rham
metrics
||
∼
||et
,
||
∼
||DR
.
Unfortunately,
we
are
unable
to
prove
a
simple
sharp
result
that
they
always
coincide.
Instead,
we
choose
three
natural
“domains
of
investigation”
–
which
we
refer
to
as
models
–
where
we
compare
these
two
metrics
using
a
particular
system
of
functions
which
are
well-adapted
to
the
domain
of
investigation
in
question.
One
of
the
most
important
features
of
these
three
models
is
that
they
each
have
natural
scaling
factors
associated
to
them.
The
three
models,
along
with
their
natural
scaling
factors,
and
natural
domains
of
applicability
are
as
follows:
1
Hermite
Model
(scaling
factor
=
d
2
)
:
nondegenerating
E,
ﬁxed
r
<
d
Legendre
Model
(scaling
factor
=
d)
:
nondegenerating
E,
varying
r
<
d
Binomial
Model
(scaling
factor
=
1)
:
degenerating
E
It
is
interesting
to
observe
that
the
exponents
appearing
in
these
scaling
factors,
i.e.,
0,
12
,
1,
which
we
refer
to
as
slopes,
are
precisely
the
same
as
the
slopes
that
appear
when
one
considers
the
action
of
Frobenius
on
the
crystalline
cohomology
of
an
elliptic
curve
at
a
ﬁnite
prime
–
cf.
the
discussions
at
the
end
of
Chapter
VII,
§3,
6,
for
more
on
this
analogy.
Finally,
we
apply
Theorem
A
to
construct
an
arithmetic
analogue
of
the
KodairaSpencer
morphism,
as
follows.
In
the
following
discussion,
we
write
def
ΠS
=
π1
((S
log
)Q
,
s)
def
for
the
algebraic
fundamental
group
of
the
base
S
log
.
Thus,
if
S
=
Spec(OK
),
where
OK
is
the
ring
of
integers
of
a
number
ﬁeld
K,
then
ΠS
=
Gal(K/K)
is
the
absolute
Galois
group
of
K.
In
this
discussion,
we
make
the
technical
assumption
that
if
d
is
even,
then
ΠS
acts
trivially
on
the
2-torsion
of
the
elliptic
curve
in
question.
Then
it
follows
from
Mumford’s
11
theory
of
algebraic
theta
functions
that
ΠS
acts
naturally
(up
to
poles
annihilated
by
4)
on
the
range
of
the
Comparison
Isomorphism
of
Theorem
A.
Thus,
Theorem
A
tells
us
that,
by
transport
of
structure,
we
get
an
action
of
ΠS
on
the
domain
of
the
Comparison
Isomorphism
which
is
(roughly)
integral
at
all
primes
(ﬁnite
and
inﬁnite).
Since
this
domain
is
equipped
with
a
natural
Hodge
ﬁltration,
we
thus
get
a
morphism
:
ΠS
→
Filt(HDR
)(S)
κarith
E
where
Filt(HDR
)(S)
is
a
certain
ﬂag
variety
of
ﬁltrations
of
the
domain
of
the
Comparison
Isomorphism,
which
we
denote
by
HDR
(since
it
is
a
sort
of
de
Rham
cohomology).
This
morphism,
which
we
refer
to
as
the
arithmetic
Kodaira-Spencer
morphism
of
the
given
family
of
elliptic
curves,
has
remarkable
integrality
properties
(cf.
the
discussion
preceding
Chapter
IX,
Deﬁnition
3.4).
In
Chapter
IX,
§1,2,
we
explain
in
detail
how
this
arithmetic
Kodaira-Spencer
morphism
is
a
very
precise
analogue
of
the
classical
Kodaira-Spencer
morphism
for
families
of
complex
and
p-adic
elliptic
curves
(cf.
also
[Katz2]).
In
the
construction
of
all
of
these
Kodaira-Spencer
morphisms,
the
main
idea
consists,
as
depicted
in
the
following
diagram:
Kodaira-Spencer
morphism:
motion
in
base-space
→
induced
deformation
of
Hodge
ﬁltration
of
the
idea
that
the
Kodaira-Spencer
morphism
is
the
map
which
associates
to
a
“motion”
in
the
base-space
of
a
family
of
elliptic
curves,
the
deformation
in
the
Hodge
ﬁltration
of
the
de
Rham
cohomology
of
the
elliptic
curve
induced
by
the
motion.
We
refer
to
Chapter
IX
for
more
details.
§2.
Technical
Roots:
the
Work
of
Mumford
and
Zhang
Let
K
be
an
algebraically
closed
ﬁeld
of
characteristic
0.
Let
E
be
an
elliptic
curve
over
K.
Let
L
be
the
line
bundle
of
Theorem
Asimple
.
Then
instead
of
considering
sections
of
L
over
E
†
,
one
can
consider
sections
of
L
over
E.
Such
sections
may
be
restricted
to
L|d
E
.
Moreover,
by
the
theory
of
algebraic
theta
functions
(cf.
[Mumf1,2,3]),
the
restriction
L|d
E
of
L
to
the
d-torsion
points
d
E
⊆
E
has
a
canonical
trivialization
L|d
E
∼
=
L|e
⊗K
Od
E
(where
e
∈
E(K)
is
the
zero
element)
—
at
least
when
d
is
odd.
Thus,
by
composing
the
restriction
morphism
with
this
trivialization,
we
obtain
a
morphism
(as
in
[Mumf1,2,3]):
Γ(E,
L)
→
L|d
E
∼
=
L|e
⊗K
Od
E
i.e.,
one
may
think
of
sections
of
L
over
E
as
functions
on
d
E.
These
functions
are
Mumford’s
“algebraic
theta
functions.”
12
Now
let
us
observe
that
dimK
(Γ(E,
L))
=
d,
while
dimK
(L|e
⊗K
Od
E
)
=
d2
.
That
is
to
say,
Mumford’s
theory
only
addresses
a
fraction
(more
precisely:
d1
)
of
the
functions
in
L|e
⊗K
Od
E
.
Thus,
it
is
natural
to
ask:
Is
there
a
natural
extension
of
Mumford’s
theory
that
allows
one
to
give
meaning
to
all
the
functions
of
L|e
⊗K
Od
E
as
some
sort
of
“global”
sections
of
L?
Theorem
Asimple
provides
a
natural,
aﬃrmative
answer
to
this
question:
i.e.,
it
states
these
functions
may
be
interpreted
naturally
as
the
sections
of
L
over
the
universal
extension
E
†
of
torsorial
degree
<
d.
In
more
classical
terms,
to
consider
the
universal
extension
amounts
essentially
to
considering
the
derivatives
of
(classical)
theta
functions
(cf.,
e.g.,
[Katz1],
Appendix
C).
For
instance,
if
one
takes
K
=
C,
and
writes
def
θτ
(z)
=

eπiτ
·n
·
e2πiz·n
2
n∈Z
def
for
the
“standard
theta
function”
(where
z
∈
C,
τ
∈
H
=
{w
∈
C
|
Im(w)
>
0}),
then
up
to
the
operation
of
taking
the
Fourier
expansion,
this
theta
function
is
essentially
a
2
∂
“Gaussian
eπiτ
·n
,”
and
its
derivatives
P
(
∂z
)
·
θτ
(z)
(where
P
(−)
is
a
polynomial
with
coeﬃcients
in
C)
are
given
by
polynomial
multiples
of
(which
are
equivalent
to
derivatives
of
)
the
Gaussian:
P
(2πi
·
n)
·
eπiτ
·n
2
Just
as
theta
functions
are
the
“fundamental
functions
on
an
elliptic
curve”
(more
precisely:
generate
the
space
of
sections
of
L
over
E),
these
derivatives
are
the
“fundamental
functions
on
the
universal
extension
of
the
elliptic
curve”
(more
precisely:
generate
the
space
of
sections
of
L
over
E
†
).
This
point
of
view
is
discussed
in
more
detail
in
Chapter
III,
§5,
6,
7;
Chapter
VII,
§6.
As
one
knows
from
elementary
analysis,
the
most
natural
polynomial
multiples/derivatives
of
a
Gaussian
are
those
given
by
the
Hermite
polynomials.
It
is
thus
natural
to
expect
that
the
Hermite
polynomials
should
appear
naturally
in
the
portion
of
the
theory
of
this
paper
concerning
the
behavior
of
the
comparison
isomorphism
at
archimedean
primes.
This
intuition
is
made
rigorous
in
the
theory
of
Chapters
IX,
X.
In
fact,
more
generally:
The
essential
model
that
permeates
the
theory
of
this
paper
is
that
of
the
Gaussian
and
its
derivatives.
This
model
may
be
seen
especially
in
the
“Gaussian
poles,”
as
well
as
in
the
“Hermite
model”
at
the
inﬁnite
prime
(cf.
§1).
13
In
the
classical
theory
over
C,
the
most
basic
derivative
of
the
theta
function
is
the
socalled
Weierstrass
zeta
function
(cf.
[Katz1],
Appendix
C).
It
should
thus
not
be
surprising
to
the
reader
that
various
generalizations
of
the
Weierstrass
zeta
function
–
which
we
refer
to
as
Schottky-Weierstrass
zeta
functions
(cf.
Chapter
III,
§6,
7)
–
play
a
fundamental
role
in
this
paper.
So
far,
in
the
above
discussion,
we
concentrated
on
smooth
elliptic
curves.
On
the
other
hand,
when
one
wishes
to
consider
degenerating
elliptic
curves,
Zhang
has
constructed
a
theory
of
metrized
line
bundles
on
such
degenerating
elliptic
curves
(cf.
[Zh]).
In
this
theory,
one
can
consider
the
curvatures
of
such
metrized
line
bundles,
as
well
as
intersection
numbers
between
two
metrized
line
bundles
in
a
fashion
entirely
similar
to
Arakelov
intersection
theory.
Using
Zhang’s
theory
of
metrized
line
bundles,
it
is
not
diﬃcult
to
extend
Mumford’s
theory
of
algebraic
theta
functions
in
a
natural
fashion
to
metrized
ample
line
bundles
on
degenerating
elliptic
curves
(cf.,
e.g.,
Chapter
IV,
§5,
for
more
details).
Unfortunately,
however,
just
as
Mumford’s
theory
only
addresses
sections
over
the
original
elliptic
curve
(as
opposed
to
over
the
universal
extension,
as
discussed
above),
Zhang’s
theory
also
only
deals
with
the
theory
of
metrized
line
bundles
over
the
original
(degenerating)
elliptic
curve.
Thus,
it
is
natural
to
ask
whether
one
can
generalize
Theorem
Asimple
to
the
case
of
degenerating
elliptic
curves
in
such
a
way
that
the
resulting
generalization
of
the
portion
of
Γ(E
†
,
L)
arising
from
sections
over
E
is
compatible
with
Zhang’s
theory
of
metrized
line
bundles
(and
their
sections)
over
E.
In
other
words,
it
is
natural
to
ask:
Can
one
“de
Rham-ify”
the
theory
of
[Zh],
so
that
it
addresses
the
“metric”
behavior
of
sections
of
L
not
only
over
E,
but
over
E
†
,
as
well?
An
aﬃrmative
answer
to
this
question
is
given
by
the
theory
of
Gaussian
poles,
or
“analytic
torsion
at
the
divisor
at
inﬁnity”
–
cf.
Theorem
A,
(3)
in
§1;
Chapters
V,
VI.
Another
way
to
view
the
relation
to
Zhang’s
theory
is
the
following.
One
consequence
of
the
theory
of
[Zh]
is
the
construction
of
a
natural
“metric”
(or
integral
structure)
on
the
space
ωE
of
invariant
diﬀerentials
on
a
(degenerating)
elliptic
curve.
If
we
regard
ωE
as
a
line
bundle
on
the
compactiﬁed
moduli
space
of
elliptic
curves,
then
Zhang’s
“admissible
1
·
∞)
(where
∞
is
metric”
on
ωE
essentially
amounts
to
the
(metrized)
line
bundle
ωE
(−
12
the
divisor
at
inﬁnity
of
the
moduli
space),
i.e.,
the
line
bundle
ωE
with
integral
structure
1
at
inﬁnity
modiﬁed
by
tensoring
with
O(−
12
·
∞).
Moreover,
it
follows
from
Zhang’s
theory
that
there
is
a
natural
trivialization
ωE
(−
1
·
∞)
∼
=O
12
of
this
metrized
line
bundle
over
the
moduli
space.
The
12-th
tensor
power
of
this
trivialization
is
the
cuspidal
modular
form
usually
denoted
“Δ”
([KM],
Chapter
8,
§8.1).
Similarly,
Theorem
A,
(3),
states
that
by
allowing
“Gaussian
poles”
in
the
sections
of
Γ(E
†
,
L),
one
gets
a
natural
isomorphism
between
Γ(E
†
,
L)
(with
this
modiﬁed
integral
structure)
and
14
a
vector
bundle
which
is
trivial
(in
characteristic
zero)
over
some
ﬁnite
log
étale
covering
of
the
compactiﬁed
moduli
(log)
stack
of
elliptic
curves.
That
is
to
say,
One
may
regard
the
theory
of
Gaussian
poles/analytic
torsion
at
the
divisor
at
inﬁnity
in
Theorem
A,
(3),
as
a
sort
of
“GL2
-analogue”
of
1
the
isomorphism
of
line
bundles
(i.e.,
Gm
-torsors)
ωE
(−
12
·
∞)
∼
=O—
or,
alternatively,
a
GL2
-analogue
of
the
modular
form
Δ.
Note:
The
reason
that
we
mention
“GL2
”
is
that
the
vector
bundle
on
the
“étale
side”
of
the
comparison
isomorphism
of
Theorem
A
arises
naturally
(at
least
in
characteristic
zero)
from
a
representation
(deﬁned
by
the
Galois
action
on
the
d-torsion
points)
of
the
fundamental
group
of
the
moduli
stack
of
elliptic
curves
into
GL2
,
whereas
the
isomorphism
1
ωE
(−
12
·
∞)
∼
=
O
naturally
corresponds
to
an
abelian
representation
(i.e.,
a
representation
into
Gm
which
is,
in
fact,
of
order
12)
of
this
fundamental
group
–
cf.
[KM],
Chapter
8,
§8.1.
§3.
Conceptual
Roots:
the
Search
for
a
Global
Hodge
Theory
§3.1.
From
Absolute
Diﬀerentiation
to
Comparison
Isomorphisms
Let
K
be
either
a
number
ﬁeld
(i.e.,
a
ﬁnite
extension
of
Q)
or
a
function
ﬁeld
in
one
variable
over
some
coeﬃcient
ﬁeld
k
(which
we
assume
to
be
algebraically
closed
in
K).
Let
S
be
the
unique
one-dimensional
regular
scheme
whose
closed
points
s
correspond
naturally
(via
Zariski
localization
of
S
at
s)
to
the
set
of
all
discrete
valuations
of
K
(where
in
the
function
ﬁeld
case
we
assume
that
the
elements
of
k
×
are
units
for
the
valuations).
We
shall
call
S
the
complete
model
of
K.
Of
course,
in
the
number
ﬁeld
case,
it
is
natural
to
“formally
append”
to
S
the
set
of
archimedean
valuations
of
K.
Let
E→S
def
be
a
one-dimensional,
generically
proper
semi-abelian
scheme
over
S,
i.e.,
EK
=
E
⊗S
K
is
an
elliptic
curve
over
K
with
semi-stable
reduction
everywhere.
Then
E
deﬁnes
a
classifying
morphism
α
:
S
→
(M1,0
)Z
to
the
compactiﬁed
moduli
stack
of
elliptic
curves
over
Z.
It
is
natural
to
endow
S
with
the
log
structure
arising
from
the
set
of
closed
points
at
which
E
→
S
has
bad
reduction.
log
Then
α
extends
to
a
morphism
αlog
:
S
log
→
(M1,0
)Z
in
the
logarithmic
category.
15
Now,
in
the
function
ﬁeld
case,
if
we
diﬀerentiate
α,
we
obtain
the
Kodaira-Spencer
morphism
of
E
→
S:
⊗2
∼
∗
κ
E
:
ωE
=
α
Ω(Mlog
)
→
ΩS
log
/k
1,0
Z
(where
ωE
is
the
restriction
to
the
identity
section
of
E
→
S
of
the
relative
cotangent
bundle
of
E
over
S).
Since
ωE
is
naturally
the
pull-back
via
α
of
an
ample
line
bundle
on
(M1,0
)Z
,
and
κE
is
typically
nonzero
(for
instance,
it
is
always
nonzero
if
K
is
of
characteristic
zero
and
E
→
S
is
not
isotrivial
(i.e.,
trivial
after
restriction
to
a
ﬁnite
covering
of
S)),
the
existence
of
the
Kodaira-Spencer
morphism
κE
gives
rise
to
a
bound
on
the
height
of
E
→
S
by
the
degree
of
ΩS
log
/k
.
The
thrust
of
a
family
of
conjectures
due
to
Vojta
(cf.
[Lang],
[Vojta])
is
that
this
bound
(or
at
least,
a
bound
roughly
similar
to
this
bound)
in
the
geometric
case
(i.e.,
the
case
when
K
is
a
function
ﬁeld)
also
holds
in
the
“arithmetic
case”
(i.e.,
the
case
when
K
is
a
number
ﬁeld).
Thus,
In
order
to
prove
Vojta’s
Conjecture
in
the
arithmetic
case,
it
is
natural
to
attempt
to
construct
some
sort
of
arithmetic
analogue
of
the
KodairaSpencer
morphism.
Indeed,
this
point
of
view
of
approaching
the
veriﬁcation
of
some
inequality
by
ﬁrst
trying
to
construct
“the
theory
underlying
the
inequality”
is
reminiscent
of
the
approach
to
proving
the
Weil
Conjectures
(which
may
be
thought
of
as
inequalities
concerning
the
number
of
rational
points
of
varieties
over
ﬁnite
ﬁelds)
by
attempting
to
construct
a
“Weil
cohomology
theory”
for
varieties
over
ﬁnite
ﬁelds
which
has
enough
“good
properties”
to
allow
a
natural
proof
of
the
Weil
Conjectures.
Of
course,
if
one
tries
to
construct
any
sort
of
naive
analogue
of
the
Kodaira-Spencer
morphism
in
the
arithmetic
case,
one
immediately
runs
into
a
multitude
of
fundamental
obstacles.
In
some
sense,
these
obstacles
revolve
around
the
fact
that
the
ring
of
rational
integers
Z
does
not
admit
“a
ﬁeld
of
coeﬃcients”
F1
⊆
Z.
If
such
a
ﬁeld
of
absolute
constants
existed,
then
one
could
consider
“absolute
diﬀerentials
ΩZ/F1
,”
or
“ΩOK
/F1
”
Moreover,
since
moduli
spaces
tend
to
be
rather
absolute
and
fundamental
objects,
it
is
natural
to
imagine
that
if
one
had
a
ﬁeld
of
absolute
constants
“F1
,”
then
(M1,0
)Z
should
descend
naturally
to
an
object
(M1,0
)F1
over
F1
,
so
that
one
could
diﬀerentiate
the
classifying
morphism
α
:
S
→
(M1,0
)Z
in
the
arithmetic
case,
as
well,
to
obtain
an
arithmetic
Kodaira-Spencer
morphism
⊗2
∼
∗
“κE
:
ωE
=
α
Ω(Mlog
)
1,0
F1
→
ΩS
log
/F1
”
and
then
use
this
arithmetic
Kodaira-Spencer
morphism
to
prove
Vojta’s
Conjecture
concerning
the
heights
of
elliptic
curves.
(Note:
In
this
case,
Vojta’s
Conjecture
is
also
referred
to
as
“Szpiro’s
Conjecture.”)
16
Unfortunately,
this
sort
of
“absolute
ﬁeld
of
constants
F1
”
does
not,
of
course,
exist
in
any
naive
sense.
Thus,
it
is
natural
to
look
for
a
more
indirect,
abstract
approach.
In
the
geometric
case,
when
k
=
C,
the
algebraic
curve
S
deﬁnes
a
Riemann
surface
S
an
.
Let
us
write
US
⊆
S
for
the
open
subobject
where
the
log
structure
of
S
log
is
trivial.
Then
the
ﬁrst
singular
cohomology
module
of
the
ﬁbers
of
E
→
S
naturally
forms
a
local
system
1
Hsing
(E/S,
Z)
on
the
Riemann
surface
USan
.
One
the
other
hand,
the
ﬁrst
de
Rham
cohomology
module
of
the
ﬁbers
of
E
→
S
forms
a
rank
two
vector
bundle
1
HDR
(E/S,
OE
)
on
USan
.
This
de
Rham
cohomology
admits
a
Hodge
ﬁltration,
which
may
be
thought
of
as
a
natural
exact
sequence:
1
0
→
ωE
→
HDR
(E/S,
OE
)
→
τE
→
0
1
(E/S,
OE
)
on
USan
admits
a
connection
∇DR
—
called
the
Moreover,
this
vector
bundle
HDR
1
(E/S,
OE
).
Gauss-Manin
connection
—
which
allows
one
to
diﬀerentiate
sections
of
HDR
Using
this
connection
∇DR
to
diﬀerentiate
the
Hodge
ﬁltration
gives
rise
to
a
natural
morphism
ΘS
log
/k
→
τE⊗2
(where
ΘS
log
/k
is
the
dual
to
ΩS
log
/k
)
which
is
dual
to
the
Kodaira-Spencer
morphism
κE
.
Thus,
Another
way
to
think
of
our
search
for
“F1
”
or
“a
notion
of
absolute
diﬀerentiation”
is
as
the
search
for
an
arithmetic
analogue
of
the
Gauss1
(E/S,
OE
).
Manin
connection
∇DR
on
the
de
Rham
cohomology
HDR
This
is
the
ﬁrst
step
towards
raising
our
search
for
an
arithmetic
Kodaira-Spencer
morphism
to
a
more
abstract
level.
Next,
let
us
recall
that
the
de
Rham
isomorphism
deﬁnes
a
natural
isomorphism
1
1
HDR
(E/S,
OE
)
∼
(E/S,
Z)
⊗Z
OUSan
=
Hsing
1
(in
the
complex
analytic
category)
over
USan
.
Moreover,
the
sections
of
HDR
(E/S,
OE
)
1
deﬁned
(via
this
isomorphism)
by
sections
of
Hsing
(E/S,
Z)
are
horizontal
for
∇DR
.
Thus,
we
conclude
that:
17
To
construct
the
Gauss-Manin
connection
∇DR
,
it
is
enough
to
know
the
de
Rham
isomorphism
between
de
Rham
and
singular
cohomology.
The
de
Rham
isomorphism
is
a
special
case
of
the
general
notion
of
a
Comparison
Isomorphism
between
de
Rham
and
singular/étale
cohomology.
In
the
last
few
decades,
this
sort
of
Comparison
Isomorphism
has
been
constructed
over
p-adic
bases,
as
well
(cf.,
e.g.,
[Falt1,2],
[Hyodo]).
In
the
arithmetic
case,
we
would
like
to
construct
some
sort
of
analogue
of
the
Kodaira-Spencer
morphism
over
S
which
also
has
natural
integrality
properties
at
the
archimedean
places,
as
well
(since
we
would
like
to
use
it
conclude
inequalities
concerning
the
height
of
the
elliptic
curve
EK
).
Put
another
way,
we
would
like
to
construct
some
sort
of
arithmetic
Kodaira-Spencer
morphism
in
the
context
of
Arakelov
theory.
Thus,
in
summary,
the
above
discussion
suggests
that:
In
order
to
construct
this
sort
of
arithmetic
Kodaira-Spencer
morphism,
a
natural
approach
is
to
attempt
to
construct
some
sort
of
Comparison
Isomorphism
in
the
“Arakelov
theater,”
analogous
to
the
wellknown
complex
and
p-adic
Comparison
Isomorphisms
between
de
Rham
and
étale/singular
cohomology.
The
construction
of
such
an
Arakelov-theoretic
Comparison
Theorem
is
the
main
goal
of
this
paper.
To
a
certain
extent,
this
goal
is
achieved
by
Theorem
A
(cf.
§1).
For
a
detailed
explanation
of
the
sense
in
which
the
Comparison
Isomorphism
of
Theorem
A
is
analogous
to
the
well-known
complex
and
p-adic
Comparison
Isomorphisms,
we
refer
to
Chapter
IX.
Unfortunately,
however,
for
various
technical
reasons,
the
arithmetic
Kodaira-Spencer
morphism
that
naturally
arises
from
Theorem
A
is
not
well
enough
understood
at
the
time
of
writing
to
allow
its
application
to
a
proof
of
Vojta’s
Conjectures
(for
more
on
these
“technical
reasons,”
cf.
§5.1
below;
Chapter
IX,
Example
3.5,
and
the
Remark
following
Example
3.5).
In
the
remainder
of
the
present
§3,
we
would
like
to
explain
in
detail
how
we
were
led
to
Theorem
A
as
a
global,
Arakelov-theoretic
analogue
of
the
well-known
“local
Comparison
Isomorphisms.”
§3.2.
A
Function-Theoretic
Comparison
Isomorphism
In
§3.1,
we
saw
that
one
way
to
think
about
absolute
diﬀerentiation
or
an
absolute/arithmetic
Kodaira-Spencer
morphism
is
to
regard
such
objects
as
natural
consequences
of
a
“global
Hodge
theory,”
or
Comparison
Isomorphism
between
the
de
Rham
and
étale
cohomologies
of
an
elliptic
curve.
The
question
then
arises:
Just
what
form
should
such
a
Global
Comparison
Isomorphism
—
i.e.,
in
suggestive
notation
1
1
(E)
⊗
??
∼
(E)
⊗
??
HDR
=
Het
—
take?
18
For
instance,
over
C,
such
a
comparison
isomorphism
exists
naturally
over
C,
i.e.,
when
one
takes
??
=
C.
In
the
p-adic
case,
one
must
introduce
rings
of
p-adic
periods
such
as
BDR
,
Bcrys
(cf.,
e.g.,
[Falt2])
in
order
to
obtain
such
an
isomorphism.
Thus,
we
would
like
to
know
over
if
there
is
some
sort
of
natural
“ring
of
global
periods”
over
which
we
may
expect
to
obtain
our
global
comparison
isomorphism.
In
fact,
in
the
comparison
isomorphism
obtained
in
this
paper
(cf.
§1,
Theorem
A),
unlike
the
situation
over
complex
and
p-adic
bases,
we
do
not
work
over
some
“global
ring
of
periods.”
Instead,
the
situation
is
somewhat
more
complicated.
Roughly
speaking,
what
we
end
up
doing
is
the
following:
In
the
Hodge-Arakelov
Comparison
Isomorphism,
we
obtain
a
comparison
isomorphism
between
the
de
Rham
and
étale
cohomologies
of
an
elliptic
curve
by
considering
functions
on
the
de
Rham
and
étale
cohomologies
of
the
elliptic
curve
and
then
constructing
an
isomorphism
between
the
two
resulting
function
spaces
which
is
(essentially)
an
isometry
with
respect
to
natural
metrics
on
these
function
spaces
at
all
the
primes
of
the
base.
Indeed,
for
instance
over
a
number
ﬁeld,
the
de
Rham
cohomology
and
étale
cohomology
are
ﬁnite
modules
over
very
diﬀerent
sorts
of
rings
(i.e.,
the
ring
of
integers
of
the
number
ﬁeld
in
the
de
Rham
case;
the
proﬁnite
completion
of
Z,
or
one
of
its
quotients
in
the
étale
case),
and
it
is
diﬃcult
to
imagine
the
existence
of
a
natural
“global
arithmetic
ring”
containing
both
of
these
two
types
of
rings.
(Note
here
that
unlike
the
case
with
Shimura
varieties,
the
adèles
are
not
a
natural
choice
here
for
a
number
of
reasons.
Indeed,
to
consider
the
adèles
here
roughly
amounts
to
simply
forming
the
direct
product
of
the
various
local
(i.e.,
complex
and
p-adic)
comparison
isomorphisms,
which
is
not
very
interesting
in
the
sense
that
such
a
simple
direct
product
does
not
result
in
any
natural
global
structures.)
Thus:
The
idea
here
is
to
abandon
the
hope
of
obtaining
a
global
linear
isomorphism
between
the
de
Rham
and
étale
cohomology
modules,
and
instead
to
look
for
an
isomorphism
(as
mentioned
above)
between
the
corresponding
function
spaces
which
does
not
necessarily
arise
from
a
linear
morphism
between
modules.
In
the
present
§,
we
explain
how
we
were
led
to
look
for
such
a
“function-theoretic
comparison
isomorphism,”
while
in
§3.3
below,
we
examine
the
meaning
of
the
nonlinearity
of
this
sort
of
comparison
isomorphism.
In
order
to
understand
the
motivating
circumstances
that
naturally
lead
to
the
introduction
of
this
sort
of
function-theoretic
point
of
view,
we
must
ﬁrst
return
to
the
discussion
of
the
case
over
the
complexes
in
§3.1
above.
Thus,
in
the
following
discussion,
we
use
the
notation
of
the
discussion
of
the
complex
case
in
§3.1.
One
more
indirect
way
to
think
about
the
existence
of
the
Kodaira-Spencer
morphism
is
the
following.
Recall
the
exact
sequence
19
1
0
→
ωE
→
HDR
(E/S,
OE
)
→
τE
→
0
which
in
fact
exists
naturally
over
S
an
.
The
Gauss-Manin
connection
∇DR
acts
on
the
middle
term
of
this
exact
sequence
(as
a
connection
with
logarithmic
poles
at
the
points
of
bad
reduction),
but
does
not
preserve
the
image
of
ωE
.
One
important
consequence
of
this
fact
is
that:
(If
one
imposes
certain
“natural
logarithmic
conditions”
on
the
splitting
at
points
of
bad
reduction,
then)
this
exact
sequence
does
not
split.
Indeed,
if
this
exact
sequence
split,
then
one
could
use
this
splitting
to
obtain
a
connection
on
ωE
induced
by
∇DR
.
Moreover,
if
the
“natural
logarithmic
conditions”
are
satisﬁed,
it
would
follow
that
this
connection
on
ωE
has
zero
monodromy
at
the
points
of
bad
reduction,
i.e.,
that
the
connection
is
regular
over
all
of
S
an
.
But
since
ωE
is
the
pull-back
to
S
of
an
ample
line
bundle
on
(M1,0
)Z
,
it
follows
(so
long
as
E
→
S
is
not
isotrivial)
that
deg(ωE
)
=
0,
hence
that
the
line
bundle
ωE
cannot
admit
an
everywhere
regular
connection.
That
is,
we
obtain
a
contradiction.
Another
(essentially
equivalent)
way
to
think
about
the
relationship
between
the
fact
that
the
above
exact
sequence
does
not
split
and
the
existence
of
the
Kodaira-Spencer
⊗2
-torsor
of
splittings
of
the
above
morphism
is
the
following.
If
one
considers
the
ωE
exact
sequence
(together
with
the
“natural
logarithmic
conditions”
at
the
points
of
bad
reduction),
we
obtain
a
class
⊗2
)
η
∈
Hc1
(S,
ωE
where
the
subscript
“c”
stands
for
“cohomology
with
compact
support.”
(The
reason
that
we
get
a
class
with
compact
support
is
because
of
the
“natural
logarithmic
conditions”
at
the
points
of
bad
reduction.)
On
the
other
hand,
if
we
apply
the
functor
Hc1
(−)
to
the
Kodaira-Spencer
morphism,
we
obtain
a
morphism
⊗2
)
→
Hc1
(S,
ΩS
log
/k
)
=
Hc1
(S,
ΩS/k
)
∼
Hc1
(S,
ωE
=k
Moreover,
the
image
of
η
under
this
morphism
can
easily
be
shown
to
be
the
element
of
Hc1
(S,
ΩS/k
)
∼
=
k
which
is
the
degree
of
the
classifying
morphism
α
:
S
→
(M1,0
)C
,
i.e.,
deg(α)
∈
Z
⊆
C
=
k,
which
is
nonzero
(so
long
as
E
→
S
is
not
isotrivial).
This
implies
that
η
is
nonzero.
Thus,
in
summary,
An
indirect
way
to
“witness
the
existence
of
the
Kodaira-Spencer
morphism”
is
to
observe
that
the
above
exact
sequence
does
not
split,
i.e.,
⊗2
-torsor
of
splittings
of
this
sequence
is
nontrivial.
that
the
ωE
20
This
point
of
view
is
discussed
in
more
detail
in
[Mzk2],
Introduction,
§2.3.
Also,
we
observe
that
this
nonsplitting
of
the
above
exact
sequence
may
also
be
regarded
as
a
sort
1
(E/S,
OE
),
∇DR
).
This
of
“stability
of
the
(vector
bundle
plus
connection)
pair”
(HDR
type
of
stability
of
a
bundle
equipped
with
connection
is
referred
to
as
“crys-stability”
in
[Mzk2]
—
cf.
[Mzk2],
Introduction,
§1.3;
[Mzk2],
Chapter
I,
for
more
details.
Fig.
1:
The
split
case.
Now
let
us
return
to
the
arithmetic
case.
In
this
case,
S
=
Spec(OK
)
(where
OK
is
the
ring
of
integers
of
a
number
ﬁeld
K).
Moreover,
we
have
a
natural
exact
sequence
of
OK
-modules:
1
0
→
ωE
→
HDR
(E/S,
OE
)
→
τE
→
0
which
extends
naturally
to
an
exact
sequence
of
OK
-modules
with
Hermitian
metrics
at
the
inﬁnite
primes,
i.e.,
an
exact
sequence
of
arithmetic
vector
bundles
on
S
(where
S
denotes
the
formal
union
of
S
with
the
set
of
inﬁnite
primes
of
K)
in
the
sense
of
Arakelov
theory.
Then
one
can
consider
whether
or
not
this
exact
sequence
of
arithmetic
vector
bundles
splits.
Moreover,
just
as
in
the
complex
case,
one
can
think
of
this
issue
as
the
21
⊗2
issue
of
whether
or
not
a
certain
Arakelov-theoretic
ωE
-torsor
splits.
(The
notion
and
basic
properties
of
torsors
in
Arakelov-theory
are
discussed
in
Chapter
I.)
Thus,
One
way
to
regard
the
issue
of
constructing
an
arithmetic
KodairaSpencer
morphism
is
as
the
issue
of
constructing
a
theory
that
proves
⊗2
-torsor
does
not
split.
that/explains
why
this
Arakelov-theoretic
ωE
Indeed,
the
nonsplitting
of
this
torsor
is
very
closely
related
to
the
Conjectures
of
Vojta
and
Szpiro
—
in
fact,
the
existence
of
(for
instance,
an
inﬁnite
number
of)
counterexamples
to
these
conjectures
would
imply
(in
an
inﬁnite
number
of
cases)
the
splitting
of
this
torsor
(cf.
Chapter
I,
Theorem
2.4;
Chapter
I,
§4).
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
Fig.
2:
The
non-split
case.
From
a
more
elementary
point
of
view,
the
nonsplitting
of
this
torsor
may
be
thought
of
in
the
following
fashion.
First
of
all,
an
arithmetic
vector
bundle
over
S
may
be
thought
of
as
an
(OK
-)
lattice
in
a
real
or
complex
vector
space.
Thus,
for
instance,
in
the
case
1
K
=
Q,
one
may
think
of
HDR
(E/S,
OE
)
as
a
lattice
in
R2
,
while
the
arithmetic
line
bundles
ωE
and
τE
may
be
thought
of
as
lattices
in
R.
In
the
case
of
arithmetic
line
bundles,
to
say
that
the
degree
of
the
arithmetic
line
bundle
(cf.
Chapter
I,
§1)
is
large
22
(respectively,
small)
amounts
to
saying
that
the
points
of
the
lattice
are
rather
densely
(respectively,
sparsely)
distributed.
Note
that
since
ωE
is
the
pull-back
to
S
of
an
ample
line
bundle
(M1,0
)Z
,
its
degree
tends
to
be
rather
large.
Thus,
to
say
that
the
torsor
in
1
question
splits
is
to
say
that
HDR
(E/S,
OE
)
looks
rather
like
the
lattice
of
Fig.
1,
i.e.,
it
is
dense
in
one
direction
and
sparse
in
another
(roughly
orthogonal)
direction.
We
would
1
(E/S,
OE
)
looks
more
like
the
lattice
in
Fig.
2,
i.e.:
like
to
show
that
HDR
1
We
would
like
to
show
that
the
lattice
corresponding
to
HDR
(E/S,
OE
)
is
roughly
equidistributed
in
all
directions.
Since
we
are
thinking
about
comparison
isomorphisms,
it
is
thus
tempting
to
think
of
the
comparison
isomorphism
as
something
which
guarantees
that
the
“distribution
of
matter”
1
in
the
lattice
HDR
(E/S,
OE
)
is
as
even
in
all
directions
as
the
“distribution
of
matter”
in
the
étale
cohomology
of
E.
Also,
it
is
natural
to
think
of
the
“distribution
of
matter
issues”
involving
the
étale
cohomology,
or
torsion
points,
of
E
as
being
related
to
the
action
of
Galois.
(The
action
of
Galois
on
the
torsion
points
is
discussed
in
Chapter
II.)
Thus,
in
summary:
It
is
natural
to
expect
that
the
global
comparison
isomorphism
should
be
some
sort
of
equivalence
between
“distributions
of
matter”
in
the
de
Rham
and
étale
cohomologies
of
an
elliptic
curve.
Typically,
in
analytic
number
theory,
probability
theory,
and
other
ﬁeld
of
mathematics
where
“distributions
of
matter”
must
be
measured
precisely,
it
is
customary
to
measure
them
by
thinking
about
functions
—
i.e.,
so-called
“test
functions”
—
(and
the
resulting
function
spaces)
on
the
spaces
where
these
distributions
of
matter
occur.
It
is
for
this
reason
that
the
author
was
led
to
the
conclusion
that:
The
proper
formulation
for
a
global
comparison
isomorphism
should
be
some
sort
of
isometric
(for
metrics
at
all
the
primes
of
a
number
ﬁeld)
isomorphism
between
spaces
of
functions
on
the
de
Rham
and
étale
cohomologies
of
an
elliptic
curve.
This
is
precisely
what
is
obtained
in
Theorem
A.
§3.3.
The
Meaning
of
Nonlinearity
In
§3.2
above,
we
saw
that
one
of
the
central
ideas
of
this
paper
is
that
to
obtain
a
“global
Hodge
theory,”
one
must
sacriﬁce
linearity
=
additivity,
and
instead
look
for
isometric
isomorphisms
between
spaces
of
functions
on
the
de
Rham
and
étale
cohomology.
Put
another
way,
this
approach
amounts
to
abandoning
the
idea
that
the
de
Rham
and
étale
cohomologies
are
modules,
and
instead
thinking
of
them
as
(nonlinear)
geometric
objects.
Thus,
one
appropriate
name
for
this
approach
might
be
“geometric
motive
theory.”
23
This
approach
contrasts
sharply
with
typical
approaches
to
the
“theory
of
motives”
or
to
“global
Hodge
theories”
which
tend
to
revolve
around
additivity/linearization,
and
involve
such
“linear”
techniques
as
the
introduction
of
derived
categories
that
contain
motives.
In
some
sense,
since
we
set
out
to
develop
a
global
Hodge
theory
in
the
context
of
Arakelov
theory,
the
nonlinearity
of
the
Comparison
Isomorphism
of
Theorem
A
is
perhaps
not
so
surprising:
Indeed,
many
objects
in
Arakelov
theory
which
are
analogues
of
“linear”
objects
in
usual
scheme
theory
become
“nonlinear”
when
treated
in
the
context
of
Arakelov
theory.
Perhaps
the
most
basic
example
of
this
phenomenon
is
the
fact
that
in
Arakelov
theory,
the
space
of
global
sections
of
an
arithmetic
line
bundle
is
not
closed
under
addition.
This
makes
it
diﬃcult
and
unnatural
(if
not
impossible)
to
do
homological
algebra
(e.g.,
involving
derived
categories)
in
the
context
of
Arakelov
theory.
Another
way
to
think
about
the
nonlinearity
of
the
Hodge-Arakelov
Comparison
Isomorphism
is
that
it
is
natural
considering
that
the
fundamental
algebraic
object
that
encodes
the
“symmetries
of
the
Gaussian,”
namely,
the
Heisenberg
algebra
—
i.e.,
the
Lie
algebra
generated
by
1,
x,
y,
and
the
relations
[x,
y]
=
1,
[x,
1]
=
[y,
1]
=
0
(the
étale
counterpart
of
which
is
the
theta
groups
of
Mumford)
—
is
closely
related
to
nonlinear
geometries.
In
the
ﬁeld
of
noncommutative
geometry,
the
object
that
represents
these
symmetries
is
known
as
the
noncommutative
torus.
Since
the
Gaussian
and
its
derivatives
lie
at
the
technical
heart
at
the
theory
of
this
paper,
it
is
thus
not
surprising
that
the
nonabelian
nature
of
the
symmetries
of
the
Gaussian
should
manifest
itself
in
the
theory.
In
fact,
in
the
portion
of
the
theory
of
this
paper
at
archimedean
primes,
it
turns
out
that
the
Comparison
Isomorphism
in
some
sense
amounts
to
a
function-theoretic
splitting
of
the
exact
sequence
0
→
d
·
Z
→
Z
→
Z/d
·
Z
→
0,
i.e.,
a
function-theoretic
version
of
a
bijection
(Z/d
·
Z)
×
(d
·
Z)
∼
=Z
This
sort
of
splitting
is
somewhat
reminiscent
of
the
“splitting”
inherent
in
regarding
Z
as
being
some
sort
of
“polynomial
algebra
over
F1
.”
Moreover,
this
archimedean
portion
of
the
theory
is
also
(not
surprisingly)
closely
related
to
the
derivatives
of
the
Gaussian
and
the
symmetries
encoded
in
the
Heisenberg
algebra.
Thus,
in
summary:
It
is
as
if
the
symmetries/twist
inherent
in
the
inclusion
“F1
⊆
Z”
are
precisely
the
symmetries/twist
encoded
in
the
noncommutative
torus
(of
noncommutative
geometry).
We
refer
to
the
discussion
of
Chapter
VIII,
§0,
for
more
details
on
this
point
of
view.
§3.4.
Hodge
Theory
at
Finite
Resolution
So
far,
we
have
discussed
the
idea
that
the
appropriate
way
to
think
about
Comparison
Isomorphisms
is
to
regard
them
as
(isometric)
isomorphisms
between
spaces
of
functions
24
on
the
de
Rham
and
étale
cohomologies
of
an
elliptic
curve.
The
question
then
arises:
How
does
one
deﬁne
such
a
natural
isomorphism?
The
key
idea
here
is
the
following:
Comparison
Isomorphisms
should
be
deﬁned
as
evaluation
maps,
given
by
evaluating
functions
on
the
universal
extension
of
an
elliptic
curve
—
×
1
which
is
a
sort
of
“HDR
(E,
OE
),”
i.e.,
a
kind
of
de
Rham
cohomology
of
the
elliptic
curve
—
at
the
torsion
points
of
the
universal
extension
(which
may
naturally
be
identiﬁed
with
the
étale
cohomology
of
the
elliptic
curve).
In
fact,
one
of
the
main
observations
that
led
to
the
development
of
the
theory
of
this
paper
is
the
following:
The
classical
Comparison
Isomorphisms
over
complex
and
p-adic
bases
may
be
formulated
precisely
as
evaluation
maps
of
certain
functions
on
the
universal
extension
at
the
torsion
points
(or
the
“singular
cohomology
analogue
of
torsion
points”)
of
the
universal
extension.
This
key
observation
is
discussed
in
detail
in
Chapter
IX,
§1,
2.
In
the
complex
case,
it
amounts
to
an
essentially
trivial
reformulation
of
the
classical
theory.
Perhaps
the
best
way
to
summarize
this
reformulation
is
to
state
that
the
subspace
of
functions
on
the
“singular
cohomology
analogue
of
torsion
points”
arising
from
the
theta
functions
on
the
elliptic
curve
is
itself
a
sort
of
“function-theoretic”
representation
of
the
Hodge
ﬁltration
induced
(by
the
de
Rham
isomorphism)
on
the
singular
cohomology
with
complex
coeﬃcients
of
an
elliptic
curve.
In
fact,
this
observation
more
than
any
other
played
an
essential
role
in
convincing
the
author
that
(roughly
speaking)
“theta
functions
naturally
deﬁne
the
Comparison
Isomorphism”
(hence
that
any
global
Comparison
Isomorphism
should
involve
theta
functions).
In
the
p-adic
case,
this
“key
observation”
amounts
to
what
is
usually
referred
to
as
the
p-adic
period
map
(cf.,
e.g.,
[Coln],
[Colz1,2],
[Font],
[Wint];
the
beginning
of
Chapter
IX,
§2,
of
the
present
paper)
of
elliptic
curves
(or
abelian
varieties).
Thus,
in
summary,
the
complex,
p-adic,
and
Hodge-Arakelov
Comparison
Isomorphisms
may
all
be
formulated
along
very
similar
lines,
i.e.,
as
evaluation
maps
of
functions
on
the
universal
extension
at
the
torsion
points
of
the
universal
extension.
Of
course,
the
diﬀerence
between
the
Hodge-Arakelov
Comparison
Isomorphism
and
its
local
(i.e.,
complex
and
p-adic)
counterparts
is
that
unlike
in
the
local
case,
where
the
spaces
of
torsion
points
involved
are
“completed
at
some
prime,”
in
the
Hodge-Arakelov
case,
we
work
with
a
discrete
set
of
torsion
points.
It
is
for
this
reason
that
we
ﬁnd
it
natural
to
think
of
the
theory
of
the
present
paper
as
a
“discretization”
of
the
well-known
local
comparison
isomorphisms.
Another
way
that
one
might
think
of
the
theory
of
the
present
paper
is
as
a
“Hodge
theory
at
ﬁnite
resolution”
(where
we
use
the
term
“resolution”
as
in
discussions
of
the
number
of
“pixels”
(i.e.,
“picture
elements,
dots”)
of
a
computer
screen).
At
this
point,
the
reader
might
feel
motivated
to
pose
the
following
question:
25
If
the
Hodge-Arakelov
Comparison
Isomorphism
is
indeed
a
comparison
isomorphism
analogous
to
the
complex
and
p-adic
comparison
isomorphisms,
then
what
sorts
of
“global
periods”
does
it
give
rise
to?
For
instance,
in
the
case
of
the
complex
comparison
isomorphism,
the
most
basic
period
is
the
period
of
the
Tate
motive,
i.e.,
of
H
1
of
Gm
,
namely,
2πi.
In
the
p-adic
case,
the
corresponding
period
is
the
copy
of
Zp
(1)
that
sits
naturally
inside
Bcrys
.
The
analogous
“period”
resulting
from
the
theory
of
the
present
paper,
then,
is
the
following:
Let
U
be
the
standard
multiplicative
coordinate
on
Gm
.
Then
U
−
1
forms
a
section
of
some
ample
line
bundle
on
Gm
,
hence
may
be
thought
of
as
a
sort
of
“theta
function”
(cf.
especially,
the
Schottky
uniformization
of
an
elliptic
curve,
as
in
[Mumf4],
§5).
Then,
roughly
speaking,
the
“discretized
Hodge
theory”
of
the
present
paper
amounts
essentially
—
from
the
point
of
view
of
periods
—
to
thinking
of
the
period
“2πi”
as
lim
n
·
(U
−
1)|U
=exp(2πi/n)
n→∞
i.e.,
the
evaluation
of
a
theta
function
at
an
n-torsion
point,
for
some
large
n.
For
the
elliptic
curve
analogue
(at
archimedean
primes)
of
this
representation
of
2πi,
we
refer
especially
to
Chapter
VII,
§5,
6,
of
the
present
paper.
In
fact,
another
way
to
interpret
the
theory
of
the
present
paper
is
the
following.
First,
let
us
observe
that
the
classical
complex
comparison
isomorphism
(i.e.,
the
de
Rham
isomorphism)
is
centered
around
“diﬀerentiation”
and
“integration,”
i.e.,
calculus
on
the
elliptic
curve.
Moreover,
in
some
sense,
the
most
fundamental
aspect
of
calculus
as
opposed
to
algebraic
geometry
on
the
elliptic
curve
is
the
use
of
real
analytic
functions
on
the
elliptic
curve.
In
the
present
context,
however,
we
wish
to
keep
everything
“arithmetic”
and
“global”
over
a
number
ﬁeld.
Thus,
instead
of
performing
calculus
on
the
underlying
real
analytic
manifold
of
a
(complex)
elliptic
curve,
we
approximate
this
classical
sort
of
calculus
by
performing
calculus
on
a
ﬁnite
(but
“large”)
set
of
torsion
points
of
the
elliptic
curve.
That
is
to
say:
We
regard
the
set
of
torsion
points
as
an
approximation
of
the
underlying
real
analytic
manifold
of
an
elliptic
curve.
Indeed,
this
notion
of
“discrete
torsion
calculus”
is
one
of
the
key
ideas
of
this
paper.
For
instance,
the
universal
extension
of
a
complex
elliptic
curve
has
a
canonical
real
analytic
splitting
(cf.
Chapter
III,
Deﬁnition
3.2),
which
is
fundamental
to
the
Hodge
theory
of
the
elliptic
curve
(cf.,
e.g.,
[Mzk2],
Introduction,
§0.7,
0.8).
Since
this
splitting
passes
through
the
torsion
points
of
the
universal
extension
(and,
in
fact,
is
equal
to
the
closure
of
these
torsion
points
in
the
complex
topology),
it
is
thus
natural
to
regard
the
torsion
points
of
the
universal
extension
as
a
“discrete
torsion
calculus
approximation”
to
the
canonical
real
analytic
splitting
(cf.
Remark
1
following
Chapter
III,
Deﬁnition
3.2).
This
“discrete
torsion
calculus”
point
of
view
may
also
be
seen
in
the
use
of
the
operator
“δ”
in
Chapter
III,
§6,7
(cf.
also
Chapter
V,
§4),
as
well
as
in
the
discussion
of
the
“discrete
Tchebycheﬀ
polynomials”
in
Chapter
VII,
§3.
26
§3.5.
Relationship
to
Ordinary
Frobenius
Liftings
and
Anabelian
Varieties
Finally,
before
proceeding,
we
present
one
more
approach
to
thinking
about
“absolute
diﬀerentiation
over
F1
.”
Perhaps
the
most
naive
approach
to
deﬁning
the
derivative
of
a
number
n
∈
Z
(cf.
[Ihara])
is
to
ﬁx
a
prime
number
p,
and
then
to
compare
n
with
its
Teichmüller
representative
[n]p
∈
Zp
.
The
idea
here
is
that
Teichmüller
representatives
should
somehow
represent
something
analogous
to
a
“ﬁeld
of
constants”
inside
Zp
.
Thus,
we
obtain
a
correspondence
p
→
1
(n
−
[n]p
)
p
Unfortunately,
if
one
starts
from
this
naive
point
of
view,
it
seems
to
be
very
diﬃcult
to
prove
interesting
global
results
concerning
this
correspondence,
much
less
to
apply
it
to
proving
interesting
results
in
diophantine
geometry.
Thus,
it
is
natural
to
attempt
to
recast
this
naive
approach
in
a
form
that
is
more
amenable
to
globalization.
To
do
this,
let
us
ﬁrst
note
that
to
consider
Teichmüller
representatives
is
very
closely
related
to
considering
the
natural
Frobenius
morphism
ΦA
:
A
→
A
def
on
the
ring
of
Witt
vectors
A
=
W
(Fp
).
In
fact,
the
Teichmüller
representatives
in
A
are
precisely
the
elements
which
satisfy
the
equation:
ΦA
(a)
=
ap
Put
another
way,
if
a
is
a
unit,
then
it
may
be
thought
of
as
an
element
∈
Gm
(A).
Moreover,
Gm
is
equipped
with
its
own
natural
Frobenius
action
ΦGm
,
given
by
U
→
U
p
(where
U
is
the
standard
multiplicative
coordinate
on
Gm
).
Thus,
the
Teichmüller
representatives
are
given
by
those
elements
of
a
∈
Gm
(A)
such
that
ΦA
(a)
=
ΦGm
(a)
In
fact,
this
sort
of
situation
where
one
has
a
natural
Frobenius
action
on
a
p-adic
(formal)
scheme,
and
one
considers
natural
p-adic
liftings
of
points
on
this
scheme
modulo
p
which
are
characterized
by
the
property
that
they
are
taken
to
their
Frobenius
(i.e.,
ΦA
)
conjugates
by
the
given
action
of
Frobenius
occurs
elsewhere
in
arithmetic
geometry.
Perhaps
the
most
well-known
example
of
this
situation
(after
Gm
)
is
the
Serre-Tate
theory
of
liftings
of
ordinary
abelian
varieties.
Recently,
this
theory
has
been
generalized
to
the
case
of
moduli
of
hyperbolic
curves
([Mzk1,2]).
We
refer
to
the
Introductions
of
[Mzk1,2]
for
more
on
this
phenomenon.
In
the
theory
of
[Mzk1,2],
this
sort
of
natural
Frobenius
action
on
a
p-adic
(formal)
scheme
is
referred
to
as
an
ordinary
Frobenius
lifting.
27
The
theory
of
ordinary
Frobenius
liftings
is
itself
a
special
(and,
in
some
sense,
the
simplest)
case
of
p-adic
Hodge
theory.
Thus,
in
summary,
from
this
point
of
view,
the
naive
approach
discussed
above
(involving
the
correspondence
p
→
p1
(n
−
[n]p
))
may
be
thought
of
as
the
approach
given
by
“looking
at
the
p-adic
Hodge
theory
of
Gm
at
each
prime
p.”
In
particular,
the
relationship
between
the
approach
of
this
paper
and
the
above
naive
approach
may
be
thought
of
as
the
diﬀerence
between
discretizing
the
various
local
p-adic
Hodge
theories
into
a
global
Arakelov-theoretic
theory
(as
discussed
in
§3.1
–
3.4
above)
and
looking
at
the
full
completed
p-adic
Hodge
theories
individually.
In
fact,
there
is
another
important
diﬀerence
between
the
approach
of
this
paper
log
and
the
above
naive
approach
—
namely,
the
diﬀerence
between
Gm
and
M1,0
(the
log
moduli
stack
of
elliptic
curves).
That
is
to
say,
unlike
the
example
discussed
above,
which
is
essentially
concerned
with
rational
points
of
Gm
,
the
theory
of
this
paper
concerns
log
“absolute
diﬀerentiation
for
points
of
M1,0
.”
At
the
present
time,
the
author
does
not
know
of
an
analogous
approach
to
“globally
discretizing”
the
local
Hodge
theories
of
Gm
log
(i.e.,
of
doing
for
Gm
what
is
done
for
M1,0
in
this
paper).
Also,
it
is
interesting
to
observe
that,
unlike
many
theories
for
elliptic
curves
which
generalize
in
a
fairly
straightforward
manner
to
abelian
varieties
of
higher
dimension,
it
is
not
so
clear
how
to
generalize
the
theory
of
this
paper
to
higher-dimensional
abelian
varieties
(cf.
§5.2
below).
Thus,
it
is
tempting
to
conjecture
that
perhaps
the
existence
of
the
theory
of
the
present
paper
log
log
in
the
case
of
M1,0
is
somehow
related
to
the
anabelian
nature
of
M1,0
(cf.
[Mzk3],
[IN]).
That
is
to
say,
one
central
feature
of
anabelian
varieties
is
a
certain
“extraordinary
rigidity”
exhibited
by
their
p-adic
Hodge
theory
(cf.
[Groth];
the
Introduction
to
[Mzk3]).
In
particular,
it
is
tempting
to
suspect
that
this
sort
of
rigidity
or
coherence
is
what
allows
one
to
discretize
the
various
local
Hodge
theories
into
a
coherent
global
theory.
Another
interesting
observation
in
this
direction
is
that
the
theta
groups
that
play
an
essential
role
in
this
paper
are
essentially
the
same
as/intimately
related
to
the
quotient
π1
(E
−
pt.)/[π1
(E
−
pt.),
[π1
(E
−
pt.),
π1
(E
−
pt.)]]
of
the
fundamental
group
π1
(E
−
pt.)
of
an
elliptic
curve
with
one
point
removed
(which
is
itself
an
anabelian
variety).
This
sort
of
quotient
of
the
fundamental
group
plays
a
central
role
in
[Mzk3].
Finally,
we
remark
that
one
point
of
view
related
to
the
discussion
of
the
preceding
paragraph
is
the
following:
One
fundamental
obstacle
to
“diﬀerentiating
an
integer
n
∈
Z
(or
Q-rational
point
of
Gm
)
over
F1
”
is
that
the
residue
ﬁelds
Fp
at
the
diﬀerent
points
of
Spec(Z)
diﬀer,
thus
making
it
diﬃcult
to
compare
the
value
of
n
at
distinct
points
of
Spec(Z).
On
the
other
hand,
the
theory
of
the
present
paper
—
which
involves
log
diﬀerentiating
Z-valued
points
of
the
moduli
stack
of
log
elliptic
curves
M1,0
—
gets
around
this
problem
eﬀectively
by
taking
the
set
of
d-torsion
points
as
one’s
absolute
constants
that
do
not
vary
even
as
the
residue
ﬁeld
varies.
Note
that
relative
to
the
discussion
of
§3.4,
this
set
of
torsion
points
should
be
regarded
as
a
discrete
analogue/approximation
to
the
underlying
real
analytic
manifold
(which,
of
course,
remains
constant)
of
a
family
of
complex
elliptic
curves.
28
§4.
Guide
to
the
Text
In
this
§,
we
give
brief
summaries
of
the
contents
of
the
various
chapters
of
this
paper.
In
Chapter
I,
we
discuss
the
notion
of
a
“torsor”
in
Arakelov
theory,
give
various
criteria
for
when
such
torsors
split,
and
ﬁnally,
explain
how
such
torsors
arise
naturally
in
arithmetic
geometry.
In
Chapter
II,
we
consider
the
issue
of
the
extent
to
which
the
Galois
action
on
the
torsion
points
of
an
elliptic
curve
over
a
number
ﬁeld
is
transitive.
We
remark
that
neither
of
these
two
chapters
is
logically
necessary
for
the
proof
of
the
main
results
of
this
paper.
(Thus,
the
reader
who
is
only
interested
in
the
proof
of
Theorem
A
(of
§1),
for
instance,
may
skip
these
two
chapters.)
The
reason
for
the
inclusion
of
these
two
chapters
is
that
they
help
to
clarify
the
background
of
the
Hodge-Arakelov
Comparison
Isomorphism,
as
explained
in
the
discussion
of
§3.2
above.
The
bulk
of
the
remainder
of
the
text
is
devoted
to
the
proof
of
the
Hodge-Arakelov
Comparison
Isomorphism.
In
Chapter
III,
we
review
basic
facts
concerning
the
universal
extension
of
an
elliptic
curve,
and
especially
its
relation
to
the
Schottky
uniformization
of
an
elliptic
curve.
In
Chapter
IV,
we
review
Mumford’s
theory
of
algebraic
theta
functions
([Mumf1,2,3])
and
Zhang’s
theory
of
metrized
line
bundles
([Zh])
and
derive
various
consequences
of
these
theories
as
they
relate
to
the
theory
of
the
present
paper.
In
Chapter
V,
we
construct
the
evaluation
map
that
gives
rise
to
the
Hodge-Arakelov
Comparison
Isomorphism
and
verify
various
basic
properties
of
this
evaluation
map.
Finally,
in
Chapter
VI,
we
prove
the
scheme-theoretic
portion
of
the
Comparison
Isomorphism
by
means
of
(among
other
things)
a
rather
involved
computation
of
degrees
(cf.
the
discussion
immediately
following
the
statement
of
Theorem
A
in
§1).
The
next
two
chapters
(VII
and
VIII)
are
devoted
to
the
theory
of
the
Comparison
Isomorphism
at
archimedean
primes.
In
Chapter
VII,
we
discuss
various
natural
systems
of
orthogonal
functions,
which
provide
natural
coordinate
systems
in
the
spaces
of
functions
that
appear
in
the
study
of
the
Comparison
Isomorphism.
Many
of
these
systems
of
orthogonal
functions
are
closely
related
to
the
well-known
classical
systems
of
Legendre
and
Hermite.
Finally,
in
Chapter
VIII,
we
apply
the
theory
of
Chapter
VII
to
complete
the
proof
of
the
archimedean
portion
of
the
Hodge-Arakelov
Comparison
Isomorphism.
In
the
ﬁnal
chapter
of
the
text,
Chapter
IX,
we
explain
how
the
Hodge-Arakelov
Comparison
Isomorphism
may
be
applied
to
construct
an
arithmetic
Kodaira-Spencer
morphism
for
elliptic
curves
over
number
ﬁelds.
We
also
explain
how
the
Hodge-Arakelov
Comparison
Isomorphism
and
the
arithmetic
Kodaira-Spencer
morphism
derived
from
it
are
related
to
more
classical
comparison
isomorphisms
and
Kodaira-Spencer-type
morphisms
over
complex
and
p-adic
bases.
29
§5.
Future
Directions
§5.1.
Gaussian
Poles
and
the
Theta
Convolution
In
some
sense,
the
most
fundamental
outstanding
problem
left
unsolved
in
this
paper
is
the
following:
How
can
one
get
rid
of
the
Gaussian
poles
(cf.
§1)?
For
instance,
if
one
could
get
rid
of
the
Gaussian
poles
in
Theorem
A,
there
would
be
substantial
hope
of
applying
Theorem
A
to
Vojta’s
Conjectures
(cf.
Chapter
IX,
Example
3.5,
and
the
Remark
following
Example
3.5).
For
instance,
if
we
take
m
=
2d
in
Theorem
A
(so
that
the
metrized
line
bundle
L
is
symmetric),
then
one
gets
an
action
of
{±1}
on
the
domain
and
range
of
the
Comparison
Isomorphism
(which
is
itself
compatible
with
this
action).
If
one
then
decomposes
the
domain
without
Gaussian
poles
into
eigenspaces
for
this
action
(and
uses
the
fact
that
everything
is
compatible
with
the
action
of
the
theta
⊗2j
-torsors
(where
j
≥
1
is
an
integer)
that
groups
involved),
then
one
obtains
natural
ωE
split
if
and
only
if
these
eigenspaces
of
the
domain
split
into
direct
sums
of
nonpositive
powers
of
ωE
.
Thus,
if
one
could
somehow
get
the
Galois
(i.e.,
ΠS
)
action
resulting
from
the
Hodge-Arakelov
Comparison
Isomorphism
to
exist
without
the
Gaussian
poles,
then
violations
to
Vojta’s
Conjecture
would
result
in
a
complete
splitting
of
the
domain
(without
Gaussian
poles)
into
nonpositive
powers
of
ωE
.
Since,
moreover,
this
Galois
action
is
not
likely
to
preserve
the
Hodge
ﬁltration,
one
would
then
most
likely
obtain
morphisms
from
various
powers
of
ωE
into
strictly
smaller
powers
of
ωE
,
which
would
result
in
a
contradiction
(since
ωE
tends
to
have
positive
degree).
The
above
sketch
of
an
argument
(i.e.,
that
one
might
be
able
to
apply
Theorem
A
to
Vojta’s
Conjectures
if
only
one
could
get
rid
of
the
Gaussian
poles)
provides,
in
the
opinion
of
the
author,
strong
motivation
for
investigating
the
issue
of
whether
or
not
one
can
somehow
eliminate
the
Gaussian
poles
from
Theorem
A.
Moreover,
the
following
argument
indicates
how
this
might
be
done:
As
discussed
in
§2,
in
some
sense,
one
may
regard
the
theory
of
this
paper
as
the
theory
of
the
Gaussian
and
its
derivatives.
The
classical
example
of
the
theory
of
the
Gaussian
and
its
derivatives
is
the
theory
of
Hermite
functions.
The
Hermite
functions,
which
are
various
derivatives
of
the
Gaussian,
are
not
themselves
polynomials,
but
rather
of
the
form:
(polynomial)
·
(Gaussian).
Thus,
it
is
natural
to
divide
the
Hermite
functions
by
the
Gaussian,
which
then
gives
us
polynomials
which
are
called
the
Hermite
polynomials.
In
the
theory
of
this
paper,
the
original
Gaussian
corresponds
(relative
to
taking
the
Fourier
expansion)
to
the
algebraic
theta
functions
of
Mumford
(i.e.,
before
we
consider
derivatives);
the
“unwanted”
Gaussian
that
remains
in
the
Hermite
functions
corresponds
to
the
Gaussian
poles.
Moreover,
since
multiplication
and
division
after
taking
the
Fourier
expansion
correspond
to
convolution,
it
is
natural
to
imagine
that
the
image
of
the
“domain
without
Gaussian
poles”
of
the
Comparison
Isomorphism
(of
Theorem
A)
should
correspond
to
those
functions
on
the
torsion
points
30
that
are
in
the
image
of
(the
morphism
given
by)
convolution
with
the
(original)
theta
function
—
which
we
refer
to
as
the
“theta
convolution”
for
short.
Thus,
it
is
natural
to
conjecture
that:
By
studying
the
theta
convolution,
one
might
be
able
to
construct
a
Galois
action
like
the
one
needed
in
the
argument
above,
i.e.,
a
“Galois
action
without
Gaussian
poles.”
In
[STC],
we
study
this
theta
convolution,
and
obtain,
in
particular,
a
theta-convoluted
comparison
isomorphism,
which
has
the
property
that,
in
a
neighborhood
of
the
divisor
at
inﬁnity,
when
one
works
with
an
étale
(i.e.,
isomorphic
to
Z/dZ)
Lagrangian
subgroup,
and
a
multiplicative
(i.e.,
isomorphic
to
μd
)
restriction
subgroup,
then
the
Gaussian
poles
vanish,
as
desired
(cf.
[STC],
especially
Remark
1
following
Theorem
10.1,
for
more
details).
In
fact,
this
point
of
view
is
already
implicit
in
the
present
paper
in
the
theory
of
the
metrics
“||
∼
||w,μa
”
of
Chapter
VIII,
§1,2.
Even
in
the
case
of
the
theta-convoluted
comparison
isomorphism,
however,
the
Gaussian
poles
fail
to
vanish
(in
a
neighborhood
of
the
divisor
at
inﬁnity)
if
either
the
restriction
subgroup
fails
to
be
multiplicative
or
the
Lagrangian
subgroup
fails
to
be
étale.
In
these
cases,
it
is
tempting
to
suspect
that
(at
least
at
p-adic
primes)
perhaps
by
working
over
some
sort
of
base
like
“Bcrys
”
—
over
which
μd
and
Z/d
·
Z
become
isomorphic
—
these
technical
problems
involving
étale
restriction
subgroups
and
multiplicative
Lagrangian
subgroups
may
be
overcome.
In
fact,
this
point
of
view
is
already
implicit
in
the
discussion
of
Chapter
IX,
§2,
of
the
present
paper.
It
is
the
hope
of
the
author
to
discuss
these
issues
in
a
sequel
to
the
present
paper
and
[STC]
devoted
to
the
p-adic
aspects
of
the
theta
convolution
(cf.
the
Introduction
to
[STC]).
§5.2.
Higher
Dimensional
Abelian
Varieties
and
Hyperbolic
Curves
Once
results
such
as
Theorem
A
(of
§1)
have
been
established
for
elliptic
curves,
it
is
natural
to
attempt
to
generalize
such
results
to
higher
dimensional
abelian
varieties
and
hyperbolic
curves.
Unfortunately,
however,
even
in
the
case
of
the
abelian
varieties,
where
one
expects
the
generalization
to
be
relatively
straightforward,
one
immediately
runs
into
a
number
of
problems.
For
instance,
if
one
considers
sections
of
an
ample
line
bundle
L
over
the
universal
extension
of
an
abelian
variety
of
dimension
g,
the
dimension
over
the
base
ﬁeld
of
the
space
of
global
sections
of
torsorial
degree
<
d
is:


d−1+g
·
dg
<
d2g
g
(where
we
assume
that
the
dimension
of
the
space
of
global
sections
of
L
over
the
abelian
variety
itself
is
equal
to
dg
)
if
g
>
1.
Thus,
the
naive
generalization
of
Theorem
Asimple
cannot
possibly
hold
(i.e.,
since
the
two
spaces
between
which
one
must
construct
an
isomorphism
have
diﬀerent
dimensions).
Nevertheless,
it
is
the
hope
of
the
author
that
31
someday
this
sort
of
technical
problem
may
be
overcome,
and
that
the
theory
of
this
paper
may
be
generalized
to
arbitrary
abelian
varieties.
If
such
a
generalization
could
be
realized,
it
would
be
interesting
if,
for
instance,
just
as
the
various
models
(Hermite,
Legendre,
Binomial)
that
occur
in
the
archimedean
theory
of
the
present
paper
correspond
naturally
to
the
possible
slopes
of
the
action
of
Frobenius
(on
the
ﬁrst
crystalline
cohomology
module
of
an
elliptic
curve)
at
ﬁnite
primes
(cf.
the
discussion
of
this
phenomenon
in
§1),
it
were
the
case
that
the
corresponding
models
in
the
archimedean
theory
for
arbitrary
abelian
varieties
correspond
to
the
possible
Newton
polygons
of
the
action
of
Frobenius
(on
the
ﬁrst
crystalline
cohomology
module
of
an
abelian
variety
of
the
dimension
under
consideration)
at
ﬁnite
primes.
Another
natural
direction
in
which
to
attempt
to
generalize
the
theory
of
this
paper
would
be
to
extend
it
to
a
global/Arakelov-theoretic
Hodge
theory
of
hyperbolic
curves.
Indeed,
the
“complex
Hodge
theory
of
hyperbolic
curves,”
which
revolves
around
the
Köbe
uniformization
of
(the
Riemann
surfaces
corresponding
to)
such
curves
by
the
upper
halfplane,
has
already
been
extended
to
the
p-adic
case
([Mzk1,2]).
Moreover,
the
theory
of
[Mzk1,2]
may
also
be
regarded
as
the
“hyperbolic
curve
analogue”
of
Serre-Tate
theory.
Thus,
it
is
natural
to
attempt
to
construct
a
“global
Arakelov
version”
of
[Mzk1,2],
just
as
the
theory
of
the
present
paper
in
some
sense
constitutes
a
globalization
of
the
Serre-Tate
theory/p-adic
Hodge
theory
of
elliptic
curves
(cf.
Chapter
IX,
§2).
Bibliography
[Coln]
R.
Coleman,
Hodge-Tate
periods
and
p-adic
Abelian
integrals,
Inv.
Math.
78
(1984),
pp.
351-379.
[Colz1]
P.
Colmez,
Périodes
p-adiques
des
variétés
abéliennes,
Math.
Ann.
292
(1992),
pp.
629-644.
[Colz2]
P.
Colmez,
Intégration
sur
les
variétés
p-adiques,
Astérisque
248,
Soc.
Math.
de
France
(1998).
[Falt1]
G.
Faltings,
p-adic
Hodge
Theory,
Journal
of
the
Amer.
Math.
Soc.
1,
No.
1
(1988),
pp.
255-299.
[Falt2]
G.
Faltings,
Crystalline
Cohomology
and
p-adic
Galois
Representations,
Proceedings
of
the
First
JAMI
Conference,
Johns-Hopkins
University
Press
(1990),
pp.
25-79.
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer-Verlag
(1990).
[Font]
J.
M.
Fontaine,
Formes
diﬀerentielles
et
modules
de
Tate
des
variétés
abéliennes
sur
les
corps
locaux,
Inv.
Math.
65
(1982),
pp.
379-409.
[GGA]
L.
Schneps
and
P.
Lochak,
Geometric
Galois
Actions:
1.
Around
Grothendieck’s
Esquisse
d’un
Programme,
2.
The
Inverse
Galois
Problem,
Moduli
Spaces
and
Mapping
Class
Groups,
London
Math.
Soc.
Lect.
Note
Ser.
242-243,
Cambridge
Univ.
Press
(1997).
32
[Groth]
A.Grothendieck,
Letter
to
G.Faltings,
June
1983,
in
[GGA],
Vol.
1,
pp.
49-58.
[Hyodo]
O.
Hyodo,
On
variation
of
Hodge-Tate
structures,
Math.
Ann.
284
(1989),
pp.
7-22.
[Ihara]
Y.
Ihara,
Fermat-shou
to
“Kazu
no
Bibun”
ni
tsuite
(=
“On
Fermat
Quotients
and
‘Derivatives
of
Numbers’
”
—
in
Japanese)
in
Algebraic
Analysis
and
Number
Theory,
RIMS
Kokyuroku
810
(1992).
[IN]
Y.Ihara
and
H.
Nakamura,
Some
illustrative
examples
for
anabelian
geometry
in
high
dimensions,
in
[GGA],
Vol.1,
pp.
127-138.
[Kato]
K.
Kato,
Logarithmic
Structures
of
Fontaine-Illusie,
Proceedings
of
the
First
JAMI
Conference,
Johns
Hopkins
University
Press
(1990),
191-224.
[Katz1]
N.
Katz,
The
Eisenstein
Measure
and
p-adic
Interpolation,
Amer.
Journ.
of
Math.
99,
No.
2
(1977),
pp.
238-311.
[Katz2]
N.
Katz,
Serre-Tate
Local
Moduli,
Algebraic
Surfaces
(Orsay,
1976-78),
Lecture
Notes
in
Mathematics
868,
Springer-Verlag
(1981),
pp.
138-202.
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
University
Press
(1985).
[Lang]
S.
Lang,
Introduction
to
Arakelov
Theory,
Springer-Verlag
(1988),
Appendix
by
Vojta.
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deﬁning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
2
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
[Mumf4]
D.
Mumford,
An
Analytic
Construction
of
Degenerating
Abelian
Varieties
over
Complete
Rings,
Appendix
to
[FC].
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
Publ.
of
RIMS
32
(1996),
pp.
957-1151.
[Mzk2]
S.
Mochizuki,
Foundations
of
p-adic
Teichmüller
Theory,
AMS/IP
Studies
in
Advanced
Mathematics
11,
American
Mathematical
Society/International
Press
(1999).
[Mzk3]
S.
Mochizuki,
The
Local
Pro-p
Anabelian
Geometry
of
Curves,
to
appear
in
Invent.
Math.
[STC]
S.
Mochizuki,
The
Scheme-Theoretic
Theta
Convolution,
manuscript.
[Vojta]
P.
Vojta,
Diophantine
Approximations
and
Value
Distribution
Theory,
Lecture
Notes
in
Mathematics
1239,
Springer-Verlag
(1987).
[Wint]
J.-P.
Wintenberger,
Théorème
de
comparaison
p-adique
pour
les
schémas
abéliens.
I:
Construction
de
l’accouplement
de
périodes,
Périodes
p-Adiques,
Astérisque
223,
Soc.
Math.
de
France
(1994).
[Zh]
S.
Zhang,
Admissible
pairing
on
a
curve,
Invent.
Math.
112
(1993),
pp.
171-193.
33
Chapter
I:
Torsors
in
Arakelov
Theory
§0.
Introduction
In
this
Chapter,
after
reviewing
various
well-known
facts
from
Arakelov
theory,
we
discuss
the
notion
of
a
torsor
in
the
Arakelov
context
and
prove
various
results
(Theorems
2.4,
3.2;
Corollary
2.5)
concerning
the
existence
of
splittings
of
such
torsors.
Finally,
in
§4,
we
discuss
how
such
torsors
arise
naturally
in
arithmetic
geometry,
and,
more
speciﬁcally,
how
they
relate
to
the
main
goal
of
this
paper,
which
is
to
understand
the
structure
of
the
arithmetic
torsor
deﬁned
by
the
universal
extension
of
an
elliptic
curve.
§1.
Arakelov
Theory
in
Geometric
Dimension
Zero
In
this
§,
we
review
basic
facts
concerning
Arakelov
theory
in
the
case
of
geometric
dimension
zero.
Our
references
will
be
[GS]
and
[Szp].
Arakelov
theory
provides
a
convenient
language
for
expressing
many
well-known
results
in
elementary
number
theory.
We
begin
by
introducing
notation.
Let
K
be
a
number
ﬁeld,
i.e.,
a
ﬁnite
extension
def
of
Q.
Let
OK
be
its
ring
of
integers.
Let
d
=
[K
:
Q]
(i.e.,
the
degree
of
K
over
Q).
Let
r1
(respectively,
r2
)
be
the
number
of
real
(respectively,
complex)
places
of
K
(so
d
=
r1
+
2r2
).
Let
Σ
be
the
set
of
embeddings
K
→
C.
If
σ
∈
Σ,
we
write
σ
for
the
embedding
obtained
by
composing
σ
with
complex
conjugation.
Also,
if
σ
∈
Σ,
we
shall
write
σ
for
[Kσ
:
R].
Let
DK
∈
Z>0
be
the
absolute
value
of
the
discriminant
of
K
over
Q.
Deﬁnition
1.1.
We
shall
call
(cf.
[GS],
§2.4.1)
a
pair
M
=
(M,
h)
an
arithmetic
vector
bundle
over
K
(of
rank
r)
if
M
if
a
ﬁnite,
ﬂat
OK
-module
(such
that
dimK
(M
⊗OK
K)
=
r),
def
and
h
=
{hσ
}σ∈Σ
is
a
set
of
Hermitian
metrics
hσ
on
Mσ
=
M
⊗OK
Kσ
such
that
the
metric
hσ
is
the
complex
conjugate
of
the
metric
hσ
.
We
shall
refer
to
an
arithmetic
vector
bundle
of
rank
one
as
an
arithmetic
line
bundle.
Example
1.2.
The
OK
-module
OK
equipped
with
the
metrics
given
by
the
absolute
value
|
|σ
deﬁned
by
σ
∈
Σ
deﬁnes
a
natural
arithmetic
line
bundle.
We
shall
denote
this
arithmetic
line
bundle
by
OK
.
def
Example
1.3.
Consider
the
OK
-module
ωK
=
HomZ
(OK
,
Z)
(cf.
[Szp],
§1.3).
Observe
that
the
trace
deﬁnes
a
natural
element
Tr
∈
ωK
.
Moreover,
there
exists
a
unique
metric
34
on
(ωK
)σ
such
that
|Tr|σ
=
ωK
.
σ.
We
shall
denote
the
resulting
arithmetic
line
bundle
by
Note
that
if
L
and
M
are
arithmetic
vector
bundles,
then
one
can
form
various
new
∨
def
arithmetic
vector
bundles
as
follows:
L
⊗OK
M
;
HomOK
(M
,
L);
M
=
HomOK
(M
,
O
K
);
∗
def
M
=
HomOK
(M
,
ω
K
);
(for
i
∈
Z≥0
)
∧i
M
.
(Note
that
our
notation
diﬀers
from
that
of
[GS].)
All
have
naturally
deﬁned
metrics,
which
we
leave
to
the
reader
to
make
explicit.
If
L,
M
,
and
P
are
arithmetic
line
bundles,
then
we
deﬁne
an
exact
sequence
of
arithmetic
line
bundles
0→L→M
→P
→0
to
be
an
exact
sequence
of
the
underlying
OK
-modules
such
that:
at
each
σ,
(i)
the
metric
on
Lσ
is
induced
by
restricting
the
metric
of
Mσ
;
(ii)
the
metric
on
Pσ
is
induced
by
the
metric
on
the
orthogonal
complement
to
Lσ
in
Mσ
.
Let
M
be
an
arithmetic
vector
bundle.
Then
we
would
like
to
deﬁne
a
number
of
invariants
associated
to
M
.
Let
us
write
def
H0
(M
)
=
{m
∈
M
such
that
|m|σ
≤
1
∀σ
∈
Σ}
and
def
h0
(M
)
=
log(#H0
(M
))
∈
R
Next,
we
could
like
to
deﬁne
the
degree
deg(M
)
of
M
.
First
of
all,
if
M
is
an
arithmetic
line
bundle,
then
for
any
m
∈
M
,
we
deﬁne
(cf.
[GS],
§2.4.1)
def
deg(M
)
=
log(#(M/O
·
m))
−

log(|m|σ
)
∈
R
σ∈Σ
This
real
number
is
easily
seen
(by
means
of
the
product
formula
of
elementary
number
theory)
to
be
independent
of
the
choice
of
m
∈
M
.
Note
that
if
M
is
an
arithmetic
line
bundle,
and
h0
(M
)
>
0
(so
H0
(M
)
has
at
least
one
nonzero
element),
then
it
follows
from
the
deﬁnition
of
H0
(M
)
that
deg(M
)
≥
0.
def
More
generally,
for
M
of
arbitrary
rank
r,
we
let
deg(M
)
=
deg(∧r
M
).
If
L
is
an
arithmetic
line
bundle,
then
deg(M
⊗
L)
=
deg(M
)
+
r
·
deg(L).
Moreover,
deg(−)
is
additive
on
exact
sequences.
Finally,
we
would
like
to
deﬁne
the
Euler
characteristic
χ(M
)
of
M
:
def
χ(M
)
=
deg(M
)
+
r
·
χ(OK
)
35
where
def
χ(OK
)
=
r2
·
log(2)
−
1
log(DK
)
2
(In
[Szp],
§1.3,
a
diﬀerent,
but
equivalent
deﬁnition
of
χ(−)
is
given
in
terms
of
logarithms
of
volumes.)
The
invariant
χ(−)
is
additive
on
exact
sequences.
Proposition
1.4.
We
have:
deg(ω
K
)
=
−2
·
χ(OK
)
=
log(DK
)
−
2r2
·
log(2).
Proof.
See
[Szp],
Lemma
1.4.

Next,
we
would
like
to
review
the
main
result
(Theorem
2)
of
[GS].
Theorem
1.5.
There
exists
a
universal
constant
C
∈
R>0
which
is
independent
of
K
such
that
the
following
inequalities
hold:
∗
−C
·
(nd)
·
(log(nd)
+
1)
≤
h0
(M
)
−
h0
(M
)
−
χ(M
)
≤
C
·
(nd)
·
(log(nd)
+
1)
for
any
arithmetic
vector
bundle
M
of
rank
n
>
0
over
a
number
ﬁeld
K.
Proof.
This
is
essentially
Theorem
2
of
[GS].
It
is
easy
to
see
(using
the
fact
that
N
!
≤
N
N
and
Stirling’s
formula
(see,
e.g.,
[Ahlf],
Chapter
5,
§2.5
–
cf.
also
Chapter
VII,
Lemma
1.5)
to
estimate
the
size
of
the
Γ
function)
that
the
number
“C(r1
,
r2
,
n)”
of
loc.
cit.
can
be
bounded
uniformly
(with
respect
to
n,
M
,
K)
by
C
·
(nd)
·
(log(nd)
+
1),
for
some
universal
C
∈
R>0
.

§2.
Deﬁnition
and
First
Properties
of
Torsors
Next,
we
would
like
to
deﬁne
the
notion
of
an
arithmetic
torsor
over
an
arithmetic
vector
bundle.
Thus,
let
M
be
an
arithmetic
vector
bundle
over
K.
Deﬁnition
2.1.
We
shall
call
a
pair
T
=
(T,
s)
an
arithmetic
torsor
over
M
,
or,
simply,
an
M
-torsor
if
T
has
the
structure
of
an
M
-torsor
T
→
Spec(OK
)
on
Spec(OK
),
and
s
=
{sσ
}σ∈Σ
is
a
collection
of
rational
points
sσ
∈
T
(Kσ
)
such
that
sσ
is
the
complex
conjugate
of
sσ
.
We
shall
refer
to
the
{sσ
}
as
the
approximands
of
the
arithmetic
torsor
T.
36
Let
T
be
an
M
-torsor.
Then
we
shall
be
especially
interested
in
the
issue
of
when
T
“splits,”
or
“is
trivial.”
Deﬁnition
2.2.
We
shall
say
that
T
splits
if
there
exists
a
t
∈
T
(OK
)
such
that
for
each
σ
∈
Σ,
the
element
t
−
sσ
∈
Mσ
satisﬁes
|t
−
sσ
|
≤
1.
In
this
case,
t
will
be
called
a
splitting
of
T
,
and
we
shall
write
t
∈
T
(OK
).
If
>
0
and
|t
−
sσ
|
≤
for
all
σ
∈
Σ,
then
we
shall
call
t
a
splitting
of
proximity
,
or,
simply,
an
-splitting.
If
t
−
sσ
=
0
for
all
σ
∈
Σ,
then
we
shall
say
that
the
torsor
T
is
trivial.
Example
2.3.
Suppose
that
0
→
M
→
P
→
OK
→
0
is
an
exact
sequence
of
arithmetic
vector
bundles
(over
K).
Then
the
splittings
O
K
→
P
of
this
exact
sequence
form
an
M
torsor
T
in
a
natural
way:
Indeed,
if
we
forget
about
metrics,
then
the
splittings
OK
→
P
form
an
M
-torsor
T
→
Spec(OK
).
Thus,
it
remains
to
deﬁne
the
“splittings
at
the
inﬁnite
prime,”
i.e.,
the
sσ
.
We
take
sσ
to
be
the
splitting
deﬁned
by
the
orthogonal
complement
to
Mσ
in
Pσ
.
This
gives
us
an
M
-torsor
T
.
In
fact,
it
is
easy
to
show
that
every
M
-torsor
arises
in
this
way.
Moreover,
T
is
trivial
if
and
only
if
P
∼
=
M
⊕
OK
.
Next,
we
would
like
to
use
Theorem
1.5
above
to
show
that
if
L
is
a
line
bundle
of
large
degree,
then
every
L-torsor
splits.
Theorem
2.4.
There
exists
a
universal
constant
Cd
∈
R
depending
only
on
d
=
[K
:
Q]
with
the
following
property:
Let
L
be
an
arithmetic
line
bundle
over
K
such
that
the
inequality
deg(L)
≥
log(DK
)
+
Cd
is
satisﬁed.
Then
any
L-torsor
T
splits.
Proof.
Let
λ
∈
R>0
.
Let
us
write
Z(λ)
for
the
arithmetic
line
bundle
over
Q
deﬁned
as
follows:
The
underlying
Z-module
of
Z(λ)
is
Z,
while
the
norm
of
1
∈
Z
is
given
by
|1|
=
λ−1
.
Thus,
if
λ
is
much
greater
than
1,
Z(λ)
will
have
lots
of
global
sections
(i.e.,
its
h0
will
be
large).
Since
the
underlying
Z-module
of
Z(λ)
is
Z,
one
can
regard
H0
(Z(λ))
as
a
(ﬁnite)
subset
of
Z.
Let
Nλ
be
the
product
of
all
the
positive
elements
of
this
subset.
Thus,
Nλ
∈
Z,
and
every
nonzero
element
of
H0
(Z(λ))
divides
Nλ
.
def
Next,
let
C
be
the
universal
constant
of
Theorem
1.5.
Let
Cd
=
2C(d
+
1)(1
+
log(d
+
1))
+
1
∈
R.
Let
λ
be
a
real
number
>
1
and
such
that
log(λ)
≥
Cd
.
Let
Cd
be
a
positive
real
number
such
that
Cd
≥
Cd
and
Cd
>
log(Nλ
).
In
the
following,
we
would
like
to
show
that
this
Cd
has
the
property
stated
in
the
theorem.
Now
let
L
be
an
arithmetic
line
bundle
over
K
satisfying
the
inequality
in
the
statement
of
the
theorem.
Then
we
wish
to
deﬁne
a
new
arithmetic
line
bundle
Lλ
over
K
as
37
follows:
The
underlying
OK
-module
Lλ
will
be
the
OK
-submodule
Nλ
·
L
⊆
L.
The
metric
on
(Lλ
)σ
=
Lσ
is
deﬁned
by
taking
λ
times
the
metric
on
Lσ
.
Thus,
we
have
an
inclusion
φ
:
Lλ
→
L
which
is
“globally
integral”
in
the
sense
that
the
following
two
conditions
are
satisﬁed:
(i)
α
∈
Lλ
maps
to
an
element
of
L;
(ii)
α
∈
(Lλ
)σ
with
absolute
value
≤
1
maps
to
an
element
of
Lσ
with
absolute
value
≤
1.
It
is
then
immediate
from
Deﬁnition
2.1
that
every
L-torsor
T
arises
from
an
Lλ
-torsor
T
λ
by
pushing
forward
via
φ.
Now
let
us
consider
the
L-torsor
T
arising
(cf.
Example
2.3)
from
an
exact
sequence
0
→
L
→
M
→
OK
→
0
By
the
remark
at
the
end
of
the
last
paragraph,
it
follows
that
this
exact
sequence
can
always
be
obtained
by
pushing
forward
(via
φ)
an
exact
sequence
0
→
Lλ
→
M
λ
→
O
K
→
0
Next,
let
us
“push-forward”
this
exact
sequence
via
“Spec(O
K
)
→
Spec(Z)”
so
as
to
obtain
an
exact
sequence
of
arithmetic
vector
bundles
over
Q.
Then,
let
us
pull-back
this
exact
sequence
via
the
morphism
of
Z-modules
Z
→
O
K
given
by
the
structure
of
OK
as
a
Z-algebra.
This
gives
us
an
exact
sequence
0
→
Lλ
→
P
λ
→
Z
→
0
Finally,
let
us
tensor
this
exact
sequence
with
Z(λ).
This
gives
us
an
exact
sequence
0
→
Lλ
(λ)
→
P
λ
(λ)
→
Z(λ)
→
0
We
would
like
to
use
Theorem
1.5
to
compute
the
number
of
global
sections
of
the
arithmetic
vector
bundles
in
this
exact
sequence.
First,
let
us
observe
that
χ(Lλ
(λ))
=
−log(Nλ
)
+
χ(L)
=
−log(Nλ
)
+
deg(L)
+
χ(OK
)
In
particular,
deg(Lλ
(λ))
=
−log(Nλ
)
+
deg(L).
Thus,
deg(HomZ
(Lλ
(λ),
Z))
=
log(Nλ
)
−
deg(L)
+
log(DK
)
−
2r2
·
log(2)
≤
log(Nλ
)
+
log(DK
)
−
deg(L)
<
Cd
+
log(DK
)
−
deg(L)
38
(where
the
last
inequality
follows
from
the
fact
that
we
chose
Cd
to
be
>
log(Nλ
)).
It
thus
follows
that
HomZ
(Lλ
(λ),
Z))
is
an
arithmetic
line
bundle
over
K
whose
degree
is
negative.
Thus,
by
[Szp],
Lemma
1.1,
this
arithmetic
line
bundle
has
no
global
sections.
Similarly,
since
χ(Z(λ))
=
deg(Z(λ))
=
log(λ),
we
conclude
that
HomZ
(Z(λ),
Z)
has
no
global
sections.
It
thus
follows
that
HomZ
(P
λ
(λ),
Z)
also
has
no
global
sections.
Now
we
are
ready
to
apply
Theorem
1.5.
We
thus
obtain
that
h0
(P
λ
(λ))
≥
χ(P
λ
(λ))
−
C(d
+
1)(1
+
log(d
+
1))
>
log(λ)
+
χ(Lλ
(λ))
−
Cd
+
C(d
+
1)(1
+
log(d
+
1))
≥
(log(λ)
−
Cd
)
+
χ(Lλ
(λ))
+
Cd(1
+
log(d))
≥
h0
(Lλ
(λ))
Thus,
there
exists
a
section
s
∈
H0
(P
λ
(λ))
whose
image
s
in
Z(λ)
is
nonzero.
Thus,
s
∈
Z
divides
Nλ
.
Then,
unraveling
all
of
the
complicated
deﬁnitions
reveals
that
if
we
divide
the
section
s
by
the
integer
s
,
we
obtain
a
section
s
∈
M
whose
image
in
OK
is
1.
Thus,
it
remains
to
analyze
s
at
the
inﬁnite
primes.
Let
us
denote
(for
σ
∈
Σ)
by
δσ
(respectively,
δσ
)
the
orthogonal
projection
of
s
(respectively,
s
)
to
(Lλ
(λ))σ
(respectively,
Lσ
).
Then
since
s
is
“integral
at
σ,”
it
follows
that
|δσ
|2σ
≤
|δσ
|2σ
+
λ−2
·
(s
)2
≤
1
On
the
other
hand,
|δσ
|σ
=
(s
)−1
·
|δσ
|σ
.
Thus,
it
follows
immediately
that
|δσ
|σ
≤
1.
In
other
words,
s
deﬁnes
a
splitting
of
the
torsor
T
.
This
completes
the
proof
of
the
theorem.

Remark.
Theorem
2.4
is
the
number-theoretic
analogue
of
the
following
well-known
fact
concerning
line
bundles
on
algebraic
curves:
If
X
is
a
smooth,
geometrically
connected,
proper
curve
over
a
ﬁeld
k,
and
L
is
a
line
bundle
on
X
such
that
deg(L)
≥
deg(ωX/k
)
+
1,
then
H1
(X,
L)
=
0.
Corollary
2.5.
There
exists
a
universal
constant
Cd
∈
R
depending
only
on
d
=
[K
:
Q]
with
the
following
property:
Let
E
be
an
arithmetic
vector
bundle
of
rank
r
over
a
number
ﬁeld
K
which
is
equipped
with
a
ﬁltration
of
arithmetic
vector
bundles
0
=
E
0
⊆
E
1
⊆
E
2
⊆
.
.
.
⊆
E
r−1
⊆
E
r
=
E
def
such
that
for
all
i
=
0,
.
.
.
,
r,
the
subquotients
Li
=
E
i
/E
i−1
are
arithmetic
line
bundles
which
satisfy
the
inequality
39
deg(Li
)
≥
log(DK
)
+
d
·
log(r)
+
Cd
Then
any
E-torsor
T
splits.
Proof.
Given
an
E-torsor,
we
may
assume
that
the
E-torsor
arises
(by
push-forward)
def
from
some
torsor
over
E(r−1
)
=
E
⊗Z
Z(r−1
).
By
applying
Theorem
2.4
to
the
pushforward
of
this
E(r−1
)-torsor
via
the
surjection
E(r−1
)
→
Lr
(r−1
)
–
where
we
note
that
by
assumption,
deg(Lr
(r−1
))
≥
log(DK
)
+
CD
so
it
is
alright
to
apply
Theorem
2.4
to
Lr
(r−1
)
–
we
obtain
a
splitting
of
the
resulting
Lr
(r−1
)-torsor.
Thus,
to
split
the
E(r−1
)-torsor
in
question,
it
remains
to
split
a
certain
E
r−1
(r−1
)-torsor.
Continuing
in
this
fashion
(i.e.,
pushing
forward
the
E
r−1
(r−1
)-torsor
via
the
surjection
E
r−1
(r−1
)
→
Lr−1
(r−1
),
splitting
the
resulting
Lr−1
(r−1
)-torsor
by
Theorem
2.4,
etc.)
we
see
that
relative
to
the
E(r−1
)-torsor
in
question,
we
obtain
a
splitting
sE
of
the
underlying
E(r−1
)-torsor
whose
distance
at
an
archimedean
prime
σ
from
the
approximand
(cf.
Deﬁnition
2.1)
at
σ
is
≤
1
+
1
+
...
+
1
=
r
(i.e.,
a
total
of
r
“1”’s),
where
the
r
“1”’s
arise
from
the
distance
from
the
approximands
of
the
torsors
over
L1
(r−1
),
L2
(r−1
),
.
.
.
,
Lr
(r−1
)
that
we
split
in
the
process
of
constructing
sE
.
On
the
other
hand,
to
say
that
sE
has
distance
≤
r
from
the
approximands
of
the
E(r−1
)-torsor
in
question
means
precisely
(by
the
deﬁnition
of
the
“(r
−1
)”)
that
if
we
regard
sE
as
a
splitting
of
the
original
E-torsor,
the
distance
of
sE
at
an
archimedean
place
σ
from
the
approximand
(of
the
original
E-torsor)
at
σ
is
≤
1,
i.e.,
that
sE
deﬁnes
a
splitting
of
the
original
E-torsor,
as
desired.

§3.
Splittings
with
Bounded
Denominators
Unfortunately,
Theorem
2.4
is
only
useful
when
considering
collections
of
torsors
all
of
which
are
deﬁned
over
number
ﬁelds
of
bounded
degree
(over
Q).
Ideally,
however,
we
would
like
to
be
able
to
consider
collections
of
torsors
over
various
number
ﬁelds
of
arbitrarily
large
degree.
In
this
case,
we
are
not
able
to
obtain
as
sharp
a
result
as
Theorem
2.4,
and
instead
must
settle
for
splittings
with
denominators,
as
follows:
Let
M
be
an
arithmetic
vector
bundle
over
K.
Let
T
=
(T,
s)
be
an
M
-torsor.
Thus,
T
is
an
M
-torsor.
Since
Spec(OK
)
is
aﬃne,
there
exists
a
splitting
of
T
,
i.e.,
an
OK
isomorphism
α
:
T
∼
=
M
.
Now
let
t
∈
T
(K)
=
TK
(K)
be
a
splitting
of
the
MK
-torsor
TK
40
(where
the
subscript
K
denotes
“⊗OK
K”).
Then
we
may
deﬁne
the
ideal
of
denominators
of
t
as
follows:
def
It
=
{a
∈
OK
|
a
·
αK
(t)
∈
M
}
(where
αK
:
TK
∼
=
MK
).
Since,
for
any
m
∈
M
,
we
have
a·αK
(t)
∈
M
⇐⇒
a·αK
(t+
m)
∈
M
,
it
follows
that
It
does
not
depend
on
the
choice
of
α.
Note
that
It
will
always
be
a
nonzero
ideal
in
OK
.
Also,
let
us
write
def
Den(t)
=
log(OK
/It
)
+

max{0,
log(|t
−
sσ
|σ
)}
σ
where
the
sum
ranges
over
all
σ
∈
Σ.
Note
that
t
deﬁnes
an
(integral)
splitting
(cf.
Deﬁnition
2.2)
∈
T
(OK
)
if
and
only
if
Den(t)
=
0.
Deﬁnition
3.1.
For
t
∈
TK
,
we
shall
refer
to
the
ideal
It
⊆
OK
as
the
ideal
of
denominators
of
t.
Morever,
we
deﬁne
the
size
of
the
denominators
of
t
to
be
the
number
Den(t)
∈
R≥0
.
If
λ
∈
R,
then
we
shall
call
a
section
t
∈
T
(K)
a
splitting
with
denominators
of
size
≤
λ
if
Den(t)
≤
λ.
Finally,
we
shall
say
that
t
is
integral
at
a
prime
p
(respectively,
σ
∈
Σ)
of
K
if
p
does
not
lie
in
the
support
of
OK
/It
(respectively,
|t
−
sσ
|σ
≤
1).
Theorem
3.2.
There
exists
a
universal
constant
C
∈
R
with
the
following
property:
Let
E
be
an
arithmetic
vector
bundle
of
rank
r
over
a
number
ﬁeld
K
which
is
equipped
with
a
ﬁltration
of
arithmetic
vector
bundles
0
=
E
0
⊆
E
1
⊆
E
2
⊆
.
.
.
⊆
E
r−1
⊆
E
r
=
E
def
such
that
for
all
i
=
0,
.
.
.
,
r,
the
subquotients
Li
=
E
i
/E
i−1
are
arithmetic
line
bundles
which
satisfy
the
inequality
deg(Li
)
>
log(DK
)
def
(where
d
=
[K
:
Q]).
Then
any
E-torsor
T
admits
a
splitting
with
denominators
of
size
≤
1
log(DK
)
+
C
·
rd(log(rd)
+
1)
2
(cf.
Deﬁnition
3.1).
41
Proof.
Just
as
in
the
proof
of
Theorem
2.4,
for
λ
∈
R>0
,
we
write
OK
(λ)
for
the
arithmetic
line
bundle
over
K
deﬁned
as
follows:
The
underlying
OK
-module
of
O
K
(λ)
is
OK
;
the
def
norm
of
1
∈
OK
at
each
σ
∈
Σ
is
given
by
|1|σ
=
λ−1
.
Thus,
if
λ
is
much
greater
than
1,
OK
(λ)
will
have
lots
of
global
sections
(i.e.,
its
h0
will
be
large).
Observe
further
that
if
λ
≥
1,
then
one
has
a
natural
inclusion
OK
=
OK
(1)
→
O
K
(λ)
(which
induces
the
identity
map
OK
→
OK
on
the
underlying
OK
-modules).
This
inclusion
is
integral
at
all
the
primes
(ﬁnite
and
inﬁnite)
of
K.
def
that
If
E
is
an
arithmetic
vector
bundle
on
K,
let
us
write
E(λ)
=
E
⊗OK
OK
(λ).
Note
deg(E(λ))
=
deg(E)
+
rd
·
log(λ)
If
λ
≥
1,
we
have
a
natural
inclusion
E(λ−1
)
→
E
(given
by
tensoring
the
inclusion
of
the
preceding
paragraph
with
E(λ−1
)).
Note
that
by
“pushing
forward”
(or,
equivalently,
executing
a
“change
of
structure
group”)
via
this
inclusion,
any
E(λ−1
)-torsor
induces
an
E-torsor.
Moreover,
it
follows
easily
from
the
deﬁnitions
that
every
E-torsor
arises
in
this
fashion
from
some
(not
necessarily
unique)
E(λ−1
)-torsor.
Now
let
λ
∈
R
be
≥
1.
Let
us
assume
that
we
are
given
an
E-torsor,
together
with
an
E(λ−1
)-torsor
from
which
it
arises.
This
E(λ−1
)-torsor
may
be
thought
of
as
corresponding
to
an
exact
sequence
(cf.
Example
2.3)
0
→
E(λ−1
)
→
M
→
O
K
→
0
If
we
tensor
this
exact
sequence
with
OK
(λ),
then
we
obtain
an
exact
sequence
0
→
E
→
M
(λ)
→
OK
(λ)
→
0
Now
we
would
like
to
compute
(cf.
the
proof
of
Theorem
2.4)
the
various
h0
’s
of
this
exact
sequence.
Let
us
write
C
(>
0)
for
the
universal
constant
of
Theorem
1.5.
Then
Theorem
1.5
implies
that
h0
(M
(λ))
≥
h0
((M
(λ))∗
)
−
(r
+
1)C
d(log(d)
+
log(r
+
1)
+
1)
+
χ(M
(λ))
≥
deg(M
(λ))
−
2C
rd(log(rd)
+
2)
+
(r
+
1)χ(O
K
)
=
deg(E)
+
d
·
log(λ)
−
2C
rd(log(rd)
+
2)
+
(r
+
1)χ(O
K
)
42
Next,
let
us
observe
that
for
i
=
0,
.
.
.
,
r,
we
have
∗
deg(Li
)
=
deg(ω
K
)
−
deg(Li
)
≤
log(DK
)
−
deg(Li
)
<
0
(by
Proposition
1.4
and
the
assumptions
on
E).
Thus,
in
particular,
we
have
(for
i
=
∗
∗
0,
.
.
.
,
r)
h0
(Li
)
=
0.
Since
the
given
ﬁltration
on
E
induces
a
ﬁltration
on
E
with
∗
subquotients
equal
to
Li
(for
i
=
0,
.
.
.
,
r),
we
thus
obtain:
∗
h0
(E
)
=
0
In
particular,
Theorem
1.5
implies
that
h0
(E)
≤
χ(E)
+
C
rd(log(rd)
+
1)
=
deg(E)
+
r
·
χ(OK
)
+
C
rd(log(rd)
+
1)
Putting
everything
together,
we
see
that
h0
(M
(λ))
−
h0
(E)
≥
χ(OK
)
+
d
·
log(λ)
−
3C
rd(log(rd)
+
2)
1
≥
d
·
log(λ)
−
log(DK
)
−
3C
rd(log(rd)
+
2)
2
Now
let
us
set
def
λ
=
1
log(DK
)
+
C
·
r(log(rd)
+
1)
2d
def
where
C
=
7C
.
Then
we
obtain
that
h0
(M
(λ))
−
h0
(E)
>
0,
i.e.,
there
exists
some
globally
integral
m
∈
M
(λ)
whose
image
m
in
O
K
(λ)
is
nonzero.
Moreover,
the
zero
locus
of
m
∈
OK
(λ)
has
logarithmic
degree
=
deg(O
K
(λ))
=
d
·
log(λ).
Thus,
sorting
through
m
the
deﬁnitions,
we
conclude
that
m

deﬁnes
a
splitting
of
the
torsor
T
with
denominators
of
size
≤d·λ=
1
log(DK
)
+
C
·
rd(log(rd)
+
1)
2
as
desired.

43
§4.
Examples
from
Geometry
In
this
§,
we
survey
various
examples
of
Arakelov-theoretic
torsors
that
arise
naturally
in
arithmetic
geometry.
For
a
more
detailed
discussion
of
the
ideas
surrounding
this
topic,
we
refer
to
the
Introductions
of
[Mzk1,2]
(especially,
§0.8,
2.3,
of
the
Introduction
to
[Mzk2]).
In
particular,
we
explain
the
relationship
of
the
general
notion
of
a
torsor
in
Arakelov
theory
to
the
main
topic
of
this
paper,
which
is,
eﬀectively,
the
study
of
a
speciﬁc
Arakelov-theoretic
torsor
canonically
associated
to
the
universal
extension
of
an
elliptic
curve.
Let
K
be
a
ﬁnite
extension
of
Q,
whose
ring
of
integers
we
denote
OK
.
Let
X
be
a
smooth
scheme
over
OK
.
Let
L
be
a
line
bundle
on
X.
Then
L
admits
a
connection
Zariski
locally
on
X
(since
Zariski
locally
it
is
isomorphic
to
the
trivial
line
bundle),
hence
naturally
deﬁnes
a
cohomology
class
c1
(L)
∈
H
1
(X,
ΩX/OK
)
which
is
the
Hodge-theoretic
ﬁrst
Chern
class
of
the
line
bundle
L.
More
geometrically,
one
may
think
of
the
space
of
connections
on
L
as
a
torsor
TL
→
X
over
the
vector
bundle
ΩX/OK
.
That
is
to
say,
ΩX/OK
acts
on
TL
(by
adding
a
diﬀerential
ω
to
a
given
connection
∇
to
form
a
new
connection
∇+ω),
and
moreover,
any
two
sections
of
TL
diﬀer
by
a
section
of
ΩX/OK
.
Typically,
this
torsor
will
not
admit
any
algebraic
sections
X
→
TL
over
X
(cf.,
e.g.,
[Mzk1],
Chapter
I,
§3,
Theorem
3.4).
In
fact,
if
the
topological
ﬁrst
Chern
class
of
L
(with
coeﬃcients
in
Q)
is
nonzero,
then
it
follows
that
such
sections
do
not
exist.
For
instance,
if
L
is
ample
and
X
is
proper
(of
dimension
≥
1)
over
OK
,
then
its
ﬁrst
Chern
class
will
be
nonzero,
so
TL
→
X
will
not
admit
any
global
sections.
Write
def
X
=
X(C)
for
the
complex
manifold
associated
to
X
over
C.
More
generally,
in
the
following
discussion,
we
shall
use
ordinary
Roman
letters
for
algebraic
objects
over
Z,
and
calligraphic
letters
for
the
associated
complex
analytic
objects.
(The
sole
exception
to
this
rule
will
be
def
the
notation
“O”
for
the
structure
sheaf.)
Thus,
we
write
TL
=
TL
(C).
Then
one
may
consider
real
analytic
sections
s
:
X
→
TL
44
of
the
torsor
TL
→
X
.
Typically,
holomorphic
sections
will
not
exist
(for
instance,
if
X
is
proper,
then
holomorphic
sections
are
equivalent
to
algebraic
ones).
However,
if
one
works
instead
in
the
real
analytic
category,
then
it
is
not
diﬃcult
to
show
that
real
analytic
sections
always
exist.
For
instance,
if
|
−
|L
is
a
C
∞
metric
on
the
line
bundle
L,
then
it
is
a
well-known
fact
from
complex
geometry
(cf.,
e.g.,
[Wells],
Chapter
III,
§2)
that
|
−
|L
deﬁnes
a
natural
C
∞
connection
∇
on
L.
Thus,
(by
taking
the
“(1,
0)-part”
of)
the
connection
∇
deﬁnes
a
C
∞
section
of
the
torsor
TL
→
X
.
If
|
−
|L
is
real
analytic
(and,
in
fact,
it
is
not
diﬃcult
to
show
that
every
C
∞
metric
may
be
approximated
by
a
real
analytic
one),
then
the
corresponding
section
of
TL
→
X
will
be
real
analytic.
In
summary,
Real
analytic
metrics
on
L
deﬁne
real
analytic
sections
of
TL
→
X
.
Moreover,
if
a
real
analytic
|
−
|L
deﬁnes
the
section
s
:
TL
→
X
,
then
the
real
analytic
(1,
1)-form
∂(s)
∈
Γreal
analytic
(X
,
∧1,1
ΩX
)
on
X
is
(up
to
a
universal
constant
factor)
the
curvature
of
the
metric
|
−
|L
.
Next,
we
list
some
typical
examples
of
this
sort
of
situation:
Example
4.1.
X
=
an
abelian
variety
over
an
open
subset
of
Spec(OK
).
In
this
case,
there
is
a
unique
(up
to
constant
multiple)
real
analytic
metric
on
L
whose
curvature
is
invariant
with
respect
to
translation
(cf.
[Mumf3],
§12).
Thus,
we
have
canonical
metrics
on
L.
For
instance,
in
the
case
where
X
is
an
elliptic
curve
E,
and
L
=
OE
(eE
)
(where
eE
is
the
origin
of
E),
TL
has
a
natural
abelian
group
scheme
structure
(cf.
Chapter
III,
§1,
4).
This
abelian
group
scheme
is
called
the
universal
extension
of
E
and
is
denoted
by
E
†
(cf.
Chapter
III
for
a
more
detailed
discussion
of
the
universal
extension).
Moreover,
in
this
case,
the
real
analytic
section
E
→
E
†
deﬁned
by
the
canonical
metric
on
L
is
simply
the
section
deﬁned
by
the
real
analytic
subvariety
†
ER
⊆
E
†
which
is
the
closure
of
the
torsion
points
of
E
†
.
We
refer
to
the
discussion
of
the
“Real
Analytic
Splitting”
in
Chapter
III,
§3,
for
more
details.
This
splitting
in
the
case
of
elliptic
curves
will
play
a
fundamental
role
in
this
paper.
Example
4.2.
X
=
Ag
,
the
moduli
stack
of
principally
polarized
abelian
varieties
of
dimension
g
over
Z.
In
this
case,
the
Siegel
upper
half-plane
uniformization
of
the
analytic
stack
Ag
carries
a
natural
Kähler
metric
which
is
the
unique
metric
on
the
Siegel
upper
half-plane
that
is
invariant
with
respect
to
the
natural
action
of
Sp2g
(R)
on
the
Siegel
45
upper
half-plane.
For
instance,
if
g
=
1,
then
this
metric
is
the
well-known
Poincaré
metric
dx
∧
dy
y2
on
the
upper
half-plane.
This
metric
induces
a
real
analytic
metric
on
the
canonical
bundle
of
Ag
(which
is
well-known
to
be
ample).
Example
4.3.
X
is
a
hyperbolic
curve
over
an
open
subset
of
Spec(OK
).
(A
“hyperbolic
curve”
is
a
family
of
curves
obtained
by
removing
a
divisor
of
degree
r
which
is
étale
over
the
base
from
a
family
of
smooth,
proper,
connected
genus
g
curves
such
that
2g−2+r
>
0.)
In
this
case,
it
follows
from
a
well-known
theorem
(“Köbe’s
uniformization
theorem”)
of
complex
analysis
that
the
univeral
cover
of
the
associated
analytic
object
X
is
(a
disjoint
union
of
copies
of)
the
upper
half-plane.
Thus,
the
Poincaré
metric
on
the
upper
half-plane
descends
to
deﬁne
a
real
analytic
Kähler
metric
on
X
.
Moreover,
this
real
analytic
Kähler
metric
deﬁnes
a
real
analytic
metric
on
the
canonical
bundle
of
X
(cf.
the
Introductions
to
[Mzk1,2]).
Example
4.4.
X
=
Mg,r
,
the
moduli
stack
of
hyperbolic
curves
of
type
(g,
r)
over
Z.
In
this
case,
there
is
a
canonical
real
analytic
Kähler
metric
on
the
associated
analytic
object
Mg,r
called
the
Weil-Petersson
metric.
This
real
analytic
Kähler
metric
deﬁnes
a
real
analytic
metric
on
the
canonical
bundle
of
Mg,r
(cf.
the
Introductions
to
[Mzk1,2]).
We
also
note
that
the
case
of
open
X,
or
of
X
which
have
semi-stable
reduction
over
OK
,
may
be
handled
in
a
parallel
fashion
to
the
smooth
case,
using
log
structures.
Since
we
do
not
need
to
use
log
structures
in
any
rigorous
sense
in
the
present
survey,
we
leave
this
generalization
to
the
reader.
Thus,
to
summarize,
we
see
that
canonical
line
bundles
L
on
smooth
OK
-schemes
X
naturally
deﬁne
torsors
TL
(over
the
sheaf
of
diﬀerentials
ΩX/OK
on
X)
which
typically
have
natural
real
analytic
sections
at
the
inﬁnite
primes
of
K
arising
from
canonical
real
analytic
Kähler
metrics
on
X(C).
In
particular,
if
one
is
given
an
OK
-rational
point
x
∈
X(OK
)
then,
by
restriction,
one
obtains
a
torsor
TL
|x
over
the
OK
-vector
bundle
ΩX/OK
|x
,
equipped
with
trivializations
at
the
inﬁnite
primes
of
K
(obtained
by
restricting
the
natural
real
analytic
section
of
TL
→
X
).
Since
ΩX/OK
|x
also
gets
a
metric
(obtained
by
restricting
the
Kähler
metric
on
X
=
X(C)),
we
thus
see
that
we
get
precisely
the
data
of
Deﬁnition
2.1,
i.e.,
for
each
rational
point
x,
we
obtain
an
arithmetic
torsor
(as
in
§2)
naturally
associated
to
x.
This
shows
how
arithmetic
torsors
arise
naturally
in
arithmetic
geometry.
46
In
the
present
paper,
we
will
especially
be
interested
in
the
cases
where
X
is
either
(i)
an
elliptic
curve
E,
or
(ii)
the
moduli
stack
of
elliptic
curves
over
Z.
In
fact,
the
torsor
arising
from
Examples
4.2,
4.3,
above
in
the
case
of
the
moduli
stack
of
elliptic
curves
may
be
thought
of
as
precisely
the
torsor
obtained
from
the
tautological
elliptic
curve
by
looking
at
tangent
space
to
the
origin
of
the
universal
extension
of
the
tautological
elliptic
curve
(cf.
Chapter
III,
Proposition
1.3;
Chapter
III,
§3,
“The
Real
Analytic
Splitting”;
[Mzk2],
Introduction,
§0.7,
0.8).
Thus,
in
summary,
the
torsors
that
we
are
interested
in
in
the
present
paper
all
arise
as
the
restriction
to
some
sort
of
rational
point
(where
(ii)
above
corresponds
eﬀectively
to
the
case
where
the
rational
point
is
valued
in
some
sort
of
ring
of
“dual
numbers”)
of
the
arithmetic
torsor
†
(E
†
→
E,
ER
⊆
E
†
)
given
by
the
universal
extension
of
an
elliptic
curve.
Put
another
way,
The
main
goal
of
the
present
paper
is
to
understand
the
arithmetic
torsor
†
(E
†
→
E,
E
⊆
E
†
)
given
by
the
universal
extension
of
an
elliptic
curve.
R
Bibliography
[Ahlf]
L.
Ahlfors,
Complex
Analysis,
McGraw-Hill
Book
Company
(1979).
[GS]
H.
Gillet
and
C.
Soulé,
On
the
number
of
lattice
points
in
convex
symmetric
bodies
and
their
duals,
Israel
Journal
of
Math.
74,
pp.
347-357
(1991).
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deﬁning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
3
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
RIMS
Preprint
1033
(September
1995);
Publ.
of
RIMS
32,
No.
6
(1996),
pp.
957-1151.
[Mzk2]
S.
Mochizuki,
Foundations
of
p-adic
Teichmüller
Theory,
AMS/IP
Studies
in
Advanced
Mathematics
11,
American
Mathematical
Society/International
Press
(1999).
[Szp]
L.
Szpiro,
Degrés,
intersections,
hauteurs
in
Astérisque
127
(1985),
pp.
11-28.
[Wells]
R.
O.
Wells,
Diﬀerential
Analysis
on
Complex
Manifolds,
Graduate
Texts
in
Mathematics
65,
Springer
(1980).
47
Chapter
II:
The
Galois
Action
on
Torsion
Points
§0.
Introduction
In
some
sense,
the
main
goal
of
the
present
paper
is
to
prove
a
comparison
theorem
that
relates
the
natural
Arakelov-theoretic
torsors
arising
from
an
elliptic
curve
(cf.
Chapter
I,
especially,
Chapter
I,
§4)
to
the
Galois
action
on
the
torsion
points
of
the
elliptic
curve.
In
Chapter
I,
we
introduced
the
“torsor
side”
of
this
comparison;
thus,
in
the
present
Chapter,
we
wish
to
discuss
the
“torsion
point
side”
of
the
comparison.
More
precisely,
in
this
Chapter,
we
show
that,
in
certain
situations,
the
Galois
action
on
the
torsion
points
of
an
elliptic
curve
is
as
transitive
as
possible,
i.e.,
that
(cf.
Theorem
4.4):
If
we
consider
all
elliptic
curves
over
number
ﬁelds
of
bounded
degree
which
have
semi-stable
reduction
everywhere
and
at
least
one
prime
of
bad
reduction,
then
for
any
prime
number
l
of
the
order
of
the
height
hE
of
the
elliptic
curve,
the
image
of
the
associated
Galois
representation
in
GL2
(Zl
)
contains
SL2
(Zl
).
In
particular,
the
elliptic
curve
will
not
have
any
rational
torsion
points
of
order
l.
Thus,
this
result
may
be
regarded
as
a
sort
of
“poor
man’s
uniform
boundedness
conjecture”
(now
Merel’s
theorem
([Mer])
–
although,
in
fact,
it
is
not
strictly
implied
by
Merel’s
theorem).
Alternatively,
it
may
regarded
as
an
eﬀective
version
of
a
theorem
of
Serre
([Ser],
Chapter
IV,
Theorem
3.2).
The
proof
is
similar
to
that
of
Faltings’
proof
of
the
Tate
Conjecture
([Falt]),
only
technically
much
simpler.
That
is
to
say,
the
main
technique
is
essentially
the
standard
one
(going
back
to
Tate)
for
proving
“Tate
conjecture-type
results.”
§1.
Some
Elementary
Group
Theory
Let
l
≥
5
be
a
prime
number.
In
this
§,
we
review
some
well-known
results
concerning
the
group
theory
of
SL2
(Zl
).
def
1
1
0
1
,
Lemma
1.1.
Let
G
⊆
SL2
(Fl
)
be
the
subgroup
generated
by
the
matrices
α
=
def
1
0
β
=
1
1
.
Then
G
=
SL2
(Fl
).
Note
that
if
μ,
λ
∈
Fl
,
then
β
μ
·
αλ
(where
this
expression
makes
sense
since

λ

def


both
αl
and
β
l
are
equal
to
the
identity
matrix)
takes
the
vector
v
=
01
to
μ·λ+1
.
In
Proof.
48

def

particular,
if
we
let
γ
=
01
10
,
then
for
any
λ
∈
F×
l
,
we
have
γ
·
v,
λ
·
γ
·
v
∈G
·
v.
We
thus
obtain
that
λ
·
v
∈
G
·
v.
Thus,
in
summary,
we
have
proven
that
F2l
−
{
00
}
⊆
G
·
v.
Now
let
us
prove
that
an
arbitrary
element
δ
∈
SL2
(Fl
)
is
contained
in
G.
By
the
conclusion
of
the
preceding
paragraph,
we
may
assume
that
δ
·
v
=
v.
But
this
implies
that
δ
is
an
upper
triangular
matrix
all
of
whose
diagonal
entries
are
“1.”
Thus,
δ
is
a
power
of
α,
hence
contained
in
G,
as
desired.

Corollary
1.2.
The
ﬁnite
group
SL2
(Fl
)
is
simple.
2
Proof.
Let
λ
∈
F×
l
be
such
that
λ
=
1.
(Note
that
such
λ
exists
since
l
≥
5.)
Let
2
def
λ
0

=
0
λ−1
.
Then
·
α
·
−1
·
α−1
=
αλ
−1
.
Thus,
α
(and,
similarly,
β)
is
contained
in
the
commutator
subgroup
of
SL2
(Fl
),
so
Corollary
1.2
follows
from
Lemma
1.1.

def
1
1
0
1
,
as
Lemma
1.3.
Let
G
⊆
GL2
(Fl
)
be
a
subgroup
that
contains
the
matrix
α
=
well
as
at
least
one
matrix
that
is
not
upper
triangular.
Then
SL2
(Fl
)
⊆
G.
Proof.
Note
that
α
generates
an
l-Sylow
subgroup
S
of
GL2
(Fl
),
and
that
the
number
of
l-Sylow
subgroups
of
GL2
(Fl
)
is
precisely
l
+
1.
Since
the
normalizer
of
S
in
GL2
(Fl
)
is
the
set
of
upper
triangular
matrices,
and
we
have
assumed
that
G
contains
at
least
one
such
matrix,
it
follows
that
the
number
nG
of
l-Sylow
subgroups
of
G
is
≥
2.
On
the
other
hand,
by
the
general
theory
of
Sylow
subgroups,
it
follows
that
nG
is
congruent
to
1
modulo
l.
Since
2
≤
nG
≤
l
+
1,
we
thus
obtain
that
nG
=
l
+
1.
In
particular,
in
the
notation
of
Lemma
1.1,
we
conclude
that
α,
β
∈
G.
Thus,
by
Lemma
1.1,
we
have
SL2
(Fl
)
⊆
G,
as
desired.

Let
l
be
a
prime
number
≥
5.
Let
G
⊆
GL2
(Zl
)
be
a
closed
subgroup

def

whose
image
H
in
GL2
(Fl
)
contains
the
matrix
α
=
10
11
,
as
well
as
a
matrix
which
is
not
upper
triangular.
Then
SL2
(Zl
)
⊆
G.
Corollary
1.4.
Proof.
By
Lemma
1.3,
we
have
that
SL2
(Fl
)
⊆
H.
Let
G
⊆
SL2
(Zl
)
be
the
commutator
subgroup
of
G.
Thus,
by
Corollary
1.2,
G
surjects
onto
SL2
(Fl
).
Now
by
[Ser],
Chapter
IV,
§3.4,
Lemma
3,
this
implies
that
SL2
(Zl
)
=
G
⊆
G,
as
desired.

§2.
The
Height
of
an
Elliptic
Curve
Let
K
be
a
number
ﬁeld,
of
degree
d
over
Q.
Let
E
→
Spec(OK
)
be
a
semi-abelian
variety
of
dimension
1
whose
generic
ﬁber
EK
is
proper.
Thus,
EK
is
an
elliptic
curve
over
K.
Let
us
write
49
ωE
for
the
ﬁnite,
ﬂat
OK
-module
of
rank
one
consisting
of
the
invariant
diﬀerentials
on
E.
def
If
σ
:
K
→
C
is
a
complex
embedding,
then
we
get
a
natural
metric
on
(ωE
)σ
=
(ωE
)
⊗K,σ
C
by
integration:
if
α
∈
(ωE
)σ
,
then
def
|α|2
=
α∧α
Eσ
def
(where
Eσ
=
E
⊗K,σ
C,
and
α
is
the
complex
conjugate
of
α).
Thus,
by
equipping
ωE
which
this
metric
at
the
archimedean
places
of
K,
we
obtain
an
arithmetic
line
bundle
ω
E
(cf.
Chapter
I,
Deﬁnition
1.1).
Let
us
write
def
hE
=
deg(ω
E
)
∈
R
This
number
is
often
referred
to
as
the
Faltings
height
of
the
elliptic
curve
E.
Next,
let
us
observe
that
E
→
Spec(OK
)
deﬁnes
a
classifying
morphism
φ
:
Spec(OK
)
→
M1,0
where
M1,0
is
the
moduli
stack
of
semi-abelian
varieties
of
dimension
one
over
Z.
As
is
well-known,
this
stack
has
a
“divisor
at
inﬁnity”
∞M
⊆
M1,0
,
whose
complement
M1,0
⊆
M1,0
is
the
moduli
stack
of
elliptic
curves
over
Z.
Thus,
we
may
consider
the
divisor
∞E
=
φ−1
(∞M
)
⊆
Spec(OK
)
def
Moreover,
we
let
def
deg(∞E
)
=
log(#(O∞E
))
∈
R
Now
we
have
the
following
well-known
result:
Proposition
2.1.
There
exists
a
universal
constant
C
(independent
of
K,
d,
and
E)
1
such
that:
12
·
deg(∞E
)
≤
hE
+
d
·
C.
Proof.
This
follows
immediately
from
the
formula
of
Proposition
1.1
of
[Silv2],
together
with
the
fact
that
the
archimedean
term
on
the
right-hand
side
of
this
formula
is
universally
bounded
below
by
d
·
C,
where
C
is
a
universal
constant
independent
of
K,
d,
and
E.

50
Proposition
2.2.
Let
α
∈
R.
Then
the
number
of
isomorphism
classes
of
elliptic
curves
EK
over
number
ﬁelds
K
of
degree
≤
d
such
that
hE
≤
α
is
ﬁnite.
Proof.
This
follows
from
[Silv1],
Proposition
8.2
and
[Silv2],
Proposition
1.1.

§3.
The
Galois
Action
on
the
Torsion
of
a
Tate
Curve
Let
K
be
a
ﬁnite
extension
of
Qp
,
where
p
is
a
prime
number.
Let
us
denote
its
residue
ﬁeld
by
k;
the
maximal
ideal
of
its
ring
of
integers
by
mK
;
and
its
associated
valuation
map
by
vK
:
K
×
→
Z
(normalized
so
that
vK
is
surjective).
Also,
let
us
write
K
for
def
an
algebraic
closure
of
K,
and
ΓK
=
Gal(K/K).
Let
E
→
Spec(OK
)
be
a
semi-abelian
scheme
of
dimension
one
over
OK
.
Let
us
assume,
moreover,
that
the
generic
ﬁber
EK
of
E
is
proper,
while
the
special
ﬁber
Ek
of
E
is
equal
to
(Gm
)k
,
the
multiplicative
group
over
k.
Let
l
be
a
prime
number
(possibly
equal
to
p).
Let
us
write
def
Ml
(E)
=
Hom(Z/l
·
Z,
E(K))
for
the
“mod
l”
Tate
module
of
EK
.
Thus,
Ml
(E)
is
(noncanonically)
isomorphic
as
an
Fl
-module
to
F2l
,
and
is,
moreover,
equipped
with
a
continuous
action
by
ΓK
(induced
by
the
natural
action
of
ΓK
on
K).
Also,
it
is
well-known
(see,
e.g.,
[FC],
Chapter
III,
Corollary
7.3)
that
Ml
(E)
ﬁts
into
a
natural
exact
sequence
of
ΓK
-modules
0
→
Fl
(1)
→
Ml
(E)
→
Fl
→
0
where
the
“(1)”
is
a
Tate
twist,
and
“Fl
”
is
equipped
with
the
trivial
Galois
action.
Moreover,
the
extension
class
associated
to
this
exact
sequence
is
precisely
that
obtained
by
extracting
an
lth
root
of
the
Tate
parameter
qE
∈
mK
.
The
Tate
parameter
is
an
element
of
mK
that
is
naturally
associated
to
E
and
has
the
property
that
the
subscheme
OK
/(qE
)
is
equal
to
the
pull-back
via
the
classifying
morphism
Spec(OK
)
→
M1,0
of
the
divisor
∞M
⊆
M1,0
.
Thus,
the
above
exact
sequence
splits
if
and
only
if
qE
has
an
lth
root
in
K.
Note
that
in
order
for
this
to
happen,
it
must
be
the
case
that
vK
(qE
)
is
divisible
by
l.
In
particular,
we
have
the
following
result:
Lemma
3.1.
Suppose
that
N
⊆
Ml
(E)
is
a
one-dimensional
Fl
-subspace
which
is
stabilized
by
ΓK
.
Then
either
vK
(qE
)
∈
l
·
Z,
or
N
is
equal
to
the
subspace
Fl
(1)
⊆
Ml
(E)
of
the
above
exact
sequence.
Deﬁnition
3.2.
We
shall
refer
to
vK
(qE
)
∈
Z>0
as
the
local
height
of
E.
51
Next,
let
us
recall
that
the
submodule
Fl
(1)
⊆
Ml
(E)
deﬁnes
a
ﬁnite,
ﬂat
subgroup
scheme
μl
⊆
E
over
OK
.
Thus,
we
may
form
the
quotient
def
E
=
E/μl
Then
E
→
Spec(OK
)
is
a
one-dimensional
semi-abelian
scheme
over
OK
whose
special
ﬁber
is
(Gm
)k
and
whose
generic
ﬁber
is
proper.
Moreover,
its
Tate
parameter
qE

satisﬁes
l
qE

=
qE
Let
us
write
def
deg(∞E
)
=
log(#(OK
/(qE
)))
∈
R
Then
we
have
deg(∞E

)
=
l
·
deg(∞E
)
§4.
An
Eﬀective
Estimate
of
the
Image
of
Galois
Let
us
write
Q
for
an
algebraic
closure
of
Q.
Let
K
be
a
subﬁeld
of
Q
of
degree
d
<
∞
over
Q,
and
let
E
→
Spec(OK
)
be
as
in
§2.
Let
l
be
a
prime
number.
Suppose
that
we
are
given
a
subgroup
scheme
GK
⊆
EK
(over
K)
such
that
over
Q,
GK
becomes
isomorphic
to
Z/l
·
Z.
We
shall
call
such
GK
lcyclic.
Write
(EG
)K
for
the
quotient
of
EK
by
GK
.
Note
that
since
(EG
)K
is
isogenous
to
EK
,
it
has
semi-stable
reduction
at
all
the
primes
of
K,
hence
extends
to
a
one-dimensional
semi-abelian
scheme
EG
→
Spec(OK
).
Lemma
4.1.
Suppose
that
GK
⊆
EK
is
l-cyclic,
and
that
l
is
greater
than
the
local
heights
of
E
at
all
of
its
primes
of
bad
(multiplicative)
reduction.
Then
there
exists
a
universal
constant
C
(independent
of
K,
d,
and
E)
such
that
1
l
·
deg(∞E
)
≤
hE
+
d
·
C
+
2d
·
log(l)
12
52
Proof.
Note
that
the
assumption
on
l
implies
(by
Lemma
3.1)
that
at
all
the
primes
of
bad
reduction,
GK
corresponds
to
the
subspace
Fl
(1)
of
Lemma
3.1.
Thus,
at
primes
of
bad
reduction,
EG
may
be
identiﬁed
with
the
elliptic
curve
E
discussed
at
the
end
of
§3.
In
particular,
deg(∞EG
)
=
l
·
deg(∞E
)
On
the
other
hand,
the
degree
l
covering
morphism
(EG
)K
→
EK
extends
(cf.,
e.g.,
[FC],
Chapter
I,
Proposition
2.7)
to
a
morphism
EG
→
E.
Thus,
we
have
a
natural
inclusion
ωE
⊆
ωEG
whose
cokernel
is
annihilated
by
l.
Moreover,
since
integrating
a
(1,
1)-form
over
Eσ
diﬀers
from
integrating
over
(E/G)σ
by
a
factor
of
l,
it
follows
that
deg(ω
EG
)
≤
deg(ω
E
)
+
2d
·
log(l)
Thus,
Lemma
4.1
follows
from
Proposition
2.1.

Lemma
4.2.
There
exists
a
universal
(positive)
constant
C
(independent
of
d)
such
that
for
each
positive
integer
d,
there
exists
a
ﬁnite
subset
Ed
⊆
M1,0
(Q)
with
the
following
property:
Suppose
that
there
exists
an
l-cyclic
GK
⊆
EK
,
where
[K
:
Q]
=
d;
EK
is
an
elliptic
curve
over
K
with
semi-stable
reduction
at
all
primes
and
at
least
one
prime
of
bad
reduction;
and
l
≥
100
·
(hE
+
C
·
d2
).
Then
the
point
of
[EK
]
∈
M1,0
(Q)
deﬁned
by
EK
belongs
to
Ed
.
Proof.
First,
observe
that
if
v
is
any
local
height
of
EK
,
then
deg(∞E
)
≥
v
·
log(2).
Thus,
Proposition
2.1
implies
that
by
choosing
C
appropriately,
we
may
assume
that
1
·
deg(∞E
).
Thus,
we
obtain
that
hE
+
C
·
d2
≥
hE
+
C
·
d
≥
12
100
·
deg(∞E
)
12
100
·
log(2)
)·v
≥(
12
>v
l≥
which
shows
that
the
hypotheses
of
Lemma
4.1
are
satisﬁed.
Thus,
we
conclude
(from
Lemma
4.1)
that
if
we
choose
C
so
that
l
≥
48d·log(l)
(cf.
Lemma
4.3
below)
then
log(2)
1
l
·
deg(∞E
)
≤
hE
+
d
·
C
+
2d
·
log(l)
12
l
·
log(2)
≤
hE
+
d
·
C
+
24
53
for
some
universal
constant
C
.
Next,
observe
that
since
EK
has
at
least
one
prime
of
bad
reduction,
it
follows
that
log(2)
≤
deg(∞E
).
Thus,
substituting
into
the
above
inequality,
we
obtain
that
l
·
log(2)
≤
hE
+
d
·
C
24
2
On
the
other
hand,
log(2)
≥
100
,
and,
by
assumption,
l
≥
100
·
hE
,
so
(substituting)
we
24
obtain
that
2hE
≤
hE
+
d
·
C
,
i.e.,
hE
≤
d
·
C
.
But
this
implies,
by
Proposition
2.2,
that
[EK
]
belongs
to
some
ﬁnite
exceptional
set
Ed
,
as
desired.

Lemma
4.3.
x
≥
y
·
log(x).
Let
x
and
y
be
real
numbers
such
that
x,
y
≥
2,
and
x
≥
2y
2
.
Then
Proof.
First
observe
that
y
≥
12
·
log(2)
+
log(y)
for
y
≥
2.
Indeed,
this
is
true
for
y
=
1
(since
4
≥
3
≥
3
·
log(2)),
and
the
function
φ(y)
=
y
−
log(y)
has
derivative
1
−
y1
,
which
1
is
≥
0
for
y
≥
1.
Thus
when
x
=
2y
2
,
we
have
x
=
2y
2
≥
2y
·
log(2
2
·
y)
=
y
·
log(x),
as
desired.
Moreover,
the
function
ψ(x)
=
x
−
y
·
log(x)
has
derivative
1
−
xy
,
which
is
≥
0
for
x
≥
2y
2
≥
2y
≥
y
(since
y
≥
1).
Thus,
ψ(x)
is
increasing
for
x
≥
2y
2
,
so
ψ(x)
≥
0
for
x
≥
2y
2
,
as
desired.

Theorem
4.4.
There
exist:
(1)
a
universal
(positive)
constant
C
(independent
of
d);
and
(2)
for
each
positive
integer
d,
a
ﬁnite
subset
Ed
⊆
M1,0
(Q)
with
the
following
property:
Suppose
that
(i.)
K
⊆
Q
is
a
subﬁeld
of
degree
d
<
∞;
(ii.)
EK
is
an
elliptic
curve
over
K
with
semi-stable
reduction
at
all
primes
and
at
least
one
prime
of
bad
reduction;
(iii.)
the
isomorphism
class
[EK
]
∈
M1,0
(Q)
does
not
belong
to
Ed
;
(iv.)
l
is
a
prime
number
≥
100
·
(hE
+
C
·
d2
).
Then
the
image
of
the
Galois
representation
Gal(Q/K)
→
GL2
(Zl
)
associated
to
EK
contains
SL2
(Zl
).
54
Proof.
As
we
saw
in
the
proof
of
Lemma
4.2,
in
the
situation
under
consideration,
the
local
height
of
EK
at
a
ﬁnite
prime
of
EK
of
bad
reduction
can
never
be
divisible
by
l.
Since,
by
hypothesis,
at
least
one
such
ﬁnite
prime
exists,
it
follows
that

the
image
of
Galois
in
GL2
(Fl
)
contains
the
element
“α”
(cf.
Corollary
1.4),
i.e.,
10
11
.
Moreover,
by
Lemma
4.2,
it
follows
that
the
image
of
Galois
in
GL2
(Fl
)
contains
at
least
one
matrix
which
is
not
upper
triangular.
Thus,
we
conclude
from
Corollary
1.4
that
the
image
of
Galois
in
GL2
(Zl
)
contains
SL2
(Zl
),
as
desired.

Bibliography
[Falt]
G.
Faltings,
Endlichkeitssätze
für
abelsche
Varietäten
über
Zahlkörpern,
Invent.
Math.
73,
pp.
349-366
(1983).
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer
(1990).
[Mer]
L.
Merel,
Bornes
pour
la
torsion
des
courbes
elliptiques
sur
les
corps
de
nombres,
Invent.
Math.
124,
pp.
437-449
(1996).
[Ser]
J.-P.
Serre,
Abelian
l-adic
Representations
and
Elliptic
Curves,
Benjamin
(1968).
[Silv1]
J.H.
Silverman,
The
Theory
of
Height
Functions
in
Arithmetic
Geometry,
ed.
by
G.
Cornell
and
J.H.
Silverman,
Springer
(1986).
[Silv2]
J.H.
Silverman,
Heights
and
Elliptic
Curves
in
Arithmetic
Geometry,
ed.
by
G.
Cornell
and
J.H.
Silverman,
Springer
(1986).
55
Chapter
III:
The
Universal
Extension
of
a
Log
Elliptic
Curve
§0.
Introduction
In
this
Chapter,
we
review
various
well-known
facts
concerning
the
universal
extension
of
an
elliptic
curve.
The
main
ideas
that
we
discuss
are
as
follows:
Given
a
log
elliptic
curve
(cf.
Deﬁnition
1.1)
E
→
S,
we
deﬁne
its
universal
extension
E
†
→
E
(cf.
Deﬁnition
1.2)
as
a
certain
group
scheme
of
line
bundles
on
E
of
degree
0
equipped
with
a
connection.
For
degenerating
log
elliptic
curves
(i.e.,
“Tate
curves”),
this
universal
extension
admits
a
canonical
splitting
(cf.
Theorem
2.1)
which
is
essentially
uniquely
characterized
by
the
fact
that
it
is
a
group
homomorphism.
The
universal
extension
E
†
→
E
also
has
a
Hodgetheoretic
interpretation
(cf.
Theorem
4.2)
as
the
Hodge-theoretic
ﬁrst
Chern
class
of
the
divisor
deﬁned
by
the
origin
of
E.
Moreover,
this
Hodge-theoretic
interpretation
of
the
universal
extension
allows
one
to
analytically
continue
(cf.
Theorem
5.6)
the
canonical
splitting,
relative
to
the
function-theoretic
context
of
[Mumf].
We
construct
this
analytic
continuation
by
studying
the
Schottky-Weierstrass
ζ-function
(cf.
§5),
which
is
a
certain
analogue
of
the
classical
Weierstrass
ζ-function,
but
for
the
Schottky
uniformization
(as
opposed
to
the
full
uniformization
by
the
complex
plane,
as
in
the
classical
case)
of
an
elliptic
curve.
This
analytic
continuation
allows
one
to
give
explicit
coordinates
for
the
torsion
points
of
the
universal
extension
(cf.
Corollary
5.9),
which
play
a
fundamental
role
in
this
paper.
During
our
analysis
of
the
universal
extension,
we
pause,
in
§3
(cf.
also
Remark
2
in
§6),
to
review
the
complex
analogues
of
the
ideas
discussed
in
this
Chapter.
Finally,
in
§6,
7,
we
discuss
certain
“higher”
analogues
of
the
Schottky-Weierstrass
ζfunction.
§1.
Deﬁnition
of
the
Universal
Extension
In
this
§,
we
would
like
to
deﬁne
a
certain
canonical
extension
of
a
“log
elliptic
curve”
–
called
the
universal
extension
of
the
log
elliptic
curve
–
which
will
play
a
key
role
in
the
present
paper.
One
useful
reference
for
this
universal
extension
(in
the
non-logarithmic
case)
is
Appendix
C
of
[Katz].
Let
M1,1
56
be
the
moduli
stack
of
one-pointed
stable
curves
of
genus
one
over
Z
(see,
e.g.,
[Knud]
for
more
details).
Note
that
M1,1
is
equipped
with
a
natural
log
structure
(in
the
sense
of
log
[Kato])
deﬁned
by
its
divisor
at
inﬁnity.
We
denote
the
resulting
log
stack
by
M1,1
.
Let
(C
→
M1,1
,
:
M1,1
→
C)
denote
the
tautological
one-pointed
stable
curve
of
genus
one.
Now
observe
that
the
inverse
image
on
C
of
the
divisor
at
inﬁnity
of
M1,1
is
a
divisor
with
normal
crossings
on
C,
hence
deﬁnes
in
a
natural
way
a
log
structure
on
C.
Denote
the
resulting
log
stack
by
C
log
.
Let
log
def
log
M1,0
=
M1,1
.
Thus,
we
have
a
natural
log
smooth
morphism
log
C
log
→
M1,0
together
with
a
section
:
M1,0
→
C.
Let
E
⊆
C
be
the
open
substack
of
C
of
points
that
are
smooth
over
M1,0
.
Since
maps
into
E,
we
have
(by
abuse
of
notation)
a
section
:
M1,0
→
E.
Moreover,
(E
→
M1,0
,
:
M1,0
→
E)
forms
a
semi-abelian
scheme
(see,
e.g.,
[FC],
Deﬁnition
2.3
of
Chapter
I,
for
more
details)
of
dimension
1
over
M1,0
.
log
Deﬁnition
1.1.
We
shall
refer
to
(C
log
→
M1,0
,
:
M1,0
→
E)
as
the
universal
log
elliptic
curve.
If
S
log
is
a
ﬁne
noetherian
log
scheme
(see
[Kato]
for
more
details),
then
we
log
shall
refer
to
the
datum
of
a
morphism
α
:
S
log
→
M1,0
as
a
log
elliptic
curve.
This
deﬁnition
prompts
the
following
basic
remarks:
log
log
(1)
The
point
of
distinguishing
M1,0
from
M1,1
(even
though
both
notations
denote
the
same
log
stack)
is
that
the
natural
log
structures
of
the
tautological
objects
that
they
parametrize
diﬀer.
This
leads
for
instance
to
diﬀerent
canonical
p-adic
uniformization
theories
(as
in
[Mzk1]).
log
(2)
Let
α
:
S
log
→
M1,0
be
a
log
elliptic
curve.
Then
pulling
back
C
log
→
log
M1,0
,
E,
and
gives
rise
to
C
log
→
S
log
,
E
→
S,
e
:
E
→
S.
Often,
by
abuse
of
terminology,
we
shall
say
“let
C
log
→
S
log
be
a
log
elliptic
curve.”
This
means
that
implicitly
we
assume
that
some
α
has
been
given
and
that
C
log
has
been
constructed
from
α
in
the
fashion
just
described.
This
completes
the
discussion
of
the
deﬁnition
of
a
log
elliptic
curve.
57
Let
f
log
:
C
log
→
S
log
be
a
log
elliptic
curve.
Let
ωE
=
e∗
ΩE/S
def
Thus,
ωE
is
a
line
bundle
on
S.
Let
W
→
S
denote
the
aﬃne
group
scheme
deﬁned
by
def
∨
(the
dual
bundle
to
ωE
.
Thus,
W
is
the
spectrum
of
the
symmetric
algebra
of
τE
=
ωE
ωE
)
over
OS
.
Now
we
would
like
to
deﬁne
a
natural
extension
of
group
schemes
0
→
W
→
E†
→
E
→
0
(cf.
Appendix
C,
§C1,
of
[Katz]),
as
follows.
First,
let
T
be
an
S-scheme.
Since
E
†
will
be
deﬁned
as
a
functor
over
E,
points
of
E
†
(T
)
will
consist
of
points
of
E(T
)
plus
some
extra
information:
We
deﬁne
E
†
(T
)
to
be
the
set
of
isomorphism
classes
of
pairs
(x,
∇x
),
where
x
∈
E(T
),
and
∇x
is
a
logarithmic
connection
(with
respect
to
def
the
morphism
C
log
→
S
log
)
on
the
line
bundle
Lx
=
OCT
(x
−
e)
(where
CT
=
C
×S
T
).
(Here
in
the
notation
“OCT
(x
−
e),”
we
use
“e”
(respectively,
“x”)
to
denote
the
(Cartier)
divisor
deﬁned
by
the
image
of
the
section
e
(respectively,
x)
in
CT
.)
It
is
immediately
clear
that
E
†
is
a
torsor
over
E
under
the
group
scheme
W
(since
ωE
may
be
identiﬁed
with
the
push-forward
of
ΩC
log
/S
log
via
f
log
:
C
log
→
S
log
).
Moreover,
E
†
has
a
natural
abelian
group
law
of
its
own
given
as
follows:
The
sum
of
(x,
∇x
)
and
(y,
∇y
)
is
the
line
bundle
Lx+y
∼
=
Lx
⊗OCT
Ly
equipped
with
the
connection
∇x
⊗
∇y
.
Deﬁnition
1.2.
We
shall
refer
to
the
exact
sequence
0
→
W
→
E†
→
E
→
0
of
smooth,
abelian
group
schemes
over
S
as
the
universal
extension
of
E
→
S
(or
C
log
→
S
log
).
Let
def
log
OC
H
=
R1
fDR,∗
58
be
the
ﬁrst
(logarithmic)
de
Rham
cohomology
module
of
f
log
:
C
log
→
S
log
(see,
e.g.,
[Kato]).
Then
H
is
a
rank
two
vector
bundle
on
S
equipped
with
a
ﬁltration
called
the
Hodge
ﬁltration.
This
ﬁltration
gives
rise
to
an
exact
sequence
0
→
ωE
→
H
→
τE
→
0
Proposition
1.3.
There
is
a
canonical
isomorphism
between
H
and
the
tangent
space
to
the
group
scheme
E
†
at
the
origin.
Moreover,
the
exact
sequence
above
arising
from
the
Hodge
ﬁltration
on
H
corresponds
under
this
isomorphism
to
the
ﬁltration
induced
on
the
tangent
space
at
the
origin
to
E
†
by
the
exact
sequence
0
→
W
→
E
†
→
E
→
0.
Proof.
This
follows
immediately
by
working
over
the
dual
numbers
S[ε]/(ε2
)
and
thinking
about
the
functorial
deﬁnitions
of
E
†
and
de
Rham
cohomology.

§2.
Canonical
Splitting
at
Inﬁnity
We
maintain
the
notations
of
§1.
In
this
§,
we
would
like
to
discuss
certain
canonical
splittings
of
the
universal
extension
E
†
→
E
of
E.
In
this
§,
we
assume
that
the
inverse
image
(via
the
implicit
classifying
morphism
log
α
:
S
log
→
M1,0
for
the
given
log
elliptic
curve)
of
the
divisor
at
inﬁnity
of
M1,0
is
a
(Cartier)
divisor
D
⊆
S.
Write
J
for
the
ideal
deﬁning
D.
Thus,
J
is
a
line
bundle
on
S.
Moreover,
we
have
a
natural
identiﬁcation:
E|D
=
(Gm
)D
Now
let
S
be
the
completion
of
S
at
D.
Thus,
S
is
a
formal
scheme.
Let
us
write
ES
for
the
formal
object
obtained
by
pulling
back
E
→
S
to
S.
Then
one
knows
that
ES
∼
=
(Gm
)S
(where
the
isomorphism
is
an
isomorphism
of
J
-adic
formal
group
objects
over
the
formal
scheme
S).
Indeed,
this
is
a
relative
simple
special
case
(the
case
already
known
to
Tate)
of
the
theory
of
[FC],
Chapter
III.
In
fact,
this
isomorphism
is
the
unique
such
isomorphism
that
reduces
to
the
identity
over
D
(by
[FC],
Chapter
I,
Theorem
2.2).
Now
let
us
pull-back
the
universal
extension
E
†
→
E
to
a
morphism
†
E
→
ES
S
59
over
S.
We
would
like
to
construct
a
certain
canonical
section
of
this
morphism.
This
canonical
section
will
be
a
homomorphism
of
group
objects.
Thus,
by
[FC],
Chapter
I,
Theorem
2.2,
it
will
exist
and
be
unique
once
it
is
constructed
over
D.
The
deﬁnition
of
this
canonical
section
over
D
is
given
as
follows:
As
discussed
above,
we
identify
ED
with
(Gm
)D
.
Let
us
think
of
the
aﬃne
ring
of
(Gm
)D
as
the
ring
of
Laurent
polynomials
in
an
indeterminate
u.
Now
let
x
be
a
D-valued
point
of
(Gm
)D
.
Then
(as
in
Appendix
C,
§C1,
of
[Katz])
points
of
E
†
lying
over
x
may
be
identiﬁed
with
sections
of
ωC
log
/S
log
⊗OS
OD
that
are
regular
away
from
x
and
e,
but
have
a
simple
pole
with
residue
1
(respectively,
−1)
at
x
(respectively,
e).
For
instance,
if
x
corresponds
to
the
section
ux
×
of
OD
,
then
def
ωx
=
du
du
−
(u
−
ux
)
(u
−
1)
is
such
a
diﬀerential.
Since
the
correspondence
x
→
ωx
is
clearly
functorial,
we
thus
obtain
a
scheme-theoretic
section
†
ED
→
ED
It
remains
to
check
that
this
is
a
homomorphism
of
group
schemes.
To
see
this,
suppose
def
that
y
∈
E(D),
z
=
x
·
y.
Then
the
isomorphism
between
OCD
(x
−
e)
⊗
OCD
(y
−
e)
and
OCD
(z
−
e)
is
given
by
division
by
the
rational
function
(u
−
1)(u
−
uz
)
(u
−
ux
)(u
−
uy
)
Moreover,
the
logarithmic
derivative
of
this
rational
function
is
clearly
equal
to
ωz
−ωx
−ωy
.
This
observation
implies
that
the
section
constructed
is
a
homomorphism
of
group
schemes,
as
desired.
Thus,
in
summary,
we
see
that
we
have
constructed
a
homomorphism
of
group
objects
κ
:
ES
→
E
†
S
†
in
the
formal
category
over
S
which
forms
a
section
of
E
→
ES
.
Moreover,
since
there
S
are
no
nontrivial
homomorphisms
from
Gm
into
W
(note:
W
is
Zariski
locally
isomorphic
to
Ga
),
it
follows
that
κ
is
the
unique
such
section.
We
state
this
as
a
theorem:
Theorem
2.1.
The
extension
†
0
→
WS
→
ES
→
E
→
0
S
60
of
group
objects
over
the
formal
scheme
S
admits
a
unique
splitting
κ
:
ES
→
E
†
S
–
which
we
shall
refer
to
as
the
canonical
splitting
of
this
extension.
In
particular,
it
follows
that
there
exists
a
natural
isomorphism
†
E
∼
=
(Gm
)S
×
WS
S
of
group
objects
over
S.
Now
recall
that
E
†
may
be
thought
of
as
an
ωE
-torsor
over
E.
Thus,
in
particular,
we
may
write
this
torsor
as
an
extension
of
coherent
OE
-modules
0
→
OE
→
T
→
τE
|E
→
0
Let
R
†
be
the
sheaf
of
quasi-coherent
OE
-algebras
whose
spectrum
is
E
†
:
E
E
†
=
Spec(R
†
)
E
Thus,
Zariski
locally
on
E,
R
†
is
the
symmetric
algebra
over
OE
of
τE
|E
.
Moreover,
E
there
is
a
natural
inclusion
T
⊆R
†
E
and
T
generates
R
†
as
an
OE
-algebra.
If
i
is
a
positive
integer,
let
us
denote
by
E
R
†
[i]
⊆
R
†
E
E
the
OE
-submodule
of
R
†
generated
by
OE
-linear
combinations
of
products
of
i
sections
E
def
of
T
.
(Also,
let
R
†
[0]
=
OE
.)
E
Deﬁnition
2.2.
We
shall
refer
to
sections
of
O
†
that
lie
inside
R
†
[i]
as
being
of
E
E
torsorial
degree
≤
i.
More
generally,
if
L
is
a
line
bundle
on
E,
then
we
shall
refer
to
sections
of
L
⊗OE
O
†
that
lie
inside
L
⊗OE
R
†
[i]
as
being
of
torsorial
degree
≤
i.
E
E
Now
by
Theorem
2.1,
we
have
a
natural
splitting
61
†
E
∼
=
ES
×
WS
S
This
natural
splitting
then
induces
an
isomorphism
(R
†
)S
∼
=
OE
[τE
|E
]
E
S
S
(where
“[−]”
means
“the
symmetric
algebra
of”).
That
is
to
say,
whereas
R
†
is,
in
genE
eral,
only
Zariski
locally
isomorphic
to
a
polynomial
algebra,
over
S,
it
becomes
naturally
isomorphic
to
a
polynomial
algebra
(i.e.,
the
symmetric
algebra
of
τE
|E
).
Thus,
if
f
is
a
S
section
of
L
⊗
O
†
,
one
can
make
the
following
deﬁnition:
E
S
Deﬁnition
2.3.
We
shall
refer
to
the
degree
i
term
of
f
(relative
to
the
above
isomorphism
of
(R
†
)S
with
a
polynomial
algebra)
as
the
degree
i
component
E
Compi
(f
)
∈
L
⊗OS
τE⊗i
|E
S
of
f
.
§3.
Canonical
Splittings
in
the
Complex
Case
Before
proceeding,
we
pause
to
review
the
basic
theory
of
the
universal
extension
and
its
canonical
splittings
over
the
complex
numbers
(cf.,
e.g.,
[Katz],
Appendix
C).
Thus,
let
E
be
an
elliptic
curve
over
C.
Then
its
universal
extension
E
†
may
be
constructed
analytically
as
follows:
First,
recall
the
de
Rham
isomorphism
1
1
(E,
OE
)
∼
(E,
C)
HDR
=
Hsing
between
the
de
Rham
cohomology
(algebraic
or
holomorphic)
of
E
and
the
singular
cohomology
of
E
with
complex
coeﬃcients.
Let
def
1
Λ
⊆
H
=
HDR
(E,
OE
)
be
the
subgroup
deﬁned
(using
the
de
Rham
isomorphism)
by
1
1
Hsing
(E,
2πi
·
Z)
⊆
Hsing
(E,
C)
62
Thus,
Λ
is
a
free
Z-module
of
rank
2,
and
C
⊗Z
Λ
∼
=
H.
Now
by
Proposition
1.3
and
the
well-known
theory
of
the
(complex
analytic)
exponential
map
of
a
complex
Lie
group,
we
have
a
natural
uniformizing
map
H
→
E†
compatible
with
the
additive
group
structures
of
H
and
E
†
.
Moreover,
the
kernel
of
this
homomorphism
(cf.
the
discussion
at
the
end
of
[Katz],
Appendix
C,
§C5)
is
Λ⊆H
Thus,
we
have
the
following:
Proposition
3.1.
If
E
is
an
elliptic
curve
over
C,
then
(the
complex
Lie
group
deﬁned
by)
E
†
is
naturally
isomorphic
to
the
quotient
H/Λ
where
H
is
the
ﬁrst
de
Rham
cohomology
module
of
E,
and
Λ
is
the
Z-submodule
arising
from
the
singular
cohomology
of
E
with
coeﬃcients
in
2πi
·
Z.
Next,
we
would
like
to
discuss
certain
canonical
splittings
that
exist
in
the
complex
analytic
case.
In
fact,
in
the
complex
analytic
case,
there
are
three
diﬀerent
types
of
canonical
splitting,
all
of
which
are
well-known
and
classical,
and
all
of
which
will
be
relevant
to
the
theory
of
the
present
paper
(but
in
diﬀerent
ways).
The
three
canonical
splittings
that
we
will
consider
are
the
following:
The
Real
Analytic
Splitting:
Write
ΛR
(respectively,
ΛC
)
for
Λ
⊗Z
R
(respectively,
Λ
⊗Z
C).
Deﬁne
ER
=
ΛR
/Λ
⊆
ΛC
/Λ
=
E
†
def
Thus,
ER
is
a
real
analytic
submanifold
of
E
†
.
Moreover,
it
is
easy
to
see
that
ER
maps
bijectively
onto
E,
i.e.,
we
have
an
isomorphism
of
real
analytic
Lie
groups
ER
∼
=E
Unlike
E,
however,
ER
is
only
a
“real
analytic
torus,”
not
a
complex
analytic
torus
inside
E
†
.
Put
another
way,
ER
deﬁnes
a
real
analytic
section
63
κR
:
E
→
E
†
of
E
†
→
E
which
is
a
homomorphism
in
the
category
of
real
analytic
Lie
groups.
Deﬁnition
3.2.
We
shall
refer
to
κR
:
E
→
E
†
as
the
canonical
real
analytic
section
of
E
†
→
E.
Remark
1.
Note
in
particular
that
since
κR
is
a
group
homomorphism,
it
maps
torsion
points
of
E
to
torsion
points
of
E
†
.
Thus,
although
κR
is
only
deﬁned
in
the
real
analytic
category,
its
restriction
to
torsion
points
can
be
deﬁned
entirely
algebraically.
For
instance,
if
E
is
deﬁned
over
a
number
ﬁeld,
then
the
restriction
of
κR
to
torsion
points
of
E
is
also
deﬁned
over
a
number
ﬁeld.
This
fact
will
be
of
fundamental
importance
in
this
paper.
Remark
2.
Although
the
following
discussion
will
not
be
very
relevant
to
the
present
paper,
the
reader
might
wonder
(in
view
of
the
choice
of
notation)
whether
κR
is,
in
some
sense,
“analogous”
to
the
formal
analytic
κ
of
Theorem
2.1.
In
fact,
there
is
an
analogy:
Namely,
ER
⊆
E
†
may
be
obtained
as
the
invariant
subset
of
a
certain
natural
complex
conjugation
morphism
on
E
†
.
Moreover,
frequently
in
discussions
of
global
motives,
it
is
natural
to
think
of
complex
conjugation
as
“Frobenius
at
the
inﬁnite
prime.”
On
the
other
hand,
the
splitting
κ
may
also
be
constructed
p-adically
as
follows:
E
†
may
be
thought
of
as
a
certain
crystal
in
group
schemes
on
the
log
crystalline
site
of
S
log
.
Put
another
way,
E
†
is,
in
essense,
the
log
crystalline
cohomology
of
C
log
→
S
log
with
coeﬃcients
in
O
×
.
Moreover,
as
a
log
crystalline
cohomology
object,
E
†
is
equipped
with
a
natural
Frobenius
action.
The
section
κ
may
then
be
constructed
p-adically
as
the
unique
Frobenius
invariant
section
of
E
†
→
E.
That
is
to
say,
both
κ
and
κR
may
be
constructed
as
invariant
subsets
of
Frobenius
actions
at
ﬁnite
and
inﬁnite
primes,
respectively.
We
refer
to
the
discussion
of
[Mzk2],
Introduction,
§1,
for
more
details.
The
Gm
-Splitting:
To
deﬁne
this
splitting,
ﬁx
a
rank
one
Z-submodule:
Λ1
⊆
Λ
This
splitting
deﬁnes
an
intermediate
covering
of
the
covering
deﬁned
by
the
exponential
map
of
E:
τE
→
τE
/Λ1
→
τE
/Λ
=
E
(where
by
abuse
of
notation,
we
also
denote
by
Λ
the
image
of
Λ
⊆
H
under
the
projection
H
→
τE
arising
from
the
Hodge
ﬁltration).
Note
that
τE
/Λ1
is
isomorphic
(by
an
isomorphism
which
is
unique
up
to
composition
with
the
inversion
map)
to
Gm
(i.e.,
the
64
multiplicative
group
Gm
over
C,
regarded
as
a
complex
analytic
Lie
group).
Thus,
in
the
following
discussion,
we
shall
make
the
following
identiﬁcation:
τE
/Λ1
=
Gm
In
other
words,
the
choice
of
Λ1
deﬁnes
a
uniformization
of
E
by
Gm
.
In
particular,
we
may
think
of
this
uniformization
as
giving
a
presentation
of
E
as
follows:
E
=
Gm
/q
Z
where
q
∈
Gm
=
C×
.
This
uniformization
of
E
is
referred
to
as
the
Schottky
uniformization
of
E
(and
depends
on
the
choice
of
Λ1
⊆
Λ).
Now
let
us
consider
the
universal
extension
E
†
of
E.
Now
we
have
a
commutative
diagram:
Λ1

=
def
(Λ1
)C
=
Λ1
⊗Z
C
Λ1

⊆
ΛC
=
H
=
Λ1

−→
τE
If
we
form
the
quotient
of
the
second
line
by
the
ﬁrst,
we
then
obtain
two
morphisms
(Λ1
)C
/Λ1
−→
E
†
|Gm
−→
Gm
whose
composite
is
an
isomorphism.
Put
another
way,
we
have
constructed
a
holomorphic
section
κΛ1
:
Gm
→
E
†
|Gm
of
the
pull-back
of
E
†
→
E
by
Gm
→
E.
Deﬁnition
3.3.
We
shall
refer
to
κΛ1
as
the
Gm
-splitting
associated
to
Λ1
.
Remark.
This
splitting
is
the
complex
analogue
of
the
splitting
of
Theorem
2.1.
Indeed,
it
is
not
diﬃcult
to
check
that
if,
in
the
context
of
Theorem
2.1,
i.e.,
of
a
degenerating
1
elliptic
curve,
one
takes
for
Λ1
⊆
Hsing
(E,
2πiZ)
=
H1sing
(E,
Z)∨
(where
“∨”
denotes
the
dual
Z-module)
the
Z-submodule
which
is
the
annihilator
of
the
submodule
Ker{H1sing
(E,
Z)
→
H1sing
(the
degenerate
elliptic
curve,
Z)
=
Z}
65
i.e.,
the
annihilator
of
the
vanishing
cycle,
then
for
this
choice
of
Λ1
,
the
splitting
κΛ1
just
constructed
coincides
with
the
complex
analytic
splitting
of
the
universal
extension
deﬁned
by
the
κ
of
Theorem
2.1
in
a
(complex
analytic)
neighborhood
of
the
point
at
inﬁnity
∞
∈
M1,0
(C).
Indeed,
the
fact
that
these
two
splittings
coincide
follows
from
the
fact
that
there
do
not
exist
any
nontrivial
homomorphisms
of
complex
Lie
groups
C×
→
C.
The
η-Splitting:
Here,
we
follow
the
treatment
of
[Katz],
Appendix
C,
§C5.
Fix
a
Clinear
isomorphism
C
∼
=
ωE
.
This
isomorphism
makes
it
easier
to
describe
the
splitting
in
question.
In
fact,
however,
the
splitting
will
be
entirely
independent
of
the
choice
of
isomorphism
C
∼
=
ωE
.
Once
this
isomorphism
is
ﬁxed,
we
get
a
choice
of
invariant
diﬀerential
ω
=
dz
(where
z
is
the
standard
coordinate
on
C),
and
so
we
can
write
E
=
C/Λ
(where
by
abuse
of
notation,
we
also
denote
by
Λ
the
image
of
Λ
⊆
H
under
the
projection
H
→
τE
arising
from
the
Hodge
ﬁltration).
Moreover,
one
has
the
Weierstrass
℘-function
(see,
e.g.,
[Ahlf],
p.
272,
for
a
treatment)
1
℘(z)
=
2
+
z

def
def
0=λ∈Λ

1
1
−
2
2
(z
−
λ)
λ

def
Let
us
write
x
=
℘(z),
and
y
=
℘
(z)
(the
derivative
with
respect
to
z).
Then,
as
stated
in
[Katz],
Appendix
C,
§C5,
the
diﬀerentials
ω=
dx
y
def
and
η
=
ω;
η(λ)
=
x
dx
y
deﬁne
by
integration
def
ω(λ)
=
def
λ
η
λ
(for
λ
∈
Λ)
a
basis
of
F
=
HomZ
(Λ,
C)
=
ΛC
(where
we
use
the
fact
that
the
cup
pairing
on
cohomology
deﬁnes
a
natural
isomorphism
of
Λ
with
its
dual).
Thus,
in
particular,
we
can
write
H∼
=
(C
·
ω)
⊕
(C
·
η)
Moreover,
although
ω
and
η
depend
on
the
choice
of
isomorphism
ωE
∼
=
C,
this
decomposition
does
not.
Thus,
we
get
a
natural
splitting
κη
:
τE
→
H
66
of
the
exact
sequence
0
→
ωE
→
H
→
τE
→
0
(cf.
the
discussion
preceding
Proposition
1.3).
Here,
we
shall
often
think
of
τE
and
H
as
the
universal
covering
spaces
of
E
and
E
†
,
respectively.
Deﬁnition
3.4.
We
shall
refer
to
κη
as
the
η-splitting
of
H
→
τE
.
Remark.
The
relationship
of
this
splitting
with
the
theory
of
this
paper
is
as
follows:
In
[Katz],
Appendix
C,
§C2,
a
certain
natural
algebraic
rational
section
of
the
universal
extension
is
constructed.
This
section
will
be
discussed
from
the
point
of
view
of
the
present
paper
in
§4
below.
It
is
then
shown
in
[Katz],
Appendix
C,
§C6,
that
the
Weierstrass
ζfunction
may
be
thought
of
as
the
diﬀerence
between
this
algebraic
rational
section
and
the
splitting
of
Deﬁnition
3.4.
On
the
other
hand,
in
the
present
paper,
we
will
consider
(cf.
§5
below)
the
diﬀerence
between
this
algebraic
rational
section
and
the
splitting
of
Theorem
2.1.
This
diﬀerence
will
play
an
important
role
in
the
theory
of
the
present
Chapter.
Moreover,
we
would
like
to
think
of
this
diﬀerence
–
which
we
will
refer
to
as
the
Schottky-Weierstrass
ζ-function
–
as
being
analogous
to
the
classical
Weierstrass
ζfunction.
In
fact,
we
shall
see
below
in
§5
that
many
of
the
important
properties
of
the
Schottky-Weierstrass
ζ-function
are
proven
by
arguments
exactly
analogous
to
those
used
to
prove
the
basic
properties
of
the
classical
Weierstrass
ζ-function.
The
reason
for
the
inclusion
of
the
word
“Schottky”
here
is
that
this
“Schottky-Weierstrass
ζ-function”
is
a
sort
of
Weierstrass
ζ-function
with
respect
to
the
Schottky
uniformization
Gm
→
E
of
E
(cf.
the
discussion
surrounding
Deﬁnition
3.3
above).
§4.
Hodge-Theoretic
Interpretation
of
the
Universal
Extension
In
this
§,
we
show
how
to
interpret
the
universal
extension
as
the
Hodge-theoretic
ﬁrst
Chern
class
of
a
certain
divisor.
The
material
of
this
§
follows
immediately
from
(the
obvious
logarithmic
generalization
of)
[Falt],
Lemma
IV.4,
but,
for
the
convenience
of
the
reader,
we
give
a
self-contained
treatment
here.
In
particular,
the
theory
of
the
present
§
will
allow
us
to
give
a
functorial
deﬁnition
of
the
splitting
of
[Katz],
Lemma
C2.1,
which
will
play
an
important
role
in
§5
below.
In
[Katz],
by
contrast,
only
an
explicit
deﬁnition
of
this
splitting
in
terms
of
certain
“special
functions”
was
given,
without
any
explanation
of
its
functorial
deﬁnition.
In
fact,
for
proving
the
results
of
§5
below,
it
will
be
important
to
know
the
deﬁnition
of
this
splitting
in
terms
of
special
functions,
but
nonetheless
it
is
interesting
to
know
that
this
splitting
can
be
deﬁned
by
means
of
abstract
nonsense.
Let
C
log
→
S
log
be
a
log
elliptic
curve.
Let
π1
,
π2
:
C
×S
E
→
E
be
the
projections
to
the
ﬁrst
and
second
factors,
and
denote
by
E
=
ΔE
⊆
E
×S
E
⊆
C
×S
E
the
diagonal
section.
(Thus,
ΔE
is
a
(closed)
divisor
in
C
×S
E.)
Let
67
Z
→
C
×S
E
be
the
torsor
of
relative
logarithmic
diﬀerentials
(i.e.,
diﬀerentials
with
respect
to
the
logarithmic
morphism
π2log
:
C
log
×S
log
E
log
→
E
log
)
that
are
regular
everywhere,
except
at
the
divisor
ΔE
,
where
they
have
a
simple
pole
with
residue
1.
Thus,
Z
is
an
ωE
|C×S
E
torsor
(where
we
think
of
the
diﬀerentials
“ωE
”
as
arising
from
the
ﬁrst
factor
of
C
×S
E)
on
C
×S
E.
Another
way
to
think
of
Z
is
that
it
is
the
torsor
deﬁned
by
the
Hodge-theoretic
ﬁrst
Chern
class
in
R1
(π2
)∗
(C
×S
E,
ωE
|C×S
E
)
of
the
divisor
ΔE
.
Similarly,
let
Y
→
C
×S
E
be
the
torsor
of
relative
logarithmic
diﬀerentials
(i.e.,
diﬀerentials
with
respect
to
the
logarithmic
morphism
π2log
:
C
log
×S
log
E
log
→
E
log
)
that
are
regular
everywhere,
except
at
the
divisor
{e}
×
E
⊆
C
×S
E,
where
they
have
a
simple
pole
with
residue
1.
(Here,
“e”
denotes
the
origin
of
E.)
Thus,
Y
is
an
ωE
|C×S
E
-torsor
on
C
×S
E.
Another
way
to
think
of
Z
is
that
it
is
the
torsor
deﬁned
by
the
Hodge-theoretic
ﬁrst
Chern
class
in
R1
(π2
)∗
(C
×S
E,
ωE
|C×S
E
)
of
the
divisor
{e}
×
E
⊆
C
×S
E.
Note
that
in
fact,
Y
is
the
pull-back
to
C
×S
E
via
π1
of
the
torsor
Tor
→
C
which
is
the
Hodge-theoretic
ﬁrst
Chern
class
of
the
divisor
{e}
in
C.
Let
us
denote
by
ZΔ
→
E;
YΔ
→
E
the
restrictions
of
the
torsors
Z
and
Y
to
ΔE
⊆
C
×S
E.
Thus,
ZΔ
and
YΔ
are
ωE
|E
torsors
on
E.
Since
the
composite
of
E
=
ΔE
→
C
×S
E
with
π1
is
the
natural
inclusion
E
→
C,
it
follows
that
YΔ
=
Tor
|E
68
i.e.,
the
torsor
associated
to
the
Hodge-theoretic
ﬁrst
Chern
class
of
the
divisor
{e}
in
C.
On
the
other
hand,
we
propose
to
show
in
the
following
that
when
2
is
invertible
on
S,
the
torsor
ZΔ
is
trivial,
and,
moreover
that
one
can
construct
an
explicit
trivialization
of
ZΔ
:
Let
J
be
the
sheaf
of
ideals
on
C
×S
E
that
deﬁnes
ΔE
.
Then
we
have
an
exact
sequence
0
→
J
2
/J
3
→
J
/J
3
→
J
/J
2
→
0
We
will
regard
this
exact
sequence
as
an
exact
sequence
of
OE
-modules
via
the
action
of
OE
arising
from
the
second
factor
of
C
×S
E.
We
would
ﬁrst
like
to
show
that
this
exact
sequence
(of
OE
-modules)
admits
a
natural
splitting
when
2
is
invertible
on
S.
We
construct
this
splitting
as
follows:
First,
observe
that
the
isomorphism
C
×S
E
∼
=
C
×S
E
given
by
(α,
β)
→
(α−β,
β)
(where
α
is
a
point
of
C,
β
a
point
of
E,
and
we
use
the
fact
that
the
group
scheme
E
acts
on
C)
maps
ΔE
⊆
C
×S
E
isomorphically
onto
{e}
×E
⊆
C
×S
E.
Thus,
if
Ie
⊆
C
is
the
sheaf
of
ideals
deﬁning
{e}
⊆
C,
then
we
have
an
exact
sequence
of
sheaves
0
→
Ie2
/Ie3
→
Ie
/Ie3
→
Ie
/Ie2
→
0
of
OS
-modules
such
that
the
exact
sequence
of
the
preceding
paragraph
is
the
pull-back
via
π1
:
C
×S
E
→
C
of
this
exact
sequence.
Thus,
it
suﬃces
to
construct
a
splitting
of
this
exact
sequence.
To
do
this,
we
consider
the
automorphism
“−1”
on
E,
which
extends
to
an
automorphism
of
C.
This
automorphism
induces
an
automorphism
α
of
the
above
exact
sequence
(which
covers
the
automorphism
“−1”
of
C).
Moreover,
the
automorphism
α
is
of
order
2,
and
(as
one
sees
easily
by
identifying
Ie
/Ie2
with
the
cotangent
space
ωE
to
C
at
e)
induces
multiplication
by
−1
(respectively,
1)
on
Ie
/Ie2
(respectively,
Ie2
/Ie3
).
Thus,
the
endomorphism
12
·
(1
−
α)
of
the
above
exact
sequence
induces
a
splitting
of
the
above
exact
sequence,
as
desired.
Thus,
we
obtain
a
splitting
SJ
:
J
/J
2
→
J
/J
3
of
the
exact
sequence
0
→
J
2
/J
3
→
J
/J
3
→
J
/J
2
→
0
Now
let
s
be
a
local
section
of
J
/J
2
in
a
(Zariski)
neighborhood
of
ΔE
.
Then
SJ
(s)
lifts
(noncanonically)
to
a
local
section
t
of
J
with
a
zero
of
order
1
at
ΔE
.
Thus,
if
we
form
69
the
logarithmic
derivative
dt
t
of
t
(where
we
diﬀerentiate
with
respect
to
the
ﬁrst
factor
of
C
×S
E),
we
get
a
diﬀerential
which
is
regular
in
a
neighborhood
of
ΔE
,
except
that
it
has
a
simple
pole
at
ΔE
with
a
residue
of
order
1.
Thus,
dt
t
deﬁnes
a
section
of
Z
over
this
neighborhood.
Moreover,
one
checks
immediately
that
the
restriction
of
this
section
to
ΔE
is
independent
of
the
choice
of
s
and
t.
Thus,
we
get
a
section
SΔ
:
E
→
ZΔ
of
ZΔ
which
is
globally
deﬁned
over
E.
That
is
to
say,
we
have
proven
the
following:
Proposition
4.1.
If
2
is
invertible
on
S,
then
the
torsor
ZΔ
→
E
admits
a
canonical
section
SΔ
:
E
→
ZΔ
(as
deﬁned
above).
Next,
let
us
observe
that
it
follows
from
the
deﬁnition
of
the
universal
extension
E
†
in
§1
that
the
torsor
Z
−Y
formed
by
taking
the
diﬀerence
of
the
torsors
Y
and
Z
on
C
×S
E
is
trivial
on
the
ﬁbers
of
π2
:
C
×S
E
→
E,
and,
moreover,
that
the
torsor
Z
−
Y
may
thus
be
“pushed
forward”
via
π2
to
form
an
ωE
-torsor
on
E
which
is
(by
deﬁnition)
equal
to
E
†
→
E.
In
fact,
because
Z
−
Y
is
trivial
on
the
ﬁbers
of
π2
,
it
is
in
fact
equal
to
the
pull-back
by
π2
of
the
torsor
E
†
→
E.
In
particular,
since
the
composite
of
E
=
ΔE
→
C
×S
E
with
π2
is
the
identity,
it
follows
that
we
have
a
natural
equality
of
ωE
-torsors
on
E:
ZΔ
−
YΔ
=
(Z
−
Y
)|ΔE
=
E
†
Thus,
by
Proposition
4.1,
we
obtain
that:
Theorem
4.2.
torsors
on
E
If
2
is
invertible
on
S,
then
there
is
a
canonical
isomorphism
of
ωE
-
E†
∼
=
−Tor
|E
between
E
†
→
E
and
−1
times
the
torsor
associated
to
the
Hodge-theoretic
ﬁrst
Chern
class
of
the
origin
{e}
⊆
E.
Next,
we
would
like
to
observe
a
certain
consequence
of
Proposition
4.2:
70
Even
if
2
is
not
invertible
on
S,
the
ωE
|E
-torsor
E
†
→
E
extends
log
†
naturally
to
an
ωE
|C
-torsor
EC
→
C.
If
S
log
=
(M1,0
)Z
,
then
this
extension
is
unique.
Corollary
4.3.
Proof.
We
begin
with
the
case
where
2
is
invertible.
Then
Theorem
4.2
implies
that
E
†
→
E
is
isomorphic
−Tor
|E
,
which
is
just
the
restriction
to
E
⊆
C
of
the
torsor
−Tor
→
C.
This
proves
extendability.
log
Next,
we
prove
uniqueness
in
the
case
where
S
log
=
(M1,0
)Z
.
Write
DS
⊆
S
for
the
divisor
at
inﬁnity,
and
DC
⊆
C
for
the
complement
of
E
in
C
with
the
“reduced
induced”
scheme
structure.
Thus,
DC
maps
isomorphically
down
to
DS
,
and
DC
∼
=
DS
∼
=
Spec(Z).
Uniqueness
then
follows
from
the
fact
that
DC
has
codimension
2
in
C
(which
is
a
regular
algebraic
stack).
log
Thus,
it
remains
to
prove
extendability
in
the
case
where
S
log
=
(M1,0
)Z
.
Note
that
(relative
to
the
notation
introduced
in
the
preceding
paragraph)
there
is
a
natural
exact
sequence
of
“local
cohomology
groups”:
.
.
.
→
H1
(C,
ωE
|C
)
→
H1
(E,
ωE
|E
)
→
H2DC
(C,
ωE
|C
)
→
.
.
.
where
H2DC
denotes
“cohomology
with
supports
in
DC
.”
On
the
other
hand,
it
is
wellknown
that
since
the
subscheme
DC
⊆
C
is
a
local
complete
intersection
of
codimension
2,
the
cohomology
module
H2DC
is
ﬂat
over
Z.
(Indeed,
this
amounts
to
a
well-known
computation
involving
the
Koszul
complex
(cf.,
e.g.,
[Mats]):
If
t1
and
t2
are
local
parameters
on
S
at
DC
,
then
this
cohomology
is
a
direct
limit
of
Z-modules
of
the
form
Z[t1
,
t2
]/(tn1
,
tn2
),
as
n
→
∞.)
Thus,
it
follows
that
the
vanishing
of
the
obstruction
to
extending
E
†
to
C
may
be
checked
after
restriction
to
Spec(Z[
12
]).
This
completes
the
proof
of
the
corollary.

Remark.
The
reader
may
ﬁnd
it
strange
that
despite
the
fact
that
we
have
shown
the
†
torsors
EC
→
C
and
−Tor
→
C
to
be
isomorphic
after
one
inverts
2,
we
may
not
conclude
immediately
that
they
are
isomorphic
even
without
inverting
2.
The
reason
for
this
is
the
possibility
of
the
existence
of
2-torsion
in
H
1
(S,
ωE
).
In
fact,
we
shall
see
later
that
the
†
isomorphism
between
EC
→
C
and
−Tor
→
C
does,
in
fact,
fail
to
be
integral
at
the
prime
2
(cf.
the
Remark
following
Corollary
5.8).
Note
that
Corollary
4.3
thus
implies
that
the
vector
bundle
T
considered
in
the
discussion
preceding
Deﬁnition
2.3
extends
naturally
to
a
vector
bundle
TC
on
C
that
ﬁts
into
an
exact
sequence
0
→
OC
→
TC
→
τE
|C
→
0
extending
the
exact
sequence
of
loc.
cit.
71
Finally,
we
make
the
connection
with
the
splitting
of
[Katz],
Lemma
C2.1.
The
point
is
the
following:
The
torsor
−Tor
→
C
is
the
torsor
of
diﬀerentials
that
are
regular
everywhere
except
for
a
simple
pole
at
the
origin
of
residue
−1.
Thus,
over
def
U
=
C
−
{e}
this
torsor
is
just
the
torsor
of
global
regular
diﬀerentials.
In
particular,
over
U
,
it
admits
a
section
given
by
the
“zero
diﬀerential.”
Moreover,
in
a
neighborhood
of
e,
it
is
easy
to
see
that
the
zero
diﬀerential,
regarded
as
the
sort
of
diﬀerential
parametrized
by
−Tor
,
has
a
pole
of
order
1
at
e.
Thus,
we
get
a
section
Sor
:
U
→
−Tor
with
a
pole
of
order
1
at
the
origin.
Now
let
us
assume
that
6
is
invertible
on
S.
Then
one
obtains
two
sections
†
S1
,
S2
:
U
→
EC
of
the
universal
extension
over
U
:
the
ﬁrst
is
given
by
transporting
Sor
by
means
of
the
isomorphism
of
Theorem
4.2;
the
second
is
that
of
[Katz],
Lemma
C2.1.
To
review,
this
section
of
[Katz]
is
deﬁned
as
follows:
For
an
elliptic
curve
deﬁned
by
the
equation
y
2
=
4x3
−g2
x−g3
,
the
section
S2
is
deﬁned
by
associating
to
a
point
P
of
U
the
diﬀerential
y
+
y(P
)
dx
·
2{x
−
x(P
)}
y
(which
is
regular
everywhere
except
at
e
and
P
,
and
has
residues
−1
at
e
and
+1
at
P
).
In
fact,
strictly
speaking,
Katz
only
deﬁnes
this
section
for
smooth
C
→
S,
but
one
checks
easily
that
the
above
deﬁnition
deﬁnes
a
section
for
arbitrary
C.
Moreover,
both
sections
have
a
pole
of
order
1
at
e.
Indeed,
this
follows
immediately
from
the
deﬁnition
for
S1
;
for
S2
,
it
follows
from,
say,
[Katz],
Theorem
C6,
(2).
Thus,
their
diﬀerence
deﬁnes
a
section
δ
∈
Γ(C,
ωE
|C
(e))
We
would
like
to
show
that
δ
=
0.
To
do
this,
it
suﬃces
to
consider
the
universal
case:
log
i.e.,
S
log
=
M1,0
⊗Z
Z[
16
].
Then
it
follows
immediately
from
an
elementary
application
of
Riemann-Roch
on
the
ﬁbers
of
C
→
S
that
δ
in
fact
lies
in
Γ(C,
ωE
|C
)
=
Γ(S,
ωE
).
On
the
other
hand,
it
is
well-known
(cf.,
e.g.,
[KM],
p.
227)
that
Γ(S,
ωE
)
=
0.
Thus,
δ
=
0,
as
desired.
In
other
words,
we
have
proven
the
following
result:
†
Corollary
4.4.
Suppose
that
6
is
invertible
on
S.
Then
the
isomorphism
−Tor
∼
=
EC
maps
the
section
Sor
:
C
−
{e}
→
−Tor
deﬁned
above
to
the
section
of
[Katz],
Lemma
C2.1.
72
†
In
particular,
the
section
of
[Katz],
Lemma
C2.1,
deﬁnes
a
unique
section
C
−
{e}
→
EC
,
even
when
6
is
not
invertible.
§5.
Analytic
Continuation
of
the
Canonical
Splitting
The
purpose
of
this
§
is
to
show
that
the
canonical
splitting
κ
of
Theorem
2.1
may
be
“analytically
continued”
to
a
splitting
in
the
category
of
“entire
functions”
on
the
uniformization
of
a
degenerating
elliptic
curve
in
the
sense
of
[Mumf
]
(i.e.,
the
formal
algebraic
analogue
of
the
Schottky
uniformization).
Although
this
splitting
will
not
be
periodic,
it
will
satisfy
a
simple
rule
with
respect
to
the
period
of
the
degenerating
elliptic
curve
(i.e.,
shifting
by
a
period
aﬀects
the
splitting
by
adding
a
constant).
In
order
to
analyze
this
splitting,
we
will
also
use
the
splitting
Sor
of
Corollary
4.4.
The
diﬀerence
between
κ
and
Sor
will
be
a
sort
of
Weierstrass
ζ-function
with
respect
to
the
Schottky
uniformization.
Thus,
we
will
refer
to
it
as
a
Schottky-Weierstrass
ζ-function.
We
will
discuss
this
ζ-function
(as
well
as
its
“close
relatives”)
in
more
detail
in
§6,
7
below.
In
the
present
§,
we
show
how
to
translate
the
material
of
[Katz],
Appendix
C,
§C6,
C7
into
the
context
of
Mumford’s
construction.
Although,
strictly
speaking,
this
Schottky
version
of
the
theory
of
[Katz],
Appendix
C,
§C6,
C7,
is
not
logically
necessary
for
the
proofs
of
the
main
results
of
the
present
§
(or,
for
that
matter,
of
the
present
paper),
we
present
it
here
nevertheless
because
we
feel
it
to
be
both
interesting
and
generally
culturally
relevant
to
what
we
do
discuss
here.
Also,
we
remark
that
“in
principle,”
what
we
discuss
here
is
“well-known,”
but
I
do
not
know
an
adequate
reference
for
it.
We
begin
by
reviewing
the
set-up
in
[Mumf
],
especially
[Mumf],
§5.
To
do
this,
we
must
introduce
some
notation.
Let
K
be
a
ﬁnite
extension
of
Q,
and
let
OK
be
its
ring
of
integers.
In
this
§,
we
let
O
be
a
Zariski
localization
of
OK
,
i.e.,
a
ring
such
that
Spec(O)
is
an
open
subscheme
of
Spec(OK
).
Let
def
A
=
O[[q]];
def
S
=
Spec(A)
(where
q
is
an
indeterminate).
Moreover,
we
equip
S
with
the
log
structure
deﬁned
by
the
def
divisor
D
=
V
(q)
⊆
S.
Let
S
be
the
formal
scheme
obtained
by
regarding
O[[q]]
as
a
topological
ring
with
the
q-adic
topology.
Let
E→S
73
be
the
semi-abelian
scheme
obtain
by
forming
the
quotient
of
Gm
by
the
period
“q”
(as
in
[Mumf]
or
[FC],
Chapter
III).
Then
E
→
S
arises
in
a
natural
way
from
a
log
elliptic
curve
C
log
→
S
log
.
Let
us
write
def
def
LC
=
OC
(e);
LE
=
LC
|E
(where
e
is
the
divisor
deﬁned
by
the
identity
section).
Next,
we
would
like
to
consider
various
kinds
of
analytic
functions.
First,
recall
that
we
have
a
natural
identiﬁcation
ES
=
(Gm
)S
an
Let
us
write
Ran
E
for
the
coordinate
ring
of
ES
.
Thus,
one
can
think
of
RE
as:
−1
Ran
}}
E
=
A{{U,
U
i.e.,
Laurent
series
with
coeﬃcients
converging
to
zero
in
A.
Let
us
write
an
Ralg
E
⊆
RE
[θ];
(respectively,
RE
⊆
Ran
E
[θ])
where
θ
is
an
indeterminate,
for
the
A-subalgebra
of
Ran
E
[θ]
generated
(respectively,
generated
q-adically)
by
the
elements
{q
k
+k
·
U
2k+1
·
θ,
q
k
·
U
2k
·
θ,
q
k
−k
·
U
2k−1
·
θ}
2
2
2
where
k
ranges
over
all
elements
of
Z.
That
is
to
say,
Ralg
E
(along
with
its
q-adic
completion
RE
)
is
the
ring
“Rφ,Σ
”
used
by
Mumford
(cf.
[Mumf],
p.
306)
to
construct
E
as
a
quotient
alg
of
Gm
.
In
this
context,
it
is
natural
to
think
of
Ran
E
[θ],
RE
and
RE
as
graded
rings,
in
which
elements
of
Ran
E
have
degree
zero
and
θ
has
degree
one.
Next,
recall
from
the
theory
of
[Mumf]
that
there
is
a
natural
action
of
Z
on
C
∞
=
Proj(Ralg
E
)
def
and
C
∞
=
Proj(RE
)
def
S
deﬁned
by
letting
1
∈
Z
act
by:
U
→
q
·
U
;
θ
→
q
·
U
2
·
θ
In
the
following,
we
shall
denote
this
group
of
automorphisms
by
Zet
74
Thus,
we
shall
identify
the
elements
of
Zet
with
Z
and
write,
for
instance,
“1et
∈
Zet
,”
but
we
prefer
to
use
the
notation
Zet
for
the
group
of
automorphisms,
in
order
to
distinguish
it
from,
for
instance,
Z
regarded
as
a
subring
of
O.
Now
it
follows
from
the
theory
of
[Mumf]
that
in
our
notation
CS
is
formed
by
taking
the
quotient
of
C
∞
by
this
action
of
Zet
.
In
fact,
the
special
ﬁber
S
(C
∞
)spl
=
(C
∞
)spl
S
(i.e.,
ﬁber
over
V
(q)
⊆
S)
of
C
∞
is
an
inﬁnite
chain
of
P1
’s,
connected
to
each
other
at
“0”
and
“∞.”
Thus,
each
irreducible
component
of
(C
∞
)spl
is
a
copy
P1
,
labeled
by
an
element
of
Zet
.
The
action
of
Zet
on
the
irreducible
components
(thought
of
relative
to
this
labeling)
is
just
the
action
of
Zet
on
Zet
by
addition.
(See
[Mumf]
for
more
details.)
Another
way
to
think
of
C
∞
is
as
a
sort
of
Néron
model
for
Gm
over
S
relative
to
the
open
immersion
S
−
V
(q)
⊆
S.
Thus,
the
irreducible
components
of
the
special
ﬁber
correspond
naturally
to
the
q-adic
orders
of
elements
of
A[q
−1
].
Relative
to
the
point
of
view
of
[Mumf]
(cf.
especially
[Mumf],
p.
289),
the
ample
line
bundle
“O(1)”
on
C
∞
obtained
by
regarding
RE
as
a
graded
ring
(as
discussed
above)
may
S
be
identiﬁed
in
a
natural
fashion
with
the
pull-back
(relative
to
the
quotient
C
∞
→
CS
)
S
L⊗2
C∞
S
⊗2i
∞
to
C
∞
of
L⊗2
C
.
Thus,
the
elements
of
RE
of
degree
i
deﬁne
sections
of
LC
∞
over
C
.
S
S
S
⊗2i
∞
Conversely,
I
claim
that
all
sections
of
LC
∞
over
C
arise
in
this
way.
Indeed,
it
suﬃces
S
S
to
note
that:
∞
(1)
The
global
sections
of
L⊗2i
C
∞
over
the
irreducible
component
of
(C
)spl
S
marked
“0”
are
spanned
over
O
by
the
restrictions
to
this
irreducible
component
of
the
sections
U
−i
·
θ
i
,
U
−i+1
·
θ
i
,
.
.
.
,
θ
i
,
U
i−1
·
θ
i
,
U
i
·
θ
i
(2)
The
sections
U
−i+1
·
θ
i
,
U
−i+2
·
θ
i
,
.
.
.
,
θ
i
,
U
i−1
·
θ
i
,
U
i
·
θ
i
all
vanish
when
restricted
to
any
irreducible
component
of
(C
∞
)spl
that
lies
on
the
same
side
of
the
component
marked
0
as
the
point
U
=
0
of
75
the
components
marked
0.
(Indeed,
acting
on
any
of
these
sections
by
a
positive
integer
∈
Zet
sends
these
sections
to
zero
modulo
q.)
By
translating
these
two
observations
over
to
the
other
irreducible
components
of
C
∞
spl
,
∞
one
sees
easily
that
one
may
construct
arbitrary
sections
of
L⊗2i
(C
∞
)spl
over
(C
)spl
by
means
of
elements
in
RE
.
This
completes
the
proof
of
the
claim.
Thus,
in
summary,
Γ(C
∞
,
L⊗2i
C
∞
)
=
degree
i
portion
of
RE
S
S
Put
another
way,
θ
deﬁnes
a
trivialization
of
the
line
bundle
L⊗2
C
∞
over
ES
=
(Gm
)S
S
with
respect
to
which
global
sections
may
be
written
as
certain
Laurent
series
in
U
whose
coeﬃcients
(∈
A)
decay
fairly
rapidly.
In
particular,
suppose
that
σ
alg
∈
Γ(C,
LC
)
is
the
section
given
by
the
embedding
OC
→
OC
(e)
=
LC
.
Then,
by
restricting
σ
alg
to
C
∞
,
we
can
write
its
square
(σ
alg
)2
S
analytically
as
some
element
(σ
alg
)2
|C
∞
=
(σ
an
)2
·
θ
∈
RE
S
where
(σ
an
)2
∈
Ran
E
is
some
(topological)
A-linear
combination
of
the
elements
{q
k
+k
·
U
2k+1
,
q
k
·
U
2k
,
q
k
−k
·
U
2k−1
}{k∈Z}
2
2
2
The
advantage
of
working
with
(σ
an
)2
is
that
it
is
an
explicit
Laurent
series.
For
convenience,
in
the
following,
we
shall
often
write
just
σ
2
for
(σ
an
)2
.
In
terms
of
normalizations
of
σ
alg
(relative
to
multiplication
by
elements
of
A×
),
we
would
like
to
think
of
σ
alg
as
being
chosen
so
that
the
square
diﬀerential
at
the
origin
e
of
E
determined
by
σ
2
(which
has
a
zero
of
order
2
at
the
origin)
is
equal
to
(d
log(U
))2
.
Next,
let
Rmer
C∞
S
denote
the
ring
of
meromorphic
functions
on
C
∞
.
By
this,
we
mean
those
functions
which
S
can,
Zariski
locally
on
the
formal
scheme
C
∞
,
be
written
as
a
quotient
of
a
regular
function
S
(i.e.,
a
section
of
OC
∞
)
by
a
nonzero
regular
function.
Thus,
the
zeroes
and
poles
of
a
S
meromorphic
function
on
C
∞
have
ﬁnite
order.
Note,
further,
that
we
have
a
natural
S
injection
an
Rmer
C
∞
→
Q(RE
)
S
76
(where
“Q”
denotes
“the
quotient
ﬁeld
of”).
Indeed,
the
fact
that
this
morphism
is
an
injection
follows
by
considering
the
situation
at
the
nodes
of
C
∞
,
where
this
injectivity
S
essentially
amounts
to
the
fact
that
the
natural
map
O[[X,
Y
]]
→
(O[[X]](X
−1
))[[Y
]]
(where
X
and
Y
are
indeterminates)
from
power
series
over
O
in
X
and
Y
to
power
series
in
Y
with
coeﬃcients
in
O[[X]](X
−1
)
is
injective.
Observe
that
if
f
is
a
function
on
C
∞
which
can
be
written
as
a
quotient
of
a
(regular)
S
section
of
L⊗2N
over
C
∞
by
a
nonzero
(regular)
section
of
L⊗2N
over
C
∞
(for
some
N
),
S
S
then
f
∈
Rmer
C∞
S
For
instance,
since
both
θ
(=
0)
and
σ
2
·
θ
are
regular
sections
of
L2
over
C
∞
,
it
follows
S
that
σ
2
=
(σ
2
·
θ)
·
θ
−1
∈
Rmer
C∞
S
Finally,
if
φ
∈
Rmer
C
∞
,
let
us
write
S
def
φ
=
U
∂φ
∂U
mer
Note
that
since
φ
∈
Rmer
C
∞
,
we
also
have
φ
∈
RC
∞
.
S
S
Next,
we
would
like
to
make
use
of
the
Weierstrass
normal
form
of
the
elliptic
curve
E
(as
in
[Katz],
§C2).
That
is
to
say,
we
ﬁx
the
diﬀerential
d
log(U
)
=
dU
U
and
take
the
resulting
rational
functions
x
and
y
on
E
such
that
dx/y
=
d
log(U
)
(as
in
[Katz],
§C2).
Thus,
the
elliptic
curve
E
is
deﬁned
by
the
equation
y
2
=
4x3
−
g2
x
−
g3
where
the
zero
section
e
is
the
point
at
inﬁnity
(of
the
aﬃne
curve
deﬁne
by
this
equation).
In
order
to
do
this,
one
must
assume
that
6−1
∈
O.
Thus,
for
the
rest
of
this
§,
until
stated
otherwise,
we
shall
assume
that
6−1
∈
O.
(We
will
state
explicitly
(after
Proposition
4.5)
when
this
assumption
is
no
longer
in
force.)
77
Thus,
x
is
a
rational
function
on
C
with
the
following
properties:
(i)
x
has
a
pole
of
order
two
at
the
origin,
and
no
other
poles;
(ii)
x
is
even;
(iii)
the
section
of
τE⊗2
deﬁned
by
looking
at
the
“leading
term”
of
x
at
∂
2
)
.
the
origin
is
equal
to
(U
∂U
∂x
Moreover,
y
is
the
rational
function
on
C
given
by
U
∂U
.
(Note
that
since
the
derivation
∂
U
∂U
is
algebraic,
this
statement
makes
sense
in
the
algebraic
category
despite
the
fact
that
“U
”
is
only
deﬁned
analytically.)
Then,
by
analogy
with
the
classical
complex
theory
(see,
e.g.,
[Ahlf],
p.
272),
we
write
℘
and
℘
for
the
analytic
representations
(i.e.,
elements
of
Rmer
C
∞
)
of
x
and
y,
respectively.
Also,
we
S
write
def
ζ
=
(σ
2
)
/(2
·
σ
2
)
∈
Rmer
C∞
S
for
the
analogue
of
the
classical
Weierstrass
ζ-function.
Note
that
since
σ
2
is
even,
while
∂
is
odd,
it
follows
that
ζ
is
an
odd
function.
Also,
note
that
since
σ
2
has
a
zero
of
U
∂U
order
2
at
the
origin
e,
it
follows
that
ζ
·
d
log(U
)
has
a
simple
pole
at
the
origin
e
whose
residue
is
1.
In
fact,
modulo
q,
it
is
easy
to
compute
ζ
explicitly:
Indeed,
modulo
q,
σ
2
is
equal
to
a
unit
multiple
of
U
−
2
+
U
−1
(compare
zero
loci!),
so
we
obtain
that
(modulo
q)
ζ
·
d
log(U
)
≡
1
1
dU
·
d
log(U
−
2
+
U
−1
)
=
−
d
log(U
)
=
2
U
−1
2
U
1
−
U
−1
2
·
d
log(U
)
In
particular,
we
see
that
the
meromorphic
function
ζ
is
regular
(i.e.,
does
not
have
a
pole)
at
the
nodes
U
=
0,
∞
of
the
component
of
(C
∞
)spl
marked
0.
S
Note
that
the
action
of
Zet
on
ζ
may
be
determined
as
follows:
1et
∈
Zet
acts
on
θ
by:
θ
→
q
·
U
2
·
θ
Since
σ
2
·
θ
is
pulled
back
from
CS
,
it
thus
follows
that
1et
∈
Zet
ﬁxes
σ
2
·
θ.
In
particular,
the
action
of
1et
∈
Zet
on
σ
2
is
given
by:
78
σ
2
→
q
−1
·
U
−2
·
σ
2
This
allows
us
to
conclude
that
the
action
of
1et
∈
Zet
on
12
times
the
logarithmic
derivative
of
σ
2
,
i.e.,
on
ζ,
is
given
by:
ζ
→
ζ
−
1
Observe
that
this
shows,
in
particular,
that
ζ
is
regular
except
at
the
orbit
e
=
Zet
(e)
⊆
C
∞
def
S
of
e
under
the
action
of
Zet
,
where
it
is
has
a
pole
of
order
one.
Next,
we
would
like
to
check
that
certain
classical
formulas
concerning
the
various
functions
just
deﬁned
hold
in
the
present
context,
as
well.
First
of
all,
let
us
observe
that
the
general
nonsense
concerning
meromorphic
functions
on
C
∞
can
be
extended
to
the
S
product
C
∞
×S
C
∞
,
as
well.
We
leave
the
formulation
of
this
general
nonsense
to
the
S
S
reader.
Now
let
us
write
μ,
π1
,
π2
:
ES
×S
ES
→
ES
for
the
obvious
multiplication
and
projection
maps,
respectively.
Write
ν
:
ES
×S
ES
→
ES
for
the
map
given
by
(α,
β)
→
α
−
β.
Then
we
have
the
following
analogue
of
a
well-known
classical
formula:
Proposition
5.1.
One
has
an
equality
(−π1∗
℘
+
π2∗
℘)2
=
(μ∗
σ
2
)
·
(ν
∗
σ
2
)
(π1∗
σ
4
)
·
(π2∗
σ
4
)
of
meromorphic
functions
on
C
∞
×S
C
∞
.
S
S
Proof.
The
proof
is
entirely
similar
to
that
in
the
classical
case.
Namely,
one
uses
the
def
cubical
structure
on
L
=
LC
|E
to
ﬁrst
deduce
the
corresponding
(natural)
isomorphism
S
of
line
bundles:
Indeed,
if
79
B
=
(μ∗
L)
⊗
(π1∗
L)−1
⊗
(π2∗
L)−1
def
is
the
corresponding
Gm
-biextension
on
the
E
×S
E
(cf.
[MB]
for
more
on
cubical
structures),
then
one
has
a
natural
isomorphism

∗
OE×S
E
∼
=
B
⊗
idE
×
(−idE
)
B
=
(μ∗
L)
⊗
(ν
∗
L)
⊗
(π1∗
L)⊗−2
⊗
(π2∗
L)⊗−2
Taking
the
“square”
of
this
isomorphism
shows
that
both
sides
of
the
desired
equality
can
be
naturally
(i.e.,
algebraically
without
enlisting
the
aid
of
the
trivialization
θ)
regarded
as
rational
functions
on
E
×S
E.
Note
that
here,
we
use
the
fact
that
the
trivialization
θ
is
compatible
with
the
cubical
structure
on
L
(which
follows
from
the
theory
of
[Mumf];
[FC],
Chapter
III).
Next,
observe
that
since
℘
is
an
even
function,
the
left-hand
side
has
zeroes
of
order
2
at
μ−1
(e)
and
ν
−1
(e).
Moreover,
the
left-hand
side
has
poles
only
at
π1−1
(e)
and
π2−1
(e),
and
these
poles
are
both
of
order
4.
Since
this
enumeration
exhausts
all
the
poles
and
zeroes
of
the
right-hand
side,
we
thus
conclude
that
the
desired
equality
holds
up
to
muliplication
by
a
unit
of
A.
In
fact,
for
our
purposes,
this
will
be
suﬃcient,
but
one
can
check
that
this
unit
must
be
=
1
be
looking
at
the
leading
term
at
the
origin.

Proposition
5.2.
One
has
an
equality
1
π1∗
℘
−
π2∗
℘
=
(μ∗
ζ)
−
(π1∗
ζ)
−
(π2∗
ζ)
∗
∗
2
π1
℘
−
π2
℘
of
meromorphic
functions
on
C
∞
×S
C
∞
.
S
S
Proof.
The
proof
is
entirely
similar
to
that
in
the
classical
case:
Namely,
one
takes
the
logarithmic
derivative
of
both
sides
of
the
equality
of
Proposition
5.1
with
respect
to
the
∂
∂
)
+
π2∗
(U
∂U
),
and
then
divides
by
4.
Note
here
that
the
push-forward
derivation
π1∗
(U
∂U
∂
of
this
derivation
with
respect
to
μ
(respectively,
ν)
is
equal
to
2
·
(U
∂U
)
(respectively,
0).

Next,
we
would
like
to
prove
the
analogue
of
Theorem
C6
of
[Katz].
The
analogue
of
the
ﬁrst
part
of
this
theorem
(i.e.,
Theorem
C6,
(1))
consists
of
making
explicit
the
diﬀerentials
deﬁned
by
the
canonical
splitting
in
terms
of
the
special
function
ζ.
Recall
that
over
D,
we
already
did
this
(i.e.,
wrote
down
the
diﬀerential
“ωx
”
explicitly)
in
our
construction
of
κ
(cf.
the
discussion
preceding
Theorem
2.1).
Thus,
we
would
like
to
extend
this
discussion
to
the
situation
over
S.
To
do
this,
let
α
∈
Gm
(S)
be
a
point
of
ES
.
Write
80
Tα
:
ES
→
ES
for
the
morphism
given
by
translating
by
α.
Then
let
us
consider
the
diﬀerential
(on
ES
)
deﬁned
by

def

ωα
=
Tα∗−1
(ζ)
−
ζ
·
d
log(U
)
Note
that
since
ζ
·
d
log(U
)
has
a
simple
pole
with
residue
1
at
e,
the
diﬀerential
ωα
has
a
simple
pole
with
residue
1
(respectively,
−1)
at
α
(respectively,
e).
Clearly,
the
correspondence
α
→
ωα
is
functorial
in
α.
Moreover,
we
have
the
following
Lemma
5.3.
The
diﬀerential
ωα
is
algebraic
in
the
sense
that
it
arises
from
a
meromorphic
diﬀerential
on
C.
Moreover,
this
meromorphic
diﬀerential
on
C
has
no
poles
except
at
α
and
e.
Proof.
Indeed,
1et
∈
Zet
acts
on
both
ζ
and
its
translate
Tα∗−1
(ζ)
by
adding
−1.
Thus,
1et
∈
Zet
stabilizes
ωα
.
This
implies
that
ωα
descends
to
an
algebraic
meromorpic
diﬀerential
on
C.
The
description
of
the
poles
of
ωα
follows
from
the
description
of
the
poles
of
ζ
given
in
the
above
discussion.

Next,
let
us
observe
that
(for
α,
β
∈
Gm
(S)
=
ES
(S))
the
meromorphic
function
(Tα∗−1
σ
2
)
·
(Tβ∗−1
σ
2
)
(Tα∗−1
·β
−1
σ
2
)
·
σ
2
on
C
∞
is
“algebraic,”
i.e.,
arises
from
a
meromorphic
function
on
E.
This
follows
immeS
diately
(cf.
the
use
of
cubical
structures
in
the
proof
of
Proposition
5.1)
from
the
fact
that
the
corresponding
line
bundle
(Tα∗−1
L)
⊗
(Tβ∗−1
L)
⊗
(Tα∗−1
·β
−1
L)−1
⊗
L−1
(and
hence
also
its
square)
is
trivial.
On
the
other
hand,
if
we
then
take
the
logarithmic
∂
)
and
multiply
by
derivative
of
this
rational
function
(with
respect
to
the
derivation
U
∂U
1
2
·
d
log(U
),
we
obtain
ωα
+
ωβ
−
ωα·β
This
implies
(cf.
the
discussion
preceding
Theorem
2.1)
that
the
correspondence
α
→
ωα
†
deﬁnes
a
homomorphism
of
ES
into
E
.
By
the
uniqueness
statement
in
Theorem
2.1,
we
S
thus
conclude
the
following
Schottky
analogue
of
[Katz],
Theorem
C6,
(1):
81
†
Theorem
5.4.
The
splitting
κ
:
ES
→
E
of
Theorem
2.1
is
the
splitting
deﬁned
by
the
S
correspondence

def

α
→
ωα
=
Tα∗−1
(ζ)
−
ζ
·
d
log(U
)
for
α
∈
ES
(S).
Next,
we
would
like
to
move
on
to
proving
the
analogue
of
the
second
part
of
Theorem
C6
of
[Katz].
First,
let
us
recall
the
exact
sequence
0
→
OC
→
TC
→
τE
|C
→
0
considered
in
the
discussion
following
Corollary
4.3.
If
we
tensor
this
exact
sequence
with
ωE
⊗OS
L⊗2
C
,
we
obtain
an
exact
sequence
⊗2
0
→
ωE
⊗
L⊗2
C
→
T
→
LC
→
0
Now
let
us
recall
the
section
†
Sor
:
C
−
e
→
−Tor
∼
=
EC
of
Corollary
4.4.
Since
this
section
has
a
pole
of
order
precisely
1
(≤
2)
at
e,
it
follows
from
the
deﬁnition
of
TC
that
it
deﬁnes
a
lifting
ξ
alg
∈
Γ(C,
T
)
alg
in
terms
of
its
components
relative
of
the
section
(σ
alg
)2
∈
Γ(E,
L⊗2
E
).
Now
let
us
write
ξ
to
the
canonical
splitting
(cf.
Deﬁnition
2.3):
(ξ[0]
·
θ,
ξ[1]
·
θ)
∂
,
we
may
regard
ξ[0]
as
a
function,
(Here,
by
trivializing
ωE
by
means
of
the
section
U
∂U
rather
than
just
a
section
of
ωE
|E
.)
Thus,
by
deﬁnition,
S
ξ[1]
=
σ
2
We
would
like
to
compute
ξ[0].
In
fact,
one
has
the
following:
Proposition
5.5.
We
have
ξ[0]
=
12
(σ
2
)
.
82
Proof.
The
proof
of
the
equality
ξ[0]
=
12
(σ
2
)
is
entirely
formally
analogous
to
the
proof
of
the
second
part
of
[Katz],
Theorem
C6.
Namely,
it
is
a
formal
consequence
of
Proposition
5.2.
Indeed,
if
α
∈
ES
(S)
=
Gm
(S),
then
ξ[0]
is
the
unique
function
such
that
adding
(σ
−2
·
ξ[0])(α)
to
the
canonical
splitting
κ(α)
of
Theorem
2.1
gives
rise
to
the
splitting
Sor
(α)
over
α.
But
by
Corollary
4.4
(and
the
explicit
form
of
Sor
in
terms
of
x
and
y
reviewed
in
the
discussion
preceding
Corollary
4.4),
this
splitting
Sor
(α)
corresponds
to
the
meromorphic
diﬀerential
y
+
y(α)
·
d
log(U
)
2{x
−
x(α)}
while
by
Theorem
5.4,
the
meromorphic
diﬀerential
given
by
adding
(σ
−2
·
ξ[0])(α)
to
the
canonical
splitting
κ(α)
of
Theorem
2.1
is
precisely
ωα
+
(σ
−2
·
ξ[0])(α)
·
d
log(U
)
=
{ζ(α−1
·
U
)
−
ζ(U
)
+
σ(α)−2
(ξ[0])(α)}
·
d
log(U
)
Since
y
is
an
odd
function,
while
x
is
even,
it
thus
follows
from
Proposition
5.2
that
these
two
expressions
are
equal
precisely
when
σ
−2
·
ξ[0]
=
ζ,
i.e.,
ξ[0]
=
12
(σ
2
)
,
as
desired.

2

)
∞
Now
let
us
recall
that
ζ
=
(σ
2·σ2
deﬁnes
a
meromorphic
function
on
CS
with
a
pole
of
order
1
at
the
origin
e.
Next,
note
that
since
the
meromorphic
splitting
Sor
is
deﬁned
over
†
CS
,
its
pull-back
to
C
∞
is
a
meromorphic
splitting
of
EC
|C
∞
over
C
∞
which
is
regular
S
S
S
away
from
e.
On
the
other
hand,
it
follows
from
Proposition
5.5
that
the
canonical
splitting
κ
over
ES
is
equal
to
the
diﬀerence
between
Sor
|E
and
ζ
·
d
log(U
)|E
.
Thus,
it
follows
S
S
†
∞
that
the
canonical
splitting
κ
extends
to
a
meromorphic
splitting
of
EC
|C
.
S
†
Next,
let
us
observe
that
the
natural
action
of
Zet
on
C
∞
and
EC
|C
∞
ﬁxes
Sor
(since
S
S
Sor
is
obtained
by
pull-back
from
CS
).
The
action
of
Zet
on
the
meromorphic
extension
over
C
∞
of
κ
may
thus
be
determined
by
looking
at
the
action
of
Zet
on
the
diﬀerence
S
between
this
meromorphic
extension
and
Sor
|C
∞
,
i.e.,
the
action
of
Zet
on
ζ.
Moreover,
as
S
computed
above,
the
action
of
1et
∈
Zet
on
ζ
is
given
by:
ζ
→
ζ
−
1
Thus,
the
action
of
1et
∈
Zet
on
the
meromorphic
extension
of
κ
(which
is,
roughly
speaking,
just
“Sor
−
ζ”)
over
C
∞
is
given
by:
S
κ
→
κ
+
d
log(U
)
83
In
particular,
since
we
know
that
ζ
and
Sor
|C
∞
are
regular
everywhere
except
e,
while
κ
S
is
regular
at
e
∈
ES
(S)
⊆
C
∞
(S),
we
conclude
that
the
meromorphic
extension
of
κ
over
S
C
∞
is,
in
fact,
regular
over
all
of
C
∞
.
In
other
words,
we
have
proven
the
following:
S
S
Theorem
5.6.
The
canonical
section
κ
of
Theorem
2.1
extends
to
a
(regular)
section
of
†
EC
|C
∞
over
C
∞
.
By
abuse
of
notation,
we
also
denote
this
(unique)
extension
of
κ
by
κ.
S
S
The
action
of
1et
∈
Zet
on
C
∞
induces
the
following
action
on
κ:
S
κ
→
κ
+
d
log(U
)
The
diﬀerence
between
κ
and
the
pull-back
to
C
∞
of
the
section
Sor
of
Corollary
4.4
is
S
def
(σ
2
)
given
by
the
function
ζ
=
2·σ2
,
which
is
meromorphic
on
C
∞
,
and
regular
everywhere
on
S
C
∞
except
for
a
pole
of
order
1
on
e
(the
Zet
-orbit
of
the
origin
of
ES
).
The
action
of
S
†
1et
∈
Zet
on
ζ
is
given
by
ζ
→
ζ
−
1.
Finally,
the
section
κ
of
EC
|C
∞
may
also
be
thought
S
of
(relative
to
the
isomorphism
of
Theorem
4.2)
as
(−
12
times)
the
section
associated
to
the
unique
connection
on
L⊗2
C
∞
for
which
the
section
θ
is
horizontal.
S
Proof.
It
remains
to
prove
the
ﬁnal
assertion
concerning
the
connection.
Let
us
denote
this
connection
by
∇.
Then
∇(σ
·
θ)
=
2
·
ζ
·
(σ
·
θ)
·
d
log(U
)
Since
σ
·
θ
is
nonzero
everywhere
on
C
∞
except
e,
it
thus
follows
that
the
connection
∇
is
S
regular
everywhere
on
C
∞
,
except
possibly
at
e.
On
the
other
hand,
since
1et
(θ)
=
q
·U
2
·θ,
S
it
follows
that
1et
(∇)
=
∇
−
2;
hence
that
∇
(which
we
know
to
be
regular
at
e)
is
also
†
regular
over
all
of
e,
hence
over
all
of
C
∞
.
Thus,
∇
deﬁnes
a
regular
section
κ∇
of
EC
|C
∞
S
S
which
satisﬁes
1et
(κ∇
)
=
κ∇
+
1.
In
particular,
κ
−
κ∇
∈
Γ(C
∞
,
ωE
|C
∞
)
=
ωE
,
i.e.,
the
S
S
diﬀerence
κ
−
κ∇
is
constant.
Now
we
consider
the
automorphism
α
of
C
∞
induced
by
S
“multiplication
by
−1”
on
E.
Note
that
since
α(σ
·
θ)
=
σ
·
θ,
the
above
formula
for
∇(σ
·
θ)
shows
that
α(∇)
=
∇.
Thus,
(since
the
isomorphism
of
Theorem
4.2
is
compatible
with
the
automorphism
α)
we
obtain
that
the
diﬀerential
κ
−
κ∇
∈
ωE
=
A
·
d
log(U
)
is
ﬁxed
by
α.
On
the
other
hand,
since
α(d
log(U
))
=
−d
log(U
),
this
implies
that
κ
−
κ∇
=
0,
as
desired.

84
Corollary
5.7.
The
canonical
section
κ
induces
an
isomorphism:
†
EC
|C
∞
∼
=
WS
×S
C
∞
S
S
(where
WS
is
the
geometric
object
corresponding
to
the
line
bundle
ωE
|S
on
the
formal
†
†
scheme
S).
Moreover,
relative
to
this
isomorphism,
the
quotient
EC
|C
∞
→
EC
is
given
by
S
the
action
of
Zet
on
W
×S
C
∞
deﬁned
by
taking
the
product
of
the
usual
action
of
Zet
on
S
C
∞
with
the
action
of
Zet
on
W
given
by
letting
1
act
as
addition
by
d
log(U
).
S
Corollary
5.8.
†
The
components
(cf.
Deﬁnition
2.3)
of
any
section
∈
Γ(EC
,
L⊗2i
C
|
†)
EC
with
respect
to
the
canonical
splitting
κ
of
Theorem
2.1
form
elements
of
RE
of
degree
i.
Remark.
Note
that
the
assertions
of
Theorem
5.6
and
Corollaries
5.7,
5.8
may
be
checked
after
inverting
6,
so
in
fact,
these
results
are
all
valid
even
if
one
does
not
invert
6.
On
the
other
hand,
as
computed
above,
modulo
q,
we
have:
ζ≡
1
1
dU
·
d
log(U
−
2
+
U
−1
)
=
−
d
log(U
)
2
U
−1
2
i.e.,
ζ
itself
fails
to
be
integral
at
the
prime
2.
Since
the
sections
κ
(cf.
Theorem
2.1)
and
Sor
(cf.
the
discussion
preceding
Corollary
4.4)
are
integral
at
2,
and
ζ
is
precisely
the
diﬀerence
between
these
two
sections
relative
to
the
isomorphism
of
Theorem
4.2,
it
thus
†
follows
that
the
isomorphism
between
EC
→
C
and
−Tor
→
C
(cf.
Theorem
4.2)
is
not
integral
at
2.
Finally,
before
proceeding,
we
apply
the
theory
developed
thus
far
to
obtain
explicit
information
concerning
liftings
of
torsion
points
of
E
to
E
†
(cf.
Remark
1
following
Deﬁnition
3.2).
First,
observe
that
since
ES
is
essentially
obtained
by
dividing
Gm
by
the
action
of
Zet
obtained
by
multiplying
Gm
powers
of
the
period
q,
it
follows
that
the
inverse
images
of
the
torsion
points
of
ES
in
C
∞
are
the
points
the
form:
S
α
·
q
β
∈
Gm
(A[qβ
,
q
−1
])
=
C
∞
(A[qβ
])
=
C
∞
(A[qβ
])
S
where
“Gm
(∼
[q
−1
])
=
C
∞
(∼)”
follows
from
the
“Néron
model-like”
property
of
C
∞
,
referred
to
earlier;
α
is
a
root
of
unity
∈
A;
and
β
∈
Q.
On
the
other
hand,
by
Corollary
†
5.7,
E
is
essentially
obtained
by
dividing
the
abelian
object
by
W
×
Gm
by
the
action
S
of
Zet
obtained
by
adding/multiplying
multiples
of
the
element
(d
log(U
),
q).
We
thus
conclude
the
following:
85
Corollary
5.9.
Relative
to
the
isomorphism
†
EC
|C
∞
∼
=
WS
×S
C
∞
S
S
of
Corollary
5.7,
the
inverse
images
of
the
torsion
points
of
E
†
are
precisely
the
points
whose
coordinates
(on
the
right-hand
side
of
the
above
isomorphism)
are
given
by
(β
·
d
log(U
),
α
·
q
β
)
where
α
is
a
root
of
unity
∈
A×
;
and
β
∈
Q.
Thus,
in
particular,
torsion
points
of
order
N
will,
in
general,
have
coordinates
with
denominator
N
.
§6.
Higher
Schottky-Weierstrass
Zeta
Functions
In
this
§,
we
deﬁne
a
new
integral
structure
on
the
universal
extension
of
a
degenerating
elliptic
curve
at
ﬁnite
primes.
Using
this
new
integral
structure,
we
construct
“higher”
analogues
of
the
Schottky-Weierstrass
zeta
function
considered
in
§5.
These
higher
Schottky-Weierstrass
zeta
functions
(together
with
their
twisted
analogues,
to
be
discussed
in
Chapter
IV)
will
play
a
fundamental
role
in
this
paper.
We
work
with
the
notation
of
§5.
Thus,
let
O
be
a
Zariski
localization
of
OK
,
where
K
is
a
ﬁnite
extension
of
Q.
Let
def
A
=
O[[q]];
def
S
=
Spec(A)
Then
we
have
a
one-dimensional
semi-abelian
scheme
E→S
over
S.
Roughly
speaking,
one
may
think
of
E
as
being
“Gm
/q
Z
.”
More
rigorously,
E
may
be
compactiﬁed
to
a
log
elliptic
curve
C
log
→
S
log
.
Moreover,
CS
(the
result
of
base
changing
C
to
the
q-adic
completion
S
of
S)
may
be
written
as
CS
=
C
∞
/Zet
S
Next,
let
us
recall
the
contents
of
Theorem
5.6,
and
its
corollaries.
First
of
all,
the
universal
extension
E
†
→
E
of
E
extends
naturally
(cf.
Corollary
4.3)
to
a
WE
-torsor
86
†
EC
→
C.
(Here,
WE
→
S
is
the
geometric
line
bundle
deﬁned
by
the
invertible
sheaf
ωE
on
S,
i.e.,
it
is
the
object
denoted
“W
”
in
§2.)
Then
Theorem
5.6,
Corollary
5.9
state
that
we
have
a
natural
isomorphism
†
EC
|C
∞
∼
=
(WE
)S
×S
C
∞
S
S
†
†
relative
to
which
the
quotient
EC
|C
∞
→
EC
of
the
left-hand
side
corresponds
to
the
S
quotient
by
the
subgroup
generated
by
(d
log(U
),
q)
†
on
the
right-hand
side.
In
the
following,
we
shall
identify
EC
|C
∞
with
(WE
)S
×S
C
∞
via
S
S
this
isomorphism.
Moreover,
(to
simplify
the
notation)
we
shall
trivialize
ωE
by
means
of
the
section
d
log(U
).
Thus,
we
may
write
WE
=
Spec(OS
[T
])
(where
T
is
the
indeterminate
corresponding
to
the
chosen
trivialization
of
ωE
).
Next,
let
us
write
(for
n
∈
Z≥0
)
def
T
[n]
=
1
T
(T
−
1)(T
−
2)
·
.
.
.
·
(T
−
(n
−
1))
n!
def
which
we
think
of
as
a
section
of
OWE
⊗
Q.
For
negative
n,
we
let
T
[n]
=
0.
Thus,
we
have
T
[0]
=
1;
T
[1]
=
T
;
T
[2]
=
1
T
(T
−
1)
2
Also,
if
f
(T
)
is
a
section
of
OWE
⊗
Q,
let
us
write
f
(T
+
n)
for
the
result
of
applying
to
f
(T
)
the
automorphism
of
WE
induced
by
net
∈
Zet
,
i.e.,
the
automorphism
deﬁned
by
T
→
T
+
n.
Thus,
in
particular,
we
may
deﬁne:
def
δ(f
)
=
f
(T
+
1)
−
f
(T
)
Then
we
have
δ(T
[n]
)
=
T
[n−1]
Now
we
are
ready
to
deﬁne
new
integral
structures.
First
of
all,
let
us
write
87
R
†
EC
|C
∞
S
†
for
the
push-forward
via
EC
|C
∞
→
C
∞
of
the
structure
sheaf
O
†
S
S
EC
|C
∞
.
Then
we
would
S
like
to
deﬁne
a
new
integral
structure
on
R
†
EC
|C
∞
⊗
Q
as
follows:
By
the
above
discussion,
S
the
sheaf
of
algebras
R
†
EC
|C
∞
on
C
∞
may
be
identiﬁed
with
S
S
OC
∞
⊗OS
OS
[T
]
=
OC
∞
⊗OS
S

S
OS
·
T
n

n≥0
Then
the
new
integral
structure
will
be
given
by
the
sheaf
OC
∞
⊗OS

S
OS
·
T
[n]

n≥0
Let
us
denote
by
Ret†
EC
|C
∞
⊆R
†
EC
|C
∞
S
S
the
corresponding
subsheaf
of
R
†
EC
|C
∞
⊗Q
⊗
Q.
Note
that
Ret†
has
a
natural
ﬁltration
EC
|C
∞
S
S
.
.
.
⊆
F
n
(Ret†
EC
|C
∞
)
⊆
.
.
.
⊆
Ret†
EC
|C
∞
S
S
whose
n-th
member
is
given
by
the
polynomials
of
degree
<
n.
Thus,
F
n
(Ret†
)
is
a
EC
|C
∞
S
vector
bundle
on
C
∞
of
rank
n
such
that
we
have
a
natural
identiﬁcation
S
(F
n+1
/F
n
)(Ret†
)=
EC
|C
∞
1
·
OC
∞
⊗OS
τE⊗n
n!
S
S
Moreover,
let
us
observe
that
the
ﬁltered
OC
∞
-submodule
Ret†
S
EC
|C
∞
S
preserved
by
the
natural
action
of
Zet
on
C
∞
.
S
88
⊆
R
†
EC
|C
∞
⊗
Q
is
S
def
Indeed,
1et
∈
Zet
maps
f
(T
)
=
T
[n]
to
f
(T
+
1)
=
f
(T
)
+
δ(f
)
=
f
(T
)
+
T
[n−1]
.
Since
T
[n−1]
also
forms
a
section
of
Ret†
,
and
EC
|C
∞
S
Ret†
EC
|C
∞
is
an
OC
∞
-module
(hence
closed
under
addition),
we
thus
conclude
that
Ret†
EC
|C
∞
S
S
S
(as
well
as
its
ﬁltration)
is
stabilized
by
the
action
of
Zet
,
as
desired.
We
summarize
this
as
follows:
Proposition
6.1.
The
OC
∞
-submodules
S
.
.
.
⊆
F
n
(Ret†
EC
|C
∞
)
⊆
.
.
.
⊆
Ret†
EC
|C
∞
S
⊆R
†
EC
|C
∞
⊗Q
S
S
are
all
preserved
by
the
natural
action
of
Zet
.
Thus,
they
descend
to
form
natural
OC
submodules
.
.
.
⊆
F
n
(Ret†
)
⊆
.
.
.
⊆
Ret†
⊆
R
†
⊗
Q
EC
EC
EC
where
the
subsheaf
F
n
(Ret†
)
of
the
ﬁltration
is
a
rank
n
vector
bundle
on
C
such
that
EC
1
(F
n+1
/F
n
)(Ret†
)
=
n!
·
OC
⊗OS
τE⊗n
.
EC
Proof.
It
remains
only
to
check
that
the
various
sheaves
that
were
constructed
on
C
∞
do
S
indeed
descend
to
C.
That
is
to
say,
since
the
covering
C
∞
→
CS
is
inﬁnite,
the
reader
S
may
fear
that
one
cannot
immediately
apply
the
usual
machinery
of
étale
descent.
In
fact,
however,
this
is
not
a
problem
since
CS
admits
a
(ﬁnite)
Zariski
open
cover
{U
}
(in
the
category
of
formal
S-schemes)
such
that
over
each
U
,
the
covering
C
∞
→
CS
splits.
Thus,
S
there
is
no
problem
with
descent.

Deﬁnition
6.2.
The
integral
structures
denoted
by
a
superscript
“et”
will
be
referred
to
as
étale-integral,
or
et-integral,
structures.
That
is
to
say,
“et”
stands
for
“étale,”
and
is
the
same
as
the
“et”
in
Zet
.
In
particular,
the
“étale-integral
structure”
may
be
thought
of
as
the
integral
structure
arising
from
thinking
of
algebraic
functions
on
the
universal
extension
as
set-theoretic
functions
on
Zet
,
i.e.,
on
the
ﬁbers
of
the
inﬁnite
étale
covering
C
∞
→
C
∞
/Zet
=
CS
.
S
S
The
original
integral
structure
on
the
various
“R’s”
(i.e.,
the
integral
structures
without
a
label)
will
be
referred
to
as
the
de
Rham-integral,
or
DR-integral,
structures.
This
is
because
they
arise
from
the
original
natural
integral
structures
on
the
universal
extension
×
1
E
†
as
a
sort
of
de
Rham
cohomology
–
i.e.,
“HDR
(E,
OE
)”
–
associated
to
E.
89
Now
we
are
ready
to
begin
the
construction
of
the
higher
Schottky-Weierstrass
zeta
functions.
In
the
following,
we
shall
refer
to
polynomials
φr
T
[r]
+
φr−1
T
[r−1]
+
.
.
.
+
φ0
(where
r
is
a
natural
number)
whose
coeﬃcients
φ0
,
.
.
.
,
φr
are
meromorphic
functions
on
C
∞
as
extension
polynomials.
One
may
also
think
of
extension
polynomials
as
meromorS
phic
sections
of
Ret†
over
C
∞
.
We
would
like
to
consider
those
extension
polynomials
EC
S
which
are
invariant
under
the
natural
action
of
Zet
,
i.e.,
which
descend
to
CS
.
Note
that
since
all
OC
-torsors
on
CS
split
as
soon
as
one
allows
a
pole
of
order
1
at
the
origin
e,
it
S
follows
that
there
exist
Zet
-invariant
extension
polynomials
of
the
form:
T
[r]
+
φr−1
T
[r−1]
+
.
.
.
+
φ0
where
φ0
,
.
.
.
,
φr−1
are
meromorphic
on
C
∞
,
regular
away
from
e
(the
Zet
-orbit
of
the
S
origin),
and
have
a
pole
of
order
at
most
1
at
the
points
of
e.
For
instance,
the
most
basic
example
(in
the
case
where
2
∈
O
×
)
of
such
a
polynomial
is
the
polynomial
T
+ζ
(where
ζ
is
as
in
§5)
studied
in
§5.
Note
that
whereas
1et
∈
Zet
acts
on
T
by
T
→
T
+
1
it
acts
on
ζ
by
ζ
→
ζ
−
1.
Thus,
T
+
ζ
is
indeed
Zet
-invariant.
In
the
following,
we
would
like
to
study
the
case
of
arbitrary
r
≥
1.
First,
let
us
introduce
some
notation:
If
f
is
an
extension
polynomial,
then
let
us
denote
the
result
of
acting
on
f
by
1et
∈
Zet
by
means
of
the
notation
α(f
).
Let
def
δ(f
)
=
α(f
)
−
f
This
extends
the
deﬁnition
of
δ
given
in
the
discussion
preceding
Proposition
1.1
(i.e.,
the
case
of
extension
polynomials
with
constant
coeﬃcients).
Also,
if
f
and
g
are
extension
polynomials,
then
we
have
δ(f
·
g)
=
δ(f
)
·
α(g)
+
f
·
δ(g)
Thus,
to
say
that
90
f=
n

φn−i
·
T
[i]
i=0
is
Zet
-invariant
means
precisely
that
δ(f
)
=
n

δ(φn−i
)(T
[i]
+
T
[i−1]
)
+
φn−i
·
T
[i−1]
=
0
i=0
i.e.,
that
for
all
i,
δ(φn−i
)
+
δ(φn−i−1
)
+
φn−i−1
=
0
def
(where
we
let
φj
=
0
for
j
<
0,
j
>
n).
Thus,
we
obtain
the
following:
Lemma
6.3.
Let
n
be
a
nonnegative
integer.
Suppose
that
f=
n

φn−i
·
T
[i]
i=0
is
a
Zet
-invariant
extension
polynomial
such
that
φ0
=
1;
and
all
the
φj
’s
are
meromorphic
functions
on
C
∞
which
are
regular
away
from
e
(the
Zet
-orbit
of
the
origin),
and
have
a
S
pole
of
order
at
most
1
at
the
points
of
e.
Then
there
exists
a
Zet
-invariant
extension
polynomial
g=
n+1

ψn+1−i
·
T
[i]
i=0
such
that
φj
=
ψj
for
0
≤
j
≤
n;
and
ψn+1
is
a
meromorphic
function
on
C
∞
which
is
S
regular
away
from
e
(the
Zet
-orbit
of
the
origin),
and
has
a
pole
of
order
at
most
1
at
the
points
of
e.
Proof.
First
note
that,
since
for
0
≤
j
≤
n,
the
invariance
condition
discussed
above
(i.e.,
“δ(φn−i
)
+
δ(φn−i−1
)
+
φn−i−1
=
0”)
on
the
φj
’s
is
precisely
the
same
as
the
invariance
condition
on
the
ψj
’s,
it
thus
follows
that
?·T
[0]
+
n+1

φn+1−i
·
T
[i]
i=1
91
deﬁnes
a
Zet
-invariant
section
of
the
sheaf
of
extension
polynomials
modulo
constant
terms
on
C
∞
.
Moreover,
since
H
1
(CS
,
OC
(e))
=
0,
it
thus
follows
that
as
long
as
we
allow
a
S
S
pole
of
order
1
at
e,
this
section
lifts
to
a
Zet
-invariant
extension
polynomial
g=
n+1

ψn+1−i
·
T
[i]
i=0
(where
ψj
=
φj
for
j
=
0,
.
.
.
,
n,
and
ψn+1
has
the
desired
properties).
This
completes
the
proof.

Theorem
6.4.
Let
n
be
a
nonnegative
integer.
Then
there
exists
a
Zet
-invariant
extension
polynomial
f=
n

ζn−i
·
T
[i]
i=0
such
that
ζ0
=
1;
δ(ζn−i
)
+
δ(ζn−i−1
)
+
ζn−i−1
=
0
(for
all
i);
and
all
the
ζj
’s
are
meromorphic
functions
on
C
∞
which
are
regular
away
from
S
e
(the
Zet
-orbit
of
the
origin),
and
have
a
pole
of
order
at
most
1
at
the
points
of
e.
In
particular,
we
have
δ(ζj
)
=
−ζj−1
+
ζj−2
−
...
+
(−1)j−1
ζ1
+
(−1)j
ζ0
(for
all
j).
Finally,
if
ζ0
,
.
.
.
,
ζn
satisfy
the
same
conditions
as
ζ0
,
.
.
.
,
ζn
,
then
for
each
j
=
0,
.
.
.
,
n,
ζj
−
ζj
=
some
A−linear
combination
of
ζ0
,
.
.
.
,
ζj−1
(where
A
=
O[[q]]).
Proof.
The
existence
of
ζ0
,
.
.
.
,
ζn
as
stated
follows
by
successively
applying
Lemma
6.3,
starting
with
the
extension
polynomial
1
(in
the
case
r
=
0).
The
second
formula
for
δ(ζj
)
follows
by
induction
on
j
from
the
ﬁrst
formula
δ(ζn−i
)
+
δ(ζn−i−1
)
+
ζn−i−1
=
0.
Thus,
it
remains
to
see
what
happens
if
ζ0
,
.
.
.
,
ζn
satisfy
the
same
conditions
as
ζ0
,
.
.
.
,
ζn
.
We
prove
that
ζj
−
ζj
is
an
A-linear
combination
of
ζ0
,
.
.
.
,
ζj−1
by
induction
92
on
j.
This
is
clear
for
j
=
0
since,
by
assumption,
ζ0
=
ζ0
=
1.
Now
observe
that,
by
the
induction
hypothesis,
both
δ(ζj
)
=
−ζj−1
+
ζj−2
−
...
+
(−1)j−1
ζ1
+
(−1)j
ζ0
and
δ(ζj
)
=
−ζj−1
+
ζj−2
−
...
+
(−1)j−1
ζ1
+
(−1)j
ζ0
are
of
the
form
“−ζj−1
plus
an
A-linear
combination
of
ζ0
,
.
.
.
,
ζj−2
.”
Thus,
by
repeated
application
of
the
formula
δ(ζl
)
=
−ζl−1
+
ζl−2
−
...
+
(−1)l−1
ζ1
+
(−1)l
ζ0
for
l
≤
j
−
1,
it
follows
that
there
exists
some
γ
=
ζj
+
η
where
η
is
an
A-linear
combination
of
ζ0
,
.
.
.
,
ζj−1
,
and,
moreover,
δ(γ)
=
δ(ζj
)
def
In
particular,
it
follows
that
=
γ
−
ζj
is
a
meromorphic
function
on
C
∞
which
is
regular
S
away
from
e,
has
a
pole
of
order
≤
1
at
the
points
of
e,
and,
moreover,
satisﬁes
δ(
)
=
0,
i.e.,
is
Zet
-invariant.
But
this
implies
that
arises
from
a
meromorphic
function
on
CS
which
is
regular
away
from
the
origin,
where
it
has
a
pole
of
order
≤
1.
In
other
words,
this
meromorphic
function
on
CS
forms
a
regular
section
of
OC
(e)
over
CS
.
But
it
follows
S
from
Riemann-Roch
that
such
a
function
must
be
constant,
i.e.,
∈
A.
Thus,
=
γ
−
ζj
∈
A.
This
completes
the
proof.

Remark
1.
Note
that
the
ζj
’s
of
Theorem
6.4
are
not
uniquely
deﬁned
(except
for
j
=
0).
Nevertheless,
we
shall
often
refer
to
these
ζj
’s,
which
are
useful
for
explicit
computations,
as
higher
Schottky-Weierstrass
ζ-functions.
Also,
we
observe
that
if
2
∈
O
×
,
then
the
function
ζ
of
§5
serves
as
a
“ζ1
”
in
Theorem
6.4.
Remark
2.
By
using
the
Gm
-splitting
discussed
in
§3,
one
may
also
construct
complex
analytic
Schottky-Weierstrass
ζ-functions,
as
follows.
Namely,
just
as
in
§5,
we
may
form
the
complex
analytic
Schottky-Weierstrass
ζ-function
ζ
93
by
taking
the
diﬀerence
between
the
Gm
-splitting
of
§3
and
the
meromorphic
splitting
Sor
of
Corollary
4.4.
This
function
is
meromorphic
on
Gm
(in
the
usual
sense
of
complex
analysis),
regular
away
from
q
Z
⊆
Gm
,
and
satisﬁes
(relative
to
the
notation
in
the
discussion
of
the
Gm
-splitting
in
§3)
the
relation
ζ(q
·
U
)
=
ζ(U
)
−
1
(where
U
is
the
standard
multiplicative
coordinate
on
Gm
).
Indeed,
to
check
that
this
relation
is
satisﬁed,
it
suﬃces
(since
all
the
functions
involved
depend
meromorphically
on
q
and
U
)
to
check
it
as
q
→
0.
But
this
case
is
precisely
the
case
where
one
is
working
near
the
point
at
inﬁnity
of
M1,0
(C),
i.e.,
the
case
discussed
in
§5.
Thus,
by
regarding
the
various
algebraic
and
formal
algebraic
functions
of
§5
as
complex
analytic
functions,
we
see
that
this
relation
follows
from
the
corresponding
formal
algebraic
relation
proven
in
Theorem
5.6.
Finally,
by
performing
exactly
the
same
formal
operations
that
we
have
done
in
the
present
§,
but
this
time
in
the
complex
analytic
category,
we
also
obtain
complex
analytic
higher
Schottky-Weierstrass
ζ-functions
ζ0
,
.
.
.
,
ζn
as
in
Theorem
6.4.
§7.
Canonical
Schottky-Weierstrass
Zeta
Functions
In
this
§,
we
continue
the
discussion
of
higher
Schottky-Weierstrass
zeta
functions
begun
in
§6.
The
purpose
of
the
present
§
is
to
construct
two
collections
of
canonical
higher
Schottky-Weierstrass
zeta
functions
by
means
of
various
diﬀerential
operators
acting
on
the
line
bundle
under
consideration.
The
ﬁrst
type
of
canonical
zeta
function,
which
we
refer
to
as
divided
power
canonical
zeta
functions,
is
the
most
basic
type
of
canonical
zeta
function.
These
divided
power
canonical
zeta
functions
do
not
satisfy
quite
the
same
relations
(concerning
the
operator
δ)
as
the
functions
of
Theorem
6.4
(although
they
do
satisfy
certain
relations
similar
to
the
relations
in
Theorem
6.4),
and,
moreover,
are
not
integral,
i.e.,
are
only
deﬁned
over
Q.
The
second
type
of
canonical
zeta
function,
which
we
refer
to
as
binomial,
is
of
the
sort
considered
in
Theorem
6.4,
and,
moreover,
is
integral
except
at
the
prime
2.
Both
the
divided
power
and
binomial
canonical
zeta
functions
of
the
present
§
(as
well
as
various
other
types,
to
be
introduced
later)
play
an
important
role
in
the
theory
of
this
paper
(cf.,
especially,
Chapter
V,
§4;
Chapter
VII;
Chapter
VIII).
We
maintain
the
notation
of
§6,
except
that
in
this
§,
we
assume,
until
mentioned
otherwise,
that
O
is
a
number
ﬁeld.
In
particular,
O
⊇
Q.
As
usual,
we
will
write
LC
∞
=
OC
∞
(e)
S
S
94
def
where
e
=
Zet
(e)
⊆
C
∞
.
Note
that
Zet
acts
on
the
global
sections
of
LC
∞
over
C
∞
.
S
S
S
Thus,
in
particular,
the
operator
δ
of
§6
deﬁned
by
def
δ(f
)
=
1et
(f
)
−
f
acts
on
Γ(C
∞
,
LC
∞
).
Just
as
in
§6,
we
would
like
to
study
sections
of
LC
∞
over
C
∞
which
S
S
S
S
satisfy
certain
properties
with
respect
to
the
operator
δ.
Next,
let
us
observe
that
we
also
have
another
operator
on
sections
of
LC
∞
given
by
S
the
connection
∇
on
LC
∞
deﬁned
by
the
canonical
section
−κ
(cf.
Theorem
5.6).
That
S
is
to
say,
by
Theorem
5.6,
−2
·
κ
determines
a
connection
on
L⊗2
C
∞
,
so
−κ
determines
a
S
connection
on
LC
∞
which
is
deﬁned
whenever
2
∈
O
×
(as
is
the
case
here).
Let
us
denote
S
∂
the
operator
on
sections
of
LC
∞
given
by
applying
the
connection
∇
in
the
direction
U
∂U
S
by
f
→
δ
∗
(f
)
=
∇(U
∂
)
(f
)
def
∂U
Note
that
since
(cf.
Theorem
5.6),
1et
(κ)
=
κ
+
d
log(U
),
we
obtain
that
1et
(∇)
=
∇
−
d
log(U
).
Thus,
1et
(δ
∗
)
=
δ
∗
−
1
(i.e.,
1et
(δ
∗
(f
))
=
δ
∗
(1et
(f
))
−
1et
(f
)),
so
we
obtain:
[δ
∗
,
δ](f
)
=
[δ
∗
,
1et
](f
)
=
δ
∗
(1et
(f
))
−
1et
(δ
∗
(f
))
=
1et
(f
)
i.e.,
[δ
∗
,
δ]
=
1et
.
Roughly
speaking,
It
is
natural
to
think
of
δ
∗
as
“diﬀerentiation
∂
with
respect
to
the
holomorphic
variable”
and
δ
as
“diﬀerentiation
∂
with
respect
to
the
antiholomorphic
variable.”
Alternatively,
one
may
think
of
the
operator
δ
∗
as
a
sort
of
adjoint
to
the
operator
δ.
This
point
of
view
is
motivated
by
the
complex
analytic
theory,
which
we
will
discuss
in
more
detail
in
Chapter
VII,
§4.
Next,
let
us
observe
that
if
we
let
ζ0PD
∈
Γ(C
∞
,
LC
∞
)
be
the
section
deﬁned
by
“1
∈
O
S
C∞
(e),”
then
it
follows
from
Theorem
5.6
that
S
S
δ
∗
(ζ0PD
)
=
ζ1
(where
ζ1
is
as
in
§5).
Thus,
it
is
natural
to
set
(for
any
integer
n
≥
0)
95
def
ζnPD
=
1
∗
n
PD
(δ
)
ζ0
n!
Here,
“PD”
stands
for
“puissances
divisés”
(i.e.,
“divided
powers”
in
French).
Just
as
was
the
case
with
the
higher
Schottky-Weierstrass
zeta
functions
of
Theorem
6.4,
the
canonical
Schottky-Weierstrass
zeta
functions
ﬁt
together
to
form
“Zet
-invariant
extension
polynomials”
as
follows:
First,
observe
that
in
the
above
discussion,
we
worked
with
various
functions/sections
of
line
bundles
over
C
∞
.
In
order
to
obtain
Zet
-invariant
S
†
extension
polynomials,
we
must
instead
work
with
objects
over
EC
|C
∞
.
Recall
that
by
S
†
Corollary
5.7,
EC
|C
∞
→
C
∞
admits
a
natural
splitting
which
allows
us
to
regard
the
S
S
push-forward
of
O
†
to
C
∞
as
the
OC
∞
-algebra
S
E
|
∞
S
C
C
S
OC
∞
[T
]
S
(cf.
the
discussion
at
the
beginning
of
§6).
Note
that
by
Theorem
4.2
(which
we
are
at
liberty
to
apply
since
here,
we
are
working
in
characteristic
zero),
the
pull-back
to
†
EC
|C
∞
of
the
line
bundle
LC
admits
a
tautological
connection
∇taut
.
Here,
just
as
in
the
S
above
discussion
involving
∇,
we
use
the
notation
“(δ
taut
)∗
”
for
the
tautological
connection
∂
∇taut
applied
in
the
direction
U
∂U
.
Since
the
natural
isomorphism
of
Corollary
5.7
is
an
isomorphism
of
WS
-torsors,
it
follows
easily
from
the
deﬁnitions
that,
relative
to
the
connection
∇
considered
above
(arising
from
−κ),
we
have:
(δ
taut
)∗
=
δ
∗
+
T
†
Note
that
unlike
δ
∗
,
the
operator
(δ
taut
)∗
descends
(since
it
is
“tautological”)
to
EC
,
hence
is
Zet
-invariant.
Now
we
have
the
following
result:
Lemma
7.1.
We
have
(for
n
≥
0):
PD
(i)
δ
∗
(ζnPD
)
=
(n
+
1)
·
ζn+1
;
def
n
i=0
(ii)
ζnPD
[T
]
=
(iii)
δ(ζnPD
)
=
n−i
T
ζiPD
·
(n−i)!
is
Zet
-invariant.
n−1
1
1
i+n
PD
PD
PD
=
−ζn−1
+
12
·
ζn−2
+
.
.
.
+
(−1)n
·
n!
·
ζ0PD
.
i=0
(−1)
(n−i)!
ζi
In
particular,
δ
n
(ζnPD
)
=
(−1)n
·
ζ0PD
.
Proof.
First,
we
observe
that:
(i)
follows
immediately
from
the
deﬁnition
of
ζnPD
;
(iii)
follows
from
the
Zet
-invariance
of
(ii)
by
evaluating
the
expression
of
(ii)
at
“U
”
equals
96
q
·U
,
“T
”
equals
0
(which
yields
1et
(ζnPD
)),
and
noting
that
this
is
equal
to
the
expression
of
i+n
n
PD
(ii)
at
“U
”
equals
U
,
“T
”
equals
−1
(which
yields
i=0
(−1)
(n−i)!
·
ζi
).
Thus,
it
suﬃces
to
prove
(ii).
But
(ii)
follows
from
the
Zet
-invariance
of
(δ
taut
)∗
:
Indeed,
since
[
δ
∗
,
T
]
=
0,
1
if
we
apply
n!
·
((δ
taut
)∗
)n
to
ζ0PD
(which
is
clearly
Zet
-invariant),
we
obtain:
n


1

n
1
taut
∗
n
PD
)
)
(ζ0
)
=
·
((δ
·
(δ
∗
)i
(ζ0PD
)
·
T
n−i
n!
n!
i=0
i
=
n

ζiPD
·
i=0
T
n−i
(n
−
i)!
as
desired.

Any
φ
∈
Γ(C
∞
,
LC
∞
)
such
that
δ
n+1
(φ)
=
0
for
some
nonnegative
Lemma
7.2.
S
S
integer
n
may
be
written
as
a
unique
A-linear
combination
of
ζ0PD
,
.
.
.
,
ζnPD
.
In
particular,
ζ0PD
,
.
.
.
,
ζnPD
are
linearly
independent
over
A.
Proof.
This
follows
by
induction
on
n.
It
is
clear
when
n
=
0
(since
Γ(C,
LC
)
(⊆
Γ(C
∞
,
LC
∞
))
is
a
free
A-module
of
rank
1
generated
by
ζ0PD
).
For
arbitrary
n
≥
1,
S
n+1
S
if
δ
(φ)
=
0,
then
by
the
induction
hypothesis,
δ(φ)
may
be
written
as
an
A-linear
n−1
combination
i=0
ci
·
ζiPD
.
Thus,
by
Lemma
7.1,
it
follows
that
for
some
appropriate
n−1
PD
ci
∈
A,
the
function
φ
−
i=0
ci
·
ζi+1
is
contained
in
the
kernel
of
δ,
hence
can
be
written
PD
as
an
A-multiple
of
ζ0
,
as
desired.
Linear
independence
follows
similarly
by
applying
δ,
using
the
induction
hypothesis
and
Lemma
7.1.

Deﬁnition
7.3.
We
shall
refer
the
functions
ζnPD
∈
Γ(C
∞
,
LC
∞
)
as
divided
power
(canonS
ical
Schottky-Weierstrass)
zeta
functions.
S
Thus,
putting
everything
together,
we
see
that
we
have
proven
the
following
result:
Theorem
7.4.
(Divided
Power
Canonical
Schottky-Weierstrass
Functions)
Let
ζ0PD
∈
Γ(C
∞
,
LC
∞
)
be
the
function
“1”
∈
OC
∞
(e).
Write
(for
n
∈
Z≥0
)
S
S
S
def
ζnPD
=
1
∗
n
PD
(δ
)
ζ0
n!
def
(and
let
ζnPD
=
0
if
n
<
0).
(Thus,
in
particular,
the
function
ζ1PD
here
is
the
same
as
the
PD
function
“ζ1
”
of
Theorem
5.6.)
Then
δ
∗
(ζnPD
)
=
(n
+
1)
·
ζn+1
,
δ
n
(ζnPD
)
=
(−1)n
·
ζ0PD
(if
n
≥
0);
97
δ(ζnPD
)
=
n−1
1
1
i+n
PD
PD
PD
=
−ζn−1
+
12
·
ζn−2
+
.
.
.
+
(−1)n
·
n!
·
ζ0PD
i=0
(−1)
(n−i)!
ζi
(for
all
n
∈
Z).
Moreover,
the
A-submodule
of
Γ(C
∞
,
LC
∞
)
generated
by
ζ0PD
,
.
.
.
,
ζnPD
is
S
S
equal
to
the
A-submodule
of
sections
of
Γ(C
∞
,
LC
∞
)
which
are
annihilated
by
δ
n+1
.
In
S
S
particular,
this
submodule
is
equal
to
the
A-submodule
of
Γ(C
∞
,
LC
∞
)
generated
by
the
S
S
functions
denoted
“ζ0
,
.
.
.
,
ζn
”
in
Theorem
6.4.
Finally,
the
polynomial
def
ζnPD
[T
]
=
n

ζiPD
·
i=0
T
n−i
Tn
T
(n−1)
PD
=
ζ0PD
·
+
ζ1PD
·
+
.
.
.
+
ζn−1
·
T
+
ζnPD
(n
−
i)!
n!
(n
−
1)!
(∈
Γ(C
∞
,
LC
∞
[T
]))
is
Zet
-invariant
(relative
to
the
natural
action
of
Zet
on
C
∞
,
LC
∞
,
S
S
S
and
the
action
of
Zet
on
T
given
by
1et
(T
)
=
T
+
1).
S
Remark
1.
Just
as
was
the
case
with
Theorem
6.4,
Theorem
7.4
also
has
a
complex
analytic
version.
We
leave
the
routine
details
to
the
reader.
Remark
2.
It
is
clear
from
the
formula
for
δ(ζnPD
)
that
the
denominators
that
occur
are
“essential”
(i.e.,
they
cannot
be
eliminated
as
in
the
case
of
Theorem
6.4
simply
by
“redeﬁning
the
integral
structure”
as
in
Deﬁnition
6.2).
In
fact,
we
shall
see
(cf.
Chapter
VI)
that
the
functions
of
Theorem
6.4
are
more
suited
to
the
study
of
the
universal
extension
at
ﬁnite
primes
(i.e.,
in
mixed
characteristic),
where
as
the
functions
of
Theorem
7.4
are
more
suited
to
the
study
of
the
universal
extension
at
inﬁnite
primes
(cf.
Chapter
VII;
Chapter
VIII).
Remark
3.
One
“generating
function-theoretic”
way
to
summarize
the
content
of
Theorem
7.4
is
the
following:
Let
s
be
an
indeterminate.
Note
that
[
δ,
(δ
taut
)∗
]
=
[
δ,
δ
∗
+
T
]
=
0
Thus,
since
δ(ζ0PD
)
=
0,
δ
also
annihilates
e
(δ
∗
+T
)·s
·
ζ0PD
=
n


n≥0
i=0
ζiPD
·
T
n−i

n
·s
(n
−
i)!
=
ζ0PD
[T
]
+
ζ1PD
[T
]
·
s
+
ζ2PD
[T
]
·
s2
+
.
.
.
+
ζnPD
[T
]
·
sn
+
.
.
.
98
The
coeﬃcients
of
this
series
are
precisely
the
functions
discussed
in
Theorem
7.4.
Next,
we
would
like
to
construct
the
binomial
canonical
Schottky-Weierstrass
functions.
First,
recall
the
polynomials
def
T
[n]
=
1
T
(T
−
1)(T
−
2)
·
.
.
.
·
(T
−
(n
−
1))
n!
discussed
in
§6.
If
D
is
any
operator,
we
shall
denote
by


D
n
the
operator
obtained
by
substituting
D
into
the
polynomial
T
[n]
.
If
D1
and
D2
are
any
two
commuting
operators,
we
have
(for
n
a
positive
Lemma
7.5.
integer)

D1
+
D
2
n





n

D1
D2
=
·
m
n−m
m=0
Proof.
This
identity
is
essentially
an
equality
between
two
polynomials
(i.e.,
the
expressions
on
the
left-
and
right-hand
sides)
in
two
variables
(i.e.,
D1
,
D2
).
Thus,
it
holds
if
and
only
if
holds
when
D1
and
D2
are
arbitrary
positive
integers.
But
for
such
D1
and
D2
,
this
identity
may
be
checked
by
considering
the
coeﬃcients
of
xn
in
the
equality
(1
+
x)D1
+D2
=
(1
+
x)D1
·
(1
+
x)D2
(where
x
is
an
indeterminate).

def
δ
∗

PD
n
(ζ0
);
def
Now
we
deﬁne
ζ0BI
=
ζ0PD
;
(for
n
a
positive
integer)
ζnBI
=
def
ζnBI
[T
]
=

∗

n

δ
+T
PD
BI
ζm
·
T
[n−m]
(ζ0
)
=
n
m=0
Note
that
the
Zet
-invariance
of
(δ
taut
)∗
=
δ
∗
+
T
implies
that
ζnBI
[T
]
is
also
Zet
-invariant.
In
particular,
the
ζnBI
are
higher
Schottky-Weierstrass
zeta
functions
in
the
sense
of
the
Theorem
6.4.
From
a
“generating
function-theoretic”
point
of
view,
one
can
write
∗
(1
+
s)(δ
+T
)
·
ζ0BI
=

ζnBI
[T
]
·
sn
n≥0
=
ζ0BI
[T
]
+
ζ1BI
[T
]
·
s
+
ζ2BI
[T
]
·
s2
+
.
.
.
+
ζnBI
[T
]
·
sn
+
.
.
.
99
Finally,
we
observe
that
the
ζnBI
are
integral
over
Z[
12
].
Indeed,
to
see
this,
we
reason
as

∗
follows:
Recall
the
section
σ
alg
∈
Γ(C,
LC
)
of
§5.
If
we
apply
δn
to
(σ
alg
)2
|C
∞
=
(σ
an
)2
·θ,
S
which
is
a
series
with
Z-integral
coeﬃcients
in
the
monomials
{q
k
+k
·
U
2k+1
·
θ,
q
k
·
U
2k
·
θ,
q
k
−k
·
U
2k−1
·
θ}
2
2
2
δ
∗


∗


acts
on
U
k
by
multiplication
by
nk
,
we
obtain
that
δn
(σ
alg
)2
|C
∞
is
ZS

∗
integral.
On
the
other
hand,
ζnBI
is
essentially
δn
(σ
alg
)|C
∞
,
so
the
Z[
12
]-integrality
of
ζnBI
S

∗
follows
formally
by
solving
for
2
·
sn
δn
(σ
alg
)|C
∞
(and
applying
induction
on
n)
in
the
then
since
n
S
formal
identity
∗
∗
(1
+
s)δ
{(σ
alg
)2
}
=
{(1
+
s)δ
(σ
alg
)}2
(where
we
note
that
this
formal
identity
follows
from
the
general
fact
that
if
X
is
any
“operator”
on
“(commuting)
functions”
A,
B
which
satisﬁes
the
Leibniz
rule,
then
the
identity
eX
(A
·
B)
=
eX
(A)
·
eX
(B)
is
a
formal
consequence
of
the
Leibniz
rule).
Deﬁnition
7.6.
We
shall
refer
the
functions
ζnBI
∈
Γ(C
∞
,
LC
∞
)
as
binomial
(canonical
S
Schottky-Weierstrass)
zeta
functions.
S
Theorem
7.7.
(Binomial
Canonical
Schottky-Weierstrass
Functions)
Let
ζ0BI
∈
def

∗

Γ(C
∞
,
LC
∞
)
be
the
function
“1”
∈
OC
∞
(e).
Write
(for
n
∈
Z≥0
)
ζnBI
=
δn
(ζ0BI
);
S
S
S
def
ζnBI
[T
]
=

∗

n

δ
+T
BI
BI
ζm
·
T
[n−m]
(ζ0
)
=
n
m=0
Then
the
ζnBI
,
ζnBI
[T
]’s
satisfy
the
properties
of
Theorem
6.4
(where
we
take
“ζn
”
of
Theorem
6.4
to
be
ζnBI
;
“f
”
of
Theorem
6.4
to
be
ζnBI
[T
]).
In
particular,
the
ζnBI
[T
]’s
are
Zet
-invariant.
Finally,
the
ζnBI
[T
]’s
are
integral
over
Z[
12
].
100
Bibliography
[Ahlf]
L.
Ahlfors,
Complex
Analysis,
McGraw-Hill
Book
Company
(1979).
[Falt]
G.
Faltings,
Stable
G-Bundles
and
Projective
Connections,
Journal
of
Algebraic
Geometry
2,
No.
3
(1993),
pp.
507-568.
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer
(1990).
[Kato]
K.
Kato,
Logarithmic
Structures
of
Fontaine-Illusie,
Proceedings
of
the
First
JAMI
Conference,
Johns
Hopkins
Univ.
Press
(1990),
pp.
191-224.
[Katz]
N.
Katz,
The
Eisenstein
Measure
and
p-adic
Interpolation,
Amer.
Journ.
of
Math.
99,
No.
2
(1977),
pp.
238-311.
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
Univ.
Press
(1985).
[Knud]
F.
F.
Knudsen,
The
Projectivity
of
the
Moduli
Space
of
Stable
Curves,
II,
Math.
Scand.
52
(1983),
pp.
161-199.
[Mats]
H.
Matsumura,
Commutative
Algebra
(Second
Edition),
The
Benjamin/Cummings
Publishing
Company
(1980).
[MB]
L.
Moret-Bailly,
Pinceaux
de
variétés
abéliennes,
Astérisque
129,
Soc.
Math.
France
(1985).
[Mumf]
D.
Mumford,
An
Analytic
Construction
of
Degenerating
Abelian
Varieties
over
Complete
Rings,
Appendix
to
[FC].
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
RIMS
Preprint
1033
(September
1995);
Publ.
of
RIMS
32,
No.
6
(1996),
pp.
957-1151.
[Mzk2]
S.
Mochizuki,
Foundations
of
p-adic
Teichmüller
Theory,
AMS/IP
Studies
in
Advanced
Mathematics
11,
American
Mathematical
Society/International
Press
(1999).
101
Chapter
IV:
Theta
Groups
and
Theta
Functions
§0.
Introduction
In
this
Chapter,
we
discuss
theta
groups
in
various
contexts.
These
groups
will
play
a
key
role
in
this
paper.
In
§1,
we
review
the
“classical
theory”
of
theta
groups
and
algebraic
theta
functions
of
[Mumf1,2,3],
specialized
to
the
case
of
elliptic
curves.
In
§2,
we
discuss
the
relationship
between
this
sort
of
theta
action,
and
the
theta
action
that
one
considers
in
the
case
of
the
Schottky
uniformization
of
a
degenerating
elliptic
curve.
In
§3,
we
use
the
theory
of
§2
to
deﬁne
twisted
Schottky-Weierstrass
zeta
functions,
which
will
play
an
important
role
in
the
calculations
of
Chapter
V.
In
§4,
we
review
Zhang’s
theory
([Zh])
of
metrized
line
bundles.
Finally,
in
§5,
we
discuss
the
relationship
between
Zhang’s
theory
and
the
theory
of
Mumford
reviewed
in
§1.
We
then
apply
this
discussion
to
compute
various
degrees
of
push-forwards
of
metrized
line
bundles.
§1.
Mumford’s
Algebraic
Theta
Functions
In
this
§,
we
review
the
deﬁnitions
and
basic
properties
of
theta
groups
(cf.,
e.g.,
[MB],
Chapitres
V,
VI)
and
algebraic
theta
functions
(cf.
[Mumf1,2,3]).
See
also
[Mumf4]
for
basic
facts
concerning
abelian
varieties.
Let
f
:E→S
be
an
elliptic
curve
over
a
scheme
S,
with
identity
section
e
:
S
→
E.
Let
L
be
a
relatively
ample,
symmetric
line
bundle
on
E,
of
relative
degree
d
(over
S).
Then
it
is
not
diﬃcult
to
show
that
L
is
necessarily
of
the
form:
def
L
=
OE
((d
−
1)
·
[e]
+
[τ
])
⊗OS
M
where
τ
∈
E(S)
is
a
section
such
that
2
·
τ
=
0,
and
M
is
a
line
bundle
on
S.
For
any
point
α
∈
E(T
)
over
an
S-scheme
T
,
the
line
bundle
(Tα∗
L)
⊗
L−1
def
(where
ET
=
E
×S
T
;
Tα
:
ET
→
ET
is
translation
by
α)
on
ET
is
of
relative
degree
0
over
T
,
hence
deﬁnes
(by
α
→
(Tα∗
L)
⊗
L−1
)
a
homomorphism
102
φL
:
E
→
E
whose
kernel
KL
=
Ker([d]
:
E
→
E)
is
the
kernel
of
multiplication
by
d
on
E.
In
particular,
KL
is
a
ﬁnite,
ﬂat
group
scheme
over
S.
Next,
we
deﬁne
the
scheme
GL
to
be
the
scheme
that
represents
pairs
(α,
ι),
where
α
∈
E(T
)
belongs
to
KL
(T
),
and
ι
:
Tα∗
L
∼
=
L
is
an
isomorphism
of
line
bundles
on
ET
.
Then
GL
has
a
natural
structure
of
group
scheme
over
S
which
ﬁts
into
an
exact
sequence
(in,
say,
the
ﬁnite
ﬂat
topology
of
S):
1
→
(Gm
)S
→
GL
→
KL
→
1
where
the
projection
GL
→
KL
is
given
by
(α,
ι)
→
α,
and
the
inclusion
(Gm
)S
→
GL
is
given
by
the
natural
action
of
(Gm
)S
on
L.
Although
(Gm
)S
lies
in
the
center
of
GL
,
in
general,
GL
will
not
be
commutative.
Indeed,
the
commutator
map
(α,
β)
→
α·β
·α−1
·β
−1
(for
α,
β
∈
GL
(T
))
deﬁnes
a
bilinear
nondegenerate
pairing
[−,
−]
:
KL
×
KL
→
(Gm
)S
The
group
scheme
GL
is
called
the
theta
group
associated
to
the
line
bundle
L.
Next,
we
would
like
to
consider
quasi-coherent
OS
-modules
equipped
with
an
action
of
GL
such
that
(Gm
)S
⊆
GL
acts
via
the
“identity
character”
(Gm
)S
→
(Gm
)S
.
We
shall
refer
to
such
modules
as
“OS
[GL
]-modules,”
for
short.
Note
that
it
follows
from
the
deﬁnition
of
GL
that
def
V
=
f∗
L
has
a
natural
structure
of
OS
[GL
]-module.
Moreover,
one
has
the
following
(cf.
[MB],
Chapitre
V,
Corollaire
2.4.3):
Theorem
1.1.
The
operation
“⊗OS
V”
induces
an
equivalence
of
categories
between
the
category
of
quasi-coherent
OS
-modules
and
the
category
of
OS
[GL
]-modules.
Moreover,
103
up
to
tensor
product
with
a
line
bundle
on
S,
V
is
the
unique
OS
[GL
]-module
with
this
property.
Example
1.2.
Now
suppose
that
we
have
an
isomorphism
KL
∼
=
μd
×
(Z/dZ)
such
that
the
pairing
discussed
above
is
given
by
(α,
β)
→
αβ
,
for
α
∈
μd
,
β
∈
Z/dZ,
λ
∈
Gm
(T
).
Then
one
may
construct
GL
,
as
well
as
the
GL
-module
V
explicitly,
as
follows.
First
of
all,
the
T
-valued
points
(for
an
S-scheme
T
)
GL
(T
)
of
the
group
scheme
GL
may
be
thought
of
as
the
set
of
triples
(α,
β,
λ),
where
α
∈
μd
,
β
∈
Z/dZ,
λ
∈
Gm
(T
),
and
the
multiplication
law
is
given
by:
(α1
,
β1
,
λ1
)
·
(α2
,
β2
,
λ2
)
=
(α1
·
α2
,
β1
+
β2
,
λ1
·
λ2
·
α2−β1
)
Now
deﬁne
the
GL
-module
W
as
the
free
OS
-module
def
W
=
OS
·
e0
⊕
OS
·
e1
⊕
.
.
.
⊕
OS
·
ed−1
(where
we
think
of
the
indices
of
the
ei
as
elements
of
Z/dZ)
on
which
(0,
0,
λ)
∈
GL
(T
)
acts
via
the
OS
-module
structure;
(α,
0,
1)
acts
on
ei
via
ei
→
αi
·
ei
;
and
(0,
β,
1)
maps
ei
to
ei+β
.
Then
the
resulting
OS
[GL
]-module
W
is
isomorphic
to
M
⊗OS
f∗
L
where
M
is
a
line
bundle
on
S.
Next,
we
consider
Lagrangian
subgroups
of
GL
.
Let
KH
⊆
KL
be
a
subgroup
scheme
of
KL
which
is
étale
locally
(on
S)
isomorphic
to
either
to
μd
or
to
Z/dZ,
and,
moreover,
has
the
property
that
the
restriction
of
the
pairing
KL
×
KL
→
(Gm
)S
discussed
above
to
KH
is
trivial.
Then
the
inverse
image
GH
⊆
GL
of
KH
deﬁnes
an
abelian
group
scheme
over
S
which
ﬁts
into
an
exact
sequence
1
→
(Gm
)S
→
GH
→
KH
→
1
If
KH
is
étale
locally
isomorphic
to
μd
,
then
(Gm
)S
and
KH
are
both
group
schemes
of
multiplicative
type.
Hence,
it
follows
that
the
splittings
of
this
exact
sequence
are
equivalent
to
splittings
of
the
corresponding
exact
sequence
of
character
groups
(i.e.,
the
exact
104
sequence
given
by
applying
Hom(−,
(Gm
)S
)
to
the
above
exact
sequence).
In
particular,
we
see
that
the
above
exact
sequence
splits
étale
locally
on
S.
If
KH
is
étale
locally
isomorphic
to
Z/dZ,
then
the
issue
of
whether
or
not
this
sequence
splits
is
more
delicate,
but
in
the
cases
that
we
are
interested
in,
this
sequence
will,
in
fact,
split.
Suppose
that
H
⊆
GH
is
a
splitting
of
the
above
exact
sequence.
Then
we
have
a
natural
isomorphism
H
∼
=
KH
.
Deﬁnition
1.3.
We
shall
refer
to
a
subgroup
KH
⊆
KL
as
above
as
a
Lagrangian
subgroup
of
KL
.
We
shall
refer
to
splittings
H
⊆
GH
as
Lagrangian
subgroups
of
GL
.
Remark.
Note
that
the
deﬁnition
of
“Lagrangian”
here
is
somewhat
diﬀerent
from
that
of
[MB].
Nevertheless,
when
applied
to
H
(as
opposed
to
KH
),
any
Lagrangian
subgroup
relative
to
Deﬁnition
1.3
is
also
Lagrangian
for
[MB],
Chapitre
V,
Déﬁnition
2.5.1.
The
following
result
is
proven
in
[MB],
Chapitre
V,
Théorème
3.2,
(i);
Chapitre
VI,
Propositions
1.2,
1.4.5:
Theorem
1.4.
Let
H
⊆
GL
be
Lagrangian.
Then
the
correspondence
M
→
MH
deﬁnes
a
equivalence
of
categories
between
the
category
of
OS
[GL
]-modules
and
the
category
of
quasi-coherent
OS
-modules.
Moreover,
H
⊆
GL
deﬁnes
a
line
bundle
LH
on
the
elliptic
def
curve
EH
=
E/KH
together
with
an
isomorphism
LH
|E
∼
=
L.
Finally,
this
isomorphism
induces
an
isomorphism
(f∗
L)H
∼
=
(fH
)∗
(LH
)
(where
fH
:
EH
→
S
is
the
structure
morphism).
Remark.
In
fact,
to
give
a
line
bundle
LH
on
EH
=
E/KH
together
with
an
isomorphism
LH
|E
∼
=
L
is
equivalent
to
giving
the
datum
of
the
lifting
H
⊆
GL
of
KH
⊆
KL
.
Thus,
often
instead
of
specifying
(respectively,
showing
the
existence
of)
the
lifting
H
⊆
GL
,
we
will
specify
(respectively,
show
the
existence
of)
the
line
bundle
LH
on
EH
=
E/KH
.
Theorem
1.4
is
convenient
for
reducing
proofs
concerning
f∗
L
to
proofs
concerning
(fH
)∗
(LH
).
105
We
are
now
ready
to
review
Mumford’s
construction
of
algebraic
theta
functions
(cf.
[Mumf1,2,3]).
In
the
remainder
of
this
§,
we
assume,
for
simplicity,
that
τ
=e
If
N
∈
Z,
let
us
write
[N
]
:
E
→
E
for
the
map
given
by
multiplication
by
N
.
Note
that
the
map
[−1]
:
E
→
E
is
an
automorphism
of
E
of
order
2
such
that
[−1]∗
L
=
L,
i.e.,
by
“=,”
we
mean
the
isomorphism
between
[−1]∗
L
and
L
arising
from
the
fact
that
(up
to
tensor
product
with
a
line
bundle
on
S)
L
is
the
line
bundle
associated
to
the
divisor
d
·
[e],
which
is
ﬁxed
by
[−1].
Thus,
from
the
deﬁnition
of
GL
,
it
follows
that
[−1]
gives
rise
to
an
automorphism
δL
:
GL
→
GL
of
order
2
whose
restriction
to
(Gm
)S
is
the
identity
and
which
induces
the
inverse
morphism
on
the
quotient
KL
of
GL
.
Let
us
write
SL
⊆
G
L
for
the
subscheme
of
T
-valued
points
(where
T
is
an
S-scheme)
γ
∈
GL
satisfying
δL
(γ)
=
γ
−1
.
Such
points
γ
are
often
referred
to
as
symmetric
(cf.
[Mumf1],
Deﬁnition,
p.
309).
One
checks
easily
that
the
projection
SL
→
KL
is
surjective,
ﬁnite,
and
ﬂat,
and
that
it
is,
in
fact,
a
torsor
over
μ2
(⊆
Gm
).
In
the
following
discussion,
we
would
like
to
show
that
this
torsor
admits
a
natural
section
over
2
·
KL
⊆
KL
.
The
construction
of
this
section,
as
well
as
the
sort
of
section
obtained,
diﬀer
slightly,
depending
on
whether
d
is
even
or
odd.
We
begin
by
making
the
following
construction,
which
is
valid
regardless
of
the
parity
of
d:
For
α
∈
KL
(T
)
(where
T
is
an
S-scheme),
if
α
∈
GL
(T
)
is
any
element
that
lifts
α,
then
the
assignment
α
→
α
·
δL
(α−1
)
(where
we
note
that
the
right-hand
side
is
independent
of
the
choice
of
α
since
δL
induces
the
identity
on
(Gm
)S
⊆
GL
)
deﬁnes
a
morphism
σ1
:
KL
→
GL
which
factors
through
SL
⊆
GL
,
and
whose
composite
with
the
projection
GL
→
KL
is
the
morphism
[2]
:
KL
→
KL
(multiplication
by
2
on
KL
).
(Note,
that
here
we
write
the
group
106
law
of
KL
additively.)
Indeed,
these
facts
follow
from
the
fact
that
δL
is
an
automorphism
of
the
group
scheme
GL
of
order
2
which
induces
the
automorphism
[−1]
on
the
quotient
KL
of
GL
.
This
morphism
σ1
is
not
(in
general)
a
group
homomorphism,
but
does
satisfy
the
following
property:
Lemma
1.5.
Let
α,
β
∈
KL
(T
)
(where
T
is
an
S-scheme).
Then
σ1
(α
+
β)
=
[α,
β]−2
·
σ1
(α)
·
σ1
(β)
(where
we
write
the
group
law
of
KL
(respectively,
GL
)
additively
(respectively,
multiplicately)).
In
particular,
it
follows
that:
(i.)
if
[α,
β]2
=
1
∈
Gm
,
then
σ1
(α
+
β)
=
σ1
(α)
·
σ1
(β);
(ii.)
the
restriction
of
σ1
to
any
subgroup
scheme
of
KL
on
which
the
pairing
[−,
−]
(discussed
above)
is
trivial
—
we
shall
call
such
subgroup
schemes
“[−,
−]-trivial”
—
is
a
group
homomorphism.
Proof.
Indeed,
if
β
∈
GL
(T
)
lifts
β,
then
α
·
β
lifts
α
+
β,
so
we
have:
σ1
(α
+
β)
=
α
·
β
·
δL
(β
−1
·
α−1
)
=
α
·
(β
·
δL
(β
−1
))
·
δL
(α−1
)
=
[α,
β]−2
·
α
·
δL
(α−1
)
·
(β
·
δL
(β
−1
))
=
[α,
β]−2
·
σ1
(α)
·
σ1
(β)
as
desired.
The
remaining
assertions
follow
immediately.

Thus,
at
any
rate,
if
d
is
odd,
then
multiplication
by
[2]
deﬁnes
an
automorphism
on
KL
,
so
we
obtain
by
σ1
deﬁnes
a
section
σ
:
KL
(=
2
·
KL
)
→
GL
(such
that
σ
·
[2]
=
σ1
),
as
desired.
Next,
we
consider
the
case
when
d
is
even.
First,
we
introduce
some
notation:
Let
us
write
def
1
d0
=
2
d
For
N
∈
Z,
let
us
denote
the
kernel
of
[N
]
:
E
→
E
by
NE
def
=
ker([N
]
:
E
→
E)
107
Then
I
claim
that
the
morphism
σ1
:
KL
=
d
E
→
GL
factors
through
KL
/2
E
∼
=
d0
E.
Indeed,
it
suﬃces
to
prove
that
for
any
α,
β
∈
KL
(T
)
(for
T
an
S-scheme)
such
that
2β
=
0,
we
have
σ1
(α
+
β)
=
σ1
(α).
But
by
Lemma
1.5,
we
have
σ1
(α
+
β)
=
σ1
(α)
·
σ1
(β)
(since
[α,
β]2
=
[α,
2β]
=
[α,
0]
=
1).
Thus,
it
suﬃces
to
show
that
σ1
(β)
=
1.
But
this
follows
from
the
fact
that
since
the
line
bundle
L
is
totally
symmetric
(cf.
[Mumf1],
§2,
Propositions
3,
6;
Corollary
2),
after
ﬁnite
ﬂat
localization,
we
may
choose
the
lift
β
∈
GL
(T
)
of
β
∈
KL
(T
)
to
lie
inside
SL
(T
)
⊆
GL
(T
)
and
(at
the
same
time)
satisfy
β
2
=
1.
Thus,
σ1
(β)
=
β
·
δL
(β)−1
=
β
2
=
1,
as
desired.
This
completes
the
proof
of
the
claim.
Note
that
we
have:
def
2
·
KL
=
d0
E
⊆
d
E
=
KL
In
particular,
we
obtain
a
morphism
σ
:
2
·
KL
→
GL
which
factors
through
SL
⊆
GL
,
and
whose
composite
with
the
projection
GL
→
KL
is
the
natural
injection
2
·
KL
⊆
KL
.
That
is
to
say,
in
the
even
case,
we
obtain
a
section
of
GL
→
KL
over
the
subgroup
scheme
2
·
KL
⊆
KL
.
This
completes
our
discussion
of
the
even
case.
Observe
that
in
both
the
even
and
odd
cases,
the
section
σ
over
2
·
KL
that
we
constructed
satisﬁes
the
following
property:
If
α
=
2α1
,
β
=
2β1
∈
2
·
KL
(T
)
(where
T
is
an
S-scheme),
then
σ(α
+
β)
·
σ(α)−1
·
σ(β)−1
=
[α1
,
β1
]2
(where
we
note
that
since
[KL
,
2
E]2
=
[KL
,
0]
=
1,
it
follows
(a
priori!)
that
[α1
,
β1
]2
depends
only
on
α,
β).
Indeed,
this
relation
follows
immediately
from
Lemma
1.5.
Let
us
observe
that
although
the
proof
of
Lemma
1.5
depends
on
the
explicit
deﬁnition
of
σ
in
terms
of
δL
,
the
square
of
the
above
relation,
i.e.,
{σ(α
+
β)
·
σ(α)−1
·
σ(β)−1
}2
=
[α,
β]
may
be
proven
solely
from
the
assumption
that
σ
maps
into
SL
⊆
GL
:
Indeed,
let
us
denote
σ(α
+
β)
·
σ(α)−1
·
σ(β)−1
∈
Gm
(T
)
by
λ.
Then
since
σ(α
+
β)
∈
SL
(T
),
we
obtain
δL
(σ(β))
·
δL
(σ(α))
·
λ
=
λ−1
·
σ(α)−1
·
σ(β)−1
.
If
we
combine
this
with
δL
(σ(α))
=
σ(α)−1
,
δL
(σ(β))
=
σ(β)−1
,
then
the
result
follows
immediately.
Next,
note
that
if
α
∈
E(S),
then
transport
of
structure
deﬁnes
a
natural
isomorphism
Gα
:
GTα∗
L
∼
=
GL
108
which
is
compatible
with
the
injections
of
Gm
,
and
projections
to
KL
=
KTα∗
L
on
both
sides.
Thus,
by
conjugating
by
Gα
,
we
see
that
σ
:
2
·
KL
→
GL
deﬁnes
a
section
σα
:
2
·
KTα∗
L
→
GTα∗
L
In
summary,
we
have
proven
the
following
result
(which
is
implicit
in
the
theory
of
[Mumf1],
§2):
Theorem
1.6.
Let
E
→
S
be
an
elliptic
curve
over
a
scheme
S.
Let
d
be
a
positive
integer.
Let
M
be
a
line
bundle
on
S.
Write
def
L
=
OE
(d
·
[e])
⊗OS
M
Then:
(1)
There
is
a
canonical
section
σ
:
2
·
KL
→
GL
of
the
projection
GL
→
KL
over
2
·
KL
⊆
KL
that
maps
into
SL
⊆
GL
,
is
functorial
in
S,
and
whose
restriction
to
[−,
−]-trivial
subgroup
schemes
of
2
·
KL
is
a
group
homomorphism.
Moreover,
these
properties
uniquely
determine
σ
over
4
·
KL
.
(2)
The
section
σ
is
related
to
the
pairing
[−,
−]
:
KL
×
KL
→
(Gm
)S
by
the
following
formula:
If
α
=
2α1
,
β
=
2β1
∈
2
·
KL
(T
)
(where
T
is
an
S-scheme),
then
σ(α
+
β)
·
σ(α)−1
·
σ(β)−1
=
[α1
,
β1
]2
In
particular,
we
have:
{σ(α
+
β)
·
σ(α)−1
·
σ(β)−1
}2
=
[α,
β].
(3)
Finally,
if
α
∈
E(S),
then
σ
deﬁnes
a
section
σα
:
2
·
KTα∗
L
→
GTα∗
L
by
transport
of
structure
via
the
translation
morphism
Tα
:
E
→
E.
def
Now
suppose
that
d
is
odd
(respectively,
even).
Then
KL0
=
KL
/2
·
KL
is
=
S
(respectively,
∼
=
2
E).
If
one
thinks
of
σ
as
a
2
·
KL
-valued
point
of
GL
,
then
it
follows
from
the
deﬁnition
of
GL
that
if
α
∈
E(S)
is
any
S-valued
point,
then
σ
induces
an
isomorphism
109
L|Tα∗
KL
∼
=
(L|α0
)
⊗OK
0
OKL
L
for
some
line
bundle
L|α0
on
the
quotient
KL0
of
KL
.
Thus,
put
another
way,
the
canonical
section
σ
determines
natural
descent
data
for
L|Tα∗
KL
from
KL
to
KL0
.
(Thus,
if
d
is
odd,
then
we
may
think
of
this
isomorphism
as
a
trivialization
of
the
restriction
of
the
line
bundle
L
to
the
subscheme
Tα∗
KL
.)
In
particular,
restriction
to
Tα∗
KL
deﬁnes
(by
composing
with
the
above
isomorphism)
a
morphism
of
OKL0
-modules
with
natural
GL
-action:
f∗
L
→
(L|α0
)
⊗OK
0
OKL
L
In
other
words,
this
morphism
allows
us
to
think
of
global
sections
of
L
over
E
as
being
(essentially)
functions
on
the
subscheme
Tα∗
KL
.
These
functions
are
the
algebraic
theta
functions
of
[Mumf1,2,3].
§2.
Theta
Actions
and
the
Schottky
Uniformization
In
this
§,
we
discuss
the
relationship
between
torsion
actions
on
line
bundles
(i.e.,
as
in
§1)
and
the
uniformization
theory
reviewed
in
Chapter
III,
§5.
Thus,
in
this
§,
we
will
use
the
same
notation
as
in
Chapter
III,
§5.
We
begin
by
reviewing
this
notation.
First
of
all,
O
is
a
Zariski
localization
of
the
ring
of
integers
of
a
ﬁnite
extension
of
Q;
def
A
=
O[[q]];
def
S
=
Spec(A);
def
S
=
Spf(A)
(where
q
is
an
indeterminate,
and
we
regard
A
as
equipped
with
the
q-adic
topology).
Over
S,
we
had
a
natural
elliptic
curve
E
→
S,
together
with
a
compactiﬁcation
C
→
S
whose
pull-back
CS
→
S
to
S
may
be
obtained
as
a
quotient
of
an
object
C
∞
with
respect
S
to
the
natural
action
of
the
group
Zet
on
C
∞
.
Moreover,
we
have
a
natural
identiﬁcation
S
ES
=
(Gm
)S
.
The
special
ﬁber
(C
∞
)spl
of
C
∞
(i.e.,
the
zero
locus
of
the
function
q)
is
a
S
S
chain
of
P1
’s
over
Spec(O)
indexed
by
Z
and
permuted
by
the
action
of
Zet
in
a
fashion
which
is
compatible
with
the
indexing
by
Z
and
the
natural
action
of
Zet
=
Z
on
Z
(by
addition).
Recall
that
we
denoted
the
origin
of
E
by
e.
This
origin,
regarded
as
a
divisor
def
def
in
E
or
C,
gives
rise
to
line
bundles
LE
=
OE
(e),
LC
=
OC
(e).
The
inverse
image
of
e
in
C
∞
(via
the
quotient
map
C
∞
→
CS
)
is
denoted
by
e
⊆
C
∞
.
In
Chapter
III,
§5,
we
S
S
S
also
discussed
how
Γ(C
∞
,
L⊗2i
C∞
)
S
110
S
def
(where
LC
∞
=
LC
|C
∞
)
may
be
described
explicitly
as
the
degree
i
portion
of
a
certain
S
S
graded
ring
RE
.
This
explicit
description
will
play
a
key
role
in
this
§,
and,
indeed,
in
the
proof
of
the
main
results
of
this
paper.
In
the
following,
we
ﬁx
a
positive
even
number
n
=
2m.
Then
let
us
recall
(cf.
[Mumf5],
p.
289)
that
there
is
a
natural
action
of
(Gm
)S
=
ES
on
C
∞
and
L⊗2
C
∞
.
In
particular,
S
S
we
obtain
a
natural
action
of
(μn
)S
(i.e.,
the
kernel
of
multiplication
by
n
on
the
abelian
group
object
(Gm
)S
)
on
C
∞
and
LC
∞
.
On
the
other
hand,
one
also
has
a
natural
action
S
of
Zet
in
C
∞
and
L⊗2
C∞
.
S
S
Moreover,
it
is
easy
to
see
from
the
deﬁnitions
of
these
actions
S
of
Zet
and
(μn
)S
(i.e.,
(μn
)S
acts
trivially
on
θ
–
cf.
[Mumf5],
p.
289;
the
action
of
Zet
,
namely,
1et
(θ)
=
q
·
U
2
·
θ,
is
discussed
in
Chapter
III,
§5)
that
they
commute
on
C
∞
and
S
L⊗n
C
∞
.
Thus,
it
follows
that
we
may
form
the
quotients
S
C
∞
=
C
∞
/μn
;
def
S
S
def
def
CS
=
CS
/μn
;
ES
=
ES
/μn
;

def
M
=
L⊗n
C
/μn
S
S
∞
of
C
∞
,
CS
,
ES
,
and
L⊗n
C
,
respectively,
by
(μn
)S
.
Indeed,
in
the
case
of
C
,
if
we
think
S
S
S
of
C
∞
as
the
q-adic
completion
of
a
sort
of
Néron
model
of
Gm
over
A[q
−1
]
(cf.
the
S
discussion
in
Chapter
III,
§5),
then
the
quotient
C
∞
→
C
∞
is
just
the
quotient
induced
S
S
on
completions
of
Néron
models
by
the
morphism
Gm
→
Gm
given
by
multiplication
by

deﬁnes
a
line
bundle
of
degree
1
on
C
whose
pull-back
to
C
n.
Finally,
note
that
M
S
S
S
⊗n
is
LC
.
S
Next,
let
us
write
C
=
C
∞
/(n
·
Zet
)
[n]
def
S
S
Thus,
we
obtain
covering
morphisms
C∞
→
C
S
[n]
S
→
CS
→
CS
def
where
the
ﬁrst
two
morphisms
are
étale
with
Galois
groups
n·Zet
and
Zet
/n
=
Zet
/n·Zet
,
respectively,
and
the
last
morphism
is
the
quotient
by
the
action
of
(μn
)S
.
Moreover,

on
C
)
into
the
last
two
morphisms
may
be
algebraized
(along
with
the
line
bundle
M
S
S
morphisms
C
[n]
→
C
→
C

on
C)
which
compactify
isogenies
of
smooth
group
schemes
(and
a
line
bundle
M
111
E
[n]
Zet
/n
−→
μn
−→
E
E
over
S.
Here,
the
groups
over
the
arrows
denote
the
kernels
of
the
respective
arrows,
or,
alternatively,
the
ﬁnite
group
schemes
with
respect
to
which
the
arrows
are
torsors.
The
group
schemes
E
and
E
have
connected
special
ﬁbers,
while
the
group
of
connected
components
of
the
special
ﬁber
of
E
[n]
may
be
identiﬁed
with
Zet
/n.
Moreover,
def
Πn
=
(Zet
/n)
×
μn
acts
on
C
[n]
and
E
[n]
,
and
E
[n]
→
E
is
naturally
a
Πn
-torsor.
Next,
observe
that
the
group
of
line
bundles
on
E
whose
pull-back
to
E
[n]
is
trivial
may
be
identiﬁed
with
the
group
of
characters
Hom(Πn
,
(Gm
)S
)
=
Hom(Πn
,
(μn
)S
)
(where
the
“Hom”
is
with
respect
to
group
schemes
over
S,
or
equivalently
in
this
case,
over
Spec(A[q
−1
])).
Indeed,
this
correspondence
may
be
given
explicitly
as
follows.
Given
a
character
χ
∈
Hom(Πn
,
(μn
)S
)
one
obtains
an
action
of
Πn
on
the
trivial
OE
[n]
-module
OE
[n]
that
covers
the
natural
action
of
Πn
on
E
[n]
by
multiplying
the
trivial
action
of
Πn
on
OE
[n]
by
χ.
Let
us
denote
χ
χ
OE
[n]
equipped
with
this
action
by
OE
[n]
.
Then
taking
Πn
-invariants
of
OE
[n]
gives
us
(since
E
[n]
→
E
is
a
Πn
-torsor)
a
line
bundle
O
χ
on
E
whose
restriction
to
E
[n]
is
equal
E
χ
χ
may
be
thought
of
as
the
to
OE
[n]
and
whose
n-th
power
is
trivial.
Put
another
way,
O
E
sheaf
of
functions
f
(
)
on
E
[n]
which
satisfy
the
transformation
rule:
f
(α
·
)
=
χ(α)−1
·
f
(
)
(for
all
points
α
(valued
in
some
scheme)
of
Πn
).
This
correspondence
χ
→
O
χ
E
induces
the
natural
bijection
between
characters
and
line
bundles
referred
to
above.
Also,
note
that
although
it
is
not
clear
whether
or
not
O
χ
extends
to
a
line
bundle
on
C,
it
E
χ
[n]
is
clear
that
the
line
bundle
with
Πn
-action
OE
extends
to
a
line
bundle
with
[n]
on
E
χ
[n]
Πn
-action
OC
[n]
on
C
.
Next,
let
us
observe
that
the
line
bundle
112
def
LC
=
OC
(e)
(where
e
is
the
identity
of
E)
satisﬁes

LC
|C
[n]
=
OC
[n]
([Πn
])
∼
=
OC
[n]
(n
·
[Zet
/n])
=
L⊗n
C
|C
[n]
=
M|C
[n]
(where
[Πn
]
and
[Zet
/n]
denote
the
divisors
in
C
[n]
deﬁned
by
the
respective
subgroup
schemes
of
E
[n]
).
Here,
the
isomorphism
“∼
=”
in
the
middle
follows
from
the
fact
that,
since
the
image
of
μn
forms
a
subgroup
scheme
in
C
[n]
annihilated
by
n,
and
OC
[n]
([Zet
/n])
is
a
line
bundle
of
degree
n
on
C
[n]
,
we
obtain
that
translation
by
μn
ﬁxes
the
isomorphism
class
of
OC
[n]
([Zet
/n]),
hence
that
OC
[n]
([Πn
])
∼
=
OC
[n]
(n
·
[Zet
/n]),
as
desired.
Thus,
it
follows
from
the
discussion
above
concerning
characters
that
there
exists
a
unique
χ
∈
Hom(Πn
,
(μn
)S
)
such
that

)
LE
=
O
χ
⊗O
(M|
E
E
E
We
are
now
ready
to
state
the
main
result
of
this
§:
Theorem
2.1.
The
character
χ
∈
Hom(Πn
,
(μn
)S
)
such
that

)
LE
=
O
χ
⊗O
(M|
E
E
E
(is
the
unique
character
which)
satisﬁes:
χ(1et
)
=
−1;
χ|μn
:
μn
→
μn
is
the
character
given
by
raising
to
the
m-th
power.
def
Proof.
To
simplify
notation,
write
ψ
=
θ
m
.
Recall
(cf.
[Mumf5],
especially
p.
289)
that

is
the
trivial
action.
In
the
action
of
Zet
×
μn
on
ψ
which
gives
rise
to
the
line
bundle
M
the
following,
we
shall
wish
to
take
objects
which
have
some
action
of
Zet
×
μn
deﬁned
in
[Mumf5],
and
twist
this
action
by
the
character
χ
described
in
the
statement
of
Theorem
2.1.
We
shall
denote
the
resulting
objects
with
twisted
action
by
means
of
a
superscript
or
subscript
χ
(whichever
is
more
convenient),
and
write,
for
instance,
[−1](ψ)
=
ψ;
[−1](ψχ
)
=
−ψχ
(where
[−1]
is
a
generator
of
μn
/μm
=
μ2
).
Since
L
has
a
unique
(up
to
constant
multiples)
nonzero
global
section
whose
zero
locus
is
precisely
e,
it
suﬃces
to
check
that
the
set
of
∞
Zet
×
μn
-invariant
sections
of
(L⊗m
C
∞
)χ
on
(C
)spl
has
a
generator
whose
zero
locus
on
the
S
S
113
Gm
inside
(C
∞
)spl
which
contains
the
identity
is
precisely
the
zero
locus
of
U
n
−
1
(i.e.,
S
the
inverse
image
of
e
⊆
E).
To
show
this,
recall
from
Chapter
III,
§5,
that
the
image
of
Γ(C
∞
,
L⊗m
C
∞
)
under
reS
striction
to
this
Gm
is
the
O-module
generated
by
S
U
m
·
ψχ
,
U
m−1
·
ψχ
,
.
.
.
,
U
·
ψχ
,
ψχ
,
U
−1
·
ψχ
,
.
.
.
,
U
−m+1
·
ψχ
,
U
−m
·
ψχ
Since
the
only
μm
-invariant
(where
μm
⊆
μn
)
U
i
are
those
for
which
i
is
divisible
by
m,
and,
moreover,
[−1](ψχ
)
=
−ψχ
=
ψχ
(where
[−1]
is
a
generator
of
μn
/μm
=
μ2
),
it
follows
that
the
μn
-invariant
subspace
of
this
image
is
given
by
the
O-module
generated
by
the
two
elements:
U
m
·
ψχ
,
U
−m
·
ψχ
Moreover,
we
have
1et
(U
−m
·
ψχ
)
=
χ(1et
)
·
(q
·
U
)−m
·
(q
·
U
2
)m
·
ψχ
=
χ(1et
)
·
U
m
·
ψχ
=
−U
m
·
ψχ
Thus,
the
Zet
×
μn
-invariant
subspace
is
generated
by
(U
m
−
U
−m
)
·
ψχ
whose
zero
locus
is
the
same
as
that
of
U
n
−
1,
as
desired.

Before
concluding
this
§,
we
make
some
ﬁnal
remarks
which
will
be
helpful
for
the
computations
that
we
will
perform
later.
First,
observe
that
it
is
a
consequence
of
the
discussion
at
the
beginning
of
Chapter
III,
§5,
that
Γ(C
∞
,
L⊗n
C
∞
)
is
topologically
A-generated
S
S
by
the
sections
U
m
·
θ
m
,
U
m−1
·
θ
m
,
.
.
.
,
U
·
θ
m
,
θ
m
,
U
−1
·
θ
m
,
.
.
.
,
U
−m+1
·
θ
m
,
U
−m
·
θ
m
and
their
Zet
-translates.
Let
us
compute
these
Zet
-translates.
Since
1et
(U
)
=
q
·
U
,
1et
(θ)
=
q
·
U
2
·
θ,
we
obtain,
for
k,
i
∈
Z,
|i|
≤
m:
ket
(U
i
)
=
q
ik
·
U
i
;
2
ket
(θ
m
)
=
q
m·k
·
U
2mk
·
θ
m
114
Thus,
we
obtain
the
following:
Proposition
2.2.
The
A-module
Γ(C
∞
,
L⊗n
C
∞
)
is
topologically
A-generated
by
the
sections
S
S
2
ket
(U
i
·
θ
m
)
=
q
m·k
+ik
·
U
2mk+i
·
θ
m
where
k,
i
∈
Z,
|i|
≤
m.
(For
instance,
the
case
m
=
1
of
Proposition
2.2
is
essentially
stated
in
the
discussion
at
the
beginning
of
Chapter
III,
§5.)
We
will
ultimately
use
Proposition
2.2
to
compute
the
image
in
ES
=
(Gm
)S
of
χ
sections
of
L⊗n
C
∞
⊗OC
∞
OC
∞
for
various
characters
χ
∈
Hom(Πn
,
(μn
)S
).
S
S
S
§3.
Twisted
Schottky-Weierstrass
Zeta
Functions
In
this
§,
we
generalize
the
discussion
of
Schottky-Weierstrass
zeta
functions
of
Chapter
III,
§6,
7,
to
the
“twisted”
context
of
§2.
We
maintain
the
notation
of
§2.
First,
let
us
recall
the
isogeny
E→E
discussed
in
§2.
This
kernel
of
this
isogeny
is
μn
.
Moreover,
this
isogeny
may
be
compactiﬁed
to
a
morphism
C
→
C.
Recall
(Chapter
III,
§1)
that
the
universal
extension
E
†
of
E
is
deﬁned
by
considering
certain
line
bundles
with
connection
on
C.
Given
such
a
line
bundle
with
connection
on
C,
by
taking
the
norm
of
this
line
bundle
(relative
to
the
ﬁnite
morphism
C
→
C),
we
obtain
a
line
bundle
on
C;
moreover,
taking
the
trace
of
the
connection
on
the
line
bundle
on
C,
we
get
a
connection
on
the
norm
on
this
line
bundle
on
C.
Thus,
by
performing
these
operations,
we
obtain
a
push-forward
homomorphism
E†
→
E†
which
covers
(since
taking
the
norm
of
the
line
bundle
deﬁned
by
a
divisor
on
E
is
the
same
as
taking
the
line
bundle
associated
to
the
image
of
this
divisor
in
E)
the
given
isogeny
E
→
E.
Moreover,
since
taking
the
trace
of
diﬀerentials
on
ES
=
(Gm
)S
via
what
amounts
to
the
multiplication
by
n
map
(Gm
)S
=
ES
→
(Gm
)S
=
ES
on
(Gm
)S
induces
an
isomorphism
of
the
invariant
diﬀerentials
on
ES
onto
the
invariant
diﬀerentials
on
ES
(i.e.,
the
trace
of
dU/U
is
n
·
dU/U
=
d(U
n
)/(U
n
)),
it
follows
that
the
push-forward
map
115
deﬁned
above
maps
WE
⊆
E
†
(i.e.,
WE
is
what
we
called
“W
”
when
E
was
the
only
elliptic
curve
under
discussion)
isomorphically
onto
WE
⊆
E
†
.
That
is
to
say,
we
have
a
commutative
diagram
0
−→
WE
⏐
⏐

−→
E†
⏐
⏐

−→
E
⏐
⏐

−→
0
0
−→
WE
−→
E†
−→
E
−→
0
where
the
vertical
arrow
on
the
left
is
an
isomorphism,
and
Ker(E
†
→
E
†
)
∼
=
μn
=
Ker(E
→
E)
∼
†
†
Next,
we
would
like
to
consider
the
canonical
splittings
κ
:
ES
→
E
,
κ
:
ES
→
E
of
S
S
Chapter
III,
§2,
Theorem
2.1.
Now
I
claim
that
κ(Ker(E
→
E))
⊆
Ker(E
†
→
E
†
)
Indeed,
since
κ
is
a
homomorphism,
it
follows
that
the
image
Im(κ(Ker(E
→
E)))
⊆
E
†
S
is
annihilated
by
n
and
vanishes
when
projected
to
ES
,
hence
is
contained
in
(WE
)S
.
On
the
other
hand,
the
image
in
(WE
)S
∼
=
A1
of
any
A-ﬂat
group
scheme
annihilated
by
n
S
is
necessarily
trivial.
Indeed,
this
may
be
checked
(by
A-ﬂatness)
in
characteristic
zero,
where
it
is
obvious.
This
completes
the
proof
of
the
claim.
Note
that
the
claim
then
implies
†
†
that
κ
:
ES
→
E
descends
to
a
homomorphism
ES
→
E
which
splits
the
projection
S
S
†
E
→
ES
.
Since
κ
is
the
unique
such
homomorphism
(cf.
Chapter
III,
§2),
it
thus
follows
S
that
we
have
a
commutative
diagram:
κ
ES
⏐
⏐

−→
ES
−→
κ
†
E
S
⏐
⏐

E
†
S
Next,
we
consider
line
bundles.
For
convenience,
we
assume
that
O
has
enough
primes
inverted
so
that
Pic(O)
=
{1}
116
(Here,
we
use
the
well-known
fact
from
elementary
algebraic
number
theory
that
“Pic”
of
the
ring
of
integers
of
a
number
ﬁeld
is
a
ﬁnite
group,
i.e.,
“the
ﬁniteness
of
the
class
group.”)
Note
that
since
Pic(O)
is
trivial,
it
follows
immediately
that
Pic(A)
is
also
trivial.
Now
recall
the
line
bundle

M
on
C.
If
χ
∈
Hom(Πn
,
(μn
)S
),
then
we
shall
write

)
χ
def
=
O
χ
⊗O
(M|
M
E
E
E
E
Note
that
since
C
is
regular,
and
C
−
E
is
of
codimension
2
in
C,
it
follows
that
the
line
χ
on
C.
Moreover,
since
E
→
E
χ
|E
extends
(uniquely)
to
a
line
bundle
M
bundle
M
C
E
χ

is
a
μn
-torsor,
we
obtain
an
action
of
μn
on
MC
.
Since
μn
is
of
multiplicative
type,
hence
reductive
(i.e.,
its
representations
split
up
into
direct
sums
of
representations
by
characters),
we
thus
obtain
that
the
μn
-invariant
subspace
χ
)μn
⊆
Γ(C,
M
χ
)
Γ(C,
M
C
C
χ
)
(which,
by
Riemann-Roch,
is
a
projective
is
a
direct
summand
of
the
A-module
Γ(C,
M
C
A-module
of
rank
n).
Since,
after
one
inverts
q,
this
invariant
subspace
may
be
identiﬁed
χ
)⊗A
A[q
−1
]
(which,
by
Riemann-Roch,
is
a
projective
A[q
−1
]-module
of
rank
with
Γ(E,
M
E
χ
)μn
is
a
projective
A-module
of
1),
we
thus
obtain
that
this
invariant
subspace
Γ(C,
M
C
χ
)μn
is
a
free
A-module
of
rank
rank
1.
Since
Pic(A)
is
trivial,
we
thus
obtain
that
Γ(C,
M
C
1.
Thus,
we
may
choose
a
generator
sχ
of
this
module,
i.e.:
χ
)μn
A
·
sχ
=
Γ(C,
M
C
Thus,
if
one
pulls
sχ
back
to
C
∞
,
we
see
that
S
sχ
|C
∞
S
may
be
thought
of
as
a
topological
A-linear
combination
σχ
of
the
elements
discussed
in
Proposition
2.2
which
satisﬁes,
for
all
points
α
of
Zet
×
μn
(valued
in
some
scheme),
α(σχ
)
=
χ−1
(α)
·
σχ
117
where
the
action
of
α
on
the
left-hand
side
is
via
the
usual
action
of
Zet
×μn
on
expressions
as
in
Proposition
2.2,
and
we
regard
the
character
χ
as
a
character
on
Zet
×
μn
via
the
natural
surjection
Zet
×
μn
→
(Zet
/n)
×
μn
=
Πn
.
Next,
let
us
recall
the
exact
sequence
0
→
OC
→
TC
→
τE
|C
→
0
of
the
discussion
following
Chapter
III,
Corollary
4.3.
The
extension
class
of
this
exact
†
sequence
is
precisely
the
torsor
deﬁned
by
the
universal
extension
EC
→
C.
By
the
discussion
above
concerning
the
relationship
between
the
universal
extensions
E
†
and
E
†
,
it
follows
that
this
exact
sequence
descends
naturally
to
an
exact
sequence
0
→
OC
→
TC
→
τE
|C
→
0
χ
).
Then
just
Thus,
we
see
that
we
obtain
a
natural
action
of
μn
on
Γ(C,
TC
⊗OC
M
C
χ
,
we
obtain
(by
applying
Riemann-Roch
and
the
as
in
the
discussion
of
sections
of
M
reductiveness
of
μn
)
that
the
μn
-invariant
subspace
χ
)μn
⊆
Γ(C,
TC
⊗
M
χ
)
Γ(C,
TC
⊗
M
C
C
ﬁts
into
an
exact
sequence
of
A-modules:
χ
)μn
→
Γ(C,
M
χ
)μn
⊗A
(A
·
U
∂
)
→
0
χ
)μn
→
Γ(C,
TC
⊗
M
0
→
Γ(C,
M
C
C
C
∂U
In
particular,
we
may
choose
a
section
χ
)μn
Sχ
∈
Γ(C,
TC
⊗
M
C
χ
)μn
⊗A
(A
·
U
∂
)
is
equal
to
sχ
·
U
∂
.
If
we
pull-back
Sχ
to
C
∞
,
whose
image
in
Γ(C,
M
C
∂U
∂U
then
we
may
think
of
Sχ∞
as
a
section
of
TC
⊗
L⊗n
C
∞
which
satisﬁes
S
α(Sχ∞
)
=
χ(α)−1
·
Sχ∞
for
all
points
α
of
Zet
×
μn
(valued
in
some
scheme).
On
the
other
hand,
κ
deﬁnes
a
section
κT
∈
Γ(C
∞
,
TC
|C
∞
)
S
118
S
S
∂
whose
image
in
Γ(C
∞
,
τE
|C
∞
)
is
U
∂U
.
Since
κ
descends
to
κ
(as
discussed
above),
the
S
S
natural
action
of
μn
on
κT
is
trivial.
Moreover,
by
Chapter
III,
Theorem
5.6,
it
follows
that
1et
(κT
)
=
κT
+
1
In
particular,
the
section
σχ
·
κT
∈
Γ(C
∞
,
L⊗n
C
∞
⊗OC
TC
)
S
S
satisﬁes
1et
(σχ
·
κT
)
=
χ(1et
)−1
·
σχ
·
(κT
+
1);
α(σχ
·
κT
)
=
χ(α)−1
·
σχ
·
κT
(where
α
is
a
point
of
μn
valued
in
some
scheme).
Thus,
if
we
form
the
diﬀerence
ζ
χ
=
Sχ∞
−
σχ
·
κT
∈
Γ(C
∞
,
L⊗n
C∞
)
def
S
S
then
we
have:
1et
(ζ
χ
)
=
χ(1et
)−1
·
(ζ
χ
−
σχ
);
α(ζ
χ
)
=
χ(α)−1
·
ζ
χ
(where
α
is
a
point
of
μn
valued
in
some
scheme).
Let
us
deﬁne
def
δ
χ
(f
)
=
{χ(1et
)
·
1et
(f
)}
−
f
(Thus,
formally,
δ
χ
(f
·
g)
=
δ
χ
(f
)
·
1et
(g)
+
f
·
δ(g),
where
δ(g)
=
1et
(g)
−
g
is
as
in
Chapter
III,
§6.)
Then
we
have
δ
χ
(ζ
χ
)
=
−σχ
Note
that
if
χ
is
the
trivial
character,
n
=
2,
and
2
∈
O
×
,
then
ζ
χ
is
simply
(in
the
notation
of
Chapter
III,
§5)
“(ζ
+
C)
·
σ
2
”
for
some
C
∈
A.
119
Now
we
would
like
to
generalize
ζ
χ
in
precisely
the
way
we
generalized
ζ
in
Chapter
III,
§6.
To
do
this,
we
would
like
to
consider
extension
polynomials
–
i.e.,
sections
of
the
sheaf
Ret†
of
Chapter
III,
Proposition
6.1
–
but
this
time
(unlike
in
Chapter
III,
§6)
with
EC
∞
coeﬃcients
that
are
sections
of
L⊗n
C
∞
over
C
.
In
other
words,
we
would
like
to
consider
sections
of
R
⊗n
†
⊗OC
LC
et
EC
S
S
over
C
∞
.
S
Also,
whereas
before
we
considered
Zet
-invariant
extension
polynomials,
this
time
we
would
like
to
consider
extension
polynomials
on
which
Zet
×
μn
acts
via
the
character
χ
–
i.e.,
polynomials
which
are
(Zet
×
μn
)-invariant
when
χ
considered
as
sections
of
Ret†
⊗OC
(L⊗n
C
∞
)
.
Other
than
these
formal
changes,
however,
EC
S
the
proofs
proceed
just
as
for
Chapter
III,
§6,
Lemma
6.3,
Theorem
6.4.
The
end
result
is
the
following:
Theorem
3.1.
Let
r
be
a
nonnegative
integer,
and
χ
∈
Hom(Πn
,
(μn
)S
).
Then
there
exists
a
(Zet
×
μn
)-invariant
extension
polynomial
r

f=
χ
ζr−i
·
T
[i]
i=0
χ
χ
(where
the
coeﬃcients
lie
in
Γ(C
∞
,
(L⊗n
C
∞
)
)),
such
that
ζ0
=
σχ
;
S
S
χ
χ
χ
δ
χ
(ζr−i
)
+
δ
χ
(ζr−i−1
)
+
ζr−i−1
=0
χ
(for
all
i);
and
all
the
ζjχ
∈
Γ(C
∞
,
(L⊗n
C
∞
)
)
are
μn
-invariant.
In
particular,
we
have
S
S
χ
χ
δ
χ
(ζjχ
)
=
−ζj−1
+
ζj−2
−
...
+
(−1)j−1
ζ1χ
+
(−1)j
ζ0χ
(for
all
j).
Finally,
if
ζ0χ
,
.
.
.
,
ζrχ
satisfy
the
same
conditions
as
ζ0χ
,
.
.
.
,
ζrχ
,
then
for
each
j
=
0,
.
.
.
,
r,
χ
ζjχ
−
ζjχ
=
some
A−linear
combination
of
ζ0χ
,
.
.
.
,
ζj−1
(where
A
=
O[[q]]).
Remark.
Just
as
in
the
non-twisted
case
(cf.
Chapter
III,
§6,
Theorem
6.4),
we
may
take
ζ1χ
=
ζ
χ
.
Also,
(just
as
in
Chapter
III,
§6,
Remark
2)
everything
we
did
here
can
also
be
done
in
the
complex
analytic
context.
120
Similarly,
one
may
generalize
the
canonical
Schottky-Weierstrass
zeta
functions
of
Chapter
III,
§7,
to
the
present
twisted
context,
as
follows.
First,
we
assume
for
the
remainder
of
the
§
that
O
is
a
ﬁnite
extension
of
Q.
Then
we
deﬁne
the
operator
δ
∗
on
L⊗n
C
∞
by
S
f
→
δ
∗
(f
)
=
def
1
·
∇(U
∂
)
(f
)
∂U
n
⊗2m
⊗2
where
∇
is
the
connection
induced
on
L⊗n
C
∞
=
LC
∞
by
the
connection
on
LC
∞
of
Chapter
S
S
S
III,
Theorem
5.6;
and
U
is
the
standard
multiplicative
coordinate
on
ES
(as
in
§2).
One
checks
easily
that
the
natural
action
of
μn
on
δ
∗
is
trivial
and
that:
[δ
∗
,
δ
χ
]
=
χ(1et
)
·
1et
Also,
just
as
in
Chapter
III,
§7,
we
may
also
deﬁne
a
tautological
connection
(on
the
universal
extension),
as
well
as
a
corresponding
diﬀerential
operator
(δ
taut
)∗
.
Thus,
by
the
same
formal
arguments
as
those
used
to
derive
Chapter
III,
Theorem
7.4,
in
Chapter
III,
we
obtain
the
following
result:
Theorem
3.2.
(Divided
Power
Twisted
Canonical
Schottky-Weierstrass
Funcχ
tions)
Let
χ
∈
Hom(Πn
,
(μn
)S
),
ζ0PD,χ
=
σχ
∈
Γ(C
∞
,
(L⊗n
C
∞
)
).
Write
(for
r
∈
Z≥0
)
def
S
def
ζrPD,χ
=
S
1
∗
r
PD,χ
(δ
)
ζ0
r!
def
PD,χ
(and
let
ζrPD,χ
=
0
if
r
<
0).
Then
δ
∗
(ζrPD,χ
)
=
(r+1)·ζr+1
,
(δ
χ
)r
(ζrPD,χ
)
=
(−1)r
·ζ0PD,χ
(if
r
≥
0);
δ
χ
(ζrPD,χ
)
=
r−1
PD,χ
PD,χ
PD,χ
1
1
i+r
=
−ζr−1
+
12
·
ζr−2
+
.
.
.
+
(−1)r
·
r!
·
ζ0PD,χ
i=0
(−1)
(r−i)!
ζi
(for
all
r
∈
Z).
Moreover,
all
of
the
ζiPD,χ
(for
i
∈
Z)
are
μn
-invariant,
and,
in
fact,
the
APD,χ
χ
,
.
.
.
,
ζrPD,χ
is
equal
to
the
A-submodule
of
submodule
of
Γ(C
∞
,
(L⊗n
C
∞
)
)
generated
by
ζ0
S
S
χ
χ
r+1
.
In
particular,
μn
-invariant
sections
of
Γ(C
∞
,
(L⊗n
C
∞
)
)
which
are
annihilated
by
(δ
)
S
S
χ
this
submodule
is
equal
to
the
A-submodule
of
Γ(C
∞
,
(L⊗n
C
∞
)
)
generated
by
the
functions
S
S
PD,χ
PD,χ
denoted
“ζ0
,
.
.
.
,
ζr
”
in
Theorem
3.1.
Finally,
the
polynomial
def
ζrPD,χ
[T
]
=
r

i=0
ζiPD,χ
·
T
r−i
Tr
T
(r−1)
PD,χ
·
T
+
ζrPD,χ
=
ζ0PD,χ
·
+
ζ1PD,χ
·
+
.
.
.
+
ζr−1
(r
−
i)!
r!
(r
−
1)!
121
χ
(∈
Γ(C
∞
,
(L⊗n
C
∞
)
[T
]))
is
(Zet
×
μn
)-invariant
relative
to
the
natural
action
of
Zet
×
μn
S
S
∞
χ
on
C
,
(L⊗n
∞
C
)
,
and
the
action
of
Zet
×
μn
on
T
S
(∀α
∈
μn
).
given
by
1et
(T
)
=
T
+
1,
α(T
)
=
T
S
Remark.
Just
as
was
the
case
with
Theorem
3.1,
Theorem
3.2
also
has
a
complex
analytic
version.
We
leave
the
routine
details
to
the
reader.
Also,
just
as
was
the
case
for
Chapter
III,
Theorem
7.4,
it
is
clear
from
the
formula
for
δ
χ
(ζrPD,χ
)
that
the
denominators
that
occur
are
“essential”
(i.e.,
they
cannot
be
eliminated
as
in
the
case
of
Theorem
3.1
simply
by
“redeﬁning
the
integral
structure”).
Finally,
just
as
in
Chapter
III,
§7,
we
may
also
deﬁne
the
twisted
version
of
binomial
canonical
Schottky-Weierstrass
zeta
functions
as
follows.
First,
let
us
observe
that
there
is
a
unique
integer
iχ
satisfying
−m
≤
iχ
<
m
such
that
the
monomials
of
Propostion
χ
2.2,
when
considered
as
sections
of
(L⊗n
C
∞
)
),
are
μn
-invariant
if
and
only
if
the
integer
i
S
(∈
{−m,
−m
+
1,
.
.
.
,
0,
.
.
.
,
m
−
1}
–
cf.
Proposition
2.2)
is
equal
to
iχ
.
Then
we
have
the
following
result:
Theorem
3.3.
(Binomial
Twisted
Canonical
Schottky-Weierstrass
Functions)
χ
BI,χ
Let
χ
∈
Hom(Πn
,
(μn
)S
),
ζ0BI,χ
=
σχ
∈
Γ(C
∞
,
(L⊗n
=
C
∞
)
).
Write
(for
r
∈
Z≥0
)
ζr
S
S
δ∗
−
iχ

BI,χ
n
(ζ
);
0
r
def
def
ζrBI,χ
[T
]
=
def

∗
r
i


δ
+
T
−
nχ
BI,χ
ζjBI,χ
·
T
[r−j]
(ζ0
)
=
r
j=0
Then
the
ζnBI,χ
,
ζnBI,χ
[T
]’s
satisfy
the
properties
of
Theorem
3.1
(where
we
take
“ζnχ
”
of
Theorem
6.4
to
be
ζnBI,χ
;
“f
”
of
Theorem
6.4
to
be
ζnBI,χ
[T
]).
In
particular,
the
ζnBI,χ
[T
]’s
are
Zet
-invariant.
Finally,
the
ζnBI,χ
[T
]’s
are
integral
over
Z.
Proof.
It
remains
only
to
verify
integrality
over
Z.
But
this
follows
from
observing
that,
by
the
deﬁnition
of
iχ
,
ζ0BI,χ
may
be
thought
of
as
a
series
in
the
monomials
ket
(U
iχ
·
θ
m
)
i
(for
k
∈
Z)
of
Proposition
2.2.
Moreover,
the
operator
δ
∗
−
nχ
acts
on
the
monomial
ket
(U
iχ
·
θ
m
)
=
q
m·k
+iχ
·k
·
U
2mk+iχ
·
θ
m
2
i
by
multiplication
by
n1
(2mk
+
iχ
)
−
nχ
=
k.
Thus,
the
operator


monomial
by
multiplication
by
nk
∈
Z,
as
desired.

122
δ∗
−
iχ

r
n
acts
on
this
§4.
Zhang’s
Theory
of
Metrized
Line
Bundles
In
this
§,
we
review
the
theory
of
[Zh]
in
the
case
of
elliptic
curves.
Roughly
speaking,
this
theory
allows
one
to
compute
intersection
numbers
of
vertical
divisors
in
the
special
ﬁber
of
an
elliptic
curve
with
multiplicative
reduction
using
the
techniques
of
classical
harmonic
analysis
on
a
circle.
In
fact,
here,
we
will
use
a
slight
generalization
of
Zhang’s
1-dimensional
theory
to
the
2-dimensional
case,
so
in
the
following,
we
will
give
precise
deﬁnitions
and
statements
of
basic
facts.
The
proofs,
however,
will
be
omitted
since
they
are
entirely
the
same
as
those
of
[Zh].
Let
R
be
a
valuation
ring
whose
valuation
group
is
an
ordered
submodule
of
R.
We
denote
its
valuation
|
−
|R
:
R
→
R
and
assume
that
we
are
given
an
element
π
∈
R
such
that
|π|R
=
e−1
,
and
all
positive
rational
powers
of
the
ideal
π
·
R
exist
(as
ideals
of
R).
In
other
words,
we
want
to
think
of
the
copy
of
R
that
contains
the
valuation
group
of
R
as
being
“−R
·
log(π)”
(where
log(π)
is
to
be
regarded
as
a
formal
symbol).
We
denote
the
quotient
ﬁeld
of
R
by
F
.
Let
V
be
a
ﬁnite
dimensional
F
-vector
space.
Then
we
will
refer
to
as
a
metric
on
V
any
map
|
−
|V
:
V
→
R
such
that:
(i)
|λ
·
v|V
=
|λ|R
·
|v|V
,
for
all
λ
∈
R,
v
∈
V
;
(ii)
|v
+
w|V
≤
max(|v|V
,
|w|V
),
for
all
v,
w
∈
V
;
(iii)
the
set
def
MV
=
{v
∈
V
|
|v|V
≤
1}
is
nbounded
(i.e.,
given
any
basis
v1
,
.
.
.
,
vn
of
V
,
there
exists
a
λ
∈
R
such
that
MV
⊆
i=1
R
·
λ
·
vi
).
Thus,
MV
forms
an
R-submodule
of
V
which
is
bounded,
saturated
—
in
the
sense
that
M=

(π
−r
M
)
r∈Q>0
—
and
generates
V
over
F
.
Conversely,
given
any
bounded,
saturated
R-submodule
M
of
V
which
generates
V
over
F
,
one
can
naturally
deﬁne
a
metric
|
−
|V
on
V
such
that
M
=
MV
as
follows:
For
any
nonzero
rational
section
v
∈
V
,
we
let
|v|V
=
e−r0
def
123
where
r0
∈
R
is
the
supremum
of
the
set
of
rational
numbers
r
such
that
the
section
π
−r
·
v
∈
M
.
In
other
words,
metrics
on
V
are
equivalent
to
bounded,
saturated
Rsubmodules
of
V
that
generate
V
over
F
.
This
makes
it
clear,
for
instance,
how
to
deﬁne
tensor
products
of
metrics.
Indeed,
the
tensor
product
of
|
−
|V
,
|
−
|W
on
V
⊗F
W
is
the
metric
corresponding
to
the
saturation
(i.e.,
the
smallest
saturated
module
containing
the
given
module)
of
the
bounded
R-submodule
Image(MV
⊗R
MW
)
⊆
V
⊗F
W
.
If
dimF
(V
)
=
1,
then
a
metric
|
−
|V
on
V
is
completely
determined
by
its
value
on
any
ﬁxed
nonzero
element
v
∈
V
.
Thus,
it
follows
that
the
metrics
on
V
naturally
form
an
(additive)
torsor
over
R.
Moreover,
the
metrics
on
the
F
-vector
space
F
may
be
naturally
identiﬁed
(by
looking
at
the
value
of
the
metric
on
1
∈
F
)
with
R
itself.
Next,
let
us
return
to
the
set-up
of
§2.
Recall
that
we
have
a
one-dimensional
semiabelian
variety
E→S
equipped
with
a
compactiﬁcation
C
→
S.
Here,
S
=
Spec(A),
A
=
O[[q]].
Now
let
(for
N
≥
1
an
integer)
def
AN
=
A[q
1/N
];
def
A∞
=

AN
;
def
SN
=
Spec(AN
);
def
S∞
=
Spec(A∞
)
N
≥1
Thus,
SN
is
a
ﬁnite,
ﬂat
S-scheme,
and
S∞
is
the
projective
limit
of
the
SN
’s.
Also,
let
us
write
US
=
Spec(A[q
−1
])
⊆
S
def
and
USN
,
US∞
,
etc.
for
the
inverse
images
in
SN
,
S∞
,
etc.
of
US
.
Note
that
E|US
×US
USN
has
a
unique
regular
semi-stable
model
CN
→
SN
over
SN
.
We
denote
the
complement
of
the
nodes
of
CN
by
EN
→
SN
Thus,
the
special
ﬁber
(i.e.,
the
zero
locus
of
q
1/N
)
of
EN
is
a
union
of
N
copies
of
(Gm
)O
.
Write
def
C∞
=
lim
CN
→
S∞
=
lim
SN
←−
←−
124
for
the
inverse
limit
of
the
CN
→
SN
,
where
N
ranges
over
the
multiplicative
semigroup
of
positive
integers.
Thus,
note
that
we
have
natural
open
immersions
EN
×SN
S∞
→
C∞
If
we
take
the
union
of
these
open
subschemes
of
C∞
over
N
,
we
obtain
an
open
subscheme
E∞
⊆
C∞
which
has
the
structure
of
a
smooth
group
scheme
over
S∞
.
Let
us
refer
to
the
prime
of
A∞
generated
by
the
q
r
for
all
positive
rational
numbers
r
as
the
central
prime
of
A∞
.
The
localization
of
A∞
at
the
central
prime
is
a
valuation
ring
with
value
group
Q.
For
geometric
objects
over
S∞
,
we
shall
refer
to
the
ﬁber
of
such
an
object
over
the
central
prime
of
S∞
as
the
special,
or
central,
ﬁber
of
the
object.
Observe
that
the
connected
components
of
the
special
ﬁber
of
EN
may
be
naturally
identiﬁed
with
1
Z/Z
N
Here,
the
Z
should
be
thought
of
as
“Z
·
log(q)”
(where
log(q)
is
a
formal
symbol).
Indeed,
[n]
just
as
in
§2,
C
∞
formed
a
Galois
cover
of
C
with
Galois
group
n
·
Zet
such
that
the
S
S
(irreducible)
components
of
the
special
ﬁber
of
C
[n]
could
be
naturally
identiﬁed
with
Zet
/N
·
Zet
,
there
exists
a
natural
inﬁnite
Galois
cover
of
(CN
)S
with
Galois
group
Z
N
(which
is
a
blow-up
of
the
pull-back
to
SN
of
the
Z-Galois
cover
C
∞
→
CS
)
such
that
the
S
components
of
the
special
ﬁber
of
CN
may
be
identiﬁed
with
N1
Z/Z,
as
desired.
By
taking
the
limit
over
N
,
we
thus
obtain
that
the
components
of
the
special
ﬁber
of
C∞
may
be
identiﬁed
with
Q/Z
⊆
R/Z
=
S1
In
the
following,
we
would
like
to
do
functional
analysis
on
S1
.
To
this
end,
we
deﬁne
Func(S1
)
to
be
the
set
of
piecewise
smooth
continuous
functions
on
S1
,
i.e.,
continuous
functions
that
are
inﬁnitely
diﬀerentiable,
except
at
a
ﬁnite
number
of
points
of
S1
.
A
crucial
ingredient
of
the
theory
of
[Zh]
is
the
notion
of
“divisors
on
S1
”
(cf.
[Zh],
§2.1).
Let
us
write
125
Div(S1
)
=
Z[Q/Z]
def
for
the
set
of
ﬁnite
formal
sums
of
elements
of
Q/Z
with
Z-coeﬃcients.
We
will
regard
such
formal
sums
as
divisors
on
S1
.
Next,
we
let
Div(S1
)
=
Div(S1
)
⊕
Func(S1
)
def
be
the
group
of
compactiﬁed
divisors
on
S1
.
Given
a
compactiﬁed
divisor
D
+
g
(i.e.,
D
∈
Div(S1
),
g
∈
Func(S1
),
we
deﬁne
the
curvature
of
D
+
g
to
be
def
hD+g
=
δD
−
Δ(g)
Here,
δD
is
the
delta
distribution
associated
to
the
divisor
D,
i.e.,
if
f
∈
Func(S1
),
and
D
=
i
ci
·
pi
(for
ci
∈
Z;
pi
∈
Q/Z),
then
def
<
δD
,
f
>
=

ci
·
f
(pi
)
i
while
Δ(g)
is
the
distribution
obtained
by
applying
the
Laplacian
operator
Δ
to
g,
i.e.,
if
f
∈
Func(S1
),
then
∂2g
<
Δ(g),
f
>
=
−
f·
2
∂θ
S1
def
(where
∂/∂θ
is
the
standard
unit
tangent
vector
on
S1
,
i.e.,
the
tangent
vector
whose

reciprocal
dθ
satisﬁes
S1
dθ
=
1).
One
also
deﬁnes
an
intersection
pairing
on
compactiﬁed
divisors
on
S1
by:
def
(D1
+
g1
,
D2
+
g2
)
=
<
δD1
,
g2
>
+
<
δD2
,
g1
>
−
S1
g1
Δ(g2
)
Next,
we
would
like
to
consider
line
bundles
on
E∞
|US
.
First,
if
p
denotes
a
prime
of
the
special
ﬁber
of
E∞
,
then
we
shall
write
Op
for
the
completion
of
OE∞
at
p,
and
Kp
for
its
quotient
ﬁeld.
Thus,
Op
is
a
valuation
ring
with
valuation
group
equal
to
Q
(times
“log(q)”).
By
the
above
discussion,
such
p
are
in
natural
bijective
correspondence
with
the
set
Q/Z.
126
Deﬁnition
4.1.
We
deﬁne
a
pre-metrized
line
bundle
(L,
|
−
|L
)
on
E∞
to
be
a
pair
(L,
|
−
|L
)
consisting
of
a
line
bundle
L
on
E∞
|US
,
together
with
a
set
of
metrics
(as
deﬁned
above)
|
−
|L
=
{|
−
|Lp
}p
(where
p
ranges
over
all
primes
in
the
special
ﬁber
of
E∞
)
for
the
one-dimensional
Kp
def
vector
space
Lp
=
L
⊗OE∞
Kp
.
We
will
call
a
pre-metrized
line
bundle
(L,
|
−
|L
)
a
metrized
line
bundle
if
for
some
nonzero
rational
section
φ
of
L
over
E∞
,
the
real-valued
function
deﬁned
on
Q/Z
⊆
S1
by
p
→
−log(|φ|Lp
)
is
the
restriction
to
Q/Z
⊆
S1
of
a
function
in
Func(S1
).
We
denote
the
group
of
metrized
line
bundles
on
E∞
by
Pic(E∞
).
Remark
1.
The
deﬁnition
of
a
metrized
line
bundle
given
here
is
slightly
diﬀerent
from
that
of
[Zh].
Nevertheless,
the
metrized
line
bundles
that
are
ultimately
dealt
with
in
[Zh]
(cf.
[Zh],
§2.5)
are
precisely
the
sort
deﬁned
in
Deﬁnition
4.1.
In
[Zh],
however,
such
bundles
are
not
given
an
explicit
name.
Remark
2.
If
L
is
a
line
bundle
(in
the
usual
sense)
on
E∞
obtained
by
pull-back
from
a
line
bundle
on
CN
for
some
N
,
then
the
metrics
|
−
|Lp
given
by
letting
the
absolute
value
of
a
generator
of
L
at
p
be
equal
to
1
deﬁne
on
L
the
structure
of
a
metrized
line
bundle.
Thus,
the
notion
of
a
metrized
line
bundle
on
E∞
generalizes
the
notion
of
a
line
bundle
on
E∞
obtained
by
pull-back
from
a
line
bundle
on
CN
.
One
also
has
a
notion
of
compactiﬁed
divisors
on
E∞
,
corresponding
to
the
notion
of
a
metrized
line
bundle.
This
group
of
compactiﬁed
divisors
is
deﬁned
by
Div(E∞
)
=
Div(E∞
|US
)
⊕
Func(S1
)
def
(where
“Div(E∞
|US
)”
is
the
usual
group
of
Weil
divisors
on
the
US
-smooth
scheme
E∞
|US
).
Any
divisor
compactiﬁed
divisor
D
+g
on
E∞
deﬁnes
a
metrized
line
bundle
OE∞
(D
+g)
=
(L,
|
−
|L
)
as
follows:
First
of
all,
if
D
is
a
Weil
divisor
on
E∞
|US
,
then
taking
the
closures
of
its
irreducible
components
deﬁnes
a
Weil
divisor
D
⊆
E∞
on
E∞
.
Moreover,
since
E∞
|US
is
quasi-compact,
and
E∞
is
an
inverse
limit
of
regular
schemes,
it
follows
that
D
is,
in
fact,
a
Cartier
divisor
(cf.
the
discussion
of
the
morphism
ρ
below
for
more
details).
Thus,
we
obtain
a
line
bundle
L
on
E∞
.
Let
L
be
the
restriction
of
L
to
E∞
|US
.
Then
it
127
remains
to
deﬁne,
for
each
p
∈
Q/Z,
a
metric
|
−
|Lp
on
Lp
.
This
metric
is
obtained
by
letting
generators
of
L
at
p
have
absolute
value
exp(−g(p)).
This
correspondence
D
+
g
→
OE∞
(D
+
g)
thus
deﬁnes
a
surjection
Div(E∞
)
→
Pic(E∞
)
Under
this
correspondence,
if
v
∈
N1
Z/Z
is
a
component
in
the
special
ﬁber
of
CN
–
which
thus
deﬁnes
a
line
bundle
on
CN
–
then
the
element
of
Pic(E∞
)
corresponding
to
this
line
bundle
(cf.
Remark
2
above)
is
the
image
under
the
above
surjection
of
the
compactiﬁed
divisor
g
∈
Func(S1
),
where
g
is
the
piecewise
linear
function
on
S1
which
is
linear
on
the
complement
of
N1
Z/Z,
equal
to
N1
at
v,
and
equal
to
0
at
all
points
of
(
N1
Z/Z)\{v}.
Next,
we
recall
that
one
has
a
natural
morphism
ρ
:
Div(E∞
|US
)
→
Div(S1
)
deﬁned
as
follows:
To
deﬁne
ρ,
it
suﬃces
to
deﬁne
ρ
on
each
prime
divisor
in
E∞
|US
.
First,
we
set
ρ
to
be
0
on
all
prime
divisors
which
are
not
US
-ﬂat.
If
DUS
⊆
E∞
|US
is
US
-ﬂat,
then
since
E∞
|US
is
an
inverse
limit
of
regular
schemes,
DUS
will
be
a
Cartier
divisor,
hence,
in
particular,
a
US
-scheme
of
ﬁnite
presentation.
Thus,
DUS
will
arise
by
base
change
from
some
divisor
(DUS
)N
⊆
EN
|US
.
Write
DN
⊆
CN
for
the
closure
of
(DUS
)N
in
CN
.
Let
DN
→
DN
be
the
normalization
of
DN
.
Thus,
DN
→
SN
is
ﬁnite
and
ﬂat
(since
SN
is
regular
of
dimension
2
and
DN
is
normal,
hence
has
depth
2).
Note
that
since
the
prime
V
(q
1/N
)
⊆
SN
is
regular
of
height
1
and
has
characteristic
zero
residue
ﬁeld,
it
follows
(by
Abhyankar’s
Lemma)
that
the
ramiﬁcation
of
any
ramiﬁed
extension
of
the
localization
of
OSN
at
this
prime
may
be
annihilated
by
adjoining
roots
of
q
to
OSN
.
In
particular,
by
taking
N
suﬃciently
large,
we
may
assume
that
DN
→
SN
is
étale
at
all
characteristic
0
primes
of
height
1.
But
then
it
follows
from
the
fact
that
CN
is
regular,
that
no
characteristic
0
height
1
prime
of
DN
can
map
to
a
node
of
CN
.
(Indeed,
if
R
is
a
complete
discrete
valuation
ring,
and
R
is
an
unramiﬁed
extension
of
R
(so
R
is
also
a
complete
discrete
valuation
ring),
then
any
R
-valued
point
of
R[[x,
y]]/(xy
−
π)
(where
x,
y
are
indeterminates,
π
is
a
uniformizer
of
R)
would
imply
the
existence
of
an
R-homomorphism
R[[x,
y]]/(xy
−
π)
→
R
for
which
the
images
of
x
and
y
lie
in
the
maximal
ideal
mR
.
But
this
implies
that
the
image
of
π
in
R
lies
in
m2R
,
which
contradicts
the
assumption
that
R
is
unramiﬁed
over
R.)
Thus,
there
exists
a
closed
subscheme
FN
⊆
DN
of
positive
characteristic
(i.e.,
such
that
FN
⊗
Q
=
∅)
such
that
DN
\FN
⊆
EN
.
In
particular,
the
closure
D∞
of
DUS
in
C∞
will
also
satisfy:
D∞
\F∞
⊆
E∞
128
for
some
closed
subscheme
of
positive
characteristic
F∞
⊆
D∞
.
For
each
characteristic
0
height
1
prime
p
of
DN
,
let
us
write
Comp(p)
∈
Q/Z
for
the
irreducible
component
of
the
special
ﬁber
E∞
that
contains
p.
Then
we
deﬁne
def
ρ(DUS
)
=

p
[k(p)
:
Q(O)]
·
Comp(p)
where
p
ranges
over
the
characteristic
0
height
one
primes
of
DN
;
k(p)
is
the
residue
ﬁeld
of
p;
Q(O)
is
the
quotient
ﬁeld
of
O
=
AN
/(q
1/N
);
and
“[∼:∼]”
denotes
the
degree
of
a
ﬁeld
extension.
One
checks
easily
that
(for
N
suﬃciently
large)
this
deﬁnition
is
independent
of
N
.
This
completes
the
deﬁnition
of
ρ.
Now
that
we
have
the
morphism
ρ,
we
may
deﬁne
an
intersection
pairing
on
Div(E∞
)
def
Div(E∞
)
×
Div(E∞
)
→
Div(S∞
)
=
Div(S∞
)
⊕
R
(where
“×
”
denotes
pairs
of
compactiﬁed
divisors
D1
+
g1
,
D2
+
g2
such
that
the
generic
points
of
the
supports
of
D1
and
D2
do
not
intersect)
as
follows:
If
D1
,
D2
are
(Cartier)
divisors
on
E∞
|US
such
that
the
generic
points
of
their
supports
do
not
intersect,
then
taking
the
closures
of
their
supports
deﬁnes
(Cartier)
divisors
D
1
,
D
2
on
E∞
|US
(cf.
the
discussion
above).
Thus,
we
deﬁne
i(D1
,
D2
)
∈
Div(S∞
)
as
the
usual
intersection
divisor
D
1
·
D
2
of
D1
and
D
2
.
Then
the
intersection
pairing
for
compactiﬁed
divisors
is
deﬁned
by:
def
(D1
+
g1
,
D2
+
g2
)
=
i(D1
,
D2
)
+
(ρ(D1
)
+
g1
,
ρ(D2
)
+
g2
)
(where
the
second
“(−,
−)”
is
an
intersection
number
of
compactiﬁed
divisors
on
S1
,
hence
∈
R).
Ultimately,
we
shall
wish
to
do
intersection
theory
not
over
“local
objects”
such
as
S,
but
over,
for
instance,
(M1,0
)Z
or
ﬁnite
ﬂat
coverings
of
(M1,0
)Z
.
In
that
sort
of
global
context,
one
can
“glue
together”
the
usual
intersection
theory
over
(M1,0
)Z
with
the
intersection
theory
of
[Zh]
to
obtain
a
global
intersection
theory
for
line
bundles
on
the
tautological
log
elliptic
curve
over
coverings
of
(M1,0
)Z
which
are
equipped
with
a
metric
“at
inﬁnity.”
We
leave
the
“general
nonsense”
details
to
the
reader.
Next,
we
would
like
to
consider
the
curvatures
of
compactiﬁed
divisors
and
metrized
line
bundles.
If
D
+
g
∈
Div(E∞
),
then
its
curvature
is
deﬁned
to
be:
def
hD+g
=
hρ(D)+g
129
(where
the
right-hand
side
is
the
curvature
of
the
compactiﬁed
divisor
ρ(D)+g
∈
Div(S1
)).
If
L
=
OE∞
(D
+
g)
is
a
metrized
line
bundle,
then
we
deﬁne
the
curvature
of
L
to
be:
def
hL
=
hD+g
This
deﬁnition
is
independent
of
the
choice
of
D
+
g
(cf.
[Zh],
§2.5).
Note
that
in
both
cases,
the
curvature
is
a
distribution
on
S1
.
Its
integral
over
S1
is
given
by
(cf.
[Zh],
§2.5):
S1
hL
=
deg(L|US
)
the
degree
of
L
on
the
generic
ﬁber
of
E∞
.
Intuitively
speaking,
The
value
of
the
curvature
hL
at
a
point
a
∈
Q/Z
⊆
S1
should
be
thought
of
as
the
degree
of
the
“restriction”
of
L
to
the
irreducible
component
of
the
special
ﬁber
of
C∞
corresponding
to
a.
Deﬁnition
4.2.
A
metrized
line
bundle
or
compactiﬁed
divisor
on
E∞
is
said
to
be
admissible
if
its
curvature
is
the
distribution
given
by
a
constant
function
on
S1
.
If
a
metrized
line
bundle
L
is
admissible,
then
its
curvature
hL
is,
in
fact,
the
constant
given
by
deg(L|US
).
Proposition
4.3.
If
L1
=
(L1
,
|−|L1
)
and
L2
=
(L2
,
|−|L2
)
are
metrized
line
bundles
on
E∞
such
that
L1
∼
=
L2
(as
line
bundles
on
E∞
|US
)
and
hL1
=
hL2
,
then
L1
∼
=
L2
⊗OE∞
(C)
1
(as
metrized
line
bundles),
where
C
∈
Func(S
)
is
a
constant
function.
In
particular,
if
L1
=
(L1
,
|
−
|L1
)
and
L2
=
(L2
,
|
−
|L2
)
are
both
admissible
metrized
line
bundles
on
E∞
such
that
L1
∼
=
L2
(as
line
bundles
on
E∞
|US
),
then
L1
∼
=
L2
⊗
OE∞
(C)
(as
metrized
line
bundles),
where
C
∈
Func(S1
)
is
a
constant
function.
−1
Proof.
By
considering
L1
⊗
L2
,
it
suﬃces
to
consider
the
case
where
L1
is
the
trivial
metrized
line
bundle.
Then
L2
is
deﬁned
by
some
compactiﬁed
divisor
g
∈
Func(S1
).
Moreover,
since
hL1
=
0,
we
have
hg
=
−Δ(g)
=
0,
i.e.,
g
is
a
continuous
function
on
S1
whose
second
(distributional)
derivative
is
zero.
But
it
is
easy
to
see
that
such
a
function
g
is
necessarily
constant.

The
notion
of
admissible
metrized
line
bundles
will
be
of
fundamental
importance
in
the
following
discussion.
Thus,
it
is
of
interest
to
construct
admissible
metrized
line
bundles.
For
instance,
given
a
horizontal
(i.e.,
S∞
-ﬂat)
divisor
130
D
⊆
E∞
one
would
like
to
know
explicitly
which
function
gD
∈
Func(S1
)
is
the
unique
function
such
that
(i)

S1
gD
=
0
2
(ii)
D+gD
is
admissible
⇐⇒
hD+gD
=
δρ(D)
−Δ(gD
)
=
δρD
+
∂∂θg2D
is
constant
Such
a
function
gD
will
be
called
the
Green’s
function
for
D.
Note
that
gD
depends
only
on
the
divisor
ρ(D)
on
S1
.
Thus,
we
will
also
write
gρ(D)
for
gD
.
Let
D
∈
Div(S1
)
be
a
divisor
on
S1
.
We
would
like
to
consider
its
Green
function
gD
.
The
simplest
case
is
the
case
where
D
=
[0]
i.e.,
the
origin
of
[0]
∈
Q/Z
⊆
R/Z
=
S1
.
In
this
case,
we
will
denote
the
associated
Green’s
function
by
φ1
.
Proposition
4.4.
|θ|
≤
12
,
by:
The
Green’s
function
φ1
associated
to
the
origin
[0]
is
given,
for
φ1
(θ)
=
1
1
2
1
θ
−
|θ|
+
2
2
12
where
θ
is
the
standard
coordinate
on
R
(regarded
as
a
covering
of
R/Z
=
S1
).
In
particular,
φ1
(θ)
∈
Q,
for
all
θ
∈
Q.
Alternatively,
in
terms
of
Fourier
expansions
on
S1
,
it
is
given
by:
φ1
(θ)
=

1
·
4π
2
0=n∈Z
1
2πinθ
e
n2
1
In
particular,
φ1
(0)
=
12
(where
we
recall
that
we
think
of
the
values
of
φ1
as
being
in
1
“log(q)”
units)
is
the
maximum
value
attained
by
φ1
,
and
φ1
(
12
)
=
−
24
is
the
minimum
value
attained
by
φ1
.
Proof.
The
polynomial
representation
of
the
Green’s
function
φ1
is
given
in
[Zh],
§a.8,
p.
193.
The
Fourier
expansion
may
be
derived
as
the
unique
(topological)
linear
combination
of
e2πin
’s
(for
n
∈
Z)
whose
ﬁrst
derivative
is
square
integrable
on
S1
(hence
is
continuous),
1
,
and
whose
second
derivative
is
the
distribution
deﬁned
by
whose
value
at
0
is
12
131
1
−
δ[0]
=
−

e2πin
0=n∈Z
on
S1
.
The
assertions
concerning
the
maximum
and
minimum
values
of
φ1
follow
from
elementary
calculus.

Corollary
4.5.
Let
a,
b
∈
Q/Z.
Then
the
Green’s
function
φa,b
associated
to
the
divisor
a
−
b
on
S1
is
the
unique
piecewise
linear
function
on
S1
which
is
linear
(with
respect
to
θ)
away

from
a
and
b,
has
second
(distributional)
derivative
equal
to
δb
−
δa
,
and
is
such
that
S1
φa,b
=
0.
Moreover,
φa,b
has
a
global
minimum
at
b
and
a
global
maximum
at
a.
Proof.
This
follows
from
the
polynomial
representation
of
Proposition
4.4
by
direct
computation.

Corollary
4.6.
Let
N
be
a
positive
integer.
Write
φN
for
the
Green’s
function
of
the
N
−1
divisor
i=0
[
Ni
].
Then
the
Fourier
expansion
of
φN
is
given
by:
φN
(θ)
=

1
·
4π
2
·
N
0=n∈Z
1
1
2πinθ·N
e
=
φ1
(N
·
θ)
2
n
N
1
In
particular,
φN
(0)
=
12·N
(where
we
recall
that
we
think
of
the
values
of
φ1
as
being
1
1
in
“log(q)”
units)
is
the
maximum
value
attained
by
φN
,
and
φN
(
2N
)
=
−
24N
is
the
minimum
value
attained
by
φ1
.
Proof.
The
assertion
concerning
the
Fourier
expansion
follows
by
adding
up
the
translates
of
the
Fourier
expansion
of
Proposition
4.4.
The
assertions
concerning
the
maximum
and
minimum
values
of
φN
follow
by
thinking
of
φN
(θ)
as
N1
·
φ1
(N
·
θ).

Note
that
the
use
of
Green’s
functions
allows
one
to
construct
metrized
line
bundles
with
arbitrary
prescribed
restrictions
to
the
special
ﬁber
of
E∞
.
Indeed,
suppose
we
start
out
with
two
horizontal
divisors
D1
,
D2
⊆
E∞
,
both
of
degree
d
(on
E∞
|US
).
Then
consider
the
metrized
line
bundle
def
L
=
OE∞
(D1
+
gD1
−
gD2
)
The
restriction
of
L
to
a
component
of
the
special
ﬁber
of
E∞
,
which
amounts
to
the
curvature
hL
of
L
evaluated
at
the
point
of
S1
corresponding
to
that
component,
is
given
(cf.
Deﬁnition
4.2)
by:
132
hL
=
δD1
−
Δ(gD1
)
+
Δ(gD2
)
=
hD1
+gD1
−
hD2
+gD2
+
δD2
=
d
−
d
+
δD2
=
δD2
i.e.,
despite
the
fact
that
on
the
generic
ﬁber
E∞
|US
of
E∞
,
L
is
just
the
line
bundle
associated
to
the
divisor
D1
,
on
the
special
ﬁber
of
E∞
,
L
looks
as
if
it
is
the
line
bundle
associated
to
the
divisor
D2
!
This
sort
of
metrized
line
bundle
will
play
a
key
role
in
this
paper.
§5.
Theta
Groups
and
Metrized
Line
Bundles
We
maintain
the
notation
of
§4.
Let
d
be
a
positive
integer;
g
∈
Func(S1
).
In
this
§,
we
would
like
to
study
the
metrized
line
bundle
on
E∞
given
by:
def
L
=
OE∞
(d[e]
+
g)
(where
e
∈
E∞
(S∞
)
is
the
origin
of
the
group
object
E∞
→
S∞
,
and
[e]
is
the
horizontal
divisor
deﬁned
by
its
image).
In
particular,
we
will
discuss
the
case
where
the
theta
groups
of
§1
act
on
L,
and
compute
(when
the
base
is
global)
the
degree
of
the
push-forward
of
L
to
such
a
global
base.
We
observe
that
although
the
issue
of
the
behavior
of
theta
groups
for
degenerating
elliptic
curves
is
also
discussed
in
[MB],
it
is
the
opinion
of
the
author
that
the
use
of
Zhang’s
theory
of
metrized
line
bundles
substantially
clariﬁes
the
behavior
of
theta
groups
for
degenerating
elliptic
curves.
Note
ﬁrst
of
all
that
when
we
restrict
to
US
,
we
are
in
the
situation
discussed
in
§1.
In
particular,
there
is
a
theta
group
(GL
)US
associated
to
OE|US
(d
·
[e]).
The
group
scheme
(KL
)US
of
d-torsion
points
of
E|US
ﬁts
into
an
exact
sequence
0
→
(μd
)US
→
(KL
)US
→
(Z/dZ)US
→
0
Although
this
exact
sequence
does
not
extend
over
S,
if
one
base-changes
to
S∞
,
then
it
extends
naturally
to
an
exact
sequence
of
group
schemes
over
S∞
:
0
→
μd
|S∞
→
KL
|S∞
→
(Z/dZ)|S∞
→
0
where
KL
|S∞
⊆
E∞
is
a
closed
subgroup
scheme.
In
fact,
this
exact
sequence
splits,
so
we
have
a
noncanonical
isomorphism
KL
|S∞
∼
=
{μd
×
(Z/dZ)}|S∞
In
the
following,
we
will
denote
KL
|S∞
by
133
KL
Thus,
the
action
of
KL
on
E∞
preserves
the
line
bundle
L|US
.
We
would
like
to
investigate
the
extent
to
which
it
preserves
L:
Proposition
5.1.
The
action
of
KL
on
E∞
preserves
L
if
and
only
if
translation
by
1
1
1
1
1
d
∈
d
Z/Z
⊆
S
on
S
preserves
the
curvature
hL
.
We
shall
call
such
distributions
on
S
d-invariant.
For
instance,
if
g
=
d
·
φ1
or
g
=
d
·
φ1
−
φd
(cf.
Corollary
4.6),
then
the
resulting
curvature
will
be
d-invariant.
Proof.
The
automorphisms
of
S1
induced
by
the
action
of
KL
on
E∞
are
precisely
those
given
by
adding
(integer)
multiples
of
d1
.
Thus,
the
necessity
of
the
condition
hL
(θ)
=
hL
(θ
+
d1
)
is
clear.
To
see
that
it
is
suﬃcient,
we
reason
as
follows.
First
of
all,
since
SN
is
regular
of
dimension
2,
it
suﬃces
to
prove
the
result
in
characteristic
0,
i.e.,
in
the
case
where
O
is
a
ﬁnite
extension
of
Q.
But
then
KL
is
étale
over
S∞
,
so
it
suﬃces
to
prove
that
the
“physical”
automorphisms
of
E∞
induced
by
S∞
-rational
points
of
KL
preserve
L.
Let
α
be
such
an
automorphism
of
E∞
that
induces
the
automorphism
θ
→
θ
+
d1
def
on
S1
.
Then
Lα
=
α∗
L
is
a
metrized
line
bundle
on
E∞
which
is
isomorphic
to
L
over
US
.
Moreover,
by
hypothesis,
hL
=
hLα
.
Thus,
by
Proposition
4.3,
it
follows
that
L
and
Lα
diﬀer
by
a
constant
C
∈
R.
If
this
constant
C
∈
Q,
then
multiplying
by
q
C
shows
that
L
∼
=
Lα
.
If
not,
then
since
α
has
order
d,
it
follows
that
C
deﬁnes
a
class
in
H
1
(Z/dZ,
R/Q)
=
Hom(Z/dZ,
R/Q)
=
0.
In
order
words,
it
follows
from
the
fact
that
the
automorphism
α
has
ﬁnite
order
(while
R/Q
is
torsion-free)
that
C
∈
Q,
so
L
∼
=
Lα
,
as
desired.
Thus,
it
remains
to
see
that
if
g
=
d
·
φ1
or
dφ1
−
φd
,
then
hL
is
invariant
under
θ
→
θ
+
d1
.
But
if
g
=
d
·
φ1
,
then
hL
is
a
constant,
so
this
is
clear.
Moreover,
φd
itself
is
invariant
under
θ
→
θ
+
d1
,
so
adding
Δ(φd
)
does
not
eﬀect
the
invariance
under
θ
→
θ
+
d1
.
This
completes
the
proof.

Thus,
if
hL
is
d-invariant,
then
by
considering
pairs
(α,
ι),
where
α
is
a
point
of
KL
and
ι
:
Tα∗
L
∼
=
L
(cf.
§1),
we
obtain
a
theta
group
scheme
GL
over
S∞
which
extends
(GL
)US∞
.
In
particular,
if
f
:
E∞
→
S∞
is
the
structure
morphism,
then
we
may
deﬁne
the
push-forward
f∗
L
134
as
the
(quasi-coherent)
OS
-submodule
of
the
rank
d
vector
bundle
(f
|US
)∗
(L|US
)
on
US∞
consisting
of
sections
whose
absolute
value
is
≤
1
with
respect
to
the
|−|Lp
for
all
p
∈
Q/Z.
Then
f∗
L
is
equipped
with
a
natural
action
of
GL
.
Since
it
is
not
diﬃcult
to
construct
a
GL
-module
V
which
is
a
rank
d
vector
bundle
on
S∞
and
on
which
Gm
⊆
GL
acts
via
the
standard
character
(cf.
Example
1.2),
it
follows
(cf.
Theorem
1.1
of
§1;
[MB],
Chapitre
V,
Corollaire
2.4.3)
that
f∗
L
∼
=
M
⊗OS∞
V
Here,
M
and
its
restriction
MU
to
US∞
satisfy
the
following:
MU
is
a
line
bundle
on
US∞
;
and
M
is
a
quasi-coherent
OS∞
-submodule
of
j∗
MU
(where
j
:
US∞
→
S∞
is
the
natural
inclusion).
Note
that
since
US∞
is
quasi-compact
and
MU
(being
a
line
bundle)
is
of
ﬁnite
presentation,
it
follows
that
MU
arises
as
the
pull-back
of
a
line
bundle
on
some
USN
.
Thus,
MU
extends
to
a
line
bundle
M
on
S∞
.
In
fact,
we
may
even
assume
that
M
⊆
M
(in
such
a
way
that
M
|US
=
M|US
).
Next,
let
us
observe
that
M
is
bounded
in
the
sense
that
there
exists
some
positive
rational
number
C
such
that
M
⊆
M
⊆
q
−C
·
M
(Indeed,
this
follows
from
the
fact
that
L
itself
is
“bounded.”)
Moreover,
M
has
the
property
that
a
rational
section
of
M
is
integral
over
S∞
if
and
only
if
it
is
integral
over
US∞
as
well
as
at
the
central
prime
V
({q
r
}r∈Q>0
)
⊆
S∞
.
Since
the
localization
of
A∞
at
the
central
prime
is
a
valuation
ring
with
value
group
Q,
it
thus
follows
that
M
is
of
the
form
M=

q
−r
·
M
r0
≤r∈Q
where
r0
∈
R≥0
.
In
other
words,
the
datum
of
M
is
equivalent
to
the
datum
of
MU
,
together
with
a
metric
on
MU
at
the
central
prime
of
S∞
.
Deﬁnition
5.2.
We
shall
refer
to
as
a
metrized
vector
bundle
on
S∞
any
pair
(F,
|
−
|F
)
consisting
of
a
vector
bundle
F
on
US∞
,
together
with
a
metric
on
F
at
the
central
prime
of
S∞
.
The
rank
of
a
metrized
vector
bundle
(F,
|
−
|F
)
is
deﬁned
to
be
the
rank
of
the
vector
bundle
F.
If
(F,
|
−
|F
)
is
a
metrized
vector
bundle,
then
by
considering
the
sheaf
of
(nonzero)
sections
of
F
whose
|
−
|F
≤
1
at
the
central
prime,
we
naturally
obtain
a
quasi-coherent
OS∞
-module.
Moreover,
it
follows
from
the
discussion
of
metrics
at
the
beginning
of
§4
–
i.e.,
“metrics
are
equivalent
to
bounded,
saturated
submodules
that
generate
over
the
quotient
ﬁeld”
–
that
the
metric
|
−
|F
may
be
recovering
from
this
quasi-coherent
module.
135
In
other
words,
metrized
vector
bundles
may
be
thought
of
as
a
special
kind
of
quasi-coherent
OS∞
-module.
On
the
other
hand,
any
vector
bundle
F
on
S∞
(in
the
usual
sense)
naturally
deﬁnes
a
metrized
vector
bundle
on
S∞
(FU
,
|
−
|FU
)
as
follows:
we
let
FU
be
the
restriction
of
F
to
US∞
;
|
−
|FU
be
the
metric
corresponding
to
the
module
of
integral
sections
at
the
central
prime
of
S∞
.
Thus,
the
(nonzero)
sections
of
F
may
be
recovered
as
those
sections
of
FU
whose
|
−
|FU
≤
1
at
the
central
prime.
In
particular,
we
see
that
the
notion
of
a
metrized
vector
bundle
on
S∞
is
a
generalization
of
the
usual
notion
of
a
vector
bundle
on
S∞
.
def
Corollary
5.3.
Let
L
=
OE∞
(d[e]+g)
be
a
metrized
line
bundle
on
E∞
whose
curvature
hL
is
d-invariant.
Then
the
push-forward
sheaf
f∗
L
on
S∞
has
a
natural
structure
of
metrized
vector
bundle
of
rank
d
on
S∞
equipped
with
an
action
of
GL
.
Moreover,
there
exists
an
isomorphism
f∗
L
∼
=
M
⊗OS∞
V
of
GL
-modules
where
M
is
a
metrized
line
bundle
on
S∞
with
trivial
GL
-action,
and
V
is
a
vector
bundle
(in
the
usual
sense)
on
S∞
with
GL
-action
on
which
Gm
⊆
GL
acts
via
the
standard
character.
Finally,
if
L
is,
in
fact,
a
line
bundle
(i.e.,
is
the
metrized
line
bundle
arising
from
some
line
bundle
on
some
CN
),
then
f∗
L
(respectively,
M)
is
a
vector
bundle
(respectively,
line
bundle)
in
the
usual
sense.
Now
suppose
(just
for
the
remainder
of
this
paragraph)
that
L
is
symmetric,
i.e.,
preserved
(up
to
isomorphism)
by
the
automorphism
of
E∞
given
by
multiplication
by
−1.
It
is
easy
to
see
that
this
is
equivalent
to
the
assertion
that
the
curvature
hL
satisﬁes
hL
(−θ)
=
hL
(θ)
(cf.
the
proof
of
Proposition
5.1).
Then
(just
as
in
the
discussion
of
§1)
the
automorphism
[−1]
of
E∞
given
by
multiplication
by
−1
induces
an
automorphism
of
GL
.
Thus,
just
as
in
§1
(cf.
especially
the
discussion
following
Theorem
1.6),
if
α
∈
E∞
(S∞
)
is
any
S∞
-valued
point,
then
we
get
an
isomorphism
(of
metrized
vector
bundles
on
S∞
)
L|Tα∗
KL
∼
=
(L|α0
)
⊗OK
0
OKL
L
def
(where
KL0
=
KL
/2
·
KL
,
and
L|α0
is
the
line
bundle
on
KL0
obtained
by
descending
L|Tα∗
KL
).
Thus,
for
instance,
if
d
is
odd,
then
we
obtain
a
trivialization
of
the
restriction
of
L
to
the
subscheme
Tα∗
KL
.
In
particular,
restriction
to
Tα∗
KL
deﬁnes
(by
composing
with
the
above
isomorphism)
a
morphism
of
metrized
vector
bundles
on
S∞
with
GL
-action:
f∗
L
→
(L|α0
)
⊗OK
0
OKL
L
136
In
other
words,
this
morphism
allows
us
to
think
of
global
sections
of
L
over
E
as
being
(essentially)
functions
on
the
subscheme
Tα∗
KL
.
These
functions
may
thus
be
thought
of
as
a
sort
of
“metrized”
or
“Zhang-theoretic”
version
of
the
algebraic
theta
functions
of
[Mumf1,2,3].
The
following
standard
line
bundles
will
be
important
in
this
paper,
so
we
give
them
explicit
names.
First,
let
us
write
def
φev
d
(θ)
=
φd
(θ
+
1
)
2d
(notation
as
in
Corollary
4.6).
In
the
following,
the
objects
with
a
superscript
“ev”
(for
“even”)
will
be
important
in
the
case
when
d
is
even.
Nevertheless,
all
the
deﬁnitions
(of
both
the
objects
with
a
superscript
“ev”
and
the
objects
without
a
superscript
“ev”)
may
be
made
regardless
of
whether
d
is
even
or
odd.
Let
def
gst
=
d
·
φ1
−
φd
;
def
ev
gst
=
d
·
φ1
−
φev
d
(notation
as
in
Corollary
4.6).
Write
def
Lst
=
OE∞
(d[e]
+
gst
);
ev
def
ev
Lst
=
OE∞
(d[e]
+
gst
)
ev
In
other
words
(cf.
the
discussion
at
the
end
of
§4),
Lst
(respectively,
Lst
)
is
the
metrized
line
bundle
whose
restriction
to
the
special
ﬁber
of
C∞
looks
like
the
divisor
d−1

i
[
]
d
i=0
(respectively,
d−1

i=0
[(
1
i
)
+
(
)]
)
2d
d
In
particular,
it
is
easy
to
see
that
if
one
takes
a
point
α
∈
KL
(S∞
)
whose
image
under
the
projection
KL
→
(Z/dZ)
is
1
∈
Z/dZ,
and
a
point
β
∈
E∞
(S∞
)
such
that
2
·
β
=
α,
then
we
have
the
following:
d−1
ev
Lemma
5.4.
If
d
is
odd,
then
Lst
∼
=
OE∞
(
i=0
[i
·
α]).
If
d
is
even,
then
Lst
∼
=
d−1
OE∞
(
i=0
[β
+
i
·
α]).
Proof.
Indeed,
one
calculates
easily
that
both
sides
are
isomorphic
generically
and
have
the
same
curvatures.
(Note
here
that
in
the
case
of
d
even,
if
one
does
not
shift
by
β,
then
both
sides
will
not
even
be
isomorphic
generically.
Indeed,
they
will
diﬀer
generically
by
a
line
bundle
of
order
precisely
2.)
Thus,
we
conclude
by
Proposition
4.3
that
the
two
sides
diﬀer
by
some
OE∞
(C),
for
C
∈
R
a
constant.
But
now
observe
(cf.
Proposition
4.4)
that
ev
gst
(respectively,
gst
)
takes
rational
values
on
Q/Z.
On
the
other
hand,
for
any
irreducible
component
p
of
the
special
ﬁber
of
E∞
,
the
order
ordp
at
p
of
a
rational
function
on
E∞
137
d−1
d−1
whose
divisor
on
E∞
|US
is
d[e]
−
i=0
[i
·
α]
(respectively,
d[e]
−
i=0
[β
+
i
·
α])
lies
in
Q.
Thus,
it
follows
that
C
may
be
taken
to
be
in
Q,
hence
(by
multiplying
by
q
C
)
it
may
be
taken
to
be
0.
Thus,
the
two
metrized
line
bundles
are
isomorphic,
as
desired.

Note,
in
particular,
that
if
d
is
odd
(respectively,
even),
then
there
exists
a
section
s
ev
of
f∗
Lst
(respectively,
f∗
Lst
)
whose
order
ordp
at
any
prime
p
∈
Q/Z
⊆
S1
is
precisely
0.
Indeed,
such
an
s
is
given
by
applying
the
isomorphism
of
Lemma
5.4
to
the
section
given
by
the
natural
inclusion
d−1

OCd
⊆
OCd
(
d−1

[i
·
α])
(respectively,
OCd
⊆
OCd
(
i=0
[β
+
i
·
α]))
i=0
It
is
clear
that
this
section
is
nonzero
at
all
the
nodes
of
Cd
,
hence
at
every
prime
p
∈
Q/Z,
as
desired.
Lemma
5.5.
Suppose
that
L
=
OE∞
(d[e]
+
g),
where
g
=
gst
+
ψ
(respectively,
ev
g
=
gst
+
ψ)
if
d
is
odd
(respectively,
even),
and
ψ
∈
Func(S1
)
is
≥
0
and
d-invariant
on
S1
.
Suppose,
moreover,
that
ψ
vanishes
at
some
point
of
Q/Z.
Then
the
natural
ev
identiﬁcation
between
f∗
L
and
f∗
Lst
(respectively,
f∗
Lst
)
over
US∞
extends
to
an
equality
f∗
L
=
f∗
Lst
ev
(resp
f∗
L
=
f∗
Lst
)
over
S∞
.
Proof.
To
simplify
notation,
we
assume
in
this
proof
that
d
is
odd.
(The
even
case
is
entirely
similar.)
Now
note
that
because
ψ
is
d-invariant,
it
follows
that
GL
acts
on
both
f∗
L
and
f∗
Lst
.
Thus,
(cf.
Corollary
5.3)
it
follows
that
for
some
r
∈
R,
we
have:
f∗
L
=
q
−r
·
f∗
Lst
(i.e.,
the
metrics
on
the
two
sides
diﬀer
by
a
factor
of
er
).
Since
ψ
≥
0,
it
follows
that
r
≥
0.
Suppose
that
r
>
0.
Then
if
s
is
any
section
of
f∗
Lst
,
then
there
exists
a
rational
number
>
0
such
that
q
−
·
s
forms
an
integral
section
of
f∗
L.
Now
suppose
that
ψ
vanishes
at
the
point
p
of
Q/Z.
By
the
preceding
discussion,
there
exists
an
s
such
that
s
does
not
vanish
(as
a
section
of
Lst
)
at
p.
Thus,
q
−
·
s
does
not
deﬁne
an
integral
section
of
Lst
at
p.
On
the
other
hand,
since
ψ(p)
=
0,
it
follows
that
Lst
and
L
have
the
same
integral
structure
at
p.
Thus,
q
−
·
s
is
not
integral
for
L
at
p
–
a
contradiction.
This
completes
the
proof.

138
Theorem
5.6.
Suppose
that
L
=
OE∞
(d[e]
+
g),
where
g
=
gst
+
ψ
(respectively,
g
=
ev
+
ψ)
if
d
is
odd
(respectively,
even),
and
ψ
∈
Func(S1
)
is
d-invariant
on
S1
.
Let
gst
def
r0
=
inf
1
ψ(α)
α∈S
ev
Then
the
natural
identiﬁcation
between
f∗
L
and
f∗
Lst
(respectively,
f∗
Lst
)
over
US∞
extends
to
an
equality
f∗
L
=
q
−r0
·
f∗
Lst
ev
(respectively,
f∗
L
=
q
−r0
·
f∗
Lst
)
ev
(i.e.,
the
metric
on
f∗
L
is
e−r0
times
the
metric
on
f∗
Lst
(respectively,
f∗
Lst
))
over
S∞
.
Proof.
For
simplicity,
we
assume
that
d
is
odd.
First,
consider
the
case
where
r0
∈
Q
and
there
exists
an
α
∈
Q/Z
such
that
ψ(α)
=
r0
.
Then
by
multiplying
through
by
q
r0
we
see
that
we
reduce
to
the
case
r0
=
0.
Moreover,
the
hypotheses
of
Lemma
5.5
are
satisﬁed,
so
we
see
that
the
result
follows
from
Lemma
5.5.
This
completes
the
case
where
r0
∈
Q
and
∃α
∈
Q/Z
such
that
ψ(α)
=
r0
.
To
handle
the
general
case,
one
simply
approximates
ψ
by
piecewise
linear
functions
ψi
in
Func(S1
)
which
satisfy
the
hypotheses
of
the
preceding
paragraph.
As
ψi
→
ψ,
it
is
clear
that
the
metric
on
the
resulting
f∗
Li
converges
to
the
metric
on
the
original
f∗
L
(corresponding
to
ψ).
This
completes
the
proof.

Corollary
5.7.
Suppose
that
L
=
OE∞
(d[e]
+
d
·
φ1
).
Then
we
have
(on
S∞
)
1
f∗
L
=
q
24d
·
f∗
Lst
1
ev
(respectively,
f∗
L
=
q
24d
·
f∗
Lst
)
if
d
is
odd
(respectively,
even).
def
Proof.
For
simplicity,
we
assume
that
d
is
odd.
Then
we
have
ψ
=
d
·
φ1
−
gst
=
φd
.
1
Moreover,
by
Corollary
4.6,
the
r0
(as
in
Theorem
5.6)
for
this
ψ
is
equal
to
−
24d
.
Thus
Corollary
5.7
follows
from
Theorem
5.6.

Next,
we
would
like
to
switch
gears,
and
consider
the
following
situation.
Suppose
that
we
are
given
a
ﬁnite
ﬂat
covering
B
→
(M1,0
)Z
which
is
étale
over
(M1,1
)Q
(i.e.,
away
from
the
divisor
at
inﬁnity
and
ﬁnite
primes).
For
simplicity,
we
will
also
assume
that
B
is
regular,
and
that
the
completion
of
B
at
the
139
inverse
image
of
the
divisor
at
inﬁnity
of
(M1,0
)Z
is
a
disjoint
union
of
“SN
’s”
as
in
the
above
discussion
(for
some
appropriate
N
and
base
ring
O).
Let
us
write
IB
for
the
set
of
connected
components
of
this
union.
Thus,
for
each
ι
∈
IB
,
we
have
a
completion
Bι
∼
=
SNι
,
where
SNι
is
understood
to
be
over
a
base
ring
Oι
.
Let
EB
⊆
CB
→
B
be
the
tautological
log
elliptic
curve
over
B.
Also,
let
us
write
UB
⊆
B
for
the
complement
of
the
divisor
at
inﬁnity
of
B.
By
gluing
together
EB
|UB
and
(E∞
)ι
at
each
ι,
we
thus
obtain
a
smooth
group
scheme
E∞,B
→
B∞
over
B∞
.
(Thus,
strictly
speaking,
B∞
is
an
algebraic
stack
in
the
ﬁnite,
ﬂat
topology.)
Then
let
us
observe
that
one
can
glue
together
the
theory
discussed
above
over
“S”
with
the
usual
theory
of
line
bundles
and
vector
bundles
on
EB
and
B
to
obtain
a
theory
of
metrized
line
bundles
on
E∞,B
and
metrized
vector
bundles
on
B∞
.
Indeed,
we
shall
not
write
out
the
routine
details,
but
the
point
is
that
a
metrized
line
bundle
on
E∞,B
is
a
line
bundle
on
E∞,B
|UB
,
together
with
a
metric
on
the
pull-back
of
this
line
bundle
to
each
E∞,B
|US∞,ι
(where
we
use
the
notation
“US∞,ι
”
relative
to
the
understanding
that
each
Bι
∼
=
SNι
has
its
associated
US∞,ι
⊆
S∞,ι
→
SNι
,
etc.).
Similarly,
a
metrized
vector
bundle
on
B∞
is
a
vector
bundle
on
UB
,
together
with
a
metric
on
the
pull-backs
of
this
vector
bundle
to
each
US∞,ι
.
Thus,
if
we
are
given,
for
each
ι
∈
IB
,
a
function
gι
∈
Func(S1ι
)
then
we
may
form
a
metrized
line
bundle
def
LB
=
OE∞,B
(d[e]
+

gι
)
ι
in
the
obvious
way.
If
we
then
push-forward
this
line
bundle
via
fB
:
E∞,B
→
B∞
,
we
obtain
a
metrized
vector
bundle
(fB
)∗
LB
whose
local
structure
was
studied
in
Corollary
5.3
and
Theorem
5.6
above.
In
particular,
let
us
note
that
it
makes
sense
to
speak
of
the
degree
of
a
metrized
vector
bundle
on
B∞
.
140
This
degree
will,
in
general,
be
a
real
number.
There
are
many
ways
that
one
can
deﬁne
this
degree.
For
instance,
one
may
deﬁne
it
as
the
degree
of
the
metrized
line
bundle
which
is
the
determinant
of
the
given
metrized
vector
bundle.
Thus,
it
suﬃces
to
deﬁne
the
degree
of
a
metrized
line
bundle
on
B∞
.
But
a
metrized
line
bundle
on
B∞
can
easily
be
seen
to
be
equivalent
(up
to
torsion)
to
an
element
of
Pic(B)
⊗Z
R.
Thus,
the
degree
of
a
metrized
line
bundle
may
be
deﬁned
by
tensoring
(over
Z
with
R)
the
usual
degree
map
Pic(B)
→
Pic(BQ
)
→
Z
on
the
smooth
proper
curve
BQ
.
Here,
because
(M1,0
)Z
is
an
algebraic
stack,
and
B
is
a
covering
of
this
stack,
it
is
each
to
get
confused
about
“what
units”
the
degree
is
measured
in.
In
this
paper,
we
adopt
the
convention
of
expressing
all
degrees
in
“log(q)”
units.
In
other
words,
in
these
units,
the
degree
of
the
divisor
at
inﬁnity
of
(M1,0
)Z
is
equal
to
1.
Theorem
5.8.
Let
d
be
an
odd
(respectively,
even)
positive
integer,
and
suppose
that
we
are
given
functions
gι
∈
Func(S1ι
)
def
def
ev
)ι
)
is
d-invariant.
for
each
ι
∈
IB
such
that
ψι
=
gι
−
(gst
)ι
(respectively,
ψι
=
gι
−
(gst
Let
def
rι
=
inf
1
ψι
(α)
α∈Sι
and
def
LB
=
OE∞,B
(d[e]
+

gι
);
ι
def
(Lst
)B
=
OE∞,B
(d[e]
+

(gst
)ι
)
ev
def
(respectively,
(Lst
)B
=
OE∞,B
(d[e]
+
ι

ev
(gst
)ι
))
ι
Then
the
natural
identiﬁcation
of
push-forwards
between
(fB
)∗
LB
and
(fB
)∗
(Lst
)B
(reev
spectively,
(fB
)∗
(Lst
)B
)
over
UB
extends
to
an
equality

qι−rι
)
·
(fB
)∗
(Lst
)B
(fB
)∗
LB
=
(
ι
141

ev
(respectively,
(fB
)∗
LB
=
(
qι−rι
)
·
(fB
)∗
(Lst
)B
)
ι
(i.e.,
the
metric
on
(fB
)∗
LB
at
ι
is
e−rι
times
the
metric
on
(fB
)∗
(Lst
)B
(respectively,
ev
(fB
)∗
(Lst
)B
))
over
S∞
.
Moreover,
we
have
deg((fB
)∗
LB
)
=
−

1
(d
−
1)
+
d
·
rι
24
ι
where
the
degree
is
in
“log(q)”
units.
Proof.
The
assertion
concerning
integral
structures
is
a
formal
consequence
of
Theorem
5.6.
Moreover,
this
assertion
concerning
integral
structures
allows
one
to
immediately
ev
reduce
the
assertion
concerning
degrees
to
the
“standard
cases”
of
(Lst
)B
,
(Lst
)B
.
In
these
cases,
the
assertion
concerning
the
degree
is
an
immediate
consequence
of
GrothendieckRiemann-Roch.
We
will
carry
out
this
computation
in
the
following
paragraph.
Before
doing
this,
however,
we
note
that
when
working
with
metrized
line
bundles,
one
does
not
necessarily
get
the
correct
answer
if
one
applies
Grothendieck-Riemann-Roch
to
an
arbitrary
metrized
line
bundle,
since
for
an
arbitrary
metrized
line
bundle,
“R1
(fB
)∗
”
is
not
well-deﬁned
(i.e.,
one
might
get
various
“analytic
torsion
eﬀects”).
This
is
why
we
ev
reduced
to
the
“standard
cases”
(Lst
)B
,
(Lst
)B
which
are
(by
Lemma
5.4),
in
fact,
line
bundles
in
the
usual
sense
(whose
R1
(fB
)∗
is
zero)
over
any
covering
of
(M1,0
)Z
over
which
the
d-torsion
points
of
E∞,B
become
rational.
Let
us
ﬁrst
treat
the
case
of
d
odd.
The
case
of
d
even
is
quite
similar,
and
we
will
remark
at
the
end
of
the
proof
what
must
be
modiﬁed
in
this
case.
By
Grothendieck-Riemann-Roch,
we
have
1
deg((fB
)∗
LB
)
=
deg(R(fCB
)∗
OCB
)
+
[LB
]
·
([LB
]
−
[ωE
])
2
def
(where
fCB
:
CB
→
B
is
the
structure
morphism;
we
take
LB
=
(Lst
)B
;
and
we
use
brackets
“[−]”
to
denote
the
Chern
class
of
a
line
bundle).
Here,
ωE
denotes
the
line
bundle
on
B
given
by
considering
the
invariant
diﬀerentials
on
EB
.
Then
Serre
duality
gives:
deg(R(fCB
)∗
OCB
)
=
deg(ωE
)
Next,
we
compute
the
various
intersection
numbers
that
appear
by
using
the
intersection
theory
of
compactiﬁed
divisors
reviewed
in
§4.
First
of
all,
since
ωE
is
a
line
bundle
on
B
⊗12
(as
opposed
to
CB
),
and
ωE
is
well-known
to
be
isomorphic
to
the
line
bundle
associated
to
the
divisor
at
inﬁnity,
we
have
142
[LB
]
·
[ωE
]
=
d
·
deg(ωE
)
=
d
12
Next,
we
have
[LB
]
·
[LB
]
=
d
·
[LB
]
·
[e]
+
S1
gst
·
hLst
On
the
other
hand,
[LB
]
·
[e]
=
d
·
[e]2
+
gst
(0)
=
−d
·
deg(ωE
)
+
d
·
φ1
(0)
−
φd
(0)
1
1
1
1
=−
=
−d
·
(
)
+
(d
−
)
·
12
d
12
12d
while
S1
gst
·
hLst
=
d−1

i
gst
(
)
=
d
·
φd
(0)
−
d
·
φd
(0)
=
0
d
i=0
1
,
so
Thus,
we
obtain
that
[LB
]2
=
−
12
deg((fB
)∗
LB
)
=
1
1
1
·
(2
−
1
−
d)
·
=
−
(d
−
1)
2
12
24
as
desired.
def
ev
Finally,
we
consider
the
case
of
d
even.
In
this
case,
we
take
LB
=
(Lst
)B
.
It
is
then
immediate
that
[LB
]
·
[ωE
]
=
d
12
(just
as
in
the
odd
case).
Thus
the
only
intersection
number
that
remains
to
be
computed
is
[LB
]2
.
We
have
[LB
]
·
[LB
]
=
d
·
[LB
]
·
[e]
+
Moreover,
143
S1
ev
gst
·
hLev
st
ev
[LB
]
·
[e]
=
d
·
[e]2
+
gst
(0)
=
−d
·
deg(ωE
)
+
d
·
φ1
(0)
−
φev
d
(0)
1
=
−d
·
deg(ωE
)
+
d
·
φ1
(0)
−
φd
(
)
2d
1
1
1
1
=
=
−d
·
(
)
+
(d
+
)
·
12
2d
12
24d
while
S1
ev
gst
·
hLev
=
d−1

st
ev
gst
(
i=0
=
d
·
φd
(
i
1
+
)
2d
d
1
1
1
1
)
−
d
·
φd
(0)
=
φ1
(
)
−
φ1
(0)
=
−
−
2d
2
24
12
1
1
1
1
)−
24
−
12
=
−
12
(just
as
in
the
odd
case),
as
desired.
This
completes
Thus,
[LB
]2
=
d·(
24d
the
proof
in
the
even
case.

Bibliography
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer
(1990).
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
University
Press
(1985).
[MB]
L.
Moret-Bailly,
Pinceaux
de
variétés
abéliennes,
Astérisque
129,
Soc.
Math.
France
(1985).
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deﬁning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
2
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
[Mumf4]
D.
Mumford,
Abelian
Varieties,
Oxford
University
Press
(1974).
[Mumf5]
D.
Mumford,
An
Analytic
Construction
of
Degenerating
Abelian
Varieties
over
Complete
Rings,
Appendix
to
[FC].
[Zh]
S.
Zhang,
Admissible
pairing
on
a
curve,
Invent.
Math.
112
(1993),
pp.
171-193.
144
Chapter
V:
The
Evaluation
Map
§0.
Introduction
In
this
Chapter,
we
prepare
for
the
proof
of
the
Comparison
Isomorphism
(which
is
the
main
topic
of
this
paper)
in
Chapter
VI
by
studying
the
morphism
which
is
to
be
the
“comparison
isomorphism.”
We
refer
to
this
morphism
as
the
evaluation
map.
Our
study
of
the
evaluation
map
consists
of
several
parts.
First,
we
must
set
up
the
notation
and
deﬁne
the
evaluation
map.
This
is
done
in
§1,
2,
3.
The
evaluation
map
essentially
consists
of
restricting
global
sections
of
a
certain
natural
metrized
line
bundle
on
the
universal
extension
of
an
elliptic
curve
to
the
torsion
points
of
the
elliptic
curve.
In
§1,
we
discuss
the
deﬁnition
of
the
natural
metrized
line
bundles
that
we
use,
and
in
§2,
we
construct
and
study
the
elementary
properties
of
the
“evaluation
map.”
In
§3,
we
observe
that
the
“étale-integral
structures”
deﬁned
in
Chapter
III,
§6,
are
deﬁned
for
arbitrary
elliptic
curves
(i.e.,
not
just
for
degenerating
elliptic
curves,
as
in
the
discussion
of
Chapter
III,
§6),
and,
moreover,
that
the
functions
in
these
étale-integral
structures
assume
integral
values
at
the
torsion
points
appearing
in
the
deﬁnition
of
the
evaluation
map.
This
integrality
property
will
be
important
in
the
proof
of
the
comparison
isomorphism
in
Chapter
VI.
After
we
have
deﬁned
the
evaluation
map,
we
commence
our
study
of
the
extent
to
which
it
is
an
isomorphism.
We
begin,
in
§4,
by
studying
the
extent
to
which
a
certain
version
of
the
evaluation
map
deﬁned
for
degenerating
elliptic
curves
is
an
isomorphism
modulo
various
powers
of
the
q-parameter.
This
essentially
amounts
to
studying
the
extent
to
which
the
twisted
Schottky-Weierstrass
zeta
functions
of
Chapter
IV,
§3,
satisfy
linear
relations
modulo
various
powers
of
the
q-parameter.
It
turns
out
that
the
calculations
of
linear
relations
that
we
carry
out
in
this
§
will
yield
the
key
technical
machinery
behind
the
main
result
of
this
paper.
Next,
in
§5,
we
study
the
determinant
of
the
evaluation
map
in
the
case
when
the
base
of
the
spectrum
of
an
algebraically
closed
ﬁeld.
We
then
use
the
theory
of
§5
to
determine,
in
§6,
precisely
when
the
evaluation
map
is
an
isomorphism
for
“suﬃciently
generic”
elliptic
curves.
§1.
Construction
of
Certain
Metrized
Line
Bundles
In
this
§,
we
continue
the
discussion
of
Chapter
IV,
§4,5,
on
metrized
line
bundles.
In
particular,
we
introduce
certain
speciﬁc
metrized
line
bundles
which
we
will
need
in
order
to
construct
the
evaluation
maps
of
§2
below.
These
metrized
line
bundles
L
are
natural
in
the
sense
that
(it
is
not
diﬃcult
to
show
that)
they
may
be
uniquely
characterized
(up
to
tensor
product
with
a
line
bundle
pulled
back
from
the
base)
by
the
following
two
conditions:
145
(i.)
They
are
symmetric
up
to
torsion
(i.e.,
the
pull-back
of
L
via
the
“multiplication
by
−1”
map
of
an
elliptic
curve
diﬀers
from
L
by
a
line
bundle
which
deﬁnes
a
torsion
element
of
the
Picard
group),
of
relative
degree
d.
(ii.)
Their
curvatures
(at
inﬁnity)
are
invariant
with
respect
to
and
“concentrated
at”
(in
the
sense
of
“delta
functions”)
the
d-torsion
points
to
which
we
will
restrict
them
when
we
consider
“evaluation
maps”
in
§2.
Condition
(ii.)
is
natural
considering
that
the
main
purpose
of
constructing
these
line
bundles
is
to
restrict
them
(and
their
sections)
to
the
subscheme
of
d-torsion
points
of
an
elliptic
curve.
In
fact,
the
“concentrated
at”
part
of
Condition
(ii.)
is
inessential
in
the
sense
that,
by
Chapter
IV,
Theorem
5.6,
even
if
the
curvature
is
not
concentrated
at
the
d-torsion
points,
the
push-forward
of
the
metrized
line
bundle
–
which
is
what
we
are
ultimately
interested
in
–
is
the
same
as
that
of
the
“maximal
metrized
subsheaf
inside
the
original
line
bundle
among
those
subsheaves
which
are
concentrated
at
the
d-torsion
points.”
Let
m
≥
1
be
an
integer.
We
would
like
to
consider
the
moduli
of
pairs
(E
→
S,
η
∈
E(S))
where
E
→
S
is
an
elliptic
curve,
and
η
∈
E(S)
generates
a
cyclic
subgroup
of
order
m
in
1
E.
Over
Z[
m
],
there
is
no
problem
in
deﬁning
an
algebraic
stack
of
such
pairs.
Moreover,
it
follows
from
the
theory
of
[KM],
Chapter
5
(cf.
especially
Theorem
5.1.1),
that
this
stack
extends
(uniquely)
to
a
ﬁnite,
ﬂat
covering
B
→
(M1,0
)Z
1
of
proper
algebraic
stacks
over
Z
which
is
étale
over
Z[
m
]
away
from
the
divisor
at
inﬁnity;
1
near
inﬁnity,
is
obtained
by
adjoining
some
q
r
,
where
r
divides
m
to
the
ring
of
integers
in
some
cyclotomic
extension
of
Q;
and,
at
primes
dividing
m,
parametrizes
“points
of
exact
order
m.”
Moreover,
the
stack
B
is
regular.
In
particular,
B
satisﬁes
the
hypotheses
of
the
discussion
following
Chapter
IV,
Corollary
5.7.
Next,
let
d
be
a
positive
integer.
Then
let
us
recall
the
metrized
line
bundles
def
(Lst
)B
=
OE∞,B
(d[e]
+

(gst
)ι
)
ι
ev
def
(Lst
)B
=
OE∞,B
(d[e]
+

ι
146
ev
(gst
)ι
)
(where
e
is
the
origin
of
the
group
object
fB
:
E∞,B
→
B∞
;
ι
ranges
over
the
connected
ev
=
d
·
φ1
−
φev
components
of
the
divisor
at
inﬁnity
of
B;
and
gst
=
d
·
φ1
−
φd
,
gst
d
are
the
“standard
Green’s
functions”
studied
in
Chapter
IV,
§4,5)
of
Chapter
IV,
Theorem
5.8.
Recall
from
the
theory
of
Chapter
IV,
§4,5
(especially
Chapter
IV,
Lemma
5.4),
that
on
each
S1ι
(i.e.,
the
“limit”
of
the
set
of
irreducible
components
of
the
semi-stable
models
ev
over
the
component
at
inﬁnity
ι),
(Lst
)B
(respectively,
(Lst
)B
)
looks
like
the
(line
bundle
associated
to)
the
divisor
d−1

i
[
]
d
i=0
(respectively,
d−1

[(
i=0
i
1
)
+
(
)]
)
2d
d
on
S1ι
.
Finally,
in
Chapter
IV,
Theorem
5.8,
we
showed
that
if
d
is
odd
(respectively,
even),
then
deg((fB
)∗
(Lst
)B
)
=
−
1
1
ev
(d
−
1)
(respectively,
deg((fB
)∗
(Lst
)B
)
=
−
(d
−
1)
)
24
24
in
“log(q)”
units.
Next,
let
us
observe
that
from
the
deﬁnition
of
the
moduli
stack
B,
we
have
a
tautological
m-torsion
point
η
∈
E∞,B
(B)
For
each
ι,
one
then
has
a
divisor
ρι
(η)
∈
Div(S1ι
)
given
by
the
unique
point
of
(Q/Z)ι
⊆
S1ι
deﬁned
by
η
at
ι.
Let
us
denote
this
unique
point
by
ηι
∈
(Q/Z)ι
⊆
S1ι
.
Thus,
ρι
(η)
=
[ηι
].
Now,
if
d
is
odd
(respectively,
even),
then
let
us
consider
the
divisor
d−1

d−1
i


i

[ηι
+
]
−
[
]
∈
Div(S1ι
)
d
d
i=0
i=0
(respectively,
i


i

1
+
]
−
[ηι
+
[
]
∈
Div(S1ι
)
)
2d
d
d
i=0
i=0
d−1

d−1
Let
us
write
φηι
(respectively,
φev
ηι
)
for
the
Green’s
function
associated
to
this
divisor
(cf.
∂2φ
the
discussion
preceding
Chapter
IV,
Proposition
4.4).
Thus,
Δ(φηι
)
=
−
∂θ2ηι
(where
147
θ
is
the
standard
coordinate
on
S1ι
)
is
equal
to
the
delta
distribution
associated
to
this
divisor.
Moreover,
by
Chapter
IV,
Corollary
4.5,
the
function
φηι
is
piecewise
linear
on
S1ι
,
d-invariant
(i.e.,
φηι
(θ
+
d1
)
=
φηι
(θ)),
and
attains
its
maximum
at
the
points
ηι
+
di
1
(respectively,
ηι
+
2d
+
di
),
and
its
minimum
at
the
points
di
,
for
i
=
0,
.
.
.
,
d
−
1.
Indeed,
it
follows
immediately
from
the
deﬁnitions
that
φηι
(θ)
=
1
1
φd·ηι
,0
(d
·
θ)
(respectively,
φev
ηι
(θ)
=
φd·ηι
+
12
,0
(d
·
θ)
)
d
d
where
φ??,0
(θ)
is
the
function
considered
in
Chapter
IV,
Corollary
4.5.
Let
us
deﬁne
def
ψηι
(θ)
=
φηι
(θ)
−
φηι
(0)
def
ev
(respectively,
ψηevι
(θ)
=
φev
ηι
(θ)
−
φηι
(0)
)
Thus,
ψηι
≥
0
(respectively,
ψηevι
≥
0)
on
S1ι
;
ψηι
(0)
=
0
(respectively,
ψηevι
(0)
=
0).
We
are
now
ready
to
deﬁne
the
metrized
line
bundles
which
are
the
main
topic
of
the
present
§.
Let

def
ψηι
)
(Lst,η
)B
=
{Tη∗
((Lst
)B
)}
⊗OE∞,B
OE∞,B
(
ι

ev
ev
def
(respectively,
(Lst,η
)B
=
{Tη∗
((Lst
)B
)}
⊗OE∞,B
OE∞,B
(
ψηevι
)
)
ι
(where
Tη
:
E∞,B
→
E∞,B
is
the
morphism
given
by
translation
by
η
∈
E∞,B
(B)).
Note
that
the
curvature
of
this
metrized
line
bundle
at
ι
is
given
by:
δ
d−1
i=0

−
Δ(ψη
)
=
δ
d−1
[ηι
+
di
]
(respectively,
δ
d−1
i=0
ι
i=0

[
di
]

−
Δ(ψ
ev
)
=
δ
d−1
1
[ηι
+
2d
+
di
]
ηι
i=0
)
[
di
]
ev
That
is
to
say,
although,
over
US
,
Lst,η
(respectively,
Lst,η
)
is
“twisted,”
i.e.,
diﬀers
from
ev
(Lst
)B
(respectively,
(Lst,η
)B
)
by
translation
by
η,
“metrically
speaking”
(i.e.,
in
the
special
ﬁbers
at
inﬁnity)
it
looks
as
though
it
was
never
twisted
by
translation
by
η
(respectively,
1
or
even
by
the
“
2d
’s”
on
the
S1ι
’s
at
inﬁnity).
Now
Chapter
IV,
Theorems
5.6,
5.8,
imply
the
following:
Proposition
1.1.
If
d
is
odd
(respectively,
even),
then
the
automorphism
of
E∞,B
given
by
translation
by
η
induces
a
natural
equality:
148
(fB
)∗
(Lst,η
)B
=
(fB
)∗
(Lst
)B
ev
ev
(respectively,
(fB
)∗
(Lst,η
)B
=
(fB
)∗
(Lst
)B
)
1
of
metrized
vector
bundles
on
B∞
.
In
particular,
deg((fB
)∗
(Lst,η
)B
)
=
−
24
(d
−
1)
(reev
1
spectively,
deg((fB
)∗
(Lst,η
)B
)
=
−
24
(d
−
1)).
Remark.
We
note
here,
for
future
reference,
that
Proposition
1.1
implies
that
1
1
1

i)
+
deg((fB
)∗
(Lst,η
)B
)
=
−d
·
{d(d
−
1)
+
(d
−
1)}
=
−
d(d2
−
1)
−
(
12
i=0
24
24
d−1
d·
if
d
is
odd
(respectively,
1
1
1

ev
i)
+
deg((fB
)∗
(Lst,η
)B
)
=
−d
·
{d(d
−
1)
+
(d
−
1)}
=
−
d(d2
−
1)
−
(
12
i=0
24
24
d−1
d·
if
d
is
even).
This
computation
will
be
of
fundamental
importance
in
the
proof
of
the
comparison
isomorphism
in
Chapter
VI.
Note,
moreover,
that
since
the
ψηι
’s
are
d-invariant,
one
can
glue
together
the
theories
of
theta
groups
discussed
in
Chapter
IV,
§1,
and
Chapter
IV,
§5,
to
obtain
a
theta
group
G(Lst
)B
=
G(Lst,η
)B
(if
d
is
odd)
which
ﬁts
into
an
exact
sequence
1
→
(Gm
)B
→
G(Lst
)B
=
G(Lst,η
)B
→
K(Lst
)B
=
K(Lst,η
)B
→
1
where
K(Lst
)B
=
K(Lst,η
)B
is
the
kernel
of
multiplication
by
d
on
E∞,B
.
Naturally,
the
equality
of
metrized
vector
bundles
in
Proposition
1.1
is,
in
fact,
an
equality
of
modules
ev
ev
over
this
group
scheme
G(Lst
)B
=
G(Lst,η
)B
.
Similar
statements
hold
for
(Lst
)B
,
(Lst,η
)B
,
if
d
is
even.
Next,
let
us
compute
some
intersection
numbers
(cf.
the
theory
of
Chapter
IV,
§4,5).
Proposition
1.2.
Suppose
that
τ
is
any
d-torsion
point
∈
E∞,B
(T
)
(i.e.,
d
·
τ
=
0)
over
some
B-scheme
T
,
where
T
→
B
is
a
ﬁnite,
ﬂat
covering
that
satisﬁes
the
same
hypotheses
as
B
(i.e.,
the
hypotheses
in
the
discussion
following
Chapter
IV,
Corollary
5.7).
Suppose
that
d
is
odd;
then
we
have
149
[τ
]
·
(Lst,η
)B
=
−
1

φ1
(−d
·
ηι
)
d
ι
i.e.,
[τ
]
·
(Lst,η
)B
=
0
if
m
does
not
divide
d;
[τ
]
·
(Lst,η
)B
=
−
1
12d
(in
“log(q)”
units)
if
m
divides
d.
Suppose
that
d
is
even;
then
we
have
ev
[τ
]
·
(Lst,η
)B
=
−
1

1
φ1
(−d
·
ηι
+
)
d
ι
2
(in
“log(q)”
units).
Proof.
For
simplicity,
we
shall
assume
that
d
is
odd.
The
even
case
is
entirely
similar.
The
only
diﬀerence
is
that,
unlike
in
the
odd
case,
the
sum
that
one
obtains
in
the
even
1
if
m
case
cannot
be
described
in
“closed
form”
(i.e.,
“=
0
if
m
does
not
divide
d,
=
−
12d
divides
d”).
By
the
above
discussion
on
theta
groups,
it
follows
that
for
some
line
bundle
N
on
T
such
that
N
⊗d
∼
=
OT
,
we
have:
Tτ∗
((Lst,η
)B
)
=
((Lst,η
)B
)
⊗OT
N
Since
[τ
]
·
[N
]
=
0,
it
thus
suﬃces
to
consider
the
case
T
=
B;
τ
=
e
(i.e.,
the
origin
of
E∞,B
).
Since
ψηι
(0)
=
0,
it
follows
that
[e]
·
[(Lst,η
)B
]
=
[e]
·
Tη∗
[(Lst
)B
]
=
[−η]
·
[(Lst
)B
]

=
d
·
[−η]
·
[e]
+
[−ηι
]
·
(dφ1
−
φd
)
ι
=
d
·
[−η]
·
[e]
+

[−ηι
]
·
φ1
−
ι
1

[−d
·
ηι
]
·
φ1
)
·
d
ι
(where
in
the
ﬁnal
equality,
we
use
the
fact
that
φd
(θ)
=
d1
·
φ1
(d
·
θ)
(cf.
Chapter
IV,
Corollary
4.6)).
150
Next,
let
us
observe
that
since
the
curvature
at
each
ι
of
the
metrized
line
bundle
OE∞,B
(e
+
φ1
)
is
(constant,
hence)
m-invariant,
it
follows
(cf.
Chapter
IV,
Proposition
5.1)
that
the
m2
-th
power
of
OE∞,B
(e
+
φ1
)
is
stabilized
by
translation
by
η
and
d
·
η
(cf.
the
discussion
at
the
beginning
of
the
proof
involving
the
line
bundle
“N
”).
On
the
other
hand,
[OE∞,B
(e
+
φ1
)]
·
[e]
=
[e]2
+
φ1
(0)
=
−
1
+
φ1
(0)
=
0
12
Thus,
we
obtain
that
0
=
[OE∞,B
(e
+
φ1
)]
·
[−η]
=
[OE∞,B
(e
+
φ1
)]
·
[−d
·
η]
This
implies,
in
particular,
that
the
expression
in
large
brackets
in
the
above
equalities
concerning
[e]
·
[(Lst,η
)B
]
vanishes.
Thus,
in
summary,
we
have:
1

[−d
·
ηι
]
·
φ1
[e]
·
[(Lst,η
)B
]
=
−
·
d
ι
1

=−
·
φ1
(−d
·
ηι
)
d
ι
=
1
[e]
·
[−d
·
η]
d
But
note
that
−d
·
η
=
e
if
and
only
if
m
divides
d.
Moreover,
since
−d
·
η
is
a
torsion
1
point,
it
follows
that
[e]
·
[−d
·
η]
is
0
if
−d
·
η
=
e,
and
−
12
if
−d
·
η
=
e.
This
completes
the
proof.

Finally,
we
note
the
following
consequence
of
the
above
discussion:
Suppose
that
ev
m
=
2d.
Write
L
for
(Lst,η
)B
(respectively,
(Lst,η
)B
)
if
d
is
odd
(respectively,
even).
Note
that
the
fact
that
m
=
2d
implies
that
L
is
symmetric.
Thus,
we
can
use
the
action
of
the
theta
group
GL
to
construct
algebraic
theta
functions
(cf.
Chapter
IV,
§1;
Chapter
IV,
the
discussion
following
Corollary
5.3),
as
follows.
If
α
∈
E∞,B
(T
)
is
any
T
-valued
point
for
a
B-scheme
T
as
in
Proposition
1.2,
then
we
get
an
isomorphism
(of
metrized
vector
bundles
on
T∞
)
L|Tα∗
KL
∼
=
(L|α0
)
⊗OK
0
OKL
L
def
(where
KL0
=
KL
/2
·
KL
,
and
L|α0
is
the
metrized
line
bundle
on
KL0
×B
T
obtained
by
descending
L|Tα∗
KL
).
Thus,
for
instance,
if
d
is
odd,
then
we
obtain
a
trivialization
of
the
151
restriction
of
L
to
the
subscheme
Tα∗
KL
.
In
particular,
restriction
to
Tα∗
KL
deﬁnes
(by
composing
with
the
above
isomorphism)
a
morphism
of
metrized
vector
bundles
on
T∞
with
GL
-action:
(fB
)∗
L|T
→
(L|α0
)
⊗OK
0
OKL
L
For
instance,
if
T
=
B,
and
α
=
e,
then
we
get
a
morphism
(fB
)∗
L
→
(L|e0
)
⊗OK
0
OKL
L
i.e.,
this
morphism
allows
us
to
think
of
global
sections
of
L
over
E∞,B
as
being
(essentially)
functions
on
the
B-ﬁnite
scheme
KL
.
§2.
The
Deﬁnition
of
the
Evaluation
Map
In
this
§,
we
set
up
the
morphism
which
will
be
the
principal
topic
of
the
comparison
isomorphism
to
be
proven
in
Chapter
VI.
Roughly
speaking,
this
morphism
is
the
morphism
given
by
evaluating
global
sections
of
an
ample
line
bundle
on
the
universal
extension
of
a
(log)
elliptic
curve
at
the
torsion
points
of
the
universal
extension.
Let
d
≥
1
be
an
integer.
Suppose
that
S
log
is
a
ﬁne
noetherian
scheme,
and
let
C
log
→
S
log
be
a
log
elliptic
curve
over
S
log
such
that
the
“divisor
at
inﬁnity”
D
⊆
S
(i.e.,
the
pullback
of
the
divisor
at
inﬁnity
of
(M1,0
)Z
via
the
classifying
morphism
S
→
(M1,0
)Z
)
is
a
Cartier
divisor
(i.e.,
locally
deﬁned
by
a
non-zero
divisor)
on
S.
Also,
let
us
assume
that
étale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root.
Next,
observe
that
by
pulling
back
the
corresponding
objects
in
the
universal
case,
we
obtain
E
→
S;
E∞,S
→
S∞
(cf.
Chapter
IV,
§4,5).
By
considering
objects
which
are
(étale
locally
on
S)
obtained
by
def
pulling
back
metrized
line
bundles
on
the
tautological
E∞,M
over
M
=
(M1,0
)Z
(cf.
the
theory
of
Chapter
IV,
§4,5),
we
obtain
a
notion
of
“metrized
line
bundles
on
E∞,S
.”
We
leave
the
routine
details
of
the
precise
formulation
of
this
notion
to
the
reader.
Let
152
L
be
a
metrized
line
bundle
on
E∞,S
of
relative
degree
d
whose
curvatures
at
all
the
components
of
D
are
d-invariant
(cf.
Chapter
IV,
Proposition
5.1).
In
fact,
ultimately
we
will
mainly
be
interested
in
the
cases
where
S
is
a
covering
B
(as
in
the
discussion
following
Chapter
IV,
Corollary
5.7),
or
an
object
derived
from
such
a
B
(i.e.,
a
completion/localization
of
such
a
B;
a
point
of
such
a
B,
etc.),
and
where
L
is
one
of
the
bundles
ev
“Lst,η
”
or
“Lst,η
”
of
§1
(or
the
pull-back
of
this
bundle
to
an
object
derived
from
such
a
B).
Next,
we
introduce
some
new
notation.
Recall
the
universal
extension
E
†
→
E
of
the
log
elliptic
curve
E
(cf.
Chapter
III,
Deﬁnition
1.2).
Recall
that
the
S-group
scheme
E
†
is
an
extension
of
E
by
the
aﬃne
group
scheme
WE
corresponding
to
the
line
bundle
ωE
.
Then
for
n
≥
1
an
integer,
let
us
denote
by
⎛
WE
−→
⎜
⏐
⏐n·
†
def
E[n]
=
lim
⎜

−→
⎝
E†
⎞
⎟
⎟
⎠
WE
†
the
WE
-torsor
E[n]
→
E
obtained
by
applying
a
“push-out”
to
this
extension
via
the
morphism
n·
:
WE
→
WE
given
by
multiplication
by
n.
Note
that
it
follows
from
the
deﬁnitions
that
the
morphism
d·
:
E
†
→
E
†
(“multipli†
cation
by
d”)
factors
through
E[d]
.
Thus,
we
get
a
homomorphism
†
E[d]
→
E
†
of
group
schemes
over
S
which
induces
an
isomorphism
(since
d·
induces
multiplication
by
†
d
on
W
)
between
W
⊆
E
and
W
⊆
E
†
.
Put
another
way,
this
morphism
exhibits
E
E
[d]
E
†
the
WE
-torsor
E[d]
as
the
pull-back
to
E
via
the
multiplication
by
d
map
on
E
of
the
†
W
-torsor
E
†
.
Moreover,
since
E
†
extends
naturally
to
a
W
-torsor
E
→
C
(Chapter
E
E
C
III,
Corollary
4.3),
and
the
morphism
“multiplication
by
d”
on
E
extends
naturally
to
a
morphism
Cd
→
C
(i.e.,
Cd
is
the
semi-stable
model
of
E
over
S
with
d
irreducible
components
in
the
special
ﬁber
–
cf.
the
notation
of
Chapter
IV,
§4),
we
thus
obtain
(by
†
pulling
back
EC
→
C
via
Cd
→
C)
a
natural
WE
-torsor
†
ECd
,[d]
→
Cd
†
extending
the
WE
-torsor
E[d]
→
E
over
E
⊆
Cd
.
Note
that
the
restriction
153
†
EEd
,[d]
→
Ed
†
of
ECd
,[d]
to
Ed
⊆
Cd
(i.e.,
the
complement
of
the
nodes
of
Cd
–
cf.
the
notation
of
Chapter
IV,
§4)
has
a
natural
structure
of
group
scheme
over
S
with
respect
to
which
the
†
†
homomorphism
E
→
E
†
considered
above
extends
to
a
homomorphism
E
→
E†.
[d]
Ed
,[d]
On
the
other
hand,
since
E∞,S
is
obtained
by
removing
the
nodes
of
an
object
C∞,S
,
†
which,
in
turn,
is
obtained
by
blowing
up
Cd
,
we
thus
see
that
the
WE
-torsor
ECd
,[d]
→
Cd
†
restricts
to
an
object
EC∞,S
,[d]
→
C∞,S
,
which,
in
turn,
restricts
to
an
object
def
†
†
E∞,[d]
=
EE∞,S
,[d]
→
E∞,S
†
(which
extends
(EEd
,[d]
→
Ed
)
×S
S∞
).
Let
us
denote
the
kernel
of
the
homomorphism
Ed
→
E
(i.e.,
the
open
version
of
the
morphism
Cd
→
C
considered
above)
by
d
E
⊆
Ed
It
follows
from
the
assumption
concerning
the
existence
of
roots
of
the
Tate
parameter
that
d
E
forms
a
ﬁnite,
ﬂat
group
scheme
over
S.
Lemma
2.1.
There
is
a
natural
subgroup
scheme
dE
†
⊆
E†
Cd
,[d]
which
maps
isomorphically
to
d
E
⊆
Cd
.
†
Proof.
Indeed,
observe
that
the
homomorphism
EEd
,[d]
→
E
†
ﬁts
into
the
following
commutative
diagram:
0
−→
0
−→
†
WE
−→
EEd
,[d]
⏐
⏐
⏐
⏐

id
WE
−→
E†
−→
Ed
⏐
⏐

−→
0
−→
E
−→
0
†
where
the
vertical
arrow
on
the
left
is
the
identity.
Thus,
we
conclude
that
EEd
,[d]
→
E
†
is
ﬁnite
and
ﬂat,
and
that
its
kernel
maps
isomorphically
down
to
the
kernel
of
Ed
→
E,
which
is
simply
d
E
(cf.
the
discussion
at
the
beginning
of
Chapter
IV,
§3).

154
We
are
now
ready
to
deﬁne
the
evaluation
map,
which
is
the
main
topic
of
this
§,
and,
indeed,
of
this
paper.
By
abuse
of
notation,
let
us
write
fS
for
all
structure
morphisms
of
objects
over
S∞
down
to
S∞
.
If
n
≥
1
is
an
integer,
let
us
denote
by
(fS
)∗
(L|
†
)<n
E∞,[d]
the
subsheaf
of
(fS
)∗
(L|
†
)
consisting
of
those
sections
whose
torsorial
degree
<
n
(cf.
E∞,[d]
Chapter
III,
Deﬁnition
2.2).
Thus,
(fS
)∗
(L|
†
)<n
forms
a
metrized
vector
bundle
on
E∞,[d]
S∞
of
rank
d
·
n
(cf.
the
theory
of
Chapter
IV,
§5).
Moreover,
this
metrized
bundle
admits
a
natural
action
of
the
theta
group
GL
associated
to
L.
†
On
the
other
hand,
for
α
∈
E
†
(S)
⊆
E∞,[d]
(S∞
),
let
us
consider
the
push-forward
to
S∞
of
the
restriction
of
the
metrized
line
bundle
L
on
E∞,S
to
the
(result
of
base-changing
†
⊇)
T
∗
(d
E
†
)
∼
by
S∞
→
S
the)
subscheme
(E
=
T
∗
(d
E)
⊆
Ed
:
α
Ed
,[d]
α
(fS
)∗
(L|
†
)
Tα∗
(d
E∞
)
†
def
(where
d
E∞
=
d
E
†
×S
S∞
;
“T??
”
denotes
“translation
by
??”).
One
sees
easily
that
2
L|
†
forms
a
metrized
vector
bundle
on
S∞
of
rank
d
.
Moreover,
since
the
action
of
Tα∗
(d
E∞
)
GL
on
L
covers
the
action
of
KL
=
d
E
on
Tα∗
(d
E),
we
thus
see
that
this
metrized
vector
bundle
admits
a
natural
action
of
the
theta
group
GL
.
†
Proposition
2.2.
Under
the
above
conditions,
restriction
of
sections
over
E∞,[d]
to
the
†
†
subscheme
Tα∗
(d
E∞
)
⊆
E∞,[d]
deﬁnes
a
natural
morphism
ΞL,d,α
:
(fS
)∗
(L|
†
E∞,[d]
)<d
→
(fS
)∗
(L|
†
)
Tα∗
(d
E∞
)
of
metrized
vector
bundles
of
rank
d2
on
S∞
which
is
compatible
with
the
actions
of
the
theta
group
GL
on
both
sides.
(When
the
various
subscripts
of
Ξ
are
ﬁxed
in
a
discussion,
they
will
often
be
omitted,
especially
in
the
case
where
α
is
taken
to
be
the
origin.)
The
main
purpose
of
this
paper
is
to
investigate
the
extent
to
which
this
restriction
morphism
ΞL,d,α
is
an
isomorphism.
Next,
suppose
that
155
H
⊆
GL
is
a
Lagrangian
subgroup
scheme
(cf.
Chapter
IV,
Deﬁnition
1.3
–
note
that
the
theory
of
Lagrangian
subgroups
reviewed
in
Chapter
IV,
§1,
extends
immediately
to
the
metrized
case).
Let
KH
⊆
KL
∼
=
KH
.)
Let
=
d
E
⊆
Ed
be
the
image
of
H
in
KL
.
(Thus,
H
∼
def
E∞H
,S
=
E∞,S
/(KH
)S∞
def
(where
(KH
)S∞
=
KH
×S
S∞
).
Note
that
the
immediate
extension
of
Chapter
IV,
Theorem
1.4,
to
the
metrized
case
shows
that
there
exists
a
metrized
line
bundle
LH
(of
relative
degree
1)
on
E∞H
,S
(deﬁned
by
H
⊆
GL
).
Write
d
EH
def
=
d
E/KH
(so
d
EH
×S
S∞
⊆
E∞H
,S
).
Thus,
d
EH
is
a
ﬁnite
ﬂat
group
scheme
over
S.
Next,
observe
that
since
KH
⊆
d
E
is
annihilated
by
d,
it
follows
that
the
ﬁnite
morphism
Cd
→
C
considered
above
(which
compactiﬁes
multiplication
by
d)
factors
(uniquely)
as
a
composite
Cd
→
CH
→
C
of
ﬁnite
morphisms,
where
CH
is
S-ﬂat,
and,
after
base-change
via
S∞
→
S
and
restriction
def
to
US
=
S
−
D,
the
morphism
Cd
→
CH
may
be
identiﬁed
with
the
morphism
E∞,S
→
†
†
E∞H
,S
.
Thus,
since
E∞,[d]
→
E∞,S
is
obtained
from
ECd
,[d]
→
Cd
which,
in
turn,
is
†
obtained
by
pulling
back
EC
→
C
via
Cd
→
C,
it
follows
that
we
obtain
natural
WE
torsors
†
ECH
,[d]
→
CH
;
†
E∞H
,[d]
→
E∞H
,S
†
†
whose
pull-backs
to
Cd
,
E∞,S
may
be
identiﬁed
with
ECd
,[d]
→
Cd
,
E∞,[d]
→
E∞,S
.
Note,
moreover,
that
(it
is
immediate
from
the
deﬁnitions
that)
the
lifting
E
†
of
E
deﬁnes
a
d
d
lifting
†
†
d
E∞H
⊆
E∞H
,[d]
†
of
d
EH
×S
S∞
⊆
E∞H
,S
.
Finally,
let
us
write
αH
for
the
image
of
α
in
E∞H
,[d]
(S∞
).
156
Thus,
by
taking
the
H-invariants
of
the
domain
and
range
of
ΞL,d,α
in
Proposition
2.2
(and
applying
the
immediate
extension
of
Chapter
IV,
Theorem
1.4,
to
the
metrized
case),
we
obtain
the
following:
†
Proposition
2.3.
Under
the
above
conditions,
restriction
of
sections
over
E∞H
,[d]
to
the
†
†
subscheme
Tα∗
(d
E∞H
)
⊆
E∞H
,[d]
deﬁnes
a
natural
morphism
:
(fS
)∗
(LH
|
†
ΞH
L,d,α
E∞
)<d
→
(fS
)∗
(LH
|
†
Tα∗
(d
E∞H
)
H
,[d]
)
H
of
metrized
vector
bundles
of
rank
d
on
S∞
which
may
be
identiﬁed
with
the
morphism
obtained
from
the
restriction
map
ΞL,d,α
of
Proposition
2.2
by
taking
H-invariants.
Since,
in
this
case,
taking
H-invariants
is
a
faithful
operation
(cf.
Chapter
IV,
Theorem
1.4),
it
follows
that,
for
instance,
the
bijectivity
of
ΞL,d,α
is
equivalent
to
that
of
ΞH
.
L,d,α
Often,
it
will
be
technically
easier
to
analyze
the
restriction
morphism
Ξ
after
taking
H-invariants.
Finally,
to
prepare
for
§5,
6
below,
we
consider
the
dependence
of
Ξ
on
α.
Let
w
be
a
section
of
WE
.
Then
note
that
translation
by
w
induces
natural
identiﬁcations
Tw∗
(L|
†
E∞,[d]
)
=
L|
†
;
E∞,[d]
Tw∗
(LH
|
†
E∞
)
=
LH
|
†
E∞
H
,[d]
H
,[d]
Thus,
translation
by
w
eﬀects
automorphisms
Tw∗
of
the
metrized
vector
bundles
(fS
)∗
(L
†
(fS
)∗
(LH
|
†
)<d
;
E∞,[d]
E∞
)<d
H
,[d]
which
are
unipotent
with
respect
to
the
ﬁltration
(on
(fS
)∗
(−)<d
)
by
torsorial
degree.
In
other
words,
these
automorphisms
Tw∗
induce
the
identity
on
each
of
the
subquotients
(fS
)∗
(−)<i
/(fS
)∗
(−)<i−1
(for
i
∈
Z).
Indeed,
this
follows
immediately
from
the
deﬁnition
of
a
WE
-torsor.
Thus,
since
both
the
domain
and
range
of
the
morphisms
of
Proposition
2.2
(respectively,
2.3)
are
the
same
(i.e.,
not
just
isomorphic)
for
α
and
α
+
w,
it
makes
sense
to
compare
these
two
morphisms,
and,
in
particular,
to
compare
their
determinants.
Note,
moreover,
that
the
morphisms
of
Propositions
2.2
(respectively,
2.3)
for
α,
α
+
w
diﬀer
precisely
by
composition
with
the
automorphism
Tw∗
.
Thus,
we
obtain
the
following:
Lemma
2.4.
For
any
section
w
of
WE
,
we
have:
det(ΞL,d,α
)
=
det(ΞL,d,α+w
);
det(ΞH
)
=
det(ΞH
)
L,d,α
L,d,α+w
157
(where
“det(−)”
is
a
section
of
the
metrized
line
bundle
det(range)
⊗
det(domain)−1
on
S∞
).
§3.
Extension
of
the
Étale-Integral
Structure
In
this
§,
we
show
that
the
étale-integral
structures
“Ret
”
discussed
in
Chapter
III,
§6,
are
deﬁned
for
arbitrary
elliptic
curves
(i.e.,
not
just
for
degenerating
elliptic
curves,
as
in
the
discussion
of
Chapter
III,
§6),
and,
moreover,
are
that
the
functions
in
these
étaleintegral
structures
assume
integral
values
at
the
torsion
points
appearing
in
the
deﬁnition
of
the
evaluation
map.
It
will
be
relative
to
this
étale-integral
structure
(deﬁned
for
arbitrary
elliptic
curves)
that
we
will
prove
the
comparison
isomorphism
in
Chapter
VI.
We
work
with
the
notation
of
Chapter
III,
§5,
6.
Thus,
let
O
be
a
Zariski
localization
of
OK
,
where
K
is
a
ﬁnite
extension
of
Q.
Let
def
A
=
O[[q]];
def
S
=
Spec(A)
Then
we
have
a
one-dimensional
semi-abelian
scheme
E→S
over
S.
Roughly
speaking,
one
may
think
of
E
as
being
“Gm
/q
Z
.”
More
rigorously,
E
may
be
compactiﬁed
to
a
log
elliptic
curve
C
log
→
S
log
.
Moreover,
CS
(the
result
of
base
changing
C
to
the
q-adic
completion
S
of
S)
may
be
written
as
CS
=
C
∞
/Zet
S
Recall
that
in
Chapter
III,
§6,
we
used
the
natural
isomorphism
of
Chapter
III,
Theorem
5.6,
Corollary
5.9:
†
EC
|C
∞
∼
=
(WE
)S
×S
C
∞
S
S
to
deﬁne
a
new
integral
structure
Ret†
EC
on
R
†
⊗
Q
(cf.
Chapter
III,
Proposition
6.1).
If
one
trivializes
ωE
by
means
of
the
EC
section
d
log(U
),
then
we
may
write
158
WE
=
Spec(OS
[T
])
(where
T
is
the
indeterminate
corresponding
to
the
chosen
trivialization
of
ωE
).
The
new
integral
structure
was
obtained
by
essentially
adjoining
the
polynomials
def
T
[n]
=
1
T
(T
−
1)(T
−
2)
·
.
.
.
·
(T
−
(n
−
1))
n!
(for
n
∈
Z≥0
)
to
the
original
integral
structure.
Now
let
us
write
(for
d
≥
1
an
integer)
(Cd
)S
=
C
∞
/(d
·
Zet
)
def
S
Since
(Cd
)S
→
S
is
proper,
it
algebrizes
to
some
Cd
→
S.
Let
E
→
S
be
the
open
subscheme
of
Cd
obtained
by
removing
from
Cd
the
irreducible
components
of
the
special
ﬁber
(i.e.,
the
ﬁber
over
q
=
0)
that
do
not
contain
the
image
of
the
identity
element
eC
∞
∈
C
∞
(S)
of
C
∞
.
Let
Ed
→
S
denote
the
complement
of
the
nodes
of
the
special
S
S
S
ﬁber
of
Cd
.
Thus,
Ed
and
E
have
a
natural
structure
of
group
scheme
over
S,
and
E
is
a
semi-abelian
scheme
over
S.
Moreover,
let
us
observe
that
we
have
a
natural
ﬁnite
étale
covering
Ed
→
E
of
degree
d
which
compactiﬁes
to
a
ﬁnite
morphism
Cd
→
C.
Relative
to
the
notation
of
§2,
if
one
takes
“E”
in
loc.
cit.
to
be
E
(in
the
notation
of
the
present
discussion),
then
the
resulting
“Ed
”
(respectively,
“Cd
”)
in
the
notation
of
loc.
cit.
corresponds
to
Ed
(respectively,
Cd
)
in
the
present
discussion.
Moreover,
I
claim
that:
†
†
†
†
The
resulting
“E[d]
,”
“ECd
,[d]
”
of
loc.
cit.
correspond
to
EC
|C
,
EC
|E
d
d
in
the
notation
of
the
present
discussion.
Indeed,
to
prove
this,
one
reasons
as
follows:
The
multiplication
by
d
morphism
Ed
→
E
factors
as
the
composite
of
the
ﬁnite
étale
isogeny
Ed
→
E
under
consideration
with
some
other
ﬁnite
isogeny
E
→
E
(of
degree
d,
whose
kernel
may
be
naturally
identiﬁed
with
μd
).
Moreover,
the
push-forward
morphism
associated
to
the
isogeny
E
→
E
induces
a
natural
isomorphism
between
the
universal
extensions
of
E
and
E
(cf.
the
discussion
at
the
beginning
of
Chapter
IV,
§3).
Thus,
it
follows
that
the
pull-back
of
the
universal
extension
of
E
to
Ed
via
the
multiplication
by
d
map
may
be
identiﬁed
with
the
pull-back
of
the
universal
extension
of
E
to
Ed
via
the
ﬁnite
étale
isogeny
E
→
E
under
consideration.
159
†
On
the
other
hand,
the
former
pull-back
is,
by
the
deﬁnition
of
“E[d]
”
given
in
§2,
none
†
other
than
the
“E[d]
”
associated
to
Ed
.
(One
concludes
the
corresponding
statement
for
†
“ECd
,[d]
”
by
using
the
fact
that
the
complement
of
Ed
in
(the
normal
scheme)
Cd
is
of
codimension
2.)
This
completes
the
proof
of
the
claim.
Thus,
in
the
following,
we
will
write
E
†
Cd
,[d]
†
for
the
WE
-torsor
over
Cd
which
is
the
“ECd
,[d]
”
(in
the
notation
of
§2)
for
the
case
where
one
takes
“E”
(in
§2)
to
be
E
(in
the
notation
of
the
present
discussion).
In
particular,
we
see
that
by
pulling
back
the
new
integral
structure
of
Chapter
III,
Proposition
6.1,
on
Ret†
via
Cd
→
C,
we
obtain
a
new
integral
structure
EC
⊆R
†
Ret†
E
E
⊗Q
Cd
,[d]
Cd
,[d]
Moreover,
this
integral
structure
has
the
property
that:
If
f
is
any
section
of
Ret†
(over,
say,
Ed
),
then
the
restriction
of
f
E
Cd
,[d]
to
any
d-torsion
point
τ
∈
Ed
(S)
deﬁnes
an
integral
section
of
OS
.
Indeed,
pulling
everything
back
to
C
∞
,
we
see
this
amounts
to
the
observation
that
the
S
pull-backs
to
C
∞
of
the
d-torsion
points
of
Ed
have
coordinates,
relative
to
the
decompoS
†
∞∼
sition
EC
|C
=
(WE
)S
×S
C
∞
,
given
by
S
S
(β,
α
·
q
β
)
where
β
∈
Z,
and
α
is
a
d-th
root
of
unity.
(Indeed,
this
follows
from
Chapter
III,
Corollary
5.9,
and
the
fact
that
the
“q-parameter”
of
E
is
given
by
q
d
.)
Thus,
the
above
property
follows
from
the
fact
that
any
T
[n]
has
integral
values
at
β
∈
Z.
(In
fact,
for
β
∈
Z≥0
,


the
value
of
T
[n]
at
T
=
β
is
0
(if
β
<
n),
1
(if
β
=
n),
βn
(i.e.,
binomial
coeﬃcients,
if
β
>
n).)
Next,
let
us
observe
that
the
semi-abelian
scheme
E
→
S
is
universal
among
degenerating
one-dimensional
semi-abelian
schemes
whose
q-parameters
admit
a
d-th
root.
Thus,
what
we
have
done
above
already
deﬁnes
a
new
integral
structure
on
“R
†
”
for
any
EC
,[d]
d
degenerating
one-dimensional
semi-abelian
scheme
E
→
S
(for
which
the
base
S
is
Z-ﬂat)
160
whose
q-parameter
admits
a
d-th
root.
In
fact,
we
would
like
to
extend
this
new
integral
from
a
formal
neighborhood
of
the
divisor
at
inﬁnity
(where
the
new
structure
on
R
†
EC
,[d]
d
integral
structure
has
already
been
deﬁned)
to
the
whole
of
(M1,0
)Z
.
That
is
to
say,
in
the
following
discussion,
we
propose
to
do
the
following:
We
would
like
to
“p-adically
analytically
continue”
the
new
integral
⊗
Q”
from
a
formal
neighborhood
of
the
divisor
structure
on
“R
†
EC
,[d]
d
at
inﬁnity
to
the
whole
of
(M1,0
)Z
.
More
precisely,
given
any
one-dimensional
semi-abelian
scheme
ET
→
T
,
where
T
is
Z-ﬂat,
and
the
q-parameters
of
ET
→
T
are
non-zero
divisors
that
admit
d-th
roots,
we
would
like
to
deﬁne
a
new
integral
structure
on
the
associated
R
†
⊗
Q.
Clearly,
since
E(C
T
)d
,[d]
n
for
a
ﬁxed
n,
the
new
integral
structure
on
F
(R
†
E(C
⊗
Q)
diﬀers
from
the
integral
T
)d
,[d]
n
structure
deﬁned
by
F
(R
†
)
at
only
ﬁnitely
many
primes,
it
suﬃces
to
deﬁne
these
E(C
T
)d
,[d]
new
integral
structure
locally,
p-adically,
at
each
rational
prime
p.
Thus,
we
may
assume
that
T
is
a
Zp
-scheme.
Next,
let
us
observe
that
in
the
discussion
of
Chapter
III,
§6,
of
the
new
integral
structure
in
the
case
of
a
degenerating
ET
→
T
(i.e.,
Chapter
III,
Proposition
6.1),
the
key
object
that
we
needed
in
order
to
deﬁne
the
new
integral
structure
was
the
canoni†
cal
decomposition
E
|C
∞
∼
=
(WE
)
×
C
∞
,
i.e.,
the
canonical
section
κ
(cf.
Chapter
III,
C
S
S
S
S
Theorem
2.1).
It
is
precisely
because
this
canonical
section
is
only
deﬁned
in
a
formal
neighborhood
of
the
divisor
at
inﬁnity
that
the
discussion
of
Chapter
III,
§6
(i.e.,
Chapter
III,
Proposition
6.1)
could
only
be
carried
out
over
such
a
formal
neighborhood.
In
fact,
however,
careful
inspection
reveals
that
really,
for
a
ﬁxed
n,
in
order
to
deﬁne
F
n
(Ret†
)
E(C
T
)d
,[d]
N
at
a
ﬁxed
prime
p,
it
suﬃces
to
have
κ
only
modulo
p
,
for
some
suﬃciently
large
N
.
Moreover,
in
the
notation
of
the
above
discussion
in
the
degenerating
case,
if
we
let
G
⊆
C
∞
/(pN
·
d
·
Zet
)
S
be
the
group
scheme
over
S
obtained
by
removing
the
nodes
from
C
∞
/(pN
·d·Zet
),
then
we
S
get
a
ﬁnite
étale
covering
G
→
E
(of
degree
pN
)
with
the
property
that
κ
is
already
deﬁned
modulo
pN
after
pull-back
via
G
→
E
(or
over
the
compactiﬁcation
C
∞
/(pN
·d·Zet
)
→
Cd
).
S
Indeed,
this
follows
from
the
fact
that
1et
∈
Zet
acts
on
κ
by
κ
→
κ
+
1
(cf.
Chapter
III,
Theorem
5.6),
so
elements
of
pN
·
d
·
Zet
preserve
κ
modulo
pN
.
Note,
moreover,
that
since
the
isogeny
G
→
E
is
of
degree
pN
,
there
exists
an
isogeny
of
group
schemes
H
→
G
which
is
ﬁnite
of
degree
pN
such
that
the
composite
161
H→E
is
isomorphic
to
the
“multiplication
by
pN
”
map
on
E
over
US
=
Spec(A[q
−1
])
(⊆
S).
Thus,
in
summary,
The
canonical
section
κ
is
deﬁned
modulo
pN
after
pull-back
from
E
to
H.
With
these
preparatory
remarks
behind
us,
we
are
now
ready
to
begin
the
“analytic
continuation”
argument:
Analytic
Continuation
Argument:
Let
ET
→
T
be
a
family
of
elliptic
curves,
where
T
is
a
ﬁnite,
ﬂat
(hence,
in
particular,
aﬃne)
scheme
over
(M1,0
)Zp
(i.e.,
the
complement
of
the
divisor
at
inﬁnity
of
(M1,0
)Zp
).
To
simplify
the
discussion,
we
shall
also
assume
that
T
is
normal.
Write
HT
→
ET
for
the
isogeny
given
by
multiplication
by
pN
.
(Thus,
HT
is
abstractly
isomorphic
as
a
T
-scheme
to
ET
.)
†
†
Consider
the
torsor
ET,[d]
→
ET
(i.e.,
the
“E[d]
”
associated
to
ET
).
This
torsor
deﬁnes
a
class
η
∈
H
1
(ET
,
ωET
|ET
)
∼
=
OT
(where
the
“∼
=”
follows
from
relative
Serre
duality
for
the
morphism
ET
→
T
).
If
we
pull
this
class
back
to
HT
,
then
we
obtain
a
class
def
ηH
∈
E
=
H
1
(HT
,
ωET
|HT
)
where
E
is
a
line
bundle
on
T
.
I
claim
that
ηH
is
≡
0
modulo
pN
.
There
are
many
ways
to
verify
this
claim.
One
way
is
the
following:
Since
E
is
a
line
bundle
on
T
,
and
T
is
normal,
it
suﬃces
to
verify
that
ηH
vanishes
modulo
pN
after
restricting
ηH
to
the
p-adic
completion
OT,p
of
the
localization
of
T
at
any
generic
point
pT
of
T
⊗
Fp
.
On
the
other
hand,
the
discrete
valuation
ring
OT,pT
is
clearly
dominated
by
a
discrete
valuation
ring
which
arises
as
the
p-adic
completion
OW,pW
of
some
W
at
a
generic
point
pW
of
W
⊗
Fp
,
where
W
is
the
base
of
some
degenerating
elliptic
curve
whose
classifying
morphism
to
(M1,0
)Z
deﬁnes
a
162
ﬁnite
morphism
W
→
Spec(Zp
[[q]]).
On
the
other
hand,
for
bases
such
as
OW,pW
,
the
fact
that
ηH
vanishes
modulo
pN
follows
from
the
above
discussion
of
the
degenerating
case
(i.e.,
where
we
saw
that
the
canonical
section
κ
is
deﬁned
modulo
pN
after
pull-back
via
“H
→
E”).
This
concludes
the
proof
of
the
claim.
†
Thus,
the
ωE
-torsor
ET,[d]
→
ET
splits
modulo
pN
after
pull-back
via
HT
→
ET
.
We
would
like
to
show
that
this
torsor
not
only
splits
modulo
pN
,
but
that
it
admits
a
splitting
which
extends
the
canonical
splitting
κ
(modulo
pN
)
in
the
degenerating
case.
To
do
this,
we
must
characterize
the
canonical
splitting
κ
in
terms
that
make
sense
even
for
non†
degenerating
elliptic
curves.
We
do
this
as
follows:
Note
that
since
ET,[d]
has
a
structure
def
of
abelian
group
scheme
over
T
,
it
admits
an
action
by
Σ
=
{±1}.
Of
course,
HT
and
ET
are
also
commutative
group
schemes
over
T
,
hence
admit
natural
actions
by
Σ
=
{±1}.
Then
let
us
observe
that
since
the
canonical
splitting
κ
is
a
group
homomorphism
(cf.
Chapter
III,
Theorem
2.1),
it
commutes
with
the
respective
actions
of
Σ
=
{±1}.
Let
us
regard
the
line
bundle
ωET
on
T
as
an
OT
-module
with
Σ
action,
where
Σ
acts
via
the
tautological
character
Σ
→
{±1}
⊆
OT×
.
Then
it
follows
by
general
nonsense
that
the
†
obstruction
to
deﬁning
a
Σ-equivariant
splitting
of
ET,[d]
over
HT
modulo
pN
is
a
class
ηΣ
∈
H
1
(Σ,
ωET
⊗
(Z/pN
))
=
{ωET
⊗
(Z/pN
)}
⊗
(Z/2)
Moreover,
if
this
class
vanishes,
then
such
a
splitting
will
be
unique
modulo
H
0
(Σ,
ωET
⊗
(Z/pN
))
=
ker(2
:
ωET
⊗
(Z/pN
))
(i.e.,
modulo
the
kernel
of
multiplication
by
2
on
ωET
⊗
(Z/pN
)).
Thus,
we
would
like
to
see
that
ηΣ
vanishes.
Of
course,
this
is
only
a
problem
when
p
=
2.
In
this
case,
since
ωET
is
a
line
bundle
on
T
,
one
proves
that
ηΣ
vanishes
in
precisely
the
same
way
as
we
proved
above
that
ηH
vanishes
modulo
pN
–
i.e.,
by
reducing
to
the
degenerating
case,
where
we
know
the
result
to
be
true.
This
completes
the
proof
that
ηΣ
is
always
zero.
As
for
uniqueness,
in
general,
we
only
get
uniqueness
modulo
pN
−1
(of
course,
if
p
is
odd,
we
get
uniqueness
modulo
pN
).
However,
by
taking
N
suﬃciently
large
(e.g.,
one
larger
than
the
original
N
necessary
to
deﬁne
the
integral
structure),
this
is
not
a
problem.
This
uniqueness
thus
shows,
by
the
same
argument
as
that
used
above
to
prove
that
ηH
≡
0
modulo
pN
–
i.e.,
by
comparing
with
the
degenerating
case
–
that:
†
There
exists
a
splitting
of
the
torsor
ET,[d]
over
HT
modulo
pN
which
extends
the
canonical
splitting
κ
considered
in
the
degenerating
case
modulo
pN
−1
.
Thus,
by
taking
N
suﬃciently
large,
we
see
that
all
the
functions
“T
[i]
”
(for
i
<
our
ﬁxed
n)
may
be
deﬁned
modulo
a
suﬃciently
large
power
of
p
so
that
we
may
form
a
new
integral
structure
163
F
n
(Ret†
ET
,[d]
)⊆R
†
ET
,[d]
⊗Q
which
extends
the
integral
structure
of
Chapter
III,
Proposition
6.1
in
the
degenerating
case
–
at
least
after
pulling
back
from
ET
to
HT
.
But
then,
by
using
the
“OT,pT
’s,”
reduction
to
the
degenerating
case,
and
ﬁnite
ﬂat
descent
(of
coherent
sheaves)
for
the
morphism
HT
→
ET
,
it
is
easy
to
see
that
these
integral
structures
descend
back
down
to
ET
,
as
desired.
This
completes
the
“p-adic
analytic
continuation
argument.”
In
other
words,
we
have
proven
the
following:
Theorem
3.1.
Let
d
≥
1
be
an
integer.
Let
C
log
→
S
log
be
any
log
elliptic
curve
as
at
the
beginning
of
§2
–
i.e.,
the
associated
q-parameter
∈
OS
(where
S
is
the
completion
of
S
along
the
divisor
at
inﬁnity
D
⊆
S
deﬁned
by
C
log
→
S
log
)
is
a
non-zero
divisor
which,
étale
locally,
admits
a
d-th
root.
Suppose
further
that
S
is
Z†
(cf.
§2,
for
the
deﬁnition
of
ECd
,[d]
)
and
its
ﬁltration
ﬂat.
Then
the
resulting
R
†
E
Cd
,[d]
admit
natural
integral
structures
.
.
.
⊆
F
n
(Ret†
EC
,[d]
)
⊆
.
.
.
⊆
Ret†
EC
,[d]
d
where
F
n
(Ret†
d
⊆R
†
EC
,[d]
⊗Q
d
)
is
a
rank
n
vector
bundle
on
Cd
such
that
EC
,[d]
d
(F
n+1
/F
n
)(Ret†
)=
EC
,[d]
1
·
OCd
⊗OS
τE⊗n
n!
d
These
integral
structures
are
uniquely
characterized
by
the
properties
that
they
are
functorial
in
C
log
→
S
log
,
and
they
extend
the
integral
structures
deﬁned
in
the
degenerating
case
in
Chapter
III,
Proposition
6.1.
Finally,
the
functions
of
Ret†
assume
integral
values
EC
,[d]
d
†
at
the
d-torsion
points
of
ECd
,[d]
(S).
Proof.
It
remains
only
to
remark
that
the
ﬁnal
assertion
concerning
the
integrality
of
the
values
at
d-torsion
points
may
be
veriﬁed
for
normal
T
as
in
the
analytic
continuation
argument
above
by
checking
integrality
at
the
various
OT,pT
(where
pT
is
a
generic
point
164
of
T
⊗
Fp
).
Moreover
the
integrality
at
OT,pT
may
be
veriﬁed
by
reduction
to
the
degenerating
case,
where
it
has
already
been
veriﬁed
(cf.
the
discussion
following
Chapter
III,
Proposition
6.1).

Deﬁnition
3.2.
(Just
as
in
Chapter
III,
Deﬁnition
6.2)
the
integral
structures
denoted
by
a
superscript
“et”
will
be
referred
to
as
étale-integral,
or
et-integral,
structures.
That
is
to
say,
“et”
stands
for
“étale,”
and
is
the
same
as
the
“et”
in
Zet
.
In
particular,
the
“étale-integral
structure”
may
be
thought
of
as
the
integral
structure
arising
from
thinking
of
algebraic
functions
on
the
universal
extension
as
set-theoretic
functions
on
Zet
,
i.e.,
on
the
ﬁbers
of
the
inﬁnite
étale
covering
C
∞
→
C
∞
/Zet
=
CS
.
S
S
The
original
integral
structure
on
the
various
“R’s”
(i.e.,
the
integral
structures
without
a
label)
will
be
referred
to
as
the
de
Rham-integral,
or
DR-integral,
structures.
This
is
because
they
arise
from
the
original
natural
integral
structures
on
the
universal
extension
×
1
E
†
as
a
sort
of
de
Rham
cohomology
–
i.e.,
“HDR
(E,
OE
)”
–
associated
to
E.
Remark.
In
fact,
even
though
in
Theorem
3.1,
we
assumed
that
S
was
Z-ﬂat,
by
working
in
the
universal
case
and
then
pulling
back,
one
sees
that
the
various
sheaves
we
constructed
with
a
superscript
“et”
are
deﬁned
for
any
C
log
→
S
log
as
in
Theorem
3.1
even
without
the
assumption
of
Z-ﬂatness.
§4.
Linear
Relations
Among
Higher
Schottky-Weierstrass
Zeta
Functions
In
this
§,
we
consider
the
extent
to
which
the
twisted
Schottky-Weierstrass
zeta
functions
of
Chapter
IV,
§3,
satisfy
linear
relations
modulo
various
powers
of
q
over
the
base
ring
A
(notation
as
in
Chapter
IV,
§3).
Thus,
throughout
this
§,
we
will
use
the
notation
and
conventions
of
Chapter
IV,
§2,3.
The
calculations
of
linear
relations
that
we
carry
out
in
this
§
will
turn
out
to
yield
the
key
technical
machinery
behind
the
main
result
of
this
paper.
We
begin
by
ﬁxing
our
base
ring
O
as
in
Chapter
IV,
§2,3).
Thus,
O
is
a
Zariski
localization
of
the
ring
of
integers
of
a
ﬁnite
extension
of
Q
such
that
Pic(O)
=
{1}.
We
also
ﬁx
a
positive
even
integer
n
=
2m.
Then
over
S
=
Spec(A)
(where
A
=
O[[q]]),
we
constructed
in
Chapter
IV,
§2,
an
isogeny
E→E
whose
kernel
is
equal
to
μn
.
Over
E,
we
considered
various
line
bundles
such
as:
def
LE
=
OE
(e);
165

M
E

was
deﬁned
as
the
restriction
to
E
⊆
C
of
a
line
bundle
M

on
C
obtained
by
Here,
M
E
∞
descending
the
line
bundle
L⊗n
via
the
“standard
action”
of
Zet
×
μn
on
L⊗n
C
∞
on
C
C∞
.
S
S
S
⊗n
Recall
that
the
line
bundle
LC
∞
is
the
line
bundle
whose
global
sections
over
C
∞
can
be
S
S
written
as
topological
A-linear
combinations
of
certain
special
monomials
2
q
m·k
+ik
·
U
2mk+i
·
θ
m
(where
k,
i
∈
Z,
|i|
≤
m)
discussed
in
Chapter
IV,
Proposition
2.2.
Moreover,
for
any
character
χ
∈
Hom(Πn
,
(μn
)S
)
(where
Πn
=
(Zet
/n)
×
μn
),
we
deﬁned
a
line
bundle
χ
M
E
and
we
saw
in
Chapter
IV,
Theorem
2.1
that
for
a
certain
particular
character,
which
we
denote
by
χθ
∈
Hom(Πn
,
(μn
)S
),
we
have
an
isomorphism
χ
LE
∼
=M
θ
E
of
degree
1
line
bundles
on
E.
In
the
following
discussion,
we
would
like
to
ﬁx
a
character
χL
∈
Hom(Πn
,
(μn
)S
)
def
Let
us
write
χM
=
χL
·
χθ
and
denote
the
restrictions
of
χM
and
χL
to
μn
⊆
(Zet
/n)
×
μn
=
Πn
by
χM,μ
:
μn
→
μn
and
χL,μ
:
μn
→
μn
,
respectively.
Thus,
we
have
χM
LχL
∼
=M
E
E
Recall
that
there
is
a
standard
action
of
μn
on
the
special
monomials
2
q
m·k
+ik
·
U
2mk+i
·
θ
m

Note
that
for
this
action,
μ
acts
trivially
on
θ
m
.
Let
(i.e.,
the
action
used
to
deﬁne
M).
n
us
refer
to
the
special
monomials
on
which
μn
acts
via
(χM,μ
)−1
as
χL
-special
monomials.
For
j
a
positive
integer,
let
us
write
cj
(χL
)
∈
Q
166
for
the
maximal
nonzero
rational
number
c
such
that
modulo
q
n·c
,
the
number
of
nonzero
χL
-special
monomials
is
<
j.
Let
us
denote
this
set
of
<
j
nonzero
(modulo
q
n·cj
(χL
)
)
χL
-special
monomials
by
Cj
(χL
)
We
remark
that,
here
(and
in
the
following
discussion):
By
“modulo”
we
mean,
strictly
speaking,
when
restricted
to
sections
of
L⊗n
C
∞
|E
over
ES
=
(Gm
)S
.
S
S
When
(as
in
the
following
discussion),
the
character
χL
is
ﬁxed,
we
shall
often
just
write
cj
,
Cj
for
cj
(χL
)
and
Cj
(χL
),
respectively.
Schola
4.1.
Computation
of
Special
Monomials
Modulo
Powers
of
q
Let
us
compute
Cj
and
cj
.
There
are
three
cases
to
consider:
Case
I:
χL,μ
=
1.
In
this
case,
the
χL
-special
monomials
are
those
for
which
i
=
±m.
Thus,
the
monomials
for
which
the
exponent
m
·
k
2
+
ik
of
q
is
0
are
precisely:
def
M
=
U
m
·
θm
,
def
M
=
U
−m
·
θ
m
=
(−1)et
(M
)
The
other
χL
-special
monomials
2
ket
(M
)
=
q
m·k
+mk
·
U
2mk+m
·
θ
m
,
(−k)et
(M
)
=
q
m·k
+mk
·
U
−2mk−m
·
θ
m
2
are
given
by
applying
(±k)et
(for
k
≥
0)
to
these
original
two.
In
particular,
there
are
precisely
2
+
2k
monomials
obtained
by
applying
ket
(for
|k
|
≤
k)
to
the
original
two
monomials.
Thus,
for
k
≥
0,
we
have
c2k+1
=
c2k+2
=
1
1
(m
·
k
2
+
mk)
=
(k2
+
k)
n
2
while
the
set
C2k+1
=
C2k+2
is
given
by
{ket
(M
)}0≤k
<k

{ket
(M
)}−k<k
≤0
Case
II:
χL,μ
=
χθ
|μn
.
In
this
case,
the
χL
-special
monomials
are
those
for
which
i
=
0.
Thus,
the
only
monomial
for
which
the
exponent
m
·
k
2
+
ik
of
q
is
0
is
the
monomial:
167
def
M
=
θm
The
other
χL
-special
monomials
(−k)et
(M
)
=
q
m·k
·
U
−2mk
·
θ
m
2
2
ket
(M
)
=
q
m·k
·
U
2mk
·
θ
m
,
are
given
by
applying
(±k)et
(for
k
≥
0)
to
this
original
monomial.
In
particular,
there
are
precisely
1+2k
monomials
obtained
by
applying
ket
(for
|k
|
≤
k)
to
the
original
monomial.
Thus,
we
have
c1
=
0
and,
for
k
≥
1,
c2k
=
c2k+1
=
1
1
·
m
·
k2
=
k2
n
2
while
C1
=
∅;
the
set
C2k
=
C2k+1
is
given
by
{ket
(M
)}0≤|k
|<k
Case
III:
χL,μ
2
=
1.
In
this
case,
the
χL
-special
monomials
are
those
for
which
i
=
iχ
,
for
some
ﬁxed
integer
iχ
such
that
0
<
|iχ
|
<
m.
Thus,
the
only
monomial
for
which
the
exponent
m
·
k
2
+
ik
of
q
is
0
is
the
monomial:
def
M
=
U
iχ
·
θ
m
The
other
χL
-special
monomials
ket
(M
)
=
q
m·k
+iχ
·k
·
U
2mk+iχ
·
θ
m
,
2
(−k)et
(M
)
=
q
m·k
−iχ
·k
·
U
−2mk+iχ
·
θ
m
2
are
given
by
applying
(±k)et
(for
k
≥
0)
to
this
original
monomial.
Note
that
(for
k
≥
1)
m
·
k
2
+
|iχ
|
·
k
>
m
·
k
2
−
|iχ
|
·
k
>
m
·
(k
−
1)2
+
|iχ
|
·
(k
−
1)
(Indeed,
the
second
inequality
follows
from
the
fact
that
2mk
=
m
+
m
·
(2k
−
1)
>
m
+
|iχ
|
·
(2k
−
1).)
In
other
words,
the
exponent
of
q
induces
a
total
ordering
on
the
set
of
χL
-special
monomials.
The
ﬁrst
2k
monomials
are
given
by
applying
ket
(for
integers
168
k
such
that
either
|k
|
<
k
or
|k
|
=
k,
k
·
iχ
<
0)
to
the
original
monomial,
while
the
ﬁrst
1
+
2k
monomials
are
given
by
applying
ket
(for
integers
k
such
that
|k
|
≤
k)
to
the
original
monomial.
Thus,
we
have
c1
=
0
and,
for
k
≥
1,
c2k
=
1
·
(m
·
k
2
−
|iχ
|
·
k);
n
c2k+1
=
1
·
(m
·
k
2
+
|iχ
|
·
k)
n
Moreover,
C1
=
∅;
the
set
C2k
is
given
by
{ket
(M
)}0≤|k
|<k
while
the
set
C2k+1
is
given
by
{ket
(M
)}0≤|k
|<k

{ket
(M
)}|k
|=k,
k
·iχ
<0
This
completes
the
computation
of
Cj
and
cj
.
Lemma
4.2.
For
any
choice
of
character
χL
∈
Hom(Πn
,
(μn
)S
),
we
have:
j

a=1
ca
=
1
j(j
2
−
1)
24
for
any
odd
integer
j
≥
1.
Proof.
First,
we
observe
that
for
any
even
integer
a
=
2k
≥
2,
we
have
ca
+
ca+1
=
k
2
.
Indeed,
in
the
cases
where
χL,μ
=
1
(i.e.,
Cases
II
and
III),
it
is
immediate
from
the
formulas
for
ca
and
ca+1
that
we
have
ca
+
ca+1
=
k
2
.
On
the
other
hand,
in
Case
I,
we
have
ca
+
ca+1
=
12
{k
2
+
k
+
(k
−
1)2
+
(k
−
1)}
=
k
2
,
as
asserted.
Thus,
if
we
let
def
j
=
12
(j
−
1),
then
we
have
j


ca
=
a=1
j

b=1
b2
=
1
1
1
j
(j
+
1)(2j
+
1)
=
(j
−
1)(j
+
1)j
=
j(j
2
−
1)
6
24
24
as
desired.

169
Note
that
in
the
above
analysis,
Cj
was
always
obtained
by
applying
various
ket
’s
to
certain
ﬁxed
monomials
M
,
M
which
were
the
unique
χL
-special
monomials
that
were
nonzero
modulo
q.
Let
us
write
(for
j
≥
3
in
Case
I;
for
j
≥
2
in
Cases
II,
III)
Max(Cj
)
(respectively,
Min(Cj
))
for
the
maximum
(respectively,
minimum)
integer
k
such
that
the
symbol
ket
(M
)
or
ket
(M
)
appears
in
the
lists
of
elements
of
Cj
that
were
given
in
Schola
4.1.
(Here,
by
“symbol,”
we
simply
mean
that
in
Case
I,
we
wish
to
distinguish
the
symbol
M
from
(−1)et
(M
).)
Note
that
Max(Cj
)
≥
0
≥
Min(Cj
)
Also,
let
us
write
def
Span(Cj
)
=
Max(Cj
)
−
Min(Cj
)
Thus,
in
Case
I,
we
have
(for
k
≥
1)
Max(C2k+1
=
C2k+2
)
=
k
−
1;
Min(C2k+1
=
C2k+2
)
=
−(k
−
1)
Span(C2k+1
=
C2k+2
)
=
2k
−
2
In
Case
II,
we
have
(for
k
≥
1)
Max(C2k
=
C2k+1
)
=
k
−
1;
Min(C2k
=
C2k+1
)
=
−(k
−
1)
Span(C2k
=
C2k+1
)
=
2k
−
2
In
Case
III,
we
have
(for
k
≥
1)
Max(C2k
)
=
k
−
1;
Min(C2k
)
=
−(k
−
1);
Span(C2k
)
=
2k
−
2
and
Max(C2k+1
)
=
k
−
1
+
Max
;
Min(C2k+1
)
=
−(k
−
1)
−
Min
Span(C2k+1
)
=
2k
−
1
170
where
Max
+
Min
=
1,
and
Max
is
1
(respectively,
0)
if
iχ
<
0
(respectively,
iχ
>
0).
In
particular,
we
observe
that
if
Min(Cj
)
≤
a
≤
Max(Cj
),
then
aet
(M
)
∈
Cj
(in
all
Cases);
aet
(M
)
∈
Cj
(in
Case
I).
Now
let
a
be
an
integer
such
that
Min(Cj
)
≤
a
≤
Max(Cj
),
for
some
integer
j
such
that
Max(Cj
),
Min(Cj
)
are
deﬁned.
Let
ket
(M
)
be
an
arbitrary
χL
-special
monomial
(so
k
may
be
any
integer).
Then
observe
that:
If
(−a)et
(ket
(M
))
=
(−a
+
k)et
(M
)
is
nonzero
modulo
q,
then
it
follows
that
ket
(M
)
∈
Cj
.
Indeed,
if
(−a)et
(ket
(M
))
is
nonzero
modulo
q,
then
(by
the
discussion
in
Schola
4.1)
we
deduce
that
(−a)et
(ket
(M
))
is
M
or
M
(in
Case
I);
(−a)et
(ket
(M
))
=
M
(in
Cases
II,
III).
Thus,
ket
(M
)
is
aet
(M
)
or
aet
(M
)
(in
Case
I);
ket
(M
)
=
aet
(M
)
(in
Cases
II,
III).
In
particular,
ket
(M
)
∈
Cj
,
as
desired.
This
observation
implies
the
following:
Lemma
4.3.
Let
j
be
an
integer
which
is
≥
3
(in
Case
I);
≥
2
(in
Cases
II,
III).
If
ψ
is
any
topological
A-linear
combination
of
χL
-special
monomials
which
is
≡
0
modulo
q
n·cj
,
then
(−a)et
(ψ)
is
≡
0
modulo
q,
for
any
a
such
that
Min(Cj
)
≤
a
≤
Max(Cj
).
Proof.
Indeed,
such
a
ψ
is
a
topological
A-linear
combination
of
ket
(M
)’s,
where
k
ranges
over
all
elements
of
Z.
If
ket
(M
)
∈
Cj
,
then
it
follows
from
the
above
observation
that
(−a)et
(ket
(M
))
≡
0
modulo
q.
Thus,
the
only
terms
in
the
topological
A-linear
combination
of
ket
(M
)’s
that
might
yield
a
nonzero
contribution
to
(−a)et
(ψ)
modulo
q
are
those
for
which
ket
(M
)
∈
Cj
.
But
since
ψ
≡
0
modulo
q
n·cj
,
it
follows
(from
the
deﬁnition
of
the
set
Cj
!)
that
the
coeﬃcients
of
those
terms
must
be
≡
0
modulo
q.
Thus,
(−a)et
(ψ)
≡
0
modulo
q,
as
desired.
(Note
that
in
this
argument,
we
make
essential
use
of
the
fact
that
the
elements
of
the
set
{ket
(M
)}k∈Z
are
(topologically)
linearly
independent
over
A
–
a
fact
which
follows
immediately
from
the
observation
that
the
exponents
of
U
which
appear
in
distinct
elements
of
this
set
are
distinct.)

def
Now
recall
the
operator
δ
χ
(i.e.,
given
by
δ
χ
(?)
=
{χ(1et
)
·
1et
(?)}−
?,
where
here
we
def
take
χ
=
χM
)
of
Chapter
IV,
§3.
Note
that
if,
for
instance,
ψ
is
a
topological
A-linear
combination
of
χL
-special
monomials
which
is
zero
modulo
q
n·cj
,
then
one
can
compute
δ
χ
(ψ)
modulo
q
as
soon
as
one
knows
ψ
and
1et
(ψ)
modulo
q.
By
induction,
one
sees
easily
that
one
can
compute
the
b-th
iterate
of
this
operator
(δ
χ
)b
(ψ)
(for
some
positive
integer
b)
modulo
q
as
soon
as
one
knows
ψ,
1et
(ψ),
.
.
.
,
bet
(ψ)
modulo
q.
Thus,
Lemma
4.3
has
the
following
consequence/generalization:
Corollary
4.4.
Let
j
be
an
integer
which
is
≥
3
(in
Case
I);
≥
2
(in
Cases
II,
III).
If
ψ
is
any
topological
A-linear
combination
of
χL
-special
monomials
which
is
≡
0
modulo
q
n·cj
,
then
171
(−a)et
((δ
χ
)b
(ψ))
≡
0
(modulo
q)
for
any
integers
a,
b
such
that
0
≤
b
≤
Span(Cj
),
b
+
Min(Cj
)
≤
a
≤
Max(Cj
).
Next,
let
us
recall
the
twisted
Schottky-Weierstrass
zeta
functions
ζiχ
(of
Chapter
IV,
def
Theorem
3.1)
associated
to
the
character
χ
=
χM
.
In
the
following
discussion,
we
shall
think
of
these
functions
as
sections
of
L⊗n
C
∞
(i.e.,
without
the
superscripted
χ
–
contrary
to
S
the
notation
of
Chapter
IV,
Theorem
3.1)
on
which
Zet
×
μn
acts
via
χ−1
.
Note
that
(by
Chapter
IV,
Theorem
3.1)
the
ζiχ
are
all
topological
A-linear
combinations
of
χL
-special
monomials,
i.e.,
satisfy
the
assumptions
on
ψ
in
Corollary
4.4.
Now
let
us
suppose
that
for
some
integer
r
≥
0,
we
are
given
an
A-linear
combination
r

γi
·
ζiχ
i=0
(where
the
γi
∈
A)
which
is
≡
0
modulo
q
n·cj
,
for
j
as
in
Corollary
4.4.
Let
Case
be
1
if
we
are
in
Case
I,
and
0
otherwise.
Suppose,
moreover,
that
for
some
s
≤
Span(Cj
)
+
Case
,
we
have:
γs
≡
0;
γi
≡
0
modulo
q
for
all
i
>
s.
Then,
by
applying
Corollary
4.4
to
the
above
sum,
we
obtain
that
for
some
integer
a:
0
≡
aet
r

i=0
γi
·
(δ
)
χ
s−Case
(ζiχ
)
s

≡
aet
γi
·
(δ
χ
)s−Case
(ζiχ
)
modulo
q
i=s−Case
i.e.,
the
terms
such
that
i
>
s
vanish
modulo
q
because
of
the
assumptions
on
the
γi
;
the
terms
such
that
i
<
s
−
Case
vanish
because
(δ
χ
)s−Case
(ζiχ
)
=
0
(by
the
formula
for
δ
χ
(ζiχ
)
given
in
Chapter
IV,
Theorem
3.1)
for
such
i.
If
we
are
in
Cases
II
or
III,
then
since
(δ
χ
)s
(ζsχ
)
=
±ζ0χ
,
and
δ
χ
(ζ0χ
)
=
χM
(1)
·
1et
(ζ0χ
)
−
ζ0χ
=
0,
we
obtain
that
0
≡
γs
·
aet
(ζ0χ
)
=
γs
·
χM
(a)−1
·
ζ0χ
modulo
q
i.e.,
γs
≡
0
modulo
q,
which
is
a
contradiction.
In
Case
I,
we
have
(δ
χ
)s−1
(ζsχ
)
=
±ζ1χ
+γ·ζ0χ
(for
some
γ
∈
A),
(δ
χ
)s
(ζsχ
)
=
±ζ0χ
,
so
we
obtain
that
0
≡
γs−1
·
aet
(±ζ1χ
+
γ
·
ζ0χ
)
±
γs
·
aet
(ζ0χ
)
modulo
q
172
(where
the
various
“±’s”
which
appear
are
not
necessarily
“coordinated”).
Moreover,
aet
(ζ1χ
)
is
clearly
equal
to
a
root
of
unity
times
ζ1χ
plus
an
A-multiple
of
ζ0χ
,
while
aet
(ζ0χ
)
is
equal
to
a
root
of
unity
times
ζ0χ
.
On
the
other
hand,
by
Lemma
4.5
below,
we
know
that
in
Case
I,
ζ0χ
and
ζ1χ
are
O-linearly
independent
modulo
q.
Thus,
we
obtain
that
γs−1
and
γs
are
≡
0
modulo
q,
which
is
again
a
contradiction.
Lemma
4.5.
In
Case
I,
the
reductions
modulo
q
of
ζ0χ
and
ζ1χ
are
linearly
independent
over
every
residue
ﬁeld
of
O.
Proof.
Write
ζ0χ
=
σ0
·
θ
m
,
ζ1χ
=
σ1
·
θ
m
.
Then
from
1et
(θ
m
)
=
q
m
·
U
n
·
θ
m
,
1et
(ζ0χ
)
=
χM
(1)−1
·
ζ0χ
,
we
obtain
that
if
we
set
def
1
ζχ
=
2
+
U
∂σ0
·
n
·
σ0
∂U
then
1et
(ζ
χ
)
=
ζ
χ
−
1
(cf.
the
case
of
“classical
Schottky-Weierstrass
zeta
function
ζ”
discussed
in
Chapter
III,
§5
–
especially
Theorem
5.6).
Note,
here,
that
the
operator
1
U
∂
2
+
n
·
∂U
is
integral
(even
at
primes
of
O
which
divide
2
or
n)
on
χL
-special
monomials
in
Case
I:
Indeed,
in
the
notation
of
Schola
4.1,
above,
this
operator
acts
on
ket
(M
)
by
multiplication
by
12
+
n1
·
(2mk
+
m)
=
k
+
1,
and
on
(−k)et
(M
)
by
multiplication
by
1
1
2
+
n
(−2mk
−
m)
=
−k.
In
other
words,
in
the
terminology
of
Chapter
IV,
§3,
“(σ0
·θ
m
)·T
+(σ0
·ζ
χ
·θ
m
)”
is
an
“extension
polynomial
on
which
Zet
×μn
acts
via
χM
.”
Thus,
we
may
take
ζ1χ
=
σ0
·ζ
χ
·θ
m
.
On
the
other
hand,
ζ0χ
modulo
q
may
be
computed
as
in
the
proof
of
Chapter
IV,
Theorem
2.1,
to
be
equal
to
(an
A×
-multiple
of)
(U
m
+
γ
·
U
−m
)
·
θ
m
∂
(where
γ
is
a
root
of
unity).
If
we
apply
the
operator
12
+
Un
·
∂U
to
the
coeﬃcient
of
θ
m
in
this
expression,
we
obtain
U
m
·
θm
Thus,
since
γ
is
a
root
of
unity,
hence
∈
O
×
,
we
obtain
that
these
two
expressions
are
linearly
independent
over
every
residue
ﬁeld
of
O,
as
desired.

Thus,
we
see
that
we
have
essentially
proven
the
following
result:
Theorem
4.6.
Let
χL
∈
Hom(Πn
,
(μn
)S
)
be
a
character.
Let
j
≥
2
be
an
integer.
Then
χ
the
twisted
Schottky-Weierstrass
ζ-functions
ζ0χ
,
.
.
.
,
ζj−1
(cf.
Chapter
IV,
Theorem
3.1)
def
associated
to
χ
=
χM
satisfy
the
following:
173
Case
I:
χL,μ
=
1.
If
j
=
2,
then
the
reductions
modulo
q
of
ζ0χ
and
ζ1χ
def
are
linearly
independent
over
A/(q)
=
O.
If
j
≥
3,
let
j0
=
2k
+
1
≥
3
be
any
odd
integer
such
that
j
≥
j0
≥
3.
Let
def
Case
=
1.
def
Case
II:
χL,μ
=
χθ
|μn
.
Let
j0
=
2k
≥
2
be
any
even
integer
such
that
j
≥
j0
≥
2.
Let
def
Case
=
0.
Case
III:
χL,μ
2
=
1.
Let
j0
≥
2
be
any
integer
such
that
j
≥
j0
≥
2.
Let
def
Case
=
0.
def
In
all
the
Cases,
let
B
=
A/(q
n·cj0
).
Then
there
exists
a
B-submodule
R
⊆
B
j
–
i.e.,
a
submodule
of
relations
–
such
that:
(i)
j−1
i=0
γi
·
ζiχ
≡
0
modulo
q
n·cj0
for
all
(γ0
,
.
.
.
,
γj−1
)
∈
R;
(ii)
the
projection
R
→
B
j−j0
+1
onto
the
last
j
−
j0
+
1
factors
is
an
isomorphism.
Finally,
we
have:
(∗)
Any
(γ0
,
.
.
.
,
γj−1
)
∈
B
j
such
that
(γ0
,
.
.
.
,
γj−1
)
∈
q
·
B
j
,
and
j−1
χ
n·cj0
has
at
least
one
i
≥
Span(Cj0
)
+
i=0
γi
·
ζi
≡
0
modulo
q
1
+
Case
=
j0
−
1
=
|Cj0
|
(i.e.,
the
cardinality
of
Cj0
)
such
that
γi
≡
0
modulo
q.
In
fact,
this
statement
(∗)
holds
“modulo
p”
for
any
maximal
prime
p
of
O,
i.e.:
(∗p
)
Any
(γ0
,
.
.
.
,
γj−1
)
∈
B
j
such
that
(γ0
,
.
.
.
,
γj−1
)
∈
(q,
p)
·
B
j
,
and
j−1
χ
n·cj0
,
p)
has
at
least
one
i
≥
Span(Cj0
)
+
i=0
γi
·
ζi
≡
0
modulo
(q
1
+
Case
=
j0
−
1
=
|Cj0
|
(i.e.,
the
cardinality
of
Cj0
)
such
that
γi
≡
0
modulo
(q,
p).
Proof.
Indeed,
the
statement
(∗)
was
precisely
what
we
proved
above;
its
“modulo
p”
version
(∗p
)
follows
by
precisely
the
same
argument.
When
j
=
2
in
Case
I,
Theorem
4.6
follows
from
Lemma
4.5.
Thus,
let
us
assume
that
we
are
in
Case
I
and
j
≥
3,
or
that
we
are
in
Cases
II
or
III
and
j
≥
2.
To
see
that
there
exists
a
B-submodule
R
in
each
Case
satisfying
properties
(i)
and
(ii),
let
us
ﬁrst
observe
that
the
map
174
(γ0
,
.
.
.
,
γj−1
)
→
j−1

γi
·
ζiχ
modulo
q
n·cj0
i=0
deﬁnes
a
B-linear
morphism
Ξ
:
B
j
→
B−linear
combinations
of
the
monomials
∈
Cj0
modulo
q
n·cj0
Note
that
because
of
the
way
in
which
j0
was
chosen
in
each
of
the
three
cases
(and
because
of
the
way
in
which
we
deﬁned
Cj0
)
it
follows
that
Cj0
has
cardinality
j0
−
1.
We
would
like
to
show
that
the
kernel
of
Ξ
is
isomorphic
(as
a
B-module)
to
B
j−j0
+1
(via
the
projection
of
(ii)).
Suppose
that
we
can
show
this
after
base-changing
from
O
to
an
arbitrary
residue
ﬁeld
of
O.
Then
it
will
follow
from
elementary
commutative
algebra
(by
thinking
about
ﬁnitely
generated
modules
over
the
principal
ideal
domain
O)
that
the
kernel
of
Ξ
is
abstractly
isomorphic
to
B
j−j0
+1
as
an
O-module;
moreover,
the
projection
of
(ii)
will
then
be
a
morphism
between
free
O-modules
of
the
same
rank
which
is
bijective
modulo
all
of
the
maximal
primes
of
O.
Thus,
it
will
follow
that
the
projection
of
(ii)
is
bijective
over
O,
hence
that
Ker(Ξ)
is
isomorphic
as
a
B-module
to
B
j−j0
+1
via
the
projection
of
(ii),
as
desired.
Thus,
it
suﬃces
to
show
(i)
and
(ii)
after
base-changing
to
an
arbitrary
residue
ﬁeld
of
O.
Let
us
denote
the
objects
obtained
by
executing
this
base-change
by
means
of
a
j0
−1
.
subscript
“res.”
Then
the
range
of
Ξres
is
a
Bres
-module
which
is
a
quotient
of
Bres
In
particular,
it
follows
from
elementary
commutative
algebra
(since
Bres
is
a
quotient
j
that
of
the
principal
ideal
domain
Ares
)
that
there
exists
a
Bres
-submodule
Rres
⊆
Bres
j−j0
+1
∼
satisﬁes
(i)
and
which
is
=
Bres
.
The
fact
that
such
an
Rres
also
satisﬁes
(ii)
is
a
formal
consequence
of
(∗p
).
This
completes
the
proof
of
the
“res”
case,
and
hence
of
the
entire
Theorem.

Remark.
From
a
certain
point
of
view,
Theorem
4.6
is
the
key
technical
result
behind
the
main
theorems
of
this
paper.
Corollary
4.7.
Let
χL
∈
Hom(Πn
,
(μn
)S
)
be
a
character.
Let
j
≥
2
be
an
integer.
Then
χ
the
twisted
Schottky-Weierstrass
ζ-functions
ζ0χ
,
.
.
.
,
ζj−1
(cf.
Chapter
IV,
Theorem
3.1)
satisfy
the
following
property:
Let
j
be
deﬁned
as
follows:
Case
I:
Let
j
be
the
smallest
odd
integer
≥
j
+
1.
Case
II:
Let
j
be
the
smallest
even
integer
≥
j
+
1.
def
Case
III:
Let
j
=
j
+
1.
175
Let
p
be
a
maximal
prime
of
O.
Then
if
γ0
,
.
.
.
,
γj−1
∈
A
are
such
that
j−1

γi
·
ζiχ
≡
0
modulo
q
n·cj

(respectively,
modulo
(q
n·cj

,
p))
i=0
then
all
of
the
γi
’s
are
≡
0
modulo
q
(respectively,
modulo
(q,
p)).
Finally,
j
satisﬁes
the
property:
|Cj

|
=
j
−
1
≤
j
+
1;
if
j
is
odd,
then
|Cj

|
is
=
j
+
1
(in
Case
I),
=
j
(in
Cases
II,
III);
if
j
is
even,
then
|Cj

|
is
=
j
+
1
(in
Case
II),
=
j
(in
Cases
I,
III).
Proof.
The
ﬁnal
statement
follows
immediately
from
the
deﬁnitions.
Thus,
let
us
prove
the
statement
concerning
linear
independence.
To
simplify
the
notation,
we
prove
the
result
in
the
“non-resp’d”
case.
(The
proof
in
the
“resp’d”
case
is
entirely
similar.)
First,
def
j
is
deﬁned
as
“the
smallest
j0
(as
in
Theorem
4.6)
which
is
≥
j
+1.”
Then
if
we
let
γi
=
0
for
i
≥
j,
suppose
that
there
exists
some
γi
≡
0
modulo
q,
and
apply
the
statement
(∗)
of
Theorem
4.6,
we
obtain
that
there
exists
some
i
≥
j
−
1
≥
j
for
which
γi
≡
0
modulo
q.
But
in
light
of
the
deﬁnition
of
the
γi
,
this
is
absurd.
This
contradiction
completes
the
proof.

Finally,
we
close
this
§
by
observing
that,
although
in
the
above
discussion,
we
took
an
abstract
point
of
view
with
respect
to
showing
the
existence
of
linear
combinations
of
the
ζiχ
satisfying
certain
congruence
property
modulo
powers
of
q,
in
fact,
it
is
possible
to
give
an
explicit
description
of
the
linear
combinations
of
ζiχ
’s
that
arise.
Indeed,
one
has
the
following
result:
Theorem
4.8.
(Congruence
Canonical
Schottky-Weierstrass
Zeta
Functions)
χ
Let
σχ
∈
Γ(C
∞
,
(L⊗n
C
∞
)
)
be
as
in
Chapter
IV,
§3.
Let
iχ
∈
{−m,
−m
+
1,
.
.
.
,
m
−
1}
be
S
S
as
in
Chapter
IV,
Theorem
3.3.
(Note
that
this
notation
is
consistent
with
the
notation
of
the
present
§
for
Case
III.)
Then,
up
to
an
A×
-multiple,
σχ
is
equal
to
the
series

q
m·k
+iχ
·k
·
U
2mk+iχ
·
θ
m
·
χ(ket
)
=
2
k∈Z

ket
(U
iχ
·
θ
m
)
·
χ(ket
)
k∈Z
def
i
χ
Now
if
r
is
a
nonnegative
integer,
let
Lr
(T
)
=
T
+
λr
−
2m
,
where
λr
∈
Z
is
deﬁned
as
follows:
def
λr
=
r
2
+
iχ

2m
i.e.,
the
greatest
integer
≤
the
number
in
brackets.
Then
if
we
set
ζ0CG
to
be
equal
to
the
above
series,
and
176
def
ζrCG
=



k
+
λr

2
Lr
(δ
∗
)
CG
(ζ0
)
=
·
q
m·k
+iχ
·k
·
U
2mk+iχ
·
θ
m
·
χ(ket
)
r
r
k∈Z
def
ζrCG
[T
]
=


r

Lr
(δ
∗
+
T
)
CG
ζiCG
·
T
[r−i]
(ζ0
)
=
r
i=0
(where
δ
∗
,
T
are
as
in
Chapter
IV,
Theorem
3.3),
then
for
any
positive
integer
j,
we
have
CG
≡
0
modulo
q
n·cj0
ζj−1
(where
j0
is
as
in
Theorem
4.6).
Finally,
the
ζrCG
are
integral
over
Z,
and
form
a
collection
of
twisted
higher
Schottky-Weierstrass
zeta
functions
as
in
Chapter
IV,
Theorem
3.1.
Proof.
Note
that
the
series
given
for
(an
A×
-multiple
of)
σχ
is
Zet
-invariant.
On
the
other
χ
hand,
since
the
set
of
Zet
-invariant
elements
of
Γ(C
∞
,
(L⊗n
C
∞
)
)
forms
a
free
A-module
of
S
×
S
rank
1,
it
follows
immediately
that
σχ
is
an
A
-multiple
of
this
series.
The
explicit
series
iχ
)
will
always
be
formula
for
ζrCG
then
follows
immediately.
In
particular,
since
Lr
(k
+
2m
∈
Z,
it
follows
immediately
that
ζrCG
is
integral
over
Z.
Since
δ
∗
+
T
is
Zet
-invariant,
it
follows
immediately
that
the
ζrCG
form
a
collection
of
twisted
higher
Schottky-Weierstrass
zeta
functions
as
in
Chapter
IV,
Theorem
3.1.
In
fact,
one
can
even
write
the
ζrCG
as
explicit
linear
combinations
of
the
ζiBI,χ
’s
(of
Chapter
IV,
Theorem
3.3)
by
using
Chapter
III,
Lemma
7.5.
CG
Thus,
it
remains
only
to
show
that
ζj−1
has
the
desired
congruence
property.
The
point
here
is
to
observe
that
if
we
deﬁne
a
ﬁltration
F
r
(Z)
(for
r
≥
0
an
integer)
on
Z
by:
def
F
r
(Z)
=
{0
−
λr
,
1
−
λr
,
.
.
.
,
r
−
1
−
λr
}
then
F
r+1
(Z)
is
obtained
from
F
r
(Z)
by
appending
one
more
integer
“k[r]”
directly
to
the
left/right
of
F
r
(Z)
(where
“left/right”
depends
only
on
the
parity
of
r),
and,
moreover,
the
exponent
of
q
in
the
χL
-special
monomial
corresponding
to
this
“k[r]”
is
≥
the
exponents
of
q
in
the
χL
-special
monomial
corresponding
to
the
integers
“k”
in
F
r
(Z).
In
particular,
it
follows
that
for
each
of
the
χL
-special
monomials
q
m·k
+iχ
·k
·
U
2mk+iχ
·
θ
m
2
iχ


iχ
(k+
2m
)
=
0.
belonging
to
Cj0
,
Lj−1
(k
+
2m
)
is
a
nonnegative
integer
≤
j
−
2.
Thus,
Lj−1j−1
CG
That
is
to
say,
the
coeﬃcients
(in
the
series
deﬁning
ζj−1
)
of
all
the
χL
-special
monomials
in
Cj0
are
zero.
This
proves
the
desired
congruence
property.

177
§5.
The
Determinant
of
the
Evaluation
Map
In
this
§,
we
prepare
for
the
discussion
of
the
following
§
by
showing
that
(at
least
if
the
base
is
an
algebraically
closed
ﬁeld,
and
the
elliptic
curve
in
question
is
“suﬃciently
generic,”
then)
the
determinants
of
the
evaluation
maps
of
Propositions
2.2,
2.3,
have
a
particularly
simple
form,
so
long
as
they
are
not
identically
zero
(Theorem
5.6).
Here,
we
use
the
notation
of
§2,
except
that
we
also
assume
(unless
speciﬁed
otherwise)
that
S
=
Spec(k),
where
k
is
an
algebraically
closed
ﬁeld.
Remark.
In
fact,
logically
speaking,
we
shall
only
use
the
theory
of
this
§
in
the
case
where
char(k)
=
0.
Thus,
the
reader
who
is
only
interested
in
material
that
is
logically
necessary
for
the
proofs
of
the
main
theorems
of
this
paper
may
assume
in
this
§
that
char(k)
=
0.
In
particular,
in
this
§,
E
→
S
will
be
a
(proper!)
elliptic
curve,
and
S
=
S∞
.
Thus,
since
we
do
not
have
to
deal
with
log
structures,
metrized
line
bundles,
etc.,
the
discussion
of
§2
simpliﬁes
substantially.
Also,
in
this
§,
we
will
assume
that
L
=
L
=
OE
(d
·
[e])
and
that
we
are
given
a
symmetric
Lagrangian
subgroup
H
⊆
GL
i.e.,
a
Lagrangian
subgroup
which
is
mapped
to
itself
under
the
automorphism
of
GL
induced
by
the
automorphism
(−1)
:
E
→
E
(“multiplication
by
−1”)
of
E.
Also,
we
assume
that
H
is
of
multiplicative
type,
i.e.,
that
H
is
étale
locally
isomorphic
to
μd
.
Since,
however,
k
is
algebraically
closed,
this
implies
that
H
∼
=
μd
.
Let
us
ﬁx
an
identiﬁcation:
H
=
KH
=
μd
Then
∼
d
EH
=
d
E/KH
=
H
∗
=
Z/dZ
(where
the
“∗”
denotes
the
Cartier
dual).
In
particular,
under
these
assumptions,
if
char(k)
=
p
>
0,
then
it
follows
that
E
is
an
ordinary
elliptic
curve
(i.e.,
its
Hasse
invariant
is
nonzero).
Conversely,
if
char(k)
=
0
or
E
is
ordinary,
then
I
claim
that
there
exists
a
symmetric
Lagrangian
subgroup
H
⊆
GL
of
multiplicative
type.
Indeed,
by
the
discussion
preceding
Chapter
IV,
Deﬁnition
1.3,
it
follows
that
the
existence
of
such
an
H
amounts
to
the
issue
of
whether
or
not
a
certain
exact
sequence
Z-modules
(character
groups)
178
0
→
Z/dZ
→??
→
Z
→
0
equipped
with
a
Z/2Z
=
{±1}-action
splits.
If
d
is
odd,
then
the
existence
of
such
a
splitting
follows
from
the
fact
that
H
1
(Z/2Z,
Z/dZ)
=
0.
If
d
is
even,
and
k
is
of
characteristic
0,
the
existence
of
such
a
splitting
follows
from
“the
existence
of
a
symmetric
θ-structure
on
a
totally
symmetric
ample
line
bundle”
[Mumf1],
Remark
2,
p.
318.
If
d
is
even,
and
k
is
of
positive
characteristic,
then
the
existence
of
such
a
splitting
follows
from
the
fact
that
the
relevant
class
in
H
1
(Z/2Z,
Z/dZ)
is
locally
constant,
hence
may
be
computed
after
lifting
the
elliptic
curve
in
question
to
characteristic
0.
This
completes
the
veriﬁcation
of
the
claim.
Thus,
other
than
the
condition
that
E
be
ordinary
if
char(k)
>
0,
the
assumption
of
the
existence
of
an
H
as
above
does
not
result
in
any
loss
of
generality.
The
Lagrangian
subgroup
H
⊆
GL
deﬁnes
a
line
bundle
LH
on
EH
=
E/KH
which
descends
L.
Since
L
and
H
⊆
GL
are
symmetric,
it
follows
that
LH
is
also
symmetric.
Since
LH
is
of
degree
1,
it
thus
follows
that
LH
∼
=
OEH
(
H
)
for
some
unique
H
∈
EH
(k),
which
satisﬁes
2
·
H
=
0.
If
G
is
a
ﬁnite,
ﬂat
subgroup
scheme
of
E
or
EH
,
let
us
write
[G]
for
the
divisor
in
E
or
EH
deﬁned
by
G.
We
will
also
use
this
notation
for
translates
of
G.
Before
continuing
our
discussion,
we
need
certain
basic
facts
concerning
the
various
line
bundles
that
appear:
Lemma
5.1.
We
have:
[KH
]
∼
(d
−
1)
·
[e]
+
[δ]
where
“∼”
denotes
linear
equivalence
of
divisors
on
E;
δ
=
e
if
d
is
odd;
and
δ
=
(
12
)μ
∈
KH
(k)
⊆
E(k),
i.e.,
the
unique
generator
of
the
subgroup
μ2
(k)
⊆
μd
(k)
=
KH
(k),
if
d
is
even.
Proof.
Indeed,
this
sort
of
equality
may
be
proven
by
lifting
to
characteristic
0.
Thus,
for
the
rest
of
the
proof,
we
assume
that
char(k)
=
0.
Then
KH
is
étale
over
k,
so
[KH
]
=

[α]
α∈KH
(k)
If
α
∈
KH
(k)
is
such
that
α
=
−α,
then
both
[α]
and
[−α]
appear
in
the
sum,
and
[α]
+
[−α]
∼
2[e].
Moreover,
the
only
[α]’s
such
that
α
=
−α
are
[e]
and
[δ].
Substituting
these
two
observations
into
the
above
sum
thus
yields
the
result.

179
Lemma
5.2.
We
have:
even
and
char(k)
=
2;
and
char(k)
=
2.
(the
origin
of
EH
)
if
d
is
odd;
H
∈
d
EH
(k)
if
d
is
∈
E
(k)\
H
H
d
EH
(k)
is
of
order
precisely
2
if
d
is
even
and
H
=
eH
Proof.
Suppose
ﬁrst
that
d
is
odd.
Then
since
the
line
bundle
L
=
OE
(d
·
[e])
is
not
ﬁxed
by
translation
by
any
point
of
E(k)
of
order
precisely
2,
and,
moreover,
the
points
of
order
2
of
E(k)
are
in
bijective
correspondence
with
the
points
of
order
2
of
EH
(k),
the
fact
that
∼
H
=
eH
follows
from
the
fact
that
L
=
OE
([KH
])
(cf.
Lemma
5.1).
Now
suppose
that
d
is
even
and
char(k)
=
2.
In
this
case,
Z/2Z
⊆
Z/dZ
∼
=
d
EH
(k)
is
equal
to
the
entire
set
of
points
in
EH
(k)
annihilated
by
2.
Thus,
H
∈
d
EH
(k).
Finally,
suppose
that
d
is
even
and
char(k)
=
2.
Since
we
know
that
2
·
H
=
0,
it
follows
that
it
suﬃces
to
prove
that
H
∈
d
EH
(k).
Next,
observe
that
since
there
exists
an
isomorphism
d
E
∼
=
H
×
H
∗
such
that
the
projection
to
the
factor
H
∗
coincides
with
the
morphism
d
E
→
d
EH
∼
=
H
∗
,
it
follows
that
there
exists
an
element
∈
E(k)
whose
order
is
precisely
2
and
which
maps
to
the
nonzero
element
of
Z/2Z
⊆
Z/dZ
∼
=
d
EH
(k)
⊆
EH
(k).

L,
so
On
the
other
hand,
by
Lemma
5.1,
we
have
OE
([KH
])
=
(d
−
1)
·
[e]
+
[(
12
)μ
]
∼
=
∗
∼
H
=
eH
.
Since
T
(L)
=
L
(here
we
use
the
fact
that
d
is
even),
it
thus
follows
that

OE
([
+
KH
])
∼

L,
which
implies
that
H
is
not
equal
to
the
image
of
in
EH
(k).
Thus,
=
we
conclude
that
H
∈
d
EH
(k),
as
desired.

Corollary
5.3.
Suppose
that
d
is
odd,
or
that
d
is
even
and
char(k)
=
2.
Then
[
H
+
d
EH
]
=
[d
EH
]
(an
equality,
not
just
a
linear
equivalence,
of
divisors
on
EH
).
def
Let
us
write
M
=
OEH
([
H
+
d
EH
]).
Note
that
there
is
an
evident
action
of
d
EH
on
M
(resulting
from
the
fact
that
d
EH
stabilizes
the
divisor
[
H
+
d
EH
]).
If
one
descends
to
M
to
E
=
EH
/d
EH
via
this
action,
then
the
resulting
line
bundle
on
E
is
simply
OEH
([
])
where
∈
E(k)
is
the
image
of
H.
Lemma
5.4.
Suppose
that
d
is
even,
and
char(k)
=
2.
Let
Lχ
be
the
line
bundle
on
E
=
EH
/d
EH
given
by
descending
the
line
bundle
M
relative
to
the
action
of
d
EH
∼
=
Z/dZ
on
M
given
by
twisting
the
evident
action
by
the
unique
nontrivial
character
χ
:
d
EH
∼
=
χ
∼
Z/dZ
→
μ2
=
{±1}
of
order
2.
Then
L
=
OE
(e).
Proof.
Clearly,
deg(Lχ
)
=
1.
Since
2
·
H
=
0,
and
χ⊗2
=
1,
it
follows
that
Lχ
is
symmetric.
Thus,
Lχ
∼
=
OE
(
χ
),
for
some
unique
χ
∈
E(k),
which
is
necessarily
of
order
2.
As
observed
above,
if
one
descends
M
via
the
evident
action
of
d
EH
on
M,
one
gets
OEH
([
]),
where
∈
E(k)
is
the
image
of
H
.
Moreover,
=
(
12
)μ
(by
Lemma
5.2).
Since
180
the
kernel
of
the
morphism
Pic0
(E)
→
Pic0
(EH
)
induced
by
EH
→
E
=
EH
/d
EH
has
a
unique
element
of
order
precisely
2,
it
follows
that
χ
is
the
unique
element
of
E(k)
of
order
≤
2
such
that
χ
=
,
OE
(
χ
)|EH
∼
=M
=
M.
But
observe
that
OE
(e)|EH
=
OEH
([d
EH
])
∼
(where
the
last
isomorphism
follows
from
the
fact
that
M
is
of
even
degree,
hence
ﬁxed
by
translation
by
H
,
which
is
order
2).
Thus,
we
conclude
that
χ
=
e,
as
desired.

Corollary
5.5.
Suppose
that
0
=
s
∈
Γ(EH
,
M)
has
the
following
property
with
respect
to
the
evident
action
of
d
EH
on
M:
s
is
ﬁxed
by
this
action
if
d
is
odd,
or
if
d
is
even
and
char(k)
=
2;
d
EH
acts
on
s
by
the
character
χ
(of
Lemma
5.4)
if
d
is
even
and
char(k)
=
2.
Then
the
inverse
image
in
E
via
E
→
EH
=
E/KH
of
the
zero
locus
V
(s)
of
s
is
equal
to
the
divisor
[d
E].
Proof.
Indeed,
if
d
is
odd,
or
if
d
is
even
and
char(k)
=
2,
then
s
descends
to
a
nonzero
section
s
∈
Γ(EH
,
OE
(
)).
Since
OE
(
)
is
of
degree
1,
V
(s
)
=
[
].
Thus,
V
(s)
=
[
H
+
d
EH
]
=
[d
EH
]
(by
Corollary
5.3),
so
the
inverse
image
in
E
of
V
(s)
is
[d
E],
as
desired.
If
d
is
even
and
char(k)
=
2,
then
(by
Lemma
5.4)
s
descends
to
a
nonzero
section
s
∈
Γ(EH
,
OE
(e)).
Since
OE
(e)
is
of
degree
1,
V
(s
)
=
[e],
so
the
inverse
image
in
E
of
V
(s)
is
[d
E],
as
desired.

Now
we
are
ready
to
return
to
our
discussion
of
the
evaluation
maps
of
§2.
In
the
present
discussion,
we
shall
omit
the
symbol
“∞”
from
the
various
notations
of
§2,
since
here,
S
=
S∞
,
E
=
E∞
,
etc.
We
would
like
to
consider
the
morphism
ΞH
L,d,α
of
Proposition
2.3,
for
a
point
α
∈
E
†
(k).
Write
def
†
V
=
Γ(EH,[d]
,
LH
|
†
)<d
EH,[d]
Also,
let
us
denote
the
elements
of
d
EH
=
Z/dZ
by
(
di
)H
,
for
i
=
0,
.
.
.
,
d
−
1.
Then
the
morphism
of
Proposition
2.3
becomes
ΞH
α
:V
→
d−1

i=0
i
OEH
([
H
+
(
)H
])|α
d
(where
we
identify
LH
with
OEH
([
H
])).
†
Now
let
β
∈
d
EH
(k)
∼
=
d
EH
(k).
We
would
like
to
consider
the
relationship
between
H
H
Ξα
and
Ξα+β
.
Note
that
both
maps
involve
restricting
sections
∈
V
to
the
same
points
†
inside
EH,[d]
,
except
in
a
diﬀerent
order.
Thus,
one
may
think
of
ΞH
α+β
as
the
result
of
H
composing
Ξα
with
the
permutation
of
the
summands
in
the
direct
sum
on
the
right
(which
are
indexed
by
i
=
0,
.
.
.
,
d
−
1)
by
the
permutation
i
→
i
+
iβ
modulo
d
(where
181
i
(
dβ
)H
∈
d
EH
(k)
is
the
element
deﬁned
by
β).
Thus,
if
one
takes
determinants,
one
obtains
that
the
determinant
−1
det(ΞH
⊗k
OEH
([
H
+
d
EH
])|α
α+β
)
∈
det(V
)
is
equal
to
−1
(−1)sgn(β)
·
det(ΞH
⊗k
OEH
([
H
+
d
EH
])|α
α
)
∈
det(V
)
where
sgn(β)
is
the
sign
of
the
permutation
i
→
i
+
iβ
modulo
d.
Note
that
if
d
is
odd,
or
if
d
is
even
and
char(k)
=
2,
then
(−1)sgn(β)
is
always
1.
If
d
is
even
and
char(k)
=
2,
then
(−1)sgn(β)
=
χ(β),
where
χ
is
the
character
of
Lemma
5.4.
Thus,
if
one
lets
α
be
the
tautological
point
∈
E
†
(E
†
),
one
gets
a
section
−1
det(ΞH
⊗k
Γ(E
†
,
OEH
([
H
+
d
EH
])|α
)
α
)
∈
det(V
)
which,
by
Lemma
2.4,
descends
to
E.
Moreover,
clearly
this
determinant
of
ΞH
α
only
depends
on
the
image
of
α
in
EH
.
Thus,
since
this
image
is
just
the
tautological
point
∈
EH
(EH
),
we
get
a
section
−1
⊗k
Γ(EH
,
OEH
([
H
+
d
EH
]))
=
det(V
)−1
⊗k
Γ(EH
,
M)
det(ΞH
α
)
∈
det(V
)
which,
by
the
above
discussion,
satisﬁes
the
hypotheses
of
Corollary
5.5
(as
soon
as
it
is
nonzero).
In
other
words,
we
see
that
the
zero
locus
of
det(ΞH
α
)
on
E
is
equal
either
to
all
of
E
or
to
[d
E].
That
is
to
say,
we
have
proven
the
following:
Theorem
5.6.
Let
E
be
an
elliptic
curve
over
an
algebraically
closed
ﬁeld
k.
Suppose
def
that
E
is
ordinary
if
char(k)
>
0.
Let
d
≥
1
be
an
integer;
L
=
OE
(d·[e]);
and
α
∈
E
†
(k).
Then
if
the
morphism
†
ΞL,d,α
:
Γ(E[d]
,
L|
†
)<d
→
L|
∗
E[d]
Tα
(d
E
†
)
is
an
isomorphism
for
any
single
α
∈
E
†
(k),
then
it
follows
that
it
is
an
isomorphism
for
all
α
∈
E
†
(k)
except
for
those
which
map
to
d
E(k)
⊆
E(k).
Moreover,
if
this
morphism
is
an
isomorphism
for
any
single
α
∈
E
†
(k),
then
the
scheme-theoretic
zero
locus
of
the
determinant
of
this
morphism
in
the
case
where
α
is
the
tautological
point
∈
E
†
(E
†
)
is
precisely
d
times
the
divisor
E
†
×E
(d
E)
⊆
E
†
.
Finally,
the
same
(except
with
“d
times”
in
the
preceding
sentence
deleted)
assertions
hold
for
the
morphism
182
†
ΞH
L,d,α
:
Γ(EH,[d]
,
LH
|
†
EH,[d]
)<d
→
LH
|
†
Tα∗
(d
EH
)
where
H
⊆
GL
is
any
Lagrangian
subgroup
(cf.
Chapter
IV,
Deﬁnition
1.3).
Proof.
It
remains
only
to
note
that,
in
the
statement
of
Theorem
5.6,
it
is
not
necessary
to
assume
that
the
Lagrangian
subgroup
is
symmetric
or
of
multiplicative
type.
Indeed,
the
assertions
in
the
statement
of
Theorem
5.6
concerning
the
Lagrangian
subgroup
follow
immediately
from
the
general
theory
of
§2,
especially
Proposition
2.3;
Chapter
IV,
Theorem
1.4.
Note
that
we
need
the
“d
times”
in
the
“non-Lagrangian
case”
because
the
matrices
appearing
in
the
non-Lagrangian
case
amount
essentially
to
d
copies
(arranged
diagonally)
of
the
matrices
appearing
in
the
Lagrangian
case.
Thus,
the
determinants
must
be
raised
to
the
d-th
power.

§6.
The
Generic
Case
In
this
§,
we
give
an
explicit
computation
of
a
certain
evaluation
map
(i.e.,
a
map
like
that
deﬁned
in
§2)
deﬁned
for
certain
degenerating
elliptic
curves
in
mixed
characteristic.
In
particular,
we
will
show
that
the
determinant
of
this
map
is
nonzero
in
mixed
characteristic.
This
result,
combined
with
the
results
of
§5,
will
allow
us
to
conclude
the
generic
bijectivity
of
certain
evaluation
maps
in
mixed
characteristic.
Moreover,
this
sort
of
generic
bijectivity
result
will
be
the
crucial
technical
ingredient
in
the
proof
of
the
main
results
of
Chapter
VI.
In
this
§,
we
use
the
notation
of
the
ﬁrst
portion
of
§3,
i.e.,
the
discussion
of
the
degenerating
case
(preceding
the
“Analytic
Continuation
Argument”).
Let
N
≥
1
be
an
integer
which
is
prime
to
d
and
invertible
in
the
base
ring
O
(a
Zariski
localization
of
the
ring
of
integers
of
a
number
ﬁeld).
Let
p
be
a
prime
number
that
appears
as
the
characteristic
of
a
residue
ﬁeld
of
O.
We
would
like
to
concentrate
our
attention,
in
this
§,
on
integral
structures
at
the
prime
p.
Let
def
1
AN
=
O[[q
N
·d
]];
def
1
SN
=
Spec(O[[q
N
·d
]])
=
Spec(AN
)
Thus,
we
have
a
natural
ﬁnite
morphism
SN
→
S,
which
we
regard
as
a
“base
extension”
of
the
base
S
=
Spec(O[[q]])
of
(the
ﬁrst
portion
of)
§3.
Note
that
if
one
thinks
of
E
as
def
being
“Gm
/q
d·Z
”
then
q
d/N
∈
Gm
(USN
)
(where
USN
=
Spec(AN
[q
−1
])
(⊆
SN
))
deﬁnes
a
rational
point
η
∈
Cd
(SN
)
183
which,
relative
to
the
group
structure
on
Cd
over
US
,
is
annihilated
by
N
.
Similarly,
q
∈
Gm
(USN
)
deﬁnes
a
rational
point
τ
∈
Ed
(S)
⊆
Cd
(SN
)
which
is
a
torsion
point
of
order
d.
In
particular,
by
using
the
group
scheme
structure
on
Ed
(together
with
the
fact
that
the
action
of
Ed
on
itself
extends
to
an
action
of
Ed
on
Cd
),
we
may
also
form
the
points
η
·
τ
β
∈
Cd
(SN
)
(for
β
∈
Z).
(Here,
we
use
the
letter
“β”
so
that
our
notation
will
be
consistent
with
the
notation
in
the
discussion
of
d-torsion
points
in
§3.)
Note
that,
relative
to
the
theory
of
Chapter
IV,
§4,
the
point
of
the
“S1
”
associated
to
E
deﬁned
by
τ
(respectively,
η
·
τ
β
)
is
equal
to
d1
(respectively,
N1
+
βd
).
Next,
let
us
write
eE
⊆
E(S)
for
the
identity
element
of
the
group
scheme
E.
Write
d
def
L
=
OC
(eE
)
d
d
for
the
corresponding
line
bundle
on
Cd
.
Note
that
since
the
points
η
·
τ
β
do
not
intersect
eE
,
it
follows
that
the
restriction
of
the
line
bundle
L
to
any
of
these
points
η
·
τ
β
admits
d
a
natural
trivialization.
In
this
§,
we
would
like
to
consider
the
following
evaluation
map
(cf.
the
evaluation
maps
deﬁned
in
§2):
Ξη
:
Γ(Cd
,
L
⊗O
Cd
))
⊗OS
OSN
−→
F
d
(Ret†
E
d−1

β=0
Cd
,[d]
(L|η·τ
β
)
=
d−1

O
SN
β=0
given
by
restriction.
Note
that
here,
to
deﬁne
the
evaluation
map
Ξη
,
we
use
the
facts
that
(i)
Ret†
⊗Q
=
R
†
⊗
Q;
(ii)
in
characteristic
zero,
the
torsion
points
η,
τ
∈
Cd
(SN
)
E
E
Cd
,[d]
Cd
,[d]
lift
naturally
to
torsion
points
of
E
structure
on
E
†
Cd
,[d]
†
Cd
,[d]
(SN
⊗
Q)
(where
“torsion”
refers
to
the
group
|USN
).
This
much
gives
us
a
map
Ξη
⊗
Q;
to
see
that
Ξη
is,
in
fact,
deﬁned
without
tensoring
with
Q,
we
need
an
integrality
statement
like
that
at
the
end
of
Theorem
3.1.
The
reason
we
cannot
apply
the
integrality
statement
at
the
end
of
Theorem
3.1
directly
is
that
instead
of
restricting
to
d-torsion
points
(i.e.,
τ
β
’s),
we
are
restricting
to
d-torsion
points
shifted
by
η.
This
is
not
a
problem,
however,
since,
just
as
in
the
proof
of
the
integrality
statement
at
the
end
of
Theorem
3.1,
we
see
that
it
suﬃces
to
prove
that
the
“T
[n]
’s”
(notation
of
the
ﬁrst
part
of
§3)
take
on
integral
values
for
T
=
Nd
+
β.
But
184
since
we
assumed
that
N
∈
O
×
,
this
is
an
easy
exercise.
(For
instance,
it
may
be
proven
by
observing
that
it
suﬃces
to
prove
it
locally
at
an
arbitrary
prime
number
l
not
dividing
N
;
but
then
Nd
may
be
l-adically
approximated
by
an
integer,
and
it
is
well-known
that
T
[n]
takes
integral
values
at
integers;
thus,
the
integrality
of
T
[n]
for
T
=
Nd
+
β
at
the
prime
l
follows
from
the
fact
that
Zl
is
l-adically
closed
in
Ql
.)
This
completes
the
deﬁnition
of
Ξη
.
In
this
§,
we
would
like
to
study
the
extent
to
which
Ξη
is
an
isomorphism.
To
do
this,
we
would
like
to
compute
the
determinant
of
Ξη
.
To
compute
this
determinant
explicitly,
we
must
introduce
various
explicit
bases
of
the
domain
and
range
of
Ξη
.
Note
that
the
range
of
Ξη
already
has
a
natural
basis
(over
OSN
)
given
by
the
fact
that
it
is
naturally
a
direct
sum
of
copies
of
OSN
.
Next,
we
consider
the
domain
of
Ξη
.
To
simplify
notation,
let
us
write
def
V
=
Γ(Cd
,
L
⊗O
Cd
F
d
(Ret†
E
))
⊗OS
OSN
Cd
,[d]
Note
that
V
has
a
natural
ﬁltration
F
n
(V
),
induced
by
the
ﬁltration
on
Ret†
(cf.
E
Cd
,[d]
Theorem
3.1).
For
0
≤
n
≤
d
−
1,
the
subquotient
(F
n+1
/F
n
)(V
)
is
a
(locally)
free
OSN
module
of
rank
1.
By
further
localizing
O,
we
may
assume
that
these
modules
are,
in
fact,
free,
hence
generated
(over
OSN
)
by
some
φn
∈
F
n+1
(V
),
where
0
≤
n
≤
d
−
1.
Thus,
φ0
,
.
.
.
,
φd−1
form
a
basis
of
V
over
OSN
.
Next,
let
us
recall
the
inﬁnite
étale
covering
C
∞
→
C
∞
/(d
·
Zet
)
=
(Cd
)S
.
We
would
S
S
def
like
to
pull-back
the
various
sections
φi
(for
i
=
0,
.
.
.
,
d
−
1)
over
(Cd
)SN
=
Cd
×S
SN
to
def
C
∞
=
C
∞
×S
SN
.
If
we
do
this,
then
it
follows
from
the
deﬁnition
of
the
“Ret
”
in
§3
SN
S
(and
Chapter
III,
§6)
that
we
can
write
φi
=
i

ζi,j
·
T
[j]
j=0
where
ζi,j
∈
Γ(C
∞
,
L|C
∞
).
Note,
moreover,
that
for
each
i
=
0,
.
.
.
,
d
−
1,
the
section
ζi,i
SN
SN
descends
to
(Cd
)SN
(cf.
the
theory
of
Chapter
III,
§6).
Since
φi
generates
(F
i+1
/F
i
)(V
),
and
restriction
of
sections
of
Γ((Cd
)SN
,
L(C
)
)
to
η
clearly
deﬁnes
an
isomorphism
d
SN
Γ((Cd
)SN
,
L(C
)
d
SN
185
)∼
=
O
SN
it
follows
that
ζi,i
(η)
∈
OS×N
.
Thus,
by
replacing
φi
by
an
appropriate
OS×N
-multiple
of
φi
,
we
may
assume
that
the
φi
’s
have
been
normalized
so
that,
for
i
=
0,
.
.
.
,
d
−
1,
we
have
ζi,i
(η)
=
1
(cf.
the
theory
of
Chapter
III,
§6).
Now
we
are
ready
to
compute
the
determinant
of
Ξη
.
Relative
to
the
bases
chosen
above,
this
amounts
to
computing
the
determinant
of
the
matrix
M
=
{Mi,β
}
where
i,
β
=
0,
.
.
.
,
d
−
1,
and
def
β
Mi,β
=
φi
(η∞
·
τ∞
)=
i

β
ζi,j
(η∞
·
τ∞
)
·
(T
[j]
|T
=
d
+β
)
N
j=0
Here,
η∞
∈
C
∞
(SN
),
τ∞
∈
C
∞
(SN
)
are
the
points
deﬁned
by
q
N
,
q
∈
Gm
(USN
),
respecd
SN
SN
tively,
by
thinking
of
C
∞
as
(the
q-adic
completion
of)
a
sort
of
Néron
model
for
Gm
over
SN
USN
(cf.
the
discussion
at
the
beginning
of
Chapter
III,
§5).
Thus,
η∞
,
τ∞
project
to
η,
τ
,
respectively.
We
would
like
to
show
that
the
determinant
in
question
is
invertible
as
a
section
of
1
OSN
.
Since
sections
of
OSN
are
invertible
if
and
only
if
they
are
invertible
modulo
q
N
,
1
it
thus
follows
that
it
suﬃces
to
show
that
det(M)
is
invertible
modulo
q
N
.
Thus,
in
the
1
following
computations,
we
will
work
modulo
q
N
.
1
β
Next,
let
us
observe
that,
modulo
q
N
,
the
rational
points
η∞
·
τ∞
(for
β
=
0,
.
.
.
,
d
−
1)
∞
of
C
over
SN
all
lie
in
the
irreducible
components
of
the
special
ﬁber
of
C
∞
labeled
SN
SN
1,
.
.
.
,
d
−
1
(cf.
the
discussion
at
the
beginning
of
Chapter
III,
§5).
Indeed,
these
d
−
1
irreducible
components
include
a
total
of
precisely
d
nodes,
and
it
is
these
d
nodes
which
1
β
(for
β
=
0,
.
.
.
,
d
−
1)
modulo
q
N
.
On
the
other
hand,
the
are
images
of
the
η∞
·
τ∞
restriction
of
the
line
bundle
L
to
the
union
of
these
d
−
1
irreducible
components
is
clearly
equal
to
the
trivial
bundle.
Let
us
write
U
for
the
union
of
these
d
−
1
components.
Then
U
is
a
chain
of
d
−
1
copies
of
P1
over
O.
In
particular,
U
is
reduced
and
connected,
so
it
follows
that
Γ(U
,
L|U
)
=
O
i.e.,
sections
of
L
are
constant
over
U
,
hence,
in
particular,
assume
the
same
values
at
the
β
points
η∞
·
τ∞
(for
β
=
0,
.
.
.
,
d
−
1)
that
we
are
interested
in.
1
Thus,
modulo
q
N
,
we
have:
186
Mi,β
≡
i

ζi,j
(η∞
)
·
(T
[j]
|T
=
d
+β
)
N
j=0
Now
we
would
like
to
perform
various
elementary
row
operations
on
this
matrix.
Here,
we
think
of
the
matrix
entries
(i,
β)
where
i
is
ﬁxed
and
β
varies
as
a
row.
Thus,
we
will
speak
of
“the
row
(i,
∼).”
Note
ﬁrst
of
all
that
the
row
(0,
∼)
consists
of
1’s,
i.e.,
(0,
β)
≡
ζ0,0
(η∞
)
·
(T
[0]
|T
=
d
+β
)
=
1
N
1
(where
“≡”
in
the
following
discussion
will
always
mean
“modulo
q
N
”).
Now
I
claim
that
by
performing
elementary
row
operations
on
the
matrix
M,
one
may
transform
this
matrix
1
(modulo
q
N
)
into
a
matrix
M
=
{Mi,β
},
where
Mi,β
≡
ζi,i
(η∞
)
·
(T
[i]
|T
=
d
+β
)
=
T
[i]
|T
=
d
+β
N
N
Indeed,
we
prove
this
for
each
row
(i,
∼)
by
induction
on
i.
First
of
all,
it
is
clearly
already
true
for
i
=
0.
The
induction
step
is
then
proven
by
observing
that
the
diﬀerence
between
the
original
row
(i,
∼)
of
M
and
the
row
(i,
∼)
of
M
is
≡
i−1

ζi,j
(η∞
)
·
(T
[j]
|T
=
d
+β
)
N
j=0
i.e.,
the
“diﬀerence
row”
may
be
thought
of
as
the
sum
(for
j
=
0,
.
.
.
,
i
−
1)
of
rows
of
the
form:
“the
constant
ζi,j
(η∞
)
times
the
row
(j,
∼)
of
M
.”
Since
for
j
<
i,
we
have
already
converted
the
row
(j,
∼)
of
M
into
the
row
(j,
∼)
of
M
by
means
of
elementary
row
operations
(by
the
induction
hypothesis),
we
thus
see
that
further
elementary
row
operations
will
allow
us
to
convert
the
row
(i,
∼)
of
M
into
the
row
(i,
∼)
of
M
,
as
desired.
This
completes
the
proof
of
the
claim.
Thus,
it
suﬃces
to
prove
that
det(M
)
is
invertible.
Since
Mi,β
≡
T
[i]
|T
=
d
+β
N
this
amounts
to
an
elementary
and
explicit
calculation.
Of
course,
one
may
perform
this
calculation
explicitly,
but
one
indirect
way
to
show
that
this
determinant
is
invertible
is
the
following:
It
suﬃces
to
show
that
this
determinant
is
invertible
at
every
prime
l
that
does
not
divide
N
.
At
such
an
l,
Nd
may
be
l-adically
approximated
by
integers.
Moreover,
since
Z×
l
is
an
l-adically
closed
subset
of
Ql
,
it
thus
suﬃces
to
prove
that
the
determinant
is
invertible
when
Nd
is
replaced
by
an
arbitrary
I
∈
Z.
Thus,
it
suﬃces
to
show
the
invertibility
of
the
matrix
M
[I]
=
{Mi,β
[I]},
where
187
Mi,β
[I]
=
T
[i]
|T
=I+β
But
now
let
us
note
that
by
repeated
application
of
the
relation
δ(T
[i]
)
=
T
[i−1]
,
one
veriﬁes
easily
that
M
[I]
may
be
converted
into
M
[I
+
1]
by
means
of
elementary
row
operations.
In
particular,
det(M
[I])
is
independent
of
I,
so
it
suﬃces
to
show
that
det(M
[0])
is
invertible.
But
Mi,β
[0]
=
T
[i]
|T
=β
is
0
if
β
<
i,
and
1
if
β
=
i.
That
is
to
say,
the
matrix
M
[0]
is
upper
triangular,
with
1’s
along
the
diagonal.
Thus,
det(M
[0])
=
1
as
desired.
In
other
words,
we
have
proven
the
following
result:
Lemma
6.1.
The
evaluation
map
Ξη
:
Γ(Cd
,
L
⊗O
Cd
d
))
⊗OS
OSN
−→
et
F
(R
†
E
d−1

β=0
Cd
,[d]
(L|η·τ
β
)
=
d−1

O
SN
β=0
is
an
isomorphism.
Now
we
would
like
to
consider
the
consequences
of
Lemma
6.1,
in
light
of
the
theory
of
§5.
To
do
this,
let
p
be
a
generic
point
of
SN
⊗
Fp
.
Write
def
W
=
Spec(OSN
,p
)
Thus,
W
is
a
trait,
i.e.,
the
spectrum
of
a
discrete
valuation
ring
(of
mixed
characteristic).
Let
us
write
pW
for
the
closed
point
of
W
.
In
the
following,
we
would
like
to
work
over
W
.
To
do
this,
we
ﬁrst
pull-back
the
various
objects
that
we
have
been
working
with
over
SN
to
W
.
Thus,
we
obtain
a
torsor
†
EW,[d]
→
EW
together
with
a
line
bundle
LW
on
EW
,
and
a
d-torsion
point
τW
∈
EW
(W
).
In
the
def
following
discussion,
we
will
often
wish
to
base-change
from
W
to
the
bases
X
=
EW
,
188
def
†
Y
=
EW,[d]
.
When
we
wish
to
think
of
these
objects
not
as
group
schemes
over
W
,
but
†
rather
as
base
extensions
of
W
,
we
will
use
the
notation
“X,”
“Y
”
for
EW
,
EW,[d]
.
We
will
denote
the
result
of
base-changing
objects
over
W
(which
have
a
subscript
“W
”)
to
objects
over
X
and
Y
by
means
of
a
subscript
X
or
Y
.
Finally,
let
us
write
δX
∈
EX
(X)
=
EW
(X);
def
δY
=
δX
|Y
∈
EW
(Y
);
†
†
†
δY
∈
EY,[d]
(Y
)
=
EW,[d]
(Y
)
for
the
tautological
points
given
by
the
respective
identity
maps.
Next,
we
would
like
to
consider
the
following
evaluation
map
(where
the
requisite
integrality
follows
from
the
statement
at
the
end
of
Theorem
3.1):
ΞTX
:
def
VXT
=
Γ(EX
,
(Tδ∗X
LX
)
⊗O
d
EX
et
F
(R
†
))
−→
EX,[d]
d−1

(Tδ∗X
LX
)|τ
β
X
β=0
(where
TδX
:
EX
→
EX
is
the
morphism
given
by
translation
by
the
point
δX
∈
EX
(X))
of
locally
free
OX
-modules
of
rank
d.
Write
ηW
for
the
pull-back
of
the
torsion
point
η
of
×
Lemma
6.1
to
a
point
of
X(W
)
=
EW
(W
).
Note
that
since
N
∈
OW
,
and
ηW
is
an
N
†
†
torsion
point,
it
follows
that
ηW
lifts
naturally
to
a
unique
N
-torsion
point
ηW
∈
EW,[d]
(W
)
(cf.
Chapter
III,
Corollary
5.9).
Moreover,
since
Nd
is
a
p-adic
integer,
translation
by
Nd
preserves
the
“T
[n]
”
(over
SN
or
over
W
).
Thus,
we
see
that
the
morphism
T
†
(translation
ηW
†
†
by
ηW
)
on
EW,[d]
induces
a
ﬁltration-preserving
automorphism
T
∗†
[Ret
]
:
Ret†
E
η
W
W,[d]
→
Ret†
E
W,[d]
Thus,
we
get
an
isomorphism
T
∗†
[V
]
:
ηW
Γ(EW
,
LW
⊗O
EW
F
d
(Ret†
))
∼
=
Γ(EW
,
(Tη∗W
LW
)
⊗O
EW
EW,[d]
F
d
(Ret†
))
EW,[d]
But
now
observe
that
the
domain
of
T
∗†
[V
]
is
simply
VW
(i.e.,
the
pull-back
to
W
of
the
ηW
∗
OSN
-module
“V
”
that
we
considered
earlier),
while
the
range
of
T
∗†
[V
]
is
ηW
(VXT
),
i.e.,
the
restriction
of
the
OX
-module
VXT
ηW
considered
above
to
the
point
ηW
∈
X(W
).
Relative
189
to
these
observations,
we
thus
see
that
the
restriction
to
W
of
the
morphism
Ξη
of
Lemma
6.1
may
be
thought
of
as:
∗
Ξη
|W
=
ηW
(ΞTX
)
◦
T
∗†
[V
]
ηW
In
particular,
it
follows
from
Lemma
6.1
that
det(ΞTX
)
(which
is
naturally
a
section
of
a
certain
line
bundle
on
the
scheme
X)
is
not
identically
zero
on
(the
irreducible
scheme)
X
⊗
(OW
/pW
).
In
other
words,
the
vanishing
locus
of
det(ΞTX
)
is
ﬁnite
and
ﬂat
over
W
,
hence
is
determined
by
its
restriction
to
the
generic
ﬁber
of
X
=
EW
→
W
.
†
Next,
we
would
like
to
work
over
the
base
Y
=
EW,[d]
.
Note
that
over
Y
,
translation
†
by
δY
deﬁnes
an
isomorphism
T
∗†
[V
]
:
Γ(EY
,
LY
⊗O
EY
δY
F
d
(Ret†
EY,[d]
))
⊗
Q
∼
=
Γ(EY
,
(Tδ∗Y
LY
)
⊗O
EY
F
d
(Ret†
))
⊗
Q
EY,[d]
†
Note
that
here,
we
must
tensor
with
Q
since
(one
may
easily
check
that)
δY
does
not
preserve
the
“et-integral
structure
Ret
”
of
§3.
Next,
let
us
consider
the
“composite
evaluation
map”:
ΞTX
|Y
◦
T
∗†
[V
]
:
δY
Γ(EY
,
LY
⊗O
EY
d
et
F
(R
†
))
⊗
Q
−→
EY,[d]
d−1

(Tδ∗Y
LY
)|τ
β
⊗
Q
β=0
Y
Now,
sorting
through
the
notation,
one
sees
that
this
composite
evaluation
map
is
(up
to
translation
by
the
torsion
point
“
H
”
of
§5)
the
same
as
the
evaluation
map
denoted
“ΞH
α
”
in
§5.
Since
the
determinant
of
this
evaluation
map
is
not
identically
zero
(by
what
we
did
in
the
preceding
paragraph),
it
thus
follows
from
Theorem
5.6,
that
(if
we
denote
by
W
∈
EW
(W
)
=
X(W
)
the
point
denoted
by
“
H
”
in
§5),
we
thus
obtain
that
the
vanishing
locus
of
the
determinant
of
this
composite
evaluation
map
is
given
by
the
divisor
d−1
β
β=0
[
W
·
τW
]
on
EW
⊗
Q.
Combining
this
with
what
we
did
in
the
preceding
paragraph,
we
thus
conclude
that:
The
vanishing
locus
of
det(ΞTX
)
is
given
by
the
divisor
d−1
β
β=0
[
W
·
τW
]
on
X
=
EW
.
Now
recall
the
semi-abelian
scheme
E
→
S
considered
at
the
beginning
of
§3.
One
may
think
of
E
as
being
the
quotient
E
→
E
of
E
by
a
subgroup
scheme
of
E
which
is
naturally
isomorphic
to
μd
.
Alternatively,
relative
to
Schottky
uniformizations,
one
may
190
think
of
the
isogeny
E
→
E
as
corresponding
to
the
morphism
Gm
/q
Z
→
Gm
/q
d·Z
induced
by
the
morphism
“raising
to
the
d-th
power”
on
Gm
.
If
we
pull-back
the
isogeny
E
→
E
to
W
,
we
get
an
isogeny
EW
→
EW
When
we
wish
to
think
of
EW
→
W
as
a
base
extension
of
W
,
we
will
denote
EW
by
def
Z
=
EW
,
and
write
γZ
∈
EW
(Z)
for
the
identity
morphism.
Finally,
we
will
denote
the
†
†
†
pull-backs
of
the
torsor
E[d]
→
E
to
W
,
Z
by
EW,[d]
→
EW
,
EZ,[d]
→
EZ
,
respectively.
def
If
we
let
LW
=
OEW
(eEW
)
(where
eEW
is
the
origin
of
EW
),
then
we
have
an
evaluation
map
for
EZ
(where
the
requisite
integrality
follows
from
the
statement
at
the
end
of
Theorem
3.1):
d
et
ΠTZ
:
Γ(EZ
,
(Tγ∗Z
L⊗d
Z
)
⊗OEZ
F
(R
†
))
−→
EZ,[d]
(Tγ∗Z
L⊗d
Z
)|(d
EZ
)
(Here
d
EZ
⊆
EZ
is
the
subgroup
scheme
of
d-torsion
points
in
EZ
.)
Thus,
one
observes,
relative
to
the
theory
of
§5,
that
for
an
appropriate
choice
of
“Lagrangian
subgroup
H”
(which
lifts
μd
⊆
E),
the
evaluation
maps
ΠTZ
and
ΞTX
correspond
to
one
another
(up
to
translation
by
W
)
with
respect
to
the
operation
of
“taking
invariants
with
respect
to
the
Lagrangian
subgroup”
(cf.
the
discussion
of
§5).
Thus,
we
obtain
the
following
result,
which
is
the
main
result
of
this
§:
Theorem
6.2.
For
any
integer
d
≥
1,
the
scheme-theoretic
zero
locus
of
the
determinant
of
the
evaluation
map
d
et
ΠTZ
:
Γ(EZ
,
(Tγ∗Z
L⊗d
Z
)
⊗OEZ
F
(R
†
EZ,[d]
))
−→
(Tγ∗Z
L⊗d
Z
)|(d
EZ
)
on
Z
=
EW
is
given
precisely
by
d
·
[d
EZ
]
⊆
EZ
,
where
[d
EZ
]
is
the
divisor
deﬁned
by
the
kernel
of
multiplication
by
d
on
EZ
.
Here,
W
is
a
trait
of
mixed
characteristic
(0,
p);
EW
→
W
is
an
elliptic
curve
with
the
property
that
the
moduli
of
the
special
ﬁber
over
W
are
generic
in
characteristic
p;
LW
def
is
the
line
bundle
deﬁned
by
the
identity
element
on
EW
;
EZ
=
EW
×W
Z,
LZ
=
LW
|Z
;
γZ
∈
EZ
(Z)
=
EW
(Z)
is
the
point
deﬁned
by
the
identity
morphism;
TγZ
is
translation
by
†
†
the
point
γZ
;
EZ,[d]
is
the
torsor
“E[d]
”
(cf.
§2)
for
the
elliptic
curve
EZ
;
and
Ret†
is
E
Z,[d]
the
“et-integral
structure”
(cf.
Deﬁnition
3.2)
on
the
ﬁltered
sheaf
of
functions
R
†
EZ,[d]
†
EZ,[d]
.
191
on
Note
that
in
the
above
proof,
we
made
essential
use
of
the
μd
-isogeny
(i.e.,
isogeny
whose
kernel
may
be
identiﬁed
with
μd
)
E→E
That
is
to
say,
we
proved
Theorem
6.2,
which
essentially
concerns
objects
over
E,
by
descending
objects
on
E
to
E
via
this
isogeny,
and
then
analyzing
the
resulting
objects
over
E
(cf.
the
discussion
preceding
Lemma
6.1).
In
fact,
however,
one
can
also
give
a
proof
of
Theorem
6.2
by
descending
with
respect
to
the
Z/dZ-isogeny
Ed
→
E
(cf.
§3
for
an
explanation
of
the
notation
–
roughly
speaking,
this
is
the
isogeny
that
looks
like
the
isogeny
“Gm
/q
dZ
→
Gm
/q
Z
”
arising
from
the
identity
Gm
→
Gm
on
Gm
),
and
then
applying
the
theory
developed
in
§4
to
the
descended
objects
on
E.
The
advantage
of
the
μd
-isogeny
proof
given
above
is
that
it
allows
one
to
calculate
the
relevant
matrix
very
explicitly
(up
to
the
elementary
row
operations)
without
much
preparation,
and
is
independent
of
the
rather
technical
theory
discussed
in
§4.
On
the
other
hand,
once
one
assumes
the
theory
of
§4,
the
proof
of
Theorem
6.2
is
relatively
short
and
proceeds
as
follows:
Alternate
Proof
of
Theorem
6.2:
We
omit
various
“general
nonsense”
details
concerning
“descent
with
respect
to
the
isogeny
in
question”
and
“base-change
to
W
”
that
were
discussed
extensively
in
the
preceding
proof
of
Theorem
6.2
and
which
are
the
same
in
both
proofs.
Recall
from
the
discussion
of
§3
that
E
†
Cd
,[d]
†
,
i.e.,
the
“E[d]
”
for
Cd
,
is
precisely
the
pull
†
back
via
the
compactiﬁed
isogeny
Cd
→
C
of
the
usual
universal
extension
torsor
EC
→
C
over
C
(⊇
E).
Moreover,
it
also
follows
from
the
discussion
of
§3
that
the
étale-integral
†
†
is
precisely
the
pull-back
of
the
étale-integral
structure
deﬁned
on
EC
structure
on
E
Cd
,[d]
in
Chapter
III,
Proposition
6.1.
Thus,
in
summary,
although
we
are
ultimately
interested
in
proving
the
result
(i.e.,
bijectivity)
for
the
evaluation
map
for
functions
in
Ret†
,
it
E
Cd
,[d]
suﬃces
(assuming
that
we
can
descend
the
relevant
line
bundle
on
Cd
down
to
C
–
cf.
the
following
paragraph)
to
prove
the
result
for
the
evaluation
map
for
functions
in
Ret†
.
EC
192
The
ﬁnal
detail
that
we
must
take
care
of
before
we
discuss
the
relevant
evaluation
map
on
C
is
the
speciﬁcation
of
the
relevant
line
bundle
on
Cd
.
More
precisely,
this
“line
bundle
on
Cd
”
will
be
a
metrized
line
bundle
on
E∞,S
.
Moreover,
we
want
this
metrized
line
bundle
to
descend
to
a
metrized
line
bundle
on
E∞,S
via
the
Z/dZ-isogeny
Ed
→
E.
We
take
this
metrized
line
bundle
on
E∞,S
to
be
Lst,η
ev
(respectively,
Lst,η
)
ev
if
d
is
odd
(respectively,
even)
–
i.e.,
the
metrized
line
bundles
“Lst,η
,”
“Lst,η
”
of
§1
for
E∞,S
(as
opposed
to
E∞,S
).
Here,
η
is
the
torsion
point
of
E∞,S
(SN
)
deﬁned
by
q
N
∈
Gm
(USN
)
(where
we
think
of
E∞,S
as
“Gm
/q
dZ
).
Thus,
it
remains
only
to
see
that
the
metrized
line
bundle
that
we
have
chosen
descends
via
Ed
→
E.
Going
back
to
the
deﬁnition
of
ev
Lst,η
,
Lst,η
in
§1,
we
see
that
these
metrized
line
bundles
are
obtained
by
translating
“Lst
,”
ev
“Lst
”
by
η
and
then
adding
various
d-invariant
ψ’s.
Since
it
is
clear
that
the
d-invariant
ev
ψ’s
descend,
it
thus
suﬃces
to
see
that
Lst
,
Lst
descend.
But
this
is
clear
from
the
explicit
forms
of
these
line
bundles
given
in
Chapter
IV,
Lemma
5.4.
Let
us
denote
the
resulting
descended
metrized
line
bundle
on
E∞,S
by
L
Note
that
L
has
relative
degree
1
over
the
base.
Moreover,
the
curvature
of
L
is
the
same
same
as
the
curvature
of
OC
(eC
)
(where
eC
is
the
identity
element
∈
C(S)
of
C).
Thus,
one
may
think
of
L
as
a
sort
of
twisted
form
of
OC
(eC
).
This
“twist”
may
be
resolved
by
pulling
back
to
an
appropriate
covering
of
C
(cf.
Chapter
IV,
§2,3;
§4
of
the
present
def
Chapter).
Since
this
twist
is
deﬁned
by
η
(
=
the
image
of
η
in
E∞,S
),
and
η
does
not
lie
in
the
identity
component
of
the
special
ﬁber
of
E∞,S
(a
consequence
of
the
fact
that
N
is
assumed
to
be
prime
to
d),
it
follows
that
the
twist
applied
to
OC
(eC
)
to
obtain
L
is
of
the
sort
eﬀected
by
a
character
“χL
”
which
falls
under
Case
III
(relative
to
the
terminology
of
§4).
Thus,
to
summarize,
the
above
discussion
shows
that
it
suﬃces
to
consider
the
evaluation
map
given
by
evaluating
sections
of
L
⊗OC
F
d
(Ret†
)
(over
E∞,S
)
on
μd
⊆
(Gm
)S
=
EC
ES
→
E
†
S
(where
ES
→
E
†
S
is
the
canonical
section
κ
of
Chapter
III,
Theorem
2.1).
Since
this
evaluation
map
is
between
vector
bundles
of
rank
d
on
S∞
,
it
follows
that
it
suﬃces
to
prove
that
it
is
injective
modulo
any
prime
p
of
O,
at
least
after
one
inverts
q.
def
But
this
injectivity
follows
immediately
from
Corollary
4.7
(applied
in
the
case
j
=
d).
Indeed,
to
see
this,
we
break
up
the
evaluation
map
of
sections
of
L
⊗OC
F
d
(Ret†
)
on
EC
μd
⊆
Gm
=
ES
⊆
E
†
S
into
two
steps:
193
(1)
First,
we
restrict
sections
of
L
⊗OC
F
d
(Ret†
)
to
ES
=
(Gm
)S
⊆
E
†
S
.
EC
(2)
Then,
we
strict
functions
on
ES
=
(Gm
)S
to
μd
⊆
(Gm
)S
=
ES
.
Strictly
speaking,
the
linear
independence
assertion
of
Corollary
4.7
implies
that
the
ﬁrst
restriction
(1)
is
injective.
(That
is,
if
it
were
not,
then
there
would
be
some
A-linear
χ
with
at
least
one
coeﬃcient
which
is
nonzero
modulo
(q,
p).
relation
among
ζ0χ
,
.
.
.
,
ζd−1
Thus,
in
particular,
we
would
get
a
linear
relation
modulo
(q
n·cj

,
p)
(with
at
least
one
coeﬃcient
which
is
nonzero
modulo
(q,
p)),
but
this
contradicts
Corollary
4.7.)
Thus,
it
remains
to
see
that
the
second
restriction
(2)
is
injective.
To
see
this,
ﬁrst
observe
that
since
we
are
in
Case
III,
the
number
“|Cj

|”
(notation
of
Corollary
4.7)
is
equal
to
j
=
d,
i.e.,
“modulo
q
n·cj

”
(notation
of
Corollary
4.7)
the
only
χL
-special
monomials
that
may
occur
(i.e.,
are
nonzero)
are
OS
-multiples
of
“U
I+i·n
”
(where
U
,
n
are
as
in
Corollary
4.7;
i
=
0,
.
.
.
,
d
−
1;
and
I
is
some
ﬁxed
constant,
independent
of
i)
–
cf.
Schola
4.1.
Moreover,
“U
n
”
(notation
of
§4)
corresponds
precisely
to
the
standard
multiplicative
coordinate
on
ES
=
(Gm
)S
(notation
of
the
present
discussion).
Let
us
denote
this
standard
coordinate
by
V
.
Thus,
we
see
that
the
assertion
that
the
second
restriction
(2)
is
injective
amounts
to
the
following
fact:
For
any
prime
p
of
O,
every
polynomial
in
V
of
degree
≤
d
−
1
which
vanishes
modulo
p
on
μd
⊆
(Gm
)S
=
ES
is
identically
0
modulo
p.
But
this
follows
immediately
from
elementary
algebraic
geometry
as
follows:
If
we
compactify
Gm
by
P1
,
then
we
see
that
we
are
reduced
to
verifying
the
assertion
that
every
global
section
over
P1
of
the
line
bundle
OP1
(−[μd
]
+
(d
−
1)[∞])
(where
“[μd
]”
is
the
degree
d
divisor
in
Gm
⊆
P1
deﬁned
by
μd
,
and
“[∞]”
is
the
(degree
1)
divisor
on
P1
at
“inﬁnity”)
is
identically
zero
(in
every
characteristic).
But
since
this
line
bundle
has
degree
−1,
this
assertion
is
an
immediate
consequence
of
elementary
algebraic
geometry.
This
completes
the
proof
of
the
various
injectivity
assertions
mentioned
above,
and
hence
of
the
entire
alternate
proof
of
Theorem
6.2.

Bibliography
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
University
Press
(1985).
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deﬁning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
2
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
194
Chapter
VI:
The
Scheme-Theoretic
Comparison
Theorem
§0.
Introduction
In
this
Chapter,
we
prove
the
Scheme-Theoretic
Comparison
Isomorphism.
This
result
essentially
asserts
that:
There
is
a
natural
bijection
between
certain
natural
types
of
algebraic
functions
on
the
universal
extension
of
an
elliptic
curve
and
the
“settheoretic
functions”
on
the
torsion
points
of
the
elliptic
curve.
This
natural
bijection
is
given
by
restricting
the
algebraic
functions
on
the
universal
extension
to
the
torsion
points
of
the
universal
extension.
This
restriction
morphism
is
referred
to
as
the
evaluation
map
(and
is
the
main
topic
of
Chapter
V).
Ultimately,
the
goal
of
this
paper
is
to
show
that
the
evaluation
map
is
not
only
a
bijection,
say,
in
characteristic
zero
(cf.
Theorem
3.1),
but
that
it
preserves
natural
integral
structures
on
both
sides
at
all
the
primes
of
the
rational
number
ﬁeld.
In
the
present
Chapter,
we
address
the
schemetheoretic
portion
of
this
goal,
namely,
we
show
that
we
essentially
get
an
isomorphism
schematically
over
(M1,0
)Z
(cf.
Theorem
4.1).
In
other
words,
we
show
that
the
integral
structures
at
all
of
the
ﬁnite
primes
(essentially)
coincide.
In
§1,
we
deﬁne
the
algebraic
functions
on
the
universal
extension
that
we
are
interested
in.
The
sheaves
of
such
functions
are
called
the
“{v,
et}-push
forwards”
of
a
metrized
line
bundle.
In
§2,
we
study
the
various
basic
properties
of
these
push-forwards,
with
an
eye
to
proving
(in
§4)
that
they
are
compatible
with
base-change.
In
§3,
we
prove
the
comparison
isomorphism
in
characteristic
zero,
i.e.,
that
the
evaluation
map
is
bijective
in
characteristic
zero
(Theorem
3.1).
Finally,
in
§4,
we
complete
the
proof
of
compatibility
with
base-change,
and
show
that
the
evaluation
map
also
(essentially)
preserves
integral
structures
on
both
sides
at
all
ﬁnite
primes
(Theorem
4.1).
§1.
Deﬁnition
of
a
New
Integral
Structure
at
Inﬁnity
In
this
§,
we
prepare
for
the
comparison
isomorphism
results
in
the
remainder
of
this
Chapter
by
introducing
a
new
integral
structure
in
a
neighborhood
of
the
divisor
at
inﬁnity
(i.e.,
the
locus
on
the
base
where
the
log
elliptic
curve
in
question
degenerates).
It
will
be
relative
to
this
new
integral
structure
that
the
evaluation
map
of
Chapter
V,
§2,
will
turn
out
to
be
an
isomorphism.
195
In
this
§,
we
use
the
notations
of
Chapter
V,
§2.
Let
us
ﬁrst
recall
the
WE
-torsor
†
ECd
,[d]
→
Cd
†
†
considered
in
Chapter
V,
§2.
Note
that
since
ECd
,[d]
extends
the
torsor
E[d]
→
E,
which
is
obtained
from
E
†
→
E
by
“pushing
out”
with
respect
to
multiplication
by
d
on
WE
,
it
follows
that
the
canonical
splitting
κ
(of
Chapter
III,
Theorem
2.1)
of
E
†
→
E
over
E
S
deﬁnes
a
canonical
splitting
†
κ
†
:
ES
→
(E[d]
)S
E[d]
Note
that
since
the
étale-integral
structure
of
Chapter
V,
Theorem
3.1,
is
deﬁned
using
this
canonical
splitting
(cf.
Chapter
V,
§3;
Chapter
III,
§6),
it
follows
that
κ
†
deﬁnes,
E[d]
for
any
integer
i
≥
0,
a
direct
sum
decomposition
i
et
F
(R
†
(E
)
i−1

)
∼
=
j=0
[d]
S
1
·
τ
⊗j
|E
j!
E
S
(cf.
Chapter
V,
Theorem
3.1).
Similarly,
one
sees
easily
that
by
translation
by
d-torsion
points,
we
get
analogous
direct
sum
decompositions
of
F
i
(Ret
†
)
over
the
q-adic
(EE
,[d]
)
d
S
completions
of
Ed
at
the
other
d
−
1
connected
components
of
the
special
ﬁber
of
Ed
.
Note,
however,
that
these
translated
decompositions
do
not
glue
together
at
the
nodes:
indeed,
if
they
did,
then
we
would
obtain
that
κ
†
extends
over
Cd
,
which
is
absurd
(cf.
E[d]
Chapter
III,
Theorem
5.6).
Now
let
us
suppose
that
we
are
given
a
“valuation”
v
∈
Q≥0
·
log(q)
(where
Q≥0
is
the
set
of
nonnegative
rational
numbers,
and
“log(q)”
is
a
formal
symbol).
In
the
following,
we
will
write
exp(v)
=
q
v/log(q)
def
We
would
like
to
construct,
for
each
integer
i
≥
0,
an
S-ﬂat
coherent
sheaf
{v})
F
i
(Ret†
EC
,[d]
d
196
on
Cd
associated
to
v,
as
follows.
First
of
all,
over
US
=
S
−
D,
we
have
F
i
(Ret†
EC
,[d]
def
{v})|US
F
i
(Ret†
=
EC
,[d]
d
Next,
let
us
deﬁne
F
i
(Ret†
EC
,[d]
d
{v})
over
ES
by
using
the
direct
sum
decomposition
given
d
{v})|E
the
integral
structure
(relative
to
above
in
the
following
way:
We
give
F
i
(Ret†
S
EC
,[d]
d
this
decomposition)
deﬁned
by:
i
{v})|E
et
F
(R
†
EC
,[d]
d
|US
)
S
def
=
i−1


1
⊗j
·
exp(−v)
·
τE
|E
OE
⊕
S
S
j!
j=1
{v})
over
the
completions
of
Ed
at
the
other
d
−
1
connected
We
then
deﬁne
F
i
(Ret†
EC
,[d]
d
components
of
Ed
in
a
similar
way,
using
the
translated
direct
sum
decompositions
discussed
above.
{v})
over
all
of
Ed
.
Thus,
it
remains
to
Now
observe
that
we
have
deﬁned
F
i
(Ret†
EC
,[d]
d
extend
the
resulting
vector
bundle
over
Ed
over
Cd
(in
some
sort
of
natural
fashion).
But
this
is
just
a
matter
of
elementary
commutative
algebra,
which
we
review
in
Lemma
1.1
below.
In
fact,
Lemma
1.1
will
also
show
that
there
is
a
unique
extension
of
this
vector
bundle
on
Ed
over
Cd
which
is
S-ﬂat,
coherent,
and
satisﬁes
the
property
that
any
length
2
regular
sequence
of
local
sections
of
OCd
is
also
regular
on
this
extension.
Relative
to
the
application
of
Lemma
1.1,
we
remark
that:
(1)
All
of
the
notation
used
in
Lemma
1.1
is
strictly
internal
to
Lemma
1.1
and
has
nothing
to
do
with
the
notation
in
the
remainder
of
the
discussion
of
this
§.
(2)
Of
course,
in
general,
Cd
need
not
be
regular,
but
it
suﬃces
to
prove
extendability
in
the
universal
case
(e.g.,
the
“EN
→
SN
”
of
Chapter
IV,
§4,
for
“N
”
taken
to
be
d),
in
which
case
Cd
is
regular,
and
the
nodes
of
Cd
(with
the
reduced
induced
scheme
structure)
are
regular
of
dimension
dim(Cd
)
−
2.
This
completes
the
deﬁnition
of
the
S-ﬂat
coherent
sheaf
{v})
F
i
(Ret†
EC
,[d]
d
on
Cd
.
197
def
Lemma
1.1.
Let
A
be
a
regular
local
ring
of
dimension
≥
2.
Let
B
=
A/(s,
t)
be
a
quotient
which
is
regular
local
ring
of
dimension
dim(A)
−
2.
Let
F
be
a
vector
bundle
def
def
on
U
=
Spec(A)\Spec(B)
⊆
X
=
Spec(B).
Then
i∗
F
is
a
coherent
sheaf
on
X
with
the
property
that
any
A-regular
sequence
of
length
2
in
A
is
also
(i∗
F)-regular.
Thus,
in
particular,
if
dim(A)
=
2,
then
i∗
F
is
a
vector
bundle
on
X.
Proof.
It
is
well-known
that
in
this
situation,
i∗
F
is
a
coherent
sheaf
(cf.,
e.g.,
[SGA2],
p.
97,
Proposition
3.2).
As
for
the
assertions
concerning
depth,
we
reason
as
follows:
Let
a,
b
∈
A
be
regular
on
A.
Then
b
acts
injectively
on
any
localization
of
A/(a).
Thus,
the
long
exact
sequence
obtained
by
applying
the
derived
functors
of
i∗
to
0
a
−→
F
−→
F
−→
F/a
·
F
−→
0
shows
that
a
acts
injectively
on
i∗
F,
and
that
we
have
an
inclusion
(i∗
F)/a
→
i∗
(F/a
·
F).
On
the
other
hand,
F/a
·
F
is
just
a
vector
bundle
over
some
open
subscheme
of
Spec(A/(a)),
so
multiplication
by
b
is
injective
on
F/a
·
F,
hence
also
on
i∗
(F/a
·
F),
as
well
as
(i∗
F)/a.
This
shows
that
a,
b
is
regular
on
i∗
F,
as
desired.
If
dim(A)
=
2,
then
this
shows
that
i∗
F
has
depth
2
as
an
A-module,
hence
(by
the
Auslander-Buchsbaum
formula
–
see,
e.g.,
[Mats])
is
a
vector
bundle.
This
completes
the
proof.

{v})
has
a
ﬁltration
As
remarked
above,
F
i
(Ret†
EC
,[d]
d
0
⊆
.
.
.
⊆
F
j
(Ret†
EC
,[d]
{v})
⊆
.
.
.
⊆
F
i
(Ret†
{v})
EC
,[d]
d
d
(where
1
≤
j
≤
i)
whose
subquotients
admit
natural
inclusions
{v})
⊆
(F
j+1
/F
j
)(Ret†
EC
,[d]
1
·
exp(−v)
·
τE⊗j
|Cd
j!
d
Moreover,
if
v1
≤
v2
,
then
we
have
a
natural
inclusion
F
i
(Ret†
EC
,[d]
{v1
})
⊆
F
i
(Ret†
{v2
})
EC
,[d]
d
d
We
denote
the
union
of
all
of
these
sheaves
(as
v
ranges
over
all
elements
of
Q≥0
·
log(q))
by
{∞})
F
i
(Ret†
EC
,[d]
d
198
We
summarize
the
properties
of
these
sheaves
as
follows:
Proposition
1.2.
The
quasi-coherent
sheaf
of
OCd
-modules
Ret†
{v}

def
=
EC
,[d]
i≥0
d
{v})
F
i
(Ret†
EC
,[d]
d
comes
equipped
with
an
exhaustive
ﬁltration
{v})
F
i
(Ret†
EC
,[d]
d
(for
i
≥
0)
whose
i-th
member
is
an
S-ﬂat
coherent
sheaf
(of
generic
rank
i)
on
Cd
.
Moreover,
this
quasi-coherent
sheaf
restricts
(as
a
ﬁltered
object)
to
Ret†
(as
in
Chapter
EC
,[d]
d
V,
Theorem
3.1)
away
from
the
divisor
at
inﬁnity.
Finally,
the
natural
morphisms
{v})
→
(F
i+1
/F
i
)(Ret†
EC
,[d]
1
·
exp(−v)
·
OCd
⊗OS
τE⊗i
i!
d
(if
i
≥
1)
and
F
1
(Ret†
EC
,[d]
{v})
→
OCd
d
arising
from
Chapter
V,
Theorem
3.1,
are
isomorphisms
over
Ed
,
i.e.,
away
from
the
nodes
of
Cd
.
By
pulling
back
these
various
objects
from
Cd
to
C∞,S
and
E∞,S
,
we
obtain
cor†
†
responding
sheaves
over
C∞,S
and
E∞,S
(cf.
the
construction
of
EC∞,S
,[d]
,
E∞,[d]
=
†
EE∞,S
,[d]
→
E∞,S
in
Chapter
V,
§2).
Naturally,
if
we
are
given
diﬀerent
sequences
vι
at
the
various
connected
components
ι
of
the
divisor
at
inﬁnity
of
S,
then
we
may
adjust
the
integral
structure
according
to
the
sequence
vι
at
ι,
and
thus
obtain
global
objects
suﬃxed
def
by
“{v},”
where
v
=
{vι
}ι
.
(We
leave
the
formal
details
to
the
reader.)
In
particular,
if
L
is
a
metrized
line
bundle
on
E∞,S
of
relative
degree
d
and
whose
curvatures
are
d-invariant
(i.e.,
a
metrized
line
bundle
of
the
sort
considered
in
Chapter
V,
§2),
then
by
taking
global
sections
over
E∞,S
of
199
L
⊗OE∞,S
F
i
(Ret†
{v})
E∞,[d]
(for
i
≥
0)
we
obtain
a
natural
metrized
vector
bundle
(of
rank
d
·
i)
with
GL
-action
(fS
)∗
(L|
†
E∞,[d]
)<i
{v,
et}
(
⊇
(fS
)∗
(L|
†
)<i
)
E∞,[d]
on
S∞
.
Deﬁnition
1.3.
forwards.
In
the
following,
we
shall
refer
to
these
push-forwards
as
{v,
et}-push
§2.
Compatibility
with
Base-Change
In
this
§,
we
study
the
push-forwards
deﬁned
in
§1
and
show,
in
particular,
that
these
push-forwards
are
compatible
with
base-change
if
and
only
if
they
are
compatible
with
base-change
“modulo
p.”
We
will
then
show,
in
certain
special
cases,
compatibility
with
base-change
modulo
p
in
§4
below,
and
thus
conclude
(in
§4)
that
(at
least
in
these
cases)
the
various
push-forwards
deﬁned
in
§1
are
compatible
with
base-change.
In
this
§,
we
continue
to
use
the
notation
of
§1.
Let
us
suppose
that
we
are
also
given
an
m-torsion
point
η
∈
E∞,S
(S∞
)
(where
m
≥
1
is
an
integer)
as
in
Chapter
V,
§1.
Then,
by
pulling
back
the
metrized
line
bundles
constructed
in
the
universal
case
in
Chapter
V,
§1,
we
obtain
metrized
line
bundles
Lst,η
;
ev
Lst,η
on
E∞,S
.
Let
us
take
the
metrized
line
bundle
L
(in
the
discussion
at
the
end
of
§1)
to
be
ev
Lst,η
(respectively,
Lst,η
)
if
d
is
odd
(respectively,
even).
Then,
in
this
§,
we
would
like
to
study
the
{v,
et}-push
forwards
(fS
)∗
(L|
†
E∞,[d]
200
)<j
{v,
et}
(for
j
≥
1)
on
S∞
.
In
particular,
we
would
like
to
study
the
extent
to
which
these
pushforwards
are
compatible
with
base-change,
among
bases
S
log
as
in
§1
(=as
in
Chapter
V,
§2),
i.e.,
bases
such
that
the
pull-back
of
divisor
at
inﬁnity
of
(M1,0
)Z
is
a
Cartier
divisor
on
S
and
for
which
the
q-parameter
locally
admits
a
d-th
root.
def
First
observe
that
over
US
=
S
−
D,
compatibility
with
base-change
follows
immediately
from
elementary
algebraic
geometry
(cf.,
e.g.,
[Harts],
Chapter
III,
Corollary
12.9,
Theorem
12.11),
since:
(i)
the
sheaf
Ret
admits
a
ﬁltration
with
subquotients
which
are
(locally
on
S)
isomorphic
to
the
structure
sheaf
(Proposition
1.2);
(ii)
the
higher
direct
image
sheaves
of
the
line
bundle
L|US
with
respect
to
the
morphism
E|US
→
US
vanish.
Thus,
it
suﬃces
to
localize
S
to
a
neighborhood
of
an
arbitrary
point
of
D.
In
the
following
discussion,
we
will
often
carry
out
such
localizations
without
further
justiﬁcation.
In
particular,
we
may
assume
that
“there
is
only
one
ι,”
i.e.,
that
D
is
irreducible.
Let
us
consider
the
line
bundle
L.
Without
loss
of
generality,
we
assume
in
the
case
of
d
even
that
the
q-parameter
has
a
2d-th
root
on
S.
(This
may
always
be
achieved
by
replacing
S
by
a
ﬁnite,
ﬂat
covering
of
S;
since
this
covering
will
be
ﬂat,
it
will
not
eﬀect
compatibility
with
base-change
issues.)
If
d
is
even,
then
we
let
β
∈
E∞,S
(S)
be
a
2d-torsion
point
as
in
Chapter
IV,
Lemma
5.4.
Now,
we
let
M
ev
be
the
metrized
line
bundle
Lst
(respectively,
Tβ∗
Lst
)
if
d
is
odd
(respectively,
even).
(Here,
“Tβ
”
is
the
automorphism
of
E∞,S
given
by
translation
by
β.)
Note
that
the
curvature
of
M
is
the
same
as
that
of
L
(cf.
Chapter
V,
the
discussion
preceding
Proposition
1.1,
for
a
computation
of
the
curvature
of
L;
Chapter
IV,
Lemma
5.4,
for
a
computation
of
the
curvature
of
M).
Moreover,
it
is
clear
from
the
deﬁnitions
of
L
and
M
on
E∞,S
|US
(namely,
both
are
obtained
by
translating
a
multiple
of
the
divisor
deﬁned
by
the
identity
element
by
some
torsion
point)
that
there
exists
an
integer
N
≥
1
such
that
(after
possibly
localizing
S
further)
we
obtain
an
isomorphism
of
metrized
line
bundles:
L
⊗N
⊗N
∼
=M
In
particular,
it
follows
that
we
may
write
L=M⊗Q
⊗N
is
trivial.
Note,
moreover,
that
where
Q
is
a
metrized
line
bundle
on
E∞,S
such
that
Q
M
is
represented
by
a
line
bundle
on
Cd
in
the
usual
sense
(cf.
Chapter
IV,
Lemma
5.4).
The
point
here
(cf.
the
proof
of
Chapter
IV,
Theorem
5.8)
is
that
we
would
like
to
reduce
compatibility
with
base-change
assertions
concerning
the
metrized
line
bundle
L
(which
is
a
delicate
issue)
to
compatibility
with
base-change
assertions
for
the
“line
bundle
in
the
usual
sense
M”
(an
issue
which
is
well-known
from
elementary
algebraic
geometry).
201
Thus,
M
is
a
line
bundle
in
the
usual
sense
on
Cd
.
Let
us
assume
(without
loss
of
generality)
that
the
q-parameter
on
S
admits
an
2N
·
d-th
root.
Then
it
follows
that
there
exists
a
ﬁnite
isogeny
Ed
→
Ed
(of
degree
N
)
whose
kernel
is
isomorphic
to
μN
.
Moreover,
this
isogeny
compactiﬁes
to
a
diagram
Ed
⏐
⏐

⊆
Cd
⏐
⏐

Ed
⊆
Cd
The
purpose
of
introducing
Ed
is
that
the
pull-back
of
the
metrized
line
bundle
Q
to
E∞,S
is
a
line
bundle
in
the
usual
sense.
Indeed,
to
see
this,
one
reasons
as
follows:
First
of
all,
observe
(from
the
general
theory
of
abelian
schemes)
that
the
kernel
of
the
pull-back
morphism
on
Picard
groups
induced
by
the
isogeny
E∞,S
|US
→
E∞,S
|US
is
the
Cartier
dual
of
Ker(E∞,S
|US
→
E∞,S
|US
)
=
μN
.
Thus,
the
kernel
of
the
pull-back
morphism
is
Z/N
Z
(cf.
the
discussion
in
Chapter
IV,
§2,
of
the
isogenies
“E
[n]
→
E
→
E”
and
line
bundles
on
E
which
become
trivial
when
pulled
back
to
E
[n]
).
In
other
words,
if
one
thinks
of
the
subscheme
of
N
-torsion
points
of
E∞,S
|US
as
μN
×
(Z/N
Z),
then
this
kernel
is
generated
by
the
line
bundle
corresponding
to
a
divisor
of
the
form
τ
−
eE∞,S
,
where
eE∞,S
is
the
identity
element
of
E∞,S
,
and
τ
is
an
N
-torsion
point
whose
projection
to
Z/N
Z
generates
Z/N
Z.
In
particular,
this
means
that
the
pull-back
of
Q|US
to
E∞,S
|US
is
isomorphic
to
the
pull-back
to
E∞,S
|US
of
the
line
bundle
associated
to
a
divisor
of
the
form
τ
−
eE∞,S
,
where
τ
∈
μN
(S)
⊆
E(S)
⊆
E∞,S
(S).
On
the
other
hand,
note
that
for
such
a
τ
,
the
line
bundle
(in
the
usual
sense)
OCd
(τ
−
eCd
)
already
forms
a
metrized
line
bundle
on


E∞,S
whose
curvature
is
zero.
Thus,
in
summary,
Q|E∞,S
and
OCd
(τ
−
eCd
)|E∞,S
have
isomorphic
restrictions
to
E∞,S
|US
and,
moreover,
both
have
curvature
zero.
In
particular,
by
Chapter
IV,
Proposition
4.3,
it
follows
that
these
two
metrized
line
bundles
on
E∞,S

are
isomorphic,
i.e.,
that
the
metrized
line
bundle
Q|E∞,S
is
represented
by
a
line
bundle
in
the
usual
sense
on
Cd
,
as
desired.
Thus,
to
summarize,
we
have
L
=
M
⊗
Q,
where
M
arises
from
a
line
bundle
in

the
usual
sense
on
Cd
;
and
Q|E∞,S
arises
from
a
line
bundle
in
the
usual
sense
on
Cd
.
In
particular,
we
conclude
that:

The
metrized
line
bundle
L|E∞,S
arises
from
a
line
bundle
P
in
the
usual
sense
on
Cd
.
Moreover,
the
restriction
of
P
to
each
to
the
irreducible
components
of
the
special
ﬁber
of
Cd
is
of
degree
N
(since
Ed
→
Ed
is
of
degree
N
).
Now
ﬁx
an
integer
j
≥
1,
and
let
def
F
=
F
j
(Ret†
EC
,[d]
d
202
{v})|Cd
Thus,
F
is
an
S-ﬂat
coherent
sheaf
on
Cd
whose
restriction
to
Ed
is
a
vector
bundle
of
rank
j
which
admits
a
ﬁltration
whose
subquotients
are
isomorphic
to
OEd
.
Moreover,
the
push-forwards
(fS
)∗
(L|
†
E∞,[d]
)<j
{v,
et}
that
we
are
interested
in
are
simply
the
μN
-invariant
portions
of
f∗
(F
⊗OC

P)
d
(where,
in
the
following,
we
shall
write
f∗
for
the
push-forwards
to
S
of
objects
on
Cd
or
Ed
)
with
respect
to
the
evident
natural
μN
-action.
Thus,
since
the
group
scheme
μN
is
of
multiplicative
type,
hence
reductive
(so
the
operation
of
“taking
the
μN
-invariant
part”
commutes
with
base-change),
it
follows
that:
The
issue
of
the
compatibility
of
the
push-forward
(fS
)∗
(L|
†
E∞,[d]
)<j
{v,
et}
with
base-change
may
be
reduced
to
the
issue
of
the
compatibility
of
the
push-forward
f∗
(F
⊗OC

P)
=
f∗
{(F
⊗OC

P)|Ed
}
with
base-change.
d
d
At
this
point,
before
we
continue
to
study
compatibility
with
base-change
issues
further,
we
pause
to
note
the
following
important
lemma:
Lemma
2.1.
The
metrized
vector
bundle
(fS
)∗
(L|
†
E∞,[d]
)<j
{v,
et}
(which
a
priori
–
cf.
Chapter
IV,
Deﬁnition
5.2
–
is
just
a
quasi-coherent
sheaf
on
S∞
)
is,
in
fact,
a
coherent
sheaf
on
S∞
.
If,
moreover,
the
classifying
morphism
S
→
(M1,0
)Z
is
ﬂat,
then
this
coherent
sheaf
is,
in
fact,
a
vector
bundle
on
S∞
.
Proof.
Indeed,
the
above
discussion
shows
that
this
metrized
vector
bundle
is
just
the
μN
-invariant
portion
of
the
push-forward
f∗
(F
⊗OC

P)
d
203
On
the
other
hand,
this
latter
push-forward
is
clearly
a
coherent
sheaf
of
OS∞
-modules.
Thus,
the
metrized
vector
bundle
(fS
)∗
(L|
†
)<j
{v,
et}
is,
in
fact,
a
coherent
sheaf
of
E∞,[d]
OS∞
-modules,
as
desired.
If
the
classifying
morphism
is
ﬂat,
then
formation
of
push-forwards
is
compatible
with
base-change,
so
we
reduce
immediately
to
the
“universal
case”
–
i.e.,
where
S
is,
say,
of
1
the
form
Spec(O[[q
2N
·d
]]),
and
O
is
the
Zariski
localization
of
the
ring
of
integers
of
a
number
ﬁeld.
In
this
case,
S∞
is
a
projective
limit
of
regular
schemes
of
dimension
2,
so
we
conclude
from
from
Lemma
1.1
that
“any
metrized
vector
bundle
on
S∞
which
is
a
coherent
sheaf
of
OS∞
-modules
is,
in
fact,
a
vector
bundle
on
S∞
,”
as
desired.

Next,
we
consider
base-change
issues.
The
following
result
follows
from
elementary
homological
algebra:
Lemma
2.2.
Let
A
be
a
quasi-coherent
OS
-algebra.
Then
we
have
an
exact
sequence:
f∗
{(F
⊗OC

P)|Ed
}
⊗OS
A
→
f∗
{(F
⊗OC

P)|Ed
⊗OS
A}
d
d
1
S
→
T
or
O
1
(R
f∗
{(F
⊗OC

P)|Ed
},
A)
→
0
d
Moreover,
when
j
=
1,
i.e.,
F
=
OCd
,
we
have
R1
f∗
(F
⊗OC

P)
=
0,
and
f∗
(F
⊗OC

d
P)
⊗OS
A
=
f∗
(F
⊗OC

P
⊗OS
A).
d
d
Proof.
Indeed,
the
exact
sequence
follows
by
considering
the
usual
spectral
sequence
relating
H
∗
(C
·
)
⊗OS
A
and
H
∗
(C
·
⊗OS
A),
where
C
·
is
a
complex
of
ﬂat,
coherent
OS
modules.
In
this
case,
since
the
push-forward
functor
f∗
has
cohomological
dimension
≤
1,
the
complex
C
·
may,
in
fact,
be
taken
to
consist
of
just
two
terms,
i.e.,
C
·
may
be
written
C
0
→
C
1
.
The
case
j
=
1
follows
by
considering
the
fact
that
P
is
a
line
bundle
whose
restriction
to
each
of
the
irreducible
components
of
the
special
ﬁber
of
Cd
is
of
degree
N
≥
1,
and
applying
[Harts],
Chapter
III,
Corollary
12.9,
Theorem
12.11.

Now
let
us
suppose
that
S
is
the
spectrum
of
a
regular
local
ring
of
dimension
2.
Suppose
that
α,
β
are
a
system
of
regular
parameters
for
this
regular
local
ring,
and
that
V
(β)
⊆
S
is
set-theoretically
equal
to
the
divisor
at
inﬁnity
D
⊆
S.
Suppose,
moreover,
that
we
know
that
the
morphism
f∗
{(F
⊗OC

P)|Ed
}
⊗OS
A
→
f∗
{(F
⊗OC

P)|Ed
⊗OS
A}
d
d
is
surjective
when
A
is
taken
to
be
OS
/(α).
Then
I
claim
that
it
follows
that
this
morphism
is
surjective
for
all
A
on
which
β
acts
injectively.
Indeed,
our
assumption
concerning
the
case
when
A
=
OS
/(α)
implies
that
204
1
S
T
orO
1
(R
f∗
{(F
⊗OC

P)|Ed
},
OS
/(α))
=
0
d
def
i.e.,
that
α
acts
injectively
on
the
coherent
sheaf
B
=
R1
f∗
{(F
⊗OC

P)|Ed
}.
Note
that
d
although
B
itself
might
not
be
ﬁnitely
generated
over
OS
,
it
may
be
written
as
a
direct
limit
of
ﬁnitely
generated
OS
-submodules
B
⊆
B.
Note
that
since
α
acts
injectively
on
B,
it
also
acts
injectively
on
B
.
Similarly,
since
B
is
set-theoretically
supported
on
D,
it
follows
that
B
is
also
set-theoretically
supported
on
D.
But
this
implies
that
the
OS
-module
B
has
depth
≥
1,
hence
(by
the
“Auslander-Buchsbaum
Formula”
–
cf.,
e.g.,
[Mats])
that
the
OS
-module
B
has
cohomological
dimension
≤
1.
Since,
moreover,
B
is
(set-theoretically)
supported
on
D,
we
thus
conclude
that
there
exists
an
exact
sequence
0
−→
OSr
φ
−→
OSr
−→
B
−→
0
(where
r
is
an
integer).
Moreover,
since
the
zero
locus
of
det(φ)
∈
OS
is
set-theoretically
equal
to
D,
we
conclude
that
there
exists
an
OS
-linear
morphism
ψ
:
OSr
→
OSr
such
that
ψ
◦
φ
=
β
a
,
for
some
integer
a
≥
0.
In
particular,
we
conclude
that
the
above
exact
sequence
remains
exact
after
tensoring
with
any
A
on
which
β
acts
injectively.
But
this
S
implies
that
for
such
an
A,
we
have
T
orO
1
(B
,
A)
=
0,
hence
(since
T
or
commutes
with
S
ﬁltered
direct
limits)
that
T
orO
1
(B,
A)
=
0,
as
claimed.
In
fact,
in
our
situation,
instead
of
being
given
that
the
entire
morphism
f∗
{(F
⊗OC

P)|Ed
}
⊗OS
A
→
f∗
{(F
⊗OC

P)|Ed
⊗OS
A}
d
d
is
surjective
when
A
=
O/(α),
we
will
instead
just
be
given
that
its
μN
-invariant
portion
is
surjective
when
A
=
O/(α).
But
since
μN
is
of
multiplicative
type,
it
is
clear
that
the
argument
of
the
preceding
paragraph
then
allows
one
to
conclude
the
surjectivity
of
the
μN
-invariant
portion
of
this
morphism
for
any
A
on
which
β
acts
injectively.
In
other
words,
we
have
proven
the
following:
Lemma
2.3.
Suppose
that
S
is
the
spectrum
of
a
regular
local
ring
of
dimension
2.
Suppose
that
α,
β
are
a
system
of
regular
parameters
for
this
regular
local
ring,
and
that
V
(β)
⊆
S
is
set-theoretically
equal
to
the
divisor
at
inﬁnity
D
⊆
S.
Suppose,
moreover,
that
we
know
that
the
morphism
f∗
{(F
⊗OC

P)|Ed
}
⊗OS
A
→
f∗
{(F
⊗OC

P)|Ed
⊗OS
A}
d
d
is
surjective
on
μN
-invariant
parts
when
A
is
taken
to
be
OS
/(α).
Then
it
follows
that
this
morphism
is
surjective
on
μN
-invariant
parts
for
all
A
on
which
β
acts
injectively.
205
§3.
The
Comparison
Isomorphism
in
Characteristic
Zero
The
purpose
of
the
present
§
is
to
show
that
for
appropriate
choices
of
the
metrized
line
bundle
L
(cf.
Chapter
V,
§1),
certain
slightly
modiﬁed
versions
of
the
evaluation
maps
of
Chapter
V,
Propositions
2.2,
2.3,
are
isomorphisms
in
characteristic
zero.
In
this
§,
we
use
the
notation
of
§1.
Let
us
suppose
that
we
are
also
given
an
m-torsion
point
η
∈
E∞,S
(S∞
)
(where
m
≥
1
is
an
integer)
as
in
Chapter
V,
§1.
Then,
by
pulling
back
the
metrized
line
bundles
constructed
in
the
universal
case
in
Chapter
V,
§1,
we
obtain
metrized
line
bundles
Lst,η
;
ev
Lst,η
on
E∞,S
.
We
are
now
ready
to
state
and
prove
the
following
result:
Theorem
3.1.
(Comparison
Isomorphism
in
Characteristic
Zero)
Let
d,
m
≥
1
be
integers
such
that
m
does
not
divide
d.
Suppose
that
S
log
is
a
ﬁne
noetherian
log
scheme,
and
let
C
log
→
S
log
be
a
log
elliptic
curve
over
S
log
such
that
the
“divisor
at
inﬁnity”
D
⊆
S
(i.e.,
the
pullback
of
the
divisor
at
inﬁnity
of
(M1,0
)Z
via
the
classifying
morphism
S
→
(M1,0
)Z
)
is
a
Cartier
divisor
on
S.
Also,
let
us
assume
that
étale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root,
and
that
the
classifying
morphism
S
→
(M1,0
)Z
associated
to
C
log
→
S
log
is
ﬂat
in
a
neighborhood
of
D.
(Note
that
this
ﬂatness
automatically
holds
whenever
S
is
of
characteristic
zero.)
Suppose,
moreover,
we
are
given
a
torsion
point
η
∈
E∞,S
(S∞
)
of
order
precisely
m
which
(according
to
the
discussion
preceding
Chapter
V,
Proposition
ev
def
1.1)
deﬁnes
line
bundles
Lst,η
,
Lst,η
.
If
d
is
odd
(respectively,
even),
then
let
L
=
Lst,η
def
ev
(respectively,
L
=
Lst,η
).
Then:
(1)
For
any
collection
v
=
{vι
}ι
of
elements
of
Q≥0
·
log(q)
∞
(one
for
each
connected
component
ι
of
the
divisor
at
inﬁnity
D),
the
evaluation
map
of
Chapter
V,
Proposition
2.2
(for
“α”
taken
to
be
0)
factors
206
through
the
metrized
vector
bundle
(fS
)∗
(L|
†
E∞,[d]
)<d
{v,
et}
of
§1
to
de-
ﬁne
a
natural
morphism
Ξ{v,
et}
:
(fS
)∗
(L|
†
E∞,[d]
)<d
{v,
et}
→
(fS
)∗
(L|
†
)
(d
E∞
)
(2)
If
vι
=
∞
for
all
ι,
then
Ξ{v,
et}
⊗
Q
is
an
isomorphism.
Moreover,
at
each
ι,
there
exists
a
unique
sequence
aι
=
{(aι
)0
,
.
.
.
,
(aι
)d−1
}
of
elements
of
Q≥0
·log(q)
such
that
the
natural
inclusions
F
j
((fS
)∗
(L|
†
E∞,[d]
)<d
{(aι
)j−1
,
et})
⊆
F
j
((fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et})
are
all
equalities
and
the
natural
projections
(F
j
/F
j−1
)((fS
)∗
(L|
†
E∞,[d]
)<d
{(aι
)j−1
,
et})
−→
1
·
exp(−(aι
)j−1
)
·
(fS
)∗
(L|E∞,S
)
⊗OS
τE⊗j−1
(j
−
1)!
(where
j
=
1,
.
.
.
,
d)
are
surjective
(hence
bijective).
(3)
Finally,
these
sequences
aι
satisfy
the
following
condition:
for
each
connected
component
ι,
there
is
an
Xι
∈
{I,
II,
III}
such
that
(aι
)j−1
=
1
·
cj
d
where
cj
is
as
in
Chapter
V,
§4,
for
Case
Xι
.
Proof.
First,
let
us
observe
that
since
the
classifying
morphism
S
→
(M1,0
)Z
is
ﬂat
in
a
neighborhood
of
inﬁnity,
the
various
push-forwards
(fS
)∗
(along
with
their
ﬁltrations)
207
are
compatible
with
base-change
(cf.
Lemma
2.2).
(Note
that
in
characteristic
zero,
the
classifying
morphism
factors
through
(M1,0
)Q
,
which
is
regular
of
dimension
one.
Thus,
ﬂatness
follows
from
the
assumption
that
the
q-parameter
is
a
non-zero
divisor,
i.e.,
that
the
closed
subscheme
D
is
a
Cartier
divisor
on
S.)
Thus,
it
suﬃces
to
prove
Theorem
def
3.1
in
the
“universal
case”
–
for
instance,
in
the
case
of
S
=
T
,
where
T
→
B
is
any
“nice
covering,”
as
in
Chapter
V,
Proposition
1.2,
such
that
at
each
ι,
the
corresponding
q-parameter
has
a
d-th
root
in
OT
.
Next,
note
that
to
see
that
the
evaluation
map
of
Chapter
V,
Proposition
2.2,
factors
as
claimed
in
(1),
it
suﬃces
to
prove
that
it
factors
in
characteristic
zero.
Indeed,
once
it
factors
in
characteristic
zero,
the
fact
that
it
also
factors
away
from
the
divisor
at
inﬁnity
(cf.
Proposition
1.2;
the
integrality
statement
at
the
end
of
Chapter
V,
Theorem
3.1)
implies
–
since
S
=
T
is
ﬁnite,
ﬂat
over
(M1,0
)Z
,
which
is
regular
–
that
it
factors
over
all
of
S
=
T
.
Similarly,
the
natural
inclusions
of
(2)
are
equalities
if
and
only
if
they
are
equalities
in
characteristic
zero.
Indeed,
if
they
are
equalities
in
characteristic
zero,
then
both
sides
are
vector
bundles
(cf.
Lemma
2.1)
which
are
tautologically
equal
away
from
the
divisor
at
inﬁnity.
Thus,
in
summary,
except
for
the
surjectivity
of
the
natural
projections
in
(2),
it
suﬃces
to
prove
Theorem
3.1
in
characteristic
zero.
In
particular,
for
the
remainder
of
the
proof
(except
where
speciﬁed
otherwise),
We
assume
that
S
is
T
⊗
Q,
where
T
is
as
above.
Also,
to
simplify
the
discussion,
we
assume
that
S
is
connected.
Thus,
the
base
S
is
a
smooth,
proper
curve
over
a
ﬁeld
of
characteristic
zero.
Now
we
divide
the
proof
into
parts:
Local
Assertions:
Let
us
ﬁrst
show
that
the
evaluation
map
factors
as
stated
in
(1)
for
any
choice
of
v,
and
that
the
natural
projections
of
(2)
(F
j
/F
j−1
)((fS
)∗
(L|
†
E∞,[d]
)<d
{(aι
)j−1
,
et})
−→
1
·
exp(−(aι
)j−1
)
·
(fS
)∗
(L|E∞,S
)
⊗OS
τE⊗j−1
(j
−
1)!
are
surjective
for
the
special
choice
of
v
referred
in
(2)
and
(3).
Since
these
are
local
issues
at
inﬁnity,
we
assume
(just
for
this
“Local
Assertions”
part
of
the
proof)
that
S
=
Spec(A)
208
def
1
where
A
=
O[[q
N
·d
]]
(where
N
=
2m
·
d),
and
O
is
a
Zariski
localization
of
the
ring
of
integers
of
a
number
ﬁeld.
Let
KH
=
Z/dZ
⊆
d
E
be
the
subgroup
corresponding
to
the
1
d-th
root
q
d
of
q.
Thus,
we
have
a
ﬁnite
étale
isogeny
Ed
→
Ed
/KH
=
EH
One
checks
easily
(using
Chapter
IV,
Lemma
5.4
–
cf.
the
argument
in
the
“Alternate
Proof
of
Theorem
6.2”
in
Chapter
V,
§6)
that
L
descends
to
a
metrized
line
bundle
LH
of
relative
degree
1
on
E∞H
,S
.
Thus,
there
exists
a
Lagrangian
subgroup
(cf.
the
discussion
of
such
subgroups
in
Chapter
IV,
§1)
H
⊆
GL
Note
that
the
{v,
et}-push
forwards,
as
well
as
the
evaluation
maps
Ξ{v,
et}
all
have
“subscript
H
versions”
(obtained
by
taking
“H-invariants”
of
the
original
versions
discussed
above).
We
leave
the
routine
details
to
the
reader.
†
†
Next,
let
us
note
that
d
E∞H
⊆
E∞H
,[d]
lies
inside
the
canonical
section
derived
from
κ.
Indeed,
this
follows
from
the
facts
that:
(i)
the
canonical
section
is
a
group
homomorphism
(Chapter
III,
Theorem
2.1);
(ii)
WE
has
no
torsion
since
our
base
S
is
Z-ﬂat;
and
†
(iii)
the
image
of
d
E∞H
in
E∞H
,S
lies
in
the
identity
component
of
the
special
ﬁber
of
E∞H
,S
.
Since
the
modiﬁcations
in
integral
structure
that
one
performs
in
order
to
construct
the
{v,
et}-push-forward
(for
any
v)
are
all
done
using
the
splittings
deﬁned
by
the
canonical
section
(derived
from
κ),
it
is
a
tautology
that
all
sections
of
the
{v,
et}-push-forward
which
have
“denominators”
relative
to
the
usual
push-forward
vanish
(i.e.,
modulo
the
sections
which
do
not
have
denominators
relative
to
the
usual
push-forward)
when
restricted
to
†
the
canonical
section,
hence
when
restricted
to
d
E∞H
.
Thus,
it
follows
that
the
evaluation
map
of
Chapter
V,
Proposition
2.2,
factors
as
claimed
in
(1)
(for
any
v).
Next,
let
us
observe
that
“metrically
speaking”
LH
is
the
same
as
the
metrized
line
bundle
OE∞H
,S
([eE∞H
,S
]).
More
precisely,
we
have:
⊗m·d
LH
∼
=
OE∞H
,S
(m
·
d
·
[eE∞H
,S
])
Indeed,
if
we
forget
about
metrics,
this
follows
from
the
linear
equivalence
m(d
·
[η])
∼
m
·
d
·
[e]
on
E∞,S
|US
pushed
forward
from
E∞,S
to
E∞H
,S
.
Moreover,
it
follows
from
the
209
computation
of
the
curvature
of
L
(in
the
discussion
preceding
Chapter
V,
Proposition
1.1)
that
both
sides
have
the
same
curvature.
Thus,
by
Chapter
IV,
Proposition
4.3,
it
follows
that
these
two
metrized
line
bundles
are
isomorphic.
(Indeed,
it
is
easy
to
check
that
the
constant
“C”
in
Chapter
IV,
Proposition
4.3,
may
be
taken
to
be
zero
in
this
case).
In
particular,
it
follows
that
LH
diﬀers
from
OE∞H
,S
([eE∞H
,S
])
by
a
metrized
line
bundle
on
E∞H
,S
whose
(m
·
d)-th
power
is
trivial.
But,
in
the
language
of
Chapter
V,
§4,
if
we
think
of
EH
here
as
the
curve
“E”
of
Chapter
V,
§4,
then
this
amounts
to
saying
that
LH
is
the
same
as
the
“standard
line
bundle
LE
”
of
Chapter
V,
§4,
twisted
by
some
appropriate
character
χL
of
order
“n”
where
we
take
the
“n”
of
Chapter
V,
§4,
to
be
N
=
2m
·
d,
relative
to
the
notation
used
here.
This
character
χL
falls
into
one
of
the
three
“Cases”
treated
in
Chapter
V,
§4.
We
take
Xι
∈
{I,
II,
III}
to
be
the
“Case”
that
χL
falls
under
(cf.
Chapter
V,
Theorem
4.6).
Now
let
def
1
(aι
)j−1
=
d
·
cj
·
log(q)
(where
cj
is
as
in
Chapter
V,
§4),
and
apply
Chapter
V,
Theorem
4.6.
Note
that
the
“q”
N
of
Chapter
V,
§4,
which
we
write
qCh.
V,§4
,
is
such
that
qCh.
is
the
q-invariant
of
E,
V,§4
which
corresponds
to
EH
in
the
present
discussion.
Since
the
q-invariant
qEH
of
EH
is
1
equal
to
q
d
,
we
thus
see
that
1
N
q
d
=
qEH
=
qCh.
V,§4
Thus,
the
various
adjustments
of
integral
structure
used
to
form
the
{v,
et}-push-forward
are
of
the
form
exp((aι
)j−1
)
=
q
d
·cj
=
qEjH
=
q
c
1
N
·cj
Ch.
V,§4
Note,
moreover,
that
cj
=
Maxj0
≤j
(cj0
)
(where
j0
ranges
over
all
integers
≤
j
which
are
admissible
as
“j0
’s”
for
Chapter
V,
Theorem
4.6,
and
we
deﬁne
the
“Max”
of
the
empty
set
to
be
0).
Note
that
Chapter
V,
Theorem
4.6,
addresses
the
case
of
“torsorial
degree”
(cf.
Chapter
III,
Deﬁnition
2.2)
<
j
and
states
that
in
this
case,
there
exist
generators
of
the
portion
of
the
“usual”
pushforward
(i.e.,
without
the
{vι
})
corresponding
to
torsorial
degrees
j0
−
1,
.
.
.
,
j
−
1
which
1
vanish
modulo
exp((aι
)j0
−1
)
=
q
d
·cj
when
restricted
to
the
canonical
section
derived
from
κ
over
(EH
)S
.
Moreover,
if
j0
is
the
largest
“admissible
j0
”
(for
Chapter
V,
Theorem
4.6)
210
which
is
≤
j,
then
exp((aι
)j

)
=
exp((aι
)j0
−1
),
for
all
j
∈
{j0
−
1,
.
.
.
,
j
−
1}.
Thus,
if
we
divide
these
generators
by
exp((aι
)j0
−1
),
we
see
that
we
get
integral
sections
of
the
(aι
)j−1
-push-forward.
In
particular,
we
see
that
for
this
choice
of
(aι
)j−1
,
the
natural
projections
(F
j
/F
j−1
)((fS
)∗
(L|
†
E∞,[d]
)<d
{(aι
)j−1
,
et})
−→
1
·
exp(−(aι
)j−1
)
·
(fS
)∗
(L|E∞,S
)
⊗OS
τE⊗j−1
(j
−
1)!
are
surjective,
as
desired.
This
completes
the
proof
of
the
local
assertions.
Reduction
to
the
Computation
of
Degrees:
Let
us
now
return
to
our
global,
universal,
characteristic
zero
S.
Next,
let
us
observe
that,
by
Chapter
V,
Theorems
5.6
and
6.2,
it
follows
from
the
fact
that
m
does
not
divide
d
(so
d
·
η
=
0)
that
in
the
present
universal
situation,
the
evaluation
map
of
Chapter
V,
Proposition
2.2,
is
an
isomorphism
over
the
generic
point
of
S.
Thus,
now
that
we
have
shown
that
the
evaluation
map
factors
as
stated,
to
show
that
Ξ{v,
et}
is
an
isomorphism
over
all
of
S,
it
will
suﬃce
to
compute
the
degrees
of
the
metrized
vector
bundles
(of
rank
d2
)
on
both
sides,
and
show
that:
deg(domain)
≥
deg(range)
Note,
moreover,
that:
The
surjectivity
assertion
of
(2)
(proven
above)
is
necessary
in
order
to
bound
from
below
the
degree
of
the
{v,
et}-push-forward
(for
v
=
∞)
by
the
sum
of
the
degrees
of
the
various
exp(−(aι
)j−1
)
·
(fS
)∗
(L|E∞,S
)
⊗OS
τE⊗j−1
.
It
turns
out
that
the
computation
of
the
degree
diﬀers
quite
substantially,
depending
on
whether
d
is
odd
or
even.
Thus,
in
the
following
we
carry
out
the
computations
in
these
two
cases
separately.
Computation
of
the
Degree
in
the
Odd
Case:
To
complete
the
proof
of
Theorem
3.1
for
d
odd,
it
suﬃces
(as
noted
above)
to
show
that
in
the
situation
discussed
above,
the
degree
of
the
domain
of
Ξ{v,
et}
is
≥
the
degree
of
the
range.
Let
us
ﬁrst
observe
that
Chapter
V,
Proposition
1.2,
implies
that:
The
degree
of
the
range
of
Ξ{v,
et}
is
equal
to
0.
211
Thus,
it
remains
to
show
that
the
degree
of
the
{v,
et}-push-forward
(for
v
=
∞)
is
≥
0.
First,
let
us
note
that
the
surjectivity
assertion
already
proven
implies
that:
deg(v−push
−
forward)
−
deg(usual
push
−
forward)
≥
d
·
d−1

ι
=
d

ι
=
(aι
)j
j=0
cj
(Case
Xι
)
j=1
1
d(d2
−
1)
24
(in
log(q)
units),
where:
(1)
In
the
ﬁrst
inequality,
the
extra
factor
of
d
out
in
front
arises
from
the
fact
that
the
push-forward
of
the
metrized
line
bundle
L
on
E∞,S
has
rank
d.
(2)
In
the
last
equality,
we
apply
Chapter
V,
Lemma
4.2.
On
the
other
hand,
the
usual
push-forward
admits
a
ﬁltration
(by
torsorial
degree)
whose
subquotients
are
τE⊗j
⊗OS
(fS
)∗
(L|E∞,S
),
for
j
=
0,
.
.
.
,
d
−
1.
Since
the
line
bundle
τE
on
1
S
has
degree
(in
log(q)
units)
given
by
−
12
(cf.
the
proof
of
Chapter
IV,
Theorem
5.8),
we
thus
obtain
that
the
degree
of
the
usual
push-forward
is
given
by:
d−1
d

1
j)
+
d
·
deg((fS
)∗
(L|E∞,S
))
=
−
d(d2
−
1)
−
·(
12
j=0
24
(cf.
the
Remark
following
Chapter
V,
Proposition
1.1).
Thus,
putting
everything
together,
we
obtain
that
the
{v,
et}-push-forward
has
degree
≥
0,
as
desired.
This
completes
the
proof
of
the
fact
that
Ξ{v,
et}
is
an
isomorphism
for
v
=
∞.
It
also
shows
that
the
natural
inclusions
of
(2)
F
j
((fS
)∗
(L|
†
E∞,[d]
)<d
{(aι
)j−1
})
⊆
F
j
((fS
)∗
(L|
†
E∞,[d]
)<d
{∞})
are
all
equalities
(for
if
any
one
of
them
were
not
an
inequality,
it
would
follow
that
the
degree
of
the
domain
of
Ξ{∞}
is
>
the
degree
of
the
range,
which
is
absurd).
(Note
that
here
we
use
the
fact
that
the
function
j
→
(aι
)j
is
“monotone
increasing”
(i.e.,
preserves
the
relation
“≤”).)
This
completes
the
proof
of
Theorem
3.1,
for
d
odd.
212
Computation
of
the
Degree
in
the
Even
Case:
In
the
even
case,
the
computations
become
somewhat
more
complicated.
First,
let
us
note
that
by
Chapter
V,
Proposition
1.2,
we
have:
deg(range)
=
−d

ι
=
−d

ι
1
φ1
(−d
·
ηι
+
)
2
1
{φ1
(−d
·
ηι
+
)
−
φ1
(−d
·
ηι
)}
2
where
we
note
that:
(1)
The
intersection
number
of
Chapter
V,
Proposition
1.2,
must
be
multiplied
by
d2
,
since
we
have
d2
torsion
points
annihilated
by
d.
(2)
In
the
second
line,
the
sum
over
all
ι
of
the
second
term
is
zero,
since
m
does
not
divide
d
–
cf.
the
(proof
of
the)
odd
part
of
Chapter
V,
Proposition
1.2.
Next,
observe
that
for
|θ|
≤
12
,
the
function
θ
→
φ1
(θ
+
12
)
−
φ1
(θ)
is
linear,
except
at
0
and
12
(cf.
Chapter
IV,
Corollary
4.5),
and
takes
the
value
−
18
(respectively,
18
)
at
θ
=
0
(respectively,
θ
=
12
)
–
cf.
Chapter
IV,
Proposition
4.4.
It
is
easy
to
see
that
these
properties
determine
this
function
uniquely,
namely:
1
1
1
φ1
(θ
+
)
−
φ1
(θ)
=
|θ|
−
2
2
8
for
|θ|
≤
12
.
On
the
other
hand,
we
have

1
cj
(Case
Xι
)
deg(domain)
≥
−
d(d2
−
1)
+
24
ι
j=1
d


1
cj
(Case
Xι
)
+
cd
(Case
Xι
)
=
−
d(d2
−
1)
+
24
ι
j=1
ι
d−1

1
1
d(d2
−
1)
+
(d
−
1)((d
−
1)2
−
1)
+
cd
(Case
Xι
)
24
24
ι

1
d(d
−
1){−(d
+
1)
+
d
−
2}
+
cd
(Case
Xι
)
=
24
ι

1
cd
(Case
Xι
)
=
−
d(d
−
1)
+
8
ι
=−
213
where:
(1)
The
ﬁrst
line
follows
by
the
same
general
reasoning
as
in
the
odd
case.
(2)
The
third
line
follows
from
the
computation
of
the
sum
of
the
cj
’s
in
the
odd
case,
applied
to
the
odd
number
d
−
1.
Thus,
to
summarize,
we
would
like
to
prove
that


1
1
1
−
k(k
−
)
+
c2k
(Case
Xι
)
≥
−d
{φ1
(−d
·
ηι
+
)
−
φ1
(−d
·
ηι
)}
2
2
2
ι
ι
def
where
we
set
k
=
d2
.
Now,
for
each
ι,
we
would
like
to
deﬁne
a
number
iι
,
as
follows.
If
Xι
=
I
(i.e.,
we
are
in
Case
I
at
ι),
then
let
def
iι
=
m
·
d
=
mCh.
V,§4
(i.e.,
“m
·
d”
in
the
notation
of
the
present
discussion
corresponds
to
“m”
in
the
notation
of
Chapter
V,
§4
(=
mCh.
V,§4
)
–
cf.
the
discussion
of
the
“Local
Assertions”
part
of
the
proof).
If
Xι
=
II,
then
let
def
iι
=
0
If
Xι
=
III,
then
let
def
iι
=
|iχ
|
(where
|iχ
|
<
mCh.
V,§4
is
as
in
the
discussion
of
Case
III
in
Chapter
V,
§4).
Then
let
us
observe
that
it
follows
immediately
from
the
explicit
formulas
for
cd
(Case
Xι
)
in
Chapter
V,
§4,
that
we
have
cd
(Case
Xι
)
=
1
2
1
1
iι
iι
=
k(k
−
)
k
−
k·
2
2
mCh.
V,§4
2
mCh.
V,§4
(where
we
use
here
the
fact
that
d
=
2k
is
even).
Thus,
we
see
that
the
left-hand
side
of
the
inequality
that
we
would
like
to
show
may
be
written
as
follows:

1
1

1
1
1

1
iι
iι
iι
)=
)=−
−1)
−
k(k−
)+
k(k−
k(
−
d(2
2
2
2
m
2
2
m
8
m
Ch.
V,
§
4
Ch.
V,
§
4
Ch.
V,
§
4
ι
ι
ι
214
(where
we
note
that
in
our
conventions,
the
“sums”
over
ι
are
“to
be
in
log(q)
units,”
hence
amount,
in
fact,
to
averages;
thus,
a
sum
over
ι
of
a
constant
C
is
equal
to
the
constant
C
itself).
Thus,
by
dividing
by
−d,
we
see
that
it
suﬃces
to
show
that

1
ι
(
2iι
8
mCh.
V,§4
−
1)
=

1
1
(
|θι
|
−
)
2
8
ι
where
θι
is
the
unique
rational
number
of
absolute
value
≤
12
that
deﬁnes
the
same
element
as
−d
·
ηι
in
S1ι
.
In
particular,
it
suﬃces
to
verify
that
iι
1
=
|θι
|
2
mCh.
V,§4
for
each
ι.
But
if
one
unravels
the
deﬁnitions,
it
is
easy
to
see
that
this
is
essentially
a
tautology:
Indeed,
it
follows
from
the
even
part
of
Chapter
IV,
Lemma
5.4,
that
the
character
χL
of
Chapter
V,
§4,
is
precisely
that
determined
by
the
torsion
point
−d
·
ηι
+
12
of
S1ι
,
i.e.,
χL
←→
−d
·
ηι
+
1
2
On
the
other
hand,
it
follows
from
the
deﬁnitions
of
Chapter
V,
§4,
that
±
2m
iι
precisely
the
“coordinate”
on
S1ι
corresponding
to
the
character
χM
,
i.e.,
χM
←→
±
§
is
Ch.
V,
4
iι
2mCh.
V,§4
Moreover,
the
character
χM
is
the
result
of
shifting
the
character
χL
by
the
character
deﬁned
by
12
:
χM
⊗
χL
−1
←→
1
2
Thus,
putting
everything
together,
the
two
“
21
’s”
cancel,
and
we
see
that
the
rational
(≤
12
)
deﬁnes
the
same
element
(up
to
sign)
as
−d
·
ηι
in
S1ι
,
hence
is
number
2m
iι
Ch.
V,§4
equal
to
|θι
|,
as
desired.
This
completes
the
proof
of
the
fact
that
Ξ[∞]
is
an
isomorphism
in
the
case
of
d
even.
The
fact
that
the
natural
inclusions
of
Theorem
3.1,
(2),
are,
in
fact,
equalities
follows
by
the
same
argument
as
in
the
odd
case.
Thus,
the
proof
of
Theorem
3.1
is
complete.

Remark.
One
may
regard
the
computation
of
the
sequences
aι
in
Theorem
3.1,
(2),
(3),
such
that
the
natural
inclusions
and
natural
projections
of
(2)
are
surjective
as
a
computation
215
of
the
analytic
torsion
of
the
{v,
et}-push
forwards
(i.e.,
the
push-forwards
equipped
with
the
new
integral
structure/metric
deﬁned
at
the
beginning
of
this
§).
This
point
of
view
is
very
much
in
line
with
what
we
will
do
in
Chapter
VII,
Chapter
VIII,
where
we
compute
analogous
analytic
torsion-type
quantities
at
the
archimedean
primes
of
a
number
ﬁeld.
§4.
The
Comparison
Isomorphism
in
Mixed
Characteristic
In
this
§,
we
prove
the
Comparison
Isomorphism
in
Mixed
Characteristic.
Put
another
way,
we
show
in
this
§
that
the
characteristic
zero
isomorphism
of
§3,
Theorem
3.1,
(2),
preserves
certain
natural
integral
structures
(at
all
ﬁnite
primes)
on
both
sides.
In
this
§,
we
shall
continue
to
use
the
notations
of
§3.
The
following
result
is
the
main
result
of
this
Chapter:
Theorem
4.1.
(Comparison
Isomorphism
in
Mixed
Characteristic)
Let
d,
m
≥
1
be
integers
such
that
m
does
not
divide
d.
Suppose
that
S
log
is
a
ﬁne
noetherian
log
scheme,
and
let
C
log
→
S
log
be
a
log
elliptic
curve
over
S
log
such
that
the
“divisor
at
inﬁnity”
D
⊆
S
(i.e.,
the
pullback
of
the
divisor
at
inﬁnity
of
(M1,0
)Z
via
the
classifying
morphism
S
→
(M1,0
)Z
)
is
a
Cartier
divisor
on
S.
Also,
let
us
assume
that
étale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root,
and
that
we
are
given
a
torsion
point
η
∈
E∞,S
(S∞
)
ev
of
order
precisely
m
which
deﬁnes
line
bundles
Lst,η
,
Lst,η
(cf.
Chapter
V,
§1).
If
d
is
odd
def
def
ev
(respectively,
even),
then
let
L
=
Lst,η
(respectively,
L
=
Lst,η
).
Then:
(1)
(Compatibility
with
Base-Change)
For
any
collection
v
=
{vι
}ι
of
elements
of
Q≥0
·
log(q)
∞
(one
for
each
connected
component
ι
of
the
divisor
at
inﬁnity
D)
such
that
for
each
ι,
vι
≥
(aι
)d−1
(notation
of
Theorem
3.1,
(3)),
the
formation
of
the
push-forward
(fS
)∗
(L|
†
E∞,[d]
216
)<d
{v,
et}
(along
with
its
ﬁltration)
commutes
with
base-change
(among
bases
S
log
satisfying
the
hypotheses
given
above).
(2)
(Zero
Locus
of
the
Determinant)
Assume
that
S
is
Z-ﬂat.
If
vι
=
∞
for
all
ι,
then
the
scheme-theoretic
zero
locus
of
det(Ξ{v,
et}),
i.e.,
the
determinant
of
the
morphism
Ξ{v,
et}
:
(fS
)∗
(L|
†
E∞,[d]
)<d
{v,
et}
→
(fS
)∗
(L|
†
)
(d
E∞
)
of
Theorem
3.1,
(1),
is
given
by
the
divisor
d
·
[η

(d
E)]
(where
d
E
is
the
kernel
of
multiplication
by
d
on
Ed
).
In
fact,
the
divisor
of
poles

of
the
inverse
morphism
to
Ξ{v,
et}
is
contained
in
the
divisor
[η
(d
E)].
(3)
(Analytic
Torsion
Properties)
For
each
ι,
let
us
write
aι
=
{(aι
)0
,
.
.
.
,
(aι
)d−1
}
for
the
sequence
of
elements
of
Q≥0
·
log(q)
discussed
in
Theorem
3.1,
(2),
(3).
Then
the
natural
inclusions
F
j+1
((fS
)∗
(L|
†
E∞,[d]
)<d
{(aι
)j
,
et})
⊆
F
j+1
((fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et})
are
all
equalities
and
the
natural
projections
(F
j+1
/F
j
)((fS
)∗
(L|
†
E∞,[d]
)<d
{(aι
)j
,
et})
−→
1
·
exp(−(aι
)j
)
·
(fS
)∗
(L|E∞,S
)
⊗OS
τE⊗j
j!
(where
j
=
0,
.
.
.
,
d
−
1)
are
bijective.
Moreover,
the
sections
of
L|
†
E∞,[d]
that
realize
these
bijections
have
q-expansions
in
a
neighborhood
of
inﬁnity
that
are
given
explicitly
in
Chapter
V,
Theorem
4.8.
217
Remark.
Relative
to
the
bound
on
the
poles
of
the
inverse
morphism
to
Ξ{v,
et}
(i.e.,
Theorem
4.1,
(2)),
we
remark
that
these
denominators
tend
to
be
very
small.
Indeed,
typically
an
intersection
between
torsion
points
will
look
like
the
zero
locus
of
some
1
−
ω,
where
ω
is
a
root
of
unity.
In
fact,
by
taking
m
to
have
at

least
two
prime
factors
that
do
not
divide
d,
it
is
easy
to
see
that
one
can
arrange
that
η
(d
E)
=
∅.
Remark.
Note
that
compatibility
with
base-change
is
extremely
important
for
applications.
For
instance,
base-change
from
(M1,0
)Z
to
a
point
of
(M1,0
)Z
valued
in
the
ring
of
integers
of
a
number
ﬁeld
is
a
typical
case
of
a
situation
where
one
must
use
the
“full
power”
of
compatibility
with
base-change.
Remark.
The
poles
“exp(−(aι
)j
)”
appearing
in
Theorem
4.1,
(3),
are
clearly
of
fundamental
importance
in
Theorems
3.1
and
4.1,
and
indeed,
of
fundamental
importance
to
this
entire
paper.
We
shall
refer
to
these
poles
as
Gaussian
poles,
since
they
grow
roughly
like
a
Gaussian
(i.e.,
(aι
)j
is
roughly
quadratic
in
j).
Proof.
First,
let
us
observe
that
once
one
proves
the
base-change
assertion
(1),
assertions
(2)
and
(3)
will
follow
as
soon
as
they
have
been
proven
in
the
“universal
case”
–
i.e.,
say,
for
S
regular
of
dimension
2
such
that
the
classifying
morphism
S
→
(M1,0
)Z
is
ﬂat.
But
in
this
“universal
case,”
assertion
(3)
already
follows
from
Theorem
3.1,
(2).
Also,
in
the
“universal
case,”
assertion
(2)
follows
from
Theorem
3.1,
(2),
and
Chapter
V,
Theorem
6.2.
Indeed,
both
the
domain
and
range
of
Ξ{v,
et}
are
vector
bundles
of
the
same
rank
over
a
two-dimensional
regular
base
(cf.
Lemma
2.1),
so
the
scheme-theoretic
zero
locus
of
the
determinant
of
Ξ{v,
et}
is
known
as
soon
as
it
is
known
at
the
height
1
primes.
But
at
the
height
1
primes,
the
zero
locus
of
det(Ξ{v,
et})
is
known
by
Theorem
3.1,
(2),
and
Chapter
V,
Theorem
6.2.
Thus,
in
summary,
to
complete
the
proof
of
Theorem
4.1,
it
suﬃces
to
prove
assertion
(1)
under
the
hypothesis
that
assertions
(2)
and
(3)
are
known
in
the
“universal
case.”
On
the
other
hand,
by
what
we
did
in
§2,
we
know
that
assertion
(1)
holds
away
from
the
divisor
at
inﬁnity.
Thus,
by
Lemma
2.3,
it
suﬃces
to
prove
compatibility
with
base-change
in
the
special
case
where
S
is
regular
of
dimension
2,
and
the
classifying
morphism
S
→
(M1,0
)Z
is
ﬁnite
and
ﬂat
(cf.
the
theory
of
[KM],
Chapter
5).
Let
O
be
the
normalization
of
Z
in
S.
Then
we
may
even
assume
that
the
ﬁbers
of
S
→
Spec(O)
are
geometrically
reduced,
and
even
smooth
near
inﬁnity.
Indeed,
by
ﬂatness
over
(M1,0
)Z
,
it
suﬃces
to
check
this
near
inﬁnity,
where
S
may
be
taken
to
be
such
that
its
completion
at
inﬁnity
is
the
spectrum
of
1
O[[q
M
]]
for
some
positive
integer
M
.
In
fact,
Lemma
2.3
tells
us
that
it
suﬃces
to
prove
compatibility
with
base-change
for
the
particular
base-change
218
S
×O
Spec(O/p)
→
S
where
p
is
an
arbitrary
maximal
prime
of
O.
In
the
following,
we
will
denote
the
result
of
def
base-changing
objects
via
O
→
k
=
O/p
by
means
of
a
subscript
k.
Next,
let
us
observe
that
the
morphism
“f∗
(F
⊗OC

P)⊗OS
A
→
f∗
(F
⊗OC

P
⊗OS
A)”
d
d
studied
in
§2
is
always
injective.
Indeed,
this
follows
from
the
fact
that
both
sides
inject
into
their
restrictions
to
US
=
S\D,
where
they
are
equal.
Thus,
compatibility
with
basechange
issues
amount
to
the
surjectivity
of
the
“μN
-invariant
part
of”
(terminology
of
§2)
this
morphism.
Thus,
in
summary,
it
suﬃces
to
show
that
the
morphism
(fS
)∗
(L|
†
E∞,[d]
)<j
{v,
et}
⊗O
k
→
(fS
)∗
(L|
†
E∞,[d]
⊗O
k)<j
{v,
et}
is
surjective
for
all
j
=
1,
.
.
.
,
d.
Let
us
write
Rj
(respectively,
Dj
;
Ij
)
for
the
range
(respectively,
domain;
image)
of
this
morphism.
Note
that
Rj
,
Dj
,
and
Ij
are
all
vector
bundles
on
Sk
.
Indeed,
this
is
clear
away
from
inﬁnity;
near
inﬁnity,
it
follows
from
the
fact
that
Sk
is
smooth
over
k
near
inﬁnity.
Thus,
we
have
an
inclusion
Ij
⊆
Rj
of
vector
bundles
on
Sk
which
is
an
equality
away
from
inﬁnity.
We
wish
to
show
that
this
inclusion
is
an
equality
over
all
of
Sk
.
Now
let
us
suppose
that:
Id
=
Rd
Then
I
claim
that
it
follows
that
Ij
=
Rj
for
all
j
=
1,
.
.
.
,
d.
Indeed,
this
follows
by
considering
degrees,
as
in
the
proof
of
Theorem
3.1.
That
is
to
say,
the
fact
that
the
natural
projections
of
(3)
are
surjective
(over
S),
combined
with
the
fact
that
the
push-forward
(fS
)∗
(L|E∞,S
)
commutes
with
base-change
(cf.
the
last
part
of
Lemma
2.2),
implies
that
if
there
were
a
single
j
such
that
Ij
=
Rj
=
F
j
(Rd
),
then
summing
up
over
the
various
(F
j
/F
j−1
)(Rd
)’s
and
Ij
/Ij−1
’s,
we
obtain
that
219
deg(Rd
)
>
d


ι
{d
·
(aι
)j−1
+
deg((fS
)∗
(L|E∞,S
⊗OS
τE⊗j−1
))}
j=1
=
deg((fS
)∗
(L|
†
)<j
{v,
et}
⊗O
Q)
=
deg((fS
)∗
(L|
†
)<j
{v,
et}
⊗O
k)
E∞,[d]
E∞,[d]
=
deg(Dd
)
=
deg(Rd
)
(where
the
ﬁrst
equality
follows
from
Theorem
3.1,
(2);
the
second
equality
follows
from
the
fact
that
the
degree
of
a
vector
bundle
on
S
is
locally
constant
over
Spec(O);
the
third
equality
follows
from
the
deﬁnition
of
Dd
;
and
the
fourth
equality
follows
from
the
assumption
Id
=
Rd
).
Thus,
we
get
a
contradiction;
this
completes
the
proof
of
the
claim.
Thus,
it
suﬃces
to
prove
that
Id
=
Rd
Since
this
assertion
is
local
at
inﬁnity,
we
will
assume
in
the
rest
of
the
proof
that
1
S
=
Spec(O[[q
M
]])
for
some
positive
integer
M
.
To
conclude
that
Id
=
Rd
,
we
would
like
to
use
the
fact
that
Ξ{v,
et}
is
an
isomorphism
over
S
(by
(2)
in
the
“universal
case”),
so
long
as
η
does
not
intersect
d
E.
Now
of
course,
in
the
case
under
consideration
η
might
intersect
d
E.
Note,
however,
that
if
we
modify
η
by
some
torsion
point
ηδ
∈
Ed
(S)
whose
restriction
to
the
special
ﬁber
of
Ed
lies
in
the
same
connected
component
as
that
of
the
identity,
then
this
problem
can
be
avoided.
Note
that
(after
possibly
enlarging
O)
such
an
ηδ
always
exists
(since
we
have
localized
near
inﬁnity).
Moreover,
we
may
even
assume
that
ηδ
is
def
such
that
η
=
η
+
ηδ
does
not
intersect
d
E.
Next,
note
that,
by
(2)
in
the
“universal
case,”
the
“Ξ{v,
et}”
corresponding
to
such
an
η
is
an
isomorphism.
Since
in
fact,
we
are
interested
in
the
situation
with
the
original
η,
we
observe
that
(by
translating
by
−ηδ
)
we
can
interpret
the
fact
that
we
get
an
isomorphism
when
η
is
replaced
by
η
as
saying
that
the
evaluation
map
(fS
)∗
(L|
†
E∞,[d]
)<d
{v,
et}
→
(fS
)∗
(L|
†
†
)
(−ηδ
+d
E∞
)
†
†
(where
ηδ
is
the
natural
lifting
of
ηδ
to
E∞,[d]
)
is
an
isomorphism.
Tensoring
with
k,
we
thus
obtain
that
the
evaluation
map
220
(fS
)∗
(L|
†
E∞,[d]
)<d
{v,
et}
⊗O
k
=
Dd
→
(fS
)∗
(L|
†
†
⊗O
k)
(−ηδ
+d
E∞
)
is
an
isomorphism
(since
push-forwards
for
ﬁnite
morphisms
always
commute
with
basechange).
But
this
morphism
clearly
factors
through
Rd
(since
sections
of
(L
⊗OE∞,S
Ret†
E∞,[d]
{v})
⊗O
k
†
†
over
E∞,S
⊗O
k
can
always
be
restricted
to
(−ηδ
+
d
E∞
)
⊗O
k).
In
other
words,
the
morphism
Dd
→
Rd
is
bijective,
so
Id
=
Rd
,
as
desired.
This
completes
the
proof
of
Theorem
4.1.

Remark.
In
fact,
compatibility
of
base-change,
i.e.,
Theorem
4.1,
(1),
may
itself
be
regarded
as
a
sort
of
“analytic
torsion
property.”
Thus,
it
is
not
surprising
that
the
proof
of
Theorem
4.1,
(1),
makes
essential
use
of
Theorem
4.1,
(3),
in
the
“universal
case.”
Bibliography
[Harts]
R.
Hartshorne,
Algebraic
Geometry,
Graduate
Texts
in
Mathematics
52,
Springer
(1977).
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
University
Press
(1985).
[Mats]
H.
Matsumura,
Commutative
Algebra
(Second
Edition),
The
Benjamin/Cummings
Publishing
Company
(1980).
[SGA2]
A.
Grothendieck
et
al.,
Cohomologie
locale
des
faisceaux
cohérents
et
théorèmes
de
Lefshetz
locaux
et
globaux,
North-Holland,
Amsterdam
(1968).
221
Chapter
VII:
The
Geometry
of
Function
Spaces:
Systems
of
Orthogonal
Functions
§0.
Introduction
The
purpose
of
the
present
Chapter
is
to
prepare
for
the
discussion
of
the
Arakelovtheoretic
extension
of
the
theory
of
Chapter
VI
in
Chapter
VIII
by
developing
the
theory
of
systems
of
orthogonal
functions
in
the
form
in
which
we
will
use
it
in
this
paper.
Such
systems
of
orthogonal
functions
are
central
to
the
archimedean
portion
of
the
theory
of
this
paper.
The
reason
for
this
is
that
the
main
result
of
this
paper,
i.e.,
the
comparison
isomorphism
between
“de
Rham
functions”
(i.e.,
functions
on
the
universal
extension
of
an
elliptic
curve,
which
is
a
sort
of
de
Rham
cohomology
group
of
the
elliptic
curve)
and
“étale
functions”
(i.e.,
functions
on
the
torsion
points
of
the
elliptic
curve)
is,
after
all,
an
isomorphism
between
function
spaces.
To
consider
such
function
spaces
in
an
Arakelovtheoretic
context
thus
amounts
to
considering
such
function
spaces
equipped
with
some
metric.
Thus,
in
order
to
develop
the
natural
Arakelov-theoretic
extension
of
the
theory
of
Chapter
VI,
we
must
study
the
relationship
between
the
natural
metrics
induced
from
the
de
Rham
and
étale
sides
of
the
comparison
isomorphism.
Because
function
spaces
tend
to
be
rather
large
and
unwieldy,
in
order
to
study
their
geometry
as
metrized
spaces,
it
is
of
crucial
importance
to
have
natural
and
explicit
orthonormal
coordinate
systems
at
our
disposal
which
allow
us
to
express
the
diﬀerence
between
the
geometries
induced
by
diﬀerent
metrics
in
a
precise
and
quantitative
fashion.
Such
orthonormal
coordinate
systems
are
provided
by
systems
of
orthogonal
functions.
It
turns
out
that
the
natural
metrics
arising
from
the
de
Rham
and
étale
sides
of
the
comparison
isomorphism
are
rather
alien
in
nature
to
one
another.
It
is
thus
diﬃcult
to
compare
them
to
one
another
directly.
Thus,
in
order
to
interpolate
the
diﬀerence
between
them,
we
must
introduce
various
intermediate
systems
of
orthogonal
functions.
This
is
the
main
goal
of
the
present
Chapter.
In
§1,
we
begin
by
discussing
the
“general
nonsense”
aspects
of
the
theory
of
orthogonal
functions.
In
§2,
we
review
the
theory
of
Legendre
and
Hermite
polynomials,
not
only
because
they
are
perhaps
the
most
fundamental
examples
of
orthogonal
functions,
but
also
because
they
play
a
crucial
role
in
the
theory
of
the
comparison
isomorphism
at
the
inﬁnite
prime.
In
§3,
we
discuss
the
theory
of
the
“discrete
Tchebycheﬀ
polynomials,”
which
are
a
sort
of
discrete
analogue
of
Legendre
polynomials.
These
polynomials
also
play
an
important
role
in
the
theory
of
this
paper.
In
§4,
we
discuss
the
metric
arising
from
the
de
Rham
side
of
the
comparison
isomorphism.
Then
in
§5,
we
discuss
the
relationship
between
this
geometry
and
the
theory
of
canonical
SchottkyWeierstrass
zeta
functions.
Finally,
in
§6,
we
begin
our
study
of
the
geometry
of
the
space
of
canonical
Schottky-Weierstrass
zeta
functions.
The
geometry
of
this
function
space
will
be
studied
further
in
Chapter
VIII.
222
In
fact,
the
introduction
of
various
types
of
canonical
Schottky-Weierstrass
zeta
functions
is
the
ﬁrst
and
most
crucial
step
in
the
interpolation
between
de
Rham
and
étale
metrics
referred
to
above.
One
way
to
think
of
this
interpolation
is
the
following:
The
de
Rham
side
of
the
comparison
isomorphism
involves
functions
on
continuous
spaces,
i.e.,
more
precisely,
on
the
underlying
real
analytic
manifold
–
which
we
denote
ER
–
of
a
complex
elliptic
curve
E.
On
the
other
hand,
the
étale
side
of
the
comparison
isomorphism
involves
functions
on
some
ﬁnite,
discrete
set
of
torsion
points.
Thus,
in
order
to
develop
an
Arakelov-theoretic
extension
of
the
theory
of
Chapter
VI,
we
must
somehow
bridge
this
gap
between
continuous
and
ﬁnite,
discrete
spaces.
Now
note
that
ER
has
precisely
two
real
dimensions.
The
passage
(§5)
from
the
de
Rham-theoretic
function
space
geometry
of
§4
to
the
canonical
Schottky-Weierstrass
zeta
function-based
geometry
of
§6
–
which
is
a
sort
of
function
theory
on
S1
(which
has
precisely
one
real
dimension)
–
then
amounts
to
the
discretization
of
one
of
these
two
real
dimensions.
This
discretization,
which
we
refer
to
as
the
ﬁrst
discretization,
turns
out
to
be
the
most
essential.
The
second
discretization,
i.e.,
the
discretization
of
the
remaining
S1
,
will
be
carried
out
in
Chapter
VIII.
Thus,
schematically:
de
Rham-based
function
theory
on
ER
(dim/R
=
2)
⇓
canonical
Schottky-Weierstrass
zeta
function-based
function
theory
on
S1
(dim/R
=
1)
⇓
function
theory
of
functions
on
a
discrete
set
of
torsion
points
(dim/R
=
0)
In
some
sense,
this
diagram
represents
the
main
theme
behind
the
theory
of
the
present
and
following
Chapters.
§1.
The
Orthogonalization
Problem
In
this
§,
we
introduce
the
basic
ideas
and
terminology
surrounding
the
theory
of
systems
of
orthogonal
functions.
We
begin
by
discussing
what
we
call
the
orthogonalization
problem.
That
is
to
say,
given
a
Hilbert
space
equipped
with
a
ﬁltration
and
an
operator
satisfying
certain
properties,
one
wishes
to
construct
a
corresponding
system
of
orthogonal
elements
of
the
Hilbert
space.
We
then
discuss
various
basic
invariants
that
one
can
associate
to
such
data
–
namely,
the
means
and
submeans
of
the
system
(cf.
Deﬁnition
1.1).
When
the
given
operator
is
self-adjoint
up
to
a
constant
multiple,
it
turns
out
that
the
system
of
orthogonal
elements
is
completely
determined
by
a
relatively
small
amount
of
data,
namely,
the
means
and
“principal
submeans”
(cf.
Proposition
1.2).
Finally,
we
discuss
various
examples
of
this
theory.
We
remark
that
the
material
that
we
treat
here
is
223
in
essence
well-known
(cf.,
e.g.,
[Sze],
[Bate]),
but
I
do
not
know
of
a
reference
that
treats
this
material
from
the
point
of
view
that
we
take
here.
We
begin
with
a
Hilbert
space
H
over
a
base
ﬁeld
K,
which
we
assume
to
be
either
R
or
C.
We
will
denote
the
inner
product
on
H
by
(−,
−)
and
its
corresponding
norm
by
|
−
|.
Let
us
assume
that
H
is
equipped
with
a
ﬁltration
of
(not
necessarily
closed)
K-subspaces:
F
−1
(H)
=
0
⊆
F
0
(H)
⊆
F
1
(H)
⊆
.
.
.
⊆
F
n
(H)
⊆
.
.
.
⊆
H
where
n
ranges
over
all
integers
<
some
ﬁxed
N
(where
N
∈
Z
def
n
n
that
the
subquotients
Q
(H)
=
(F
/F
n−1
∞).
Moreover,
we
assume
)(H)
satisfy:
dimK
(Qn
(H))
=
1
for
all
0
≤
n
<
N
.
Thus,
in
particular,
if
0
≤
n
<
N
,
dimK
(F
n
(H))
=
n
+
1.
In
the
following,
we
will
write
∞
def
F
(H)
=
N
−1
i
F
(H);
F
∞−1
def
(H)
=
i=0
N
−2
F
i
(H)
i=0
for
the
union
of
all
the
(respectively,
all
but
the
last)
subspace(s)
in
the
ﬁltration.
Note
that
this
data
of
Hilbert
space
plus
ﬁltration
already
determines
splittings
of
the
ﬁltration
n
F
(H)
=
n

Qi
(H)
i=0
(for
0
≤
n
<
N
)
given
by
taking
the
orthogonal
complement
of
F
n−1
(H)
in
F
n
(H).
Thus,
one
can
think
of
the
Qn
(H)
as
subspaces
of
H.
In
its
most
basic
form,
The
orthogonalization
problem
is
the
problem
of
explicitly
determining
these
splittings
of
the
ﬁltration
F
∗
(H).
What
does
to
mean
to
“explicitly
determine”
the
splittings?
To
give
meaning
to
this
expression,
it
is
typical
to
assume
that
one
is
also
given
a
(K-linear,
but
not
necessarily
continuous)
operator
X
:
F
∞−1
(H)
→
F
∞
(H)
Moreover,
we
assume
that,
for
0
≤
n
<
N
,
X(F
n−1
(H))
⊆
F
n
(H),
and,
moreover,
that
the
induced
morphism
224
Qn−1
(H)
→
Qn
(H)
is
an
isomorphism.
Put
another
way,
if
F
0
(H)
=
K
·
,
then
F
n
(H)
=
{φ(X)
·
}
where
φ(X)
ranges
over
all
polynomials
in
X
with
coeﬃcients
in
K
of
degree
≤
n.
Thus,
if
one
is
given
such
an
operator
X,
then
it
makes
sense
to
ask:
Can
one
explicitly
determine
some
set
of
polynomials
{φn
(X)}
(where
deg(φn
(X))
=
n;
n
ranges
over
all
nonnegative
integers)
such
that
φn
(X)
·

generates
the
one-dimensional
K-subspace
Qn
(H)
⊆
H?
This
is
the
form
of
the
orthogonalization
problem
that
will
appear
most
frequently
in
the
present
Chapter.
A
mild
variant
of
this
problem
involves
ﬁnding
φn
(X)
as
above
such
that
φn
(X)
·

not
only
generates
Qn
(H),
but
has
norm
equal
to
1.
Let
us
assume
that
the
set
{φn
(X)
·
}
is
orthonormal.
Then
we
shall
denote
the
coeﬃcient
of
X
n−i
in
φn
(X)
by
κn,i
∈
K
(cf.
[Sze],
Theorem
12.7.1).
Thus,
φn
(X)
=
κn,0
·
X
n
+
κn,1
·
X
n−1
+
.
.
.
+
κn,n
def
Note
(cf.
[Sze],
§12.3)
that
the
number
μn
=
|κn,0
|−2
may
also
be
characterized
as
the
inﬁmum
inf
|φ(X)
·
|2
φ(X)
where
φ(X)
=
X
n
+
.
.
.
is
a
polynomial
in
X
(with
coeﬃcients
in
K)
of
degree
n
with
leading
coeﬃcient
equal
to
1.
Note
that
this
inﬁmum
is
attained
for
φ(X)
=
κ−1
n,0
·
φn
(X).
def
Deﬁnition
1.1.
We
shall
refer
to
the
number
μn
=
|κn,0
|−2
as
the
n-th
mean
of
the
data
def
(H,
F
∗
(H),
X).
We
shall
refer
to
the
number
rn,i
=
κn,i
/κn,0
(for
0
≤
i
≤
n
<
N
)
as
the
((n,
i)-)submean
of
the
data
(H,
F
∗
(H),
X).
The
(n,
1)-submean
will
be
referred
to
as
the
n-th
principal
submean.
Note
that
the
means
and
submeans
are
uniquely
determined
by
the
data
(H,
F
∗
(H),
X).
Moreover,
if
one
knows
the
means
and
submeans
of
this
data,
then
one
can
immediately
reconstruct
the
system
{φn
(X)},
up
to
multiplication
(of
each
φn
(X))
by
an
element
of
K
of
absolute
value
1.
225
The
reason
for
the
terminology
“means”
is
the
following:
In
a
certain
very
basic
and
representative
case
(cf.
Example
(3)
below;
[Sze],
§12.3)
involving
polynomials
which
are
orthogonal
with
respect
to
a
given
weight
function
on
the
circle
S1
,
the
zeroth
mean
μ0
is,
in
fact,
the
arithmetic
mean
of
the
weight
function
(i.e.,
in
the
notation
of
Example
(3)

2π
1
·
0
w(θ)
dθ).
Moreover,
in
this
case,
the
higher
means
satisfy
below,
the
quantity
2π
def
μn
≤
μn−1
(for
all
positive
integers
n)
and
their
limit
μ∞
=
limn→∞
μn
is
the
geometric
mean
of
the
weight
function
(i.e.,
in
the
notation
of
Example
(3)
below,
the
quantity

2π
1
·
0
log(w(θ))
dθ)).
exp(
2π
One
of
the
most
important
cases
of
the
orthogonalization
problem
is
the
case
where
the
operator
X
is
self-adjoint
up
to
a
constant
multiple,
i.e.,
there
exists
some
ﬁxed
constant
αX
∈
K
such
that
(X
·
v,
w)
=
αX
·
(v,
X
·
w),
for
all
v,
w
∈
F
∞
(H).
In
this
case,
the
polynomials
{φn
(X)}
satisfy
a
recurrence
relation:
Proposition
1.2.
Assume
that
the
operator
X
is
self-adjoint
up
to
a
constant
multiple
αX
∈
K.
Then
for
1
≤
n
<
N
−
1,
we
have
φn+1
(X)
=
(An
X
+
Bn
)
·
φn
(X)
−
Cn
·
φn−1
(X)
where
An
=
κn+1,0
/κn,0
;
Bn
=
An
·
(rn+1,1
−
rn,1
);
Cn
=
αX
·
An
/An−1
(where
the
bar
denotes
complex
conjugation).
That
is
to
say,
the
polynomials
φn
(X)
are
entirely
determined
by
the
means
and
principal
submeans.
Proof.
The
proof
is
essentially
given
in
[Bate],
pp.
158-9.
In
fact,
[Bate]
only
treats
the
case
where
H
is
some
space
of
real-valued
functions
on
an
interval
(a,
b)
⊆
R
equipped
def

b
with
the
norm
(f,
g)
=
a
f
·
g
·
w
arising
from
some
weight
function
w
on
(a,
b),
and
X
is
the
operator
given
by
multiplying
by
the
standard
coordinate
on
R.
In
fact,
however,
it
is
not
diﬃcult
to
see
that
the
only
properties
of
this
data
that
are
used
in
this
proof
are
the
properties
that
we
have
assumed
here.
For
instance,
to
see
that
(X
·φn
(X)·,
φ(X)·)
=
0
for
all
φ(X)
of
degree
≤
n
−
2,
it
suﬃces
to
apply
the
self-adjointness
(up
to
a
constant
multiple)
of
X,
which
implies
that
(φn
(X)
·
,
X
·
φ(X)
·
)
=
0
since
X
·φ(X)
is
of
degree
≤
n−1.
The
coeﬃcients
An
,
Bn
,
and
Cn
may
then
be
determined
in
the
obvious
fashion
–
cf.
[Bate],
pp.
158-9.

We
conclude
this
§
by
listing
some
examples
of
the
theory
discussed
so
far.
Some
examples
are
well-known;
others
are
to
be
treated
in
the
present
and
following
Chapters.
226
Examples
of
Orthogonal
Systems:
(1)
Polynomials
on
intervals
of
the
real
line:
Let
(a,
b)
⊆
R
be
an
open
interval
in
R
(where
a,
b
∈
R
{±∞}).
Write
x
for
the
standard
coordinate
on
R.
Suppose
that
w(x)
is
positive
integrable
function
on
(a,
b).
Then
we
may
form
the
Hilbert
space
L2w
(a,
b)
of
b
K-valued
functions
f
on
(a,
b)
which
satisfy
a
|f
|2
·
w
·
dx
<
∞.
The
inner
product
of
this
Hilbert
space
is
given
by
b
def
f
·
g
·
w
·
dx
(f,
g)
=
a
(where
g
denotes
the
complex
conjugate
of
g).
Let
us
assume
that
for
all
n
≥
0,
xn
∈
L2w
(a,
b).
Then
if
we
take
def
H
=
L2w
(a,
b);
def
F
n
(H)
=
{cn
xn
+
.
.
.
+
c1
x
+
c0
|
c0
,
.
.
.
,
cn
∈
K};
def
X
=
x·
(i.e.,
X
is
the
self-adjoint
operator
given
by
multiplication
by
x),
we
obtain
data
as
in
def
the
above
discussion.
The
resulting
φn
(x)
=
φn
(X)
·
1’s
are
thus
orthonormal
with
respect
to
the
weight
function
w(x).
This
special
case
of
the
above
discussion
is
the
most
fundamental.
Two
of
the
most
basic
examples
of
this
sort
of
orthogonal
system
are
the
Legendre
polynomials
(where
a
=
−1,
b
=
1,
w(x)
=
1)
and
the
Hermite
polynomials
(where
1
2
a
=
−∞,
b
=
∞,
w(x)
=
e−
2
x
).
These
two
cases
will
be
discussed
in
§2
below.
(2)
Polynomials
on
a
ﬁnite
set
of
points:
This
case
is
similar
to
(1).
Instead
of
working
with
an
interval
in
R,
however,
we
work
with
the
ﬁnite
set
of
points
{0,
.
.
.
,
d
−
1}
⊆
R.
We
then
consider
a
positive
weight
function
w(x)
on
{0,
.
.
.
,
d
−
1}.
The
Hilbert
space
H
is
taken
to
be
the
set
of
K-valued
functions
f
on
{0,
.
.
.
,
d
−
1}
with
the
inner
product
given
by
def
(f,
g)
=
d−1

f
(x)
·
g(x)
·
w(x)
x=0
Here,
we
take
N
=
d,
and
for
0
≤
n
<
N
,
we
let
F
n
(H)
⊆
H
be
the
subspace
of
polynomials
in
x
of
degree
≤
n;
and
X
the
self-adjoint
operator
given
by
multiplication
by
x.
Just
as
was
the
case
with
(1),
the
present
set-up
(2)
also
has
a
long
history,
dating
back
to
the
nineteenth
century.
The
most
basic
example
of
this
sort
of
orthogonal
system
is
the
system
of
discrete
Tchebycheﬀ
polynomials
(where
w(x)
=
1),
to
be
reviewed
in
§3
below
(cf.
also
[Sze],
§2.8;
[Bate],
p.
223).
As
one
might
expect
from
the
weight
functions,
the
discrete
Tchebycheﬀ
polynomials
are
a
sort
of
discrete
analogue
of
the
Legendre
polynomials.
Another
basic
example
of
(2)
is
the
case
of
Krawtchouk
polynomials,
which
are
a
sort
of
discrete
analogue
of
the
Hermite
polynomials
(cf.
[Sze],
§2.82).
227
(3)
Polynomials
on
the
circle
S1
:
Another
important
case
is
the
case
of
a
positive
weight
def
function
w(θ)
on
the
unit
circle
S1
.
We
let
H
=
L2w
(S1
)
be
the
Hilbert
space
of
comdef
plex
square
integrable
functions
with
respect
to
w
on
S1
;
F
n
(H)
=
{cn
z
n
+
.
.
.
+
c1
z
+
def
c0
|
c0
,
.
.
.
,
cn
∈
C},
where
n
≥
0,
and
z
=
eiθ
;
and
X
the
operator
given
by
multiplication
by
z.
There
is
a
rich
and
well-developed
concerning
the
resulting
orthogonal
system
φn
(z)
–
see,
e.g.,
[Sze],
Chapters
XI,
XII
–
which
is
in
some
senses
more
transparent
then
the
theory
of
Example
(1).
For
instance,
this
theory
gives
rise
to
asymptotic
formulas
for
the
φn
(z)
in
terms
of
w(θ)
(cf.
[Sze],
Chapter
XII).
Historically,
one
of
the
ﬁrst
cases
in
which
this
situation
was
investigated
in
detail
was
the
case
in
which
w(θ)
is
given
by
a
theta
function
on
S1
(cf.
[Sze2]).
This
case
is
particularly
interesting
in
that
it
foreshadowed
the
subsequent
development
of
q-analogues
of
the
classical
orthogonal
polynomials
(such
as
those
of
Legendre
and
Hermite).
def
(4)
Derivatives
of
a
weight
function
on
the
circle
S1
:
In
this
case,
we
let
H
=
L2
(S1
)
be
the
usual
L2
-space
of
square-integrable
complex
functions
on
S1
.
Moreover,
we
assume
that
we
are
given
a
function
w(θ)
on
S1
which
is
inﬁnitely
diﬀerentiable
(i.e.,
of
class
C
∞
).
def
def
∂
Let
X
=
∂θ
be
the
usual
diﬀerentiation
operator,
and
let
F
n
(H)
=
{cn
X
n
+
.
.
.
+
c1
X
+
c0
|
c0
,
.
.
.
,
cn
∈
C}
·
w(θ),
for
n
≥
0.
Note
that
the
adjoint
of
X
is
−X,
so
Proposition
1.2
applies.
Thus,
the
φn
(X)
are
entirely
determined
by
the
means
and
principal
submeans.
In
the
present
paper,
the
case
where
w(θ)
is
a
theta
function
will
play
an
important
role
(cf.
§6,
Deﬁnition
6.3;
Chapter
VIII).
(5)
Sections
of
a
line
bundle
on
an
elliptic
curve:
Let
E
be
an
elliptic
curve
over
C,
and
L
be
the
line
bundle
deﬁned
by
the
origin.
Then
L
admits
a
Hermitian
metric
(unique
up
to
constant
multiple)
||
∼
||L
whose
curvature
is
translation
invariant
(cf.
§4
for
more
details).
This
Hermitian
metric
allows
us
to
deﬁne
the
L2
-space
of
square-integrable
sections
s
of
H

satisfying
E
||s||2L
<
∞.
We
take
H
to
be
this
L2
-space,
and
(for
n
≥
0)
F
n
(H)
to
be
the
n+1
space
of
sections
annihilated
by
∂
.
It
may
be
shown
that
dimC
(F
n
(H))
=
n
+
1.
Now
one
wishes
to
compute
the
splittings
of
this
ﬁltration
deﬁned
by
the
inner
product
on
H.
∗
This
is
done
in
§4
by
using
the
adjoint
∂
of
∂
(with
respect
to
the
inner
product
of
H).
In
particular,
it
is
shown
that
if
s
is
a
generator
of
F
0
(H),
then
Qn
(H)
⊆
H
is
generated
∗
∗
by
(∂
)n
(s)
(cf.
Theorem
4.5
of
§4
below).
Thus,
if
we
take
X
to
be
∂
,
then
we
see
that
in
this
case,
φn
(X)
is
a
constant
multiple
of
X
n
.
This
example
will
also
play
a
key
role
in
the
present
paper
and
will
be
treated
in
detail
in
§4.
(6)
The
discrete
version
of
(5):
Let
E
and
L
be
as
in
(5),
and
write
HR
for
the
Hilbert
space
“H”
of
(5).
Fix
a
positive
integer
N
,
and
let
G
⊆
E
be
a
cyclic
subgroup
of
order
N
.
Let
η
∈
E
be
a
torsion
point
which
is
∈
/
G.
Then
it
follows
from
Chapter
VI,
Theorem
3.1
(2),
together
with
the
theory
of
§4
of
the
present
Chapter,
that
the
restriction
map
ΞR
:
F
N
−1
(HR
)
→
L|η+G
228
is
bijective.
Note
that
||
∼
||L
deﬁnes
a
natural
inner
product
on
the
N
-dimensional
Cdef
vector
space
L|η+G
.
Thus,
L|η+G
is
a
ﬁnite-dimensional
Hilbert
space
H.
Let
F
n
(H)
=
ΞR
(Fn
(HR
))
∼
=
F
n
(HR
)
for
0
≤
n
<
N
,
and
write
X
:
F
∞−1
(H)
→
F
∞
(H)
for
the
operator
induced
by
the
“X”
of
(5)
(via
the
isomorphisms
F
n
(H)
∼
=
F
n
(HR
)).
Then
one
wishes
to
compute
the
resulting
φn
(X).
Indeed,
The
computation
of
the
φn
(X)
in
this
case
is
the
ultimate
goal
of
the
theory
of
the
present
and
following
Chapters.
In
fact,
it
is
essentially
a
tautology
that
concretely
speaking,
the
comparison
of
the
metrized
function
spaces
of
“de
Rham
functions”
and
“étale
functions”
(cf.
§0)
amounts
to
estimating
the
coeﬃcients
of
the
φn
(X).
Since
this
ultimate
goal
of
comparing
Examples
(5)
and
(6)
is
too
diﬃcult
to
achieve
directly,
we
relate
Examples
(5)
and
(6)
by
using
a
certain
intermediate
orthogonal
system
which
is
a
special
case
of
Example
(4)
(i.e.,
the
case
where
“w(θ)”
is
a
theta
function).
Finally,
we
analyze
this
special
case
of
Example
(4)
(cf.
§6;
Chapter
VIII)
by
using
the
well-known
theories
of
Examples
(1)
and
(2).
§2.
Review
of
Legendre
and
Hermite
Polynomials
In
this
§,
we
review
the
classical
orthogonal
polynomials
of
Legendre
and
Hermite.
These
examples
are
important
not
only
because
they
serve
to
illustrate
the
general
theory
of
orthogonal
systems
of
functions,
but
also
because
they
appear
naturally
in
the
theory
of
the
Hodge-Arakelov
comparison
isomorphism
(Chapter
VIII)
as
limiting
cases
of
the
orthogonal
functions
arising
from
diﬀerential
calculus
on
the
“theta-weighted
circle”.
We
begin
with
the
polynomials
of
Legendre:
Proposition
2.1.
(Legendre
Polynomials)
For
every
integer
n
≥
0,
we
deﬁne:



[2]

2n
−
2j
def
1
j
n
Pn
(T
)
=
n
·
(−1)
·
T
n−2j
2
j=0
j
n
n
(where
[∼]
denotes
the
greatest
integer
less
than
the
real
number
inbrackets).
Thus,
Pn
(T
)
n
is
a
polynomial
of
degree
n
whose
leading
term
is
given
by
2−n
·
2n
n
·T
and
which
satisﬁes
Pn
(1)
=
1.
In
particular,
P0
(T
)
=
1;
P1
(T
)
=
T
Moreover,
the
system
of
polynomials
{Pn
(T
)}
satisﬁes
the
following
properties:
229

(1)
(Orthogonality
and
Norms)
[−1,1]
2
Pm
(T
)
·
Pn
(T
)
=
2n+1
·
δmn
.
(2)
(Recurrence
Formula)
(n
+
1)
·
Pn+1
(T
)
−
(2n
+
1)T
·
PN
(T
)
+
n
·
Pn−1
(T
)
=
0
for
n
≥
1.
(3)
(Diﬀerential
Equation)
(1
−
T
2
)Pn
(T
)
−
2T
·
Pn
(T
)
+
n(n
+
1)
·
Pn
(T
)
=
0.
(4)
(Rodrigues’
Formula)
d
n
)
{(T
2
−
1)n
}.
Pn
(T
)
=
2n1·n!
·
(
dT
Proof.
See,
e.g.,
[Rice],
pp.
47-48.
Note
that
up
to
constant
multiples,
the
Pn
(T
)
are
determined
uniquely
by
the
following
two
properties:
(i)
Pn
(T
)
is
of
degree
precisely
n;
(ii)
if
m
=
n,
then
tm
(T
)
and
tn
(T
)
are
orthogonal
with
respect
to
L2
([−1,
1]).

Next,
we
consider
the
polynomials
of
Hermite:
Proposition
2.2.
def
Write
D
=
(Hermite
Polynomials)
Let
X
be
the
standard
coordinate
on
R.
d
dX
.
For
n
≥
0,
deﬁne
Hn
(X)
=
e
2
X
·
D
n
(e−
2
X
)
def
1
2
def
1
2
Thus,
H0
(X)
=
1;
H1
(X)
=
−X.
Let
dα
=
e−
2
X
·
dX,
which
we
think
of
as
a
metric/measure
on
R.
Then
for
n
≥
0,
1
2
(1)
(Orthogonality
and
Norms)
+∞
−∞
1
Hn
(X)
·
Hm
(X)
·
dα
=
(2π)
2
·
n!
·
δmn
.
(2)
(Explicit
Formula)

(−2)−m
·
X
n−2m
m!
(n
−
2m)!
m=0
[n/2]
Hn
(X)
=
(−1)
·
n!
·
n
230
where
[n/2]
is
n/2
(respectively,
(n
−
1)/2)
if
n
is
even
(respectively,
odd).
Hn
(X)
=
(D
−
X)n
(1).
(3)
(Alternate
Deﬁnition)
(4)
(Recurrence
Formula)
Hn+1
(X)
+
X
·
Hn
(X)
=
D(Hn
(X))
=
−n
·
Hn−1
(X).
def
(5)
(Diﬀerential
Relations)
If
we
set
Φn
(X)
=
Hn
(X)
·
e−
4
X
,
then
1
(D
−
X)
·
Φn
(X)
=
Φn+1
(X);
2
(D2
−
1
2
1
(D
+
X)
·
Φn
(X)
=
−n
·
Φn−1
(X);
2
1
1
·
X
2
−
)
·
Φn
(X)
=
−(n
+
1)
·
Φn
(X).
4
2
Proof.
The
properties
here
all
follow
essentially
from
[Bate],
p.
193.
Since,
however,
we
use
diﬀerent
normalizations
here
from
those
of
[Bate],
we
sketch
the
proofs
here.
First,
deﬁne
the
operator:
D
exp
=
e
2
X
·
D
·
e−
2
X
def
1
2
1
2
Then
by
deﬁnition,
Hn
(X)
=
(Dexp
)n
(1).
But
one
computes
easily
that
D
exp
=
e
2
X
·
(e−
2
X
·
D
+
[D,
e−
2
X
])
1
2
1
2
1
2
=
D
+
e
2
X
·
D(e−
2
X
)
=D−X
1
2
1
2
This
proves
the
“Alternate
Deﬁnition.”
The
“Recurrence
Formula”
follows
by
applying
the
operator-theoretic
relation
D
·
(D
−
X)n
=
(D
−
X)n
·
D
+
[D,
(D
−
X)n
]
=
(D
−
X)n
·
D
+
n
·
(D
−
X)n−1
·
[D,
D
−
X]
=
(D
−
X)n
·
D
−
n
·
(D
−
X)n−1
to
the
constant
function
1.
The
“Diﬀerential
Relations”
follow
by
using
(D
−
X)(Hn
)
=
Hn+1
;
D(Hn
)
=
−n
·
Hn−1
;
and
the
operator-theoretic
relation
(D2
−
14
X
2
)
−
12
=
D
2
−
1
2
1
1
1
4
X
−
2
[D,
X]
=
(D
+
2
X)(D
−
2
X).
This
operator
231
1
1
(D
+
X)(D
−
X)
2
2
is
a
sort
of
Laplacian
operator,
and
is
self-adjoint
for
the
L2
-norm
on
R
equipped
with
the
usual
measure
(i.e.,
dX).
Thus,
the
fact
that
the
Φn
(X)’s
are
eigenfunctions
for
this
operator
implies
that
they
are
mutually
orthogonal.
The
integrals
+∞
−∞
Φ2n
dX
may
then
be
computed
by
using
the
fact
that
D
+
12
X
(respectively,
D
−
12
X)
is
adjoint
to
−(D
−
12
X)
(respectively,
−(D
+
12
X)).
Finally,
the
“Explicit
Formula”
may
be
proven
by
applying
induction
on
n
and
the
relation
Hn+1
(X)
=
(D
−
X)
·
Hn
(X).

Remark
1.
In
fact,
the
explicit
formula
given
above
(i.e.,
Proposition
2.2,
(2))
may
be
interpreted
as
a
formula
for
any
two
operators
A
and
B
satisfying
[A,
B]
=
c
∈
C
and
A
·
v
=
0,
for
some
vector
v.
That
is
to
say,
the
explicit
formula
implies
that

(c/2)m
·
B
n−2m
·v
m!
(n
−
2m)!
m=0
[n/2]
(A
+
B)
·
v
=
n!
·
n
Indeed,
this
follows
by
thinking
of
A
as
λ−1
·
D
and
of
B
as
−λ−1
·
X,
where
λ−2
=
−c.
Remark
2.
Thus,
the
theory
of
Hermite
polynomials
essentially
amounts
to
harmonic
analysis
with
respect
to
the
metric
dα
=
e−
2
X
·
dX
def
1
2
on
R.
This
is
interesting
relative
to
the
main
theme
of
this
work,
i.e.,
of
a
“comparison
2
1
isomorphism
via
theta
functions,”
since
this
sort
of
factor
e−
2
X
(i.e.,
an
exponential
with
a
quadratic
exponent)
appears
frequently
in
the
theory
of
theta
functions
(cf.,
e.g.,
[Mumf3],
§12,
proof
of
Lemma
2,
(II)).
Indeed,
from
this
point
of
view,
one
may
think
of
this
factor
as
being
essentially:
exp
(Chern
class
of
L)
=
exp
(Riemann
form
of
L)
Note
that
this
sort
of
factor
also
appears
in
the
adjustment
of
integral
structure
at
inﬁnity
in
Chapter
VI,
Theorem
3.1,
(3),
i.e.,
this
adjustment
of
integral
structure
varies
roughly
232
as
the
exponential
of
the
“cj
’s”
of
loc.
cit.,
which
(cf.
Chapter
V,
Schola
4.1)
are
quadratic
functions
of
j.
This
appearance
of
the
exponential
of
a
quadratic
function
in
all
of
these
places
is
by
no
means
a
coincidence,
as
will
become
increasingly
apparent
to
the
reader
as
he/she
studies
the
material
of
this
and
the
following
Chapters.
§3.
Discrete
Tchebycheﬀ
Polynomials
and
the
Fundamental
Combinatorial
Model
In
this
§,
we
discuss
the
theory
of
discrete
Tchebycheﬀ
polynomials.
This
theory
may
be
regarded
as
the
archimedean
portion
of
the
fundamental
combinatorial
model
underlying
the
theory
of
this
paper.
This
combinatorial
model
is
the
evaluation
map
Ξ
cb
<d
:
Z[T
]
d−1

−→
Z
i=0
T
→
(0,
1,
2,
.
.
.
,
d
−
1)
given
by
evaluating
polynomials
in
the
indeterminate
T
of
degree
<
d
(for
d
a
positive
integer)
with
integral
coeﬃcients
at
the
points
T
=
0,
1,
2,
.
.
.
,
d
−
1.
In
Chapter
V
(cf.,
especially,
Chapter
V,
§6),
we
discussed
the
evaluation
map
Ξcb
at
ﬁnite
primes.
In
particular,
we
saw
that
if
we
adjust
the
integral
structure
in
an
appropriate
fashion
(cf.
Chapter
III,
§6;
Chapter
V,
§3)
–
i.e.,
if
we
consider
the
submodule
of
Z[T
]
⊗Z
Q
generated
by
the
polynomials
def
T
[n]
=
1
T
(T
−
1)(T
−
2)
·
.
.
.
·
(T
−
n
+
1)
n!
–
then
the
matrix
corresponding
to
the
evaluation
map
Ξcb
takes
on
the
simple
upper
triangular
form
⎛
1
⎜
⎜
0
⎜
[i]
{T
|T
=j
}{i,j=0,1,2,...,d−1}
=
⎜
⎜...
⎝
0
∗
...
∗
1
...
∗
...
0
...
0
∗
⎞
⎟
∗
⎟
⎟
⎟
...⎟
⎠
1
which
is
manifestly
both
integral
and
invertible
at
all
ﬁnite
primes.
Unfortunately,
however,
although
the
polynomials
T
[n]
are
very
well-suited
to
analyzing
the
eﬀect
of
Ξcb
on
the
integral
structures
at
ﬁnite
primes,
they
are
not
well-suited
to
analyzing
Ξcb
at
the
inﬁnite
233
(archimedean)
prime.
At
the
inﬁnite
prime,
the
range
of
Ξcb
has
a
natural
“L2
-metric”
given
by:
1
||(a0
,
.
.
.
,
ad−1
)||
=
(a20
+
.
.
.
+
a2d−1
)
2
(where
a0
,
.
.
.
,
ad−1
∈
R).
In
the
present
§,
we
would
like
to
analyze
Ξcb
relative
to
this
L2
-metric
on
the
range,
i.e.,
we
would
like
to
discuss
the
metric
induced
on
Z[T
]<d
via
Ξcb
by
this
L2
-metric.
In
the
theory
of
Ξcb
at
archimedean
primes,
the
polynomials
that
play
the
role
of
the
T
are
the
discrete
Tchebycheﬀ
polynomials
discussed
in
[Bate],
[Sze].
We
summarize
their
deﬁnition
and
basic
properties
in
the
following
Proposition:
[n]
Proposition
3.1.
(Discrete
Tchebycheﬀ
Polynomials)
Fix
a
positive
integer
d.
Then
we
deﬁne,
for
n
=
0,
1,
2,
.
.
.
,
d
−
1,
(1)
(“Rodrigues’
Formula”)
def
tn
(T
)
=
n!
·
δ
n



T
T
−d
n
n
def
where,
as
usual,
if
f
(T
)
is
a
polynomial
in
T
,
then
δ(f
)(T
)
=
f
(T
+1)−f
(T
).
(When
it
is
necessary
to
specify
the
dependence
on
d,
we
write
tn,d
(T
)
for
tn
(T
).)
Thus,
for
instance,
t0
(T
)
=
1;
t1
(T
)
=
2T
−
(d
−
1)


n
and
(for
all
n
=
0,
1,
2,
.
.
.
,
d
−
1)
the
leading
term
of
tn
(T
)
is
2n
n
·
T
.
The
polynomials
2
tn
(T
)
form
an
orthogonal
system
of
polynomials
for
the
L
-norm
(as
deﬁned
above)
on
the
space
of
functions
on
the
set
{0,
1,
2,
.
.
.
,
d
−
1}:
(2)
(Orthogonality
and
Norms)
def

tn
(T
),
tm
(T
)

=
d−1

tn
(T
)
·
tm
(T
)
=
(2n
+
1)−1
·
d(d2
−
12
)(d2
−
22
)
.
.
.
(d2
−
n2
)
·
δmn
T
=0
for
m,
n
=
0,
1,
2,
.
.
.
,
d
−
1
(where
δmn
is
=
0
if
m
=
n
and
=
1
if
m
=
n).
Moreover,
these
polynomials
also
satisfy
the
following
properties:
(3)
(Recurrence
Formula)
(n
+
1)
·
tn+1
(T
)
−
(2n
+
1)(2T
−
d
+
1)
·
tn
(T
)
+
n(d2
−
n2
)tn−1
(T
)
=
0
234
for
n
=
1,
2,
.
.
.
,
d
−
1.
(4)
(Diﬀerence
Equation)
(T
+
2)(T
−
d
+
2)
δ
2
(tn
(T
))
+
[2T
−
d
+
3
−
n(n
+
1)]
δ(tn
(T
))
−
n(n
+
1)
tn
(T
)
=
0
for
n
=
0,
1,
2,
.
.
.
,
d
−
1.
(5)
(Connection
with
Legendre
Polynomials)
lim
d−n
tn
(d
·
T
)
=
Pn
(2T
−
1)
d→∞
for
n
=
0,
1,
2,
.
.
.
,
d
−
1.
Here
Pn
(T
)
is
the
n-th
Legendre
polynomial
(cf.
Proposition
2.1).
(6)
(Connection
with
usual
Monomials)
For
any
real
number


2n
−n(1+)
1+
lim
d
tn
(d
·
T)
=
·
Tn
d→∞
n
>
0,
for
n
=
0,
1,
2,
.
.
.
,
d
−
1.
Proof.
See,
e.g.,
[Bate],
p.
223.
The
symbol
T
(respectively,
δ(−);
d)
in
our
notation
corresponds
to
x
(respectively,
Δ;
N
)
in
the
notation
of
loc.
cit.
Note
that
up
to
constant
multiples,
the
tn
(T
)
are
determined
uniquely
by
the
following
two
properties:
(i)
tn
(T
)
is
of
degree
precisely
n;
(ii)
if
m
=
n,
then
tm
(T
)
and
tn
(T
)
are
orthogonal
with
respect
to
L2
({0,
1,
.
.
.
,
d
−
1}).
The
only
result
listed
in
Proposition
3.1
that
cannot
be
found
in
[Bate]
is
the
connection
with
“the
usual
monomials
T
n
.”
But
this
follows
immediately
from
Rodrigues’
formula,
which,
in
the
limit,
takes
on
the
form
1
d
·
(
)n
(T
2n
)
=
n!
dT


2n
·
Tn
n
as
desired.

Remark
1.
Note
that
the
various
properties
of
the
Legendre
polynomials
listed
in
Proposition
2.1
may
all
be
obtained
by
passing
to
the
limit
d
→
∞
from
the
corresponding
properties
listed
in
Proposition
3.1.
Thus,
the
discrete
Tchebycheﬀ
polynomials
are
discrete
versions
of
the
Legendre
polynomials.
The
Legendre
polynomials
appear
(by
substituting
“cos(θ)”
for
T
)
as
eigenfunctions
of
the
Laplacian
operator
on
the
sphere
(equipped
with
its
unique
rotation
invariant
metric).
Indeed,
the
diﬀerential
equation
which
states
that
Pn
(cos(θ))
is
an
eigenfunction
of
this
Laplacian
with
eigenvalue
n(n
+
1)
may
be
written
235
entirely
in
terms
of
T
and
is,
in
fact,
the
diﬀerential
equation
that
appears
in
Proposition
2.1.
Thus,
the
discrete
Tchebycheﬀ
polynomials
may
be
regarded
as
discrete
versions
of
the
eigenfunctions
of
the
Laplacian
on
the
sphere.
Remark
2.
Note
that
while
the
limit
of
the
discrete
Tchebycheﬀ
polynomials
as
the
length
of
the
interval
under
consideration
remains
ﬁxed
and
equal
to
1
is
given
by
the
Legendre
polynomials
(Proposition
3.1,
(5)),
the
limit
of
the
discrete
Tchebycheﬀ
polynomials
as
the
length
of
the
interval
under
consideration
→
0
is
simply
the
system
of
“usual
monomials”
T
n
(up
to
constant
multiples
–
cf.
Proposition
3.1,
(6)).
That
is
to
say,
just
as
the
Legendre
polynomials
are
“metrically
suited”
to
reﬂect
the
geometry
of
the
unit
interval,
the
usual
monomials
are
functions
which
are
“metrically
suited”
to
reﬂect
the
geometry
of
an
inﬁnitesimal
neighborhood
of
a
point.
It
is
for
this
reason
that
such
functions
appear
naturally
in
the
theory
of
Taylor
series,
i.e.,
the
theory
of
expansions
of
functions
in
an
inﬁnitesimal
neighborhood
of
a
point.
The
main
result
that
we
wish
to
prove
in
this
§
is
the
following
(Proposition
3.2),
concerning
a
bound
on
the
coeﬃcients
of
the
discrete
Tchebycheﬀ
polynomials.
First,
let
us
introduce
some
notation:
Write
cnk
[d]
for
the
coeﬃcient
of
T
k
in
the
polynomial
d−n
·
tn,d
(d
·
T
)
(cf.
Proposition
2.1).
Thus,
cnk
[d]
=
Coeﬀ
T
k
1
1
·
t
(d
·
T
)
=
·
Coeﬀ
T
k
tn
(T
)
n
dn
dn−k
(where
“Coeﬀ
A
(B)”
denotes
“the
coeﬃcient
of
the
monomial
A
in
the
polynomial
B”).
Proposition
3.2.
Let
us
write
1
d2
tn
(T
)
=
·
tn
(d
·
T
)
||
tn
||
def
(where
“||
∼
||”
denotes
the
L2
-norm
on
{0,
1,
.
.
.
d
−
1}).
Then:
(i.)
cnk
[d]
≤
e2n
;
n+
1
1
(ii.)
1
≤
||d
tn
2||
≤
(2n
+
1)
2
·
en+1
≤
3
·
e2n
;
1
Coeﬀ
T
k
tn
(T
)
≤
(2n
+
1)
2
·
e3n+1
≤
3
·
e4n
;
(iii.)
Coeﬀ
T
n
tn
(T
)
≥
cnn
[d]
=
2n
n
≥
1;
for
all
integers
d,
n,
k
such
that
0
≤
k
≤
n
≤
d
−
1.
236
Proof.
Let
us
ﬁrst
prove
(i.).
First,
note
that
d0
·
t0
(d
·
T
)
=
1;
d−1
·
t1
(d
·
T
)
=
d−1
(2d
·
T
+
1
−
d)
=
T
−
1
+
d−1
,
so
the
inequality
of
(i.)
is
satisﬁed
for
n
=
0,
1.
Now
we
apply
the
“Recurrence
Formula”
(cf.
Proposition
3.1,
(3)),
and
induction
on
n.
This
gives
us:
!
!
!
Coeﬀ
T
k
d−n−1
·
tn+1
(d
·
T
)
!
!
2n
+
1
!
!
)(2d
·
T
−
d
+
1)
·
d−n−1
·
tn
(d
·
T
)
!
=
!
Coeﬀ
T
k
(
n+1
!
n
!
2
2
−n−1
)(d
−
n
)d
·
tn−1
(d
·
T
)
!
−(
!
!
n+1
!
!
−1
−n
≤
!
Coeﬀ
T
k
2(2T
−
1
+
d
)
·
d
·
tn
(d
·
T
)
!
!
!
!
!
+
!
Coeﬀ
T
k
d−(n−1)
·
tn−1
(d
·
T
)
!
!
!
!
!
−n
≤
4
·
!
Coeﬀ
T
k−1
d
·
tn
(d
·
T
)
!
!
!
!
!
+
2
·
!
Coeﬀ
T
k
d−n
·
tn
(d
·
T
)
!
!
!
!
!
−(n−1)
+
!
Coeﬀ
T
k
d
·
tn−1
(d
·
T
)
!
≤
4
·
7n
+
2
·
7n
+
7n−1
≤
7n
Since
e2
≥
7,
this
completes
the
proof
of
(i.).
To
derive
(ii.)
from
(i.),
it
suﬃces
(by
Proposition
3.1,
(2))
to
bound
1
(2n
+
1)
2
·
dn
1≤
1
1
1
(d2
−
12
)
2
·
(d2
−
22
)
2
·
.
.
.
·
(d2
−
n2
)
2
1
2
(d
−
n
−
1)!
·
d
(d
+
n)!
=
(2n
+
1)
·
d
·
n
1
2
By
Stirling’s
Formula
(reviewed
below
–
cf.
Lemma
3.5),
it
follows
that
this
last
expression
may
be
bounded
by
d2n+1
·
(d
−
n
−
1)d−n−1
·
e−(d−n−1)
·
(d
−
n
−
1)
2
·
e
1
1
2
(2n+1)
·
(d
+
n)d+n
·
e−(d+n)
·
(d
+
n)
1
2
1
2
1
≤
(2n+1)
2
·en+1
≤
3·e2n
as
desired.
This
completes
2n
the
proof
of
(ii.)
(as
well
as
the
proof
of
the
ﬁrst
inequality
of
n
(iii.)).
That
cn
[d]
=
n
≥
1
follows
immediately
from
Proposition
3.1,
(1)
(and
the
fact




1
n
that
the
leading
term
of
Tn
,
T
n−d
is
n!
T
).

Before
proceeding,
we
would
also
like
to
bound
the
coeﬃcients
of
the
polynomials
T
[n]
.
237
Proposition
3.3.
Let
n
be
a
positive
integer.
Then
the
coeﬃcients
of
the
polynomial
def
T
[n]
=
1
·
T
(T
−
1)
·
.
.
.
·
(T
−
(n
−
1))
n!
satisfy
(for
k
=
0,
.
.
.
,
n)
Coeﬀ
T
k
(T
[n]
)
≤
e2n
nk
In
particular,
if
n
≤
d,
then
Coeﬀ
(T
/d)k
(T
[n]
)≤e
2n
·

d
k
n
≤e
2n
·

d
n
n
≤
e2n+d
Proof.
n
If
one
expands
the
polynomial
T
(T
−
1)
·
.
.
.
·
(T
−
(n
−
1)),
one
sees
that
there
are
≤
k
terms
of
degree
k,
each
of
which
has
a
coeﬃcient
whose
absolute
value
is
a
product
of
n
−
k
positive
integers
≤
n.
It
thus
follows
that
Coeﬀ
T
k
(T
[n]


n−k
n
n
)≤
·
k
n!
≤
2n
·
≤
e2n
nk
nn−k
nn
·
e−n
(where
in
the
second
inequality,
we
use
Lemma
3.5
below).
If
n
≤
d,
then
(d/n)k
≤
(d/n)n
.
Finally,
by
Lemma
3.6,
(d/n)n
≤
ed
.

Next,
we
return
to
the
combinatorial
evaluation
map:
Ξ
cb
<d
:
Z[T
]
−→
d−1

Z
i=0
As
discussed
earlier,
the
range
admits
a
natural
“L2
-norm,”
hence
deﬁnes
an
arithmetic
vector
bundle
(cf.
Chapter
I,
Deﬁnition
1.1)
over
Q,
which
we
denote
by
Φet
(for
“étale
function
space”).
Next,
let
us
denote
by
ΦDR
(for
“de
Rham
function
space”)
the
arithmetic
vector
bundle
deﬁned
by
Q[T
]<d
equipped
with:
(i.)
the
metric
induced
by
the
L2
-metric
on
Φet
via
Ξcb
at
the
inﬁnite
prime
of
Q;
(ii.)
the
integral
structure
deﬁned
238
by
T
[0]
,
T
[1]
,
.
.
.
,
T
[d−1]
at
the
ﬁnite
primes
of
Q.
Thus,
Ξcb
induces
an
isomorphism
of
arithmetic
vector
bundles:
ΦDR
∼
=
Φet
Let
us
denote
the
ﬁltration
on
ΦDR
given
by
considering
polynomials
of
degree
<
n
by
F
n
(ΦDR
).
Note
that
since
Φet
is
a
direct
sum
of
trivial
arithmetic
line
bundles,
it
follows
that
d−1

deg{(F
n+1
/F
n
)(ΦDR
)}
=
deg(ΦDR
)
=
deg(Φet
)
=
0
n=0
In
fact,
if
we
compute
the
“zeroes
and
poles”
of
the
rational
section
of
the
arithmetic
line
bundle
def
Ln
=
(F
n+1
/F
n
)(ΦDR
)
deﬁned
by
T
n
,
we
see
(cf.
Proposition
3.1,
(2);
Proposition
3.2,
(iii.))
that
deg(Ln
)
=
log(n!)
+
log(||tn
||−1
·
Coeﬀ
T
n
(tn
(T
)))
2n
(2n
+
1)
12
·
((d
−
n
−
1)!)
12

=
log(n!)
+
log
·
1
n
((d
+
n)!)
2
(where
the
ﬁrst
(respectively,
second)
“log”
represents
the
contribution
arising
from
the
ﬁnite
(respectively,
inﬁnite)
places).
In
fact,
the
fact
that
the
sum
of
the
deg(Ln
)’s
is
0
may
be
checked
directly
as
follows:
Proposition
3.4.
The
degree
of
Ln
deg(Ln
)
=
log(n!)
+
log(||tn
||−1
·
Coeﬀ
T
n
(tn
(T
)))
satisﬁes
|
n
·
log(n/d)
+
1
·
log(d)
−
deg(Ln
)
|
≤
4n
+
2
2
Moreover,
the
sum
of
the
deg(Ln
)’s
satisﬁes:



2n
(2n
+
1)
·
(d
−
1
−
n)!

12
exp(deg(Ln
))
=
n!
·
·
=1
(d
+
n)!
n
n=0
n=0
d−1

d−1

239
(for
any
positive
integer
n).
Proof.
The
inequality
concerning
deg(Ln
)
follows
immediately
from
Proposition
3.2,
(ii.),
and
Lemma
3.5
below.
Thus,
it
remains
to
prove
the
assertion
concerning
the
sum
of
the
deg(Ln
)’s.
Although
it
is
not
logically
necessary
for
the
proof,
we
ﬁrst
observe
that
the
fact
that
the
sum
of
the
deg(Ln
)’s
is
zero
is
compatible
with
the
inequalities
just
proven.
Indeed,
we
have

d−1


d
n
n=1
n
·d
1
2

≥1
while
(by
Lemma
3.6
below)

d−1


d
n
n=1
n


d−1


d−1



2
2
1
1
−4n−2
·d
·
e
ed
·
e
2
·log(d)
·
e−2d
≤
ed(d+
2
·d)−2d
≤
1
≤
1
2
n=0
n=1
as
desired.
Now
we
prove
exact
equality.
For
simplicity,
we
treat
the
case
of
d
odd;
the
case
of
d
even
is
similar
(only
easier).
We
compute:


1!
·
2!
·
.
.
.
·
(d
−
1)!
(2n
+
1)
·
(d
−
1
−
n)!
=
1
·
3
·
5
·
.
.
.
·
(2d
−
1)
·
(d
+
n)!
d!
·
(d
+
1)!
·
.
.
.
·
(2d
−
1)!
n=0
d−1

=
{1
·
3
·
5
·
.
.
.
·
(d
−
2)}2
·

(2!)2
·
(4!)2
·
.
.
.
·
((d
−
3)!)2
·
(d
−
1)!

(d
−
1)!
·
((d
+
1)!)2
·
((d
+
3)!)2
·
.
.
.
·
((2d
−
2)!)2
If
we
multiply
the
square
root
of
this
expression
by
"d−1
2n
n=0
n
,
we
obtain:


2!
·
4!
·
.
.
.
·
(2d
−
2)!


(2!)
·
(4!)
·
.
.
.
·
(d
−
3)!
·
(d
−
1)!
·
1
·
3
·
.
.
.
·
(d
−
2)
·
(1!
·
2!
·
.
.
.
·
(d
−
1)!)2
(d
−
1)!
·
(d
+
1)!
·
(d
+
3)!
·
.
.
.
·
(2d
−
2)!

2!
·
4!
·
.
.
.
·
(d
−
1)!
2

1
·
3
·
5
·
.
.
.
·
(d
−
2)

·
=
1!
·
2!
·
3!
·
.
.
.
·
(d
−
1)!
(d
−
1)!

(2!
·
4!
·
.
.
.
·
(d
−
3)!)2



1
·
=
1!
·
2!
·
3!
·
.
.
.
·
(d
−
1)!
(2!
·
4!
·
.
.
.
·
(d
−
3)!)2
1
=
1!
·
2!
·
3!
·
.
.
.
·
(d
−
1)!
240
as
desired.

Before
continuing,
we
review
the
following
well-known
elementary
Lemmas,
which
we
will
use
often
throughout
this
Chapter:
Lemma
3.5.
(Stirling’s
Formula)
If
n
is
a
positive
integer,
then
n!
=
nn
·
e−n
·
√
n·
√
2π
·
Θn
where
Θn
is
a
real
number
satisfying
1
≤
Θn
≤
e.
Proof.
For
a
precise
statement
of
Stirling’s
formula,
we
refer
to
[Ahlf],
Chapter
5,
§2.5,
Ex.
2.
The
inequalities
stated
here
are
formal
consequences
of
Stirling’s
formula
stated
in
this
form.

Lemma
3.6.
Proof.
y
If
x,
y
are
positive
real
numbers,
then
(
xy
)x
≤
e
e
.
def
u
By
letting
u
=
xy
,
we
see
that
it
suﬃces
to
prove
that
u
≤
e
e
,
or,
equivalently,
def
that
f
(u)
=
u
−
e
·
log(u)
is
≥
0
for
all
positive
real
u.
Now
note
that
f
(u)
=
1
−
ue
is
0
if
and
only
if
u
=
e.
Moreover,
since
f
(e)
=
0,
f
(0)
=
+∞,
f
(+∞)
=
+∞,
we
thus
conclude
that
f
(u)
≥
0
for
all
positive
real
u,
as
desired.

The
above
discussion
of
the
fundamental
combinatorial
model
at
ﬁnite
and
inﬁnite
primes,
together
with
Remark
2
following
Proposition
3.1,
motivate
the
following
point
of
view:
Fix
an
integer
n
≥
2.
Then
let
us
consider
the
limit
lim
d→∞
tn,d
(dλ
·
T
)
dλ·n
·
Coeﬀ
T
n
(tn,d
(T
))
where
λ
∈
R,
and
“Coeﬀ
T
n
(−)”
denotes
the
coeﬃcient
of
T
n
in
the
polynomial
in
parentheses.
Proposition
3.1,
(6),
states
that
when
λ
>
1,
this
limit
exists
and
is
equal
to
T
n
.
Proposition
3.1,
(5),
states
that
when
λ
=
1,
this
limit
exists
and
is
equal
to
a
polynomial
of
degree
n
whose
leading
term
is
T
n
,
but
which
has
(as
one
sees
from
the
explicit
formula
for
the
Legendre
polynomials
given
in
Proposition
2.1)
nonzero
terms
of
lower
degree.
The
fact
that
there
exist
nonzero
terms
of
lower
degree
implies
that
if
λ
<
1,
then
the
above
limit
diverges.
Thus,
we
see
that
“λ
=
1”
is
a
distinguished
value
associated
to
the
family
of
systems
of
discrete
Tchebycheﬀ
polynomials
that
one
obtains
as
d
varies.
Terminology
3.7.
We
shall
refer
to
this
special
exponent
λ
of
the
scaling
factor
d
as
the
slope
of
this
family
of
orthogonal
systems
on
ﬁnite
discrete
sets.
241
Later
in
this
Chapter
(cf.
§6,
especially
Theorem
6.7),
we
shall
encounter
another
family
of
orthogonal
systems
on
ﬁnite
discrete
sets
whose
slope
is
12
and
whose
limit
is
the
Hermite
polynomials.
On
the
other
hand,
the
natural
system
of
polynomials
at
the
ﬁnite
primes,
i.e.,
the
binomial
coeﬃcient
polynomials
T
[n]
(cf.
the
discussion
at
the
beginning
of
this
§),
have
slope
0,
i.e.,
the
exact
same
polynomials
T
[n]
capture
the
integral
structure
at
ﬁnite
primes
of
Z-valued
functions
on
the
set
{0,
.
.
.
,
d
−
1},
regardless
of
the
size
of
d.
It
turns
out
that
the
combinatorics
of
these
three
types
of
systems,
i.e.,
Legendre,
Hermite,
and
binomial,
are
fundamental
to
the
theory
of
the
comparison
isomorphism
at
archimedean
places
(cf.
Chapter
VIII).
Moreover,
in
Chapter
VIII,
we
shall
see
that
these
three
types
of
systems
form
the
fundamental
models
of
approximation
that
allow
us
to
estimate
the
diﬀerence
between
the
natural
metrics
on
the
spaces
of
“de
Rham
functions”
and
“étale
functions”
(cf.
§0).
Also,
it
is
interesting
to
note
that
the
slopes
of
these
three
models,
i.e.,
1,
12
,
and
0,
are
exactly
the
same
as
the
slopes
of
Frobenius
that
appear
in
the
Frobenius
action
on
the
ﬁrst
crystalline
cohomology
group
associated
to
an
elliptic
curve
in
characteristic
p.
Indeed,
it
is
precisely
because
we
feel
that
there
is
a
deep
analogy
between
these
two
notions
of
“slope”
that
we
chose
the
name
“slope”
for
the
invariant
λ
of
the
above
discussion.
For
more
on
this
analogy,
we
refer
to
the
discussion
of
§6.
§4.
The
Kähler
Geometry
of
a
Polarized
Elliptic
Curve
In
this
§,
we
study
the
Kähler
geometry
of
a
polarized
elliptic
curve
(i.e.,
an
elliptic
curve
equipped
with
a
line
bundle
of
degree
1)
over
C.
Since
the
underlying
real
analytic
manifold
of
such
an
elliptic
curve
is
a
two
(real)
dimensional
torus,
it
is
natural
to
expect
that
the
topology
of
the
torus
will
play
a
fundamental
role
in
our
analysis.
In
fact,
the
key
technology
that
we
will
use
in
this
§
is
a
sort
of
Lie
algebra
version
of
the
theta
groups
discussed
in
Chapter
IV,
§1.
That
is
to
say,
just
as
the
theta
group
of
a
line
bundle
may
essentially
be
thought
of
as
the
extension
of
(a
certain
portion
of)
the
étale
fundamental
2
group
of
the
elliptic
curve
determined
by
the
étale
cohomological
ﬁrst
Chern
class
(∈
Het
–
i.e.,
the
“Weil
pairing”)
of
the
line
bundle
in
question,
the
“diﬀerential
theta
group”
that
we
consider
here
may
be
thought
of
as
the
extension
of
the
topological
fundamental
group
tensored
with
C
determined
by
the
diﬀerential-geometric
ﬁrst
Chern
class
of
the
line
bundle
in
question.
This
technology
will
allow
us
to
analyze
(in
terms
of
various
diﬀerential
operators)
the
structure
of
certain
natural
metrics
on
the
space
of
sections
of
the
line
bundle
in
question
over
the
universal
extension
of
the
elliptic
curve.
This
analysis
will
be
important
in
the
following
§’s
since
it
will
allow
us
to
relate
these
natural
metrics
to
the
canonical
Schottky-Weierstrass
zeta
functions
of
Chapter
III,
§7;
Chapter
IV,
§3.
We
remark
that
the
material
of
this
§
is
“in
principle
well-known,”
but
we
do
not
know
an
adequate
reference
for
it.
242
Let
E
be
an
elliptic
curve
over
C.
We
shall
often
write
E
for
the
complex
manifold
†
deﬁned
by
the
given
(algebraic)
elliptic
curve.
Let
us
write
ER
(respectively,
ER
)
for
the
underlying
real
analytic
manifold
associated
to
E
(respectively,
the
universal
extension
E
†
of
E).
Then
recall
(cf.
Chapter
III,
Deﬁnition
3.2)
that
we
have
a
canonical
real
analytic
section
†
κR
:
ER
→
ER
of
the
universal
extension
E
†
→
E
of
E.
This
section
κR
is
the
unique
real
analytic
section
†
that
respects
the
group
structures
of
ER
,
ER
.
Let
us
write
R
†
for
the
subsheaf
of
the
push-forward
of
O
†
to
OE
consisting
of
E
E
sections
of
ﬁnite
torsorial
degree
(cf.
Chapter
III,
Deﬁnition
2.2).
Thus,
R
†
admits
an
E
exhaustive
ﬁltration
{F
n
(R
†
)},
where
F
n
(R
†
)
is
the
subsheaf
of
sections
of
torsorial
E
E
degree
<
n.
In
particular,
F
n
(R
†
)
is
a
holomorphic
vector
bundle
of
rank
n
on
E.
E
Moreover,
(F
n+1
/F
n
)(R
†
)
=
τE⊗n
⊗C
OE
E
∨
(where
τE
=
ωE
,
and
ωE
is
the
cotangent
space
to
E
at
the
origin).
Next,
let
us
observe
that
the
real
analytic
splitting
κR
of
the
torsor
E
†
→
E
induces
a
real
analytic
splitting
of
the
ﬁltration
on
R
†
:
E
R
†
⊗OE
OER
=
E

τE⊗n
⊗C
OER
n≥0
Here,
we
write
OER
for
the
sheaf
of
complex-valued
real
analytic
functions
on
ER
.
Now
let
dμ
be
the
unique
(real
analytic)
(1,
1)-form
on
E
which
is
invariant
with
respect
to
translation
by
elements
of
E
and
whose
integral
satisﬁes:
dμ
=
1
E
Write
def
L
=
OE
(eE
)
def
(where
eE
is
the
origin
of
E).
Thus,
L
is
a
holomorphic
line
bundle
on
E.
Write
LR
=
L
⊗OE
OER
.
Let
||
∼
||L
be
a
Hermitian
metric
on
L
whose
curvature
ΘL
(i.e.,
the
(1,
1)form
given
locally
by
∂∂
log(||s||L
),
where
s
is
a
nonvanishing
holomorphic
section
of
L)
satisﬁes:
243
1
·
ΘL
=
dμ
2πi
(Such
a
Hermitian
metric
always
exists,
and,
moreover,
is
unique
up
to
a
positive
real
constant
multiple
–
cf.,
e.g.,
[Mumf1,2,3],
§12,
Corollary
to
Lemma
1.)
Note
that
dμ
induces
def
a
metric
||
∼
||τ
on
τE
;
||
∼
||L
and
dμ
induce
a
metric
||
∼
||VR
on
VR
=
Γ(ER
,
LR
):
def
||φ||2VR
=
E
||φ||2L
·
dμ
(for
φ
∈
VR
).
In
the
following
discussion,
it
will
be
useful
to
trivialize
ωE
once
and
for
all
by
some
diﬀerential
form
θ
such
that
||θ||ω
=
1
(where
||
∼
||ω
is
the
dual
metric
to
||
∼
||τ
).
∨
Thus,
θ
also
deﬁnes
a
trivialization
θ
∨
of
τE
,
as
well
as
trivializations
θ,
θ
of
the
complex
conjugates
of
ωE
and
τE
.
Moreover,
one
checks
easily
that
θ
∧
θ
is
imaginary
(i.e.,
complex
conjugation
acts
on
it
by
multiplication
by
−1).
Thus,
θ
∧
θ
=
−i
·
dμ
(where
the
sign
preceding
“i”
may
be
checked
by
computing
using
local
coordinates).
Moreover,
the
trivialization
θ
∨
allows
us
to
think
of
R
†
⊗OE
OER
=
E

τE⊗n
⊗C
OER
n≥0
as
the
OER
-algebra
OER
[TDR
]
of
polynomials
in
the
indeterminate
TDR
.
Now
write
def
Vn
=
Γ(E,
L
⊗OE
F
n
(R
†
))
E
Then
we
can
deﬁne
two
natural
metrics
on
Vn
,
as
follows:
(1)
Let
s
∈
Vn
.
Then
the
above
real
analytic
splitting
of
the
ﬁltration
on
R
†
induces
a
decomposition
of
s
into
components:
s
=
s[0]
+
s[1]
·
E
n−1
,
where
s[i]
∈
VR
.
Now
we
deﬁne
TDR
+
.
.
.
+
s[n
−
1]
·
TDR
def
||s||L2DR
=

||s[i]||VR
i
We
shall
refer
to
this
metric
as
the
L2DR
-metric
on
Vn
.
244
(2)
Let
s
∈
Vn
.
Then
one
may
think
of
s
as
a
(holomorphic)
section
of
L
over
E
†
.
If
we
pull-back
this
section
via
κR
,
we
obtain
a
real
analytic
section
sR
∈
VR
.
(Note
that
in
the
notation
of
(1)
above,
sR
=
s[0].)
Then
we
deﬁne
def
||s||L2R
=
||sR
||VR
We
shall
refer
to
this
metric
as
the
L2R
-metric
on
Vn
.
One
of
the
goals
of
this
§
is
to
describe
the
precise
relationship
between
the
L2DR
-
and
L2R
-metrics.
To
do
this,
we
must
introduce
various
diﬀerential
operators,
as
follows.
First,
let
us
denote
by
∇R
:
LR
→
LR
⊗OER
ΩER
(where
ΩER
is
the
rank
two
locally
free
OER
-module
of
(complex-valued)
diﬀerentials
on
ER
)
naturally
associated
to
the
metric
||
∼
||L
(cf.,
e.g.,
[Wells],
Chapter
III,
Theorem
2.1).
Then
the
decomposition
0,1
ΩER
=
Ω1,0
ER
⊕
ΩER
0,1
1,0
(where
Ω1,0
ER
=
ΩE
⊗OE
OER
,
and
ΩER
is
the
complex
conjugate
of
ΩER
)
induces
a
decomposition
∇R
=
∇1,0
⊕
∇0,1
where
∇0,1
is
simply
the
∂-operator
on
L.
If
we
think
of
E
†
→
E
as
the
torsor
of
holomorphic
connections
on
L−1
(cf.
Chapter
III,
Theorem
4.2),
then
we
see
that
the
(1,
0)-component
∇1,0
induces
a
real
analytic
section
†
κ∇
R
:
ER
→
ER
Moreover:
Proposition
4.1.
We
have:
κR
=
κ∇
R
,
i.e.,
the
canonical
real
analytic
section
κR
of
Chapter
III,
Deﬁnition
3.2,
is
the
same
as
the
real
analytic
section
deﬁned
by
the
canonical
connection
∇R
associated
to
||
∼
||L
.
245
Proof.
Since
E
†
→
E
is
a
holomorphic
torsor,
we
may
consider
∂
of
real
analytic
sections
s
of
this
torsor.
Such
a
∂(s)
will
be
a
real
analytic
(1,
1)-form
on
E
whose
integral
∂(s)
=
−1
E
is
precisely
the
class
in
H
1
(E,
ΩE
)
∼
=
C
corresponding
to
the
torsor
E
†
→
E.
Next,
let
us
observe
that
(it
follows
from
the
deﬁnitions
that)
∂(κ∇
R
)
is
a
constant
multiple
of
the
curvature
ΘL
,
hence
is
translation
invariant.
On
the
other
hand,
one
sees
immediately
from
the
deﬁnition
of
κR
(cf.
Chapter
III,
Deﬁnition
3.2)
–
which
is
essentially
a
matter
def
of
linear
algebra
–
that
∂(κR
)
is
also
translation
invariant.
Thus,
if
we
write
η
=
κR
−
κ∇
R
for
the
(1,
0)-form
on
E
given
by
the
diﬀerence
between
the
two
sections
in
question,
we
see
that
∂(η)
is
a
translation
invariant
(1,
1)-form
whose
integral
is
zero.
Thus,
∂(η)
=
0,
i.e.,
η
is
holomorphic.
Moreover,
η
∈
Γ(E,
ΩE
)
=
ωE
will
be
zero
if
it
is
invariant
under
pull-back
by
the
automorphism
α
:
E
→
E
given
by
multiplication
by
−1.
On
the
other
hand,
it
is
clear
from
the
deﬁnitions
that
both
κR
and
κ∇
R
are
invariant
with
respect
to
α.
Thus,
α(η)
=
η,
which
implies
that
η
=
0,
as
desired
(cf.
the
proof
of
Chapter
III,
Theorem
5.6).

Remark.
Note
that
if
Gm
→
E
=
Gm
/q
Z
is
a
Schottky
uniformization
(as
in
the
discussion
preceding
Chapter
III,
Deﬁnition
3.3),
then
the
splitting
κΛ1
:
Gm
→
E
†
|Gm
of
Chapter
III,
Deﬁnition
3.3,
coincides
with
κR
on
S1
⊆
C×
=
Gm
.
(Here,
note
that

since
S1
q
Z
=
{1},
we
also
have
an
inclusion
S1
→
Gm
/q
Z
=
E.)
Indeed,
this
follows
from
the
fact
that
both
κR
|S1
and
κΛ1
|S1
are
continuous
group
homomorphisms.
Thus,
their
diﬀerence
is
a
continuous
group
homomorphism
S1
→
ωE
(∼
=
C),
hence
is
zero.
1
This
coincidence
of
κR
and
κΛ1
on
S
⊆
Gm
,
E
will
be
important
in
the
computations
of
this
Chapter
since
it
will
allow
us
to
relate
the
real
analytic
theory
of
the
present
§
to
the
arithmetic
Schottky
uniformizations
over
Z
that
appeared
throughout
Chapters
III-VI.
Now
we
would
like
to
study
the
various
diﬀerential
operators
introduced
above.
Recall
that
in
the
above
discussion,
we
chose
trivializations
θ,
θ
of
ωE
,
ω
E
(the
complex
conjugate
of
ωE
).
These
trivializations
allow
us
to
regard
the
operators
∇1,0
and
∇0,1
as
operators
on
VR
=
Γ(ER
,
LR
).
Note
that
the
L2
-norm
||
∼
||VR
deﬁned
above
on
VR
corresponds
naturally
to
an
inner
product

−,
−
VR
on
VR
.
Proposition
4.2.
We
have:
(∇1,0
)∗
=
∇0,1
;
(∇0,1
)∗
=
∇1,0
(where
“∗”
denotes
the
adjoint
of
an
operator
on
VR
equipped
with
the
inner
product

−,
−
VR
).
Proof.
Indeed,
if
φ,
ψ
∈
VR
,
then
246

∇1,0
(φ),
ψ
VR
=
i
·

∇1,0
(φ)
·
θ,
ψ
·
θ
L
E
i
·

∇R
(φ),
ψ
·
θ
L
=
E
=−
i
·

φ,
∇R
(ψ
·
θ)
L
+
E
=−
i
·
d

φ,
ψ
·
θ
L
E
i
·

φ,
∇R
(ψ
·
θ)
L
E
i
·

φ,
∇0,1
(ψ)
·
θ
∧
θ
L
=
E

φ,
∇0,1
(ψ)
L
·
dμ
=

φ,
∇0,1
(ψ)
VR
=
E
Here,
the
second
(respectively,
third;
fourth;
ﬁfth)
equality
follows
from
the
fact
that
all
(0,
2)-forms
are
identically
zero
(respectively,
the
fact
that
∇R
preserves
the
metric
||
∼
||L
;
Stokes’
theorem;
the
fact
that
all
(2,
0)-forms
are
identically
zero),
and
we
recall
that
θ
∧
θ
=
−i
·
dμ
Thus,
(∇1,0
)∗
=
∇0,1
,
as
desired.
The
relation
(∇0,1
)∗
=
∇1,0
follows
similarly.

Thus,
in
the
following,
we
shall
simply
write:
∗
def
∂
=
∇1,0
;
def
∂
=
∇0,1
∗
Put
another
way,
∂
(respectively,
∂)
is
simply
∇R
evaluated
in
the
direction
θ
∨
(respec∨
tively,
θ
).
∗
Proposition
4.3.
We
have:
[∂
,
∂]
=
−2π.
∨
Proof.
Note
that
[θ
∨
,
θ
]
=
0.
(Indeed,
this
follows
from
the
fact
that
the
Lie
algebra
of
the
complex
Lie
group
E
†
is
abelian!)
Thus,
it
follows
from
the
deﬁnitions
(cf.
[Wells],
∗
Chapter
III,
Proposition
1.9)
that
[∂
,
∂]
is
simply
the
curvature
ΘL
(which
is
a
(1,
1)-form)
∗
divided
by
θ
∧
θ
=
−i
·
dμ,
i.e.,
[∂
,
∂]
=
−2π,
as
desired.

Remark.
One
can
now
deﬁne
the
Lie
algebra
GLdiﬀ
to
be
the
Lie
algebra
(over
C)
of
∗
operators
on
VR
generated
by
1,
∂,
∂
.
Thus,
we
have
an
exact
sequence
0
→
C
·
1
→
GLdiﬀ
→
Lie(E
†
)
→
0
247
∗
where
C
·
1
is
central
in
GLdiﬀ
,
and
Lie(E
†
)
=
C
·
∂
+
C
·
∂
is
the
Lie
algebra
of
E
†
.
Moreover,
the
commutator
product
of
GLdiﬀ
deﬁnes
a
bilinear
morphism
Lie(E
†
)
×
Lie(E
†
)
→
C
∗
that
maps
(∂
,
∂)
→
−2π
(by
Proposition
4.3).
This
bilinear
form
is
essentially
the
“differential
geometric”
ﬁrst
Chern
class
of
the
line
bundle
L.
Thus,
this
“diﬀerential
theta
group”
GLdiﬀ
is
very
much
analogous
to
the
“étale
theta
groups”
reviewed
in
Chapter
IV,
§1.
Next,
we
would
like
to
consider
the
following
Laplacian
operator
on
VR
:
def
Δ
=
1
∗
·∂
·∂
2π
Then
we
have
the
following:
Proposition
4.4.
We
have:
(i.)
Δ∗
=
Δ
(ii.)
Δ
·
∂
=
∂
·
(Δ
−
1)
∗
∗
(iii.)
Δ
·
∂
=
∂
·
(Δ
+
1)
In
particular,
the
eigenvalues
of
Δ
are
all
real
and
nonnegative,
and
eigenfunctions
of
Δ
with
distinct
eigenvalues
are
orthogonal
to
one
another
(with
respect
to

−,
−
VR
).
Moreover,
if,
for
s
∈
VR
,
λ
∈
R,
we
have
Δ(s)
=
λ
·
s,
then
Δ(∂(s))
=
(λ
−
1)
·
(∂(s));
∗
∗
Δ(∂
(s))
=
(λ
+
1)
·
(∂
(s)).
∗
∗
Proof.
(i.)
Since
(∂)∗
=
∂
,
(∂
)∗
=
∂,
we
obtain
immediately
that
Δ∗
=
Δ.
∗
∗
(ii.)
Compute
(using
Proposition
4.3):
2π
·Δ·∂
=
∂
·∂
·∂
=
∂
·∂
·∂
−2π
·∂
=
2π
·(∂
·Δ−∂).
∗
∗
∗
∗
∗
∗
(iii.)
Compute
(using
Proposition
4.3):
2π
·
Δ
·
∂
=
∂
·
∂
·
∂
=
∂
·
∂
·
∂
+
2π
·
∂
=
∗
∗
2π
·
(∂
·
Δ
+
∂
).
The
ﬁnal
remarks
—
except
for
the
fact
that
the
eigenvalues
are
≥
0,
but
this
follows
from
the
well-known
argument:
Δ(s)
=
λ
·
s
=⇒
λ

s,
s
VR
=

s,
Δ(s)
VR
=
248

∂(s),
∂(s)
VR
≥
0
—
in
Proposition
4.4
are
formal
consequences
of
(i.),
(ii.),
and
(iii.).

We
are
now
ready
to
prove
the
following
result:
Theorem
4.5.
The
pull-back
morphism
κ∗R
:
Vn
→
VR
n
is
injective,
and
its
image
is
equal
to
the
kernel
of
∂
(as
an
operator
on
VR
).
In
fact,
to
apply
∂
to
an
element
of
the
image
of
κ∗R
:
Vn
→
VR
corresponds
to
applying
the
∨
relative
exterior
diﬀerential
operator
(in
the
direction
θ
)
of
the
morphism
E
†
→
E
to
the
corresponding
element
of
Vn
.
In
particular,
Ker(∂)
∼
=
V1
is
a
one-dimensional
complex
DR
vector
space.
If
ζ0
∈
Ker(∂)
is
nonzero,
write
def
ζnDR
=
1
∗
·
(∂
)n
(ζ0DR
)
n!
def
if
n
>
0,
ζnDR
=
0
if
n
<
0.
Then
for
n
≥
0,
we
have:
C
·
ζnDR
=
Ker(Δ
−
n),
and
n+1
∗
DR
ζ0DR
,
.
.
.
,
ζnDR
form
an
orthogonal
basis
of
Ker(∂
)
such
that
∂
(ζnDR
)
=
(n
+
1)
·
ζn+1
;
n
(2π)
DR
DR
DR
2
DR
2
∂(ζn
)
=
2π
·
ζn−1
;
||ζn
||VR
=
n!
·
||ζ0
||VR
.
Proof.
That
κ∗R
:
Vn
→
VR
is
injective
follows
from
the
fact
that
if
it
were
not,
then
the
image
of
κR
would
be
contained
inside
a
one-dimensional
complex
subvariety
of
E
†
,
which
is
absurd
(cf.
the
deﬁnition
of
κR
in
Chapter
III,
§3).
The
statement
concerning
the
correspondence
between
∂
and
the
relative
exterior
diﬀerential
operator
for
E
†
→
E
follows
immediately
from
the
deﬁnitions
(cf.
also
the
discussion
of
Chapter
III,
§3).
n
To
see
that
the
image
κ∗R
(Vn
)
is
equal
to
Ker(∂
),
we
reason
as
follows:
First,
the
statement
concerning
the
relationship
between
∂
and
the
relative
exterior
diﬀerenn
tial
operator
of
E
†
→
E
implies
that
κ∗R
(Vn
)
⊆
Ker(∂
).
Thus,
in
particular,
we
see
n
that
dimC
(Ker(∂
))
≥
n.
On
the
other
hand,
one
proves
easily
by
induction
on
n
that
n
dimC
(Ker(∂
))
≤
n:
Indeed,
this
is
clear
if
n
=
1,
since
(by
deﬁnition)
Ker(∂)
=
Γ(E,
L).
n
n−1
If
n
≥
2,
then
note
that
∂
deﬁnes
a
morphism
Ker(∂
)
→
Ker(∂
)
whose
kernel
has
n
dimension
≤
1.
Thus,
by
the
induction
hypothesis,
we
conclude
that
dimC
(Ker(∂
))
≤
n
1
+
(n
−
1)
=
n,
as
desired.
This
completes
the
proof
that
κ∗R
(Vn
)
=
Ker(∂
).
That
Δ(ζnDR
)
=
n
·
ζnDR
(for
n
≥
0)
follows
from
Proposition
4.4,
(iii.),
induction
on
n,
and
the
fact
that
Δ(ζ0DR
)
=
0.
If,
for
s
∈
VR
,
we
have
Δ(s)
=
n
·
s
(for
n
≥
1),
then
by
Proposition
4.4,
(ii.),
Δ(∂(s))
=
(n
−
1)
·
∂(s).
Thus,
by
induction
on
n,
we
obtain
that
n
Δ(s)
=
n
·
s
(for
n
≥
1)
implies
∂
(s)
∈
Ker(Δ).
But
if
Δ(t)
=
0,
then
249
∗

∂(t),
∂(t)
VR
=

t,
∂
·
∂(t)
VR
=

t,
Δ(t)
VR
=
0
n+1
).
On
the
other
hand,
this
imso
∂(t)
=
0.
Thus,
in
summary,
Ker(Δ
−
n)
⊆
Ker(∂
DR
DR
plies
that
ζ0
,
.
.
.
,
ζn
(which
are
mutually
orthogonal
by
Proposition
4.4,
hence
linearly
n+1
),
which
(as
we
saw
above)
has
dimension
n
+
1.
independent
over
C)
are
∈
Ker(∂
n+1
DR
DR
Thus,
we
conclude
that
ζ0
,
.
.
.
,
ζn
form
an
orthogonal
basis
of
Ker(∂
),
and
that
DR
Ker(Δ
−
n)
=
C
·
ζn
,
as
desired.
∗
DR
DR
follows
from
the
deﬁnitions.
That
∂(ζnDR
)
=
2π
·
ζn−1
That
∂
(ζnDR
)
=
(n
+
1)
·
ζn+1
follows
by
computing
(using
Proposition
4.3):
∗
DR
DR
DR
∂(ζnDR
)
=
n−1
·
∂
·
∂
(ζn−1
)
=
2π
·
n−1
·
(Δ
+
1)(ζn−1
)
=
2π
·
ζn−1
n
DR
2
Finally,
||ζnDR
||2VR
=
(2π)
n!
·
||ζ0
||VR
follows
by
computing:
DR
DR
,
ζn−1

2π
·
n
·

ζnDR
,
ζnDR

=
2π
·

Δ(ζnDR
),
ζnDR

=

∂(ζnDR
),
∂(ζnDR
)

=
(2π)2
·

ζn−1
This
completes
the
proof
of
Theorem
4.5.

We
are
now
ready
to
analyze
the
relationship
between
the
L2DR
-
and
L2R
-metrics:
Corollary
4.6.
Let
ζnDR
[TDR
]
∈
Vn
be
the
unique
element
such
that
κ∗R
(ζnDR
[TDR
])
=
ζnDR
.
Then,
relative
to
the
above
decomposition
of
R
†
⊗OE
OER
,
we
have:
E
ζnDR
[TDR
]
=
n

ζiDR
·
n−i

DR
)

(2π
·
T
(n
−
i)!

(2π
·
T
)n


(2π
·
T
)n−1

DR
DR
DR
+
ζ1DR
·
+
.
.
.
+
ζn−1
=
ζ0DR
·
·
(2π
·
TDR
)
+
ζnDR
n!
(n
−
1)!
i=0
In
particular,
ζ0DR
[TDR
],
ζ1DR
[TDR
],
.
.
.
,
ζnDR
[TDR
],
.
.
.
are
mutually
orthogonal
with
respect
to
both
the
L2DR
-
and
L2R
-metrics,
and
their
norms
are
given
as
follows:
If
we
rescale
the
metric
on
τE
so
that
|TDR
|
=
ρ
∈
R>0
(note
that
in
the
above
discussion
ρ
=
1),
then
||
ζnDR
[TDR
]
||L2R
=
||ζnDR
||VR
=
250

(2π)n

12
n!
·
||ζ0DR
||VR
n


(2π
·
ρ)n−i
2

(2π)i

12
·
·
||ζ0DR
||VR
(n
−
i)!
i!
i=0
n



n
(2π
·
ρ2
)i

12
DR
=
||
ζn
[TDR
]
||L2R
·
i
i!
i=0
||
ζnDR
[TDR
]
||L2DR
=
=
||
ζnDR
[TDR
]
||L2R
·
Cn
(ρ)
n
where
1
≤
Cn
(ρ)
≤
eπ
·
2
2
·
Max(1,
ρn
).
Proof.
Let
us
ﬁrst
show
that
ζnDR
[TDR
]
=
ζ0DR
·

(2π
·
T
n
DR
)
n!
+
ζ1DR
·

(2π
·
T
n−1

DR
)
(n
−
1)!
DR
+
.
.
.
+
ζn−1
·
(2π
·
TDR
)
+
ζnDR
We
use
induction
on
n.
The
result
is
clear
for
n
=
0,
so
assume
the
result
known
for
“n
−
1.”
The
fact
that
the
constant
term
of
ζnDR
[TDR
]
is
ζnDR
follows
from
the
deﬁnition
of
ζnDR
[TDR
].
Thus,
to
prove
the
above
equality,
it
suﬃces
to
prove
it
after
applying
∂
∂
∗
∂TDR
.
Since
applying
∂TDR
corresponds
(relative
to
pull-back
via
κR
)
to
applying
∂
to
the
DR
corresponding
element
of
VR
(cf.
Theorem
4.5),
it
follows
(since
∂(ζnDR
)
=
2π
·
ζn−1
by
Theorem
4.5)
that
it
suﬃces
to
show
that
DR
2π
·
ζn−1
[TDR
]
=
ζ0DR
·
n−1

DR
)

2π
·
(2π
·
T
(n
−
1)!
+
ζ1DR
·
n−2

DR
)

2π
·
(2π
·
T
(n
−
2)!
DR
+
.
.
.
+
ζn−1
·
(2π)
But
this
follows
from
the
induction
hypothesis.
This
completes
the
computation
of
the
components
of
ζnDR
[TDR
].
The
statement
concerning
orthogonality
then
follows
from
the
statement
concerning
the
orthogonality
of
the
ζnDR
’s
in
Theorem
4.5.
The
computation
of
the
norms
also
follows
from
the
norm
computation
of
Theorem
4.5
(together
with
the
elementary
facts
that
n
n
xi
n
x
i=0
i!
≤
e
for
x
≥
0).

i
≤
2
,
Remark
1.
One
can
regard
the
results
of
Corollary
4.6
as
the
computation
of
the
analytic
def
torsion
of
Vn
=
Γ(E,
L
⊗OE
F
n
(R
†
)).
If
there
were
“no
analytic
torsion,”
then
the
norm
E
of
ζnDR
[TDR
]
would
go
roughly
as
the
norm
of
its
“leading
term,”
i.e.,
roughly
as
(2π)n
n!
251
n
1
2
not
as
(
(2π)
n!
)
(as
in
Corollary
4.6).
Remark
2.
The
reader
may
already
have
noticed
many
formal
similarities
between
Theorem
4.5,
Corollary
4.6
above
and
Chapter
III,
Theorem
7.4.
These
similarities
are
by
no
means
an
accident.
In
§5
below,
we
will
discuss
the
relationship
between
the
theory
of
the
present
§
and
the
theory
of
the
canonical
Schottky-Weierstrass
functions
of
Chapter
III,
§7.
Remark
3.
Just
as
in
Chapter
III,
Remark
3
(following
Chapter
III,
Theorem
7.4),
one
can
give
a
more
“generating
function-theoretic”
formulation
of
the
Corollary
4.6
as
follows:
Let
s
be
an
indeterminate.
Let
us
write
∂
†
for
the
“∂-operator”
acting
on
real
analytic
E
†
sections
of
the
holomorphic
line
bundle
L
over
ER
.
Thus,
we
may
regard
∂
†
as
an
E
operator
on
LR
[TDR
]
∗
If
we
write
∂,
∂
for
the
operators
obtained
on
LR
[TDR
]
by
acting
on
the
coeﬃcients,
then
one
computes
easily
that
∂
†
=∂−
E
∂
∂TDR
hence
that
∗
∗
[
∂
†
,
∂
+
2π
·
TDR
]
=
[
∂,
∂
]
−
[
E
∂
,
2π
·
TDR
]
=
2π
−
2π
=
0
∂TDR
(by
Proposition
4.3).
Thus,
since
(∂
†
)(ζ0DR
)
=
0,
∂
†
also
annihilates
E
e
∗
(∂
+2π·TDR
)·s
·
ζ0DR
=
n


n≥0
i=0
E
n−i

DR
(2π
·
TDR
)
·
sn
ζi
·
(n
−
i)!
=
ζ0DR
[TDR
]
+
ζ1DR
[TDR
]
·
s
+
ζ2DR
[TDR
]
·
s2
+
.
.
.
+
ζnDR
[TDR
]
·
sn
+
...
The
coeﬃcients
of
this
series
are
precisely
the
functions
discussed
in
Corollary
4.6.
The
norms
computed
in
Corollary
4.6
may
also
be
computed
directly
from
these
exponential
expressions.
We
leave
this
as
an
exercise
for
the
reader.
252
§5.
The
Relationship
Between
de
Rham
and
Canonical
Schottky-Weierstrass
Zeta
Functions
In
this
§,
we
study
the
relationship
between
the
canonical
Schottky-Weierstrass
(“SW
”
for
short)
zeta
functions
of
Chapter
III,
§7,
and
the
de
Rham
(“DR”
for
short)
zeta
functions
of
§4
(i.e.,
the
ζnDR
’s).
In
a
word,
the
combinatorics
of
this
relationship
are
described
by
the
Hermite
polynomials
(cf.
Proposition
2.2).
Using
the
well-known
explicit
form
of
the
Hermite
polynomials,
we
give
explicit
equations
relating
the
two
types
of
zeta
functions,
and
use
these
equations
to
bound
the
norm
of
the
canonical
SW
zeta
functions
in
terms
of
the
L2DR
-metric
(of
§4).
One
way
to
think
about
the
material
of
the
present
§
is
to
regard
it
as
corresponding
to
the
usual
Hodge
comparison
theorem
(i.e.,
the
“de
Rham
isomorphism”
between
de
Rham
cohomology
and
singular
cohomology
–
cf.
Chapter
VIII,
§1)
over
C,
expressed
at
the
level
of
diﬀerential
operators,
i.e.,
∗
as
the
relationship
between
the
“de
Rham-theoretic”
operators
∂,
∂
of
§4,
which
correspond
to
diﬀerentiation
in
the
direction
of
the
Hodge
ﬁltration
and
its
complex
conjugate,
and
the
operator
δ
∗
of
Chapter
III,
§7,
which
corresponds
to
diﬀerentiation
along
a
topological
cycle
of
the
elliptic
curve.
This
relationship
between
diﬀerential
operators
is
expressed
at
the
function-theoretic
level
as
the
relationship
between
the
DR
zeta
functions
of
§4
and
the
canonical
SW
zeta
functions
of
Chapter
III,
§7.
We
continue
with
the
notation
of
§4.
Thus,
E
is
an
elliptic
curve
over
C.
Recall
from
the
discussion
of
Chapter
III,
§3,
that
one
has
a
natural
isomorphism
–
called
the
de
Rham
isomorphism
–
1
1
(E,
OE
)
∼
(E,
2πi
·
R)
⊗R
C
=
Λ
⊗Z
C
HDR
=
Hsing
def
1
(where
Λ
=
Hsing
(E,
2πi
·
Z))
of
complex
vector
spaces.
The
left-hand
side
of
this
isomor1
phism,
i.e.,
HDR
(E,
OE
),
may
be
regarded
as
the
tangent
space
to
the
universal
extension
1
(E,
OE
)
→
τE
arising
from
the
projection
E
†
,
and
thus
admits
a
natural
surjection
HDR
†
1
E
→
E.
Note
that
since
the
right-hand
side
of
this
isomorphism
Hsing
(E,
2πi
·
C)
admits
def
a
natural
real
structure
(given
by
ΛR
=
Λ
⊗Z
R),
it
follows
that
the
isomorphism
induces
1
on
HDR
(E,
OE
)
a
natural
complex
conjugation
automorphism.
If
we
use
this
automor1
phism
to
conjugate
the
projection
HDR
(E,
OE
)
→
τE
,
we
thus
obtain
a
natural
direct
sum
decomposition:
1
(E,
OE
)
=
τE
⊕
τEc
HDR
(where
τEc
is
the
complex
conjugate
C-vector
space
to
τE
).
Note
that
here
we
use
the
notation
“τEc
”
rather
than
τ
E
because
we
wish
to
think
of
τEc
here
as
a
“holomorphic
253
dimension”
(which
just
happens
to
be
isomorphic
to
the
complex
conjugate
of
τE
),
not
as
an
“anti-holomorphic
dimension”
(which
is
the
interpretation
most
commonly
given
to
a
“bar,”
as
in
τ
E
).
Next,
suppose
that
we
are
given
a
rank
one
Z-submodule
Λ1
⊆
Λ
(cf.
Chapter
III,
§3,
the
discussion
of
the
“Gm
-splitting”).
Choose
a
generator
λ1
∈
Λ1
.
Then
there
exists
a
unique
isomorphism
of
τE
with
C
relative
to
which
E
may
be
written
in
the
form
E
=
C/

1,
τ

=
C×
/q
Z
def
where
the
“1”
corresponds
to
λ1
,
q
=
e2πiτ
,
and
Im(τ
)
>
0.
Relative
to
the
de
Rham
1
isomorphism
and
the
direct
sum
decomposition
of
HDR
(E,
OE
)
discussed
above,
λ1
corresponds
to
some
element
1
(E,
OE
)
(v,
u
·
v
c
)
∈
τE
⊕
τEc
=
HDR
where
v
c
is
the
element
of
τEc
deﬁned
by
v;
u
∈
C
satisﬁes
|u|
=
1.
Moreover,
the
length
of
v
(relative
to
the
metric
||
∼
||τ
)
of
§4)
may
be
computed
as
follows:
Lemma
5.1.
If
λ1
corresponds
under
the
de
Rham
isomorphism
to
(v,
u
·
v
c
)
(where
u
∈
C
satisﬁes
|u|
=
1),
then
the
length
of
v
is
given
by:
||v||τ
=
1
1
{8π
2
·
Im(τ
)}
2
Proof.
Let
us
think
of
E
as
C/

1,
τ

=
C×
/q
Z
,
and
write
z
(respectively,
U
)
for
the
standard
coordinate
on
C
(respectively,
C×
).
Thus,
U
=
exp(2πiz).
Moreover,
the
def
diﬀerential
corresponding
to
λ1
∈
Λ1
is
given
by
d
log(U
)
=
dU
U
=
2πi
·
dz.
That
is
to
say,
||v||−1
=
||d
log(U
)||
=
2π
·
||dz||
.
Moreover,
the
deﬁnition
of
||
∼
||ω
is
such
that
ω
ω
τ
def
||dz||2ω
=
!
!
!
!
!
dz
∧
dz
!
=
2
·
Im(τ
)
E
as
desired.

Now
we
would
like
to
consider
the
relationship
between
the
canonical
SW
zeta
functions
of
Chapter
III,
§7,
and
the
DR
zeta
functions
introduced
in
§4.
To
avoid
confusion,
let
254
us
denote
the
indeterminate
“T
”
of
Chapter
III,
§7,
by
TSW
.
Thus,
we
would
like
to
investigate
the
relationship
between
ζnPD
[TSW
]
(cf.
Chapter
III,
Theorem
7.4)
and
ζnDR
[TDR
]
(Corollary
4.6).
It
follows
immediately
from
the
deﬁnitions
that
this
essentially
amounts
to
investigating
the
relationship
between
the
diﬀerential
operators:
∗
∂
+
TDR
and
δ
∗
+
TSW
(where
δ
∗
is
as
in
Chapter
III,
§7).
This
relationship
may
be
described
as
follows:
Lemma
5.2.
As
operators
on
the
holomorphic
sections
of
L
over
E
†
,
the
above
two
operators
are
related
as
follows:
∗
L
·
(∂
+
u
·
∂
+
TDR
)
=
δ
∗
+
TSW
for
some
u,
L
∈
C,
where
|u|
=
1,
|L|
=
{8π
2
·
Im(τ
)}−
2
.
1
Proof.
Note
that
δ
∗
+
TSW
is
(by
deﬁnition)
the
tautological
connection
on
L|
†
applied
E
in
the
direction
(d
log(U
))∨
.
Put
another
way,
this
operator
is
the
operator
given
by
1
diﬀerentiation
in
the
direction
deﬁned
by
λ1
∈
Λ1
⊆
ΛC
∼
(E,
OE
)
(where
we
regard
=
HDR
1
†
HDR
(E,
OE
)
as
the
tangent
space
to
E
).
By
deﬁnition,
the
tangent
space
to
ER
⊆
E
†
is
1
given
by
Λ
⊗
R
→
HDR
(E,
OE
).
Thus,
it
follows
that
this
tangent
direction
is
contained
inside
the
real
analytic
submanifold
ER
⊆
E
†
deﬁned
by
the
section
κR
.
Moreover,
since
λ1
corresponds
to
(v,
u·v
c
)
under
the
de
Rham
isomorphism,
diﬀerentiation
in
this
tangent
∗
direction
on
ER
is
given
by
the
operator
L
·
(∂
+
u
·
∂),
for
some
L,
u
as
in
the
statement
of
Lemma
5.2.
Note
that
here,
L
is
deﬁned
by
the
relation
L
·
θ
=
(d
log(U
))∨
.
Similarly,
relative
to
the
decomposition
of
E
†
induced
by
κR
,
the
tautological
connection
(applied
in
the
tangent
direction
in
question)
at
points
of
E
†
with
relative
coordinate
(i.e.,
the
coordinate
of
E
†
over
E)
TDR
is
given
by
adding
to
the
connection
at
the
section
κR
the
))∨
.”
But
this
quantity
is
simply
L
·
TDR
,
as
desired.

quantity
“TDR
times
(d
log(U
θ
Remark.
Note
that
the
equality
of
operators
in
Lemma
5.2
does
not
necessarily
hold
when
applied
to
arbitrary
real
analytic
sections
of
L
over
E
†
.
Indeed,
roughly
speaking,
the
operator
on
the
right-hand
side
of
the
formula
in
Lemma
5.2
is
the
“holomorphic
portion”
of
the
operator
on
the
left-hand
side
of
this
formula.
We
are
now
ready
to
compute
the
precise
relationship
between
ζnPD
[TSW
]
and
ζnDR
[TDR
].
It
turns
out
that
the
combinatorics
of
this
relationship
are
described
by
the
Hermite
polynomials
(cf.
Proposition
2.2).
Let
us
begin
by
observing
ﬁrst
of
all
that
both
ζnPD
[TSW
]
and
ζnDR
[TDR
]
are
holomorphic
(hence,
in
particular,
real
analytic)
sections
of
the
line
bundle
L
over
E
†
.
Thus,
it
makes
255
sense
to
compare
them.
Here,
by
ζnPD
[TSW
]
we
mean
the
complex
analytic
version
of
the
canonical
Schottky-Weierstrass
zeta
functions
(cf.
Chapter
III,
Remark
1
following
Theorem
7.4).
That
is
to
say,
these
functions
are
the
functions
obtained
by
regarding
the
(clearly
convergent
–
since
diﬀerentiation
does
not
eﬀect
convergence)
formal
series
in
q
of
Chapter
III,
§7,
as
holomorphic
functions
of
q
=
e2πiτ
(where
the
family
of
elliptic
curves
def
in
question
is
given
by
C×
/q
Z
,
and
τ
∈
H
=
{τ
∈
C
|
Im(τ
)
>
0}.
Theorem
5.3.
Let
n
≥
0
be
an
integer.
Choose
ζ0DR
,
ζ0PD
to
be
the
same
section
ζ0
∈
Γ(E,
L).
Then
we
have
the
following
equality
of
holomorphic
(hence,
in
particular,
real
analytic)
sections
of
L
over
E
†
:
def
ζnPD
[TSW
]
=
[n/2]

(π
·
u)m
·
(∂
∗
+
TDR
)n−2m
(ζ
DR
)
1
0
∗
n
PD
n
·
(δ
+
TSW
)
(ζ0
)
=
L
·
n!
m!
(n
−
2m)!
m=0

(π
·
u)m
DR
·
ζn−2m
[TDR
]
m!
m=0
[n/2]
=L
·
n
where
u,
L
∈
C
satisfy
|u|
=
1,
|L|
=
{8π
2
·
Im(τ
)}−
2
.
1
Similarly,
def
ζnDR
[TDR
]
=
[n/2]

(−π
·
u)m
·
(δ
∗
+
TSW
)n−2m
(ζ
PD
)
1
∗
0
n
DR
·
(∂
+
TDR
)
(ζ0
)
=
n−2m
n!
L
·
m!
(n
−
2m)!
m=0

[n/2]
=
(−π
·
u)m
PD
·
ζn−2m
[TSW
]
n−2m
·
m!
L
m=0
Proof.
Indeed,
the
ﬁrst
formula
follows
immediately
by
applying
the
identity

(c/2)m
·
B
n−2m
·v
m!
(n
−
2m)!
m=0
[n/2]
(A
+
B)
·
v
=
n!
·
n
def
def
∗
(cf.
Remark
1
following
Proposition
2.2)
with
A
=
u
·
∂
and
B
=
∂
+
TDR
(which
satisfy
∗
A(ζ0
)
=
u
·
∂(ζ0
)
=
0
and
[A,
B]
=
u
·
[∂,
∂
]
=
2π
·
u
(by
Proposition
4.3))
to
compute
1
1
∗
·
(∂
+
u
·
∂
+
TDR
)n
(ζ0DR
)
=
L−n
·
·
(δ
∗
+
TSW
)n
(ζ0PD
)
=
L−n
·
ζnPD
[TSW
]
n!
n!
(where
the
ﬁrst
equality
follows
from
Lemma
5.2).
256
def
def
The
second
formula
follows
similarly,
by
letting
A
=
−u
·
∂,
B
=
L−1
·
(δ
∗
+
TSW
).
∗
Thus,
A
+
B
=
∂
+
TDR
(cf.
Lemma
5.2),
[A,
B]
=
−2π
·
u
(cf.
Proposition
4.3).
Note
that
Lemma
5.2
applies
here
since
the
operator
∂
(as
we
have
deﬁned
it
here)
maps
all
of
the
holomorphic
sections
of
L
(over
E
†
)
in
question
to
holomorphic
sections
of
L
(over
E
†
).
Indeed,
this
may
be
veriﬁed
immediately
by
applying
∂
to
the
expression
on
the
right-hand
side
of
the
ﬁrst
formula
of
Corollary
4.6
(cf.
also
the
proof
of
Corollary
4.6).

Corollary
5.4.
Let
n
≥
0
be
an
integer.
Choose
ζ0DR
,
ζ0PD
to
be
the
same
section
ζ0
∈
Γ(E,
L).
Then
if
we
rescale
the
metric
on
τE
so
that
|TDR
|
=
ρ
∈
R>0
(note
that
in
the
above
discussion
ρ
=
1;
cf.
Corollary
4.6),
then
||
n!
·
ζnPD
[TSW
]
||L2DR
≤
||ζ0
||L2DR
·
eπ
·
Max(1,
ρn
)
·

8π
·
n

n2
Im(τ
)
Proof.
We
compute,
using
Theorem
5.3
and
Corollary
4.6:

[n/2]
1
||
n!
·
ζnPD
[TSW
]
||L2DR
≤
|n
2
·
L|n
·
π
n
·
≤

n!
DR
[TDR
]
||L2DR
·
||
ζn−2m
n
·
(m!)
m=0
n
2

n2
n
n
2
2
·
eπ
·
Max(1,
ρn
)
·
||
ζ
·
(2
·
π
·
2π)
0
||L2DR
8π
2
·
Im(τ
)


[n/2]
·
m=0

12
n!
·
n!
nn
·
(m!)2
·
(n
−
2m)!
n
n

n2
≤
·
(π/2)
2
·
eπ
·
Max(1,
ρn
)
·
||
ζ0
||L2DR
Im(τ
)



[n/2]
·
m=0

12
n!
(m!)2
·
(n
−
2m)!
n
n

n2
≤
·
(π/2)
2
·
eπ
·
Max(1,
ρn
)
·
||
ζ0
||L2DR
·
3n
Im(τ
)

8π
·
n

n2
≤
||
ζ0
||L2DR
·
eπ
·
Max(1,
ρn
)
·
Im(τ
)

as
desired.

257
§6.
Diﬀerential
Calculus
on
the
Theta-Weighted
Circle
In
this
§,
we
commence
our
study
of
the
function
theory
of
canonical
SW
zeta
functions.
We
begin
by
giving
various
estimates
(which
will
be
useful
to
us
in
Chapter
VIII,
as
well
as
in
the
present
§)
of
the
coeﬃcients
of
the
q-expansions
of
several
types
of
canonical
SW
zeta
functions
(Lemmas
6.1,
6.2).
Next,
we
introduce
what
we
call
orthogonal
canonical
SW
zeta
functions.
This
new
type
of
canonical
SW
zeta
function
is
obtained
by
applying
the
orthogonalization
process
discussed
in
§1
(cf.,
especially,
Example
(4))
to
(a
slight
variant
of)
the
divided
power
canonical
SW
zeta
functions
of
Chapter
III,
Theorem
7.4,
and
Chapter
IV,
Theorem
3.2.
Certain
limits
(in
which
the
scaling
factor
has
slope
12
–
cf.
the
discussion
surrounding
“Terminology
3.7”)
of
the
orthogonal
SW
zeta
functions
give
rise
to
canonical
SW
zeta
functions
based
on
the
Hermite
polynomials
(Theorem
6.7).
Finally,
we
relate
this
fact
to
the
discussion
of
§5
(which
may
be
summarized
as
stating
that
the
de
Rham
zeta
functions
are
essentially
Hermite
polynomial-based
canonical
SW
zeta
functions).
Write
def
A
=
C{{qsc
}}
(i.e.,
convergent
series
in
qsc
).
In
fact,
in
this
§,
we
shall
think
of
qsc
=
exp(2πiτsc
)
as
def
a
complex
variable
on
the
unit
disc
|qsc
|
<
1,
i.e.,
τsc
∈
H
=
{z
∈
C
|
Im(z)
>
0}.
def
Let
S
=
Spec(A)
(cf.
the
notation
of
Chapter
IV,
§2,3).
We
would
like
to
think
of
qsc
as
the
q-parameter
associated
to
the
elliptic
curve
E
of
Chapter
IV,
§2,3.
Thus,
qsc
is
equal
to
“q
n
”
in
the
notation
of
Chapter
IV,
§2,3.
In
the
following,
we
shall
write
qcv
(where
“cv”
stands
for
“covering”)
for
the
“q”
of
Chapter
IV,
§2,3.
Thus,
in
the
present
complex
analytic
context,
the
elliptic
curve
“E”
(respectively,
“E”)
of
Chapter
IV,
§2,3,
def
def
Z
Z
corresponds
to
Ecv
=
Gm
/qcv
(respectively,
Esc
=
Gm
/qsc
).
Also,
we
shall
write
Ucv
for
the
standard
multiplicative
coordinate
on
the
copy
(Gm
)cv
of
Gm
which
uniformizes
Z
,
and
Usc
for
the
multiplicative
coordinate
on
the
copy
(Gm
)sc
of
Gm
Ecv
=
(Gm
)cv
/qcv
def
Z
which
uniformizes
Esc
=
(Gm
)sc
/qsc
.
Thus,
n
;
Usc
=
Ucv
n
qsc
=
qcv
and
Esc
=
Ecv
/μn
.
Fix
a
character
χ
∈
Hom(Πn
,
(μn
)S
)
χ
as
in
Chapter
IV,
Theorem
3.2,
where
n
=
2m
∈
2Z.
Let
σχ
∈
Γ(C
∞
,
(L⊗n
C
∞
)
),
iχ
∈
S
S
{−m,
−m
+
1,
.
.
.
,
m
−
1}
be
as
in
Chapter
V,
Theorem
4.8.
Note
that
the
action
of
258
χ
∞
Zet
×
μn
on
(L⊗n
C
∞
)
is
compatible
with
the
Galois
action
of
Zet
×
μn
on
C
,
regarded
as
S
S
a
covering
space
of
the
elliptic
curve
E
of
Chapter
IV,
§2,3.
Thus,
if
we
descend
and
then
translate
into
the
complex
analytic
language
of
the
present
section,
we
obtain
a
natural
line
bundle
Lχsc
of
degree
1
on
Esc
.
Note
that
the
section
“θ
m
”
may
then
be
thought
of
as
a
section
of
the
line
bundle
Lχsc
over
the
cover
(Gm
)cv
→
(Gm
)sc
→
Esc
n
(where
(Gm
)cv
→
(Gm
)sc
is
the
map
Ucv
→
Usc
=
Ucv
).
Thus,
if
we
divide
the
series
for
m
σχ
in
Chapter
V,
Theorem
4.8,
by
θ
,
we
obtain
the
(twisted)
theta
function
Θχ
:

1
·k2
+(iχ
/n)·k
2
qsc
2mk+iχ
·
Ucv
·
χ(ket
)
=
k∈Z

1
(
1
·k2
+(iχ
/n)·k)
d
2
qor
2mk+iχ
·
Ucv
·
χ(ket
)
k∈Z
def
def
d
where
qor
=
qsc
,
and
d
is
a
ﬁxed
positive
integer.
(We
shall
also
write
τor
=
d
·
τsc
.)
The
point
of
introducing
these
two
“q’s”
(i.e.,
qsc
and
qor
)
is
that
we
want
to
think
of
ourselves
def
Z
as
being
interested
in
degree
d
line
bundles
on
the
elliptic
curve
Eor
=
Gm
/qor
.
To
study
such
bundles,
it
is
convenient
to
take
invariants
with
respect
to
“Zet
/d”
(cf.
Chapter
IV,
Theorem
1.4)
and
work
with
degree
d
line
bundles
on
the
quotient
Eor
/(Zet
/d)
=
Esc
.
Thus,
we
would
like
to
think
of
the
d
as
a
scaling
factor.
That
is
to
say,
qor
is
our
“original
q,”
while
qsc
is
our
“scaled
q.”
Recall
the
diﬀerential
operator
δ
∗
of
Chapter
IV,
Theorem
3.2.
This
operator
satisﬁes
N
n·N
δ
(Ucv
)
=
N
·
Ucv
(for
N
∈
Z).
Let
us
deﬁne
the
“χ-shifted
operator”
∗
δχ∗
=
δ
∗
−
def
iχ
n
Thus,
n·N
+iχ
n·N
+iχ
)
=
N
·
Ucv
δχ∗
(Ucv
(for
N
∈
Z).
Our
ﬁrst
goal
in
this
§
is
to
bound
the
coeﬃcients
in
the
expansion
of
the
“shifted
and
scaled
monomial”
canonical
SW
zeta
functions
def
ζrSS
·
θ
−m
=

δ
∗
r
χ
d
(Θχ
)
=


k
r
k∈Z
d
259
1
(
1
·k2
+(iχ
/n)·k)
d
2
·
qor
2mk+iχ
·
Ucv
·
χ(ket
)
(where
r
is
a
nonnegative
integer).
2mk+iχ
Lemma
6.1.
Let
a
be
a
positive
integer.
Then
the
coeﬃcient
CkSS
of
Ucv
satisﬁes
the
following:
in
ζrSS
(1)
If
|k|
≤
a
·
d,
then
|CkSS
|
≤
e−
d
·Im(τor
)·(k
+(iχ
/m)·k)
·
ar
≤
ar
.
2
π
(2)
Let
>
0
be
a
real
number.
If
|k|
≥
Max(
1+

,
a
·
d),
r
≤
d,
and
a
≥
12
·
(b
+
1)
·
Q−1
,
where
b
∈
R≥1
,
and
def
Q
=
π
·
Im(τor
)
2(1
+
)
then
|CkSS
|
≤
e−b·|k|
.
In
particular,
in
this
case,
we
have:
∞

∞

|CkSS
|
≤
4
·
e−a·b·d
;
|k|=a·d
|CkSS
|2
≤
4
·
e−2a·b·d
|k|=a·d
Proof.
The
estimates
of
(1)
follow
immediately
from
the
facts
that
|qor
|
≤
1;
|k|
≤
a·d
=⇒
(|k|/d)r
≤
ar
.
The
estimates
of
(2)
are
obtained
as
follows:
First,
we
observe
that
since
|k|
≥
a
·
d,
1
1
2
2
|k|
≥
1+

(so
k
−
|k|
≥
1+
·
k
),
r
≤
d,
and
a
·
Q
≥
2
·
(b
+
1),
1
2
(k
+
(2
·
iχ
/n)
·
k)
2d
1
≤
r
·
log(|k|/r)
−
2π
·
Im(τor
)
·
(k2
−
|k|)
2d
2
k
≤
|k|
−
2π
·
Im(τor
)
·
2d(1
+
)
log(|CkSS
|)
=
r
·
log(|k|/d)
−
2π
·
Im(τor
)
·
=
|k|
−
2Q
·
(|k|/d)
·
|k|
≤
|k|
−
2Q
·
a
·
|k|
≤
−b
·
|k|
(where
in
the
third
line,
we
use
Lemma
3.6),
as
desired.
The
inequalities
concerning
the
sums
then
follow
immediately.
Note
that
here
we
use
the
facts
that
260
∞

e
−k
=
(1
−
e
−1
−1
)
≤
2;
k=0
∞

e−2k
=
(1
−
e−2
)−1
≤
2
k=0
(which
follow
from
e2
≥
e
≥
2).

Next,
although
it
will
not
be
logically
necessary
in
the
following
discussion,
we
observe
that
the
estimates
of
Lemma
6.1
allow
us
to
estimate
the
coeﬃcients
of
the
congruence
canonical
SW
zeta
functions
of
Chapter
V,
Theorem
4.8
(cf.
Chapter
VIII,
§3,4,5,
for
more
details
on
the
archimedean
properties
of
these
functions):
Lemma
6.2.
2mk+iχ
The
coeﬃcient
C
CG
[r]k
of
Ucv
ζrCG
·
θ
−m
=
in
the
series

∗


k
+
λr

1
·k2
+(iχ
/n)·k
δχ
+
λr
2mk+iχ
2
·
Ucv
·
χ(ket
)
(Θχ
)
=
·
qsc
r
r
k∈Z
of
Chapter
V,
Theorem
4.8,
satisﬁes
the
following:
(1)
If
|k|
≤
a
·
d,
then
|C
CG
[r]k
|
≤
ar
·
e3r
·

r
d
r
≤
ar
·
e3r+d
.
(2)
Let
>
0
be
a
real
number.
If
|k|
≥
Max(
1+

,
a
·
d),
1
≤
r
≤
d,
and
1
−1
a
≥
2
·
(b
+
5)
·
Q
,
where
b
∈
R≥1
,
and
def
Q
=
then
|C
[r]k
|
≤
e
we
have:
CG
∞

|k|=a·d
|C
CG
−(b+1)·|k|
[r]k
|
≤
4
·
e
·
π
·
Im(τor
)
2(1
+
)

r
d
r
−a·b·d
≤
e−b·|k|
.
In
particular,
in
this
case,
∞

;
|C
CG
[r]k
|2
≤
4
·
e−2a·b·d
|k|=a·d
Proof.
of
the
polynomial
T
+λr

To
apply
Lemmai
6.1,
it
suﬃces
to
estimate
the
coeﬃcients
r
in
terms
of
(T
/d)
.
One
sees
easily
(since
|λr
|
≤
2
;
for
N
=
0,
1,
.
.
.
,
r
−
1,
r
261
N
+
λr
|
≤
r)
that
T
+λthe

estimates
of
Proposition
3.3
for
the
coeﬃcients
of
the
polynomial
|
−
T
r
also
hold
for
(by
the
same
proof
as
that
given
for
Proposition
3.3).
Thus,
these
r
r

r
≤
e2r+d
.
Since
there
are
a
total
of
r
+
1
≤
er
coeﬃcients
may
be
bounded
by
e2r
·
dr
terms
to
contend
with,
we
thus
see
that
in
order
to
get
estimates
for
C
CG
[r]k
,
it
suﬃces


to
multiply
the
estimates
for
CkSS
in
Lemma
6.1
by
e3r
·
d
r
r
≤
e3r+d
.
This
takes
care
of
(1).
For
(2),
we
note
further
that
if
we
take
the
“b”
of
Lemma
6.1
to
be
b
+
4
(in
the
notation
of
the
present
Corollary),
then
using
r
≤
d
≤
a
·
d
≤
|k|,
we
obtain
|C
CG
[r]k
|
≤
e−(b+4)·|k|+3r
·

d
r
r

d
r
≤
e−(b+4)·|k|+3·|k|
·
r

d
r
≤
e−(b+1)·|k|
·
r
−(b+1)·|k|+d
≤e
≤
e−(b+1)·|k|+|k|
=
e−b·|k|
as
desired.

Next,
we
would
like
to
introduce
the
orthogonal
canonical
SW
zeta
functions,
as
follows.
First,
in
the
following
discussion,
we
would
like
to
restrict
the
variable
Ucv
∈
C×
to
the
unit
circle;
we
shall
write
Ucv
|(S1
)cv
=
exp(2πitcv
)
(where
tcv
∈
[0,
2π))
for
this
restricted
Ucv
.
Then
observe
that
Θχ
|(S1
)cv
is
a
smooth
function
on
(S1
)cv
(varying
with
the
parameter
q).
Recall
that
L2
((S1
)cv
)
is
equipped
with
a
natural
inner
product
given
by
def
(f,
g)
=
1
·
2π
(S1
)cv
f
·
g
·
dt
Now
we
would
like
to
apply
the
theory
of
§1,
especially
Example
(4).
That
is
to
say,
we
take
def
def
H
=
L2
((S1
)cv
),
X
=
δ
∗
,
and
(for
r
≥
0)
F
r
(H)
to
be
the
complex
vector
subspace
of
H
generated
by
functions
of
the
form
P
(δχ∗
)
·
Θχ
,
where
P
(−)
is
a
polynomial
(with
complex
coeﬃcients)
of
degree
≤
r.
Put
another
way,
we
would
like
to
consider
the
(C-)linear
combinations
of
the
“standard
monomial”
canonical
SW
zeta
functions
def
ζrSM
·
θ
−m
=

r

2
1
1
iχ
2mk+iχ
d
(
2
·k
+(iχ
/n)·k)
δ
∗
(Θχ
)
=
(k
+
)r
·
qor
·
Ucv
·
χ(ket
)
n
k∈Z

1
2
iχ
−
1
·(i
/n)2
kχ
2
kχ
·
kχr
·
qsc
·
Usc
·
χ((kχ
−
)et
)
=
qsc
2
χ
n
iχ
kχ
∈
Z+
n
−
1
·(iχ
/n)2
=
qor
2d

·
1
i
kχ
∈
Z+
nχ
262
k2
kχ
2d
χ
kχr
·
qor
·
Usc
·
χ((kχ
−
iχ
)et
)
n
def
n
(where
Usc
=
Ucv
)
whose
restrictions
to
(S1
)cv
are
orthonormal
with
respect
to
the
inner
product
just
deﬁned
on
L2
((S1
)cv
).
If
we
normalize
the
orthonormal
system
that
we
deal
with
by
assuming
that
the
leading
coeﬃcient
(i.e.,
the
coeﬃcient
of
ζrSM
)
in
the
degree
r
member
of
this
system
is
a
positive
real
number,
then
we
see
that
we
obtain
uniquely
deﬁned
functions
1
1
ζ0OR,S
,
.
.
.
,
ζrOR,S
,
.
.
.
(for
r
≥
0).
Because
these
functions
are
a
sort
of
prototype
of
the
orthogonal
functions
that
we
will
consider
in
Chapter
VIII(cf.,
especially,
§2),
we
give
them
a
name:
1
Deﬁnition
6.3.
We
refer
to
the
ζrOR,S
as
the
orthogonal
canonical
Schottky-Weierstrass
zeta
functions.
1
Note
that
it
follows
from
the
general
theory
of
§1
(e.g.,
Proposition
1.2)
that
the
ζrOR,S
are
completely
determined
by
their
means
and
principal
submeans.
In
the
following
discussion,
we
would
like
to
consider
the
trivialization
θ
m
of
the
line
bundle
Lχsc
over
the
covering
(Gm
)cv
→
(Gm
)sc
→
Esc
,
where
(Gm
)cv
→
(Gm
)sc
is
the
n
map
Ucv
→
Usc
=
Ucv
.
Note
that
this
line
bundle
Lχsc
on
the
elliptic
curve
Esc
admits
a
unique
(up
to
a
positive
real
multiple)
metric
with
translation-invariant
curvature
(cf.
the
discussion
of
the
metric
||
∼
||L
in
§4).
This
metric
thus
deﬁnes
a
function
||θm
||
of
Ucv
.
For
simplicity,
let
us
assume
that
our
metric
has
been
normalized
so
that
||θm
||
=
1
at
Ucv
=
1.
Note
that
since
the
natural
action
of
μ∞
on
“L⊗n
C
∞
”
(cf.
the
discussion
at
the
S
beginning
of
Chapter
IV,
§2)
ﬁxes
θ
m
(as
well
as
the
metric
||
∼
||),
we
thus
see
that
||θm
||
is
invariant
under
translation
by
elements
of
(S1
)cv
.
In
particular,
it
follows
that
we
may
regard
||θm
||
as
a
function
of
Usc
.
Lemma
6.4.
ρ
At
Usc
=
qsc
·
exp(2πitcv
)
(where
tcv
∈
[0,
2π),
ρ
∈
R≥0
),
we
have
||θm
||
=
|qsc
|
2
·ρ
1
2
Proof.
First,
observe
that
the
section
θ
m
(of
the
line
bundle
Lχsc
over
the
cover
(Gm
)cv
→
(Gm
)sc
→
Esc
)
is
nonzero
for
all
values
of
Ucv
∈
C×
(i.e.,
it
really
is
a
“trivialization”).
Indeed,
this
follows,
for
instance,
from
the
fact
that
the
holomorphic
connection
deﬁned
by
θ
is
regular
(i.e.,
has
no
poles)
for
all
Ucv
∈
C×
(cf.
Chapter
III,
Theorem
5.6),
which
would
not
be
the
case
if
θ
had
zeroes.
Thus,
θ
m
constitutes
a
trivialization
of
the
line
bundle
in
question
at
all
values
of
Ucv
∈
C×
.
In
particular,
since
the
curvature
of
the
metric
that
we
∂2
∂2
are
using
is
translation-invariant
(i.e.,
“constant”),
it
follows
that
the
Laplacian
∂ρ
2
+
∂t2
263
def
ρ
of
the
function
φ(ρ,
t)
=
log(||θm
||)
(where
Usc
=
qsc
·
exp(2πitcv
))
is
constant.
Since
2
φ(ρ,
t)
=
φ(ρ)
is
independent
of
tcv
,
we
thus
obtain
that
ddρφ2
is
constant.
But
this
implies
that
φ(ρ)
is
a
quadratic
function
of
ρ,
hence
determined
as
soon
as
it
is
determined
for
Z
Z
,
i.e.,
for
Ucv
=
qcv
.
Thus,
it
suﬃces
to
prove
Lemma
6.4
for
such
values
of
Usc
.
Usc
=
qsc
N
m·N
2
n·N
·
Ucv
·
θ
m
||
But
for
Ucv
=
qcv
,
we
may
calculate
||θm
||
as
the
value
of
||Net
(θ
m
)||
=
||qcv
2
2
1
N
at
Ucv
=
1,
which
is
just
|qcv
|m·N
=
|qsc
|
2
·N
,
as
desired
(since
Ucv
=
qcv
corresponds
to
N
Usc
=
qsc
).
This
completes
the
proof.

Now
that
we
have
computed
the
absolute
value
of
our
trivialization
θ
m
,
we
would
like
compute
various
L2
-norms
of
canonical
zeta
functions
as
follows.
First,
let
P
(s)
be
a
polynomial
with
complex
coeﬃcients
in
the
indeterminate
s.
Then
let
us
write
−
1
·(iχ
/n)2
ζ
P
[T
]·θ
−m
=
P
(δ
∗
+T
)·(Θχ
)
=
qsc
2
def

·
1
k2
kχ
2
χ
P
(kχ
+T
)·qsc
·Usc
·χ((kχ
−
i
kχ
∈
Z+
nχ
iχ
)et
)
n
(where
the
indeterminate
“T
”
is
as
in
Chapter
IV,
§3).
We
would
like
to
consider
the
ρ
·
exp(2πitcv
)
(where
tcv
∈
[0,
2π),
ρ
∈
R≥0
),
i.e.,
value
of
this
zeta
function
at
Ucv
=
qcv
n
ρ
Usc
=
Ucv
=
qsc
·
exp(2πitcv
·
n).
Since
at
this
value
of
Ucv
,
the
indeterminate
T
takes
on
the
value
ρ
(cf.
Chapter
III,
Corollary
5.9,
for
rational
ρ;
since
T
is
a
continuous
function,
we
thus
obtain
the
result
for
arbitrary
real
ρ).
Thus,
−
1
·(i
/n)2
χ
2
ρ
ζ
P
[T
]·θ
−m
|U
=qcv
·
·exp(2πitcv
)
=
qsc

1
2
iχ
2
kχ
+kχ
·ρ
P
(kχ
+
ρ)
·
qsc
·
exp(2πitcv
·
n
·
kχ
)
·
χ((kχ
−
)et
)
n
iχ
kχ
∈
Z+
n
ρ
In
particular,
by
applying
Lemma
6.4,
for
Ucv
=
qcv
·
exp(2πitcv
),
we
obtain:
||ζ
P
[T
]||
=
|qsc
|−
2
·(iχ
/n)
+
2
·ρ
!
!

1
2
iχ
!
!
2
kχ
+kχ
·ρ
·!
P
(kχ
+
ρ)
·
qsc
·
exp(2πitcv
·
n
·
kχ
)
·
χ((kχ
−
)et
)!
n
iχ
1
2
1
2
kχ
∈
Z+
n
2
=
|qsc
|−
2
·(iχ
/n)
!

!
·!
1
1
k2
2
χ,ρ
P
(kχ,ρ
)
·
qsc
·
exp(2πitcv
·
n
·
kχ,ρ
)
·
χ((kχ,ρ
−
ρ
−
i
kχ,ρ
∈
Z+ρ+
nχ
264
!
iχ
!
)et
)!
n
Thus,
by
squaring
and
integrating
over
(S1
)cv
,
we
obtain
the
following:
ρ
Lemma
6.5.
Write
Ucv
=
qcv
·
exp(2πitcv
),
where
we
ﬁx
ρ,
and
let
exp(2πitcv
)
∈
(S1
)cv
ρ
vary.
Then
for
|Ucv
|
=
|qcv
|
,
we
have:

2
||ζ
P
[T
]||2L2
((S1
)cv
)
=
|qsc
|−(iχ
/n)
·
2
|P
(kχ,ρ
)|2
·
|qsc
|kχ,ρ
i
kχ,ρ
∈
Z+ρ+
nχ
If,
moreover,
we
integrate
these
L2
((S1
)cv
)
norms
as
ρ
ranges
from
0
to
1,
we
obtain:
||ζ
P
[T
]||2L2
(Esc
)
=
|qsc
|−(iχ
/n)
·
2
2
kχ
∈
=
e
d
·Im(τor
)·(iχ
/n)
·
2
2π
|P
(kχ
)|2
·
|qsc
|kχ
·
dkχ
i
R+
nχ
|P
(k)|2
·
e−
d
·Im(τor
)·k
·
dk
2
2π
R
(where
the
L2
-norm
L2
(Esc
)
is
deﬁned
by
integrating
the
L2
((S1
)cv
)
norms
as
a
function
of
ρ,
where
ρ
ranges
from
0
to
1).
Next,
we
would
like
to
see
what
happens
if
we
replace
(S1
)cv
in
the
above
discussion
by
def
μd
.
Let
us
write
tsc
=
n
·
tcv
,
and
think
of
μd
⊆
(S1
)sc
as
a
subset
of
the
circle
(S1
)sc
with
coordinate
exp(2πitsc
).
Then
by
restricting
ζ
P
to
μd
and
dividing
by
a(n)
(unnecessary)
factor
of
exp(2πi
·
iχ
·
tcv
)
·
θ
m
,
we
obtain
ζ
P,μd
=
exp(−2πi
·
iχ
·
tcv
)
·
θ
−m
·
P
(δ
∗
)
·
(Θχ
)|μd

−
1
·(i
/n)2
=
qsc
2
χ
·
exp(2πitsc
·
kmod
)
·
def
kmod
∈Z/dZ
·
χ((kχ
−

1
k2
2
χ
P
(kχ
)
·
qsc
i
kχ
∈
kmod
+
nχ
iχ
)et
)
n
Let
us
deﬁne
the
inner
product
on
L2
(μd
)
by
def
1
(f,
g)
=
d
·

α∈μd
f
(α)
·
g(α)
Note
that,
just
as
in
Lemma
6.5,
we
have:
||ζ
P,μd
||2L2
(μ
)
=
|qsc
|−(iχ
/n)
·
2
d

kmod
∈Z/dZ
!
!
!

1
i
kχ
∈
kmod
+
nχ
265
k2
2
χ
P
(kχ
)
·
qsc
·
χ((kχ
−
!2
iχ
!
)et
)!
n
Now
assume
(just
for
this
discussion
of
functions
on
μd
)
that
iχ
=
0.
By
Chapter
VI,
Theorem
3.1,
(2),
this
assumption
implies
that
as
P
(−)
ranges
over
the
polynomials
of
degree
<
d,
the
resulting
ζ
P,μd
form
a
basis
of
L2
(μd
).
Thus,
we
may
orthonormalize
these
ζ
P,μd
’s
to
obtain
OR,μ
ζ0
OR,μ
Deﬁnition
6.6.
We
refer
to
the
ζr
zeta
functions.
OR,μ
,
.
.
.
,
ζd−1
as
the
μd
-orthogonal
canonical
Schottky-Weierstrass
We
are
now
ready
to
state
the
main
result
of
this
§:
First,
let
us
write
Lχsc
|(S1
)cv
for
the
restriction
of
Lχsc
to
the
circle
(S1
)cv
⊆
(Gm
)cv
which
is
parametrized
by
Ucv
.
Note
that
this
bundle
Lχsc
|(S1
)cv
over
(S1
)cv
admits
a
natural
trivialization
deﬁned
by
θ
m
.
In
the
following
theorem,
we
would
like
to
consider
the
analogue
for
the
line
bundle
Lχsc
on
Esc
of
the
real
analytic
sections
ζrDR
of
§4,
5,
of
the
line
bundle
associated
to
the
origin
of
an
elliptic
curve.
Since
the
pair
(Esc
,
Lχsc
)
is
isomorphic
(by
translation)
to
the
pair
(Esc
,
OEsc
(eEsc
))
(where
eEsc
is
the
origin
of
E),
we
thus
see
that,
by
transport
of
structure,
the
theory
of
§4,5,
also
applies
to
the
pair
(Esc
,
Lχsc
).
Thus,
by
abuse
of
notation,
we
denote
by
ζrDR
the
resulting
real
analytic
section
of
Lχsc
on
Esc
(associated
to
the
choice
of
ζ0DR
deﬁned
by
σχ
).
The
following
theorem
concerns
the
restriction
ζrDR
|(S1
)cv
of
ζrDR
to
(S1
)cv
⊆
(Gm
)cv
.
Theorem
6.7.
Write
Let
r
≥
0
be
an
integer.
Let
us
ﬁx
qor
,
and
consider
d
≥
1
as
variable.
def
γd
=
d
4π
·
Im(τor
)
1
2
and
Pr,d
(s)
=
Hr
(s
·
γd−1
),
where
Hr
(−)
is
the
Hermite
polynomial
of
Proposition
2.2.
Let
def
def
ζrHMd
=
ζ
Pr,d
;
HMd
,μd
def
ζr
=
ζ
Pr,d
,μd
Then
if
we
regard
sections
of
Lχsc
|(S1
)cv
as
functions
on
(S1
)cv
by
means
of
the
trivialization
θ
m
,
we
have:
−1
1
−1
1
−1
lim
γd
2
·
(r!)
2
·
ζrOR,S
=
lim
γd
2
·
ζrHMd
=
lim
γd
2
·
d→∞
d→∞
d→∞
r!
·
ζ
DR
(2π)r/2
r
(where
the
convergence
is
relative
to
the
sup
norm
for
functions
on
(S1
)cv
).
If,
moreover,
iχ
=
0,
then
(if
we
trivialize
Lχsc
|μ∞
by
means
of
exp(2πi
·
iχ
·
tcv
)
·
θ
m
)
we
have:
266
HMd
,μd
lim
γd
2
·
(r!)
2
·
ζrOR,μ
=
lim
γd
2
·
ζr
−1
−1
1
d→∞
d→∞
−1
=
lim
γd
2
·
d→∞
r!
·
ζrDR
|μd
r/2
(2π)
(where
the
convergence
is
relative
to
the
sup
norm
for
functions
on
μ∞
).
Remark.
It
is
not
diﬃcult
to
see
that
in
the
latter
part
of
Theorem
6.7,
if
χ
is
of
order
precisely
m,
and
one
takes
the
limit
over
d
which
are
not
divisible
by
m,
then
the
latter
part
of
Theorem
6.7
holds
even
if
iχ
=
0.
Indeed,
the
only
place
where
we
used/will
use
that
iχ
=
0
is
in
the
application
of
Chapter
VI,
Theorem
3.1,
(2).
Proof.
Let
us
ﬁrst
consider
the
(S1
)cv
case.
Recall
from
Lemma
6.5
that
for
|Ucv
|
=
|qcv
|ρ
,
ρ
=
0,
we
have:

γd−1
·
||ζ
P
||2L2
((S1
)cv
)
=
γd−1
·
e
d
·Im(τor
)·(iχ
/n)
·
2
2π
|P
(kχ
)|2
·
e−
d
·Im(τor
)·kχ
2
2π
i
kχ
∈
Z+
nχ

=
e
d
·Im(τor
)·(iχ
/n)
·
2
2π

2
|Pγd
(k
)|2
·
e−
2
·(k
)
·
γd−1
1
k
∈
γd−1
(Z+
nχ
)
i
where
k
=
kχ
·
γd−1
;
Pγd
(k
)
=
P
(k
·
γd
).
Thus,
as
d
→
∞,
def
def
lim
d→∞
γd−1
·
||ζ
P
||2L2
((S1
)cv
)
=
lim
d→∞
1
k
∈R

2
|Pγd
(k
)|2
·
e−
2
·(k
)
·
dk
Put
another
way,
this
is
the
L2
-norm
of
Pγd
(−)
for
the
measure
on
R
that
appears
in
Proposition
2.2.
Since
all
the
norms
considered
here
are
on
the
ﬁnite-dimensional
Cvector
space
of
ζ
P
for
P
(−)
of
degree
≤
r,
we
thus
see
that
if
we
take
the
basis
for
this
vector
space
given
by
letting
P
(s)
=
1,
.
.
.
,
(s/γd
)j
,
.
.
.
,
(s/γd
)r
1
and
we
divide
the
norms
by
γd2
,
then
this
normed
vector
space
converges
to
the
normed
vector
space
spanned
by
the
ﬁrst
r
+1
Hermite
polynomials
of
Proposition
2.2.
This
proves
1
1
−1
−1
limd→∞
γd
2
·
(r!)
2
·
ζrOR,S
=
limd→∞
γd
2
·
ζrHMd
.
(Note
that
here
we
use
the
fact
that
1
the
L2
-norm
of
the
Hermite
polynomial
Hr
is
a
constant
(independent
of
r)
times
(r!)
2
.)
−1
−1
r!
DR
To
prove
that
limd→∞
γd
2
·
ζrHMd
=
limd→∞
γd
2
·
(2π)
,
it
suﬃces
to
observe
that
r/2
·
ζr
(by
the
latter
part
of
Lemma
6.5)
267
d→∞

2
|Pγd
(k
)|2
·
e−
2
·(k
)
·
dk
=
lim
1
lim
k
∈R
d→∞
γd−1
·
||ζ
P
||2L2
(Esc
)
and
that
the
L2
-norm
L2
(Esc
)
of
Lemma
6.5
coincides
with
the
norm
||
∼
||L2R
of
§4.
(Note
that
we
use
here
the
fact
that
the
L2
-norm
of
the
Hermite
polynomial
Hr
is
a
constant

12

r
1
(independent
of
r)
times
(r!)
2
,
while
the
L2R
-norm
of
ζrDR
is
a
constant
times
(2π)
.)
(r!)
Thus,
it
remains
to
prove
the
analogous
results
for
μd
when
iχ
=
0.
These
results
follow
similarly
by
applying
the
formula
||ζ
P,μd
||2L2
(μ
)
d
1
−d
·(iχ
/n)2
=
|qor
|
·
!
!
!

kmod
∈Z/dZ

1
2
2d
kχ
P
(kχ
)
·
qor
i
kχ
∈
kmod
+
nχ
!2
iχ
!
·
χ((kχ
−
)et
)!
n
together
with
the
estimates
of
Lemma
6.1.
When
we
apply
Lemma
6.1,
we
take
“d,”
“r”
(notation
of
Lemma
6.1)
to
be
r
(in
the
present
notation),
and
“a”
(notation
of
Lemma
d
6.1)
to
be
[
2r
]
(in
the
present
notation).
This
allows
us
to
take
“b”
(notation
of
Lemma
6.1)
arbitrarily
large
as
d
→
∞.
Also,
note
that
the
factor
of
“dr
”
(notation
of
Lemma
6.1)
in
ζrSS
does
not
bother
us
here,
since
in
the
present
notation,
this
factor
corresponds
to
r
r
which
is
constant
as
d
→
∞.
Thus,
we
obtain:
lim
d→∞

kmod
∈Z/dZ
!
!
!

1
k2
2d
χ
P
(kχ
)
·
qor
·
χ((kχ
−
i
kχ
∈
kmod
+
nχ
=
lim
d→∞
!2
iχ
!
)et
)!
n
!
1
2
!2
!
2d
kχ
!
!P
(kχ
)
·
qor
!

i
kχ
∈
Z+
nχ
,
|kχ
|≤
d
2
=
lim
!
1
2
!2
!
2d
kχ
!
!P
(kχ
)
·
qor
!

d→∞
i
kχ
∈
Z+
nχ
which
is
the
same
sum
as
that
which
appeared
in
the
discussion
of
the
(S1
)cv
case.

Remark
1.
Stated
in
words,
Theorem
6.7
asserts
that:
As
d
→
∞,
the
orthogonal
systems
of
canonical
SW
zeta
functions
obtained
from
the
natural
inner
products
on
L2
((S1
)cv
)
and
L2
(μd
)
converge
to:
(i)
one
another;
(ii)
canonical
SW
zeta
functions
modeled
on
the
Hermite
polynomials;
(iii)
the
de
Rham
zeta
functions
studied
in
§4,5.
Thus,
in
particular,
Theorem
6.7
implies
that
the
de
Rham
zeta
functions
ζrDR
are
equal
to
Hermite
polynomial-based
canonical
Schottky-Weierstrass
zeta
functions.
In
other
words,
268
we
see
that
we
have
obtained
another
independent
proof
of
the
latter
part
of
Theorem
5.3,
which,
in
the
notation
of
the
present
discussion,
reads:

(−π
·
u)j
·
(δ
∗
)r−2j
(σχ
)
Lr−2j
·
j!
(r
−
2j)!
j=0
[r/2]
ζrDR
=
[r/2]
r

(2π
·
u)
2
(−2)−j
·
(δ
∗
)r−2j
(σχ
)
r
·
(−1)
=
·
r!
·
1
(−1)r
·
r!
{(2π
·
u)
2
·
L}r−2j
·
j!
(r
−
2j)!
j=0
r
1
(2π
·
u)
2
·
Hr
({(2π
·
u)
2
·
L}−1
·
δ
∗
)
·
σχ
=
r
(−1)
·
r!
(where
|L|
=
{8π
2
·
Im(τsc
)}−
2
,
|u|
=
1).
Note
that
the
scaling
factor
here,
i.e.,
{(2π
·
u)
2
·
1
2π
}
2
=
γd
.
That
is
to
say,
Theorems
5.3
and
6.7
L},
has
absolute
value
equal
to
{
8π2
·Im(τ
sc
)
are
consistent
in
the
sense
that
they
yield
the
same
scaling
factor.
Note,
relative
to
the
discussion
surrounding
Terminology
3.7,
that
this
implies
that
(if
we
think
of
Im(τor
)
as
OR,μ
’s
(for
varying
d)
have
slope
12
(as
promised
in
§3).
ﬁxed),
the
ζr
1
1
Remark
2.
It
is
interesting
to
note
that
in
the
discussion
of
this
§,
there
are
three
natural
parameters
involved;
we
would
like
to
think
of
these
parameters
as
follows:
Holomorphic
Variable:
τor
Anti-Holomorphic
Variable:
d
Arithmetic
Variable:
r
That
is
to
say,
one
way
to
think
of
the
goal
of
this
paper
is
that
we
are
trying
to
descend
the
Z-scheme
(M1,0
)Z
(i.e.,
the
moduli
stack
of
elliptic
curves)
to
some
sort
of
object
over
the
hypothetical/mythical
“ﬁeld
of
constants”
F1
⊆
Z.
This
descent
may
be
carried
out
at
diﬀerent
primes;
here
we
are
interested
in
carrying
it
out
at
the
inﬁnite
prime.
Thus,
one
expects
that
(M1,0
)Z
should
have
three
arithmetic/real
dimensions
over
F1
.
Two
of
these
arithmetic
dimensions
should
be
geometric
and
correspond
to
the
holomorphic
and
anti-holomorphic
coordinates
on
the
complex
manifold
(M1,0
)C
.
We
feel
that
these
two
dimensions
are
given
by
τor
(the
holomorphic
coordinate)
and
the
scaling
parameter
d
(which
plays
the
role
of
the
anti-holomorphic
coordinate,
and
corresponds
to
powers
of
the
geometric
Frobenius
morphism
in
the
p-adic
theory).
Note
that
this
interpretation
of
these
parameters
is
compatible
with
the
fact
that
the
exponent
of
the
exponential
appearing
in
the
various
theta/zeta
functions
of
this
§
essentially
consists
of
τor
·d−1
,
which
is
reminiscent
of
the
exponent
“|z|2
=
z
·
z”
of
the
exponential
which
appears
in
the
usual
complex
theory
of
theta
functions
(cf.,
e.g.,
Remark
2
following
Proposition
2.2;
[Mumf3],
§12).
Finally,
we
have
the
index
“r”
which
plays
the
role
of
the
single
arithmetic
dimension
of
F1
.
In
the
padic
theory,
this
dimension
corresponds
to
arithmetic
Frobenius,
i.e.,
the
single
dimension
of
Gal(Fp
).
269
Note
that
this
point
of
view
is
compatible
with
the
point
of
view
of
the
discussion
at
the
end
of
§3
(see
also
Remark
1
above).
Indeed,
the
slope
as
discussed
in
§3
is
obtained
precisely
by
looking
at
the
“action
of
the
scaling
parameter
d.”
Also,
we
observe
that
this
point
of
view
is
reminiscent
of
the
point
of
view
of
the
Introductions
of
[Mzk1,2]
which
discuss
the
analogy
between
Frobenius
actions
and
real
analytic
Kähler
metrics.
(The
connection
here
being
that
orthogonal
functions
typically
arise
from
some
sort
of
real
analytic
Kähler
metric,
as
in
§4.)
Bibliography
[Ahlf]
L.
Ahlfors,
Complex
Analysis,
McGraw-Hill
Book
Company
(1979).
[Bate]
Erdélyi,
Magnus,
Oberhettinger,
and
Tricomi,
Higher
Transcendental
Functions,
Bateman
Manuscript
Project,
Volume
II,
McGraw-Hill
(1953).
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
Publ.
of
RIMS
32,
No.
6
(1996),
pp.
957-1151.
[Mzk2]
S.
Mochizuki,
Foundations
of
p-adic
Teichmüller
Theory,
AMS/IP
Studies
in
Advanced
Mathematics
11,
American
Mathematical
Society/International
Press
(1999).
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deﬁning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
2
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
[Rice]
J.
R.
Rice,
The
Approximation
of
Functions,
Volume
1:
Linear
Theory,
AddisonWesley
Publishing
Company
(1964).
[Sze]
G.
Szegö,
Orthogonal
Polynomials,
Amer.
Math.
Soc.,
Colloquium
Pub.
23
(1959).
[Sze2]
G.
Szegö,
Ein
Beitrag
zur
Theorie
der
Thetafunktionen,
Gabor
Szegö:
Collected
Papers,
Vol.
I,
Birkhäuser
(1982),
pp.
795-811.
[Wells]
R.
O.
Wells,
Diﬀerential
Analysis
on
Complex
Manifolds,
Graduate
Texts
in
Mathematics
65,
Springer
(1980).
270
Chapter
VIII:
The
Hodge-Arakelov
Comparison
Theorem
§0.
Introduction
In
Chapter
VII,
we
so-to-speak
“introduced
the
actors”
(which
are
systems
of
orthogonal
functions)
in
the
archimedean
theory
of
the
Comparison
Isomorphism.
In
the
present
Chapter,
we
“present
the
play.”
Put
another
way,
we
complete
the
“Scheme-Theoretic
Comparison
Isomorphism”
of
Chapter
VI
by
computing
the
behavior
of
the
Comparison
Isomorphism
at
archimedean
primes.
Thus,
in
summary,
our
result
may
be
roughly
stated
as
follows
(cf.
the
Introduction
to
Chapter
VI):
There
is
a
natural
bijection
between
certain
natural
types
of
algebraic
functions
on
the
universal
extension
of
an
elliptic
curve
and
the
“settheoretic
functions”
on
the
torsion
points
of
the
elliptic
curve.
Moreover,
this
bijection
is
compatible
with
certain
natural
metrics/integral
structures
deﬁned
at
all
(ﬁnite
and
inﬁnite)
primes
of
a
number
ﬁeld,
as
well
as
at
the
divisor
at
which
the
elliptic
curve
in
question
degenerates.
We
refer
to
this
result
as
the
Hodge-Arakelov
Comparison
Isomorphism.
In
more
precise
terms,
our
result,
obtained
by
combining
Theorem
7.4
of
the
present
Chapter
with
Chapter
VI,
Theorem
4.1,
is
as
follows:
Theorem
A.
(The
Hodge-Arakelov
Comparison
Isomorphism)
Let
d,
m
≥
1
be
integers
such
that
m
does
not
divide
d.
Suppose
that
S
log
is
a
ﬁne
noetherian
log
scheme,
and
let
C
log
→
S
log
be
a
log
elliptic
curve
over
S
log
such
that
the
divisor
at
inﬁnity
D
⊆
S
(i.e.,
the
pullback
of
the
divisor
at
inﬁnity
of
(M1,0
)Z
via
the
classifying
morphism
S
→
(M1,0
)Z
)
is
a
Cartier
divisor
on
S.
Also,
let
us
assume
that
étale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root,
and
that
we
are
given
a
torsion
point
η
∈
E∞,S
(S∞
)
271
ev
of
order
precisely
m
which
deﬁnes
line
bundles
Lst,η
,
Lst,η
(cf.
Chapter
V,
§1).
If
d
is
def
ev
def
odd
(respectively,
even),
then
let
L
=
Lst,η
(respectively,
L
=
Lst,η
).
Then:
(1)
(Compatibility
with
Base-Change)
The
formation
of
the
push-forward
(cf.
Chapter
VI,
Deﬁnition
1.3)
(fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et}
(along
with
its
ﬁltration)
commutes
with
base-change
(among
bases
S
log
satisfying
the
hypotheses
given
above).
(2)
(Zero
Locus
of
the
Determinant)
Assume
that
S
is
Z-ﬂat.
The
schemetheoretic
zero
locus
of
the
determinant
det(Ξ{∞,
et}),
i.e.,
the
determinant
of
the
evaluation
map
(cf.
Chapter
V,
Proposition
2.2;
Chapter
VI,
Theorem
3.1,
(1))
Ξ{∞,
et}
:
(fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et}
→
(fS
)∗
(L|
†
)
(d
E∞
)
is
given
by
the
divisor
d
·
[η

(d
E)]
(where
d
E
is
the
kernel
of
multiplication
by
d
on
Ed
).
In
fact,
the
divisor
of
poles

of
the
inverse
morphism
to
Ξ{∞,
et}
is
contained
in
the
divisor
[η
(d
E)].
(3)
(Analytic
Torsion
at
the
Divisor
at
Inﬁnity)
For
each
ι,
there
is
a
sequence
of
elements
aι
=
{(aι
)0
,
.
.
.
,
(aι
)d−1
};
(aι
)j
≈
j2
8d
2
j
(cf.
Chapter
of
Q≥0
·
log(q),
where
(aι
)j
goes
roughly
(as
a
function
of
j)
as
8d
VI,
Theorem
3.1,
(2)),
such
that
the
subquotients
of
the
natural
ﬁltration
on
the
domain
of
Ξ{∞,
et}
admits
natural
isomorphisms:
(F
j+1
/F
j
)((fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et})
−→
272
1
·
exp(−(aι
)j
)
·
(fS
)∗
(L|E∞,S
)
⊗OS
τE⊗j
j!
for
j
=
0,
.
.
.
,
d
−
1.
Moreover,
the
sections
of
L|
†
that
realize
these
bijections
E∞,[d]
have
q-expansions
in
a
neighborhood
of
inﬁnity
that
are
given
explicitly
in
Chapter
V,
Theorem
4.8.
(4)
(Integrality
Properties
at
the
Inﬁnite
Prime)
Suppose
that
D
=
∅,
and
S
†
†
is
of
ﬁnite
type
over
C.
Let
us
then
write
L,
Ξ,
E
†
,
E
for
L,
Ξ{∞,
et},
E∞
,
d
d
[d]
†
E∞,[d]
.
Then
one
may
equip
L
with
a
(smooth,
i.e.,
C
∞
)
metric
|
∼
|L
whose
curvature
is
translation-invariant
on
the
ﬁbers
of
E
→
S.
Moreover,
such
a
metric
is
unique
up
to
multiplication
by
a
(smooth)
positive
function
on
S(C).
Then
|
∼
|L
deﬁnes
a
metric
on
the
vector
bundle
(fS
)∗
(L|
†
)
(i.e.,
the
range
dE
of
Ξ),
namely,
the
L
-metric
for
“L-valued
functions
on
d
E
†
”
(where
we
assume
that
the
total
mass
of
d
E
†
is
1).
Since
Ξ
is
an
isomorphism,
this
metric
thus
induces
a
metric
on
(fS
)∗
(L|
†
)<d
(i.e.,
the
domain
of
Ξ),
which
we
denote
by
2
E[d]
||
∼
||et
and
refer
to
as
the
étale
metric.
On
the
other
hand,
by
using
the
canonical
real
†
analytic
splitting
of
E[d]
(C)
→
E(C)
(i.e.,
the
unique
splitting
which
is
a
continuous
homomorphism),
we
may
split
sections
of
(fS
)∗
(L|
†
)<d
into
components
E[d]
⊗r
which
are
real
analytic
sections
of
L
⊗
τE
(where
r
<
d)
over
E(C).
Since
τE
gets
a
natural
metric
by
square
integration
over
E,
these
components
have
natural
L2
-norms
determined
by
integrating
their
|
∼
|2L
over
the
ﬁbers
of
E(C)
→
S(C).
This
deﬁnes
what
we
refer
to
as
the
de
Rham
metric
||
∼
||DR
on
(fS
)∗
(L|
†
)<d
.
The
relationship
between
the
étale
and
de
Rham
metrics
may
E[d]
be
described
using
three
“models”:
(A.)
The
Hermite
Model:
This
model
states
that
if
we
ﬁx
r
<
d,
and
let
d
→
∞,
then
over
any
compact
subset
of
S(C),
the
étale
metric
||
∼
||et
on
F
r
((fS
)∗
(L|
†
)<d
)
converges
(up
to
a
factor
≤
eπ+r
,
≥
1)
E[d]
to
the
metric
||
∼
||DR
,
as
well
as
to
a
certain
metric
“||
∼
||HMd
”
deﬁned
by
considering
Hermite
polynomials
scaled
by
a
factor
of
√
(constant)·
d
in
the
derivatives
of
the
theta
functions
∈
(fS
)∗
(L|E
)
=
F
1
((fS
)∗
(L|
†
)<d
).
E[d]
(B.)
The
Legendre
Model:
This
model
states
(roughly)
that
over
any
compact
subset
of
S(C),
a
certain
average
–
which
we
denote
273
||
∼
||w,μa
–
of
translates
of
the
étale
metric
||
∼
||et
on
(fS
)∗
(L|
†
)<d
E[d]
is
equal
(provided
d
≥
25),
up
to
a
factor
of
(constant)
,
to
the
de
Rham
metric
||
∼
||DR
,
as
well
as
to
a
certain
metric
“||
∼
||Tch
”
deﬁned
by
considering
discrete
Tchebycheﬀ
polynomials
scaled
by
a
factor
of
d
in
the
derivatives
of
the
theta
functions
∈
(fS
)∗
(L|E
)
=
F
1
((fS
)∗
(L|
†
)<d
).
These
discrete
Tchebycheﬀ
polynomials
are
disd
E[d]
crete
versions
of
the
Legendre
polynomials,
and
in
fact,
if
we
let
d
→
∞
with
the
said
scaling
by
d,
then
the
discrete
Tchebycheﬀ
polynomials
converge
uniformly
to
the
Legendre
polynomials.
(C.)
The
Binomial
Model:
This
model
involves
the
explicit
q-expansions
(where
we
write
E
=
Gm
/q
Z
,
and
q
is
a
holomorphic
function
which
is
deﬁned,
at
least
locally,
on
S(C))
referred
to
in
(3)
above,
which
are
essentially
binomial
coeﬃcient
polynomials
(scaled
by
1)
in
the
derivatives
of
the
theta
functions
∈
(fS
)∗
(L|E
)
=
F
1
((fS
)∗
(L|
†
)<d
).
E[d]
If
we
divide
these
functions
by
appropriate
powers
of
q,
then
the
norm
||
∼
||qCG
for
which
these
functions
divided
by
powers
of
q
are
orthonormal
satisﬁes
the
following
property:
If
d
≥
12,
and
Im(τ
)
≥
200{log2
(d)
+
n
·
log(d)
+
n
·
log(n)}
(where
q
=
exp(2πiτ
)),
then:
n−1
·
e−32d
·
||
∼
||qCG
≤
||
∼
||et
≤
e4d
·
||
∼
||qCG
Here,
the
factor
of
n−1
that
appears
is
the
exact
archimedean
analogue
of
the
poles
that
appeared
at
ﬁnite
primes
in
(2)
above.
Finally,
for
each
of
these
three
models,
the
combinatorial/arithmetic
portion
of
the
analytic
torsion
(i.e.,
the
portion
not
arising
from
letting
the
elliptic
curve
E
degenerate
–
cf.
(3)
above
for
the
portion
arising
from
degeneration
of
the
elliptic
curve)
induced
on
(F
r+1
/F
r
)((fS
)∗
(L|
†
)<d
)
by
the
metrics
||
∼
||DR
;
||
∼
||HMd
;
||
∼
||Tch
;
||
∼
||w,μa
;
E[d]
||
∼
||qCG
(in
their
respective
domains
of
applicability)
as
r
→
d,
goes
(modulo
factors
of
the
order
(constant)d
)
as
≈
(r!)−1
≈
(d!)−1
which
is
precisely
what
you
would
expect
by
applying
the
product
formula
to
the
computation
of
the
“analytic
torsion”
in
the
ﬁnite
prime
case,
which
consists
of
a
factor
of
precisely
(r!)−1
(cf.
Chapter
V,
Theorem
3.1;
Chapter
VI,
Theorem
4.1;
Chapter
VII,
Proposition
3.4).
As
discussed
in
the
statement
of
Theorem
A,
the
key
point
of
the
archimedean
portion
of
Theorem
A
is
the
comparison
of
the
étale
and
de
Rham
metrics
||
∼
||et
,
||
∼
||DR
.
Unfortunately,
we
are
unable
to
prove
a
simple
sharp
result
that
they
always
coincide.
Instead,
we
choose
three
natural
“domains
of
investigation”
–
which
we
refer
to
as
models
274
–
where
we
compare
these
two
metrics
using
a
particular
system
of
functions
which
are
welladapted
to
the
domain
of
investigation
in
question.
One
of
the
most
important
features
of
these
three
models
is
that
they
each
have
natural
scaling
factors
associated
to
them.
The
three
models,
along
with
their
natural
scaling
factors,
and
natural
domains
of
applicability
are
as
follows:
1
Hermite
Model
(scaling
factor
=
d
2
)
:
nondegenerating
E,
ﬁxed
r
<
d
Legendre
Model
(scaling
factor
=
d)
:
nondegenerating
E,
varying
r
<
d
Binomial
Model
(scaling
factor
=
1)
:
degenerating
E
It
is
interesting
to
observe
that
the
exponents
appearing
in
these
scaling
factors,
i.e.,
0,
12
,
1,
which
we
refer
to
as
slopes,
are
precisely
the
same
as
the
slopes
that
appear
when
one
considers
the
action
of
Frobenius
on
the
crystalline
cohomology
of
an
elliptic
curve
at
a
ﬁnite
prime
(cf.
the
discussions
at
the
end
of
Chapter
VII,
§3,
6,
for
more
on
this
analogy).
If
we
write
E
=
Gm
/q
Z
,
q
=
exp(2πiτ
),
then
the
Hermite
Model
(respectively,
Legendre
Model,
Binomial
Model)
corresponds
to
the
case
where/is
most
useful
when
Im(τ
)
is
ﬁxed
(respectively,
→
0;
→
∞).
The
Binomial
Model
is
interesting
in
that
it
is
the
most
closely
analogous
to
the
situation
at
the
ﬁnite
primes.
The
Hermite
model
is
interesting
in
2
1
that
it
sheds
light
on
the
factors
of
q
≈
8d
·j
–
which
are
essentially
Gaussians
–
that
appear
in
Theorem
A,
(3).
Moreover,
the
Hermite
model
in
some
sense
makes
explicit
that
essentially
what
we
are
doing
throughout
this
entire
paper
is
simply
studying
the
derivatives
of
a
Gaussian/theta
function.
Finally,
the
Legendre
model
is
interesting
in
that
it
shows
how
the
Comparison
Isomorphism
for
general
elliptic
curves
may
be
thought
of
as
being
essentially
a
(more
complicated)
version
of
the
Fundamental
Combinatorial
Model
(cf.
Chapter
VII,
§3)
given
by
considering
integer-valued
polynomial
functions
on
a
set
of
d
points.
Our
main
technique
for
comparing
the
étale
and
de
Rham
metrics
in
these
various
models
is
to
reduce
the
problem
to
the
computation
of
certain
metrics
on
certain
ﬁnitedimensional
spaces
of
q-series.
The
q-series
then
tend
to
have
the
form:
q-series
=
“head”
+
“tail”
where
“head”
=
a
function
of
the
sort
that
appears
in
the
“model”
while
!
!
!
!
!
“tail”
!
≤
(i.e.,
the
tail
is
rather
small
compared
to
the
head).
Such
estimates
then
show
that
the
behavior
of
the
q-series
is
roughly
the
same
as
the
behavior
as
the
special
functions
of
the
275
“model.”
This
sort
of
analysis
was
already
carried
out
for
the
Hermite
Model,
which
is
technically
the
simplest
of
the
three
models,
in
Chapter
VII,
§6.
The
analogous
analysis
for
the
Legendre
Model
(which
is
technically
the
next
simplest
of
the
three)
is
carried
out
in
§1,2,
of
the
present
Chapter.
Finally,
we
carry
out
this
analysis
for
the
Binomial
Model,
which
is
by
far
the
most
technically
intricate
of
the
three
models,
in
§3,4,5,
of
the
present
Chapter.
In
§6,
we
then
relate
these
estimates
to
the
analysis
of
the
de
Rham
metric
given
in
Chapter
VII,
§4,5.
Finally,
in
§7,
we
summarize
everything
in
the
form
of
the
main
theorem.
In
a
word,
the
main
point
of
this
sort
of
“head
+
tail”
estimate
is
to
show
that
the
“tail”
is
small.
The
reason
that
the
tail
is
small
is,
invariably,
because
it
decays
like
a
Gaussian,
since
the
q-series
in
question
are
essentially
just
derivatives
of
theta
functions.
Unfortunately,
however,
because
we
are
ultimately
working
with
the
L2
-metric
||
∼
||et
deﬁned
by
a
discrete
set
of
points
(as
opposed
to,
say,
the
L2
-metric
obtained
by
integrating
over
the
entire
continuous
elliptic
curve
in
question),
numerous
technical
diﬃculties
arise.
These
technical
diﬃculties
make
the
resulting
analysis
rather
unpleasant,
especially
in
the
case
of
the
binomial
model.
Because
of
the
cumbersome
and
unenlightening
nature
of
this
analysis,
we
submit
that
the
experienced
mathematician
may
ﬁnd
it
substantially
easier
to
work
out
the
details
for
himself/herself
than
to
wade
through
the
lengthy
estimates
of
the
present
Chapter.
Also,
we
remark
in
passing,
that
although
in
Theorem
A,
we
only
give
“qualitative
estimates”
(e.g.,
of
the
form
“(constant)d
”),
in
fact,
all
the
results
that
we
derive
involve
explicit
estimates
of
the
constants
that
appear.
We
refer
to
§6,7,
for
such
explicit
estimates.
Nevertheless,
despite
the
fact
that
we
made
an
eﬀort
to
give
such
explicit
estimates
of
the
constants
that
appear,
we
made
no
eﬀort
to
give
“best
possible
estimates”
for
these
constants.
Thus,
throughout
the
arguments
of
the
present
Chapter,
the
reader
will
often
note
that
the
estimates
tend
to
be
rather
weak,
and
that
with
very
little
extra
eﬀort,
one
could
give
somewhat
stronger
estimates
for
these
constants.
Our
aim
here
was
not
to
make
any
pretense
of
giving
such
strong
estimates,
but
only
to
give
estimates
that
are
representative
of
the
essential
technique
involved.
Finally,
we
remark
that
although
this
“head
+
tail”
technique
has
an
unenlightening
technical
side,
it
also
admits
the
following
intriguing
philosophical
interpretation.
Namely,
the
terms
appearing
in
the
q-series
are
naturally
indexed
by
Z.
Roughly
speaking,
the
terms
that
contribute
to
the
head
are
those
numbered
0,
1,
.
.
.
,
N
−1
(where
N
is
a
positive
integer).
The
remaining
terms
then
naturally
form
deformations
of
the
“head
terms”
in
the
following
fashion:
The
term
numbered
by
j
deforms
the
term
numbered
by
the
unique
Head(j)
∈
{0,
.
.
.
,
N
−
1}
such
that
Head(j)
≡
j
modulo
N
.
Thus,
the
fact
that
ultimately
only
the
“head
terms”
contribute
signiﬁcantly
may
thus
be
interpreted
as
the
datum
of
the
map
(from
Z
to
{0,
1,
.
.
.
,
N
−
1})
j
→
Head(j)
in
the
language
of
function-theory.
Put
another
way,
it
may
be
regarded
as
a
functiontheoretic
encoding
of
the
splitting
276
Z∼
=
{0,
1,
.
.
.
,
N
−
1}
×
(N
·
Z)
(given
by
j
→
(Head(j),
j
−
Head(j))).
This
interpretation
is
interesting
for
the
following
reason:
As
explained
in
the
Introduction
to
the
present
paper,
the
Hodge-Arakelov
Comparison
Isomorphism
was
originally
envisioned
as
a
sort
of
Hodge
theory-type
comparison
theorem
between
de
Rham
and
étale/singular
cohomology,
in
the
context
of
Arakelov
theory.
By
analogy
with
the
case
of
a
geometric
base
(as
opposed
to,
say,
a
number
ﬁeld
as
base)
for
the
elliptic
curve
in
question,
such
a
comparison
should
result
in
some
sort
of
Kodaira-Spencer
map,
i.e.,
a
map
from
the
tangent
vectors
of
the
base
to
tangent
vectors
of
the
moduli
stack
of
elliptic
curves
(cf.
the
Introduction).
Thus,
in
particular,
this
sort
of
comparison
theorem
should
have
something
to
do
with
absolute
diﬀerentials
of
Z,
i.e.,
with
the
point
of
view
that
Z
contains
some
sort
of
“absolute
ﬁeld
of
constants
F1
”
over
which
it
acts
like
a
polynomial
algebra:
“Z
∼
=
F1
[t]”
But
now
note
that
this
formula
“Z
∼
=
F1
[t]”
is
strikingly
reminiscent
of
the
decomposition
∼
“Z
=
{0,
1,
.
.
.
,
N
−
1}
×
(N
·
Z)”
that
appeared
above.
Thus,
in
summary,
it
is
as
if
the
“head
+
tail”
approach
is
a
sort
of
appeal
to
the
notion
Z
∼
=
F1
[t]
encoded
in
functiontheoretic
language.
In
fact,
it
is
tempting
to
take
this
analogy
a
step
further
as
follows:
The
“fundamental
symmetries”
of
a
polarized
elliptic
curve
are
controlled
by
the
“theta
group”
and
its
analogous
Lie
algebra
version
(cf.
Chapter
VII,
§4).
Moreover,
this
sort
of
algebraic
structure
is
exactly
what
noncommutative
geometers
refer
to
as
a
noncommutative
torus.
Thus,
it
is
as
if
the
mathematics
of
the
Hodge-Arakelov
Comparison
Isomorphism
is
trying
to
assert
that:
The
symmetries/twist
inherent
in
the
inclusion
“F1
⊆
Z”
are
precisely
the
symmetries/twist
described
by
the
structure
known
as
a
noncommutative
torus.
It
is
the
hope
of
the
author
that
some
day
future
research
will
allow
one
to
make
these
ideas
more
rigorous.
277
§1.
Averages
of
Metrics
In
this
§,
we
discuss
certain
metrics
on
the
space
of
functions
on
S1
obtained
by
averaging
the
usual
L2
-metrics
obtained
by
restricting
these
functions
to
translates
of
a
ﬁxed
ﬁnite
subgroup
of
S1
.
These
metrics
will
play
an
important
role
in
the
theory
of
§2.
We
would
like
to
begin
by
discussing
the
Hilbert
space
L2
(S1
)
equipped
with
the
standard
inner
product:
def
(f,
g)
=
1
·
2π
S1
f
·g
def
We
shall
write
U
=
exp(2πit)
(where
t
∈
[0,
2π))
for
the
standard
coordinate
on
S1
.
Thus,
any
element
f
∈
L2
(S1
)
may
be
written
in
the
form
f=

ck
·
U
k
k∈Z
(where
ck
∈
C).
Then
L2
-norm
of
such
an
f
is
then
given
by

def
||f
||2
=
|ck
|2
k∈Z
Let
us
write
C
∞
(S1
)
⊆
L2
(S1
)
for
the
subspace
of
smooth
functions
on
S1
.
def
Now
let
us
suppose
that
we
are
also
given
two
positive
integers
d,
a.
Write
d
=
d
·
a.
Suppose
that
we
are
also
given
positive
real
numbers
(“weights”)
w0
,
.
.
.
,
wd−1
.
If
φ
=
d−1
k
1
k=0
γk
·
U
(where
γk
∈
C)
is
a
function
on
μd
(⊆
S
),
then
we
would
like
to
consider
the
norm
def
1
||φ||2w
=
·
d
d−1

wk
·
|γk
|2
k=0
on
L2
(μd
).
Thus,
for
smooth
functions
f
=

1
def
||f
||2w
=
||(f
|μd
)||2w
=
·
d
ck
·
U
k
∈
C
∞
(S1
),
we
have:
k∈Z
d−1

!
!
wk
·
!
k=0

!2
!
ck
!
k
∈k+d·Z
Moreover,
if
α
∈
S1
,
then
we
may
translate
||
∼
||w
as
follows:
1
||(Tα
(f
)|μd
)||2w
=
·
d
d−1

!
!
wk
·
!
k=0
278

k
∈k+d·Z
!2
ck
·
α
!
k
!
def
(where
Tα
(f
)(U
)
=
f
(α
·
U
)).
Note
that
||(Tα
(f
)|μd
)||2w
only
depends
on
the
image
of
α
in
S1
/μd
.
Thus,
if
we
write
αμ
for
the
image
of
α
in
S1
/μd
,
it
makes
sense
to
deﬁne
def
||f
||2w,αμ
=
||(Tα
(f
)|μd
)||2w
Now
we
have
the
following
result:
Proposition
1.1.
For
smooth
functions
f
=
def
1
||f
||2w,μa
=
=
a
·

αμ
∈μa
k∈Z
ck
·
U
k
∈
C
∞
(S1
),
we
have:
||f
||2w,αμ
d−1
a−1

!!
1

·
wk
·
!
d

k=0

k
=0

k
∈k+d·k
+d·Z
d−1
!2
!
1

!
!
ck
!
≥
·
wk
·
!
d
k=0

!2
!
ck
!
k
∈k+d·Z
(where
we
regard
μa
=
μd
/μd
⊆
S1
/μd
).
Proof.
Indeed,
from
the
deﬁnitions,
we
have:


1
1
·
||f
||2w,αμ
=
·
a
α
∈μ
a
α
∈μ
μ
a
μ
a
d−1
!

1

!
·
wk
·
!
d

k=0
!

!2
ck
·
αk
!
k
∈k+d·Z

1
=
·
a
α
∈μ
μ
a
d−1
!
a−1
1

!
·
wk
·
!
d


1
=
·
a
α
∈μ
μ
a
d−1
!
a−1

1

!
·
wk
·
!
αd·k
d

k=0
k=0
k
=0
!

!2
ck
·
αk
!

k
∈k+d·k
+d·Z
k
=0

!2
!
ck
!
k
∈k+d·k
+d·Z
(where
α
∈
S1
denotes
any
element
that
maps
to
αμ
∈
S1
/μd
).
Thus,
(readjusting
the
notation)
we
see
that
it
suﬃces
to
prove
that
if
λ0
,
.
.
.
,
λa−1
∈
C,
then
1

·
a
α∈μ
a
!
a−1
!2
a−1

!!
!!2
!
k
!
α
·
λk
!
=
!
!λk
!
k=0
k=0
To
prove
this,
it
suﬃces
to
observe
that
279
!
a−1
!2

a−1

a−1



!
k
!
k
α
·
λk
!
=
α
·
λk
α−j
·
λj
!
k=0
j=0
k=0
=
a−1

a−1

αk−j
·
λk
·
λj
k=0
j=0
(where
λj
denotes
the
complex
conjugate
of
λj
).
But
if
we
average
over
α
∈
μa
in
this
last
sum,
we
see
that
the
only
terms
that
survive
are
those
for
which
k
=
j.
Moreover,
the
a−1
!!
!!2
sum
of
these
terms
is
precisely
k=0
!λk
!
,
as
desired.

§2.
The
Legendre
Model
In
this
§,
we
study
the
space
of
canonical
SW
zeta
functions
equipped
with
a
certain
natural
metric,
arising
from
restriction
to
torsion
points.
In
particular,
we
show
that
when
equipped
with
this
metric,
the
space
of
canonical
SW
zeta
functions
becomes
“approximately
isomorphic”
to
the
space
of
discrete
Tchebycheﬀ
polynomials
studied
in
Chapter
VII,
§3.
We
begin
by
making
certain
estimates,
based
on
the
estimates
of
Chapter
VII,
Lemma
6.1.
In
the
following
discussion,
we
use
the
notation
of
Chapter
VII,
§6;
also,
we
assume
(for
simplicity)
that
d
≥
2.
First,
we
recall
the
theta
function
Θχ

1
·k2
+(iχ
/n)·k
2
qsc
2mk+iχ
·
Ucv
·
χ(ket
)
=
k∈Z

1
(
1
·k2
+(iχ
/n)·k)
d
2
qor
2mk+iχ
·
Ucv
·
χ(ket
)
k∈Z
In
Chapter
VII,
§6,
we
also
considered
the
derivatives
def
ζrSS
=

δ
∗
r
χ
d
(Θχ
)
=


k
r
k∈Z
d
1
(
1
·k2
+(iχ
/n)·k)
d
2
·
qor
2mk+iχ
·
Ucv
·
χ(ket
)
where
(to
simplify
the
notation)
we
omit
the
“·θ
−m
”
in
the
deﬁnition
of
ζrSS
.
To
prepare
for
the
discussion
below,
we
would
like
to
introduce
various
objects
related
to
the
coeﬃcients
of
this
expansion.
If
we
think
of
the
integers
0,
.
.
.
,
d
−
1
as
representing
the
elements
of
Z/dZ,
then
for
j
=
0,
.
.
.
,
d
−
1,
let
us
write
def
ej
=
Min
1
2
·
k
+
(iχ
/n)
·
k)
2
280
def
(where
the
minimum
is
over
k
such
that
k
≡
j
modulo
d)
and
wj
=
|qsc
|−2·ej
≥
1.
Next,
iχ
”
of
Chapter
V,
Theorem
4.8.
Let
us
write
recall
the
linear
function
“Ld
(T
)
=
T
+
λd
−
2m
def
λd
ld
=
d
Thus,
0
≤
ld
≤
12
(since
d
≥
2).
It
is
easy
to
check
that
λd
has
the
following
property
(cf.
the
proof
of
Chapter
V,
Theorem
4.8):
the
minimum
appearing
in
the
deﬁnition
of
ej
is
attained
for
any
k
such
that
0
≤
k
+
λd
≤
d
−
1.
Let
us
write
def
KCrit
=
{0
−
λd
,
1
−
λd
,
.
.
.
,
d
−
1
−
λd
}
for
the
set
of
such
“critical”
k.
It
thus
follows
that
ej
is
attained
for
some
k
satisfying
|k|
≤
d.
In
particular,
it
follows
that
2|ej
|
≤
|k2
+
(iχ
/m)
·
k|
≤
32
·
d2
,
hence
that
0
≤
log(wj
)
≤
3π
·
Im(τor
)
·
d
≤
6(1
+
)Q
·
d
(in
the
notation
of
Chapter
VII,
Lemma
6.1,
(2)).
Thus,
if,
for
instance,
one
is
considering
a
situation
in
which
Im(τor
)
varies
in
a
compact
subset
of
the
upper
half-plane,
then
it
follows
that
on
that
compact
subset,
wj
is
bounded
above
and
below
by
constants
C1d
,
C2d
,
where
C1
,
C2
∈
R>0
depend
only
on
the
compact
set.
Now
that
w0
,
.
.
.
,
wd−1
have
been
deﬁned,
we
may
apply
the
theory
of
§1.
In
particular,
if
we
ﬁx
a

positive
integer
a
≥
2,
then
it
follows
from
Proposition
1.1
that
for
smooth
functions
f
=
k∈Z
φk
·
U
k
∈
C
∞
((S1
)sc
),
we
have
the
following
“averaged”
L2
-norm:
def
1
||f
||2w,μa
=
d
·
d−1

wj
·
a−1

j

=0
j=0
!
!
!

!2
!
φk
!
k∈j+d·j

+d·Z
In
this
§,
we
would
like
to
consider
two
related
norms:
def
1
||f
||2Tch
=
·
d

!
!
wj
·
!
j∈KCrit

!2
!
φk
!
≤
||f
||2w,μa
k∈j+d·Z
(where,
for
j
<
0
or
>
d−1,
wj
is
deﬁned
as
wj

for
the
unique
j
∈
{0,
.
.
.
,
d−1}
such
that
j
≡
j;
and
the
inequality
follows
from
the
fact
that
||f
||2Tch
is
deﬁned
to
be
the
sum
of
a
subset
of
the
same
collection
of
nonnegative
numbers
whose
sum
constitutes
the
deﬁnition
of
||f
||2w,μa
)
and
def
1
||f
||2Tch
=
·
d

j∈KCrit
281
!
!2
!
!
wj
·
!φj
!
In
fact,
in
the
following
discussion,
we
would
like
to
consider
functions
f
∈
C
∞
((S1
)cv
)
def
i
which
are
of
the
form
f1
·
Ucvχ
,
for
some
f1
∈
C
∞
((S1
)sc
).
For
such
f
,
we
write
||f
||??
=
||f1
||??
,
where
??=
w,
μa
;
Tch
;
or
Tch.
Next,
let
us
observe
that
when
f
=
Θχ
,
then
it
follows
from
the
above
discussion
concerning
ld
that
the
resulting
“φj
”
satisfy
wj
·
|φj
|2
=
1,
for
j
∈
KCrit
.
Similarly,
if
δχ∗
is
the
diﬀerential
operator
of
Chapter
VII,
§6,
and
P
(−)
is
a
polynomial
with
complex
coeﬃcients,
then
||P
(δχ∗
)
·
Θχ
||2Tch
=

1
·
d
!2
!
!
!
P
(j)
!
!
j∈KCrit
that
is
to
say,
the
expression
on
the
right-hand
side
of
this
equation
is
essentially
(i.e.,
up
to
a
factor
of
d1
in
front,
and
a
shift
in
the
variable
j
by
the
number
λd
of
Chapter
V,
Theorem
4.8)
the
(squared)
L2
-norm
||
∼
||2
considered
in
our
discussion
of
discrete
Tchebycheﬀ
polynomials
(Chapter
VII,
§3).
In
the
following,
we
would
like
to
show
that
in
the
situation
that
we
are
interested
in,
the
norms
subscripted
w,
μa
;
Tch
;
and
Tch
are
very
close
to
another
and
hence
that
the
theory
of
orthogonal
functions
with
respect
to
the
w,
μa
-norm
is
very
close
to
the
theory
of
discrete
Tchebycheﬀ
polynomials
of
Chapter
VII,
§3.
This
observation
motivates
the
following
deﬁnitions:
First,
we
introduce
some
indeterminates
def
T
t
=
d
;
def
s
=
t
+
ld
Thus,
as
T
ranges
over
KCrit
,
s
ranges
over
0,
d1
,
.
.
.
,
d−1
d
.
In
particular,
we
have
1
||P
(δχ∗
)
·
Θχ
||2Tch
=
·
d

j∈KCrit
d−1
!
!2
!2
1

!!
!
!
!
!P
(−)|T
=j
!
=
·
!P
(j)|s=
j
!
d
d
j=0
This
makes
the
relationship
between
the
norms
considered
here
and
the
norms
of
Chapter
VII,
§3,
explicit.
Recall
that
the
“normalized
discrete
Tchebycheﬀ
polynomials”
tr
(s)
of
Chapter
VII,
Proposition
3.2,
are
orthonormal
with
respect
to
the
(square
L2
-)
norm
!2
d−1
!!
!
Q(s)
→
d1
·
j=0
!Q(
dj
)!
.
Now
we
deﬁne
the
(discrete)
Tchebycheﬀ
canonical
SW
zeta
functions
as
follows:
def
ζrTCH
=

2
1
1
δχ∗
k
2mk+iχ
d
(
2
·k
+(iχ
/n)·k)
tr
(
+
ld
)
·
qor
tr
(
+
ld
)
·
(Θχ
)
=
·
Ucv
·
χ(ket
)
d
d
k∈Z
282
where
0
≤
r
≤
d
−
1,
tr
(s)
is
the
“normalized
discrete
Tchebycheﬀ
polynomial”
of
Chapter
VII,
Proposition
3.2.
Thus,
The
ζrTCH
are
orthonormal
with
respect
to
the
inner
product
deﬁned
by
||
∼
||Tch
.
Now
we
would
like
to
estimate
the
diﬀerence
between
the
various
norms
deﬁned
above:
def
Lemma
2.1.
Let
A
be
an
integer
which
satisﬁes
A
≥
Max(a,
1
+
Q−1
),
where
Q
=
π
4
·
Im(τor
).
Then
we
have:
||P
(δχ∗
)
·
Θχ
||Tch
≤
||P
(δχ∗
)
·
Θχ
||w,μa
≤
(r
+
1)
2
·
e4r+4
·
A2r+1
·
||P
(δχ∗
)
·
Θχ
||Tch
9
for
any
polynomial
with
complex
coeﬃcients
P
(−)
of
degree
≤
r
<
d.
Proof.
The
ﬁrst
inequality
was
already
noted
in
the
discussion
above.
Thus,
let
us
prove
the
second
inequality.
We
may
assume
without
loss
of
generality
that
||P
(δχ∗
)·Θχ
||2Tch
=
1.
Thus,
it
follows
from
the
above
discussion
that
P
(T
)
=
r

γj
·
tj
(t
+
ld
)
j=0
where
γj
∈
C,
r
j=0
|γj
|2
=
1.
Next,
we
would
like
to
bound
the
coeﬃcients
of
P
(T
)
as
a
polynomial
in
t.
To
do
this,
1
ﬁrst
we
observe
that
the
coeﬃcients
of
tj
(−)
(for
j
≤
r)
may
be
bounded
by
(2r+1)
2
·e3r+1
(by
Chapter
VII,
Proposition
3.2,
(ii.)).
Moreover,
if
one
expands
(t
+ld
)j
(for
j
≤
r)
as
a

polynomial
in
t,
the
absolute
values
of
the
coeﬃcients
are
bounded
by
jj
·
|ld
|j
≤
2j
≤
2r
(where
0
≤
j
≤
j,
and
we
note
that
|ld
|
≤
12
).
Since
(t
+
ld
)j
(for
j
≤
r)
has
≤
r
+
1
terms
as
a
polynomial
in
t,
it
thus
follows
that
as
a
polynomial
in
t,
tj
(t
+
ld
)
has
coeﬃcients
of
5
5
absolute
value
≤
(r
+
1)
2
·
e3r+2
·
2r
≤
(r
+
1)
2
·
e4r+2
.
Since
|γj
|
≤
1
(for
j
≤
r),
we
thus
obtain
that
as
a
polynomial
in
t,
P
(T
)
=
P
(t
+
ld
)
has
coeﬃcients
of
absolute
value
7
≤
(r
+
1)
2
·
e4r+2
Thus,
we
obtain
||P
(δχ∗
)
·
Θχ
||w,μa
≤
(r
+
1)
2
·
e4r+2
·
7
7
2
≤
(r
+
1)
·
e
4r+2
·

δ
∗
j
χ
||
·
Θχ
||w,μa
d
j=0
r

r

j=0
283
||ζjSS
||w,μa
On
the
other
hand,
the
terms
||ζjSS
||w,μa
may
be
bounded
by
what
was
already
done
in
Chapter
VII,
Lemma
6.1,
as
follows.
To
simplify
the
notation
(more
precisely,
to
free
up
the
letter
“j”
for
use
in
future
summations),
we
consider
the
case
j
=
r.
When
j
<
r,
a
similar
argument
applies.
Now
recall
the
general
formula:
1
||f
||2w,μa
=
·
d
d−1

j=0
wj
·
a−1

j

=0
!
!
!

!2
!
φk
!
k∈j+d·j

+d·Z
In
the
case
of
f
=
ζrSS
,
we
would
like
to
divide
up
the
task
of
bounding
the
|φk
|
into
two
cases,
the
case
where
|k|
<
A
·
d,
and
the
case
where
|k|
≥
A
·
d:
Case
(i):
First,
we
consider
the
case
where
|k|
<
A
·
d.
In
this
case,
it
follows
from
Chapter
VII,
Lemma
6.1,
(1),
(plus
the
deﬁnition
of
wk
)
that
wj
·
|φk
|2
≤
A2r
.
Note
that
the
number
of
k
in
a
given
residue
class
modulo
d
=
a
·
d
that
fall
under
the
present
Case
(i)
is
≤
2
·
A
·
a−1
.
Case
(ii):
Next,
we
consider
the
case
where
|k|
≥
A
·
d.
Let
k0
denote
the
unique
integer
∈
KCrit
such
that
k
≡
k0
modulo
d.
Let
σk
be
the
sign
of
k,
i.e.,
1
(respectively,
−1)
if
k
is
>
0
(respectively,
<
0).
def
Write
kδ
=
σk
·
(|k|
−
|k0
|).
Note
that
since
|k0
|
≤
d,
we
obtain
that
|kδ
|
≥
(A
−
1)
·
d
≥
1
(since
A
≥
2).
Thus,
(k2
+
(iχ
/m)
·
k)
−
(k02
+
(iχ
/m)
·
k0
)
=
(|k0
|
+
|kδ
|)2
−
k02
+
(iχ
/m)
·
(kδ
+
k
−
k0
−
kδ
)
=
kδ2
+
(iχ
/m)
·
kδ
+
2
·
|k0
|
·
|kδ
|
+
(iχ
/m)
·
(σk
·
|k0
|
−
k0
)
≥
kδ2
+
(iχ
/m)
·
kδ
+
2
·
|k0
|
·
(|kδ
|
−
1)
≥
kδ2
+
(iχ
/m)
·
kδ
But
note
that,
if
we
raise
these
inequalities
to
the
base
qsc
,
we
obtain
that

|k|
2r
wj
·
|φk
|2
=
wk0
·
|φk
|2
≤
·
|φkδ
|2
|kδ
|

A
2r
≤
·
|φkδ
|2
≤
4r
·
|φkδ
|2
A−1
def
Thus,
by
Chapter
VII,
Lemma
6.1,
if
A−1
≥
Q−1
,
where
Q
=
π4
·Im(τor
)
(and
we
take
“b,”
“
”
in
loc.
cit.
to
be
1;
“a”
in
loc.
cit.
to
be
A
−
1;
“k”
in
loc.
cit.
to
be
kδ
),
then

1
wj2
·
|φk
|
≤
2r+2
·
e−(A−1)·d
≤
2d+2
·
e−(A−1)·d
|k|≥A·d
≤
4
·
e−(A−2)·d
≤
4
284
If
we
then
add
up
the
contributions
from
these
two
cases,
we
obtain
d−1
a−1

!!
1

·
wj
·
!
d
j=0

j
=0

k∈j+d·j

+d·Z
d−1
a−1
!2
1



!
φk
!
≤
·
d
j=0

j
=0
!
!2
1
!
!
wj2
·
!φk
!

k∈j+d·j

+d·Z
d−1
a−1
2
1



≤
·
2
·
A
·
a−1
·
A2r
+
4
d
j=0

j
=0
2

2

−1
2r+1
2r+1
≤a·
6·a
·A
≤
6·A
(where
we
use
that
A
≥
a
in
the
third
inequality).
Thus,
we
have
||ζrSS
||w,μa
≤
6
·
A2r+1
.
Combining
this
with
the
previous
inequalities
concerning
||P
(δχ∗
)·Θχ
||2w,μa
,
we
thus
obtain
||P
(δχ∗
)
·
Θχ
||w,μa
≤
(r
+
1)
2
·
e4r+2
·
6
·
A2r+1
≤
(r
+
1)
2
·
e4r+4
·
A2r+1
9
9
as
desired.

Next,
we
would
like
to
compare
||
∼
||Tch
and
||
∼
||Tch
.
Lemma
2.2.
def
Suppose
that
a
≥
Max(2
+
Q−1
,
8),
where
Q
=
π4
·
Im(τor
).
Then
we
have:
1−(d+1)
2
·e4−d
·||P
(δχ∗
)·Θχ
||Tch
≤
||P
(δχ∗
)·Θχ
||Tch
≤
1+(d+1)
2
·e4−d
·||P
(δχ∗
)·Θχ
||Tch
9
9
for
any
polynomial
with
complex
coeﬃcients
P
(−)
of
degree
≤
r
<
d.
Here,
the
ﬁrst
9
expression
in
large
brackets,
i.e.,
1
−
(d
+
1)
2
·
e4−d
,
is
≥
12
if
d
≥
25.
Proof.
The
argument
is
similar
to
the
argument
given
for
“Case
(ii)”
in
the
proof
of
Lemma
2.1
(except
that
we
take
“A”
to
be
a
−
1).
Indeed,
the
diﬀerence
between
the
two
norms
def
1
||f
||2Tch
=
d
·

j∈KCrit
!
!
wj
·
!

!2
!
φk
!
;
k∈j+d·Z
def
1
and
||f
||2Tch
=
d
·

!
!2
!
!
w
j
·
!
φj
!
j∈KCrit
is
that
the
sum
in
the
deﬁnition
of
||f
||2Tch
involves
the
φk
for
k
∈
(KCrit
+
d
·
Z)\KCrit
,
i.e.,
(by
the
triangle
inequality)
285
(||f
||Tch
−
||f
||Tch
)
2
def
1
≤
||f
||2TchΔ
=
·
d
!
!
wj
·
!

j∈KCrit

!2
!
φk
!
k∈(j+d·Z)\{j}
Just
as
in
the
proof
of
Lemma
2.1,
we
may
assume
without
loss
of
generality
that
||P
(δχ∗
)
·
Θχ
||2Tch
=
1.
This
implies
(just
as
in
the
proof
of
Lemma
2.1)
that
the
coeﬃcients
of
P
(−)
7
have
absolute
value
≤
(r
+
1)
2
·
e4r+2
,
hence
that
7
||P
(δχ∗
)
·
Θχ
||TchΔ
≤
(r
+
1)
2
·
e4r+2
·
r

||ζjSS
||TchΔ
j=0
Thus,
it
suﬃces
to
bound
||ζrSS
||TchΔ
.
But
(as
remarked
at
the
beginning
of
this
proof)
this
was
essentially
already
done
in
“Case
(ii)”
of
the
proof
of
Lemma
2.1.
More
precisely,
/
KCrit
.
We
would
like
to
let
k0
∈
KCrit
,
k
≡
k0
modulo
d;
assume,
moreover,
that
k
∈
SS
consider
the
coeﬃcient
φk
in
the
expansion
of
f
=
ζr
.
Note
that
since
|k0
|
≤
d,
k
∈
KCrit
,
it
follows
that
|k|
≥
d
−
d
=
(a
−
1)d.
Thus,
if
we
substitute
a
−
1
(≥
1
+
Q−1
)
for
“A”
in
the
treatment
of
Case
(ii)
in
the
proof
of
Lemma
2.1,
we
obtain

1
wk20
·
|φk
|
≤
4
·
e−(a−3)·d
|k|≥(a−1)·d
hence
1
||ζrSS
||2TchΔ
=
·
d
≤

!
!
wk0
·
!
k0
∈KCrit
1
·
d


!2
!
φk
!
k∈(k0
+d·Z)\{k0
}
16
·
e−2(a−3)·d
=
16
·
e−2(a−3)·d
k0
∈KCrit
Thus,
we
have
||P
(δχ∗
)
·
Θχ
||TchΔ
≤
(r
+
1)
2
·
e4r+2
·
4
·
e−(a−3)·d
9
≤
(d
+
1)
2
·
e4
·
e−(a−7)·d
≤
(d
+
1)
2
·
e4−d
9
9
9
(where
in
the
last
inequality
we
use
that
a
≥
8).
Moreover,
(d
+
1)
2
·
e4−d
≤
12
if
d
≥
25.
This
completes
the
proof.

We
are
now
ready
to
state
the
main
result
of
this
§:
Theorem
2.3.
Let
Hχd
be
the
vector
space
of
functions
on
S1
of
the
form
P
(δχ∗
)
·
Θχ
,
where
P
(−)
is
a
polynomial
of
degree
<
d
with
complex
coeﬃcients,
and
Θχ
and
δχ∗
are
as
286
deﬁned
in
Chapter
VII,
§6.
For
r
∈
Z,
let
F
r
(Hχd
)
⊆
Hχd
be
the
subspace
of
such
functions
for
which
the
degree
of
P
(−)
is
≤
r
(cf.
the
notation
of
Chapter
VII,
§1).
Let
a
≥
8
be
an
integer.
Let
||
∼
||w,μa
be
the
L2
-norm
on
Hχd
given
by
averaging
the
L2
-norms
on
α
·
μd
⊆
(S1
)sc
with
weights
w0
,
.
.
.
,
wd−1
(as
deﬁned
at
the
beginning
of
this
§)
as
α
varies
in
μa·d
/μd
(see
the
above
discussion
for
more
details).
Let
||
∼
||Tch
be
the
L2
-norm
on
Hχd
given
by:
d−1
!2
1

!!
!
∗
2
||P
(δχ
)
·
Θχ
||Tch
=
·
!P
(j
−
λd
)!
d
j=0
where
ld
is
d1
times
the
constant
“λd
”
of
Chapter
V,
Theorem
4.8.
Then
as
r
varies
over
0,
.
.
.
,
d
−
1,
the
functions
def
ζrTCH
=
tr
(

2
1
1
δχ∗
k
2mk+iχ
d
(
2
·k
+(iχ
/n)·k)
tr
(
+ld
)·qor
·Ucv
·χ(ket
)
+ld
)·(Θχ
)
=
d
d
∈
F
r
(Hχd
)
k∈Z
(where
tr
(−)
is
the
“normalized
discrete
Tchebycheﬀ
polynomial”
of
Chapter
VII,
Proposition
3.2)
form
an
orthonormal
basis
of
Hχd
with
respect
to
the
inner
product
associated
to
def
norm
||
∼
||Tch
.
Moreover,
if
a
≥
Max(2
+
Q−1
,
8)
(where
Q
=
π4
·
Im(τor
)
–
cf.
Chapter
VII,
Lemma
6.1),
and
d
≥
25,
then
we
have
9
1
·
||P
(δχ∗
)
·
Θχ
||Tch
≤
||P
(δχ∗
)
·
Θχ
||w,μa
≤
(r
+
1)
2
·
e4r+4
·
a2r+1
·
||P
(δχ∗
)
·
Θχ
||Tch
2
w,μa
w,μ
,
.
.
.
,
ζd−1
a
form
an
orthonormal
basis
of
Hχd
with
respect
to
the
r
w,μ
TCH
,
then
inner
product
associated
to
||
∼
||w,μa
,
and
we
write
ζr
a
=
j=0
γr,j
·
ζj
r
2
j=0
|γr,j
|
≤
4,
and
In
particular,
if
ζ0
9
(r
+
1)
2
·
e4r+4
·
a2r+1
−1
≤
|γr,r
|
≤
2
Finally,
if
Im(τor
)
varies
in
a
compact
subset
of
the
upper
half-plane,
then
on
that
compact
subset,
the
wj
are
bounded
above
and
below,
i.e.,
there
exist
constants
C1
,
C2
∈
R>0
(depending
only
on
the
compact
set)
such
that
C1d
·
||
∼
||1,μa
≤
||
∼
||w,μa
≤
C2d
·
||
∼
||1,μa
where
||
∼
||1,μa
is
the
norm
deﬁned
in
the
same
way
as
||
∼
||w,μa
except
with
all
the
“weights”
(i.e.,
“wj
”)
equal
to
1.
287
Proof.
Most
of
the
assertions
of
Theorem
2.3
have
already
been
proven.
Thus,
it
remains
only
to
check
the
following:
The
inequalities
relating
||
∼
||w,μa
and
||
∼
||Tch
follow
from
2.1,
2.2
(where
in
Lemma
2.1,
we
take
“A”
to
be
a).
The
resulting
bound
r
Lemmas
2
|γ
|
≤
4
follows
immediately.
This
implies
|γr,r
|
≤
2.
The
lower
bound
for
r,j
j=0
|γr,r
|
results
from
the
elementary
geometry
of
Hilbert
spaces,
together
with
the
inequality
bounding
||
∼
||w,μa
in
terms
of
||
∼
||Tch
.

Remark.
Thus,
stated
in
words,
Theorem
2.3
asserts
the
following:
Up
to
a
factor
of
order
C
r
on
the
degree
≤
r
portion
of
Hχd
=
{P
(δχ∗
)
·
Θχ
|
deg(P
(−))
<
d}
the
L2
-norm
on
Hχd
given
by
averaging
the
L2
-norms
on
the
α
·
μd
(as
α
varies
over
μa·d
/μa
,
and
a
≥
8,
d
≥
25
are
suﬃciently
large)
with
weights
w0
,
.
.
.
,
wd−1
induces
orthonormal
polynomials
which
are
essentially
the
discrete
Tchebycheﬀ
polynomials.
Thus,
as
d
→
∞,
the
orthonormal
polynomials
for
this
averaged
L2
-norm
are
essentially
the
Legendre
polynomials
(cf.
Chapter
VII,
Propositions
2.1,
3.1).
Moreover,
if
the
elliptic
curve
in
question
varies
on
a
compact
set,
then,
up
to
a
factor
of
order
C
d
,
we
may
even
assume
that
the
weights
(i.e.,
the
“wj
”)
are
all
equal
to
1.
Stated
in
this
way,
we
feel
that
this
theorem
justiﬁes
the
terminology
“Legendre
model”
used
in
the
title
of
this
§.
Also,
note
that,
as
expected,
the
Legendre
limit
involves
a
scaling
factor
of
d,
i.e.,
this
limit
is
a
slope
1
limit
–
cf.
the
discussions
at
the
end
of
Chapter
VII,
§3,
6.
Finally,
we
remark
that
that
if,
on
the
other
hand,
one
ﬁxes
d
and
lets
a
→
∞,
then
one
veriﬁes
easily
that
the
norm
with
weights
equal
to
1,
i.e.,
1
||f
||21,μa
=
·
d
d−1
a−1


!!
!
j=0
j

=0

!2
!
φk
!
k∈j+d·j

+d·Z
converges
(up
to
a
constant
factor)
to
the
usual
L2
-norm
on
L2
(S1
).
Thus,
in
this
limit,
the
resulting
orthonormal
functions
converge
(up
to
a
constant
factor)
to
the
orthogonal
1
canonical
Schottky-Weierstrass
zeta
functions
ζrOR,S
of
Chapter
VII,
Deﬁnition
6.3.
288
§3.
The
Truncated
Binomial
Model
In
this
§,
we
discuss
the
analogue
of
the
“truncated”
(i.e.,
by
comparison
to
||
∼
||Tch
,
||
∼
||w,μa
)
norm
||
∼
||Tch
of
§2
for
what
we
call
the
binomial
model.
In
the
case
of
the
Legendre
model
that
we
studied
in
§2,
the
truncated
version
was
essentially
isomorphic
to
the
system
of
discrete
Tchebycheﬀ
polynomials
(cf.
Chapter
VII,
§3),
which
is
already
well-known.
In
the
present
binomial
case,
however,
the
truncated
version
is
not
so
wellknown,
so
we
give
an
independent
treatment
in
the
present
§.
This
will
prepare
us
for
the
following
two
§’s,
in
which
we
study
the
function
space
of
derivatives
of
the
theta
function
by
regarding
it
as
a
deformation
of
the
truncated
binomial
model
(cf.
what
we
did
in
§2
–
i.e.,
we
studied
this
same
function
space
by
regarding
it
as
a
deformation
of
the
discrete
Tchebycheﬀ
polynomials).
We
maintain
the
notation
of
§2.
In
this
§,
we
would
like
to
consider
a
ﬁltration
on
the
set
KCrit
,
deﬁned
as
follows.
Recall
the
function
“Lr
(T
)
=
T
+
λr
−
iχ
/n”
of
Chapter
V,
Theorem
4.8.
Then
we
deﬁne
(for
r
=
0,
1,
.
.
.
,
d)
def
F
r
(KCrit
)
=
{0
−
λr
,
1
−
λr
,
.
.
.
,
r
−
1
−
λr
}
Thus,
F
r
(KCrit
)
has
r
elements;
F
0
(KCrit
)
=
∅;
F
d
(KCrit
)
=
KCrit
.
Moreover,
one
checks
easily
from
the
deﬁnitions
that
(for
r
=
1,
.
.
.
,
d)
F
r−1
(KCrit
)
⊆
F
r
(KCrit
).
Thus,
for
r
=
0,
.
.
.
,
d
−
1
F
r+1
(KCrit
)\F
r
(KCrit
)
consists
of
precisely
one
element,
which
we
denote
by
k[r].
Moreover,
the
ﬁltration
F
r
(KCrit
)
induces
a
total
ordering
“≤Crit
”
on
the
set
KCrit
deﬁned
by
k
≤Crit
k
(for
k,
k
∈
KCrit
)
if
k
∈
F
r
(KCrit
)
=⇒
k
∈
F
r
(KCrit
)
(for
all
r
=
1,
.
.
.
,
d).
Put
another
way,
k[r1
]
≤Crit
k[r2
]
⇐⇒
r1
≤
r2
When
the
chosen
character
belongs
to
Case
I
(respectively,
Case
II;
Case
III),
and
r
is
even
(respectively,
odd;
either
even
or
odd)
F
r
(KCrit
)
is
the
set
of
exponents
of
“U
”
(cf.
Chapter
V,
Schola
4.1)
of
the
ﬁrst
r
special
monomials
considered
in
Chapter
V,
Schola
4.1,
where
“ﬁrst”
is
relative
to
the
ordering
induced
by
the
exponent
of
q.
Stated
in
a
word,
the
purpose
of
the
present
and
the
next
two
§’s,
is
to
study
the
congruence
canonical
SW
zeta
functions
(cf.
Chapter
V,
Theorem
4.8)
def
ζrCG
=



k
+
λr

1
·k2
+(iχ
/n)·k
Lr
(δ
∗
)
CG
2mk+iχ
2
·
Ucv
·
χ(ket
)
·
qsc
(ζ0
)
=
r
r
k∈Z
289
at
the
inﬁnite
prime
(where,
for
simplicity,
we
omit
mention
of
the
“trivialization”
θ
m
).
In
the
present
§,
we
would
like
to
consider
the
following
truncated
versions
of
the
ζrCG
:
def
−
1
·k[r]2
−(iχ
/n)·k[r]
ZrCG
=
qsc
2
·


k∈KCrit
k
+
λr
r

1
·k2
+(iχ
/n)·k
2
·
qsc
k
·
Usc
·
χ(ket
)
i
n
=
Usc
(note
that
we
also
divide
by
the
unnecessary
factor
of
Ucvχ
).
Note
that
where
Ucv
the
only
nonzero
terms
of
this
sum
over
KCrit
are
those
for
which
k
∈
/
F
r
(KCrit
).
Thus,
the
exponents
of
qsc
are
all
nonnegative.
In
the
following
discussion,
we
shall
write
def
1
Ψ(k)
=
2
·
k2
+
iχ
k
n
for
the
function
of
k
appearing
in
the
exponent
of
qsc
.
In
this
§,
we
would
like
to
think
of
the
space
of
linear
combinations
of
the
ZrCG
as
equipped
with
the
usual
L2
-norm
||
∼
||
k
(k
∈
Z)
form
an
orthonormal
system
–
cf.
§1).
on
(S1
)sc
(i.e.,
the
norm
for
which
the
Usc
The
purpose
of
the
present
§
is
to
consider
the
following
problem:
Let
def
Z
=
d−1

γr
·
ZrCG
r=0
be
a
C-linear
combination
(i.e.,
the
γr
∈
C)
of
the
ZrCG
.
def
Suppose
that
||Z||
=
1.
Then
to
what
extent
can
one
bound
the
gr
=
|γr
|?
k
(k
∈
Z)
form
an
orthonormal
system,
it
follows
that
the
coefSince
||Z||
=
1,
and
the
Usc
k
ﬁcients
of
the
Usc
(in
the
“Fourier
expansion”
of
Z)
are
≤
1.
In
particular,
the
coeﬃcient
k[r]
of
Usc
is
≤
1,
hence:


r
!
!

k[r]
+
λj
!
!
Ψ(k[r])−Ψ(k[j])
γj
·
·
χ(k[r]et
)
!
≤
1
·
qsc
!
j
j=0
Thus,
if
we
write
def
C[r,
j]
=

k[r]
+
λj
j

then
we
obtain
290
·
|qsc
|Ψ(k[r])−Ψ(k[j])
gr
≤
1
+
r−1

C[r,
r1
]
·
gr1
r1
=0
(so
in
particular,
g0
≤
1).
If
we
then
substitute
into
this
last
inequality
the
analogous
inequality
for
gr1
,
we
obtain

gr
≤
1
+
C[r,
r1
]
+
r>r1
≥0

C[r,
r1
]
·
C[r1
,
r2
]
·
gr2
r>r1
>r2
≥0
Continuing
in
this
fashion,
we
obtain
gr
≤
1
+
r


C[r,
r1
]
·
C[r1
,
r2
]
·
.
.
.
·
C[rj−1
,
rj
]
j=1
r>r1
>r2
>...>rj
≥0
(where
we
use
that
g0
≤
1,
and
that
if
r
>
r1
>
.
.
.
>
rj
≥
0,
then
j
≤
r).
Next,
we
would
like
to
analyze
this
double
summation
in
more
detail.
First,
we
would
like
to
estimate
the
number
of
terms
appearing
in
this
summation.
By
using
the
transformation
(r1
,
r2
,
.
.
.
,
rj
)
→
(r
−
r1
,
r1
−
r2
,
r2
−
r3
,
.
.
.
,
rj−1
−
rj
),
one
veriﬁes
easily
that
the
number
of
terms
in
this
double
summation
is
≤
the
coeﬃcient
of
tr
in
the
power
series
(1
−
t)−r
(where
t
is
an
indeterminate).
By
taking
the
r-th
derivative
of
(1
−
t)−r
(and
dividing
by

2r−1
r!),
we
obtain
that
this
coeﬃcient
is
equal
to
≤
22r−1
≤
4r
−
1.
Thus,
we
obtain
r
that
The
number
of
terms
in
the
double
summation
above
is
≤
4r
−
1.
Next,
we
would
like
to
bound
the
C[r,
r
]’s
(where
r
<
r).
This
consists
of
two
parts,
i.e.,
bounding
the
binomial
coeﬃcient
portion
of
C[r,
r
],
and
bounding
the
power
of
|qsc
|
appearing
in
C[r,
r
].
Let
us
begin
with
the
binomial
coeﬃcient
portion,
i.e.,

k[r]
+
λr
r

of
C[r,
r
],
where
0
≤
r
<
r
≤
d
−
1.
First,
let
us
observe
that
k[r
−
1]
+
λr
is
either
0
or
r
−
1.
Now
one
may
check
easily
from
the
deﬁnitions
that
the
interval
of
integers
F
r+1
(KCrit
)
is
obtained
from
interval
of
integers
F
r
(KCrit
)
by
adjoining
one
more
integer
to
F
r
(KCrit
),
where
this
last
integer
lies
either
immediately
to
the
left
or
immediately
to
the
right
of
F
r
(KCrit
).
Moreover,
whether
this
last
integers
lies
to
the
left
or
to
the
right
depends
only
on
the
parity
of
r,
i.e.,
as
r
increases,
“left”
and
“right”
occur
alternately,
one
after
the
other.
Thus,
it
follows
that
k[r]
+
λr
is
either
∈
{−
21
(r
−
r
+
2),
.
.
.
,
−1}


r
|
is
≤
a
product
of
or
∈
{r
,
.
.
.
,
r
−
1
+
12
(r
−
r
+
2)}.
But
this
implies
that
|
k[r]+λ

r
291
1
2
(r
−
r
+
2)
≤
2(r
−
r
)
positive
integers,
each
of
which
is
≤
r
1
2
(r
+
r
)
≤
r.
Thus,
we
obtain
that:
−
1
+
12
(r
−
r
+
2)
=

The
binomial
coeﬃcient
portion
of
C[r,
r
]
is
≤
r
2(r−r
)
.
In
particular,
the
binomial
coeﬃcient
portion
of
the
term
C[r,
r1
]
·
C[r1
,
r2
]
·
.
.
.
·
C[rj−1
,
rj
]
in
the
double
summation
above
is
≤
r
2{(r−r1
)+(r1
−r2
)+...+(rj−1
−rj
)}
≤
r
2(r−rj
)
.
Next,
we
would
like
to
bound
the
power
of
|qsc
|,
i.e.,

|qsc
|Ψ(k[r])−Ψ(k[r
])
appearing
in
C[r,
r
]
(where
0
≤
r
<
r
≤
d
−
1).
Since
|qsc
|
<
1,
this
means
that
we
would
like
to
bound
Ψ(k[r])−Ψ(k[r
])
from
below.
Note
that
we
always
have
Ψ(k[r])−Ψ(k[r
])
≥
0.
In
the
following,
we
would
like
to
obtain
a
stronger
bound
from
below
under
the
assumption
that
r
≥
r
+
6.
Lemma
3.1.
1
(r
+
r
)(r
−
r
).
Suppose
that
r
+
6
≤
r.
Then
Ψ(k[r])
−
Ψ(k[r
])
≥
16
Proof.
The
proof
consists
of
a
case
by
case
analysis,
depending
on
which
of
the
three
Cases
I,
II,
III
of
Chapter
V,
Schola
4.1,
the
character
χ
belong
to.
We
begin
with
Case
I.
In
this
Case,
r
may
be
written
as
2k
or
2k
+
1
(where
k
≥
0
is
an
integer).
Then
Ψ(k[r])
=
12
(k2
+
k)
(cf.
Chapter
V,
Schola
4.1).
Let
us
write
k
for
the
“k”
associated
to
r
.
Then
Ψ(k[r])
−
Ψ(k[r
])
=
r−r
≥
k−k
2(r
−
r
)
r−r
8(r
−
r
)
·
(k
+
k
+
1)
≥
·
r
+
r

2
=
r−1−r
4(r
−
r
)
·
r
+
r

2
1
(r
+
r
)
16
as
desired.
Next,
we
consider
Case
II.
In
this
Case,
r
may
be
written
as
2k
or
2k
−
1
(where
k
≥
0
is
an
integer).
Then
Ψ(k[r])
=
12
·
k
2
(cf.
Chapter
V,
Schola
4.1).
Let
us
write
k
for
the
“k”
associated
to
r
.
Then
292
Ψ(k[r])
−
Ψ(k[r
])
=
r−r
≥
k−k
2(r
−
r
)
r−r
8(r
−
r
)
r
+
r

r−1−r
·
4(r
−
r
)
2
r
+
r

1
·
=
(r
+
r
)
2
16
·
(k
+
k
)
≥
as
desired.
Finally,
we
consider
Case
III.
In
this
Case,
r
may
be
written
as
2k
or
2k
−
1
(where
k
≥
0
is
an
integer).
Then
Ψ(k[r])
is
≥
12
(k2
−
k),
≤
12
(k2
+
k)
(cf.
Chapter
V,
Schola
4.1).
Let
us
write
k
for
the
“k”
associated
to
r
.
Note
that
since
r
≥
r
+
6,
we
have
r
−
r
−
3
≥
12
·
(r
−
r
),
k
≥
k
+
2.
Thus,
Ψ(k[r])
−
Ψ(k[r
])
≥
r−r
≥

k
2
−
k
−
(k
)2
−
k

k−k
−1
·
≥
2(r
−
r
)
k−k
−1
r
+
r

r−r
1
·
=
(r
+
r
)
8(r
−
r
)
2
16
r−r
−3
4(r
−
r
)
·
(k
+
k
)
as
desired.

Thus,
in
particular,
it
follows
that
The
power
of
|qsc
|
appearing
in
the
term
C[r,
r1
]·C[r1
,
r2
]·.
.
.·C[rj−1
,
rj
]
in
the
double
summation
above
is
={Ψ(k[r])
−
Ψ(k[r1
])}
+
{Ψ(k[r1
])
−
Ψ(k[r2
])}+
.
.
.
+
{Ψ(k[rj−1
])
−
Ψ(k[rj
])}
=Ψ(k[r])
−
Ψ(k[rj
])
1
which
is
≥
0
always
and
≥
16
(r
+
rj
)(r
−
rj
)
if
r
≥
rj
+
6.
Lemma
3.2.
We
have
r
·
log(r)
−
2r
·

log2
(d)

d
≤
12
·
d
for
any
integer
r
satisfying
0
≤
r
≤
d.
Proof.
Lemma
3.2
is
clear
if
r
=
0,
1,
2
(note
that
if
r
=
1,
2,
then
the
expression
in
brackets
{,
}
is
≤
1),
or
if
r
=
d.
Thus,
we
may
assume
that
r
≥
3
(so,
in
particular,
d
≥
3).
Write
293
def
f
(r)
=
r
·
log(r)
−
2r
·

log2
(d)

d
Since
we
have
checked
that
f
(r)
≤
12
·
d
for
r
=
2,
d,
it
suﬃces
(by
elementary
calculus)
to
show
that
f
(ρ)
≤
12
·
d
for
any
real
number
ρ
∈
[2,
d]
such
that
f
(ρ)
=
0.
For
such
a
ρ,
we
have
3
·
log(ρ)
≥
log(ρ)
+
1
=
4ρ
·

log2
(d)

d
(where
we
use
that
ρ
≥
2
implies
2
·
log(ρ)
≥
log(4)
≥
1)
hence
f
(ρ)
=
ρ
·
log(ρ)
−
1
1
·
(log(ρ)
+
1)
≤
·
ρ
·
log(ρ)
2
2
ρ
3d
Next,
let
us
apply
the
function
log2
(−)
to
both
sides
of
the
inequality
4·log
2
(d)
≥
log(ρ)
(≥
1).
Since
both
sides
of
this
equality
are
≥
1,
it
thus
follows
that
we
obtain
an
inequality
log2
(d)
≥
log2
3d
4
·
log2
(d)
≥
log2

1
ρ

≥
·
log2
(ρ)
log(ρ)
16
1
ρ
≥
ρ
4
(since
ρ
≥
2)).
If
we
then
(where
we
use
that
log(d)
≥
1
(since
d
≥
3),
and
log(ρ)
ρ
1
3d
·
log2
(ρ)
by
4·log
multiply
the
inequality
log2
(d)
≥
16
2
(d)
≥
log(ρ)
,
we
thus
obtain
1
3
3d
ρ
1
·
d
≥
log2
(d)
·
·
log2
(ρ)
·
=
·
ρ
·
log(ρ)
≥
2
4
16
log(ρ)
16
4
·
log
(d)
i.e.,
f
(ρ)
≤
ρ
·
log(ρ)
≤
12
·
d,
as
desired.

Now
let
us
return
to
the
inequality
gr
≤
1
+
r


C[r,
r1
]
·
C[r1
,
r2
]
·
.
.
.
·
C[rj−1
,
rj
]
j=1
r>r1
>r2
>...>rj
≥0
Suppose
that
qsc
satisﬁes:
1
64
·
log2
(d)
−log|qsc
|
=
2π
·
·
Im(τor
)
≥
d
d
Then
by
what
we
have
done
above
(cf.
especially
Lemmas
3.1,
3.2),
each
term
in
the
double
summation
satisﬁes:
294
1
·
(r
+
rj
)(r
−
rj
)
·
log|qsc
|
16
1
·
r
·
log|qsc
|)
≤
2(r
−
rj
)
·
(log(r)
+
32
≤
2(r
−
rj
)
·
(log(r)
−
2
·
r
·
d−1
·
log2
(d))
d
≤
2(r
−
rj
)
·
12
·
≤
24
·
d
r
log(C[r,
r1
]
·
C[r1
,
r2
]
·
.
.
.
·
C[rj−1
,
rj
])
≤
2(r
−
rj
)
·
log(r)
+
when
r
≥
rj
+
6
and
log(C[r,
r1
]
·
C[r1
,
r2
]
·
.
.
.
·
C[rj−1
,
rj
])
≤
2(r
−
rj
)
·
log(r)
≤
12
·
log(r)
≤
12
·
log(d)
otherwise.
Thus,
since
(as
we
saw
above)
there
are
4r
−
1
such
terms
in
the
above
double
summation,
(if
we
add
in
the
additional
“1+”
at
the
beginning,
so
that
we
get
a
total
of
4r
terms,
then)
it
follows
that
gr
≤
4r
·
e24·d
≤
e26·d
Now
we
are
ready
to
state
the
main
result
of
the
present
§:
Theorem
3.3.
Suppose
that
Im(τor
)
≥
def
d−1
r=0
and
let
Z
=
Then
32
·
log2
(d)
π
γr
·
ZrCG
be
a
C-linear
combination
(i.e.,
the
γr
∈
C)
of
the
ZrCG
.
(1)
If
the
|γr
|
≤
1
for
r
=
0,
.
.
.
,
d
−
1,
then
the
L2
((S1
)sc
)-norm
of
Z
satisﬁes:
||Z||
≤
d2
·
ed
≤
e3d
.
(2)
If
||Z||
≤
1,
then
the
|γr
|
≤
e26·d
,
for
r
=
0,
.
.
.
,
d
−
1.
In
particular,
if
we
orthonormalize
the
ZrCG
to
form
OC
Z0OC
,
.
.
.
,
Zd−1
295
–
which
are
unique
if
we
stipulate
that
the
leading
coeﬃcient
of
ZrOC
(i.e.,
the
coeﬃcient
of
ZrCG
in
the
linear
combination
of
Z0CG
,
.
.
.
,
ZrCG
that
forms
ZrOC
)
be
positive
–
then
the
have
absolute
value
≤
e26d
,
and
the
absolute
values
of
coeﬃcients
of
the
ZrCG
in
each
ZrOC

−2
−d
the
leading
coeﬃcients
are
≥
d
·
e
≥
e−3d
.
Proof.
The
assertion
concerning
the
ZrOC
at
the
end
of
Theorem
3.3
follows
formally
from
Assertions
(1)
and
(2)
(cf.
the
proof
of
Theorem
2.3).
Assertion
(2)
is
precisely
what
we
have
just
proven
in
the
above
discussion.
Thus,
it
remains
to
verify
Assertion
(1).
As
we
k[r]
saw
above,
the
absolute
value
of
the
coeﬃcient
of
Usc
(for
k[r]
∈
KCrit
)
in
Z
is


!
r
r
!

!

!

k[r]
+
λj
!
!
k[r]
+
λj
!
!
Ψ(k[r])−Ψ(k[j])
γj
·
·
χ(k[r]et
)
!
≤
·
qsc
!
!
!
j
j
j=0
j=0


r
j
|
≤
d
·
ed
,
Thus,
since
the
cardinality
of
KCrit
is
d,
it
suﬃces
to
show
that
j=0
|
k[r]+λ
j
for
all
k[r]
∈
KCrit
.
Moreover,
this
last
inequality
will
follow
as
soon
as
we
show
that
!
k[r]
+
λ

!
!
!
j
!
≤
2
d
≤
ed
!
j
But
this
follows
from
the
analysis
of
the
“binomial
coeﬃcient
portion
of
C[r,
r
]”
in
the
discussion
above:
Indeed,
this
analysis
shows
that
there
exists
an
integer
N
satisfying
j
≤
N
≤
j
−
1
+
12
(r
−
j
+
2)
≤
r
such
that
!
k[r]
+
λ

!
N

!
!
j
≤
2
N
≤
2
r
≤
er
≤
ed
!
!=
j
j
as
desired.

Remark.
Thus,
stated
in
words,
Theorem
3.3
asserts
that:
2
d
If
Im(τor
)
≥
32
π
·
log
(d),
then
up
to
a
factor
of
order
C
(for
some
constant
C),
the
L2
((S1
)sc
)-norm
on
the
complex
vector
space
generCG
ated
by
Z0CG
,
.
.
.
,
Zd−1
,
is
the
same
as
the
norm
for
which
the
functions
CG
CG
Z0
,
.
.
.
,
Zd−1
are
orthonormal.
Note
that
unlike
the
case
with
Theorem
2.3,
in
the
present
situation,
one
does
not
have
the
stronger
result
that
the
discrepancy
is
of
order
C
r
on
the
subspace
generated
by
Z0CG
,
.
.
.
,
ZrCG
.
Indeed,
typically
results
such
as
Theorem
3.3,
(2),
(i.e.,
where
one
must
show
that
the
coeﬃcients
are
bounded
whenever
the
L2
((S1
)sc
)-norm
is
bounded)
are
much
more
diﬃcult
than
results
such
as
Theorem
3.3,
(1)
(i.e.,
where
one
must
show
that
if
the
296
coeﬃcients
are
bounded,
then
the
L2
((S1
)sc
)-norm
is
bounded).
But
it
is
not
diﬃcult
to
check
that
even
in
this
easier
direction
(i.e.,
the
direction
of
Theorem
3.3,
(1))
the
binomial
coeﬃcients
that
one
must
bound
do
not
satisfy
≤
C
r
type
inequalities.
§4.
The
Combinatorics
of
the
Full
Binomial
Model
In
this
and
the
following
§’s,
we
discuss
what
we
call
the
(full)
binomial
model.
This
“full”
binomial
model
is
a
deformation
of
the
truncated
binomial
model
studied
in
§3
(cf.
especially
Theorem
3.3)
in
essentially
the
same
way
as
the
“Legendre
model”
studied
in
§2
(cf.
especially
Theorem
2.3)
is
a
deformation
of
(what
are
essentially)
the
discrete
Tchebycheﬀ
polynomials.
One
diﬀerence,
however,
between
what
we
do
in
the
present
and
following
§’s
and
what
was
done
in
§3
is
that
here,
we
do
not
use
the
averaging
process
of
§1.
As
a
result,
there
are
two
types
of
deformation
term
that
occur.
The
ﬁrst
type
results
from
the
fact
that
we
do
not
use
the
averaging
process
of
§1.
This
type
will
be
dealt
with
in
the
discussion
of
the
semi-truncated
binomial
model
below,
and
is
the
more
diﬃcult
to
handle
(of
the
two
types).
The
second
type
is
exactly
the
same
as
the
deformation
terms
that
occurred
in
“Case
(ii)”
of
the
proof
of
Lemma
2.1,
and
may
be
handled
in
exactly
the
same
way
as
in
the
proof
of
Lemma
2.1.
Unfortunately,
since
our
estimates
of
the
ﬁrst
type
of
deformation
term
are
very
involved,
we
treat
the
combinatorial
aspects
of
these
estimates
in
the
present
§.
In
the
following
§,
we
apply
the
results
of
the
present
§
to
study
the
orthogonal
system
which
constitutes
the
“full
binomial
model.”
We
maintain
the
notation
of
§3.
Also,
for
simplicity,
we
assume
in
the
following
discussion
that
d
≥
12
Let
us
write
KSemi
=
{k
∈
Z
|
∃
k0
∈
KCrit
s.t.
|k
−
k0
|
=
d,
|k0
+
(iχ
/n)|
≥
def
Thus,
KSemi

d
,
k
·
k0
<
0}
4
/
KSemi
.
In
general,
for
k
∈
Z,
let
us
write
KCrit
=
∅,
0
∈
Crit(k)
for
the
(unique)
k0
∈
KCrit
such
that
k
≡
k0
modulo
d.
Also,
let
us
write
def
{k[d]}
=
{0
−
λd+1
,
1
−
λd+1
,
.
.
.
,
d
−
λd+1
}\KCrit
;
297
def
F
d+1
(KCrit
)
=
{k[d]}

KCrit
In
the
following
discussion,
if
F
is
a
ﬁnite
subset
of
R,
and
λ
∈
R,
then
we
shall
write
def
Dist(λ,
F
)
=
Minf
∈F
{|λ
−
f
|}
for
the
“distance”
between
λ
and
F
.
Finally,
we
shall
write
def
Ψ(λ)
=
Ψ(λ)
+
1
1
·
(iχ
/n)2
=
·
(λ
+
(iχ
/n))2
2
2
for
λ
∈
R.
Note
that
if
r1
≤
r2
(where
r1
,
r2
are
nonnegative
integers
≤
d),
then
Ψ(k[r1
])
≤
Ψ(k[r2
]),
Ψ(k[r1
])
≤
Ψ(k[r2
]).
We
would
like
to
begin
by
introducing
the
“semi-truncated
version”
of
the
ζrCG
,
i.e.,
a
function
which
is
a
sort
of
intermediate
step
between
ζrCG
and
ZrCG
:
def
−Ψ(k[r])
ZCG
=
qsc
·
r


k∈KCrit
−Ψ(k[r])
=
ZrCG
+
qsc
·
KSemi

k∈KSemi
k
+
λr
r

Ψ(k)
Crit(k)
·
qsc
·
Usc
·
χ(ket
)


k
+
λr
Ψ(k)
Crit(k)
·
Usc
·
χ(ket
)
·
qsc
r
The
key
to
understanding
ZCG
is
the
following
analysis
of
the
combinatorics
of
the
sets
r
KCrit
,
KSemi
:
Lemma
4.1.
If
A,
B
∈
R,
let
us
write
[A,
B]Int
for
the
set
of
integers
in
the
closed
interval
[A,
B]
⊆
R.
Let
r
∈
[2,
d]Int
.
Then

−

r
r
(r
−
2)
(r
−
2)

,
⊆
F
r
(KCrit
)
=
[−λr
,
r
−
1
−
λr
]Int
⊆
−
,
2
2
2
2
Int
Int
In
particular,
for
any
k0
∈
F
r
(KCrit
),
we
have
|k0
|
≤
r2
,
and
2r
≥
|k[r
−
1]|
≥
r−2
2
.
Finally,
the
average
(or
“center
of
mass”)
Avg(F
r
(KCrit
))
of
the
elements
of
F
r
(KCrit
)
is
1
1
2
(r
−
1)
−
λr
∈
{0,
±
2
}.
Proof.
Indeed,
the
number
λr
of
Chapter
V,
Theorem
4.8,
satisﬁes
r2
≥
λr
≥
r−2
2
≥
0
r
r
r
r
(since
r
≥
2).
Thus,
F
(KCrit
)
=
[−λr
,
r
−
1
−
λr
]Int
⊆
[−
2
,
2
];
F
(KCrit
)
=
[−λr
,
r
−
1
−
r−2
λr
]Int
⊇
[−
r−2
2
,
2
].
Since
k[r
−
1]
∈
{−λr
,
r
−
1
−
λr
},
it
thus
follows
that
|k[r
−
1]|
≥
r−2
r−2
Min(λr
,
r
−
1
−
λr
)
≥
Min(
r−2
2
,
2
)
=
2
.
Finally,
the
statement
concerning
the
average
follows
immediately.

298
Lemma
4.2.
Suppose
that
k
∈
Z\(KCrit
KSemi
).
Then
|k
+
(iχ
/n)|
≥
34
d;
|k|
≥
12
d.
1
·
d
·
|k|.
Moreover,
we
have
Ψ(k)
−
Ψ(k[d
−
1])
≥
16
def
Proof.
Write
k0
=
Crit(k).
Since
k
∈
/
KSemi
,
∈
/
KCrit
,
it
follows
from
the
deﬁnitions
that
at
least
one
of
the
following
holds:
|k
−
k0
|
≥
2d,
or
|k0
+
(iχ
/n)|
<
d4
,
or
k
·
k0
≥
0.
Suppose
that
|k
−
k0
|
≥
2d.
By
Lemma
4.1
above,
we
have
|k0
|
≤
d2
.
Thus,
it
follows
that
|k
+
(iχ
/n)|
≥
2d
−
|k0
|
−
12
≥
2d
−
12
d
−
12
=
32
d
−
12
≥
34
d
(since
d
≥
1),
as
desired.
Next,
let
us
assume
that
|k0
+
(iχ
/n)|
<
d4
.
Write
k
=
k0
+
A
·
d,
where
A
∈
Z,
A
=
0.
Then
|k
+
(iχ
/n)|
≥
|A|
·
d
−
|k0
+
(iχ
/n)|
≥
d
−
14
d
=
34
d,
as
desired.
Finally,
let
us
assume
that
k
·
k0
≥
0.
Write
k
=
k0
+
A
·
d,
where
A
∈
Z,
A
=
0.
Then
since
|k0
|
≤
d2
≤
d
−
1
(by
Lemma
4.1,
d
≥
2),
it
follows
that
|A|
·
d
≥
d
>
|k0
|.
Thus,
k
·
k0
≥
0
implies
that
A
·
k0
·
d
≥
−k02
,
hence
that
A
·
k0
≥
0.
In
particular,
|k
+
(iχ
/n)|
≥
|A
·
d
+
k0
|
−
12
≥
|A|
·
d
−
12
≥
d
−
12
≥
34
d
(since
d
≥
2),
as
desired.
This
completes
the
proof
of
the
assertion
|k
+
(iχ
/n)|
≥
34
d.
This
implies
that
|k|
≥
|k
+
(iχ
/n)|
−
12
≥
34
d
−
12
≥
12
d
(since
d
≥
2).
Now
we
compute
(using
this
assertion,
together
with
the
estimates
of
Lemma
4.1):
2(Ψ(k)
−
Ψ(k[d
−
1]))
=
2(Ψ(k)
−
Ψ(k[d
−
1]))
=
(k
+
(iχ
/n))2
−
(k[d
−
1]
+
(iχ
/n))2
=
{|k
+
(iχ
/n)|
+
|k[d
−
1]
+
(iχ
/n)|}
·
{|k
+
(iχ
/n)|
−
|k[d
−
1]
+
(iχ
/n)|}
3
1
≥
d
·
(|k
+
(iχ
/n)|
−
−
|k[d
−
1]|)
4
2
1
1
3
≥
d
·
(|k
+
(iχ
/n)|
−
(d
+
2)
+
)
4
2
2
5
1
3
1
3
1
≥
d
·
(|k
+
(iχ
/n)|
−
d
+
)
≥
d
·
(
|k
+
(iχ
/n)|
+
)
4
8
2
4
6
2
1
1
1
1
≥
d
·
(|k
+
(iχ
/n)|
+
3)
≥
d
·
(|k|
−
+
3)
≥
·
d
·
|k|
8
8
2
8
(where
we
use
d
≥
8),
as
desired.

Lemma
4.3.
Let
k
∈
KSemi
.
Suppose
that
there
exists
some
k[r]
∈
KCrit
(where
r
∈
[0,
d−1]Int
)
such
that
Ψ(k)
=
Ψ(k[r]).
Then
r
=
d−1,
k
=
k[d],
and
the
character
χ
belongs
(in
the
language
of
Chapter
V,
§4)
to
Cases
I
or
II.
Moreover,
under
these
hypotheses,
Crit(k)
=
k[d
−
1],
and
(for
any
r
<
d
−
1)
we
have
Ψ(k[r
])
<
Ψ(k[r])
=
Ψ(k[d
−
1]).
We
shall
refer
to
such
k
as
exceptional.
Proof.
Indeed,
this
follows
from
the
discussion
of
Chapter
V,
Schola
4.1.
More
precisely,
if
χ
belongs
to
Case
III,
then
Ψ
is
injective
on
Z.
Thus,
χ
must
belong
to
Cases
I
or
II.
299
It
follows
from
the
discussion
of
Chapter
V,
Schola
4.1,
that
the
map
r
→
Ψ(k[r
])
(for
r
=
0,
.
.
.
,
d)
is
monotone
increasing
even
in
Cases
I
or
II,
and
that
the
ﬁbers
of
the
map
/
KCrit
,
it
follows
k
→
Ψ(k
)
(for
k
∈
Z)
contain
at
most
two
elements.
Moreover,
since
k
∈
that
Ψ(k[d])
≤
Ψ(k).
Now
I
claim
that
Ψ(k[d
−
1])
=
Ψ(k[d]).
Indeed,
if
Ψ(k[d
−
1])
<
Ψ(k[d]),
then
it
follows
that
Ψ(k[r])
≤
Ψ(k[d
−
1])
<
Ψ(k[d])
≤
Ψ(k)
(which
contradicts
the
hypothesis
Ψ(k[r])
=
Ψ(k)).
This
proves
the
claim.
Thus,
since
the
ﬁbers
of
the
map
r
→
Ψ(k[r
])
(for
r
=
0,
.
.
.
,
d)
contain
at
most
two
elements,
it
follows
that
for
r
=
0,
.
.
.
,
d
−
2,
we
have
Ψ(k[r
])
<
Ψ(k[d
−
1])
=
Ψ(k[d])
≤
Ψ(k).
Thus,
we
conclude
that
r
=
d
−
1.
If
k[d]
=
k,
then
the
fact
that
the
ﬁbers
of
the
map
k
→
Ψ(k
)
(for
k
∈
Z)
contain
at
most
two
elements
implies
that
Ψ(k[r])
=
Ψ(k[d−1])
=
Ψ(k[d])
<
Ψ(k),
which
is
absurd.
Thus,
we
conclude
that
k[d]
=
k.
Thus,
it
remains
to
prove
that
Crit(k)
=
k[d
−
1].
But
this
follows
from
the
explicit
analysis
of
Chapter
V,
Schola
4.1.
Indeed,
in
Case
I,
since
Ψ(k[d
−
1])
=
Ψ(k[d]),
it
follows
that
d
is
odd,
and
that
|k[d]
−
k[d
−
1]|
=
2
·
{
21
(d
−
1)}
+
1
=
d.
Similarly,
in
Case
II,
since
k[d
−
1]
=
k[d],
it
follows
that
d
is
even,
and
that
|k[d]|
=
|k[d
−
1]|
=
12
d,
so
|k[d]
−
k[d
−
1]|
=
d,
as
desired.
This
completes
the
proof.

def
Lemma
4.4.
Suppose
that
k
is
exceptional
(cf.
Lemma
4.3).
Write
k0
=
Crit(k).
k0
in
ZCG
Then
the
coeﬃcient
of
Usc
d−1
is
a
complex
number
whose
absolute
value
is
≤
2
and
π
≥
2m
=
πn
.
Proof.
Recall
the
original
nontruncated
series
def
ζrCG
=



k
+
λr

Lr
(δ
∗
)
CG
Ψ(k
)
2mk
+iχ
·
Ucv
·
χ((k
)et
)
(ζ0
)
=
·
qsc
r
r

k
∈Z
Now
I
claim
that
as
k
ranges
over
k0
+d·Z,
the
only
k
(other
than
k0
=
k[d−1])
for
which
Ψ(k
)
=
Ψ(k0
)
is
the
current
exceptional
k
under
consideration.
Indeed,
if
k
∈
KCrit
,
this
follows
from
Lemma
4.3.
If
k
∈
KSemi
,
then
by
Lemma
4.3,
k
=
k[d]
=
k.
Finally,
if
/
KCrit
,
∈
/
KSemi
,
then
by
Lemma
4.2,
Ψ(k
)
>
Ψ(k[d
−
1])
=
Ψ(k0
).
This
completes
k
∈
the
proof
of
the
claim.
Next,
recall
from
Lemma
4.3
that
Ψ(k[d
−
1])
>
Ψ(k[r])
for
r
<
d
−
1.
It
thus
follows
−Ψ(k[r])
·
ζrCG
(for
r
=
0,
.
.
.
,
d
−
1)
to
μd
⊆
(S1
)sc
,
and
let
qsc
→
0,
that
if
we
restrict
the
qsc
2mk
+i
then
the
coeﬃcient
of
Ucv
0
χ
will
be
0
for
r
<
d
−
1,
and
it
will
be
equal
(by
the
claim
of
the
preceding
paragraph)
to

k
=k0
,k

k
+
λd−1
d−1
300

·
χ((k
)et
)


d−1

=
±1.
for
r
=
d
−
1.
Note
that
for
k
=
k0
,
k,
we
have
k
+
λd−1
∈
{−1,
d
−
1},
so
k
+λ
d−1
Thus,
the
coeﬃcient
in
question
will
be
a
sum
of
two
n-th
roots
of
unity.
This
shows
that
this
coeﬃcient
has
absolute
value
≤
2.
It
also
shows
that
if
this
coeﬃcient
is
nonzero,
then
π
(where
the
inequality
may
be
proven
it
has
absolute
value
≥
sin(2π/n)
=
sin(π/m)
≥
2m
by
elementary
calculus,
using
the
fact
that
m
≥
2).
Moreover,
it
follows
immediately
from
the
deﬁnitions
that
this
coeﬃcient
is
the
coeﬃcient
referred
to
in
the
statement
of
Lemma
4.4.
Thus,
it
suﬃces
to
show
that
this
coeﬃcient
is
nonzero.
But
since
the
corresponding
−Ψ(k[r])
·
ζrCG
are
0
for
r
<
d
−
1,
to
say
that
the
present
coeﬃcient
in
coeﬃcients
in
qsc
question
is
zero
would
imply
that
the
comparison
isomorphism
(Chapter
VI,
Theorem
4.1
–
in
fact,
we
only
need
it
in
characteristic
zero,
i.e.,
Chapter
VI,
Theorem
3.1)
is
false.
This
contradiction
completes
the
proof
of
Lemma
4.4.

Remark.
The
proof
of
Lemma
4.4
is
interesting
because
it
may
be
turned
around
and
regarded
as
an
explicit
way
to
verify
the
comparison
theorem
(Chapter
VI,
Theorem
4.1)
in
a
neighborhood
of
inﬁnity.
That
is
to
say,
the
fact
that
the
coeﬃcient
in
question
is
nonzero
may
also
be
proven
by
a
direct
computation
(which
is
not
diﬃcult,
and
is
left
as
an
exercise
for
the
reader).
This
direct
computation
may
then
be
regarded
as
an
alternate
proof
of
Chapter
VI,
Theorem
4.1,
in
a
neighborhood
of
inﬁnity.
Put
another
way,
this
portion
of
the
treatment
of
the
archimedean
theory
in
the
present
Chapter
may
be
regarded
as
the
archimedean
analogue
of
the
description
of
the
scheme-theoretic
zero
locus
of
the
determinant
given
in
Chapter
VI,
Theorem
4.1,
(2).
Lemma
4.5.
Let
k
∈
KSemi
.
Then
|k|
≥
12
d.
def
Proof.
Write
k0
=
Crit(k).
Since
|k
−
k0
|
=
d,
we
have
|k|
≥
d
−
|k0
|
≥
d
−
12
d
=
12
d
(by
Lemma
4.1).

Lemma
4.6.
Let
X,
A,
and
B
be
nonnegative
real
numbers
such
that
B
≥
A,
B
>
0.
Then
(X
+
A)
≥
(A/B)
·
(X
+
B).
Proof.
Indeed,
B(X
+
A)
≥
B
·
X
+
A
·
B
≥
A
·
X
+
A
·
B
=
A(X
+
B).

Lemma
4.7.
Let
k
∈
KSemi
.
Write
k0
=
k[r0
]
=
Crit(k).
Let
r
be
an
integer
satisfying
4
≤
r
≤
d
−
1.
Then
Ψ(k)
−
Ψ(k[r])
≥
1
·
d
·
Dist(k,
F
r
(KCrit
))
32n
so
long
as
either
k
is
non-exceptional
(cf.
Lemma
4.3)
or
r
<
d
−
1.
301
def
def
Proof.
Write
σk
=
k/|k|
(note
that
|k|
≥
1
>
0,
by
Lemma
4.5),
k[r]∗
=
−(iχ
/n)
+
σk
·
1
∗
|k[r]
+
(iχ
/n)|.
By
Lemma
4.1,
|k[r]|
≥
r+1
2
−
1
≥
1
+
2
.
It
thus
follows
that
k[r]
has
the
r−3
same
sign
as
k,
and
that
|k[r]∗
|
≥
r+1
2
−1−1=
2
.
Write
R
·
F
r
(KCrit
)
for
the
closed
convex
hull
(in
R)
of
the
points
in
F
r
(KCrit
).
Note
that
k
∈
/
F
r
(KCrit
),
so
k
∈
/
R
·
F
r
(KCrit
);
0
∈
R
·
F
r
(KCrit
)
(by
Lemma
4.1).
Observe
that
k
divides
the
real
line
into
two
open
rays.
Now
I
claim
that
k[r]∗
lies
in
the
same
open
ray
as
R
·
F
r
(KCrit
).
Indeed,
if
this
were
not
the
case,
then
since
0
∈
R
·
F
r
(KCrit
),
it
would
then
follow
that
|k[r]∗
|
≥
|k|
≥
1.
Since
k[r]∗
and
k
have
the
same
sign,
it
thus
follows
that
|k[r]∗
+
(iχ
/n)|
−
|k[r]∗
|
=
|k
+
(iχ
/n)|
−
|k|,
hence
that
|k[r]∗
+
(iχ
/n)|
≥
|k
+
(iχ
/n)|.
But
this
implies
that
2
·
Ψ(k[r])
=
(k[r]
+
(iχ
/n))2
=
(k[r]∗
+
(iχ
/n))2
≥
(k
+
(iχ
/n))2
=
2
·
Ψ(k)
i.e.,
that
Ψ(k[r])
≥
Ψ(k).
On
the
other
hand,
since
k[r]
∈
KCrit
,
k
∈
/
KCrit
,
we
have
Ψ(k[r])
≤
Ψ(k).
Thus,
we
conclude
that
Ψ(k[r])
=
Ψ(k),
so
k
is
exceptional
and
r
=
d
−
1,
contrary
to
the
hypotheses
of
Lemma
4.7.
This
completes
the
proof
of
the
claim.
Thus,
k[r]∗
=
k
lies
to
the
same
side
of
k
as
R
·
F
r
(KCrit
).
Next,
let
us
prove
the
inequality
|k
−
k[r]∗
|
≥
1
·
Dist(k,
F
r
(KCrit
))
4n
Indeed,
if
|k
−
k[r]∗
|
≥
Dist(k,
F
r
(KCrit
)),
then
this
inequality
follows
immediately,
so
we
may
assume
that
|k
−
k[r]∗
|
<
Dist(k,
F
r
(KCrit
)),
i.e.,
that
k[r]∗
lies
between
k
and
R
·
F
r
(KCrit
).
Since
k
=
k[r]∗
and
n
·
k,
n
·
k[r]∗
∈
Z,
it
follows
that
|k
−
k[r]∗
|
≥
n1
.
On
the
other
hand,
Dist(k[r]∗
,
F
r
(KCrit
))
=
|k[r]∗
−
k[r
]|
for
some
r
∈
{r
−
2,
r
−
1}
(i.e.,
k[r
]
is
the
closest
element
∈
F
r
(KCrit
)
to
k[r]∗
).
Moreover,
by
Lemma
4.1,
we
have
r+1
r−3
r
r−3
∗
2
+
1
≥
|k[r]
|
≥
2
;
2
≥
|k[r
−
1]|,
|k[r
−
2]|
≥
2
>
0.
Thus,
in
particular,
it
follows
that
k[r
]
and
k[r]∗
have
the
same
sign,
so
we
obtain
Dist(k[r]∗
,
F
r
(KCrit
))
=
|k[r]∗
−
k[r
]|
1

1
1
1
≤
Max
(r
+
3)
−
(r
−
3),
r
−
(r
−
3)
=
3
2
2
2
2
Thus,
by
Lemma
4.6
(where
we
take
the
quantity
“X
+
A”
(respectively,
“X
+
B”)
of
Lemma
4.6
to
be
|k
−
k[r]∗
|
(respectively,
Dist(k,
F
r
(KCrit
)))),
we
have
|k
−
k[r]∗
|
≥
−1
1
1
1
·
+3
·
Dist(k,
F
r
(KCrit
))
·
Dist(k,
F
r
(KCrit
))
≥
n
n
4n
302
1
This
completes
the
proof
of
the
inequality
|k
−
k[r]∗
|
≥
4n
·
Dist(k,
F
r
(KCrit
)).
Now
we
are
ready
to
complete
the
proof
of
Lemma
4.7.
Note
that
since
either
k
is
non-exceptional
or
r
<
d
−
1,
we
have
Ψ(k)
>
Ψ(k[r])
(cf.
Lemma
4.3).
Also,
by
the
deﬁnition
of
k[r]∗
,
it
follows
that
k[r]∗
+
(iχ
/n)
and
k
+
(iχ
/n)
have
the
same
sign.
Thus,
we
compute
(using
the
inequality
of
the
preceding
paragraph,
together
with
Lemma
4.5):
2(Ψ(k)
−
Ψ(k[r]))
=
2(Ψ(k)
−
Ψ(k[r]))
=
2(Ψ(k)
−
Ψ(k[r]∗
))
=
(k
+
(iχ
/n))2
−
(k[r]∗
+
(iχ
/n))2
=
(|k
+
(iχ
/n)|
+
|k[r]∗
+
(iχ
/n)|)
·
(|k
+
(iχ
/n)|
−
|k[r]∗
+
(iχ
/n)|)
≥
|k
+
(iχ
/n)|
·
|k
+
(iχ
/n)
−
k[r]∗
−
(iχ
/n)|
1
1
≥
(
d
−
)
·
|k
−
k[r]∗
|
2
2
1
1
1
·
Dist(k,
F
r
(KCrit
))
=
·
d
·
Dist(k,
F
r
(KCrit
))
≥
(
d)
·
4
4n
16n
(where
we
use
that
d
≥
2)
as
desired.

Finally,
we
need
one
more
lemma
in
the
style
of
Lemma
4.7,
which
is
a
sort
of
analogue
(in
the
present
context)
of
Lemma
3.1
of
§3:
Lemma
4.8.
Let
r
>
r
be
nonnegative
integers
≤
d
−
1
such
that
|k[r]
+
(iχ
/n)|,
|k[r
]
+
(iχ
/n)|
≥
d
4

1
·
d
·
Dist(k[r],
F
r
(KCrit
)).
and
Ψ(k[r])
=
Ψ(k[r
]).
Then
Ψ(k[r])
−
Ψ(k[r
])
≥
32n
def
def
def
Proof.
Write
k
=
k[r],
k
=
k[r
],
σk
=
k/|k|
(note
that
|k|
≥
|k
+
(iχ
/n)|
−
12
≥
d4
−
12
≥
def
1
>
0,
since
d
≥
6),
(k
)∗
=
−(iχ
/n)
+
σk
·
|k
+
(iχ
/n)|.
Since
|k
+
(iχ
/n)|,
|k
+
(iχ
/n)|
≥
d
∗
∗
4
>
1,
it
follows
that
k,
(k
)
,
k
+
(iχ
/n),
and
(k
)
+
(iχ
/n)
have
the
same
sign.
Thus,
|k
+(iχ
/n)|−|(k
)∗
+(iχ
/n)|
=
σk
(k
+(iχ
/n)−(k
)∗
−(iχ
/n))
=
σk
(k
−(k
)∗
)
=
|k|−|(k
)∗
|
On
the
other
hand,
since
Ψ(k)
>
Ψ(k
)
=
Ψ((k
)∗
),
it
follows
that
this
diﬀerence
of
absolute
values
is
>
0,
hence
that
|k|
>
|(k
)∗
|
303
Next,
observe
that
λ1
=
0
(cf.
Chapter
V,
Theorem
4.8).
Thus,
k[0]
=
0,
hence
r,
r
≥
1

(since
|k|,
|k
|
≥
d4
−
12
≥
1).
In
particular,
0
∈
F
1
(KCrit
)
⊆
F
r
(KCrit
).
On
the
other


hand,
since
r
>
r
,
k
=
k[r]
∈
/
F
r
(KCrit
).
Thus,
we
conclude
that
(k
)∗
and
F
r
(KCrit
)
lie
to
the
same
side
of
k
(i.e.,
in
the
same
connected
component
of
R\{k}).


Note
that
the
fact
that
0
∈
F
r
(KCrit
)
also
implies
that
F
r
(KCrit
)
is
nonempty.
Let
us


write
k[r
]
for
the
unique
element
of
F
r
(KCrit
)
such
that
|k
−
k[r
]|
=
Dist(k,
F
r
(KCrit
)).
Then
r
∈
{r
−
1,
r
−
2}.
Thus,
by
Lemma
4.1
(plus
the
fact
that
k[0]
=
0),
we
have:
r
−1
r
+1
≥
|k[r
]|
≥
2
2
On
the
other
hand,
again
by
Lemma
4.1,
we
have
r
−1
r
+1
≥
|k
|
=
|k[r
]|
≥
2
2
which
implies
that
r
−3
r
+3
≥
|(k
)∗
|
≥
2
2
hence
(since
k[r
]
·
k
≥
0,
(k
)∗
·
k
>
0)
that
|(k
)∗
−
k[r
]|
≤
Max(
≤
r
+1
r
−3
r
+3
r
−1
−
,
−
)
2
2
2
2
1
·
Max(r
−
r
+
4,
r
−
r
+
4)
≤
3
2
Now
we
are
ready
to
prove
the
inequality:
|k
−
(k
)∗
|
≥

1
·
Dist(k,
F
r
(KCrit
))
4n

Indeed,
without
loss
of
generality,
we
may
assume
that
|k
−
(k
)∗
|
<
Dist(k,
F
r
(KCrit
)),

i.e.,
that
(k
)∗
lies
strictly
between
k
and
F
r
(KCrit
).
Since
k
=
(k
)∗
and
n
·
k,
n
·
(k
)∗
∈
Z,
it
follows
that
|k
−
(k
)∗
|
≥
n1
.
On
the
other
hand,
|(k
)∗
−
k[r
]|
≤
3,
so
by
Lemma
4.6,
we
have
|k
−
(k
)∗
|
≥

1
1
1
1
·
(
+
3)−1
·
|k
−
k[r
]|
≥
·
|k
−
k[r
]|
=
·
Dist(k,
F
r
(KCrit
))
n
n
4n
4n
as
desired.
304
Thus,
just
as
in
Lemma
4.7,
we
have:
2(Ψ(k)
−
Ψ(k
))
=
2(Ψ(k)
−
Ψ(k
))
=
2(Ψ(k)
−
Ψ((k
)∗
))
=
(k
+
(iχ
/n))2
−
((k
)∗
+
(iχ
/n))2
=
(|k
+
(iχ
/n)|
+
|(k
)∗
+
(iχ
/n)|)
·
(|k
+
(iχ
/n)|
−
|(k
)∗
+
(iχ
/n)|)
≥
(|k
+
(iχ
/n)|)
·
|k
+
(iχ
/n)
−
(k
)∗
−
(iχ
/n)|
1
≥
d
·
|k
−
(k
)∗
|
4


1
1
1
·
Dist(k,
F
r
(KCrit
))
=
·
d
·
Dist(k,
F
r
(KCrit
))
≥
d·
4
4n
16n
as
desired.

§5.
The
Full
Binomial
Model
In
this
§,
we
apply
the
estimates
of
the
preceding
§
to
study
the
orthogonal
system
which
constitutes
the
full
binomial
model.
We
maintain
the
notation
of
§4.
We
begin
by
considering
the
binomial
coeﬃcients
that
appear
in
the
sum
deﬁning
ZCG
r
.
def
Lemma
5.1.
Let
k
∈
Z,
r
∈
[0,
d
−
1]Int
(where
[0,
d
−
1]Int
=
[0,
d
−
1]
Lemma
4.1).
Then

Z
is
as
in
!k
+
λ
!
Dist(k,
F
r
(K
))
+
r
−
1
!
r
!
Crit
!=
!
r
r
!
!
!
k+λr
!
In
particular,
log(!
r
!)
≤
Dist(k,
F
r
(KCrit
))
·
log(|k|
+
d).
Proof.
First,
let
us
observe
that
in
general,
for
any
N
∈
Z,
we
have
the
identity
!N
!
Dist(N,
[0,
r
−
1]
)
+
r
−
1
!
!
Int
!
!=
r
r
Indeed,
thisis
clear
for
N
∈

[0,
r
−
1]Int
(since
both
sides
are
zero).
For
N
<
0,
one
checks
N
r−1−N
,
Dist(N,
[0,
r
−1]Int
)
=
Dist(r
−1−N,
[0,
r
−1]Int
),
so
it
suﬃces
easily
that
|
r
|
=
r
305
to
prove
the
identity
when
N
≥
r.
But
for
N
≥
r,
we
have
Dist(N,
[0,
r−1]Int
)
=
N
−(r−1),
so
the
identity
follows
immediately.
Applying
this
identity,
we
obtain
!k
+
λ
!
Dist(k
+
λ
,
[0,
r
−
1]
)
+
r
−
1
!
r
!
r
Int
!
!=
r
r




Dist(k,
F
r
(KCrit
))
+
r
−
1
Dist(k,
[0,
r
−
1]Int
−
λr
)
+
r
−
1
=
=
r
r
by
the
deﬁnition
of
F
r
(KCrit
).


r
Finally,
we
note
that
the
binomial
coeﬃcient
Dist(k,F
(Kr
Crit
))+r−1
may
be
bounded
by
the
product
of
Dist(k,
F
r
(KCrit
))
−
1
(≤
Dist(k,
F
r
(KCrit
)))
integers
all
of
which
have
absolute
value
≤
|Dist(k,
F
r
(KCrit
))
+
r
−
1|
≤
|k
−
Avg(F
r
(KCrit
))|
+
|r
−
1|
≤
|k|
+
12
+
(d
−
2)
≤
|k|
+
d
(by
Lemma
4.1).

Let
us
write
def
Semi
=
Crit(KSemi
)
⊆
KCrit
KCrit
Semi
Thus,
(by
the
deﬁnition
of
KSemi
)
every
k0
∈
KCrit
satisﬁes
|k0
+
(iχ
/n)|
≥
d4
≥
3
(so
Semi
,
then
r
≥
4
(indeed,
if
r
≤
3,
|k0
|
≥
52
),
where
we
use
that
d
≥
12.
Also,
if
k[r]
∈
KCrit
r+1
then
by
Lemma
4.1,
|k[r]|
≤
2
≤
2).
Let
us
write
def
Semi
Semi
=
{r
∈
[0,
d
−
1]Int
|
k[r]
∈
KCrit
}
RCrit
Next,
let
us
observe
that
Semi
KCrit
=
{k0
∈
KCrit
|
|k0
+
(iχ
/n)|
≥
d
}
4
Indeed,
“⊆”
follows
from
the
deﬁnition
of
KSemi
.
On
the
other
hand,
if
|k0
+
(iχ
/n)|
≥
d4
,
def
def
and
σk0
=
k0
/|k0
|,
then
(since
|k0
|
≤
d2
<
d
by
Lemma
4.1,
d
≥
1)
the
integer
k
=
k0
−
σk0
·
d
satisﬁes
k
·
k0
<
0,
hence
∈
KSemi
.
This
completes
the
proof
of
the
above
observation.
In
the
following,
we
shall
write
def
Semi(k0
)
=
k0
−
σk0
·
d
1
In
particular,
since
(for
r
∈
[0,
d
−
1]Int
)
r
→
|k[r]
+
(iχ
/n)|
=
{2
·
Ψ(k[r])}
2
is
(not
Semi
is
an
interval
of
integers,
necessarily
strictly)
monotone
increasing,
it
follows
that
RCrit
306
1
d
i.e.,
of
the
form
[r,
d
−
1]Int
(where
|k[d
−
1]
+
(iχ
/n)|
≥
d−2
2
−
2
≥
4
(by
Lemma
4.1,
Semi
)
for
some
integer
r.
d
≥
6)
implies
d
−
1
∈
RCrit
def
Semi
)
by:
Next,
we
would
like
to
deﬁne
a
matrix
M
=
{Mr,r
}
(where
r,
r
∈
RCrit
def
Mr,r
=
Coeﬀ
U
k[r
]
(ZCG
r
)
sc


k[r
]
+
λr
−Ψ(k[r])
Ψ(k[r
])
·
qsc
·
·
χ(k[r
]et
)
=
qsc
r


Semi(k[r
])
+
λr
Ψ(Semi(k[r
]))
+
·
χ(Semi(k[r
])et
)
·
qsc
r
Let
us
write
def
M
=
M0
+
MSemi
where
(M0
)r,r
is
deﬁned
to
be
the
sum
of
all
the
terms
in
Mr,r
in
which
the
exponent
of
def
qsc
is
zero;
MSemi
=
M
−
M0
.
More
precisely,
(by
Lemma
4.3)
(M0
)r,r
can
be
nonzero
only
when
Ψ(k[r])
=
Ψ(k[r
]).
Moreover,
when
Ψ(k[r])
=
Ψ(k[r
]),
we
have

(M0
)r,r
=
where
k[r
]
+
λr
r



Semi(k[r
])
+
λr
·
χ(k[r
]et
)
+
·
·
χ(Semi(k[r
])et
)
r
def
=
1
if
r
=
r
=
d
−
1
and
Semi(k[d
−
1])
=
k[d]
is
exceptional
(cf.
Lemma
def
4.3);
and
=
0
otherwise.
In
the
following
discussion,
we
would
like
to
show
that
(under
certain
conditions)
M
admits
a
bounded
inverse.
We
will
do
this
by
regarding
MSemi
as
a
deformation
of
M0
,
i.e.,
we
will
ﬁrst
study
the
inverse
of
M0
and
then
show
that
MSemi
is
rather
small.
We
begin
by
considering
M0
.
Note
that
since
the
ﬁbers
of
the
map
r
→
Ψ(k[r])
have
at
most
two
(necessarily
adjacent)
elements,
it
follows
that
(M0
)r,r
can
be
nonzero
only
in
the
cases
r
=
r
and
r
=
r
±
1.


r
Now
suppose
that
r
=
r
.
Then
we
have
k[r]
+
λr
∈
{−1,
r},
so
k[r]+λ
=
±1.
r
Similarly,
if
r
=
r
=
d
−
1
and
Semi(k[d
−
1])
=
k[d]
is
exceptional,
then
we
have



])+λr
Semi(k[r])
+
λr
∈
{−1,
d
−
1},
so
Semi(k[r
=
±1.
Thus,
r
(M0
)r,r
=
±χ(k[r]et
)
±
·
χ(Semi(k[r])et
)
(where
the
two
“±’s”
are
not
necessarily
the
same
sign).
Note
that
when
r
=
r
=
d
−
1
and
k[d]
is
exceptional,
(M0
)r,r
is
precisely
the
coeﬃcient
discussed
in
Lemma
4.4.
307
F
Next,
suppose
that
r
=
r
−
1.
In
this
case,
=
0.
Moreover,
k[r
]
=
k[r
+
1]
∈



(KCrit
),
so
k[r
]
+
λr
∈
{−1,
r}.
Thus,
k[r
r]+λr
=
±1,
so
we
have:
r+2
(M0
)r,r+1
=
±χ(k[r
+
1]et
)
Note,
moreover,
that
in
this
case,
since
Ψ(k[r])
=
Ψ(k[r
+
1]),
and
the
ﬁbers
of
the
map
r
→
Ψ(k[r])
have
at
most
two
elements,
it
follows
that
Ψ(k[r
+
1])
<
Ψ(k[r
+
2]),
i.e.,
that
(M0
)r+1,r+2
=
0.
Finally,
suppose
that
r
=
r
+
1.
In
this
case,
=
0.
Moreover,
k[r
]
=
k[r
−
1]
∈


r
F
(KCrit
),
so
k[r
]
+
λr
∈
[0,
r
−
1]Int
.
Thus,
k[r
]+λ
=
0,
so
we
have:
r
r
(M0
)r,r−1
=
0
In
particular,
we
conclude
that
(M0
)r,r
=
0
if
r
>
r
or
r
<
r
−
1.
In
fact,
this
analysis
shows
the
following:
Lemma
5.2.
The
matrix
M0
is
of
the
form
⎛
∗
⎜
⎜0
⎜
⎜
⎜
⎝
0
0
0
...
∗
0
...
...
0
0
...
0
⎞
⎟
0⎟
⎟
⎟
⎟
⎠
∗
that
is
to
say,
zeroes
away
from
the
“diagonal”
(i.e.,
the
“∗’s”),
where
each
“∗”
in
the
diagonal
is
either
a
one-by-one
matrix
or
an
upper
triangular
two-by-two
matrix.
In
particular,
M0
itself
is
upper
triangular.
Moreover,
the
diagonal
matrix
elements
of
each
submatrix
“∗”
are
either
n-th
roots
of
unity,
or
(in
the
case
of
(M0
)d−1,d−1
,
when
k[d]
is
exceptional)
the
coeﬃcient
of
Lemma
4.4.
The
oﬀ-diagonal
elements
of
each
submatrix
“∗”
are
all
n-th
roots
of
unity.
Finally,
M0
is
invertible,
and
the
components
of
its
inverse
n
M−1
0
are
complex
numbers
of
absolute
value
≤
π
.
Proof.
All
the
statements
except
for
the
“Finally,...”
follow
immediately
from
the
above
analysis.
The
“Finally,...”
follows
from
the
fact
that
each
of
the
∗’s
are
invertible,
with
inverses
bounded
as
stated.
(Note
that
here
we
use
the
estimates
of
Lemma
4.4.)

Next,
we
would
like
to
bound
MSemi
.
By
deﬁnition,
MSemi
consists
of
the
terms
of
308


k[r
]
+
λr
Ψ(k[r
])
·
χ(k[r
]et
)
·
qsc
r


Semi(k[r
])
+
λr
Ψ(Semi(k[r
]))
·
χ(Semi(k[r
])et
)
+
·
qsc
r
−Ψ(k[r])
Mr,r
=
qsc
·
for
which
the
exponent
of
qsc
is
nonzero.
Thus,
there
are
two
cases
(corresponding
to
the
two
terms
that
appear
in
Mr,r
)
to
consider:
(i)
Ψ(k[r
])
=
Ψ(k[r]);
(ii)
Ψ(Semi(k[r
]))
=
Ψ(k[r]).
We
begin
by
considering
case
(ii).
In
this
case,
either
Semi(k[r
])
is
nonSemi
exceptional,
or
r
<
d
−
1.
Moreover,
(since
r
∈
RCrit
)
r
≥
4.
Thus,
Lemma
4.7
implies
that
Ψ(Semi(k[r
]))
−
Ψ(k[r])
≥
1
·
d
·
Dist(Semi(k[r
]),
F
r
(KCrit
))
32n
Thus,
since
d
+
|Semi(k[r
])|
≤
2d
+
|k[r
]|
≤
52
·
d
≤
d2
(by
the
deﬁnition
of
“Semi(−),”
Lemma
4.1,
d
≥
3),
we
have
(by
Lemma
5.1):
!
!
Semi(k[r
])
+
λ

!
!
r
Ψ(Semi(k[r
]))−Ψ(k[r])
·
χ(Semi(k[r
])et
)
!
·
qsc
!
r


≤
e2·log(d)·Dist(Semi(k[r
]),F
(KCrit
))
·
|qsc
|
32n
·Dist(Semi(k[r
]),F
(KCrit
))
r
d

π
r
r
=
e(2·log(d)−Im(τor
)·
16n
)·Dist(Semi(k[r
]),F
(KCrit
))
(where
we
use
that
log|qsc
|
=
−
2π
/
d
·
Im(τor
)).
Also,
let
us
observe
that
(since
Semi(k[r
])
∈
F
r
(KCrit
)),
we
have
Dist(Semi(k[r
]),
F
r
(KCrit
))
≥
1.
Next,
we
consider
case
(i),
i.e.,
the
ﬁrst
term
in
Mr,r
when
Ψ(k[r
])
=
Ψ(k[r]).
Note
ﬁrst
of
all
that
this
condition
implies
that
r
=
r
.
Moreover,
if
r
>
r
,
then
k[r
]
∈



F
r
(KCrit
),
i.e.,
k[r
]
+
λr
∈
[0,
r
−
1]Int
,
so
k[r
r]+λr
=
0.
Thus,
it
suﬃces
to
bound
this
Semi
,
we
have
|k[r]+(iχ
/n)|,
|k[r
]+(iχ
/n)|
≥
d4
.
term
when
r
<
r
.
Note
that
since
r,
r
∈
RCrit
Thus,
by
applying
Lemma
4.8
(note
that
“r,”
“r
”
in
Lemma
4.8
are
the
reverse
of
what
they
are
in
the
present
discussion),
we
obtain
Ψ(k[r
])
−
Ψ(k[r])
≥
1
·
d
·
Dist(k[r
],
F
r
(KCrit
))
32
·
n
Thus,
using
Lemma
5.1
(and
the
fact
that
d
+
|k[r
]|
≤
32
·
d
≤
d2
,
by
Lemma
4.1,
d
≥
2)
as
in
the
preceding
paragraph,
we
obtain:
!
k[r
]
+
λ

!
!
!
r
Ψ(k[r
])−Ψ(k[r])
·
χ(k[r
]et
)
!
·
qsc
!
r


≤
e2·log(d)·Dist(k[r
],F
(KCrit
))
·
|qsc
|
32n
·Dist(k[r
],F
(KCrit
))
r
π
d

r
=
e(2·log(d)−Im(τor
)·
16n
)·Dist(k[r
],F
(KCrit
))
309
r

Also,
let
us
observe
that
since
r
<
r
(so
k[r
]
∈
/
F
r
(KCrit
)
⊆
F
r
(KCrit
)),
we
have
Dist(k[r
],
F
r
(KCrit
))
≥
1.
Now
let
us
assume
that
Im(τor
)
≥
{5
+
(log(n)/log(d))}
·
16
·
log(d)
·
n
π
Then
it
follows
that
2
·
log(d)
−
Im(τor
)
·
π
≤
−{3
+
(log(n)/log(d))}
·
log(d)
16n

π

16n
≤
−{3
+
(log(n)/log(d))}
·
log(d)
=
−3
·
log(d)
−
log(n)
+
{5
+
(log(n)/log(d))}
·
log(d)
−
Im(τor
)
·
In
particular,
it
follows
that
both
of
the
terms
(cf.
the
treatment
of
cases
(i),
(ii)
above)
which
appear
in
the
components
of
MSemi
have
absolute
value
≤
e−3·log(d)−log(n)
=
(n
·
d3
)−1
.
Thus,
since
there
are
two
terms
involved,
we
obtain
the
following
result:
Lemma
5.3.
If
the
condition
Im(τor
)
≥
{5
+
(log(n)/log(d))}
·
16
·
log(d)
·
n
π
2
In
is
satisﬁed,
then
the
components
of
the
matrix
MSemi
have
absolute
value
≤
n·d
3.
−1
n
2
particular,
the
components
of
the
matrix
M0
·
MSemi
have
absolute
value
≤
d
·
π
·
n·d3
≤
d−2
.
Proof.
The
statement
concerning
the
absolute
values
of
the
components
of
MSemi
was
proven
in
the
above
discussion.
The
statement
concerning
the
absolute
values
of
the
components
of
M−1
0
·
MSemi
follows
from
this
estimate,
plus
the
estimates
of
Lemma
5.2
(together
with
the
fact
that
these
matrices
are
square
matrics
of
order
equal
to
the
Semi
Semi
|
≤
|KCrit
|
=
d
of
KCrit
).

cardinality
|KCrit
Now
we
come
to
the
invertibility
of
the
original
matrix
M.
Note
that
−1
M−1
0
·
M
=
1
+
M0
·
MSemi
def
Write
M
=
−M−1
0
·
MSemi
.
Then
by
Lemma
5.3,
the
components
of
M
have
absolute
value
≤
d−2
.
Thus,
for
any
nonnegative
integer
N
,
the
components
of
(M
)N
+1
will
have
Semi
|≤
absolute
value
≤
d−2
·
(d
·
d−2
)N
=
d−N
−2
(where
we
again
use
the
fact
that
|KCrit
def
310

|KCrit
|
=
d).
Thus,
the
series
N
≥0
(M
)N
converges
to
a
matrix
whose
components
have
absolute
value
≤
(1
−
d−1
)−1
≤
2.
Moreover,
M
−1
=

N
(M
)

·
M−1
0
N
≥0
Thus,
(applying
the
estimates
of
Lemma
5.2)
we
see
that
we
have
proven
the
following:
Lemma
5.4.
Under
the
hypothesis
of
Lemma
5.3,
the
matrix
M
is
invertible,
and
the
components
of
its
inverse
have
absolute
value
≤
2
·
d
·
nπ
≤
d
·
n.
to
the
problem
that
Now
we
would
like
to
consider
the
analogous
problem
for
the
ZCG
r
we
solved
in
§3
for
the
ZrCG
:
Namely,
let
def
Z
=
d−1

γr
·
ZCG
r
r=0
be
a
C-linear
combination
(i.e.,
the
γr
∈
C)
of
the
ZCG
r
.
def
Suppose
that
||Z||
=
1.
Then
to
what
extent
can
one
bound
the
gr
=
|γr
|?
k
(k
∈
Z)
form
an
orthonormal
system
in
L2
((S1
)sc
),
it
follows
Since
||Z||
=
1,
and
the
Usc
k
that
the
coeﬃcients
of
the
Usc
(in
the
“Fourier
expansion”
of
Z)
are
≤
1.
In
particular,
k[r
]
for
each
r
=
0,
.
.
.
,
d
−
1,
the
coeﬃcient
of
Usc
is
≤
1.
Thus,
we
would
like
to
analyze
these
coeﬃcients
in
a
fashion
similar
to
§3.
Unfortunately,
however,
the
present
situation
is
somewhat
more
complicated
than
in
§3,
so
we
must
break
the
situation
down
into
two
cases.
Semi
/
RCrit
.
This
case
is
the
simpler
case
since
it
may
be
First,
we
consider
the
case
r
∈
Semi
reduced
to
the
results
of
§3.
More
precisely,
let
us
observe
that
for
r
∈
/
RCrit
,
there
do
not
exist
any
k
∈
KSemi
such
that
Crit(k)
=
k[r
].
Thus,
if
we
just
look
at
the
coeﬃcient
k[r
]
is
exactly
the
same
as
ZrCG
.
Thus,
we
obtain
exactly
the
same
inequalities
of
Usc
,
ZCG
r


r
!

!
k[r
]
+
λr
!
!
Ψ(k[r
])−Ψ(k[r])
γr
·
·
χ(k[r]et
)
!
≤
1
·
qsc
!
r
r=0
Semi
Semi
,
any
r
≤
r
will
also
∈
RCrit
.
Thus,
for
the
r
appearing
as
in
§3.
Note
that
since
r
∈
RCrit
k[r]
in
this
sum,
we
also
get
similar
inequalities
(obtained
by
considering
the
coeﬃcient
of
Usc
).
In
particular,
by
the
analysis
of
§3
(more
precisely:
by
Theorem
3.3,
(2)),
we
obtain
the
following
result:
311
2
26·d
Semi
Suppose
that
Im(τor
)
≥
32
,
for
all
r
∈
/
RCrit
.
π
·
log
(d).
Then
|γr
|
≤
e
Lemma
5.5.
Semi
.
This
case
is
the
more
diﬃcult
of
the
two
cases.
Next,
we
consider
the
case
r
∈
RCrit
k[r
]
First,
let
us
observe
that
by
looking
at
the
coeﬃcient
of
Usc
,
we
obtain
an
inequality
!
!
d−1
!

CG
!
γr
·
Coeﬀ
U
k[r
]
(Zr
)
!
≤
1
!
sc
r=0
Semi
analogous
to
the
one
considered
in
the
“∈
/
RCrit
case.”
Thus,
under
the
hypothesis
of
Lemma
5.5,
we
obtain
!
!
!
!
!
!
!
γr
·
Mr,r
!
=
!

Semi
r∈RCrit
!

!
γr
·
Coeﬀ
U
k[r
]
(ZCG
)!
r
sc
Semi
r∈RCrit
!
!
≤1+!
!
!
γr
·
Coeﬀ
U
k[r
]
(ZCG
)
!
r

sc
Semi
r∈R
/
Crit
≤
1
+
e26·d
·
!
!
!
!
)
!
Coeﬀ
U
k[r
]
(ZCG
!
r

sc
Semi
r∈R
/
Crit
Now
we
have
the
following
result:
Lemma
5.6.
Let
r
∈
[0,
d
−
1]Int
,
r
!
!
!
CG
!

!
Coeﬀ
U
k[r
]
(Zr
)
!
≤
23d−1
.
Semi
∈
RCrit
.
Then
sc
Proof.
Note
that
Ψ(Semi(k[r
]))
≥
Ψ(k[r])
always,
and
Ψ(k[r
])
≥
Ψ(k[r])
if
r
≤
r
.
On
the
other
hand,
Coeﬀ
U
k[r
]
(ZCG
r
)
is
given
by
sc

k[r
]
+
λr
r


Ψ(k[r
])−Ψ(k[r])
·
χ(k[r
]et
)
·
qsc


Semi(k[r
])
+
λr
Ψ(Semi(k[r
]))−Ψ(k[r])
·
qsc
·
χ(Semi(k[r
])et
)
+
r

where
the
ﬁrst
term
is
zero
if
r
>
r
(since
then
k[r
]
∈
F
r
+1
(KCrit
)
⊆
F
r
(KCrit
),
so
k[r
]
+
λr
∈
[0,
r
−
1]Int
).
Since
the
exponents
of
qsc
appearing
in
the
nonzero
term(s)
are
≥
0,
we
thus
obtain
that
this
coeﬃcient
has
absolute
value
≤
!k[r
]
+
λ
!
!Semi(k[r
])
+
λ
!
!
!
r
!
r
!
!+!
!
!
r
r




Dist(Semi(k[r
]),
F
r
(KCrit
))
+
r
−
1
Dist(k[r
],
F
r
(KCrit
))
+
r
−
1
≤
+
r
r


r
r
≤
2Dist(k[r
],F
(KCrit
))+d−2
+
2Dist(Semi(k[r
]),F
(KCrit
))+d−2
≤
22d−2
+
23d−2
≤
2
·
23d−2
=
23d−1
312
(where
we
use
Lemma
5.1,
d
≥
1,
and
the
estimates
Dist(k[r
],
F
r
(KCrit
))
≤
|k[r
]
−
Avg(F
r
(KCrit
))|
≤
d
1
+
≤d
2
2
and
Dist(Semi(k[r
]),
F
r
(KCrit
))
≤
|Semi(k[r
])
−
Avg(F
r
(KCrit
))|
≤
|Semi(k[r
])|
+
≤
d
+
|k[r
]|
+
1
2
1
d
1
≤
d
+
+
≤
2d
2
2
2
–
cf.
Lemma
4.1).

Thus,
applying
Lemma
5.6
in
the
above
discussion,
we
obtain:
!
!
!

!
!
Semi
γr
·
Mr,r
!
≤
1
+
e26·d
·
|[0,
d
−
1]Int
\RCrit
|
·
23d−1
≤
d
·
e26·d
·
23d
≤
d
·
e29·d
Semi
r∈RCrit
On
the
other
hand,
by
Lemma
5.4,
M
is
invertible,
and
the
components
of
M−1
have
absolute
value
≤
d
·
n.
Thus,
we
conclude
that,
under
the
hypothesis
of
Lemma
5.3,
we
have:
Semi
|γr
|
≤
|RCrit
|
·
(d
·
n)
·
d
·
e29·d
≤
n
·
d3
·
e29·d
≤
n
·
e30·d
Semi
(since
d
≤
e
3
·d
for
d
≥
6)
for
r
∈
RCrit
.
That
is
to
say,
we
have
proven
the
following
CG
analogue
for
the
Zr
of
Theorem
3.3:
1
Suppose
that
d
≥
12,
and
Theorem
5.7.
Im(τor
)
≥
def
d−1
r=0
and
let
Z
=
16
32
80
·
log2
(d)
+
·
n
·
log(d)
+
·
n
·
log(n)
π
π
π
γr
·ZCG
be
a
C-linear
combination
(i.e.,
the
γr
∈
C)
of
the
ZCG
r
r
.
Then
(1)
If
the
|γr
|
≤
1
for
r
=
0,
.
.
.
,
d
−
1,
then
the
L2
((S1
)sc
)-norm
of
Z
satisﬁes:
||Z||
≤
d2
·
e3d
≤
e4d
.
313
(2)
If
||Z||
≤
1,
then
the
|γr
|
≤
n
·
e30·d
,
for
all
r
=
0,
.
.
.
,
d
−
1,
and
Semi
/
RCrit
.
|γr
|
≤
e26·d
if
r
∈
In
particular,
if
we
orthonormalize
the
ZCG
to
form
r
OC
ZOC
0
,
.
.
.
,
Zd−1
–
which
are
unique
if
we
stipulate
that
the
leading
coeﬃcient
of
ZOC
(i.e.,
the
coeﬃcient
r
CG
CG
CG
OC
of
Zr
in
the
linear
combination
of
Z0
,
.
.
.
,
Zr
that
forms
Zr
)
be
positive
–
then
the
30d
coeﬃcients
of
the
ZCG
in
each
ZOC
,
and
the
absolute
values
r
r
have
absolute
value
≤
n
·
e
−2
−3d
−4d
≥e
.
of
the
leading
coeﬃcients
are
≥
d
·
e
Proof.
Note
that
the
hypothesis
of
Theorem
5.7
implies
the
hypotheses
of
Lemmas
5.3,
5.4,
5.5.
The
ﬁnal
portion
concerning
the
ZOC
follows
formally
from
(1),
(2)
(cf.
the
proof
r
of
Theorem
3.3).
Moreover,
(2)
is
precisely
what
was
proven
above
(cf.
Lemma
5.5
for
the
last
part
of
(2)).
Thus,
it
suﬃces
to
prove
(1).
To
prove
(1),
it
suﬃces
to
bound
the
k[r
]
(for
r,
r
=
0,
.
.
.
,
d
−
1)
by
e3d
.
For
absolute
value
of
the
coeﬃcient
of
each
Usc
in
ZCG
r
CG
Semi
r
∈
/
RCrit
,
(as
discussed
above)
the
Zr
look
exactly
the
same
as
the
ZrCG
,
so
we
obtain
Semi
,
the
coeﬃcient
the
estimate
“≤
ed
(≤
e3d
)”
as
in
the
proof
of
Theorem
3.3.
For
r
∈
RCrit

k[r
]
of
Usc
has
absolute
value
≤
e3d
by
Lemma
5.6
(cf.
the
proof
of
Theorem
3.3).
This
completes
the
proof
of
(1).

and
the
original
ζrCG
.
This
It
thus
remains
to
deal
with
the
discrepancy
between
ZCG
r
discrepancy
may
be
dealt
with
exactly
as
in
the
proof
of
Lemma
2.1
in
§2
(where
we
dealt
with
deformations
of
the
discrete
Tchebycheﬀ
polynomials).
Indeed,
let
def
ζrCG,μ
=

k
+
λr

k∈Z
=
ZCG
+
r
r
Ψ(k)−Ψ(k[r])
Crit(k)
·
Usc
·
χ(ket
)
·
qsc


k∈Z\(KCrit
k
+
λr
r

Ψ(k)−Ψ(k[r])
Crit(k)
·
Usc
·
χ(ket
)
·
qsc
KSemi
)
−Ψ(k[r])
be
the
series
obtained
by
restricting
qsc
def
ζμ
=
d−1

−i
·
Ucv
χ
·
ζrCG
to
μd
⊆
(S1
)sc
.
Let
γr
·
ζrCG,μ
r=0
CG,μ
be
a
C-linear
combination
(i.e.,
the
γr
∈
C)
of
the
ζr
314
.
Moreover,
let
us
assume
that
def
Z
=
d−1

γr
·
ZCG
r
r=0
satisﬁes
||Z||
=
1.
Then
we
would
like
to
bound
||ζ
μ
||
from
above
and
below.
In
the
following
discussion,
we
assume
that
the
hypotheses
of
Theorem
5.7
are
satisﬁed.
Then
by
Theorem
5.7,
(2),
we
obtain
|γr
|
≤
n
·
e30·d
for
r
=
0,
.
.
.
,
d
−
1.
On
the
other
hand,
by
Lemma
4.2,
for
k
∈
Z\(KCrit
KSemi
),
we
1
·
d
·
|k|.
Thus,
(by
Lemmas
4.1,
5.1,
and
the
estimate
have
|k|
≥
12
d,
Ψ(k)
−
Ψ(k[d
−
1])
≥
16
Dist(k,
F
r
(KCrit
))
≤
|k
−
Avg(F
r
(KCrit
))|
≤
|k|
+
12
)
we
have:
!
k
+
λ

!
Dist(k,
F
r
(K
))
+
r
−
1
!
r
Crit
Ψ(k)−Ψ(k[r])
!
·
qsc
·
|qsc
|Ψ(k)−Ψ(k[d−1])
!
!≤
r
r
≤
2Dist(k,F
(KCrit
))+r−1
·
|qsc
|
16
·d·|k|
≤
2|k|+
2
+d−2
·
|qor
|
16
·|k|
r
1
1
1
≤
23·|k|
·
|qor
|
16
·|k|
≤
e3·|k|−
16
·Im(τor
)·|k|
≤
e|k|·(3−
8
·Im(τor
))
1
2π
π
Now
let
us
assume
that
def
π
C
=
8
·
Im(τor
)
−
3
≥
62
+
2
·
log(n)
d
Then
it
follows
that
!
k
+
λ

!
!
r
Ψ(k)−Ψ(k[r])
!
·
q
!
!
sc
r

||ζrCG,μ
−
ZCG
r
||
≤
k∈Z\(KCrit

≤
k∈Z\(KCrit
≤2·

KSemi
)
e−C·|k|
KSemi
)
e−C·k
k≥
12
d
≤
2
·
e−
2
C·d
·
(1
−
e−C
)−1
≤
4
·
e−
2
C·d
1
1
(since
C
≥
1
implies
eC
≥
e
≥
2,
so
(1
−
e−C
)−1
≤
2).
Thus,
since
12
C
≥
31
+
log(n)
d
,
we
have:
315
||ζ
μ
−
Z||
≤
d−1

|γr
|
·
||ζrCG,μ
−
ZCG
r
||
r=0
≤
d
·
(n
·
e30·d
)
·
(4
·
e−
2
C·d
)
1
1
≤
·
n
·
ed·(31−
2
C)
2
1
1
≤
·
n
·
e−log(n)
=
2
2
1
(where
we
use
that
d
≥
4
implies
8d
≤
ed
).
Thus,
since
||Z||
=
1,
we
obtain
1
3
1
·
||Z||
=
≤
||Z||
−
||Z
−
ζ
μ
||
≤
||ζ
μ
||
≤
||ζ
μ
−
Z||
+
||Z||
≤
≤
2
=
2
·
||Z||
2
2
2
This
is
the
desired
bound
on
||ζ
μ
||.
Thus,
we
have
proven
the
following
result,
which
is
the
main
result
of
the
present
§:
Theorem
5.8.
Suppose
that
d
≥
12,
and
Im(τor
)
≥
32
80
16
8
·
log2
(d)
+
·
n
·
log(d)
+
·
n
·
log(n)
+
·
65
π
π
π
π
def
d−1
−Ψ(k[r])
and
let
ζ
=
·
ζrCG
be
a
C-linear
combination
(i.e.,
the
γr
∈
C)
of
the
r=0
γr
·
qsc
−Ψ(k[r])
·
ζrCG
.
Let
us
write
qsc
||ζ||et
0
1
d−1
for
the
L2
(μd
)
norm
(i.e.,
the
norm
for
which
Usc
,
Usc
,
.
.
.
,
Usc
are
orthonormal)
of
the
−iχ
function
(Ucv
·
ζ)|μd
⊆(S1
)sc
.
Then
(1)
If
the
|γr
|
≤
1
for
r
=
0,
.
.
.
,
d−1,
then
we
have:
||ζ||et
≤
2·d2
·e3d
≤
e4d
.
(2)
If
||ζ||et
≤
1,
then
the
|γr
|
≤
2n
·
e30·d
,
for
all
r
=
0,
.
.
.
,
d
−
1,
and
Semi
|γr
|
≤
2
·
e26·d
if
r
∈
/
RCrit
.
−Ψ(k[r])
In
particular,
if
we
orthonormalize
the
qsc
·
ζrCG
to
form
OC
ζ0OC
,
.
.
.
,
ζd−1
–
which
are
unique
if
we
stipulate
that
the
leading
coeﬃcient
of
ζrOC
(i.e.,
the
coeﬃcient
of
ζrCG
in
the
linear
combination
of
ζ0CG
,
.
.
.
,
ζrCG
that
forms
ζrOC
)
be
positive
–
then
the
316
coeﬃcients
of
the
ζrCG
in
each
ζrOC
have
absolute
value
≤
2n
·
e30d
,
and
the
absolute
values

of
the
leading
coeﬃcients
are
≥
e−4d
.
Proof.
One
checks
easily
that
the
hypothesis
of
Theorem
5.8
implies
both
the
hypothesis
of
Theorem
5.7,
as
well
as
the
assumption
π
2
·
Im(τor
)
−
3
≥
62
+
·
log(n)
8
d
made
above.
Then
(1),
(2)
follow
from
the
corresponding
assertions
of
Theorem
5.7,
together
with
the
inequalities
1
·
||Z||
≤
||ζ
μ
||
≤
2
·
||Z||
2
derived
above
(which
hold
even
if
||Z||
=
1).
The
assertions
concerning
the
ζrOC
follow
formally
from
(1),
(2)
(cf.
the
proof
of
Theorem
5.7).

Remark.
Thus,
stated
in
words,
Theorem
5.8
asserts
that:
If
Im(τor
)
is
suﬃciently
large
(roughly
≥
the
order
of
log2
(d),
when
n
is
held
ﬁxed),
then
up
to
a
factor
of
order
n
·
C
d
(for
some
constant
C),
−Ψ(k[r])
·
ζrCG
the
L2
-norm
on
the
complex
vector
space
generated
by
the
qsc
(for
r
=
0,
.
.
.
,
d
−
1)
is
the
same
as
the
norm
for
which
these
functions
−Ψ(k[r])
·
ζrCG
(for
r
=
0,
.
.
.
,
d
−
1)
are
orthonormal.
qsc
Note
that
the
factor
of
n
in
“n
·
C
d
”
is
precisely
the
archimedean
analogue
of
the
schemetheoretic
zero
locus
of
the
determinant
given
in
Chapter
VI,
Theorem
4.1,
(2)
(cf.
also
the
Remark
following
Lemma
4.4).
In
some
sense,
of
the
three
models
(Hermite,
Legendre,
and
Binomial)
discussed,
the
(full)
binomial
model
is
the
closest
archimedean
analogue
to
what
is
done
in
Chapter
VI
at
ﬁnite
primes.
Unfortunately,
however,
the
estimates
for
the
binomial
model
only
hold
when
the
elliptic
curve
in
question
is
fairly
close
to
inﬁnity.
This
degree
of
proximity,
i.e.,
log2
(d)
when
n
is
held
ﬁxed,
is
not
so
outrageously
large
in
the
sense
that,
roughly
speaking,
Im(τor
)
should
be
regarded
as
being
roughly
on
a
par
with
d
in
terms
of
size
(cf.
the
discussion
of
“natural
variables
over
F1
”
in
Remark
2
at
the
end
of
Chapter
VII,
§6).
Thus,
in
some
sense,
to
require
that
Im(τor
)
be
at
least
of
the
order
of
log2
(d)
is
a
“logarithmically
weak”
requirement
on
the
proximity
to
inﬁnity.
317
§6.
Relations
Among
Various
Norms
and
Zeta
Functions
In
this
§,
we
prepare
for
the
discussion
of
the
Hodge-Arakelov
Comparison
Isomorphism
in
§7
below
by
relating
the
material
of
§1
through
5
of
the
present
Chapter
to
the
theory
of
§4
through
6
of
Chapter
VII.
That
is
to
say,
throughout
Chapter
VII
and
the
present
Chapter,
various
canonical
norms
on
function
spaces,
as
well
as
various
canonical
zeta
functions
were
introduced.
The
reason
that
so
many
such
objects
were
introduced
was
because
each
one
relates
to
a
certain
piece
of
the
fundamental
problem
of
relating
the
natural
metrics
on
the
function
spaces
of
“de
Rham
functions”
and
“étale
functions”
to
one
another
(cf.
the
Introduction
to
Chapter
VII).
Thus,
the
purpose
of
the
present
§
is
to
explain
how
to
put
these
pieces
together.
We
continue
with
the
notation
of
§5.
In
addition,
we
suppose
for
simplicity
that
d
≥
25
Let
us
review
the
situation
that
we
are
in.
First
of
all,
we
have
our
“original”
elliptic
def
def
Z
Z
,
together
with
our
“scaled”
elliptic
curve
Esc
=
(Gm
)sc
/qsc
,
curve
Eor
=
(Gm
)or
/qor
2πiτor
2πiτsc
where
qor
=
e
,
qsc
=
e
,
τor
=
d
·
τsc
,
and
(Gm
)or
=
(Gm
)sc
.
Thus,
we
may
think
of
Esc
as
a
quotient
Z
Z
Eor
=
(Gm
)or
/qor
→
Esc
=
(Gm
)sc
/qsc
def
def
of
Eor
.
The
pull-back
morphism
on
diﬀerentials
thus
induces
a
natural
isomorphism
ιdiﬀ
:
ωEor
∼
=
ωEsc
Note
that
this
quotient
map
extends
to
a
push-forward
morphism
on
the
universal
extensions
of
Eor
,
Esc
:
0
−→
ωEor
−→
⏐
⏐d·ι

diff
†
Eor
⏐
⏐

0
−→
−→
†
Esc
ωEsc
−→
Eor
⏐
⏐

−→
0
−→
Esc
−→
0
One
checks
easily
that
the
push-forward
morphism
induces
the
map
d
·
ιdiﬀ
on
ωEor
=
∨
(respectively,
ωEsc
.
In
the
following
discussion,
we
would
like
to
think
of
τEor
=
ωE
or
∨
τEsc
=
ωE
)
as
the
space
of
(linear)
functions
on
the
ω
(respectively,
ω
Eor
Esc
)
portion
sc
†
†
of
Eor
(respectively,
Esc
).
From
this
“function-theoretic”
point
of
view,
we
obtain
an
isomorphism
ιfunc
:
τEsc
→
τEor
318
def
where
ιfunc
=
(d
·
ιdiﬀ
)∨
.
Next,
we
would
like
to
consider
various
trivializations
of
τEor
,
τEsc
.
If
we
think
of
Esc
as
the
elliptic
curve
“E”
of
Chapter
VII,
§4,5,
then
we
have
the
trivialization
“θ
∨
”
(cf.
Chapter
VII,
§4,5)
of
τEsc
,
which
is
determined
up
to
multiplication
by
an
element
∈
S1
⊆
C×
by
the
property
that
its
norm
with
respect
to
the
metric
“||
∼
||τ
”
of
Chapter
VII,
§4,
is
1.
Let
us
denote
this
trivialization
by
ΘDR,sc
.
Put
another
way,
if
we
regard
Esc
as
the
“E”
of
Chapter
VII,
§4,5,
then
ΘDR,sc
may
be
identiﬁed
with
the
exterior
derivative
of
the
function
“TDR
”
on
Chapter
VII,
§4,5.
Similarly,
we
have
a
metric
“||
∼
||τ
”
(as
in
Chapter
VII,
§4)
on
τEor
which
gives
rise
to
a
trivialization
ΘDR,or
of
τEor
whose
norm
is
1
and
which
may
be
normalized
by
requiring
that
it
be
a
positive
multiple
of
ΘDR,sc
∈
τEsc
∼
=
τEor
(where
“∼
=”
is
either
ι∨
diﬀ
or
ιfunc
–
both
give
the
same
result
since
they
diﬀer
by
a
positive
multiple).
Since
the
metric
“||
∼
||τ
”
of
Chapter
VII,
§4,
is
deﬁned
by
integration,
and
integrating
the
pull-back
to
Eor
of
a
(1,
1)-form
on
Esc
diﬀers
by
a
factor
1
∨
of
d
from
integrating
the
form
on
Esc
,
we
thus
obtain
that
d
2
·(ΘDR,or
)∨
=
ι−1
diﬀ
((ΘDR,sc
)
),
1
which
implies
(by
taking
the
dual)
d−
2
·
ΘDR,or
=
ι∨
diﬀ
(ΘDR,sc
),
hence
(by
multiplying
by
1
d
2
):
ΘDR,or
=
d−
2
·
ιfunc
(ΘDR,sc
)
1
∂
On
the
other
hand,
in
Chapter
VII,
§5,
we
also
considered
the
trivialization
“
∂log(U
)”
(where
U
is
the
standard
coordinate
on
Gm
),
which
gave
rise
to
the
function
“TSW
”
of
Chapter
VII,
§5.
Let
us
write
ΘSW,sc
(respectively,
ΘSW,or
)
for
the
trivialization
of
ωEsc
∂
∂
(respectively,
ωor
)
deﬁned
by
∂log(U
(respectively,
∂log(U
).
If
we
think
of
the
elliptic
sc
)
or
)
curve
“E”
of
Chapter
VII,
§5,
as
being
Esc
,
then
one
may
also
think
of
ΘSW,sc
as
the
exterior
derivative
of
the
function
“TSW
”
of
Chapter
VII,
§5.
In
particular,
it
follows
from
Chapter
VII,
Lemma
5.2,
that
ΘDR,sc
=
{8π
2
Im(τsc
)}
2
·
ΘSW,sc
=
d−
2
·
Cor
·
ΘSW,sc
1
def
1
1
where
Cor
=
{8π
2
·
Im(τor
)}
2
.
Similarly,
ΘDR,or
=
Cor
·
ΘSW,or
Remark.
One
convenient
way
to
keep
track
of
the
various
trivializations
introduced
above
is
†
to
think
of
them
as
functions
on
the
“ωEor
(respectively,
ωEsc
)
portion”
of
Eor
(respectively,
†
†
†
Esc
),
hence
as
linear
functions
(well-deﬁned
up
to
some
constant
term,
since
Eor
,
Esc
are
†
†
torsors)
on
the
d-torsion
points
of
Eor
(which
map
to
the
d-torsion
points
of
Esc
).
From
this
point
of
view,
we
see
that
(if
we
neglect
the
constant
term,
then)
ΘSW,or
(respectively,
ΘSW,sc
)
takes
values
∈
d1
·
Z
(respectively,
∈
Z)
on
the
d-torsion
points
(cf.
Chapter
III,
†
Corollary
5.9)
of
Eor
.
Thus,
in
summary,
the
values
taken
(if
we
neglect
the
constant
term)
†
by
these
functions
(trivializations)
on
the
d-torsion
of
Eor
are
given
by:
319
ΘSW,sc
:
∈
Z
ΘDR,sc
:
∈
Cor
1
·
Z
d2
Cor
ΘDR,or
:
∈
d
·
Z
ΘSW,or
:
∈
d1
·
Z
1
As
we
will
see
in
the
following
discussion,
these
factors
of
d,
d
2
that
occur
are
related
to
various
scaling
issues,
of
the
sort
discussed
at
the
end
of
Chapter
VII,
§3.
Next,
we
would
like
to
apply
the
theory
of
Chapter
VII,
§5,
relating
the
de
Rham
and
Schottky-Weierstrass
canonical
zeta
functions
in
the
case
where
the
elliptic
curve
“E”
(of
Chapter
VII,
§5)
is
Esc
.
First,
let
us
write
(S1
)sc
⊆
(Gm
)sc
for
the
copy
of
(S1
)sc
in
(Gm
)sc
.
Note
that
(S1
)sc
also
injects
into
Esc
via
the
projection
(Gm
)sc
→
Esc
.
Moreover,
†
(S1
)sc
⊆
Esc
lifts
naturally
(and
uniquely!)
to
a
closed
subgroup
(S1
)sc
⊆
Esc
.
Thus,
†
we
may
restrict
the
relations
of
Chapter
VII,
Theorem
5.3,
to
(S1
)sc
⊆
Esc
.
Note
that
†
the
functions
“TSW
”
and
“TDR
”
of
Chapter
VII,
§5,
are
zero
on
(S1
)sc
⊆
Esc
.
(This
†
follows
since
the
canonical
sections
of
Esc
→
Esc
used
to
deﬁne
“TSW
”
and
“TDR
”
are
†
continuous
homomorphisms,
hence
map
(S1
)sc
⊆
Esc
into
(S1
)sc
⊆
Esc
.)
Also,
note
that
although
the
theory
of
Chapter
VII,
§5,
was
only
given
in
the
case
of
a
trivial
character
χ,
it
generalizes
immediately
to
the
case
of
an
arbitrary
character
χ
(cf.
Chapter
IV,
§3,
especially
Theorems
3.2,
3.3),
for
instance,
by
“transport
of
structure”
relative
to
the
automorphism
of
“E”
given
by
translating
by
an
appropriate
torsion
point
(cf.
the
discussion
immediately
preceding
Chapter
VII,
Theorem
6.7).
Thus,
by
Chapter
VII,
Theorem
5.3,
we
obtain
(for
r
∈
Z≥0
):
ζrSS
|(S1
)sc
=
[r/2]

(π
·
u)m
r!
PD
r!
DR
1
·
ζr−2m
·
ζr
|(S
)sc
=
r
|(S1
)sc
r
·
r
2
d
m!
Cor
·
d
m=0
(where
ζrSS
is
as
in
Chapter
VII,
§6).
Thus,
in
particular,
if
we
think
of
ζrSS
as
a
section
†
of
the
line
bundle
Lχsc
on
Esc
corresponding
to
χ
(cf.
Chapter
VII,
§6)
over
Esc
,
then
the
leading
term
of
ζrSS
,
i.e.,
the
image
of
ζrSS
in
(F
r+1
/F
r
)(R
†
)
⊗OEsc
Lχsc
,
is
equal
to
a
unimodular
multiple
(i.e.,
S1
⊆
C×
-multiple)
of
Esc
1
1
⊗r
⊗r
·
Θ⊗r
r
·
ΘDR,sc
=
DR,or
=
ΘSW,or
r
r
·
d2
Cor
Cor
while
the
norm
of
ζrSS
with
respect
to
the
metric
“||
∼
||L2DR
”
of
Chapter
VII,
§4,5,
which
we
denote
here
by
||
∼
||DR,sc
,
satisﬁes
(by
Chapter
VII,
Corollary
5.4,
and
the
fact
that
1
1
dr
≤
r!
):
e
||ζrSS
||DR,sc
≤
||ζ0SS
||DR,sc
·
π
r!
·

8π
·
r
·
d

r2
Im(τor
)
320
=
||ζ0SS
||DR,sc
·
eπ
·

8π
23
r
(r
·
d)
r2
·
Cor
r!
Finally,
by
Chapter
VII,
Lemma
6.5
(where
we
take
“P
(−)”
to
be
1,
and
change
the
def
1
2
variable
of
integration
from
“k”
to
x
=
{
2π
d
·
Im(τor
)}
·
k),
we
have:
||ζ0SS
||2DR,sc
=
e
d
·Im(τor
)·(iχ
/n)
·
2
2π
=e
2
8π
2
4πd
·Im(τor
)·(iχ
/n)


12
4π
·
d
8π
2
·
Im(τor
)
e−x
dx
2
R
−1
2
2
·
(4π
·
d)
·
Cor
·
π
=
2π
·
(d/Cor
)
·e
1
2
1
2
1
(Cor
·iχ
/n)2
8πd
(r
·
d)
2
·
(50/Cor
)
·
r!
(Cor
·iχ
/n)2
4πd
Thus:
2
14
)
·e
||ζrSS
||DR,sc
≤
100
·
(d/Cor
r
r
In
the
following
discussion,
we
would
like
to
think
of
the
metric
||
∼
||DR,sc
,
as
well
as
the
metrics
||
∼
||Tch
;
||
∼
||w,μa
of
§2,
as
being
metrics
on
the
space
Γ(Esc
,
Lχsc
⊗OEsc
R
†
),
Esc
which
we
think
of
as
the
subspace
Γ(Esc
,
Lχsc
⊗OEsc
R
†
)
→
L2
((S1
)sc
)
Esc
i
(where
the
map
“→”
is
obtained
by
dividing
by
the
trivialization
“Ucvχ
·
θ
m
”)
generated
by
ζ0SS
,
.
.
.
,
ζrSS
,
.
.
.
(i.e.,
ζ0SS
and
its
derivatives).
On
the
other
hand,
let
us
write
||
∼
||SS
for
the
metric
on
Γ(Esc
,
Lχsc
⊗OEsc
R
†
)
for
which
the
ζrSS
are
orthonormal.
Then
by
Chapter
VII,
Theorem
5.3,
we
have:

d
12
r
Cor

[r/2]
·
ζrDR
|(S1
)sc
=
dr−m
·
(−π
·
u)m
SS
·
ζr−2m
|(S1
)sc
2m
·
m!
·
(r
−
2m)!
C
or
m=0
which
shows
that
(for
r
<
d)

d
12
r
Cor

[r/2]
·
||ζrDR
||SS
≤
e3d
·
πm
2
≤
e3d
·
r
·
{1
+
(π/Cor
)}r
2m
Cor
m=0
(where
we
use
that


dr−m
r−m
dr−m
dr−m
≤
·
≤
2r
·
m
m!(r
−
2m)!
(r
−
m)!
(r
−
m)!
r−m
d
≤
e2r+d
≤
e3d
≤
e2r
·
(r
−
m)r−m
321
Esc
by
Chapter
VII,
Lemmas
3.5,
3.6).
Since,
by
Chapter
VII,
Corollary
4.6,
Lemma
6.5,
we
have:
||ζrDR
||DR,sc
≥

(2π)r

12
r!
·
||ζ0DR
||DR,sc
=

(2π)r

12
r!
·e
(Cor
·iχ
/n)2
8πd
1
1
2
4
·
(2π)
2
·
(d/Cor
)
we
obtain:
(Cor
·iχ
/n)2
8πd
1
1
1
(r!)
2
2
r+
2
·
r
·
{1
+
(π/C
2
)}r
·
e3d
·
r
·
(Cor
/d
)
or
(2π)
2
1/2

−1
r
(C
·iχ
/n)2
r
·
Cor
−
or8πd
−r
12
Cor
+
π
·
Cor
≤e
·
(r!
·
d
)
·
·
e3d
1
1
(2π)
2
d4
DR
−
||ζrDR
||−1
DR,sc
·
||ζr
||SS
≤
e
Thus,
in
summary:
Lemma
6.1.
For
r
≤
d,
the
metrics
||
∼
||DR,sc
,
||
∼
||SS
on
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))
Esc
satisfy:
e
(Cor
·iχ
/n)2
−3d
8πd

r
3
(2π)
2
1/2
−1
·
(d
/r!)
·
·
(d
4
·
r
·
Cor
)
·
||
∼
||SS
≤
||
∼
||DR,sc
−1
Cor
+
π
·
Cor
r
(Cor
·iχ
/n)2
(r
·
d)
2
2
14
·
(50/Cor
)r
·
100
·
(d5
/Cor
≤
e
8πd
·
)
·
||
∼
||SS
r!
r
1
2
1
Proof.
This
follows
immediately
from
the
above
inequalities:
Indeed,
if
||φ||SS
≤
1
(where
φ
∈
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))),
then
φ
may
be
written
as
a
linear
combination
of
the
Esc
SS
ζr
with
complex
coeﬃcients
≤
1.
Thus,
||φ||DR,sc
may
be
bounded
using
the
bound
for
||ζrSS
||DR,sc
obtain
above.
Similarly,
if
||φ||DR,sc
≤
1,
then
φ
may
be
written
as
a
linear
DR
combination
of
the
||ζrDR
||−1
with
complex
coeﬃcients
≤
1.
Thus,
||φ||SS
may
be
DR,sc
·
ζr
DR
−1
bounded
using
the
bound
for
||ζr
||DR,sc
·
||ζrSS
||SS
obtain
above.

Remark.
Note
that
(for
r
≤
d),
we
have:
(dr
/r!)
2
·
d−2
·
e−3d
≥
e−4d
1
r
r
r
d
(r
·
d)
2
er
·
(r
·
d)
2
·
d2
≤
·
d2
≤
er
·
(d/r)
2
·
d2
≤
er
·
d2
·
e
2
≤
e2d
r
r!
r
322
d
(cf.
Chapter
VII,
Lemmas
3.5,
3.6),
where
we
use
that
d2
≤
e
2
since
d
≥
10.
It
thus
follows
that:
If
τor
is
restricted
to
vary
in
a
compact
subset
of
the
upper
half-plane,
then
||
∼
||SS
and
||
∼
||DR,sc
diﬀer
from
each
other
by
a
factor
≤
constant
·
e4d
.
In
fact,
even
if
τor
is
not
restricted
to
vary
inside
a
compact
set,
the
“constant”
in
this
statement
is
bounded
by
(some
absolute
constant)d
times
e
in
particular,
that:
(Cor
·iχ
/n)2
8πd
−1
d
·
(Cor
+
Cor
)
.
Note,
Despite
the
fact
that
the
“leading
term”
of
ζrSS
(cf.
the
above
discussion)
⊗r
SS
goes
like
C1r
·
Θ⊗r
DR,or
=
ΘSW,or
,
the
absolute
value
of
ζr
with
respect
or
to
||
∼
||DR,sc
(a
norm
which
is
based
on
a
ΘDR,sc
-type
scaling
of
R
†
,
Esc
not
a
ΘDR,or
-type
scaling!)
goes
(at
least
for
compactly
varying
Im(τor
),
and
up
to
a
factor
of
constant
·
e4d
)
like
≈
1.
r
This
discrepancy
of
roughly
a
factor
d
2
(when
Im(τor
)
varies
compactly)
in
the
portion
1
of
torsorial
degree
r,
i.e.,
a
scaling
factor
of
d
2
,
is
the
phenomenon
of
analytic
torsion
–
1
r
cf.
Remark
1
following
Chapter
VII,
Corollary
4.6,
which
concerns
a
factor
of
(r!)
2
≈
d
2
(as
r
→
d)
in
the
portion
of
torsorial
degree
r.
This
analytic
torsion
may
be
regarded
as
1
the
analogue
at
the
inﬁnite
prime
of
the
factors
of
r!
that
must
be
added
to
the
integral
structure
of
the
portion
of
torsorial
degree
r
in
the
ﬁnite
prime
case
(cf.,
e.g.,
Chapter
V,
Theorem
3.1).
Next,
we
would
like
to
recall
from
§2
the
relationship
between
||
∼
||SS
and
||
∼
||Tch
.
First,
let
us
recall
from
the
ﬁrst
part
of
the
proof
of
Lemma
2.1
that
if
||φ||Tch
=
1
(for
φ
∈
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
)),
r
≤
d),
then
φ
may
be
written
as
a
linear
combination
of
Esc
the
ζrSS

(where
r
<
r)
with
complex
coeﬃcients
of
absolute
value
7
≤
r
2
·
e4r
Thus,
we
conclude
that
on
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))
(where
r
≤
d),
we
have:
Esc
9
||
∼
||SS
≤
r
2
·
e4r
·
||
∼
||Tch
On
the
other
hand,
from
the
deﬁnition
of
||
∼
||Tch
,
we
have
1
||ζrSS
||2Tch
=
·
d
d−1
!
!2r

!
!
!(j/d)
−
ld
!
j=0
d−1
1

≤
·
1=1
d
j=0
323
where
ld
is
as
in
§2,
hence
satisﬁes
0
≤
ld
≤
12
.
Thus,
on
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))
(where
Esc
r
≤
d),
we
have:
||
∼
||Tch
≤
r
·
||
∼
||SS
We
summarize
this
as
follows:
For
r
≤
d,
the
metrics
||
∼
||Tch
,
||
∼
||SS
on
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))
Lemma
6.2.
Esc
satisfy:
r
−1
·
||
∼
||Tch
≤
||
∼
||SS
≤
r
2
·
e4r
·
||
∼
||Tch
9
while
the
metrics
||
∼
||Tch
,
||
∼
||DR,sc
on
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))
satisfy:
Esc
e
(Cor
·iχ
/n)2
−3d
8πd
r
3
(2π)
2
1/2
−1
·
(d
/r!)
·
·
(d
4
·
r
2
·
Cor
)
·
||
∼
||Tch
−1
Cor
+
π
·
Cor
≤
||
∼
||DR,sc
r

1
2
1
≤e
(Cor
·iχ
/n)2
8πd
r
1
(r
·
d)
2
·
(e8
/Cor
)r
·
100
·
(d12
/Cor
)
2
·
||
∼
||Tch
·
r!
Finally,
the
metrics
||
∼
||w,μa
(cf.
§2),
||
∼
||DR,sc
on
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))
satisfy:
Esc
e
(Cor
·iχ
/n)2
−3d
8πd
1

r
(2π)
2
1/2
−1
·
(d8
·
Cor
)
·
||
∼
||w,μa
−1
4
2
e
·
a
·
(Cor
+
π
·
Cor
)
≤
||
∼
||DR,sc
·
(dr
/r!)
2
·
≤e
1
(Cor
·iχ
/n)2
8πd
r
1
(r
·
d)
2
·
·
(e8
/Cor
)r
·
200
·
(d12
/Cor
)
2
·
||
∼
||w,μa
r!
where
a
is
a
positive
integer
satisfying
a
≥
8
+
(
π4
·
Im(τor
))−1
.
Remark.
Thus,
stated
in
words,
the
above
Lemma
asserts
that:
When
Im(τor
)
varies
compactly,
||
∼
||DR,sc
and
||
∼
||w,μa
diﬀer
by
at
most
a
factor
of
(constant)d
.
Thus,
||
∼
||DR,sc
;
||
∼
||SS
;
||
∼
||Tch
;
||
∼
||w,μa
belong
to
“the
same
equivalence
class”
–
i.e.,
in
the
sense
that
when
Im(τor
)
varies
compactly,
they
diﬀer
by
at
most
a
factor
of
(constant)d
.
324
Similarly,
we
may
recall
the
relationship
between
||
∼
||SS
and
the
ζrCG
,
as
follows.
Let
us
write
||
∼
||CG
(respectively,
||
∼
||qCG
)
−Ψ(k[r])
for
the
metric
on
Γ(Esc
,
Lχsc
⊗OEsc
F
d
(R
†
))
for
which
the
ζrCG
(respectively,
qsc
Esc
·ζrCG
–
notation
of
§3,4,5),
where
r
=
0,
.
.
.
,
d
−
1,
are
orthonormal.
Recall
from
the
proof
of
Chapter
VII,
Lemma
6.2
(i.e.,
in
essence,
Chapter
VII,
Proposition
3.3),
that
ζrCG
is
a
linear
combination
of
ζ0SS
,
.
.
.
,
ζrSS
with
complex
coeﬃcients
of
absolute
value
≤
e2r+d
.
Thus,
||ζrCG
||SS
≤
(r
+
1)
·
e3d
In
particular,
on
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))
(where
r
≤
d),
we
have:
Esc
||
∼
||SS
≤
r
2
·
e3d
·
||
∼
||CG
On
the
other
hand,
if
we
consider
a
linear
combination
of
ζ0CG
,
.
.
.
,
ζrCG
whose
||
∼
||Tch
=
d−1
,
then
we
see
that
the
issue
of
bounding
the
coeﬃcients
of
such
a
linear
combination
is
exactly
the
same
as
the
situation
considered
in
§3,
except
with
|qsc
|
=
1.
(Indeed,
note
that
if
we
set
|qsc
|
=
1,
then
in
the
context
of
§3,
||
∼
||Tch
=
d−1
means
that
the
usual
L2
((S1
)sc
)-norm
of
the
corresponding
linear
combination
of
Z0CG
,
.
.
.
,
ZrCG
is
=
1.)
Thus,
by
specializing
what
we
did
in
§3
to
the
case
where
|qsc
|
=
1,
we
see
that
the
coeﬃcients
of
this
linear
combination
are
bounded
by
a
sum
of
4r
terms,
each
of
which
has
absolute
value
≤
r
2r
(cf.
the
bounding
of
the
“binomial
coeﬃcient
portion
of
the
C[r,
r1
]
·
C[r1
,
r2
]
·
.
.
.
·
C[rj−1
,
rj
]”
in
§3).
Thus,
the
coeﬃcients
of
the
linear
combination
under
consideration
have
absolute
value
≤
4r
·
r
2r
.
In
particular,
we
obtain
that
on
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))
(where
r
≤
d),
we
have:
Esc
||
∼
||CG
≤
r
·
4r
·
r
2r
·
d
·
||
∼
||Tch
Finally,
the
leading
term
of
ζrCG
is
equal
to
the
leading
term
of
ζrPD
.
That
is,
in
summary:
Lemma
6.3.
For
r
≤
d,
the
metrics
||
∼
||CG
,
||
∼
||SS
on
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))
Esc
satisfy:
d−1
·
4−r
·
r
−2r−2
·
||
∼
||CG
≤
||
∼
||SS
≤
r
2
·
e3d
·
||
∼
||CG
325
and
(for
0
≤
r
≤
d
−
1)
ζrCG
has
the
same
leading
term
(i.e.,
image
in
Γ(Esc
,
Lχsc
⊗OEsc
r
(F
r+1
/F
r
)(R
†
)))
as
dr!
·
ζrSS
.
On
the
other
hand,
(for
r
≤
d)
the
metrics
||
∼
||CG
,
Esc
||
∼
||DR,sc
on
Γ(Esc
,
Lχsc
⊗OEsc
F
r
(R
†
))
satisfy:
Esc
e
(Cor
·iχ
/n)2
−3d
8πd
·
(dr
/r!)
2
·
r
−2r−2
·
1

r
(2π)
2
1/2
−1
·
(d2
·
r
·
Cor
)
·
||
∼
||CG
−1
4(Cor
+
π
·
Cor
)
1
≤
||
∼
||DR,sc
≤e
r
1
(r
·
d)
2
·
(e7
/Cor
)d
·
100
·
(d7
/Cor
)
2
·
||
∼
||CG
·
r!
(Cor
·iχ
/n)2
8πd
and
(for
0
≤
r
≤
d
−
1)
ζrCG
has
the
same
leading
term
(i.e.,
image
in
Γ(Esc
,
Lχsc
⊗OEsc
r
(F
r+1
/F
r
)(R
†
)))
as
Cdr
2·r!
·
ζrDR
.
Esc
or
Remark.
Thus,
stated
in
words,
the
above
Lemma
asserts
that:
When
Im(τor
)
varies
compactly,
the
||ζrCG
||DR,sc
are
bounded
by
a
factor
of
(constant)d
,
but
if
one
expands
ζrCG
in
terms
of
an
orthonormal
basis
for
||
∼
||DR,sc
,
the
resulting
coeﬃcients
have
rather
large
absolute
values,
i.e.,
of
the
order
dconstant·d
.
Put
another
way,
whereas
||
∼
||DR,sc
;
||
∼
||SS
;
||
∼
||Tch
;
||
∼
||w,μa
belong
to
“the
same
equivalence
class”
–
i.e.,
in
the
sense
that
when
Im(τor
)
varies
compactly,
they
diﬀer
by
at
most
a
factor
of
(constant)d
–
the
metric
||
∼
||CG
lies
outside
this
equivalence
class.
That
is
to
say,
it
is
bounded
below
by
metrics
in
this
equivalence
class,
but
not
above.
Moreover,
this
obstruction
to
bounding
it
above
by
metrics
in
the
said
equivalence
class
arises
not
from
letting
the
elliptic
curve
in
question
degenerate,
but
from
the
combinatorial
portion
of
the
coeﬃcients
involved.
Finally,
we
consider
the
Hermite
model.
Let
us
write
||
∼
||HMd
for
the
metric
on
Γ(Esc
,
Lχsc
⊗OEsc
F
d
(R
†
))
for
which
Esc
||P
(δ
∗
)
·
ζ0
||2HMd
=
def
def
R
!
!2
2
1
!
!
!P
(s)!
·
e−
2
(s/γd
)
·
ds
1
HMd
where
γd
=
{d/4π·Im(τor
)}
2
(as
in
Chapter
VII,
Theorem
6.7).
Thus,
the
ζ0HMd
,
.
.
.
,
ζd−1
(of
Chapter
VII,
Theorem
6.7)
are
orthogonal
for
||
∼
||HMd
,
and
γd−1
·
||ζrHMd
||2HMd
=
326
1
(2π)
2
·
r!.
Recall
that
the
ζrHMd
are
the
canonical
zeta
functions
associated
to
the
(scaled)
Hermite
polynomials
Hr
(s/γd
)
where
Hr
(−)
is
as
in
Chapter
VII,
Proposition
2.2.
Let
us
write
||
∼
||R,sc
for
the
metric
on
Γ(Esc
,
Lχsc
⊗OEsc
F
d
(R
†
))
denoted
by
||
∼
||L2
(Esc
)
in
Chapter
VII,
§6,
Esc
and
by
||
∼
||L2R
in
Chapter
VII,
§4.
Note
that
2
2π
||ζ0SS
||2R,sc
=
||ζ0SS
||2DR,sc
=
e
d
·Im(τor
)·(iχ
/n)
·


12
1
d
(2π)
2
4π
·
Im(τor
)
2
=
(2π)
2
·
γd
·
e
d
·Im(τor
)·(iχ
/n)
1
2π
(cf.
the
discussion
preceding
Lemma
6.1),
and
!!

!!
!!
2
1
2π
r!

DR
!!!!2
·
ζr
!!
=
r!
·
||ζ0DR
||2R,sc
=
(2π)
2
·
r!
·
γd
·
e
d
·Im(τor
)·(iχ
/n)
r
R,sc
(2π)
2
(cf.
Chapter
VII,
Theorem
4.5).
Now,
if
we
write
||ζ||et
0
1
d−1
(as
in
Theorem
5.8)
for
the
L2
(μd
)
norm
(i.e.,
the
norm
for
which
Usc
,
Usc
,
.
.
.
,
Usc
−iχ
are
orthonormal)
of
the
function
(Ucv
·
ζ)|μd
⊆(S1
)sc
,
then
we
obtain
from
Chapter
VII,
Theorem
6.7,
that:
Lemma
6.4.
If
we
ﬁx
a
nonnegative
integer
r
≤
d
and
let
d
→
∞,
then
on
χ
r
Γ(Esc
,
Lsc
⊗OEsc
F
(R
†
)),
we
have:
Esc
−1
lim
γd
2
·
||
∼
||et
=
d→∞
−1
lim
γd
2
·
||
∼
||HMd
=
d→∞
−1
lim
γd
2
·
||
∼
||R,sc
d→∞
(where
all
three
sides
are
ﬁnite)
and
||
∼
||R,sc
≤
||
∼
||DR,sc
≤
eπ+r
·
||
∼
||R,sc
.
327
Proof.
Note
that
the
inequalities
relating
||
∼
||R,sc
and
||
∼
||DR,sc
result
from
Chapter
VII,
Corollary
4.6
(for
ρ
=
1).

§7.
The
Comparison
Isomorphism
at
the
Inﬁnite
Prime
In
this
§,
we
complete
the
proof
of
a
theorem,
which
is
the
main
theorem
of
this
paper,
concerning
the
behavior
of
the
comparison
isomorphism
of
Chapter
VI,
Theorem
3.1,
at
all
the
primes
of
a
number
ﬁeld.
The
behavior
of
this
comparison
isomorphism
at
ﬁnite
primes
is
discussed
in
Chapter
VI,
Theorem
4.1;
the
behavior
of
this
comparison
isomorphism
at
archimedean
primes
is
the
general
topic
of
Chapter
VII
and
the
present
Chapter.
We
refer
to
the
result
which
encompasses
integrality
issues
at
all
primes
of
a
number
ﬁeld
as
the
Hodge-Arakelov
Comparison
Isomorphism
(cf.
the
Introduction
to
this
Chapter).
In
the
present
§,
we
complete
the
archimedean
portion
of
this
result,
which
consists
of
showing
that
the
natural
metrics
on
the
function
spaces
of
“de
Rham
functions”
and
“étale
functions”
are
close
to
one
another
in
three
senses.
These
three
senses
correspond,
respectively,
to
the
Hermite,
Legendre,
and
Binomial
Models
treated
in
Chapter
VII
and
the
present
Chapter.
def
We
continue
with
the
notation
of
§5.
Write
Lχor
=
Lχsc
|Eor
.
Thus,
Lχor
is
a
line
bundle
of
degree
d
on
Eor
.
Let
def
G
=
GLχor
be
the
theta
group
associated
to
this
line
bundle
(cf.
Chapter
IV,
§1).
Let
us
write
GS1
⊆
G
for
the
maximal
compact
subgroup.
Thus,
we
have
an
exact
sequence
0
→
S1
→
GS1
→
KLχor
→
0
Note
that
the
kernel
of
Eor
→
Esc
,
together
with
the
line
bundle
Lχsc
,
deﬁne
a
Lagrangian
subgroup
(cf.
Chapter
IV,
the
Remark
following
Theorem
1.4)
H
⊆
G.
Suppose
that
V
is
an
irreducible
C[G]-module
(such
that
Gm
⊆
G
acts
on
V
in
the
usual
fashion).
Thus,
V
is
a
d-dimensional
complex
vector
space,
and
the
subspace
of
H-invariants
V
H
⊆
V
is
a
1-dimensional
complex
subspace.
Let
v
⊆
V
H
be
nonzero.
Lemma
7.1.
There
exists
a
unique
GS1
-invariant
Hermitian
metric
(−,
−)
on
V
such
that
(v,
v)
=
1.
328
Proof.
Write
KH
⊆
KLχor
for
the
image
of
H
in
KLχor
.
Let
H
⊆
G
be
a
ﬁnite
cyclic
subgroup
of
order
d
with
the
property
that
the
image
KH

of
H
in
KLχor
is
such
that
KLχor
=
KH
×
KH

.
(It
is
not
diﬃcult
to
see
that
such
an
H
always
exists
–
cf.,
e.g.,
Chapter
IV,
Example
1.2).
Since
V
is
irreducible,
it
follows
(cf.
Chapter
IV,
Example
1.2)
that
V
=

C
·
g(v)
g∈H

def
def
For
g,
g
∈
H
such
that
g
=
g
,
deﬁne
(g(v),
g(v))
=
1,
(g(v),
g
(v))
=
0.
This
gives
us
a
well-deﬁned
metric
(−,
−)
on
V
.
On
checks
easily
that
this
metric
is
H
-invariant.
Because
of
the
well-known
structure
of
G,
(cf.
Chapter
IV,
§1),
it
follows
that
if
g
∈
H,
g
∈
H
,
then
g(g
(v))
=
λ
·
g
(g(v))
=
λ
·
g
(v),
where
λ
∈
S1
⊆
C×
.
Thus,
it
is
clear
that
H
also
preserves
this
metric.
Thus,
it
follows
that
this
metric
is
GS1
-invariant.
Uniqueness
follows
from
the
fact
that
V
is
irreducible
as
an
GS1
-module.

Lemma
7.2.
Let
{M
;
(−,
−)M
}
be
a
pair
consisting
of
a
GS1
-module
M
and
a
GS1
invariant
metric
(−,
−)M
on
M
.
Then
the
correspondence
def
{M
;
(−,
−)M
}
→
{M
H
;
(−,
−)M
H
=
(−,
−)M
|M
H
}
given
by
taking
H-invariants
is
an
equivalence
of
categories
(cf.
Chapter
IV,
Theorem
1.4)
between
the
category
of
ﬁnite
dimensional
(i.e.,
over
C)
C[GS1
]-modules
equipped
with
GS1
invariant
Hermitian
metrics
and
the
category
of
ﬁnite
dimensional
complex
vector
spaces
equipped
with
Hermitian
metrics.
Proof.
Indeed,
the
functor
“→”
is
clearly
well-deﬁned.
If
{N
;
(−,
−)N
}
is
a
ﬁnite
dimensional
complex
vector
space
equipped
with
a
Hermitian
metric,
and
{V
;
(−,
−)V
}
is
a
C[GS1
]-module
as
in
Lemma
7.1
equipped
with
the
metric
of
Lemma
7.1
(relative
to
some
v
∈
V
H
),
then
N
⊗C
V
admits
a
natural
structure
of
GS1
-module
(where
g
∈
GS1
acts
by
g(α
⊗
β)
=
α
⊗
g(β),
for
α
∈
N
,
β
∈
V
),
as
well
as
a
natural
metric
(obtained
by
tensoring
(−,
−)N
with
(−,
−)V
),
which
is
clearly
GS1
-invariant.
Moreover,
it
is
clear
that
“→”
associates
{N
⊗
V
;
(−,
−)N
⊗V
}
to
the
pair
{N
;
(−,
−)N
}.
Since
maps
between
“{N
;
(−,
−)N
}’s”
clearly
induce
maps
between
“{N
⊗
V
;
(−,
−)N
⊗V
}’s,”
we
thus
see
that
the
functor
“→”
is
full
and
essentially
surjective.
Faithfulness
follows
from
Chapter
IV,
Theorem
1.4.

Thus,
applying
Lemma
7.2
shows
that
the
various
metrics:
||
∼
||DR,sc
;
||
∼
||R,sc
;
329
||
∼
||SS
;
||
∼
||Tch
||
∼
||w,μa
;
||
∼
||et
;
||
∼
||CG
;
||
∼
||qCG
on
the
space
Γ(Esc
,
Lχsc
⊗OEsc
F
d
(R
†
))
that
we
discussed
in
§5,
6
naturally
deﬁne
metrics
Esc
on
the
space
Γ(Eor
,
Lχor
⊗OEsc
F
d
(R
†
)).
(By
abuse
of
notation)
we
shall
denote
the
Esc
resulting
metrics
on
Γ(Eor
,
Lχor
⊗OEsc
F
d
(R
†
))
by
the
same
names.
Esc
†
†
Note
that
the
morphism
Eor
→
Esc
considered
in
§6
deﬁnes
an
isomorphism
†
†
×
E
Eor,[d]
∼
=
Esc
Esc
or
†
(where
Eor,[d]
is
as
in
Chapter
V,
§2)
which,
if
we
identify
ωEor
with
ωEsc
via
ιdiﬀ
(cf.
†
the
discussion
at
the
beginning
of
§6),
induces
an
isometry
between
ωEor
⊆
Eor,[d]
and
†
ωEor
=
ωEsc
⊆
Esc
×Esc
Eor
–
i.e.,
both
may
be
identiﬁed
naturally
with
“d
times
the
ωEor
⊆
†
Eor
.”
Thus,
we
may
naturally
identify
Γ(Eor
,
Lχor
⊗OEsc
F
r
(R
†
))
with
Γ(Eor
,
Lχor
⊗OEor
Esc
F
r
(R
†
)).
Note,
moreover,
that
these
spaces
Γ(Eor
,
Lχor
⊗OEor
F
r
(R
†
))
are
exactly
Eor,[d]
Eor,[d]
the
spaces
the
appear
in
the
domain
of
the
evaluation
map
of
Chapter
VI,
Theorem
4.1,
(2)
(when
applied
to
Eor
).
def
Next,
let
us
consider
the
action
of
Z
on
H
=
{τ
∈
C
|
Im(τ
)
>
0}
deﬁned
by
letting
1
∈
Z
act
as
τ
→
τ
+
1.
Write
def
T∞
=
H/Z
def
for
the
quotient
of
H
by
this
action.
Thus,
the
function
q
=
exp(2πiτ
)
deﬁnes
a
biholomorphic
isomorphism
of
T∞
with
the
punctured
unit
disk
{z
∈
C
|
0
<
|z|
<
1}.
In
the
present
context,
we
would
like
to
think
of
T∞
as
a
covering
space
of
the
analytic
stack
an
M1,0
=
H/SL2
(Z)
(where
the
quotient
H/SL2
(Z)
is
the
quotient
of
H
by
the
standard
action
of
SL2
(Z)
in
the
sense
of
analytic
stacks).
Then
let
us
observe
that
as
the
moduli
of
Eor
vary
(i.e.,
where
take
“q”
in
the
preceding
paragraph
to
be
qor
),
the
metrics
deﬁned
above
all
descend
naturally
from
H
to
T∞
.
(Indeed,
this
follows
immediately
from
the
deﬁnitions.)
Moreover,
I
claim
that:
an
The
metrics
||
∼
||DR,sc
;
||
∼
||R,sc
;
||
∼
||et
descend
naturally
to
M1,0
.
Indeed,
||
∼
||R,sc
is
deﬁned
by
using
the
canonical
real
analytic
section
(κsc
)R
:
(Esc
)R
→
†
†
(Esc
)R
(which
deﬁnes
a
real
analytic
splitting
of
R
†
)
to
restrict
sections
of
Lχsc
over
Esc
Esc
330
to
sections
over
Lχsc
.
On
the
other
hand,
one
checks
easily
(for
instance,
by
considering
†
torsion
points)
that
the
canonical
real
analytic
splitting
(κor
)R
:
(Eor
)R
→
(Eor
)R
is
†
†
compatible
with
(κsc
)R
with
respect
to
the
natural
morphism
Eor
→
Esc
.
Moreover,
(κor
)R
an
manifestly
descends
from
H
to
M1,0
.
On
the
other
hand,
the
metric
with
translationinvariant
curvature
on
Lχsc
(that
was
used
in
Chapter
VII,
§4)
pulls
back
to
a
metric
with
translation-invariant
curvature
on
Lχor
.
Since
metrics
with
translation-invariant
curvature
are
unique
up
to
multiplication
by
a
positive
real
number,
we
thus
see
that
such
a
metric
an
descends
from
H
to
M1,0
.
Thus,
in
summary,
all
the
ingredients
used
to
deﬁne
||
∼
||R,sc
an
descend
naturally
to
M1,0
,
so
we
conclude
that
||
∼
||R,sc
itself
descends
naturally
to
an
M1,0
.
Similarly,
the
only
additional
object
used
to
deﬁne
||
∼
||DR,sc
is
the
metric
on
ωEsc
1
deﬁned
in
Chapter
VII,
§4,
but
this
metric
is
equal
to
d−
2
times
the
analogously
deﬁned
an
metric
on
ωEor
(which
manifestly
descends
to
M1,0
)
–
cf.
the
discussion
at
the
beginning
1
an
of
§6
involving
ΘDR,sc
=
d
2
·
ΘDR,or
.
Thus,
||
∼
||DR,sc
also
descends
naturally
to
M1,0
.
Finally,
the
metric
on
||
∼
||et
on
Γ(Eor
,
Lχor
⊗OEor
F
r
(R
†
))
is
clearly
equal
to
the
Eor,[d]
†
metric
obtained
as
follows:
Since
we
have
a
natural
inclusion
d
Eor
⊆
Eor,[d]
of
the
d-torsion
†
points
d
Eor
of
Eor
in
Eor,[d]
,
we
may
restrict
sections
s
∈
Γ(Eor
,
Lχor
⊗OEor
F
r
(R
†
))
to
Eor,[d]
χ
d
Eor
to
obtain
sections
s|d
Eor
∈
Lor
|d
Eor
.
Then
||s||2et
=

1
·
d2
|s(α)|2
α∈d
Eor
(where
|
∼
|
is
the
chosen
metric
on
Lχor
with
translation-invariant
curvature),
which
an
manifestly
descends
to
M1,0
.
This
completes
the
proof
of
the
claim.
Next,
we
pause
to
take
a
closer
look
at
the
metric
||
∼
||R,sc
on
Γ(Eor
,
Lχor
⊗OEor
F
r
(R
†
)).
Note
that
we
have
a
natural
surjection:
Eor,[d]
Γ(Eor
,
Lχor
⊗OEor
F
r+1
(R
†
Eor,[d]
))
→
Γ(Eor
,
Lχor
⊗OEor
(F
r+1
/F
r
)(R
†
))
Eor,[d]
=
(d
·
τEor
)r
⊗
Γ(Eor
,
Lχor
)
Moreover,
since
all
the
metrics
dealt
with
here
are
GS1
-invariant,
it
follows
that,
if
we
equip
d
·
τEor
with
its
natural
metric
(i.e.,
the
metric
for
which
ΘDR,or
has
norm
d−1
),
then
the
metric
induced
by
||
∼
||R,sc
on
(d
·
τEor
)r
⊗
Γ(Eor
,
Lχor
)
is
equal
to
some
constant
times
the
metric
induced
by
||
∼
||R,sc
on
Γ(Eor
,
Lχor
).
By
Chapter
VII,
Theorem
4.5,
it
follows
that

12

r
3r
.
Since
(d−1
·
ΘDR,or
/ΘDR,sc
)r
=
d−
2
,
this
constant
is
(d−1
·
ΘDR,or
/ΘDR,sc
)r
·
r!
·
(2π)
r!
we
thus
obtain:
331
Lemma
7.3.
We
have:
Metric
induced
by
||
∼
||R,sc
on
(d
·
τEor
)r
⊗
Γ(Eor
,
Lχor
)

(2π)r
·
r!

12
=
Metric
induced
by
·
||
∼
||R,sc
on
Γ(Eor
,
Lχor
)
d3r
Remark.
The
meaning
of
Lemma
7.3
is
the
following:
We
saw
in
Chapter
VI,
Theorem
4.1,
that
at
ﬁnite
primes,
the
necessary
modiﬁcation
to
the
integral
structure
of
the
space
“(d
·
τEor
)r
⊗
Γ(Eor
,
Lχor
)”
that
allows
one
to
obtain
an
exact
comparison
isomorphism
is
a
factor
of
(r!)−1
(cf.
Chapter
V,
Theorem
3.1).
Thus,
by
the
product
formula,
assuming
that
the
modiﬁcations
to
the
integral
structure
are
distributed
evenly
with
respect
to
r,
one
expects
that
the
modiﬁcation
to
the
integral
structure
to
“(d
·
τEor
)r
⊗
Γ(Eor
,
Lχor
)”
at
the
inﬁnite
primes
should
be
of
the
order
of
(r!)−1
≈
(d!)−1
(as
r
→
d)
(cf.
the
discussion
of
the
“Fundamental
Combinatorial
Model”
in
Chapter
VII,
§3,
especially
the
proof
of
Proposition
3.4).
On
the
other
hand,
Lemma
7.3
states
that
in
fact,
for
the
metric
||
∼
||R,sc
(hence
also
for
||
∼
||DR,sc
–
by
Lemma
6.4),
the
corresponding
modiﬁcation
to
the
integral
structure
is
roughly

(2π)r
·
r!

12
d3r
≈
(d−3r
·
r!)
2
≈
(d!)−1
1
(where
we
ignore
factors
of
the
order
(constant)d
)
as
r
→
d.
Moreover,
let
us
recall
that
these
“modiﬁcations
to
the
integral
structure”
are
also
known
as
analytic
torsion.
Thus,
in
summary:
Lemma
7.3
asserts
that
for
the
metrics
||
∼
||DR,sc
,
||
∼
||R,sc
,
the
resulting
analytic
torsion
at
the
inﬁnite
prime
is
roughly
the
same
as
the
analytic
torsion
that
one
would
expect
from
applying
the
product
formula
(of
elementary
number
theory)
to
the
analytic
torsion
at
the
ﬁnite
primes.
Put
another
way,
Lemma
7.3
is
the
analogue
for
general
smooth
elliptic
curves
of
Chapter
VII,
Proposition
3.4
(which,
in
eﬀect,
concerns
“degenerate
elliptic
curves”).
In
particular,
Lemma
7.3
leads
one
to
suspect
that:
The
metrics
||
∼
||DR,sc
,
||
∼
||R,sc
are
natural
(rough)
candidates
for
(at
least
the
“combinatorial”
or
“arithmetic”
portion
–
i.e.,
the
portion
that
does
not
arise
from
allowing
the
elliptic
curve
in
question
to
degenerate
–
of)
the
integral
structure
on
Γ(Eor
,
Lχor
⊗OEor
F
d
(R
†
Eor,[d]
332
))
arising
from
the
“étale
side”
of
the
comparison
isomorphism,
i.e.,
the
metric
||
∼
||et
.
The
extensive
calculations
of
Chapter
VII
and
the
present
Chapter
imply
that
this
intuitive
argument
based
on
the
product
formula
does,
in
fact,
give
the
right
answer:
Theorem
7.4.
def
E
=
Gm
/q
Z
(The
Comparison
Isomorphism
at
the
Inﬁnite
Prime)
Let
(where
q
=
exp(2πiτ
)
∈
T∞
)
be
an
elliptic
curve
over
C.
Let
d,
m
≥
1
be
def
integers
such
that
m
does
not
divide
d;
write
n
=
2m.
Let
def
L
=
OE
(d
·
[η])
†
where
η
∈
E
is
a
point
of
order
equal
to
m.
Write
E[d]
for
the
result
of
pushing
forward
the
universal
extension
E
†
→
E
of
E
by
the
map
ω
→
ω
given
by
multiplication
by
d.
E
E
Write
d
E
⊆
E
for
the
subscheme
of
d-torsion
points;
thus,
we
have
a
natural
inclusion
†
d
E
⊆
E[d]
.
Consider
the
Comparison
Isomorphism
Ξ
:
Γ(E,
L
⊗OE
F
d
(R
†
))
∼
=
L|d
E
E[d]
†
†
of
Chapter
VI,
Theorem
4.1
(given
by
restriction
sections
of
L
over
E[d]
to
d
E
⊆
E[d]
).
Choose
a
metric
|
∼
|L
on
L
whose
curvature
is
translation-invariant.
Let
us
regard
L|d
E
as
equipped
with
the
L2
-metric
deﬁned
by
|
∼
|L
,
i.e.:
def
||s||2
=
1

·
|s(α)|2
d2
α∈d
E
for
s
∈
L|d
E
.
Write
||
∼
||et
for
the
“étale
metric,”
i.e.,
the
metric
on
Γ(E,
L
⊗OE
F
d
(R
†
))
induced
by
this
L2
-metric.
On
the
other
hand,
the
canonical
real
analytic
E[d]
†
splitting
κR
:
ER
→
(E[d]
)R
(i.e.,
the
unique
continuous
section
which
is
a
group
homomorphism)
deﬁnes
a
metric
||
∼
||R
on
Γ(E,
L
⊗OE
F
d
(R
†
))
by
restricting
sections
of
E[d]
†
holomorphic
sections
of
L
over
E[d]
to
real
analytic
sections
of
L
over
E,
where
one
has
the
L2
-metric:
def
|κ∗R
(s)|2L
·
dμ
||s||2R
=
E
(where
s
∈
Γ(E,
L
⊗OE
F
(R
†
)),
and
dμ
is
the
unique
translation-invariant
(1,
1)-form
d
E[d]
†
whose
integral
is
1).
Finally,
the
section
κR
:
ER
→
(E[d]
)R
determines
a
real
analytic
direct
sum
decomposition

τE⊗r
⊗
OER
(R
†
)R
∼
=
E[d]
r≥0
333
(where
the
subscript
“R’s”
denote
that
the
decomposition
is
in
the
real
analytic
category).
If
we
use
this
decomposition
to
write
s
∈
Γ(E,
L
⊗OE
F
d
(R
†
))
as
s
=
s[0]
+
s[1]
+
.
.
.
+
E[d]
s[r]
+
.
.
.,
and,
moreover,
equip
ωE
with
the
metric
given
by:
def
||α||2
=
d
·
α∧α
E
then
we
obtain
another
metric,
the
“de
Rham
metric”
||
∼
||DR
,
on
Γ(E,
L
⊗OE
F
d
(R
†
)):
E[d]
def
||s||DR
=

r≥0
E
|s[r]|2L
·
dμ
(cf.
Chapter
VII,
§4,
for
more
details).
These
metrics
satisfy:
||
∼
||R
≤
||
∼
||DR
≤
eπ+r
·
||
∼
||R
Moreover,
(1)
(Hermite
Model)
If
we
ﬁx
a
nonnegative
integer
r
≤
d
and
let
d
→
∞,
then
on
Γ(E,
L
⊗OE
F
r
(R
†
)),
we
have:
E[d]
−1
lim
γd
2
·
||
∼
||et
=
d→∞
def
Here
γd
=
d
4π·Im(τ
)
1
2
−1
lim
γd
2
·
||
∼
||HMd
=
d→∞
−1
lim
γd
2
·
||
∼
||R
d→∞
,
and
||
∼
||HMd
is
the
metric
on
the
space
Γ(E,
L
⊗OE
F
r
(R
†
))
E[d]
deﬁned
by
considering
Hermite
polynomials
scaled
by
γd
in
the
derivatives
of
the
theta
functions
∈
Γ(E,
L)
(cf.
§6
for
more
details
on
||
∼
||HMd
).
(2)
(Legendre
Model)
There
is
a
natural
metric
||
∼
||Tch
on
Γ(E,
L
⊗OE
F
d
(R
†
))
E[d]
which
admits
a
natural
orthonormal
basis
obtained
by
considering
discrete
Tchebycheﬀ
polynomials
(cf.
Chapter
VII,
Proposition
3.1)
scaled
by
d
in
the
derivatives
of
the
theta
functions
∈
Γ(E,
L)
(cf.
§2
for
more
details
on
||
∼
||Tch
).
In
the
limit,
as
d
→
∞,
with
this
scaling,
these
polynomials
converge
to
the
Legendre
polynomials.
Moreover,
if
d
≥
25,
then
for
r
≤
d,
the
metrics
||
∼
||Tch
;
||
∼
||DR
on
Γ(E,
L
⊗OE
F
r
(R
†
))
satisfy:
E[d]
2
|q|−
2d
·(iχ
/n)
·
||
∼
||Tch
≤
||
∼
||DR
d3
·
C
1/2
·
e5d
·
(C
+
C
−1
)r

e5
·
d6


e10
d
2
1
≤
·
|q|−
2d
·(iχ
/n)
·
||
∼
||Tch
·
1
C
C2
1
334
def
1
where
C
=
{8π
2
·
Im(τ
)}
2
.
Moreover,
if
a
is
a
natural
number,
then
there
is
a
natural
metric
||
∼
||w,μa
on
Γ(E,
L⊗OE
F
d
(R
†
))
obtained
by
averaging
||
∼
||et
with
respect
to
E[d]
translates
by
the
a
·
d-torsion
points
of
E
=
Gm
/q
Z
arising
from
the
torsion
points
of
Gm
(cf.
§1,2,
for
more
details).
The
metrics
||
∼
||w,μa
;
||
∼
||DR
on
Γ(E,
L
⊗OE
F
r
(R
†
))
E[d]
satisfy:
|q|−
2d
·(iχ
/n)
·
||
∼
||w,μa
≤
||
∼
||DR
d8
·
C
1/2
·
e9d
·
{a2
·
(C
+
C
−1
)}r

e6
·
d6


e10
d
2
1
≤
·
|q|−
2d
·(iχ
/n)
·
||
∼
||w,μa
·
1
C
C2
2
1
whenever
a
≥
8
+
(
π4
·
Im(τ
))−1
.
(3)
(Binomial
Model)
There
is
a
natural
metric
||
∼
||CG
on
Γ(E,
L
⊗OE
F
d
(R
†
))
E[d]
which
admits
a
natural
orthonormal
basis
obtained
by
considering
certain
binomial
coefﬁcient
polynomials
(cf.
Chapter
V,
Theorem
4.8)
(scaled
by
1
=
d0
)
in
the
derivatives
of
the
theta
functions
∈
Γ(E,
L)
(cf.
§2
for
more
details
on
||
∼
||Tch
).
If
d
≥
25,
for
r
≤
d,
then
the
metrics
||
∼
||CG
,
||
∼
||DR
on
Γ(E,
L
⊗OE
F
d
(R
†
))
satisfy:
E[d]
|q|−
2d
·(iχ
/n)
·
||
∼
||CG
≤
||
∼
||DR
e3d
·
r
2r
·
d5
·
C
1/2
·
{4π(C
+
C
−1
)}r

e
5
·
d
4


e
9
d
2
1
·
≤
·
|q|−
2d
·(iχ
/n)
·
||
∼
||CG
1
C
C2
1
2
Moreover,
there
is
a
natural
metric
||
∼
||qCG
on
Γ(E,
L
⊗OE
F
d
(R
†
))
which
admits
a
E[d]
natural
orthonormal
basis
obtained
by
dividing
the
binomial
coeﬃcient
polynomials
in
the
derivatives
of
the
theta
functions
considered
above
by
certain
powers
of
q.
If
d
≥
12,
and
Im(τ
)
≥
200{log2
(d)
+
n
·
log(d)
+
n
·
log(n)},
then
this
metric
satisﬁes:
n−1
·
e−32d
·
||
∼
||qCG
≤
||
∼
||et
≤
e4d
·
||
∼
||qCG
In
particular,
for
each
of
these
models,
the
combinatorial/arithmetic
portion
of
the
analytic
torsion
(i.e.,
the
portion
not
arising
from
letting
the
elliptic
curve
E
degenerate)
induced
on
Γ(E,
L
⊗OE
(F
r+1
/F
r
)(R
†
))
by
the
metrics
||
∼
||R
;
||
∼
||DR
;
||
∼
||HMd
;
E[d]
||
∼
||Tch
;
||
∼
||w,μa
;
||
∼
||qCG
(in
their
respective
domains
of
applicability)
as
r
→
d,
goes
(modulo
factors
of
the
order
(constant)d
)
as
≈
(d!)−1
335
which
is
precisely
what
you
would
expect
by
applying
the
product
formula
to
the
computation
of
the
“analytic
torsion”
in
the
ﬁnite
prime
case
(cf.
Chapter
V,
Theorem
3.1;
Chapter
VI,
Theorem
4.1;
Chapter
VII,
Proposition
3.4).
Finally,
all
of
the
metrics
appearing
above
on
the
space
Γ(E,
L⊗OE
F
r
(R
†
))
are
invariant
with
respect
to
the
maximal
E[d]
compact
subgroup
GS1
⊆
GL
of
the
theta
group
GL
associated
to
L.
Proof.
Note
that
relative
to
the
discussion
preceding
Theorem
7.4,
we
replace
Eor
(respectively,
qor
;
DR,
sc;
R,
sc)
by
the
simpler
notation
E
(respectively,
q;
DR;
R)
in
the
statement
of
Theorem
7.4.
The
inequality
relating
||
∼
||R
;
||
∼
||DR
follows
from
Lemma
6.4.
The
estimates
of
(1)
(respectively,
(2);
(3))
follow
by
weakening/simplifying
the
estimates
of
Lemma
6.4
(respectively,
Lemma
6.2;
Lemma
6.3,
Theorem
5.8).
For
stronger
estimates,
we
refer
to
the
various
estimates
of
§5,
6.
(Note
that
to
simplify
these
estimates,
we
make
use
of
Chapter
VII,
Lemmas
3.5,
3.6.)
The
statement
concerning
the
relationship
between
the
analytic
torsion
and
the
comparison
theorem
at
ﬁnite
primes
follows
from
Lemma
7.3
and
the
Remark
following
Lemma
7.3.
The
statement
concerning
invariance
with
respect
to
GS1
follows
from
the
deﬁnitions
of
the
metrics
using
Lemma
7.2.

Remark.
Note
that
the
three
models
correspond
roughly
to
three
“domains
of
validity/applicability”:
1
Hermite
Model
(scaling
factor
=
d
2
)
:
nondegenerating
E,
ﬁxed
r
<
d
Legendre
Model
(scaling
factor
=
d)
:
nondegenerating
E,
varying
r
<
d
Binomial
Model
(scaling
factor
=
1)
:
degenerating
E
Relative
to
Im(τ
)
(where
E
=
Gm
/q
Z
,
q
=
exp(2πiτ
)),
the
Hermite
Model
(respectively,
Legendre
Model,
Binomial
Model)
corresponds
to
the
case
where/is
most
useful
when
Im(τ
)
is
ﬁxed
(respectively,
→
0;
→
∞).
Finally,
as
remarked
at
the
end
of
§5,
the
factor
of
n−1
appearing
at
the
beginning
of
the
last
line
of
inequalities
of
Theorem
7.4,
(3),
is
the
archimedean
analogue
of
the
description
of
the
scheme-theoretic
zero
locus
of
the
determinant
given
in
Chapter
VI,
Theorem
4.1,
(2).
336
Chapter
IX:
The
Arithmetic
Kodaira-Spencer
Morphism
§0.
Introduction
In
this
Chapter,
we
apply
the
Hodge-Arakelov
Comparison
Theorem
(Chapter
VIII,
Theorem
A)
to
construct
an
arithmetic
version
of
the
well-known
Kodaira-Spencer
morphism
of
a
family
of
elliptic
curves
E
→
S
(satisfying
a
mild
technical
assumption
concerning
its
2-torsion):
κarith
:
ΠS
→
Filt(HDR
)(S)
E
Roughly
speaking,
this
arithmetic
Kodaira-Spencer
morphism
is
a
canonical
map
from
the
def
algebraic
fundamental
group
of
SQ
=
S
⊗Z
Q
(i.e.,
if
S
=
Spec(OK
),
where
OK
is
the
ring
of
integers
of
a
number
ﬁeld
K,
then
one
may
think
of
ΠS
as
the
absolute
Galois
group
of
K)
to
a
ﬂag
variety
of
ﬁltrations
of
a
module
which
is
a
certain
analogue
of
the
de
Rham
cohomology
of
the
elliptic
curve.
Moreover,
this
morphism
has
certain
remarkable
integrality
properties
(in
the
Arakelov
sense)
at
all
the
primes
(both
ﬁnite
and
inﬁnite)
of
a
number
ﬁeld.
This
arithmetic
Kodaira-Spencer
morphism
is
constructed
in
§3
of
this
Chapter.
In
§1,2,
we
ﬁrst
give
a
construction
of
the
Kodaira-Spencer
morphism
in
the
complex
and
p-adic
cases
which
is
entirely
analogous
to
the
construction
to
be
given
in
the
arithmetic
case
in
§3,
but
which
shows
quite
explicitly
how
this
construction
is
related
(in
the
complex
and
p-adic
cases)
to
the
“classical
Kodaira-Spencer
morphism”
that
appears
in
the
theory
of
moduli
of
algebraic
varieties.
Conceptually
speaking,
the
main
point
in
all
of
these
constructions
consists,
as
depicted
in
the
following
diagram:
Kodaira-Spencer
morphism:
motion
in
base-space
→
induced
deformation
of
Hodge
ﬁltration
of
the
idea
that
the
Kodaira-Spencer
morphism
is
the
map
which
associates
to
a
“motion”
in
the
base-space
of
a
family
of
elliptic
curves,
the
deformation
in
the
Hodge
ﬁltration
of
the
de
Rham
cohomology
of
the
elliptic
curve
induced
by
the
motion.
More
concretely,
the
main
idea
consists
of
a
certain
“recipe”
for
constructing
“Kodaira-Spencer-type
morphisms”
out
of
“comparison
isomorphisms
between
de
Rham
and
étale/singular
cohomology.”
In
§3,
we
carry
out
this
recipe
in
the
case
when
the
comparison
isomorphism
is
the
the
Hodge-Arakelov
Comparison
Isomorphism
(Chapter
VIII,
Theorem
A);
in
§1,2,
we
discuss
certain
novel
approaches
to
the
well-known
comparison
isomorphisms
for
elliptic
curves
337
in
the
complex
and
p-adic
cases,
which,
on
the
one
hand,
make
the
connection
with
the
classical
Kodaira-Spencer
morphism
explicit,
and,
on
the
other
hand,
show
how
the
HodgeArakelov
Comparison
Isomorphism
is
entirely
analogous
to
the
well-known
complex
and
p-adic
comparison
isomorphisms.
§1.
The
Complex
Case:
The
Classical
“Modular
Theory”
of
the
Upper
Half-Plane
In
this
§,
we
review
the
de
Rham
isomorphism
of
a
complex
elliptic
curve,
showing
how
this
isomorphism
may
be
regarded
as
being
analogous
in
a
fairly
precise
sense
to
the
Comparison
Isomorphism
of
Chapter
VIII,
Theorem
A.
We
then
discuss
the
theory
of
the
Kodaira-Spencer
morphism
of
a
family
of
complex
elliptic
curves
in
the
universal
case,
but
we
formulate
this
theory
in
a
somewhat
novel
fashion,
showing
how
the
Kodaira-Spencer
morphism
may
be
derived
directly
from
the
de
Rham
isomorphism
in
a
rather
geometric
way.
This
formulation
will
allow
us
to
make
the
connection
with
the
global
arithmetic
theory
of
§3.
We
begin
our
discussion
by
considering
a
single
elliptic
curve
E
over
C.
Frequently
in
the
following
discussion,
we
shall
also
write
“E”
for
the
complex
manifold
deﬁned
by
the
original
algebraic
curve.
Recall
(cf.
Chapter
III,
§3)
that
we
have
a
commutative
diagram
1
(E,
OE
)
=
E
†
HDR
⏐
⏐exp

∼
=
×
1
HDR
(E,
OE
)
=
E†
1
∼
(E,
C×
)
=
Hsing
1
(E,
C)
Hsing
⏐
⏐exp

⊇
1
Hsing
(E,
2πi
·
R)
⏐
⏐exp

1
⊇
Hsing
(E,
2πi
·
Z)
⏐
⏐exp

1
⊇
Hsing
(E,
S1
)
=
ER
⊇
identity
elt.
Here,
the
horizontal
isomorphisms
are
the
de
Rham
isomorphisms
relating
de
Rham
cohomology
to
singular
cohomology.
Note
that
in
characteristic
zero,
line
bundles
with
connec×
1
(E,
OE
),
tion
are
necessarily
of
degree
zero,
so
E
†
may
be
naturally
identiﬁed
with
HDR
the
group
of
line
bundles
equipped
with
a
connection
on
E.
(Similarly,
the
(topological)
1
(E,
OE
).)
The
vertical
maps
are
the
universal
cover
E
†
of
E
†
may
be
identiﬁed
with
HDR
morphisms
induced
on
cohomology
by
the
exponential
map;
S1
⊆
C×
is
the
unit
circle
(equipped
with
its
usual
group
structure).
Finally,
ER
⊆
E
†
is
the
real
analytic
submanifold
(discussed
in
Chapter
III,
§3)
which
is
equal
to
the
closure
of
the
torsion
points
of
E
†
and
maps
bijectively
onto
E
via
the
natural
projection
E
†
→
E.
Here,
we
would
like
to
consider
the
issue
of
precisely
how
the
de
Rham
isomorphisms
of
the
above
diagram
are
deﬁned.
Of
course,
there
are
many
possible
deﬁnitions
for
these
isomorphisms,
but
the
point
that
we
would
like
to
make
here
is
the
following:
def
1
1
If
one
thinks
of
Hsing
(E,
S1
)
=
ER
(respectively,
Tv
(E)
=
Hsing
(E,
2πi·
R))
as
the
“v-divisible
group
of
torsion
points
of
E”
(respectively,
the
338
“v-adic
Tate
module”)
—
where
v
=
∞
is
the
archimedean
prime
of
Q
—
then,
roughly
speaking,
one
may
think
of
the
de
Rham
isomorphisms
as
being
given
by
the
diagram
1
Hol.
fns.
on
HDR
(E,
OE
)
=
E
†
“∼
=”
1
Real
an.
fns.
on
Hsing
(E,
2πi
·
R)
×
1
Hol.
fns.
on
HDR
(E,
OE
)
=
E†
“∼
=”
1
Real
an.
fns.
on
Hsing
(E,
S1
)
=
ER
where
the
horizontal
isomorphisms
“∼
=”
are
given
by
restricting
holo†
†
morphic
functions
on
E
,
E
to
real
analytic
functions
on
the
“∞-adic
def
1
torsion
points/Tate
module”
ER
,
T∞
(E)
=
Hsing
(E,
2πi
·
R).
Here,
we
say
“roughly
speaking”
(and
write
“∼
=”)
for
the
following
reason:
Although
this
restriction
morphism
is
injective,
the
correspondence
between
holomorphic
functions
on
the
de
Rham
objects
E
†
,
E
†
and
real
analytic
functions
on
the
v-adic
torsion
point
objects
ER
,
T∞
(E)
is,
strictly
speaking,
only
true
on
an
“inﬁnitesimal
neighborhood”
of
ER
⊆
E
†
,
T∞
(E)
⊆
E
†
.
(That
is
to
say,
although
a
real
analytic
function
on
ER
always
corresponds
to
a
holomorphic
function
on
some
open
neighborhood
of
ER
in
E
†
,
whether
or
not
this
holomorphic
function
extends
to
a
holomorphic
function
deﬁned
over
all
of
E
†
involves
subtle
convergence
issues
and,
in
fact,
is
not
always
the
case.)
Thus,
here,
in
order
to
get
a
precise
statement,
we
shall
work
with
polynomial
functions
on
E
†
and
T∞
(E).
Then
one
sees
immediately
that
the
de
Rham
isomorphism
of
the
ﬁrst
commutative
diagram
of
this
§
may
be
formulated
as
the
isomorphism
HolomPoly
(E
†
)
∼
=
Real
AnPoly
(T∞
(E))
given
by
restricting
holomorphic
polynomials
on
E
†
to
the
∞-adic
torsion
points
so
as
to
obtain
real
analytic
polynomials
on
T∞
(E).
When
formulated
from
this
point
of
view,
one
sees
that
the
Comparison
Isomorphism
of
Chapter
VIII,
Theorem
A,
is
analogous
in
a
very
direct
sense
to
the
classical
de
Rham
isomorphism
in
the
complex
case,
i.e.:
Both
may
be
thought
of
as
being
bijections
between
algebraic/
holomorphic
functions
on
de
Rham-type
objects
and
arbitrary/
real
analytic
functions
on
torsion
points
–
bijections
given
by
restricting
algebraic/
holomorphic
functions
on
de
Rham-type
objects
to
the
torsion
points
lying
inside
those
de
Rham-type
objects.
This
observation
may
be
thought
of
as
the
philosophical
starting
point
of
the
theory
of
this
paper.
339
1
Remark.
Note
that
the
collection
of
“holomorphic
functions
on
HDR
(E,
OE
)”
includes,
in
particular,
the
theta
functions
(cf.,
e.g.,
[Mumf],
Chapter
I,
§3)
associated
to
the
elliptic
curve
E.
Moreover,
these
functions
are
“fairly
representative
of”
(roughly
speaking,
“gen1
erate”)
the
set
of
all
holomorphic
functions
on
HDR
(E,
OE
)
that
arise
by
pull-back
via
the
1
1
projection
HDR
(E,
OE
)
→
H
(E,
OE
)
(deﬁned
by
the
Hodge
ﬁltration)
from
holomorphic
functions
on
H
1
(E,
OE
).
This
observation
played
a
fundamental
motivating
role
in
the
development
of
the
theory
of
the
present
paper.
Next,
we
shift
gears
and
discuss
various
versions
of
the
Kodaira-Spencer
morphism
for
def
the
universal
family
of
complex
elliptic
curves.
First,
let
us
write
H
=
{z
∈
C
|
Im(z)
>
0}
for
the
upper
half-plane,
and
EH
→
H
for
the
universal
family
of
complex
elliptic
curves
over
H.
That
is
to
say,
over
a
point
z
∈
H,
the
ﬁber
Ez
of
this
family
is
given
by
Ez
=
C/
<
1,
z
>
(where
<
1,
z
>
denotes
the
Z-submodule
generated
by
1,
z).
Let
us
ﬁx
a
“base-point”
z0
∈
H.
Write
def
1
1
HDR
(Ez0
)
=
HDR
(Ez0
,
OEz0
)
1
Thus,
HDR
(Ez0
)
is
a
two-dimensional
complex
vector
space.
Recall
that,
in
fact,
the
1
correspondence
z
→
HDR
(Ez
)
deﬁnes
a
rank
two
vector
bundle
E
on
H
equipped
with
a
natural
(integrable)
connection
(the
“Gauss-Manin
connection”).
Since
the
underlying
topological
space
of
H
is
contractible,
parallel
transport
via
this
connection
thus
gives
rise
to
a
natural
trivialization
of
this
rank
two
vector
bundle
E,
i.e.,
a
natural
isomorphism
1
E∼
(Ez0
)
=
H
×
HDR
Recall
that
the
Hodge
ﬁltration
of
de
Rham
cohomology
deﬁnes
a
subbundle
F
1
(E)
⊆
E
of
rank
one.
This
subbundle
induces
a
natural
holomorphic
morphism
def
1
κH
:
H
→
P
=
P1
(HDR
(Ez0
))
1
1
that
maps
a
point
z
∈
H
to
the
subspace
of
HDR
(Ez0
)
=
HDR
(Ez
)
deﬁned
by
F
1
(E)
⊆
E
at
z.
Now
let
us
recall
that
we
have
a
natural
action
of
SL2
(R)
on
H
given
by
linear
fractional
transformations.
This
action
allows
us
to
deﬁne
a
morphism
κSL2
:
SL2
(R)
→
P
340
def
by
letting
κSL2
(γ)
=
κH
(γ
·
z0
)
(for
γ
∈
SL2
(R)).
If
we
then
diﬀerentiate
κSL2
at
z0
,
we
obtain
a
morphism
on
tangent
spaces
that
ﬁts
into
a
commutative
diagram:
κsl
2
−→
sl2
(R)
⏐
⏐

sl2
(R)/so2
∼
=
τP,p0
#
⏐κτ
⏐
τH,z0
Here,
the
vertical
morphism
on
top
is
the
derivative
of
κSL2
at
the
origin
of
SL2
(R);
def
τP,p0
(respectively,
τH,z0
)
is
the
tangent
space
to
P
(respectively,
H)
at
p0
=
κH
(z0
)
(respectively,
z0
).
This
vertical
morphism
clearly
factors
through
the
quotient
sl2
(R)
→
sl2
(R)/so2
,
where
sl2
(R)
(respectively,
so2
)
is
the
Lie
algebra
associated
to
SL2
(R)
(respectively,
the
subgroup
of
SL2
(R)
that
ﬁxes
z0
).
Moreover,
all
tangent
vectors
to
z0
∈
H
are
obtained
by
acting
by
various
elements
of
sl2
(R)
on
H
at
z0
;
thus,
one
may
identify
sl2
(R)/so2
with
τH,z0
(the
vertical
isomorphism
on
the
bottom).
Deﬁnition
1.1.
We
shall
refer
to
κSL2
(respectively,
κsl2
;
κτ
)
as
the
group-theoretic
(respectively,
Lie-theoretic;
classical)
Kodaira-Spencer
morphism
(of
the
family
EH
→
H
at
z0
).
Thus,
the
“classical
Kodaira-Spencer
morphism”
κτ
is
obtained
(cf.
the
above
commutative
diagram)
simply
by
using
the
fact
that
κsl2
factors
through
the
quotient
sl2
(R)
→
sl2
(R)/so2
.
One
checks
easily
that
this
morphism
is
indeed
the
usual
Kodaira-Spencer
morphism
associated
to
the
family
EH
→
H.
In
particular,
κτ
is
an
isomorphism.
The
reason
that
we
feel
that
it
is
natural
also
to
regard
κSL2
and
κsl2
as
“KodairaSpencer
morphisms”
is
the
following:
The
essence
of
the
notion
of
a
“Kodaira-Spencer
morphism”
is
that
of
a
correspondence
that
associates
to
a
motion
in
the
base-space
the
induced
deformation
of
the
Hodge
ﬁltration
of
the
de
Rham
cohomology,
i.e.,
symbolically,
Kodaira-Spencer
morphism:
motion
in
base-space
→
induced
deformation
of
Hodge
ﬁltration
In
the
case
of
the
“group-theoretic
Kodaira-Spencer
morphism”
(respectively,
“Lie-theoretic
Kodaira-Spencer
morphism”;
“classical
Kodaira-Spencer
morphism”),
this
motion
is
a
motion
given
by
the
“Lie
group
SL2
(R)
of
motions
of
H”
(respectively,
the
Lie
algebra
associated
to
this
Lie
group
of
motions;
a
tangent
vector
in
H).
That
is
to
say,
all
three
types
of
Kodaira-Spencer
morphism
discussed
here
ﬁt
into
the
general
pattern
just
described.
It
turns
out
that
the
group-theoretic
Kodaira-Spencer
morphism
is
the
version
which
is
most
suited
to
generalization
to
the
arithmetic
case
(cf.
the
discussions
of
§2,3
below).
Finally,
we
make
the
connection
between
the
theory
of
the
Kodaira-Spencer
morphism
just
discussed
and
the
function-theoretic
approach
to
the
de
Rham
isomorphism
discussed
341
at
the
beginning
of
this
§.
First
of
all,
let
us
observe
that
the
action
of
SL2
(R)
on
H
lifts
naturally
to
an
action
on
E.
Moreover,
if
one
thinks
of
SL2
(R)
as
the
group
of
unimodular
(i.e.,
with
determinant
=
1)
R-linear
automorphisms
of
the
two-dimensional
R-vector
space
T∞
(Ez0
),
that
is,
if
one
makes
the
identiﬁcation
SL2
(R)
=
SL(T∞
(Ez0
))
1
(Ez0
)
corresponds
to
the
natural
action
of
then
the
action
of
SL2
(R)
on
E
∼
=
H
×
HDR
1
∼
SL(T∞
(Ez0
))
on
HDR
(Ez0
)
=
T∞
(Ez0
)
⊗R
C
(where
the
isomorphism
here
is
the
de
Rham
isomorphism).
It
thus
follows
that
the
group-theoretic
Kodaira-Spencer
morphism
κSL2
may
also
be
deﬁned
as
the
morphism
1
SL2
(R)
=
SL(T∞
(Ez0
))
→
P
=
P(HDR
(Ez0
))
given
by
γ
→
γ
·
p0
,
where
the
expression
“γ
·
p0
”
is
relative
to
the
natural
action
of
1
SL(T∞
(Ez0
))
on
P
=
P(HDR
(Ez0
))
∼
=
P(T∞
(Ez0
)
⊗R
C)
(where
the
isomorphism
here
is
that
derived
from
the
de
Rham
isomorphism).
This
approach
to
deﬁning
κSL2
shows
that:
The
group-theoretic
Kodaira-Spencer
morphism
κSL2
may
essentially
be
deﬁned
directly
from
the
de
Rham
isomorphism.
This
observation
brings
us
one
step
closer
to
the
discussion
of
the
arithmetic
case
in
§3.
In
particular,
in
light
of
the
above
“function-theoretic
approach
to
the
de
Rham
isomorphism,”
it
motivates
the
following
point
of
view:
Note
that
(in
the
notation
of
the
discussion
at
the
beginning
of
this
§)
the
space
HolomPoly
(E
†
)
of
holomorphic
polynomials
on
E
†
has
a
Hodge
ﬁltration
.
.
.
F
d
(HolomPoly
(E
†
))
⊆
.
.
.
⊆
HolomPoly
(E
†
)
given
by
letting
F
d
(HolomPoly
(E
†
))
⊆
HolomPoly
(E
†
)
denote
the
subspace
of
polynomials
whose
“torsorial
degree”
(cf.
Chapter
III,
Deﬁnition
2.2),
i.e.,
degree
as
a
polynomial
in
the
relative
variable
of
the
torsor
E
†
→
E
(where
E
is
the
universal
covering
space
of
E),
is
<
d.
Note
that
relative
to
the
“function-theoretic
de
Rham
isomorphism”
HolomPoly
(E
†
)
∼
=
Real
AnPoly
(T∞
(E)),
F
d
(HolomPoly
(E
†
))
corresponds
to
the
subspace
d
of
Real
AnPoly
(T∞
(E))
annihilated
by
∂
.
(Here,
∂
is
the
usual
“del-bar”
operator
of
complex
analysis
on
T∞
(E)
=
ER
,
relative
to
the
complex
structure
on
ER
deﬁned
by
E.)
Let
us
write
Filt(HolomPoly
(E
†
))
342
for
the
(inﬁnite-dimensional)
ﬂag-manifold
of
C-linear
ﬁltrations
{F
d
}d∈Z≥0
of
HolomPoly
(E
†
)
such
that
F
0
=
0.
Then
the
“Hodge
ﬁltration”
just
deﬁned
determines
a
point
∈
Filt(HolomPoly
(E
†
))
pfunc
E
Similarly,
any
one-dimensional
complex
quotient
E
†
→
Q
deﬁnes
a
ﬁltration
of
HolomPoly
(E
†
)
(given
by
looking
at
the
degree
with
respect
to
the
variable
corresponding
to
the
kernel
of
E
†
→
Q).
In
particular,
we
get
an
immersion
P(E
†
)
→
Filt(HolomPoly
(E
†
))
Thus,
returning
to
the
discussion
of
the
group-theoretic
Kodaira-Spencer
morphism,
we
see
that
we
may
think
of
the
composite
Poly
(E
†
))
κfunc
SL2
:
SL2
(R)
=
SL(T∞
(Ez0
))
→
Filt(Holom
of
κSL2
with
the
inclusion
P(E
†
)
→
Filt(HolomPoly
(E
†
))
as
being
deﬁned
as
follows:
The
natural
action
of
SL(T∞
(Ez0
))
on
Real
AnPoly
(T∞
(Ez0
))
induces,
via
the
“function-theoretic
de
Rham
isomorphism”
Real
AnPoly
(T∞
(Ez0
))
∼
=
HolomPoly
(Ez†0
)
†
an
action
of
SL(T∞
(Ez0
))
on
HolomPoly
(Ez0
);
then
the
“function-theoretic
version
of
the
group-theoretic
Kodaira-Spencer
morphism”
Poly
(Ez†0
))
κfunc
SL2
:
SL(T∞
(Ez0
))
→
Filt(Holom
†
Poly
func
is
deﬁned
by
γ
→
γ
·
pfunc
(Ez0
))
is
the
Ez0
,
where
pEz0
∈
Filt(Holom
†
natural
point
deﬁned
by
the
Hodge
ﬁltration
on
HolomPoly
(Ez0
).
It
is
this
point
of
view
that
forms
the
basis
of
our
approach
to
the
arithmetic
case
in
§3.
Remark.
The
theory
discussed
in
§1,2,
of
this
Chapter
generalizes
immediately
to
the
case
of
higher-dimensional
abelian
varieties.
Since,
however,
the
Hodge-Arakelov
Comparison
Theorem
(Chapter
VIII,
Theorem
A)
is
only
available
(at
the
time
of
writing)
for
elliptic
curves,
we
restrict
ourselves
both
in
the
present
and
the
following
§’s
to
the
case
of
elliptic
curves.
343
§2.
The
p-adic
Case:
The
Hodge-Tate
Decomposition
as
an
Evaluation
Map
The
purpose
of
this
§
is
to
exhibit
the
morphism
which
deﬁnes
the
Hodge-Tate
decomposition
of
the
p-adic
Tate
module
of
an
elliptic
curve
as
an
evaluation
map,
given
by
restricting
certain
functions
on
the
universal
extension
of
the
elliptic
curve
to
the
p-power
torsion
points
of
the
elliptic
curve.
This
renders
explicit
the
analogy
between
the
HodgeArakelov
Comparison
Isomorphism
of
Chapter
VIII,
Theorem
A,
and
the
p-adic
Hodge
theory
of
an
elliptic
curve.
We
then
explain
how,
if
one
applies
the
general
recipe
–
which
is
the
theme
of
the
present
Chapter
–
for
obtaining
Kodaira-Spencer-type
morphisms
from
evaluation
map-based
comparison
isomorphisms
(cf.
§1
in
the
complex
case
and
in
§3
in
the
global
Arakelov
case)
to
the
present
p-adic
situation,
one
obtains
a
sort
of
“p-adic
arithmetic
Kodaira-Spencer
morphism,”
which,
by
Faltings’
computation
of
certain
Galois
cohomology
groups,
may
be
identiﬁed
with
the
classical
Kodaira-Spencer
morphism
of
a
family
of
elliptic
curves.
Remark.
The
material
of
the
present
§
is
in
principle
“well-known,”
and,
in
fact,
inspired
by
the
techniques
and
points
of
view
of
[Falt1,2],
[Font],
but
I
do
not
know
of
an
adequate
explicit
reference
for
this
material.
Roughly
speaking,
the
idea
here
is
what
is
usually
referred
to
as
the
p-adic
period
map
for
abelian
varieties
–
cf.
[Coln],
[Colz],
[Wint].
Indeed,
our
point
of
view
here
essentially
coincides
with
what
is
done
in
[Coln],
[Colz],
[Wint],
and
[Font],
when
restricted
to
the
subspace
of
the
de
Rham
cohomology
of
an
elliptic
curve
arising
from
diﬀerentials
of
the
ﬁrst
kind
(i.e.,
globally
holomorphic
diﬀerentials).
Our
treatment
of
the
“other
half”
of
the
de
Rham
cohomology,
however,
appears
to
diﬀer
from
these
other
sources.
Indeed,
Coleman
([Coln])
and
Fontaine
([Font])
do
not
construct
a
morphism
on
the
entire
de
Rham
cohomology
module.
On
the
other
hand,
Colmez
([Colz],
Théorème
5.2)
constructs
such
a
morphism
by
thinking
of
the
remainder
of
the
de
Rham
cohomology
as
being
deﬁned
by
diﬀerentials
of
the
second
kind
(i.e.,
meromorphic
diﬀerentials
which
are
“locally
integrable”),
which
he
integrates
to
construct
his
period
map;
in
particular,
Colmez
does
not
use
the
universal
extension
as
we
do
here.
Finally,
Wintenberger
([Wint],
§4)
uses
the
universal
extension,
but
in
a
somewhat
diﬀerent
fashion
from
what
is
done
here.
Let
k
be
a
perfect
ﬁeld
of
characteristic
p
>
2.
(In
fact,
the
case
p
=
2
may
be
handled
without
much
more
diﬃculty,
but
for
simplicity,
we
assume
here
that
p
>
2.)
def
def
Write
A
=
W
(k);
K
=
A
⊗Zp
Qp
.
Let
S
be
a
formal
p-adic
A-scheme,
which
is
formally
smooth
and
formally
of
ﬁnite
type
over
A.
Suppose
that
S
is
equipped
with
an
A-ﬂat
divisor
with
normal
crossings
D
⊆
S.
Write
S
log
for
the
resulting
log
scheme.
Suppose
that
C
log
→
S
log
is
a
log
elliptic
curve
over
S
log
(cf.
Chapter
III,
Deﬁnition
1.1).
344
Next,
let
us
suppose
that
S
is
aﬃne,
i.e.,
of
the
form
Spf(R)
where
R
is
a
p-adic
ring,
and
small
(cf.
[Falt2],
II.,
(a.)),
i.e.,
R
is
étale
over
the
p-adic
completion
A[t1
,
.
.
.
,
tr
]∧
of
A[t1
,
.
.
.
,
tr
],
where
t1
,
.
.
.
,
tr
are
indeterminates
such
that
the
def
schematic
zero
locus
of
t
=
t1
·
.
.
.
·
tr
in
S
is
equal
to
D.
Write
R
for
the
p-adic
completion
of
the
normalization
R
of
R
in
the
maximal
étale
extension
of
def
RQp
[t−1
]
(where
RQp
=
R
⊗
Qp
).
(Here,
“maximal”
means
“among
those
extensions
whose
Spf
is
connected.”)
Also,
let
us
write
def
ΓR
=
Gal(RQp
/RQp
)
Then
as
in
[Falt2],
II.,
(b.),
we
may
form
the
ring
of
p-adic
periods
B
+
(R)
This
ring
admits
a
natural
ΓR
-action,
together
with
a
ΓR
-equivariant
projection
B
+
(R)
→
R
whose
kernel
I
is
a
“principal
divided
power
ideal.”
In
the
discussion
of
the
present
§,
we
will
work
with
the
following
truncated
version
of
B
+
(R):
def
B
=
B
+
(R)/I
[2]
def
(where
I
[2]
is
the
second
divided
power
of
I).
Write
J
=
I/I
[2]
⊆
B
for
the
image
of
I
in
B.
Thus,
we
have
an
exact
sequence
of
ΓR
-modules:
0→J
→B→R→0
Moreover,
J
is
a
free
R-module
of
rank
1.
If
one
further
takes
the
ΓR
-action
on
J
into
account,
then
one
has
a
natural
identiﬁcation
(cf.
[Falt2],
II.,
(b.))
1
Zp
(1)
·
R
=
p
(p−1)
·
J
(where
the
“(1)”
is
a
Tate
twist).
Put
another
way,
there
is
a
ΓR
-equivariant
homomorphism
βQp
:
Qp
(1)
→
B
×
345
×
×
whose
projection
to
R
is
the
natural
inclusion
Qp
(1)/Zp
(1)
→
R
and
whose
restriction
to
Zp
(1)
is
equal
to
1
plus
the
homomorphism
β
:
Zp
(1)
→
J.
Note
that
since
R
contains
all
roots
of
the
q-parameter
at
inﬁnity,
we
may
form
E∞
→
Spf(R);
C∞
→
Spf(R)
as
in
Chapter
IV,
§4.
Note
that
we
have
a
projection
C∞
→
C,
and
an
open
immersion
E∞
→
C∞
.
Thus,
in
particular,
by
pulling
back
via
this
projection
and
this
open
immersion
the
extension
to
C
(cf.
Chapter
III,
Corollary
4.3)
†
EC
→
C
of
the
universal
extension
E
†
→
E
of
E,
we
obtain
†
→
Spf(R);
E∞
†
EC∞
→
Spf(R)
†
†
Next,
let
us
recall
that
the
universal
extension
E∞
deﬁnes
a
crystal
E∞,crys
(cf.,
e.g.,
[Mess],
for
the
non-logarithmic
case)
over
Spf(R)log
(where
“log”
refers
to
the
natural
log
structure
deﬁned
by
roots
of
the
q-parameter
at
inﬁnity).
Since
we
may
regard
Spf(B)
as
†
a
PD-thickening
of
Spf(R)log
,
we
thus
see
that
it
makes
sense
to
speak
of
E∞,crys
(B),
or
even
†
(BQp
)
E∞,crys
def
where
BQp
=
B
⊗
Qp
.
In
particular,
we
see
that,
for
n
≥
0,
†
†
pn
E∞,crys
(BQp
)
⊆
E∞,crys
(BQp
)
forms
a
group
(noncanonically
isomorphic
to)
(Z/pn
·
Z)2
.
In
fact,
the
sections
of
the
†
†
crystal
E∞,crys
deﬁned
by
pn
E∞,crys
(BQp
)
are
all
horizontal,
hence
preserved
by
base†
changes
of
E∞,crys
among
various
thickenings
of
BQp
.
Observe
also
that
as
n
→
∞,
†
the
pn
E∞,crys
(BQp
)
form
a
natural
inverse
system
(all
of
whose
transition
morphisms
are
surjective);
the
inverse
limit
of
this
inverse
system
is
the
Tate
module
TE
of
E.
Note
that
as
a
topological
group,
TE
∼
=
Zp
2
.
Moreover,
TE
has
a
natural
structure
of
†
continuous
ΓR
-module,
and
TE
⊗Z/pn
·
Z
may
be
naturally
identiﬁed
with
pn
E∞,crys
(BQp
).
346
Next,
we
would
like
to
consider
functions.
Let
us
write
R
†
E∞
†
for
the
push-forward
to
E∞
of
the
structure
sheaf
O
†
on
E∞
.
Recall
that
this
structure
E∞
sheaf
has
a
ﬁltration
F
(R
†
)
⊆
R
†
(for
j
∈
Z),
where
we
take
F
j
(R
†
)
to
be
the
j
E∞
E∞
E∞
subsheaf
of
sections
of
torsorial
degree
(cf.
Chapter
III,
Deﬁnition
2.2)
≤
−j.
Note
that
the
ﬁltration
index
that
we
use
here
diﬀers
from
the
ﬁltration
index
of
Chapters
III-VIII
in
that
“the
index
used
here
=
1−
the
index
used
there.”
In
particular,
F
j
(R
†
)
as
deﬁned
E∞
here
is
a
vector
bundle
on
E∞
of
rank
1
−
j,
when
j
≤
0.
Thus,
we
have
an
exact
sequence:
−→
0
OE∞
−→
F
−1
(R
†
)
E∞
−→
τE
⊗OS
O
†
E∞
R
−→
0
†
In
particular,
if
we
apply
this
ﬁltration
to
the
crystal
E∞,crys
evaluated
on
the
thickening
B,
where
we
regard
B
itself
as
equipped
with
the
ﬁltration
given
by:
F
≥2
(B)
=
0;
then
we
see
that
the
sheaf
R
†
F
1
(B)
=
J;
E∞,crys
(B)
F
≤0
(B)
=
B
†
of
functions
on
E∞,crys
(B)
(pushed
forward
topo-
logically
to
E∞
)
gets
a
ﬁltration
whose
F
0
(−)
we
denote
by
R0
†
†
†
If
one
restricts
functions
on
E∞,crys
(B)
to
E∞,crys
(R)
=
E∞
(R),
then
one
obtains
a
surjection
R0
→
OE∞
which
ﬁts
into
an
exact
sequence
0
−→
J
⊗
F
−1
(R
†
)
R
E∞
−→
R0
−→
OE∞
−→
−→
−→
0
Let
us
write
def
RJ
=
R0
/J
·
OE∞
Thus,
we
have
an
exact
sequence
0
−→
(J
⊗R
τE
)
⊗
OE∞
R
−→
RJ
347
OE∞
0
The
evaluation
map
that
we
will
consider
in
this
§
(which
gives
rise
to
the
comparison
isomorphism
of
Hodge-Tate
theory)
will
be
deﬁned
by
restricting
functions
in
R0
to
the
†
p-power
torsion
points
pn
E∞,crys
(BQp
)
(and
then
noting
that
this
restriction
map
factors
through
RJ
).
†
More
precisely,
since
sections
of
R0
are
functions
on
E∞,crys
(B),
hence
deﬁne
func†
†
tions
on
E∞,crys
(BQp
),
we
may
restrict
them
to
the
points
of
pn
E∞,crys
(BQp
)
to
obtain
a
morphism
def
†
(BQp
),
BQp
)
=
ΞQp
[pn
]
:
R0
→
Func(pn
E∞,crys

BQp
†
γ∈pn
E∞,crys
(BQp
)
Now
we
have
the
following:
Lemma
2.1.
The
morphism
ΞQp
[pn
]
reduced
modulo
JQp
⊆
BQp
maps
into
R
⊆
RQp
.
Proof.
Indeed,
this
follows
from
the
deﬁnition
of
R0
,
together
with
the
fact
that
the
image
†
of
pn
E∞,crys
(RQp
)
in
E∞
(RQp
)
maps
into
E∞
(R)
⊆
E∞
(RQp
)
(i.e.,
all
the
p-torsion
points
of
E∞
over
RQp
are
already
deﬁned
over
R).

†
Thus,
it
follows
that
ΞQp
[pn
]
maps
J
·
O(E∞
)
⊆
R0
into
Func(pn
E∞,crys
(BQp
),
J)
⊆
R
†
Func(pn
E∞,crys
(BQp
),
BQp
).
In
particular,
if
we
compose
ΞQp
[pn
]
with
the
projection
†
†
(BQp
),
BQp
)
→
Func(pn
E∞,crys
(BQp
),
BQp
/Zp
)
Func(pn
E∞,crys
def
†
(where
BQp
/Zp
=
B
⊗
Qp
/Zp
)
we
get
a
morphism
R0
→
Func(pn
E∞,crys
(BQp
),
BQp
/Zp
)
†
which
vanishes
on
the
kernel
of
R0
→
RJ
and
maps
into
Func(pn
E∞,crys
(BQp
),
JQp
/Zp
),
i.e.,
a
morphism
ΞRJ
[pn
]
:
RJ
→
Func(TE
⊗
Z/pn
·
Z,
JQp
/Zp
)
†
(since
TE
⊗
Z/pn
·
Z
=
pn
E∞,crys
(BQp
)).
Let
us
analyze
this
morphism
ΞRJ
[pn
]
in
more
detail.
First,
let
us
observe
from
the
deﬁnitions
that
R0
has
a
natural
ring
structure
(inherited
from
the
ring
structure
).
Moreover,
it
follows
immediately
from
the
deﬁnitions
that
the
evaluation
of
O
†
E∞,crys
map
ΞQp
[pn
]
is
a
ring
homomorphism.
Note
also
that
Func(TE
⊗
Z/pn
·
Z,
JQp
/Zp
)
has
a
natural
R0
-module
structure
deﬁned
by
ΞQp
[pn
].
348
Lemma
2.2.
a
derivation.
The
restriction
R0
→
Func(TE
⊗
Z/pn
·
Z,
JQp
/Zp
)
of
ΞRJ
[pn
]
to
R0
is
Proof.
Suppose
that
f,
g
are
local
sections
of
R0
.
Write:
(ΞQp
[pn
])(f
)
=
α0
+
αJ
;
(ΞQp
[pn
])(g)
=
β0
+
βJ
where
α0
,
β0
∈
B,
and
αJ
,
βJ
∈
JQp
.
(Note
that
the
fact
that
such
α0
,
β0
,
αJ
,
βJ
exist
follows
from
Lemma
2.1.)
Then
since
ΞQp
[pn
]
is
a
ring
homomorphism,
we
obtain
that:
(ΞQp
[pn
])(f
g)
=
(ΞQp
[pn
])(f
)
·
(ΞQp
[pn
])(g)
=
(α0
+
αJ
)
·
(β0
+
βJ
)
=
α0
·
βJ
+
β0
·
αJ
+
α0
·
β0
But
α0
·
β0
∈
B,
so
modulo
B,
we
obtain:
(ΞQp
[pn
])(f
g)
≡
α0
·
βJ
+
β0
·
αJ
≡
f
·
(ΞQp
[pn
])(g)
+
g
·
(ΞQp
[pn
])(f
)
This
completes
the
proof.

†
Next,
let
us
observe
that
the
crystal
E∞,crys
gives
rise
to
a
crystal
Ω
†
(the
sheaf
E∞,crys
†
of
diﬀerentials
of
E∞,crys
over
the
base,
i.e.,
thickening
of
R,
in
question)
of
modules
over
(where
R
†
is
the
topological
push-forward
to
E∞
of
the
structure
sheaf
of
R
†
E∞,crys
E∞,crys
†
E∞,crys
).
Let
us
denote
by
Ωinv†
E∞,crys
⊆Ω
†
E∞,crys
the
subsheaf
of
invariant
diﬀerentials
(cf.
the
discussion
at
the
beginning
of
the
Appendix).
Thus,
Ωinv†
forms
a
crystal
in
(rank
two)
vector
bundles
over
Spf(R),
and
we
have
an
E∞,crys
isomorphism
of
crystals:
Ωinv†
E∞,crys
⊗R
†
E∞,crys
∼
=Ω
†
E∞,crys
(where
the
tensor
product
is
over
the
base,
i.e.,
thickening
of
R,
in
question).
Note
that
Ωinv†
(i.e.,
Ωinv†
E∞
evaluated
on
Spf(R))
admits
a
natural
two-step
Hodge
ﬁltration,
whose
E∞,crys
349
F
0
=
Ωinv†
;
F
2
=
0;
and
F
1
consists
of
the
invariant
diﬀerentials
ωE
on
E∞
.
(Thus,
F
0
/F
1
E∞
may
be
identiﬁed
with
τE
.)
Tensoring
this
ﬁltration
with
the
ﬁltration
discussed
above
on
R
†
gives
rise
to
a
ﬁltration
on
Ω
†
.
Moreover,
these
ﬁltrations
deﬁne
ﬁltrations
on
the
E∞
E∞
evaluations
(on
various
thickenings
of
Spf(R))
of
the
corresponding
crystals.
Thus,
if
we
evaluate
these
crystals
on
Spf(B),
we
obtain:
F
1
(Ωinv†
E∞,crys
)|Spf(B)
⊆
F
1
(Ω
†
E∞,crys
)|Spf(B)
⊆
Ω
†
E∞,crys
|Spf(B)
Note
that
we
have
a
natural
inclusion
F
1
(Ωinv†
)
⊗
Ker(R0
→
OE∞
))
→
F
1
(Ω
†
E∞
R
E∞,crys
|Spf(B)
)
Let
us
write
def
ΩJ
†
=
F
1
(Ω
†
|Spf(B)
)/(F
1
(Ωinv†
)
⊗
Ker(R0
→
OE∞
))
E∞
E∞
R
E∞
def
ΩInv,J
=
(F
1
/F
2
)(Ωinv†
)|Spf(B)
†
E
E
∞
∞
Thus,
we
have
a
commutative
diagram
of
R-modules:
0
−→
J
⊗R
τE
⏐
⏐

0
−→
(J
⊗R
τE
)
⊗
OE∞
R
−→
ΩInv,J
†
E∞
⏐
⏐

−→
−→
ΩJ
†
−→
Ω
E∞
ωE
⊗R
R
⏐
⏐

−→
0
=
ωE
⊗R
OE∞
−→
0
E∞
/R
In
particular,
we
see
that
we
obtain
a
natural
isomorphism
ΩInv,J
⊗
OE∞
∼
=
ΩJ
†
†
R
E
E
∞
∞
On
the
other
hand,
it
follows
immediately
from
the
deﬁnitions
of
the
various
ﬁltrations
|Spf(B)
induces
a
morphism
R0
→
that
the
exterior
derivative
d
(over
B)
on
R
†
E∞,crys
F
1
(Ω
†
|Spf(B)
),
hence
(by
projecting)
a
morphism
E∞
R0
→
Ω
J
†
E∞
350
which
is
easily
seen
to
vanish
on
J
·
O(E∞
)
.
Thus,
we
obtain
that
the
exterior
derivative
R
induces
a
derivation
RJ
→
Ω
J
†
E∞
from
the
ring
RJ
to
the
module
ΩJ
†
,
hence
a
natural
morphism
E∞
Ω
J
R
/R
→
ΩJ
†
E∞
But
one
computes
easily
(using
the
exact
sequence
considered
above
in
which
RJ
appears
as
the
term
in
the
middle)
that
this
morphism
is
an
isomorphism
(where
we
use
that
p
=
2!),
i.e.,
we
have
proven
the
following
We
have:
Ω
J
Lemma
2.3.
R
/R
∼
=
ΩJ
†
.
E∞
Thus,
the
well-known
relation
between
derivations
and
diﬀerentials
implies
(by
Lemmas
2.2,
2.3)
that
ΞRJ
[pn
]
factors
as
the
composite
of
the
tautological
derivation
d
R
J
:
RJ
→
Ω
J
R
/R
∼
=
ΩJ
†
E∞
and
a
morphism
ΩJ
†
→
Func(TE
⊗
Z/pn
·
Z,
JQp
/Zp
)
E∞
If
we
then
restrict
to
the
invariant
diﬀerentials
ΩInv,J
⊆
ΩJ
†
,
we
get
a
morphism
†
E
E
∞
∞
Ψ[pn
]
:
ΩInv,J
→
Func(TE
⊗
Z/pn
·
Z,
JQp
/Zp
)
†
E
∞
Lemma
2.4.
The
image
of
Ψ[pn
]
lies
in
the
subset
Hom(TE
⊗
Z/pn
·
Z,
JQp
/Zp
)
⊆
Func(TE
⊗
Z/pn
·
Z,
JQp
/Zp
)
of
“functions
that
are
compatible
with
the
additive
group
operations
on
TE
⊗
Z/pn
·
Z
and
JQp
/Zp
.”
Proof.
Indeed,
this
follows
by
observing
that
since
the
deﬁnition
of
Ψ[pn
]
is
“natural,”
it
is
functorial
with
respect
to
the
homomorphism
μ
:
E∞
×
E∞
→
E∞
(deﬁned
by
the
R
351
group
law
on
the
group
scheme
E∞
).
On
the
other
hand,
(by
the
functoriality
of
invariant
diﬀerentials
with
respect
to
homomorphisms)
the
pull-back
to
E∞
×
E∞
of
any
section
α
R
of
ΩInv,J
is
simply
(α,
α).
Put
another
way,
this
implies
that
to
evaluate
(Ψ[pn
])(α)
on
the
†
E∞
sum
of
two
elements
of
TE
⊗
Z/pn
·
Z
is
the
same
as
the
sum
of
the
values
of
(Ψ[pn
])(α)
at
each
of
these
two
elements,
i.e.,
the
function
(Ψ[pn
])(α)
∈
Func(TE
⊗
Z/pn
·
Z,
JQp
/Zp
)
is
additive,
as
desired.

Note
that
the
additivity
property
of
Lemma
2.4
implies
that:
(i)
the
image
of
Ψ[pn
]
is
annihilated
by
pn
;
(ii)
for
α
∈
ΩInv,J
,
the
function
(Ψ[pn−1
])(α)
is
the
function
induced
by
†
E∞
(p
·
Ψ[pn
])(α)
on
the
quotient
TE
⊗
Z/pn
·
Z
→
TE
⊗
Z/pn−1
·
Z.
In
particular,
by
taking
the
inverse
limit,
we
obtain
a
morphism:
ΨZp
:
ΩInv,J
→
Hom(TE
,
J)
†
E
∞
This
morphism
is
the
morphism
that
deﬁnes
the
Hodge-Tate
decomposition
(cf.,
e.g.,
the
ﬁnal
Theorem
–
i.e.,
the
“relative
version”
–
in
[Hyodo],
§0.3).
The
following
result
may
be
regarded
as
the
main
theorem
of
the
Hodge-Tate
theory
of
an
elliptic
curve:
Theorem
2.5.
The
morphism
ΨZp
:
ΩInv,J
→
Hom(TE
,
J)
†
E
∞
1
is
invertible
over
Qp
,
and
its
inverse
has
poles
annihilated
by
p
(p−1)
.
Proof.
Note
that
ΨZp
is
an
R-linear
morphism
between
free
R-modules
of
rank
2.
Moreover,
its
determinant
may
be
regarded
as
a
morphism
det(ΨZp
)
:
J
→
det(TE
)∨
⊗Zp
J
⊗2
=
J
⊗2
(−1)
i.e.,
this
determinant
may
be
thought
of
as
an
element
D
∈
Hom
(J,
J
⊗2
(−1))
=
J(−1)
=
HomZp
(Zp
(1),
J)
R
I
claim
that
(up
to
a
sign)
this
element
is
the
morphism
β
:
Zp
(1)
→
J
discussed
at
the
beginning
of
this
§.
(Note
that
this
is
suﬃcient
to
complete
the
proof
of
Theorem
2.5.)
In
order
to
prove
this
claim,
let
us
ﬁrst
observe
that
it
suﬃces
to
prove
it
when
the
present
S
is
replaced
by
the
(formal
scheme
given
by
the)
completion
of
S
along
D.
Indeed,
this
is
clear
when
this
completion
along
the
divisor
at
inﬁnity
D
is
“schematically
dense”
352
in
S
(i.e.,
the
map
from
functions
on
S
to
functions
on
this
completion
is
injective).
But
this
holds
in
the
“universal
case,”
i.e.,
when
the
original
S
is
étale
over
(the
padic
completion
of)
the
moduli
stack
(M1,0
)Zp
.
Thus,
it
suﬃces
to
work
in
a
formal
neighborhood
of
inﬁnity.
In
particular,
for
the
rest
of
the
proof,
we
assume
that
S
is
such
a
formal
neighborhood.
Then,
by
Chapter
III,
Theorem
2.1,
we
have
an
exact
sequence
of
group
objects
†
→W
→0
0
→
(Gm
)S
→
E∞
E
over
S.
(Here,
WE
is
the
aﬃne
group
object
associated
to
ωE
.)
Let
us
observe
that,
†
relative
to
the
structure
of
E∞
as
a
crystal
over
Spf(R),
this
exact
sequence
is
horizontal.
†
Indeed,
the
subobject
(Gm
)S
⊆
E∞
may
be
recovered
as
the
(formal)
schematic
closure
†
of
the
prime-to-p
torsion
points
of
E∞
that
lie
inside
(Gm
)S
.
But
it
is
clear
that
the
subschemes
deﬁned
by
these
torsion
points
are
horizontal.
Thus,
we
see
that
this
exact
sequence
is
horizontal,
as
desired.
Next,
observe
that,
since
we
are
working
in
a
formal
neighborhood
of
inﬁnity,
the
ΓR
-module
ﬁts
into
a
natural
exact
sequence
of
ΓR
-modules:
0
→
Z/pn
·
Z(1)
→
TE
⊗
Z/pn
·
Z
→
Z/pn
·
Z
→
0
Moreover,
if
we
consider
the
aﬃne
coordinate
“T
”
on
WE
corresponding
to
the
trivialization
of
ωE
given
by
“d
log(U
)”
(notation
of
Chapter
III,
§5),
then
it
follows
from
Chapter
III,
Corollary
5.9,
that
the
image
under
ΞRJ
[pn
]
of
the
section
of
RJ
deﬁned
by
“T
·
j”
(where
j
∈
J)
is
the
function
on
TE
⊗Z/pn
·
Z
that
arises
by
pulling
back
(to
TE
⊗Z/pn
·
Z)
the
J-valued
function
on
Z/pn
·
Z
that
maps
b
∈
Z/pn
·
Z
to
b
·
j.
Thus,
in
particular,
applying
Hom(−,
J)
to
the
inverse
limit
as
n
→
∞
of
the
above
exact
sequence
—
which
yields
an
exact
sequence
0
→
J
→
Hom(TE
,
J)
→
J(−1)
→
0
—
we
see
that
ΨZp
maps
T
·J
⊆
ΩInv,J
to
J
⊆
Hom(TE
,
J)
isomorphically
via
the
morphism
†
E∞
given
by
T
→
1.
Thus,
it
remains
to
consider
what
happens
when
functions
on
(Gm
)S
are
restricted
to
Z/pn
·
Z(1)
⊆
TE
⊗
Z/pn
·
Z.
In
particular,
we
would
like
to
investigate
the
image
of
the
invariant
diﬀerential
d
log(U
)
under
Ψ[pn
].
But
since
Ψ[pn
]
was
deﬁned
by
factoring
the
derivation
ΞRJ
[pn
]
(cf.
Lemma
2.2)
through
the
tautological
derivation,
it
follows
that
this
amounts
to
investigating
the
behavior
of
the
function
“log(U
)”
on
Z/pn
·
Z(1)
⊆
(Gm
)S
.
But
then
it
follows
from
the
deﬁnition
of
the
morphism
β
:
Zp
(1)
→
J
(which
is
essentially
given
by
taking
the
logarithm
of
p-power
roots
of
unity!
—
cf.
[Falt2],
II.,
(b.))
that
(up
to
a
sign),
if
we
take
the
inverse
limit
as
n
→
∞,
the
image
of
d
log(U
)
∈
ωE
⊆
Ωinv†
/(J
⊗R
τE
)
E∞
353
under
the
composite
of
ΨZp
with
the
quotient
Hom(TE
,
J)
→
J(−1)
is
precisely
β
∈
Hom(Zp
(1),
J)
=
J(−1).
More
explicitly,
let
ζ
∈
R
be
a
pn
-th
root
of
unity.
Write
def
ζ
∈
p−n
·
Zp
(1)
⊆
Qp
(1)
for
an
element
such
that
z
=
βQp
(ζ)
≡
ζ
modulo
J.
Note
that
def
z
∈
B
itself
is
not
necessarily
a
pn
-th
root
of
unity.
If
δ
=
−p−n
·ζ
·β(pn
·
ζ)
∈
p−n
·J
⊆
JQp
,
then
(z
+
δ)p
=
z
p
+
pn
·
z
p
−1
·
δ
=
1
+
β(pn
·
ζ)
+
pn
·
ζ
−1
·
δ
=
1
n
n
n
i.e.,
z
+
δ
∈
μpn
(B).
Thus,
the
evaluation
map
“modulo
B”
(cf.
the
deﬁnition
of
ΞRJ
[pn
]
above)
maps
the
function
U
on
(Gm
)S
to
the
image
of
z
+
δ
in
BQp
/Zp
.
In
fact,
this
image
is
equal
to
the
image
δ
∈
JQp
/Zp
of
δ.
Put
another
way,
we
obtain
that
dU
→
δ,
so
d
log(U
)
=
U
−1
·
dU
→
ζ
−1
·
δ
=
−p−n
·
β(pn
·
ζ)
(mod
J)
∈
JQp
/Zp
.
Taking
the
inverse
limit
as
n
→
∞,
we
thus
obtain
that,
in
this
inverse
limit,
d
log(U
)
→
−β,
as
desired.
Thus,
combining
this
with
what
was
done
in
the
preceding
paragraph,
we
see
that
the
determinant
D
in
question
is
equal
to
±β,
as
claimed.

Remark.
The
isomorphism
of
Theorem
2.5
is
the
Hodge-Tate
Comparison
Isomorphism
of
an
elliptic
curve.
If
one
restricts
it
to
a
point
α
of
S
valued
in
some
ﬁnite
extension
L
of
K,
def
then
it
follows
from
the
facts
H
1
(ΓL
,
L(1))
=
0,
H
0
(ΓL
,
L)
=
L
(where
ΓL
=
Gal(L/L))
that
Ωinv†
|α
admits
a
unique
ΓL
-invariant
splitting
E∞
Ωinv†
|α
=
ωE
|α
⊕
τE
(1)|α
E∞
(where
we
use
that
JQp
=
RQp
(1)),
hence
that
Theorem
2.5
gives
us
an
isomorphism
ωE
|α
⊕
τE
(1)|α
∼
=
TE
⊗Zp
L
This
is
the
usual
form
in
which
the
Hodge-Tate
“comparison
isomorphism”/decomposition
is
stated.
The
important
point
here
is
that
this
well-known
isomorphism
is
essentially
deﬁned
by
restricting
functions
on
the
universal
extension
of
E
to
p-power
torsion
points
(cf.
the
deﬁnition
of
ΞQp
[pn
]),
i.e.,
The
Hodge-Tate
Comparison
Isomorphism
is
deﬁned
in
a
fashion
which
is
entirely
analogous
to
the
deﬁnition
of
the
Hodge-Arakelov
Comparison
Isomorphism
(Chapter
VIII,
Theorem
A).
Note,
moreover,
that
after
reducing
ΞQp
[pn
]
“modulo
Zp
,”
and
factoring
through
the
tautological
derivation
dRJ
,
we
restricted
to
the
invariant
diﬀerentials
on
the
universal
354
extension.
Thus,
put
another
way,
the
comparison
isomorphism
of
Theorem
2.5
was
deﬁned
essentially
by
integrating
invariant
diﬀerentials,
and
then
restricting
the
resulting
functions
to
p-power
torsion
points.
(Thus,
these
“resulting
functions”
are
essentially
“logarithm”
type
functions,
of
the
sort
reviewed
in
the
Appendix.)
Regarded
from
this
point
of
view,
we
thus
also
see
the
explicit
analogy
between
this
p-adic
comparison
isomorphism
and
its
complex
counterpart
in
§1.
Finally,
we
make
the
connection
between
the
above
discussion
of
the
Hodge-Tate
Comparison
Isomorphism
and
the
arithmetic
Kodaira-Spencer
morphism.
In
keeping
with
the
analogy
to
the
theory
of
§1,3,
we
start
oﬀ
with
the
comparison
isomorphism
(Theorem
2.5):
ΨQp
:
E
=
(ΩInv,J
)Qp
∼
=
Hom(TE
,
JQp
)
=
VE∨
(1)
⊗Qp
RQp
∼
=
VE
⊗Qp
RQp
†
E
def
∞
def
def
(where
ΨQp
=
ΨZp
⊗
Qp
,
VE
=
TE
⊗
Qp
).
Since
VE
⊗Qp
RQp
has
a
natural
ΓR
-action,
we
thus
obtain
a
natural
ΓR
-action
on
E.
This
technique
of
obtaining
a
Galois
action
on
the
de
Rham
side
of
the
comparison
isomorphism
by
pulling
back
(via
the
comparison
isomorphism)
the
natural
Galois
action
on
the
étale
side
is
entirely
analogous
to
what
is
done
in
§1,3.
Thus,
we
have
a
natural
ΓR
-action
on
E.
Note,
moreover,
that
we
have
an
exact
sequence
of
RQp
-modules:
0
→
τE
(1)
⊗R
RQp
→
E
→
ωE
⊗R
RQp
→
0
(where
we
identify
JQp
with
RQp
(1)
via
β).
Moreover,
it
is
easy
to
see
from
the
deﬁnition
of
ΞRJ
[pn
]
that
the
natural
Galois
action
on
τE
(1)
⊗R
RQp
⊆
E
is
compatible
with
the
Galois
action
on
VE
⊗Qp
RQp
.
Thus,
this
submodule
is
stabilized
by
ΓR
,
and
the
above
exact
sequence
is
an
exact
sequence
of
ΓR
-modules.
(Note
that
the
fact
that
the
Galois
action
on
ωE
⊗R
R
arising
from
the
Galois
action
on
E
is
the
expected
action
may
be
derived
using
determinants,
as
in
the
proof
of
Theorem
2.5.)
We
observe
that
this
exact
sequence
is
essentially
the
same
as
that
of
[Mzk3],
Proposition
2.4.
This
exact
sequence
thus
deﬁnes
a
cohomology
class
ηKS
∈
H
1
(ΓR
,
Hom
RQp
(ωE
⊗R
RQp
,
τE
(1)
⊗R
RQp
))
=
H
1
(ΓR
,
τE⊗2
(1)
⊗R
RQp
)
Such
a
cohomology
class
may
be
thought
of
as
an
equivalence
class
of
twisted
homomordef
⊗2
=
τE
(1)
⊗R
RQp
,
where
we
consider
twisted
homomorphisms
phisms
ΓR
→
τE⊗2
(1)
R
Qp
355
that
diﬀer
by
(the
twisted
homomorphism
deﬁned
by)
a
coboundary
to
be
equivalent.
We
would
like
to
regard
this
equivalence
class
of
twisted
homomorphisms
which,
by
abuse
of
notation,
we
write
:
ΓR
→
τE⊗2
(1)
κarith,p
R
R
Qp
as
a
sort
of
p-adic
(Galois)
group-theoretic/arithmetic
Kodaira-Spencer
morphism,
analarith
”
in
§3.
Note
that
the
construction
of
ogous
to
the
morphisms
“κfunc
SL2
”
of
§1,
and
“κE
arith,p
starting
from
the
comparison
isomorphism
is
entirely
analogous
to
what
is
done
in
κR
§1,3.
as
a
sort
of
Kodaira-Spencer
morphism,
To
explain
why
it
is
natural
to
regard
κarith,p
R
we
must
recall
the
theory
of
[Falt1].
In
[Falt1],
I.,
§4,
(b),
(f),
a
certain
natural
extension
of
ΓR
-modules
0
→
p−
(p−1)
·
R
→
Eρ
→
Ωlog
S
(−1)
⊗R
R
→
0
1
def
def
∨
(where
Ωlog
=
ΩS
log
/A
)
is
constructed.
If
we
write
Θlog
=
(Ωlog
S
S
S
)
for
the
logarithmic
tangent
bundle
of
S
log
over
A,
then
we
get
an
element
ηFalt
∈
H
1
(ΓR
,
Θlog
S
(1)
⊗R
RQp
)
This
element
may
be
thought
of
as
a
twisted
homomorphism
Falt
ξR
:
ΓR
→
Θlog
S
(1)
R
Qp
On
the
other
hand,
we
have
the
classical
Kodaira-Spencer
morphism
⊗2
κclass
:
Θlog
R
S
→
τE
given
by
observing
the
extent
to
which
the
Hodge
ﬁltration
of
the
crystal
Ω
†
varies
as
E∞
one
moves
in
various
tangent
directions
∈
Θlog
S
.
Then
the
relationship
between
the
p-adic
arith,p
and
the
classical
Kodaira-Spencer
morphism
arithmetic
Kodaira-Spencer
morphism
κR
class
Falt
κR
is
given
by
Faltings’
morphism
ξR
,
as
described
in
Theorem
2.6
below.
Remark.
If
we
write
def
def
ΔR
=
Ker(ΓR
→
ΓK
=
Gal(K/K))
356
for
the
geometric
portion
of
the
Galois
group
ΓR
,
then
according
to
the
theory
of
“almost
étale
extensions”
discussed
in
[Falt1],
“ΔR
⊗Zp
RQp
”
(notation,
which,
of
course,
is
not
deﬁned
rigorously,
but
is
meant
to
be
suggestive
of
what
is
going
on)
may
roughly
be
identiﬁed
with
Θlog
S
(1)
⊗R
RQp
,
that
is
to
say,
over
RQp
,
the
geometric
Galois
group
ΔR
log
of
S
is
“almost
equivalent”
to
the
tangent
bundle
of
S
log
,
hence
may
be
thought
of
as
a
group
of
“motions
in
S
log
.”
From
this
“almost”
point
of
view,
it
is
thus
natural
that
the
domain
of
our
p-adic
arithmetic
Kodaira-Spencer
morphism
κarith,p
is
the
Galois
group
R
ΓR
.
Theorem
2.6.
We
have
a
commutative
diagram:
ΓR
⏐
⏐
id
ΓR
Falt
−ξR
−→
κarith,p
R
−→
Θlog
S
(1)R
Qp
⏐
class
⏐κR
(1)

RQ
p
τE⊗2
(1)
R
Qp
i.e.,
in
terms
of
cohomology
classes,
the
change
of
coeﬃcients
morphism
⊗2
1
H
1
(ΓR
,
Θlog
S
(1)
⊗R
RQp
)
→
H
(ΓR
,
τE
(1)
⊗R
RQp
)
deﬁned
by
κclass
maps
−ηFalt
→
ηKS
.
R
Proof.
First
of
all,
since
both
ηFalt
and
ηKS
are
clearly
functorial
in
R,
it
suﬃces
to
prove
the
result
in
the
universal
case,
i.e.,
the
case
where
S
is
(formally)
étale
over
the
p-adic
completion
of
the
moduli
stack
(M1,0
)Zp
.
Thus,
for
the
rest
of
the
proof,
we
assume
that
we
are
dealing
with
such
an
S.
Let
us
write
def
def
ΔR
=
Ker(ΓR
→
ΓK
=
Gal(K/K))
Then
observe
that
by
the
theory
of
[Falt1]
(cf.
especially
[Falt1],
p.
270,
Theorem
4.4,
(i)),
it
follows
that
H
0
(ΓK
,
H
1
(ΔR
,
τE⊗2
(1)
⊗R
RQp
))
is
a
free
RQp
-module
of
rank
1,
while
H
1
(ΓK
,
H
0
(ΔR
,
τE⊗2
(1)
⊗R
RQp
))
=
0
(cf.
the
well-known
fact
that
H
1
(ΓK
,
K(1))
=
0;
[Mzk3],
Lemma
2.2).
Thus,
by
the
Leray-Serre
spectral
sequence,
we
obtain
that
H
1
(ΓR
,
τE⊗2
(1)
⊗R
RQp
)
→
H
0
(ΓK
,
H
1
(ΔR
,
τE⊗2
(1)
⊗R
RQp
))
(∼
=
RQp
)
i.e.,
that
two
classes
in
H
1
(ΓR
,
τE⊗2
(1)
⊗R
RQp
)
coincide
if
and
only
if
they
coincide
after
restriction
to
a
formal
neighborhood
of
the
divisor
at
inﬁnity
D
(cf.
the
proof
of
Theorem
2.5).
Thus,
it
suﬃces
to
prove
the
result
in
the
case
where
S
is
a
such
a
formal
neighborhood.
357
In
this
case,
however,
it
follows
from
the
construction
of
the
extension
“Eρ
”
in
[Falt1],
I.,
§4,
that
ηFalt
is
essentially
given
by
the
image
of
the
class
∈
H
1
(ΓR
,
Zp
(1))
obtained
by
extracting
p-power
roots
of
the
q-parameter
under
the
change
of
coeﬃcients
morphism
H
1
(ΓR
,
Zp
(1))
→
H
1
(ΓR
,
Θlog
S
(1)
⊗R
RQp
)
deﬁned
by
the
“tangent
vector”
∂/∂log(q).
On
the
other
hand,
it
follows
from
the
discussion
in
the
proof
of
Theorem
2.5
that
the
extension
ηKS
is
simply
the
extension
class
of
the
exact
sequence
0
→
Zp
(1)
→
TE
→
Zp
→
0
pushed
forward
by
the
change
of
coeﬃcients
morphism
H
1
(ΓR
,
Zp
(1))
→
H
1
(ΓR
,
τE⊗2
(1)
⊗R
RQp
)
deﬁned
by
(∂/∂U
)⊗2
(notation
of
the
proof
of
Theorem
2.5).
On
the
other
hand,
since
it
is
well-known
that
the
classical
Kodaira-Spencer
morphism
maps
∂/∂log(q)
→
−(∂/∂U
)⊗2
(cf.,
e.g.,
[FC],
p.
84,
the
second
paragraph
preceding
Lemma
9.3,
beginning
“As
an
example...”),
it
thus
follows
that
−ηFalt
→
ηKS
,
as
desired.

Remark.
Put
another
way,
the
message
of
the
proof
of
Theorem
2.6,
and
indeed
of
this
entire
§,
is
that:
The
relationship
between
the
p-adic
Galois-theoretic/arithmetic
KodairaSpencer
morphism
and
the
classical
Kodaira-Spencer
morphism
is
the
essential
content
of
Serre-Tate
theory.
For
more
on
this
point
of
view
in
the
case
of
abelian
varieties,
we
refer
to
[Katz].
For
more
on
this
point
of
view
in
a
more
general
context
(in
particular,
the
case
of
hyperbolic
curves),
we
refer
to
[Mzk1],
Introduction;
Chapter
V,
§1;
as
well
as
to
[Mzk2],
Introduction,
especially
§2.3.
358
§3.
The
Global
Arithmetic
Case:
Application
of
the
Hodge-Arakelov
Comparison
Isomorphism
In
this
§,
we
apply
the
Hodge-Arakelov
Comparison
Isomorphism
(cf.
Chapter
VIII,
Theorem
A)
to
construct
a
global
arithmetic
analogue
of
the
Kodaira-Spencer
morphism
of
a
family
of
elliptic
curves.
The
technique
of
construction
is
motivated
by
the
point
of
view
discussed
in
§1,2,
in
the
complex
and
p-adic
cases.
We
begin
by
discussing
the
behavior
of
the
trivializations
arising
from
theta
groups
at
archimedean
primes.
Thus,
let
E
be
an
elliptic
curve
over
C.
Fix
a
positive
integer
d,
and
write
def
L
=
OE
(d
·
[e])
Let
|
∼
|L
be
a
metric
on
L
whose
curvature
is
translation-invariant.
Recall
from
Chapter
IV,
§1,
the
subscheme
of
symmetric
elements
SL
⊆
G
L
of
the
theta
group
GL
of
L.
Lemma
3.1.
The
automorphisms
of
(E,
L)
deﬁned
by
points
of
SL
preserve
|
∼
|L
.
Proof.
Indeed,
clearly
any
translation
of
a
translation-invariant
(1,
1)-form
is
again
translation-invariant.
Thus,
it
follows
that
for
γ
=
(α,
ι)
∈
SL
,
the
metric
γ(|
∼
|L
)
that
one
obtains
on
L
by
ﬁrst
pulling
back
|
∼
|L
via
ι
:
Tα∗
L
∼
=
L,
and
then
applying
−1
∗
(Tα
)
to
produce
(by
transport
of
structure)
a
metric
on
L
has
translation-invariant
curvature.
Thus,
the
metrics
γ(|
∼
|L
)
and
|
∼
|L
both
have
translation-invariant
curvature,
hence
diﬀer
by
a
positive
constant
λγ
.
Moreover,
since
γ
∈
SL
implies
γ
N
∈
SL
(∀
N
∈
Z),
it
follows
that
the
correspondence
γ
→
λγ
deﬁnes
a
homomorphism
from
<
γ
>
(the
subgroup
of
GL
generated
by
γ,
which
lies
inside
SL
)
to
R>0
(equipped
with
its
multiplicative
group
structure).
Since
<
γ
>
is
a
ﬁnite
group,
it
thus
follows
that
this
homomorphism
is
trivial,
so
λγ
=
1,
as
desired.

Now
recall
the
“theta
trivialization”
Θα
:
L|Tα∗
KL
∼
=
(L|α0
)
⊗OK
0
OKL
L
(where
α
∈
KL
)
of
the
discussion
following
Chapter
IV,
Theorem
1.6.
Note
that
both
sides
of
this
isomorphism
may
be
regarded
as
ﬁnite-dimensional
complex
vector
spaces.
Moreover,
both
of
these
vector
spaces
have
natural
metrics,
arising
from
|
∼
|L
,
and
the
359
fact
that
since
we
are
working
over
C,
the
ring
OKL
may
be
regarded
as
the
ring
of
C-valued
functions
on
the
d-torsion
points
d
E
of
E,
hence
admits
a
natural
L2
-metric
def
||f
||2
=
1

·
|f
(τ
)|2
d2
τ
∈d
E
(for
f
∈
OKL
).
Since
this
trivialization
is
deﬁned
by
the
splitting
σ
:
2
·
KL
→
GL
of
GL
→
KL
discussed
in
Chapter
IV,
Theorem
1.6,
which
factors
through
SL
,
it
follows
from
Lemma
3.1
that:
Lemma
3.2.
If
one
equips
both
sides
of
the
theta
trivialization
Θα
:
L|Tα∗
KL
∼
=
(L|α0
)
⊗OK
0
OKL
L
determined
by
the
splitting
σ
of
Chapter
IV,
Theorem
1.6,
with
their
natural
metrics
(arising
from
|
∼
|L
,
and
the
L2
-metric
on
OKL
),
then
this
trivialization
Θ
is
an
isometry.
Remark.
In
particular,
we
may
conclude
the
following:
Recall
the
Comparison
Isomorphism
(cf.
Chapter
V,
Theorem
3.1,
(2);
or,
alternatively,
Chapter
VIII,
Theorem
A,
(2))
†
Ξ
:
Γ(E[d]
,
Lη
)<d
∼
=
Lη
|d
E
def
where
Lη
=
Tη∗
L,
and
η
∈
E
is
a
torsion
point
of
order
m
not
dividing
d.
Thus,
if
we
compose
this
isomorphism
with
the
trivialization
Θη
:
L|Tη∗
KL
=
Lη
|d
E
∼
=
(L|η0
)
⊗OK
0
OKL
L
we
get
an
isomorphism
†
Ψ
:
Γ(E[d]
,
Tη∗
L)<d
∼
=
(L|η0
)
⊗OK
0
OKL
L
of
d-dimensional
vector
spaces
over
C.
Next,
suppose
that
we
are
given
an
automorphism
Φ
of
the
C-algebra
OKL
which
preserves
and
induces
the
identity
on
the
C-subalgebra
OKL
0
⊆
OKL
arising
from
the
quotient
KL
→
KL
0
.
Observe
(by
thinking
about
the
fact
that
Φ
necessarily
arises
as
the
morphism
induced
on
functions
by
some
automorphism
of
the
set
of
d-torsion
points
of
E)
that
such
an
automorphism
Φ
is
an
isometry
of
OKL
onto
itself
(where
we
equip
OKL
with
the
natural
L2
-metric
of
the
discussion
above).
Note,
moreover,
that
Φ
induces
an
(isometric)
automorphism
of
(L|η0
)
⊗OK
0
OKL
,
hence
(by
L
360
†
conjugating
by
Ψ)
an
automorphism
of
Γ(E[d]
,
Tη∗
L)<d
.
By
Lemma
3.2
(and
the
deﬁnition
†
of
the
“étale
metric”
||
∼
||et
on
Γ(E[d]
,
Tη∗
L)<d
),
we
thus
obtain
that:
†
Φ
induces
an
automorphism
of
Γ(E[d]
,
Tη∗
L)<d
which
is
an
isometry
with
respect
to
the
||
∼
||et
-metric
(cf.
Chapter
VIII,
Theorem
A,
(4)).
This
observation
will
be
of
central
importance
in
the
following
discussion.
Now
let
S
log
be
any
log
scheme
whose
underlying
scheme
is
connected,
ﬂat
and
of
ﬁnite
type
over
Z,
and
whose
log
structure
is
deﬁned
by
a
divisor
with
normal
crossings.
Write
Int(S
log
)
⊆
S
for
the
interior
of
S
log
,
i.e.,
the
open
subscheme
where
the
log
structure
is
trivial.
Let
C
log
→
S
log
be
a
log
elliptic
curve
over
S
log
as
in
Chapter
VIII,
Theorem
A,
i.e.:
(1)
the
divisor
at
inﬁnity
D
⊆
S
(i.e.,
the
pull-back
of
the
divisor
at
inﬁnity
of
(M1,0
)Z
via
the
classifying
morphism
S
→
(M1,0
)Z
)
is
a
Cartier
divisor
on
S;
(2)
étale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root.
Here,
we
also
make
the
technical
assumption
that
if
d
is
even,
then
the
2-torsion
points
of
E
→
S
over
the
interior
of
SQ
are
all
rational
(i.e.,
deﬁned
over
the
interior
of
SQ
).
Let
us
write
(as
usual)
dE
→
S
for
the
ﬁnite,
ﬂat
group
scheme
of
d-torsion
points
of
E∞,S
.
Note
that
if
we
tensor
with
Q,
the
resulting
morphism
(d
E)Q
→
SQ
is
ﬁnite
étale.
Let
us
ﬁx
a
geometric
point
s
of
log
Int(SQ
)
valued
in
an
algebraically
closed
ﬁeld
of
characteristic
0,
and
write
def
ΠS
=
π1
((S
log
)Q
,
s)
log
for
the
algebraic
fundamental
group
of
Int(SQ
).
Also,
let
us
ﬁx
a
geometric
point
sd
of
E
lying
over
s.
Thus,
it
is
clear
that
Π
acts
naturally
on
(d
E)Q
→
SQ
.
d
S
Now
I
claim
that:
361
The
natural
action
of
ΠS
on
(d
E)Q
→
SQ
extends
(uniquely)
to
an
action
on
d
E
→
S,
except
for
possible
poles
annihilated
by
4.
The
uniqueness
of
the
action
follows
immediately
from
the
ﬂatness
of
the
morphisms
d
E
→
S
and
S
→
Spec(Z).
To
prove
existence,
let
us
ﬁrst
observe
that
it
suﬃces
to
verify
this
claim
for
the
“universal
cases”
S
=
(M1,0
)Z
(with
the
trivial
log
structure)
and
def
1
1
S
=
Spec(Z[[q
d
]]),
endowed
with
the
log
structure
deﬁned
by
the
divisor
V
(q
d
).
In
these
cases,
it
follows
from
the
theory
of
[KM]
(cf.,
[KM],
Chapter
5,
especially
Theorem
5.1.1)
that
the
closed
subscheme
Fd
of
d
E
corresponding
to
points
of
a
given
order
d
is
regular,
hence
normal.
Thus,
it
follows
immediately
that
the
action
of
ΠS
extends
to
the
Fd
.
Next,
one
checks
that,
for
instance,
at
the
prime
2,
regular
functions
on
the
disjoint
union
of
the
Fd
regarded
as
rational
functions
on
the
original
d
E
have
poles
annihilated
by
4.
Indeed,
in
our
situation,
since
the
base
S
is
regular
of
dimension
2,
it
suﬃces
to
verify
this
assertion
on
the
ordinary
locus,
where
it
essentially
amounts
to
the
corresponding
assertion
for
μ2N
(as
opposed
to
d
E),
where
we
write
2N
for
the
maximal
power
of
2
dividing
d.
But
then
OF
i

F
j
(where
i
<
j
≤
N
)
is
annihilated
by
ζ2i
−
ζ2j
(where
ζ??
is
a
primitive
2
2
−j+1
??-th
root
of
unity),
which
has
the
same
2-adic
valuation
as
22
.
Thus,
we
see
that
the
structure
sheaf
of
the
intersection
of
F2i
with
the
union
of
the
other
Fd
’s
is
annihilated
by
2
to
the
power
i
·
2−i+1
+
2−(i+1)+1
+
2−(i+2)+1
+
.
.
.
+
2−N
+1
≤
i
·
2−i+1
+
2−i+1
=
(i
+
1)
·
2−i+1
≤
2
i.e.,
annihilated
by
4
(which
implies
that
the
“rational
function
on
μ2N
”
which
is
1
on
F2i
and
0
on
the
other
Fd
’s
has
poles
annihilated
by
4,
as
desired).
This
completes
the
proof
of
the
claim
at
the
prime
2.
At
odd
primes,
the
extendability
of
the
action
of
ΠS
follows
from
the
fact
that
since
the
universal
bases
in
question
(i.e.,
S
=
(M1,0
)Z
and
def
1
S
=
Spec(Z[[q
d
]]))
are
“absolutely
unramiﬁed,”
the
fact
that
d
E
σ
(where
σ
∈
ΠS
)
and
d
E
are
“equal”
over
Q
implies
that
their
integral
structures
at
the
prime
p
are
equal,
as
well
(cf.
[Falt2],
Theorems
2.6,
7.1).
Now
let
us
assume
that
we
are
also
given
a
torsion
point
η
∈
E∞,S
(S∞
)
of
order
precisely
m
∈
Z≥1
(where
m
does
not
divide
d)
which
allows
us
to
deﬁne
a
(Zhangtheoretically
metrized)
line
bundle
L
as
in
Chapter
VIII,
Theorem
A.
Note
that
KL
→
S
may
be
identiﬁed
with
d
E
→
S.
On
the
other
hand,
by
the
isomorphism
in
the
discussion
at
the
end
of
Chapter
V,
§1
(where
we
take
“α”
to
be
e),
we
have
a
natural
isomorphism:
L|d
E
=
L|KL
∼
=
(L|e0
)
⊗OK
0
OKL
L
362
Indeed,
this
follows
immediately
from
the
discussion
at
the
end
of
Chapter
V,
§1,
in
the
case
when
m
=
2d
(which
ensures
that
L
is
symmetric).
But
this
case
diﬀers
(cf.
the
deﬁniton
of
L
in
Chapter
V,
§1)
from
the
case
of
an
arbitrary
m
by
a
translation,
plus
a
modiﬁcation
of
the
integral
structure
at
inﬁnity
by
a
d-invariant
distribution.
Translations
are
not
a
problem
(by
“transport
of
structure”),
while
modiﬁcations
of
the
integral
structure
at
inﬁnity
by
a
d-invariant
distribution
are
not
a
problem
since
they
are
preserved
by
the
action
of
theta
groups
(cf.
Chapter
IV,
Proposition
5.1).
Thus,
in
particular,
we
see
(by
the
assumption
concerning
the
rationality
of
the
2-torsion
points!)
that
we
get
a
natural
action
(up
to
poles
annihilated
by
4)
of
ΠS
on
(L|e0
)
⊗OK
0
OKL
L
(where
e
is
the
identity
section
of
C
→
S).
Thus,
we
obtain
a
natural
action
(up
to
poles
annihilated
by
4)
of
ΠS
on
L|d
E
=
L|
†
d
E∞
i.e.,
on
the
range
of
the
evaluation
map
of
Chapter
VIII,
Theorem
A:
Ξ{∞,
et}
:
(fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et}
→
(fS
)∗
(L|
†
)
(d
E∞
)
By
Chapter
VIII,
Theorem
A,
(2),
it
follows
that
the

poles
of
the
inverse
morphism
to
this
evaluation
map
are
contained
in
the
divisor
[η
(d
E)].
Thus,
we
see
that
we
get
a
natural
action
of
ΠS
up
to
poles
in
the
divisor
[η
(d
E)]
+
V
(4)
on
def
HDR
=
(fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et}
(where
V
(4)
is
the
zero
locus
of
4).
Here
by
the
expression
“with
poles
in
(a
divisor),”
we
mean
that
the
action
of
any
element
of
ΠS
induces
an
endomorphism
of
HDR
⊗
Q,
which
takes
HDR
into
the
subsheaf
of
HDR
⊗
Q
given
by
meromorphic
sections
of
HDR
which
are
integral
everywhere,
except
for
possible
poles
contained
in
the
divisor
stated.
Moreover,
the
Remark
following
Lemma
3.2
implies
that
if
we
put
a
metric
on
LC
(where
def
LC
=
L
⊗Z
C)
whose
curvature
on
the
ﬁbers
of
EC
→
SC
is
translation-invariant,
then
the
resulting
“étale
metric”
||
∼
||et
(cf.
Chapter
VIII,
Theorem
A,
(4))
is
preserved
by
the
action
of
ΠS
on
HDR
.
We
summarize
this
discussion
as
follows:
363
Theorem
3.3.
Let
S
log
be
any
connected
log
scheme,
whose
underlying
scheme
is
ﬂat
and
of
ﬁnite
type
over
Z,
and
such
that
the
log
structure
is
deﬁned
by
a
divisor
with
normal
crossings.
Fix
positive
integers
m,
d,
where
m
does
not
divide
d.
Let
C
log
→
S
log
be
a
log
elliptic
curve
over
S
log
,
and
η
∈
E∞,S
(S∞
)
be
a
torsion
point
of
order
precisely
m
satisfying
the
hypotheses
of
Chapter
VIII,
Theorem
A.
Fix
geometric
points
sd
,
s
of
d
E
(the
scheme
of
d-torsion
points
of
E∞,S
),
Int(S
log
)Q
such
that
sd
maps
to
s.
Write
def
ΠS
=
π1
((S
log
)Q
,
s)
log
for
the
algebraic
fundamental
group
of
Int(SQ
).
Let
us
assume
that
if
d
is
even,
then
ΠS
acts
trivially
on
the
2-torsion
points
of
the
given
log
elliptic
curve.
Fix
a
metric
on
def
LC
=
L
⊗Z
C
whose
curvature
on
the
ﬁbers
of
EC
→
SC
is
translation-invariant.
Then
there
is
a
natural
action
of
ΠS
on
the
metrized
vector
bundle
def
HDR
=
(fS
)∗
(L|
†
E∞,[d]
)<d
{∞,
et}
on
S
which
is
integral
(over
S)
except
for
possible
poles
contained
in
the
divisor
[η

(d
E)]
+
V
(4)
and
preserves
the
“étale
metric”
||
∼
||et
(cf.
Chapter
VIII,
Theorem
A)
determined
by
the
chosen
metric
on
L.
Next,
recall
that
the
metrized
vector
bundle
HDR
is
equipped
with
a
natural
ﬁltration,
which
we
refer
to
as
the
Hodge
ﬁltration.
The
subquotients
of
this
ﬁltration
admit
natural
isomorphisms
(cf.
Chapter
VIII,
Theorem
A,
(3)):
1
⊗j
(F
j+1
/F
j
)(HDR
)
∼
=
·
exp(−(aι
)j
)
·
(fS
)∗
(L|E∞,S
)
⊗OS
τE
j!
for
j
=
0,
.
.
.
,
d
−
1.
Here,
the
“exp(−(aι
)j
)”
are
powers
of
the
q-parameter,
as
in
Chapter
VIII,
Theorem
A,
(3),
i.e.,
j2
exp((aι
)j
)
=
q
≈
8d
Let
us
write
364
Filt(HDR
)
for
the
ﬂag
variety
over
S
of
ﬁltrations
of
HDR
which
are
of
the
same
“type”
(i.e.,
each
“F
j
”
has
the
same
rank
as
F
j
(HDR
))
as
the
Hodge
ﬁltration.
(Thus,
each
ﬁber
of
Filt(HDR
)
→
S
is
noncanonically
isomorphic
to
the
ﬂag
variety
of
ﬂags
F
1
(V
)
⊆
F
2
(V
)
⊆
.
.
.
F
d−1
(V
)
⊆
F
d
(V
)
=
V
in
a
d2
-dimensional
vector
space
V
for
which
dim(F
j
(V
))
=
j
·
d.)
Note
that
if
we
apply
the
action
of
ΠS
on
HDR
to
the
Hodge
ﬁltration,
we
thus
obtain
a
morphism
:
ΠS
→
Filt(HDR
)(S)
κarith
E
(where
the
“(S)”
denotes
the
“S-valued
points”).
Note
that
The
integrality
statements
of
Theorem
3.3
(at
both
the
ﬁnite
and
inﬁnite
primes)
imply
that
the
image
of
each
element
γ
∈
ΠS
under
κarith
is
a
E
j
to
denominators
contained
in
the
ﬁltration
{γ(F

(HDR
)}
such
that
(up
divisor
[η
(d
E)]+V
(4))
each
γ(F
j
(HDR
)}
is
globally
isomorphic
(i.e.,
isomorphic
as
a
vector
bundle
on
S,
equipped
with
a
metric
over
SC
)
to
F
j
(HDR
).
is
entirely
analogous
to
the
construction
of
the
Note,
further
that
the
construction
of
κarith
E
“group-theoretic
Kodaira-Spencer
morphism”
Poly
(E
†
))
κfunc
SL2
:
SL2
(R)
→
Filt(Holom
of
§1,
as
well
as
to
the
morphism
:
ΓR
→
τE⊗2
(1)
κarith,p
R
R
Qp
of
§2.
Deﬁnition
3.4.
We
shall
refer
to
κarith
:
ΠS
→
Filt(HDR
)(S)
E
as
the
arithmetic
Kodaira-Spencer
morphism
associated
to
E
→
S.
Example
3.5.
Suppose,
for
instance,
that
S
=
Spec(OK
)
365
where
OK
is
the
ring
of
integers
of
a
number
ﬁeld
K
(i.e.,
[K
:
Q]
<
∞).
Suppose,
moreover,
that
the
log
structure
of
S
log
is
deﬁned
by
the
divisor
Dred
⊆
S
(where
D
is
the
“divisor
at
inﬁnity”
associated
to
C
log
→
S
log
).
In
this
example,
let
us
assume
that
d
≥
12
def
def
and
write
d2
=
2ord2
(d)
(i.e.,
d2
divides
d
and
d/d2
is
odd).
Here,
let
us
take
m
=
2d2
,
n
=
4d2
.
Suppose
that
the
elliptic
curve
EK
over
K
is
suﬃciently
close
to
inﬁnity
at
all
the
archimedean
primes,
in
the
following
sense:
For
each
embedding
σ
of
K
into
C,
the
resulting
elliptic
curve
Eσ
(over
C)
can
be
written
as
Gm
/q
Z
,
where
q
=
exp(2πiτ
)
satisﬁes:
Im(τ
)
≥
200{log2
(d)
+
4d2
·
log(d)
+
4d2
·
log(4d2
)}
(Thus,
if
d
>>
d2
(for
instance,
if
d
is
odd,
in
which
case
d2
=
1),
then
the
lower
bound
on
Im(τ
)
goes
roughly
as
log2
(d).)
Note
that
it
is
not
diﬃcult,
for
a
ﬁxed
d,
to
construct
lots
of
examples
of
EK
satisfying
this
condition
at
the
archimedean
primes.
Now
it
follows
from
Chapter
VIII,
Theorem
A,
(4),
(C),
that:
e−33d
·
||
∼
||qCG
≤
1
·
e−32d
·
||
∼
||qCG
≤
||
∼
||et
≤
e4d
·
||
∼
||qCG
4d2
Thus,
in
particular,
it
follows
that
if
we
include
both
the
poles
at
the
ﬁnite
primes
(cf.
Theorem
3.3;
the
ﬁrst
Remark
following
Chapter
VI,
Theorem
4.1)
as
well
as
the
poles
at
the
archimedean
primes,
then:
The
global
divisor
of
poles
of
the
action
on
HDR
of
an
element
of
ΠS
has
Arakelov-theoretic
degree
(cf.
Chapter
I,
§1)
≤
38d
·
[K
:
Q],
and
is
concentrated
at
the
archimedean
primes,
and
the
primes
that
divide
m
=
2d2
.
(where
the
“38”
is
the
sum
of
the
“4”
and
the
“33”
appearing
in
the
inequalities
above,
plus
“1”
more,
to
take
care
of
the
contribution
from
the
ﬁnite
primes).
Put
another
way,
the
action
of
each
element
of
ΠS
maps
HDR
,
whose
subquotients
are
given
by
1
·
exp(−(aι
)j
)
·
τE⊗j
j!
(tensored
with
a
“common
factor”
of
(fS
)∗
(L|E∞,S
))
to
a
module
whose
subquotients
are
given
by
366
1
·
exp(−(aι
)j
)
·
τE⊗j
·
(poles)
j!
(tensored
with
a
“common
factor”
of
(fS
)∗
(L|E∞,S
))
—
where
the
“(poles)”
admit
bounds
as
described
in
the
italicized
caption
above
—
in
a
fashion
which
is
integral
at
all
the
primes
(both
archimedean
and
non-archimedean)
of
the
number
ﬁeld
K.
Remark.
It
is
thus
tempting,
relative
to
the
analogue
with
the
Kodaira-Spencer
morphism
in
the
geometric
case,
to
try
to
apply
this
theory
to
obtain
bounds
on
the
height
of
an
elliptic
curve
over
a
number
ﬁeld,
as
conjectured
by
Szpiro
and
Vojta
(cf.,
e.g.,
[Lang],
[Vojta]).
There
are,
unfortunately,
a
number
of
technical
diﬃculties
here.
Perhaps
the
most
obvious
is
the
factors
of
“exp(−(aι
)j
)”
that
appear
in
the
subquotients
–
we
refer
to
these
factors
as
Gaussian
poles
(since
they
grow
like
a
Gaussian
distribution)
–
since
these
factors
distort
one’s
ability
to
compute
degrees
as
one
would
like.
That
is
to
say,
by
analogy
to
the
geometric
case,
ideally
one
wishes
for
only
the
factor
“τE⊗j
·
(poles)”
to
appear
in
these
subquotients.
Relative
to
this
point
of
view,
poles
of
the
order
“C
j
≈
C
d
”
(as
j
→
d)
are
not
a
substantial
problem
(at
least
if
one
concentrates
on
the
subquotients
where
j
is
close
to
d),
since
this
just
adds
an
extra
constant
term
to
the
Arakelov-theoretic
degree
of
τE
.
From
this
point
of
view,
one
might
a
priori
think
that
the
factors
of
j!1
are
also
a
cause
for
concern
(since
they
are
not
of
the
order
C
d
).
Note
that
this
is
why,
in
the
theory
of
Chapter
VIII
–
cf.
especially
the
statement
concerning
analytic
torsion
and
the
product
formula
at
the
end
of
Chapter
VIII,
Theorem
A
–
we
were
so
concerned
with
making
sure
that
the
“denominators”
that
occurred
in
the
theory
at
the
archimedean
primes
were
of
the
order
“C
d
”
(i.e.,
even
when
one
takes
the
factors
of
j!1
mentioned
above
into
account).
Another
technical
diﬃculty
(by
comparison
to
the
geometric
case)
is
the
general
nonlinearity
that
appears
–
e.g.,
of
ΠS
,
by
comparison
to
the
tangent
bundle
in
the
geometric
case;
of
the
action
of
ΠS
on
HDR
,
which
does
not
appear
to
arise
from,
say,
taking
symmetric
powers
of
the
some
action
on
F
2
(HDR
),
as
in
the
geometric
case.
Perhaps
this
nonlinearity
is
not
surprising
in
view
of
the
general
phenomenon
that
Arakelov
theory
tends
to
give
rise
to
nonlinear
objects
which
are
analogous
to
linear
objects
in
the
classical
geometric
theory
(for
instance,
the
global
integral
sections
of
a
line
bundle
in
Arakelov
theory
are
not,
in
general,
closed
under
addition).
Yet
another
technical
diﬃculty
is
the
fact
that
in
Example
3.5
above,
we
needed
to
assume
that
EK
is
rather
close
to
inﬁnity
at
the
archimedean
primes.
It
is
the
hope
of
the
author
that
these
technical
diﬃculties
can
be
overcome
in
a
future
paper.
367
Appendix:
Formal
Uniformization
of
Smooth
Abelian
Group
Schemes
In
this
Appendix,
we
review
various
well-known
facts
concerning
the
“exponential
map”
of
an
abelian
group
scheme.
Let
S
be
a
noetherian
scheme.
Let
f
:G→S
be
a
smooth,
abelian
group
scheme
with
identity
section
e
:
S
→
G.
Observe
that
the
morphism
G
×S
G
→
G
×S
G
deﬁned
on
T
-valued
points
(where
T
is
an
S-scheme)
g,
h
∈
G(T
)
by
(g,
h)
→
(gh,
g)
induces
an
isomorphism
of
the
diagonal
embedding
G
→
G
×S
G
with
the
embedding
G
→
G
×S
G
given
by
g
→
(g,
e)
(where
e
is
the
identity
element).
Since
the
sheaf
of
diﬀerentials
ΩG/S
on
G
is
the
conormal
bundle
of
the
former
embedding,
we
thus
obtain
a
natural
isomorphism
f
∗
e∗
ΩG/S
∼
=
ΩG/S
Write
Ω
=
e∗
ΩG/S
def
Thus,
Ω
is
a
locally
free
sheaf
on
S,
and
the
above
isomorphism
induces
a
natural
morphism
Ω
→
f∗
ΩG/S
.
The
diﬀerentials
in
the
image
of
this
morphism
are
called
invariant
diﬀerentials
on
G.
Now
let
A
be
the
“pro-algebra”
(i.e.,
inverse
limit
of
ﬁnite
locally
free
OS
-algebras)
on
S
given
by
taking
the
completed
PD-envelope
in
G
of
e
(cf.,
e.g.,
[BO]
for
more
details).
Thus,
A
is
equipped
with
a
natural
augmentation
A
→
OS
(“evaluation
at
e”)
whose
kernel
I
is
a
PD-ideal
of
A.
If
n
is
a
positive
integer,
let
us
write
I
[n]
for
the
nth
divided
power
of
I.
Thus,
def
An
=
A/I
[n]
368
is
a
ﬁnite
locally
free
OS
-algebra,
and
I
[n]
/I
[n+1]
is
a
ﬁnite
locally
free
OS
-module.
Moreover,
A
is
complete
with
respect
to
the
ﬁltration
.
.
.
⊆
I
[n]
⊆
.
.
.
⊆
I
[2]
⊆
I
Intuitively
speaking,
if
x1
,
.
.
.
,
xr
are
a
complete
set
of
local
parameters
on
G
(over
S)
at
e,
then
A
may
be
described
as
the
ring
of
formal
power
series
in
divided
powers
of
the
xi
with
coeﬃcients
in
OS
.
Moreover,
note
that
A
may
be
regarded
as
also
being
equipped
with
an
OG
-algebra
structure
in
the
sense
that
one
has
a
coherent
system
of
natural
morphisms
Spec(An
)
→
G
(“Taylor
expansion
at
e
to
order
n
of
functions
on
G”).
Thus,
if,
for
instance,
F
is
a
locally
free
coherent
sheaf
on
G,
it
makes
sense
to
write
A
⊗OG
F.
Moreover,
A
⊗OG
F
will
be
a
locally
free
A-module
of
ﬁnite
rank.
In
the
following,
we
shall
denote
A
⊗OG
∧i
ΩG/S
by
ΩiA
.
Sometimes,
we
shall
want
to
consider
the
completed
PD-envelope
of
G
at
an
S-valued
point
x
∈
G(S)
of
G
which
is
not
equal
to
e.
Note,
however,
that
translation
by
x
induces
an
automorphism
Tx
:
G
→
G
which
maps
the
completed
PD-envelope
of
G
at
e
(i.e.,
A)
isomorphically
onto
the
completed
PD-envelope
of
G
at
x.
Thus,
in
the
following,
we
shall
identify
these
two
PDenvelopes
by
means
of
this
isomorphism.
Now
observe
that
by
formally
diﬀerentiating
power
series,
we
obtain
a
de
Rham
complex
of
“PD-functions”
d
A
−→
Ω1A
d
−→
Ω2A
d
−→
.
.
.
Composing
the
morphism
Ω
→
f∗
ΩG/S
constructed
above
with
restriction
to
Ω1A
then
gives
us
a
morphism
ι
:
Ω
→
Ω1A
Now
we
have
the
following
well-known
result:
Lemma
A.1.
Suppose
that
the
map
OS
→
OS
given
by
multplication
by
2
is
injective.
Then
the
composite
of
ι
with
the
exterior
derivative
d
is
zero.
Proof.
Since
G
is
abelian,
it
follows
that
the
automorphism
ν
:
G
→
G
given
by
inversion
is
a
group
homomorphism.
Note
that
ν
induces
natural
actions
ν
∗
on
Ω
and
on
the
ΩiA
.
Indeed,
ν
∗
acts
as
−1
on
Ω
and
as
(−1)i
on
ΩiA
.
Since
d
and
ι
are
natural,
ν
∗
acts
on
elements
in
the
image
of
d
◦
ι
by
multiplication
by
−1.
On
the
other
hand,
since
these
369
elements
are
sections
of
Ω2A
,
ν
∗
must
act
on
these
elements
as
the
identity.
Thus,
it
follows
that
Im(d
◦
ι)
is
annihilated
by
multiplication
by
2.
On
the
other
hand,
since
Ω2A
is
an
inverse
limit
of
locally
free
coherent
OS
-modules,
it
follows
from
the
assumption
of
the
Lemma
that
Im(d
◦
ι)
=
0,
as
desired.

Let
us
assume
for
the
rest
of
this
Appendix
that
the
assumption
of
Lemma
A.1
is
in
force.
Thus,
the
diﬀerentials
in
the
image
of
ι
are
closed,
and
hence,
by
formal
integration,
exact
(see,
e.g.,
[BO]
for
a
discussion
of
the
Poincaré
Lemma
in
the
context
of
PD-functions).
Moreover,
it
is
clear
(from
the
Poincaré
Lemma)
that
d
induces
an
isomorphism:
d
:
I
(⊆
A)
∼
=
{exact
diﬀerentials
of
Ω1A
}
Thus,
we
see
that
ι
lifts
to
a
natural
morphism
λ
:
Ω
→
I
whose
composite
with
the
projection
to
I/I
[2]
=
Ω
is
the
identity.
Deﬁnition
A.2.
Suppose
that
S
is
a
noetherian
scheme
such
that
multiplication
by
2
on
OS
is
injective.
Let
G
→
S
be
a
smooth,
abelian
group
scheme
over
S.
Then
we
shall
refer
to
the
natural
morphism
λ
:
Ω
→
I
just
constructed
as
the
logarithmic
uniformization
(morphism)
of
G.
Proposition
A.3.
The
morphism
λ
:
Ω
→
I
is
functorial
(in
the
obvious
sense)
with
respect
to
homomorphisms
G
→
H
of
smooth,
abelian
group
schemes
over
S.
Proof.
Indeed,
λ
is
determined
by
its
composite
with
the
exterior
diﬀerential
operator
d.
Thus,
it
suﬃces
to
observe
that
the
morphism
Ω
→
f∗
ΩG/S
constructed
above
is
functorial
in
G,
but
this
is
clear
from
its
construction.

Example
A.4.
Suppose
that
G
=
(Gm
)S
i.e.,
the
multiplicative
group
scheme
over
S.
One
may
think
of
G
as
the
spectrum
of
OS
[U,
U
−1
],
where
U
is
an
indeterminate.
Then
the
image
of
the
natural
morphism
370
Ω
→
f∗
ΩG/S
constructed
above
is
generated
by
dU/U
.
Moreover,
λ(dU/U
)
is
the
natural
logarithm
def
log(U
)
=
−
∞

(1
−
U
)i
i=1
Example
A.5.
i
Suppose
that
G
=
(Ga
)S
i.e.,
the
additive
group
scheme
over
S.
One
may
think
of
G
as
the
spectrum
of
OS
[T
],
where
T
is
an
indeterminate,
and
T
=
0
is
the
section
“e.”
Then
the
image
of
the
natural
morphism
Ω
→
f∗
ΩG/S
constructed
above
is
generated
by
dT
.
Moreover,
λ(dT
)
is
just
the
function
T
.
Finally,
before
proceeding,
we
recall
the
analogue
of
the
construction
above
at
the
inﬁnite
prime.
Thus,
let
C
denote
the
ﬁeld
of
complex
numbers.
Let
G
be
an
abelian
complex
Lie
group.
Thus,
G
is
“an
abelian
group
object”
in
the
category
of
complex
(i.e.,
holomorphic)
manifolds.
Let
Θ
(respectively,
Ω)
denote
the
tangent
(respectively,
cotangent)
space
to
G
at
the
origin.
Thus,
Θ
and
Ω
are
ﬁnite-dimensional
complex
vector
spaces
which
are
dual
to
one
another.
Now
one
knows
from
the
elementary
theory
of
complex
Lie
groups
(see,
e.g.,
[Vara])
that
there
exists
a
unique
holomorphic
morphism,
called
the
exponential
map
expG
:
Θ
→
G
compatible
with
the
additive
structures
of
Θ
and
G
and
whose
derivative
at
the
origin
is
the
identity
map
Θ
→
Θ.
Let
us
denote
by
Ahol
the
local
ring
of
holomorphic
functions
in
a
neighborhood
of
the
origin
of
G.
Thus,
Ahol
is
equipped
with
an
ideal
I
hol
⊆
Ahol
of
functions
vanishing
at
the
origin
of
G.
Since
expG
induces
an
isomorphism
between
the
local
rings
of
holomorphic
functions
in
a
neighbhorhood
of
the
origin
of
Θ
and
G,
we
thus
see
that
the
local
coordinate
functions
(i.e.,
elements
of
Ω)
on
Θ
deﬁne
elements
of
I
hol
,
i.e.,
we
have
a
natural
morphism
λhol
:
Ω
→
I
hol
which
is
the
holomorphic
analogue
of
the
algebraic
λ
constructed
above
in
the
following
sense:
Suppose
G
is
the
complex
Lie
group
deﬁned
by
some
abelian
group
scheme
G
over
371
C.
Then
both
Ahol
and
A
embed
naturally
in
the
ring
Afor
of
formal
functions
at
the
origin
of
G
(i.e.,
the
ring
obtained
by
completing
G
at
e).
Write
I
for
⊆
Afor
for
the
ideal
of
functions
vanishing
at
the
origin.
Thus,
since
both
I
hol
and
I
may
be
regarded
as
subsets
of
I
for
,
it
follows
that
both
λhol
and
λ
deﬁne
natural
morphisms
Ω
→
I
for
.
Proposition
A.6.
These
two
morphisms
Ω
→
I
for
coincide.
Proof.
Indeed,
it
is
clear
(from
the
theory
of
the
exponential
map)
that
the
exterior
derivative
d
of
the
image
of
λhol
gives
rise
to
(the
power
series
expansions
at
the
origin
of)
invariant
diﬀerentials
on
G.
Since
d
is
injective
on
I
for
,
this
completes
the
proof.

Bibliography
[BO]
P.
Berthelot
and
A.
Ogus,
Notes
on
Crystalline
Cohomology,
Princeton
Univ.
Press
(1978).
[Coln]
R.
Coleman,
Hodge-Tate
periods
and
p-adic
Abelian
integrals,
Inv.
Math.
78
(1984),
pp.
351-379.
[Colz]
P.
Colmez,
Périodes
p-adiques
des
variétés
abéliennes,
Math.
Ann.
292
(1992),
pp.
629-644.
[Falt1]
G.
Faltings,
p-adic
Hodge
Theory,
Journal
of
the
Amer.
Math.
Soc.
1,
No.
1
(1988),
pp.
255-299.
[Falt2]
G.
Faltings,
Crystalline
Cohomology
and
p-adic
Galois
Representations,
Proceedings
of
the
First
JAMI
Conference,
Johns-Hopkins
University
Press
(1990),
pp.
25-79.
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer-Verlag
(1990).
[Font]
J.
M.
Fontaine,
Formes
diﬀerentielles
et
modules
de
Tate
des
variétés
abéliennes
sur
les
corps
locaux,
Inv.
Math.
65
(1982),
pp.
379-409.
[Hyodo]
O.
Hyodo,
On
variation
of
Hodge-Tate
structures,
Math.
Ann.
284
(1989),
pp.
7-22.
[Katz]
N.
Katz,
Serre-Tate
Local
Moduli,
Algebraic
Surfaces
(Orsay,
1976-78),
Lecture
Notes
in
Mathematics
868,
Springer-Verlag
(1981),
pp.
138-202.
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
University
Press
(1985).
[Lang]
S.
Lang,
Introduction
to
Arakelov
Theory,
Springer-Verlag
(1988),
Appendix
by
Vojta.
[Mess]
W.
Messing,
The
Crystals
Associated
to
Barsotti-Tate
Groups;
with
Applications
to
Abelian
Schemes,
Lecture
Notes
in
Mathematics
264,
Springer-Verlag
(1972).
[Mumf]
D.
Mumford,
Abelian
Varieties,
Oxford
University
Press
(1974).
372
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
Publ.
of
RIMS
32
(1996),
pp.
957-1151.
[Mzk2]
S.
Mochizuki,
Foundations
of
p-adic
Teichmüller
Theory,
AMS/IP
Studies
in
Advanced
Mathematics
11,
American
Mathematical
Society/International
Press
(1999).
[Mzk3]
S.
Mochizuki,
The
Local
Pro-p
Anabelian
Geometry
of
Curves,
Inv.
Math.,
to
appear.
[Vara]
V.
S.
Varadarajan,
Lie
Groups,
Lie
Algebras,
and
their
Representations,
Prentice
Hall
(1974).
[Vojta]
P.
Vojta,
Diophantine
Approximations
and
Value
Distribution
Theory,
Lecture
Notes
in
Mathematics
1239,
Springer-Verlag
(1987).
[Wint]
J.-P.
Wintenberger,
Théorème
de
comparaison
p-adique
pour
les
schémas
abéliens.
I:
Construction
de
l’accouplement
de
périodes,
Périodes
p-Adiques,
Astérisque
223,
Soc.
Math.
de
France
(1994).
373
