The
Hodge-Arakelov
Theory
of
Elliptic
Curves:
Global
Discretization
of
Local
Hodge
Theories
by
Shinichi
Mochizuki
September
1999
Table
of
Contents
Introduction
Â§1.
Statement
of
the
Main
Results
Â§2.
Technical
Roots:
the
Work
of
Mumford
and
Zhang
Â§3.
Conceptual
Roots:
the
Search
for
a
Global
Hodge
Theory
Â§3.1.
From
Absolute
Diï¬€erentiation
to
Comparison
Isomorphisms
Â§3.2.
A
Function-Theoretic
Comparison
Isomorphism
Â§3.3.
The
Meaning
of
Nonlinearity
Â§3.4.
Hodge
Theory
at
Finite
Resolution
Â§3.5.
Relationship
to
Ordinary
Frobenius
Liftings
and
Anabelian
Varieties
Â§4.
Guide
to
the
Text
Â§5.
Future
Directions
Â§5.1.
Gaussian
Poles
and
the
Theta
Convolution
Â§5.2.
Higher
Dimensional
Abelian
Varieties
and
Hyperbolic
Curves
Chapter
I:
Torsors
in
Arakelov
Theory
Â§0.
Introduction
Â§1.
Arakelov
Theory
in
Geometric
Dimension
Zero
Â§2.
Deï¬nition
and
First
Properties
of
Torsors
Â§3.
Splittings
with
Bounded
Denominators
Â§4.
Examples
from
Geometry
Chapter
II:
The
Galois
Action
on
Torsion
Points
Â§0.
Introduction
Â§1.
Some
Elementary
Group
Theory
Â§2.
The
Height
of
an
Elliptic
Curve
Â§3.
The
Galois
Action
on
the
Torsion
of
a
Tate
Curve
Â§4.
An
Eï¬€ective
Estimate
of
the
Image
of
Galois
1
Chapter
III:
The
Universal
Extension
of
a
Log
Elliptic
Curve
Â§0.
Introduction
Â§1.
Deï¬nition
of
the
Universal
Extension
Â§2.
Canonical
Splitting
at
Inï¬nity
Â§3.
Canonical
Splittings
in
the
Complex
Case
Â§4.
Hodge-Theoretic
Interpretation
of
the
Universal
Extension
Â§5.
Analytic
Continuation
of
the
Canonical
Splitting
Â§6.
Higher
Schottky-Weierstrass
Zeta
Functions
Â§7.
Canonical
Schottky-Weierstrass
Zeta
Functions
Chapter
IV:
Theta
Groups
and
Theta
Functions
Â§0.
Introduction
Â§1.
Mumfordâ€™s
Algebraic
Theta
Functions
Â§2.
Theta
Actions
and
the
Schottky
Uniformization
Â§3.
Twisted
Schottky-Weierstrass
Zeta
Functions
Â§4.
Zhangâ€™s
Theory
of
Metrized
Line
Bundles
Â§5.
Theta
Groups
and
Metrized
Line
Bundles
Chapter
V:
The
Evaluation
Map
Â§0.
Introduction
Â§1.
Construction
of
Certain
Metrized
Line
Bundles
Â§2.
The
Deï¬nition
of
the
Evaluation
Map
Â§3.
Extension
of
the
Etale-Integral
Structure
Â§4.
Linear
Relations
Among
Higher
Schottky-Weierstrass
Zeta
Functions
Â§5.
The
Determinant
of
the
Evaluation
Map
Â§6.
The
Generic
Case
Chapter
VI:
The
Scheme-Theoretic
Comparison
Theorem
Â§0.
Introduction
Â§1.
Deï¬nition
of
a
New
Integral
Structure
at
Inï¬nity
Â§2.
Compatibility
with
Base-Change
Â§3.
The
Comparison
Isomorphism
in
Characteristic
Zero
Â§4.
The
Comparison
Isomorphism
in
Mixed
Characteristic
Chapter
VII:
The
Geometry
of
Function
Spaces:
Systems
of
Orthogonal
Functions
Â§0.
Introduction
Â§1.
The
Orthogonalization
Problem
Â§2.
Review
of
Legendre
and
Hermite
Polynomials
Â§3.
Discrete
Tchebycheï¬€
Polynomials
and
the
Fundamental
Combinatorial
Model
Â§4.
The
KaÌˆhler
Geometry
of
a
Polarized
Elliptic
Curve
Â§5.
The
Relationship
Between
de
Rham
and
Canonical
Schottky-Weierstrass
Zeta
Functions
Â§6.
Diï¬€erential
Calculus
on
the
Theta-Weighted
Circle
2
Chapter
VIII:
The
Hodge-Arakelov
Comparison
Theorem
Â§0.
Introduction
Â§1.
Averages
of
Metrics
Â§2.
The
Legendre
Model
Â§3.
The
Truncated
Binomial
Model
Â§4.
The
Combinatorics
of
the
Full
Binomial
Model
Â§5.
The
Full
Binomial
Model
Â§6.
Relations
Among
Various
Norms
and
Zeta
Functions
Â§7.
The
Comparison
Isomorphism
at
the
Inï¬nite
Prime
Chapter
IX:
The
Arithmetic
Kodaira-Spencer
Morphism
Â§0.
Introduction
Â§1.
The
Complex
Case:
The
Classical
â€œModular
Theoryâ€
of
the
Upper
Half-Plane
Â§2.
The
p-adic
Case:
The
Hodge-Tate
Decomposition
as
an
Evaluation
Map
Â§3.
The
Global
Arithmetic
Case:
Application
of
the
Hodge-Arakelov
Comparison
Isomorphism
Appendix:
Formal
Uniformization
of
Smooth
Abelian
Group
Schemes
3
Introduction
Â§1.
Statement
of
the
Main
Results
The
main
result
of
this
paper
is
a
Comparison
Theorem
(cf.
Theorem
A
below)
for
elliptic
curves,
which
states
roughly
that:
The
space
of
â€œpolynomial
functionsâ€
of
degree
(roughly)
<
d
on
the
universal
extension
of
an
elliptic
curve
maps
isomorphically
via
restriction
to
the
space
of
(set-theoretic)
functions
on
the
d-torsion
points
of
the
universal
extension.
This
rough
statement
is
essentially
precise
for
(smooth)
elliptic
curves
over
ï¬elds
of
characteristic
zero.
For
elliptic
curves
in
mixed
characteristic
and
degenerating
elliptic
curves,
this
statement
may
be
made
precise
(i.e.,
the
restriction
map
becomes
an
isomorphism)
if
one
modiï¬es
the
â€œintegral
structureâ€
on
the
space
of
polynomial
functions
in
an
appropriate
fashion.
Similarly,
in
the
case
of
elliptic
curves
over
the
complex
numbers,
one
can
ask
whether
or
not
one
obtains
an
isometry
if
one
puts
natural
archimedean
metrics
on
the
spaces
involved.
In
this
paper,
we
also
compute
precisely
what
modiï¬cation
to
the
integral
structure/metrics
in
all
of
these
cases
(i.e.,
at
p-adic
and
archimedean
primes,
and
for
degenerating
elliptic
curves)
is
necessary
to
obtain
an
isomorphism
(or
something
very
close
to
an
isomorphism).
In
characteristic
zero,
the
universal
extension
of
an
elliptic
curve
may
be
regarded
as
the
de
Rham
cohomology
of
the
elliptic
curve,
with
coeï¬ƒcients
in
the
sheaf
of
invertible
functions
on
the
curve.
On
the
other
hand,
the
torsion
points
of
the
elliptic
curve
may
be
regarded
as
a
portion
of
the
eÌtale
cohomology
of
the
elliptic
curve.
Thus,
one
may
regard
this
Comparison
Theorem
as
a
sort
of
isomorphism
between
the
de
Rham
and
eÌtale
cohomologies
of
the
elliptic
curve,
given
by
considering
functions
on
each
of
the
respective
cohomology
spaces.
When
regarded
from
this
point
of
view,
this
Comparison
Theorem
may
be
thought
of
as
a
sort
of
discrete
or
Arakelov-theoretic
analogue
of
the
usual
comparison
theorems
between
de
Rham
and
eÌtale/singular
cohomology
in
the
complex
and
p-adic
cases.
This
analogy
with
the
â€œclassicalâ€
local
comparison
theorems
can
be
made
very
precise,
and
is
one
of
the
main
topics
of
Chapter
IX.
Using
this
point
of
view,
we
apply
the
Comparison
Theorem
to
construct
a
global/Arakelov-theoretic
analogue
for
elliptic
curves
over
number
ï¬elds
of
the
Kodaira-Spencer
morphism
of
a
family
of
elliptic
curves
over
a
geometric
base.
This
arithmetic
Kodaira-Spencer
morphism
is
studied
in
Chapter
IX.
4
Suppose
that
E
is
an
elliptic
curve
over
a
ï¬eld
K
of
characteristic
zero.
Let
d
be
a
positive
integer,
and
Î·
âˆˆ
E(K)
a
torsion
point
of
order
not
dividing
d.
Write
def
L
=
OE
(d
Â·
[Î·])
for
the
line
bundle
on
E
corresponding
to
the
divisor
of
multiplicity
d
with
support
at
the
point
Î·.
Write
Eâ€ 
â†’
E
for
the
universal
extension
of
the
elliptic
curve,
i.e.,
the
moduli
space
of
pairs
(M,
âˆ‡M
)
consisting
of
a
degree
zero
line
bundle
M
on
E,
together
with
a
connection
âˆ‡M
.
Thus,
E
â€ 
is
an
aï¬ƒne
torsor
on
E
under
the
module
Ï‰E
of
invariant
diï¬€erentials
on
E.
In
particular,
since
E
â€ 
is
(Zariski
locally
over
E)
the
spectrum
of
a
polynomial
algebra
in
one
variable
with
coeï¬ƒcients
in
the
sheaf
of
functions
on
E,
it
makes
sense
to
speak
of
the
â€œrelative
degree
over
Eâ€
â€“
which
we
refer
to
in
this
paper
as
the
torsorial
degree
â€“
of
a
function
on
E
â€ 
.
Note
that
(since
we
are
in
characteristic
zero)
the
subscheme
d
E
â€ 
âŠ†
E
â€ 
of
d-torsion
points
of
E
â€ 
maps
isomorphically
to
the
subscheme
d
E
âŠ†
E
of
d-torsion
points
of
E.
Then
in
its
simplest
form,
the
main
result
of
this
paper
states
the
following:
Theorem
Asimple
.
Let
E
be
an
elliptic
curve
over
a
ï¬eld
K
of
characteristic
zero.
Write
E
â€ 
â†’
E
for
its
universal
extension.
Let
d
be
a
positive
integer,
and
Î·
âˆˆ
E(K)
a
torsion
def
point
whose
order
does
not
divide
d.
Write
L
=
OE
(d
Â·
[Î·]).
Then
the
natural
map
Î“(E
â€ 
,
L)<d
â†’
L|
dE
â€ 
given
by
restricting
sections
of
L
over
E
â€ 
whose
torsorial
degree
is
<
d
to
the
d-torsion
points
of
E
â€ 
is
a
bijection
between
K-vector
spaces
of
dimension
d2
.
The
remainder
of
the
main
theorem
essentially
consists
of
specifying
precisely
how
one
must
modify
the
integral
structure
of
Î“(E
â€ 
,
L)<d
over
more
general
bases
in
order
to
obtain
an
isomorphism
at
the
ï¬nite
and
inï¬nite
primes
of
a
number
ï¬eld,
as
well
as
for
degenerating
elliptic
curves.
To
state
the
main
theorem
in
its
more
general
form,
it
is
natural
to
work
over
a
ï¬ne
noetherian
log
scheme
S
log
(cf.
[Kato]).
Over
the
base
S
log
,
we
consider
what
we
call
a
log
elliptic
curve
C
log
â†’
S
log
(cf.
Chapter
III,
Deï¬nition
1.1),
i.e.,
the
result
of
pulling
back,
via
some
morphism
S
log
â†’
log
log
log
(M1,0
)Z
,
the
universal
log
curve
C
log
â†’
(M1,0
)Z
.
Here,
(M1,0
)Z
is
the
log
moduli
stack
5
of
elliptic
curves
over
Z,
equipped
with
its
natural
log
structure
deï¬ned
by
the
divisor
at
inï¬nity,
and
C
â†’
(M1,0
)Z
is
the
unique
(proper)
semi-stable
curve
of
genus
1,
which
we
equip
with
the
log
structure
deï¬ned
by
the
divisor
in
C
which
is
the
pull-back
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
.
In
the
general
version
of
the
main
theorem,
we
must
use
line
bundles
â€“
which
play
the
role
of
the
line
bundle
L
in
Theorem
Asimple
â€“
equipped
with
a
metric
as
in
[Zh]
in
a
neighborhood
of
the
divisor
at
inï¬nity
D
âŠ†
S.
These
metrized
line
bundles
â€œLâ€
live
on
a
â€œZhang-theoretic
versionâ€
Eâˆ,S
â†’
Sâˆ
of
C
log
â†’
S
log
(cf.
Chapter
IV,
Â§4,5),
and
are
discussed
in
detail
in
Chapter
V,
Â§1.
For
smooth
elliptic
curves,
these
line
bundles
are
exactly
the
same
as
the
line
bundle
â€œLâ€
of
Theorem
Asimple
.
Next,
it
turns
out
that
at
ï¬nite
primes
the
universal
extension
E
â€ 
â†’
E
is
not
quite
adequate;
instead,
one
must
modify
it
by
multiplying
the
Ï‰E
-portion
of
E
â€ 
by
a
factor
of
â€ 
d
(cf.
Chapter
V,
Â§2).
The
resulting
object
E[d]
â†’
E
is
an
Ï‰E
-torsor
which
coincides
with
E
â€ 
over
bases
on
which
d
is
invertible.
In
a
neighborhood
of
the
divisor
at
inï¬nity,
one
â€ 
must
consider
a
version
of
E[d]
which
is
compatible
with
Zhangâ€™s
theory
of
metrized
line
â€ 
bundles.
This
version
of
E[d]
is
denoted
by
â€ 
Eâˆ,[d]
â€ 
(cf.
Chapter
V,
Â§2).
For
smooth
elliptic
curves
in
characteristic
zero,
Eâˆ,[d]
is
the
same
as
E
â€ 
.
In
the
general
form
of
Theorem
A,
we
would
like
to
consider
sections
of
the
metrized
â€ 
line
bundle
L
over
Eâˆ,[d]
of
torsorial
degree
<
d.
It
turns
out,
however,
that
if
one
just
considers
the
usual
global
section
or
push-forward
functor
in
the
naive
sense,
then
one
does
not
get
the
desired
isomorphism
at
ï¬nite
or
degenerating
primes.
In
order
to
get
the
desired
isomorphism
at
such
primes,
one
must
modify
the
integral
structure
at
those
primes.
The
resulting
push-forward
functor
is
denoted
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et}
(cf.
Chapter
VI,
Deï¬nition
1.3).
For
smooth
elliptic
curves
in
characteristic
zero,
this
push-forward
is
the
same
as
the
usual
one.
Finally,
by
restricting
such
sections
of
L
over
â€ 
â€ 
â€ 
Eâˆ,[d]
to
the
d-torsion
points
d
Eâˆ
in
Eâˆ,[d]
,
one
obtains
an
evaluation
map
Î{âˆ,
et}
:
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et}
â†’
(fS
)âˆ—
(L|
â€ 
)
(d
Eâˆ
)
(cf.
Chapter
V,
Proposition
2.2;
Chapter
VI,
Theorem
3.1
(1)).
For
smooth
elliptic
curves
in
characteristic
zero,
this
is
the
same
as
the
map
considered
in
Theorem
Asimple
.
6
We
are
now
ready
to
state
the
main
theorem
of
this
paper
(cf.
Chapter
VIII,
Â§0,
Theorem
A):
Theorem
A.
(The
Hodge-Arakelov
Comparison
Isomorphism)
Let
d,
m
â‰¥
1
be
integers
such
that
m
does
not
divide
d.
Suppose
that
S
log
is
a
ï¬ne
noetherian
log
scheme,
and
let
C
log
â†’
S
log
be
a
log
elliptic
curve
over
S
log
such
that
the
divisor
at
inï¬nity
D
âŠ†
S
(i.e.,
the
pullback
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
via
the
classifying
morphism
S
â†’
(M1,0
)Z
)
is
a
Cartier
divisor
on
S.
Also,
let
us
assume
that
eÌtale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root,
and
that
we
are
given
a
torsion
point
Î·
âˆˆ
Eâˆ,S
(Sâˆ
)
ev
of
order
precisely
m
which
deï¬nes
line
bundles
Lst,Î·
,
Lst,Î·
(cf.
Chapter
V,
Â§1).
If
d
is
def
ev
def
odd
(respectively,
even),
then
let
L
=
Lst,Î·
(respectively,
L
=
Lst,Î·
).
Then:
(1)
(Compatibility
with
Base-Change)
The
formation
of
the
push-forward
(cf.
Chapter
VI,
Deï¬nition
1.3)
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et}
(along
with
its
natural
ï¬ltration
by
torsorial
degree)
commutes
with
base-change
(among
bases
S
log
satisfying
the
hypotheses
given
above).
(2)
(Zero
Locus
of
the
Determinant)
Assume
that
S
is
Z-ï¬‚at.
The
schemetheoretic
zero
locus
of
the
determinant
det(Î{âˆ,
et}),
i.e.,
the
determinant
of
the
evaluation
map
(cf.
Chapter
V,
Proposition
2.2;
Chapter
VI,
Theorem
3.1,
(1))
Î{âˆ,
et}
:
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et}
â†’
(fS
)âˆ—
(L|
is
given
by
the
divisor
d
Â·
[Î·
â€ 
)
(d
Eâˆ
)

7
(d
E)]
(where
d
E
is
the
kernel
of
multiplication
by
d
on
Ed
).
In
fact,
the
divisor
of
poles

of
the
inverse
morphism
to
Î{âˆ,
et}
is
contained
in
the
divisor
[Î·
(d
E)].
(3)
(Analytic
Torsion
at
the
Divisor
at
Inï¬nity)
For
each
Î¹,
there
is
a
sequence
of
elements
aÎ¹
=
{(aÎ¹
)0
,
.
.
.
,
(aÎ¹
)dâˆ’1
};
(aÎ¹
)j
â‰ˆ
j2
8d
2
j
of
Qâ‰¥0
Â·
log(q),
where
(aÎ¹
)j
goes
roughly
(as
a
function
of
j)
as
8d
(cf.
Chapter
VI,
Theorem
3.1,
(2)),
such
that
the
subquotients
of
the
natural
ï¬ltration
on
the
domain
of
Î{âˆ,
et}
admits
natural
isomorphisms:
(F
j+1
/F
j
)((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et})
âˆ’â†’
1
Â·
exp(âˆ’(aÎ¹
)j
)
Â·
(fS
)âˆ—
(L|Eâˆ,S
)
âŠ—OS
Ï„EâŠ—j
j!
(where
Ï„E
is
the
dual
of
Ï‰E
)
for
j
=
0,
.
.
.
,
dâˆ’1.
Moreover,
the
sections
of
L|
â€ 
Eâˆ,[d]
that
realize
these
bijections
have
q-expansions
in
a
neighborhood
of
inï¬nity
that
are
given
explicitly
in
Chapter
V,
Theorem
4.8.
(4)
(Integrality
Properties
at
the
Inï¬nite
Prime)
Suppose
that
D
=
âˆ…,
and
S
â€ 
â€ 
is
of
ï¬nite
type
over
C.
Let
us
then
write
L,
Î,
E
â€ 
,
E
for
L,
Î{âˆ,
et},
Eâˆ
,
d
d
[d]
â€ 
Eâˆ,[d]
.
Then
one
may
equip
L
with
a
(smooth,
i.e.,
C
âˆ
)
metric
|
âˆ¼
|L
whose
curvature
is
translation-invariant
on
the
ï¬bers
of
E
â†’
S.
Moreover,
such
a
metric
is
unique
up
to
multiplication
by
a
(smooth)
positive
function
on
S(C).
Then
|
âˆ¼
|L
deï¬nes
a
metric
on
the
vector
bundle
(fS
)âˆ—
(L|
â€ 
)
(i.e.,
the
range
dE
of
Î),
namely,
the
L
-metric
for
â€œL-valued
functions
on
d
E
â€ 
â€
(where
we
assume
that
the
total
mass
of
d
E
â€ 
is
1).
Since
Î
is
an
isomorphism,
this
metric
thus
induces
a
metric
on
(fS
)âˆ—
(L|
â€ 
)<d
(i.e.,
the
domain
of
Î),
which
we
denote
by
2
E[d]
||
âˆ¼
||et
and
refer
to
as
the
eÌtale
metric.
On
the
other
hand,
by
using
the
canonical
real
â€ 
analytic
splitting
of
E[d]
(C)
â†’
E(C)
(i.e.,
the
unique
splitting
which
is
a
continuous
homomorphism),
we
may
split
sections
of
(fS
)âˆ—
(L|
â€ 
)<d
into
components
E[d]
âŠ—r
which
are
real
analytic
sections
of
L
âŠ—
Ï„E
(where
r
<
d)
over
E(C).
Since
Ï„E
gets
a
natural
metric
by
square
integration
over
E,
these
components
have
natural
8
L2
-norms
determined
by
integrating
their
|
âˆ¼
|2L
over
the
ï¬bers
of
E(C)
â†’
S(C).
This
deï¬nes
what
we
refer
to
as
the
de
Rham
metric
||
âˆ¼
||DR
on
(fS
)âˆ—
(L|
â€ 
)<d
.
The
relationship
between
the
eÌtale
and
de
Rham
metrics
may
E[d]
be
described
using
three
â€œmodelsâ€:
(A.)
The
Hermite
Model:
This
model
states
that
if
we
ï¬x
r
<
d,
and
let
d
â†’
âˆ,
then
over
any
compact
subset
of
S(C),
the
eÌtale
metric
||
âˆ¼
||et
on
F
r
((fS
)âˆ—
(L|
â€ 
)<d
)
converges
(up
to
a
factor
â‰¤
eÏ€+r
,
â‰¥
1)
E[d]
to
the
metric
||
âˆ¼
||DR
,
as
well
as
to
a
certain
metric
â€œ||
âˆ¼
||HMd
â€
deï¬ned
by
considering
Hermite
polynomials
scaled
by
a
factor
of
âˆš
(constant)Â·
d
in
the
derivatives
of
the
theta
functions
âˆˆ
(fS
)âˆ—
(L|E
)
=
F
1
((fS
)âˆ—
(L|
â€ 
)<d
).
E[d]
(B.)
The
Legendre
Model:
This
model
states
(roughly)
that
over
any
compact
subset
of
S(C),
a
certain
average
â€“
which
we
denote
||
âˆ¼
||w,Î¼a
â€“
of
translates
of
the
eÌtale
metric
||
âˆ¼
||et
on
(fS
)âˆ—
(L|
â€ 
)<d
E[d]
is
equal
(provided
d
â‰¥
25),
up
to
a
factor
of
(constant)
,
to
the
de
Rham
metric
||
âˆ¼
||DR
,
as
well
as
to
a
certain
metric
â€œ||
âˆ¼
||Tch
â€
deï¬ned
by
considering
discrete
Tchebycheï¬€
polynomials
scaled
by
a
factor
of
d
in
the
derivatives
of
the
theta
functions
âˆˆ
(fS
)âˆ—
(L|E
)
=
F
1
((fS
)âˆ—
(L|
â€ 
)<d
).
These
discrete
Tchebycheï¬€
polynomials
are
disd
E[d]
crete
versions
of
the
Legendre
polynomials,
and
in
fact,
if
we
let
d
â†’
âˆ
with
the
said
scaling
by
d,
then
the
discrete
Tchebycheï¬€
polynomials
converge
uniformly
to
the
Legendre
polynomials.
(C.)
The
Binomial
Model:
This
model
involves
the
explicit
q-expansions
(where
we
write
E
=
Gm
/q
Z
,
and
q
is
a
holomorphic
function
which
is
deï¬ned,
at
least
locally,
on
S(C))
referred
to
in
(3)
above,
which
are
essentially
binomial
coeï¬ƒcient
polynomials
(scaled
by
1)
in
the
derivatives
of
the
theta
functions
âˆˆ
(fS
)âˆ—
(L|E
)
=
F
1
((fS
)âˆ—
(L|
â€ 
)<d
).
E[d]
If
we
divide
these
functions
by
appropriate
powers
of
q,
then
the
norm
||
âˆ¼
||qCG
for
which
these
functions
divided
by
powers
of
q
are
orthonormal
satisï¬es
the
following
property:
If
d
â‰¥
12,
and
Im(Ï„
)
â‰¥
200{log2
(d)
+
n
Â·
log(d)
+
n
Â·
log(n)}
(where
q
=
exp(2Ï€iÏ„
)),
then:
nâˆ’1
Â·
eâˆ’32d
Â·
||
âˆ¼
||qCG
â‰¤
||
âˆ¼
||et
â‰¤
e4d
Â·
||
âˆ¼
||qCG
9
Here,
the
factor
of
nâˆ’1
that
appears
is
the
exact
archimedean
analogue
of
the
poles
that
appeared
at
ï¬nite
primes
in
(2)
above.
Finally,
for
each
of
these
three
models,
the
combinatorial/arithmetic
portion
of
the
analytic
torsion
(i.e.,
the
portion
not
arising
from
letting
the
elliptic
curve
E
degenerate
â€“
cf.
(3)
above
for
the
portion
arising
from
degeneration
of
the
elliptic
curve)
induced
on
(F
r+1
/F
r
)((fS
)âˆ—
(L|
â€ 
)<d
)
by
the
metrics
||
âˆ¼
||DR
;
||
âˆ¼
||HMd
;
||
âˆ¼
||Tch
;
||
âˆ¼
||w,Î¼a
;
E[d]
||
âˆ¼
||qCG
(in
their
respective
domains
of
applicability)
as
r
â†’
d,
goes
(modulo
factors
of
the
order
(constant)d
)
as
â‰ˆ
(r!)âˆ’1
â‰ˆ
(d!)âˆ’1
which
is
precisely
what
you
would
expect
by
applying
the
product
formula
to
the
computation
of
the
â€œanalytic
torsionâ€
in
the
ï¬nite
prime
case,
which
consists
of
a
factor
of
precisely
(r!)âˆ’1
(cf.
Chapter
V,
Theorem
3.1;
Chapter
VI,
Theorem
4.1;
Chapter
VII,
Proposition
3.4).
In
particular,
Theorem
A,
(3),
tells
us
that
the
necessary
modiï¬cation
to
the
integral
structure
of
the
degree
j
portion
of
the
push-forward
at
the
p-adic
and
degenerating
primes
is
a
factor
of
âˆ’j
2
1
Â·
q
8d
j!
âˆ’j
2
The
factor
q
8d
involving
the
q-parameter
is
of
fundamental
importance
in
the
theory
of
this
paper.
Because
(as
a
function
of
j)
this
factor
varies
like
a
â€œGaussian
exp(âˆ’x2
)â€
and
gives
rise
to
poles
(relative
to
the
usual
push-forward)
in
the
modiï¬ed
push-forward
that
we
consider
in
Theorem
A,
we
refer
to
the
modiï¬cation
in
integral
structure
arising
from
1
in
the
exponent
may
be
justiï¬ed
by
the
this
factor
as
the
Gaussian
poles.
The
factor
of
8d
following
calculation:
On
the
one
hand,
if
one
thinks
in
terms
of
degrees
of
vector
bundles
on
(M1,0
)C
,
the
degree
of
the
usual
push-forward
goes
roughly
as
dâˆ’1

j=0
deg(Ï„EâŠ—j
)
=
dâˆ’1

j
Â·
deg(Ï„E
)
â‰ˆ
j=0
d2
1
2
1
1
d
Â·
deg(Ï„E
)
=
âˆ’
d2
Â·
log(q)
=
âˆ’
Â·
log(q)
2
2
12
24
where
â€œlog(q)â€
is
a
symbol
that
stands
for
the
element
in
Pic((M1,0
)C
)
deï¬ned
by
the
divisor
at
inï¬nity.
(It
turns
out
that
the
contribution
to
the
degree
by
the
line
bundle
L
is
negligible.)
On
the
other
hand,
the
sum
of
the
degrees
resulting
from
the
Gaussian
poles
is
dâˆ’1
2

j
j=0
8d
Â·
log(q)
â‰ˆ
1
3
1
d2
d
Â·
Â·
log(q)
=
Â·
log(q)
3
8d
24
10
1
In
other
words,
the
factor
of
8d
is
just
enough
to
make
the
total
degree
0.
Since
the
restriction
of
L
to
the
torsion
points
is
(essentially)
a
â€œtorsion
line
bundleâ€
(i.e.,
some
tensor
power
of
it
is
trivial),
the
degree
of
the
range
of
the
evaluation
map
is
zero
â€“
i.e.,
the
1
is
just
enough
to
make
the
degrees
of
the
domain
and
range
of
the
evaluation
factor
of
8d
map
of
Theorem
A
equal
(which
is
natural,
since
we
want
this
evaluation
map
to
be
an
isomorphism).
In
fact,
It
turns
out
that
the
proof
of
the
scheme-theoretic
portion
of
Theorem
A
in
Chapter
VI,
Â§3,4,
is
based
on
precisely
this
sort
of
â€œsummation
of
degreesâ€
argument.
In
this
proof,
however,
in
order
to
get
an
exact
isomorphism,
it
is
necessary
to
compute
all
the
degrees
involved
precisely.
This
computation
requires
a
substantial
amount
of
work
(involving,
for
instance,
the
theory
of
[Zh])
and
is
carried
out
in
Chapters
IV,
V,
VI.
On
the
other
hand,
the
key
point
of
the
archimedean
portion
of
Theorem
A
is
the
comparison
of
the
eÌtale
and
de
Rham
metrics
||
âˆ¼
||et
,
||
âˆ¼
||DR
.
Unfortunately,
we
are
unable
to
prove
a
simple
sharp
result
that
they
always
coincide.
Instead,
we
choose
three
natural
â€œdomains
of
investigationâ€
â€“
which
we
refer
to
as
models
â€“
where
we
compare
these
two
metrics
using
a
particular
system
of
functions
which
are
well-adapted
to
the
domain
of
investigation
in
question.
One
of
the
most
important
features
of
these
three
models
is
that
they
each
have
natural
scaling
factors
associated
to
them.
The
three
models,
along
with
their
natural
scaling
factors,
and
natural
domains
of
applicability
are
as
follows:
1
Hermite
Model
(scaling
factor
=
d
2
)
:
nondegenerating
E,
ï¬xed
r
<
d
Legendre
Model
(scaling
factor
=
d)
:
nondegenerating
E,
varying
r
<
d
Binomial
Model
(scaling
factor
=
1)
:
degenerating
E
It
is
interesting
to
observe
that
the
exponents
appearing
in
these
scaling
factors,
i.e.,
0,
12
,
1,
which
we
refer
to
as
slopes,
are
precisely
the
same
as
the
slopes
that
appear
when
one
considers
the
action
of
Frobenius
on
the
crystalline
cohomology
of
an
elliptic
curve
at
a
ï¬nite
prime
â€“
cf.
the
discussions
at
the
end
of
Chapter
VII,
Â§3,
6,
for
more
on
this
analogy.
Finally,
we
apply
Theorem
A
to
construct
an
arithmetic
analogue
of
the
KodairaSpencer
morphism,
as
follows.
In
the
following
discussion,
we
write
def
Î S
=
Ï€1
((S
log
)Q
,
s)
def
for
the
algebraic
fundamental
group
of
the
base
S
log
.
Thus,
if
S
=
Spec(OK
),
where
OK
is
the
ring
of
integers
of
a
number
ï¬eld
K,
then
Î S
=
Gal(K/K)
is
the
absolute
Galois
group
of
K.
In
this
discussion,
we
make
the
technical
assumption
that
if
d
is
even,
then
Î S
acts
trivially
on
the
2-torsion
of
the
elliptic
curve
in
question.
Then
it
follows
from
Mumfordâ€™s
11
theory
of
algebraic
theta
functions
that
Î S
acts
naturally
(up
to
poles
annihilated
by
4)
on
the
range
of
the
Comparison
Isomorphism
of
Theorem
A.
Thus,
Theorem
A
tells
us
that,
by
transport
of
structure,
we
get
an
action
of
Î S
on
the
domain
of
the
Comparison
Isomorphism
which
is
(roughly)
integral
at
all
primes
(ï¬nite
and
inï¬nite).
Since
this
domain
is
equipped
with
a
natural
Hodge
ï¬ltration,
we
thus
get
a
morphism
:
Î S
â†’
Filt(HDR
)(S)
Îºarith
E
where
Filt(HDR
)(S)
is
a
certain
ï¬‚ag
variety
of
ï¬ltrations
of
the
domain
of
the
Comparison
Isomorphism,
which
we
denote
by
HDR
(since
it
is
a
sort
of
de
Rham
cohomology).
This
morphism,
which
we
refer
to
as
the
arithmetic
Kodaira-Spencer
morphism
of
the
given
family
of
elliptic
curves,
has
remarkable
integrality
properties
(cf.
the
discussion
preceding
Chapter
IX,
Deï¬nition
3.4).
In
Chapter
IX,
Â§1,2,
we
explain
in
detail
how
this
arithmetic
Kodaira-Spencer
morphism
is
a
very
precise
analogue
of
the
classical
Kodaira-Spencer
morphism
for
families
of
complex
and
p-adic
elliptic
curves
(cf.
also
[Katz2]).
In
the
construction
of
all
of
these
Kodaira-Spencer
morphisms,
the
main
idea
consists,
as
depicted
in
the
following
diagram:
Kodaira-Spencer
morphism:
motion
in
base-space
â†’
induced
deformation
of
Hodge
ï¬ltration
of
the
idea
that
the
Kodaira-Spencer
morphism
is
the
map
which
associates
to
a
â€œmotionâ€
in
the
base-space
of
a
family
of
elliptic
curves,
the
deformation
in
the
Hodge
ï¬ltration
of
the
de
Rham
cohomology
of
the
elliptic
curve
induced
by
the
motion.
We
refer
to
Chapter
IX
for
more
details.
Â§2.
Technical
Roots:
the
Work
of
Mumford
and
Zhang
Let
K
be
an
algebraically
closed
ï¬eld
of
characteristic
0.
Let
E
be
an
elliptic
curve
over
K.
Let
L
be
the
line
bundle
of
Theorem
Asimple
.
Then
instead
of
considering
sections
of
L
over
E
â€ 
,
one
can
consider
sections
of
L
over
E.
Such
sections
may
be
restricted
to
L|d
E
.
Moreover,
by
the
theory
of
algebraic
theta
functions
(cf.
[Mumf1,2,3]),
the
restriction
L|d
E
of
L
to
the
d-torsion
points
d
E
âŠ†
E
has
a
canonical
trivialization
L|d
E
âˆ¼
=
L|e
âŠ—K
Od
E
(where
e
âˆˆ
E(K)
is
the
zero
element)
â€”
at
least
when
d
is
odd.
Thus,
by
composing
the
restriction
morphism
with
this
trivialization,
we
obtain
a
morphism
(as
in
[Mumf1,2,3]):
Î“(E,
L)
â†’
L|d
E
âˆ¼
=
L|e
âŠ—K
Od
E
i.e.,
one
may
think
of
sections
of
L
over
E
as
functions
on
d
E.
These
functions
are
Mumfordâ€™s
â€œalgebraic
theta
functions.â€
12
Now
let
us
observe
that
dimK
(Î“(E,
L))
=
d,
while
dimK
(L|e
âŠ—K
Od
E
)
=
d2
.
That
is
to
say,
Mumfordâ€™s
theory
only
addresses
a
fraction
(more
precisely:
d1
)
of
the
functions
in
L|e
âŠ—K
Od
E
.
Thus,
it
is
natural
to
ask:
Is
there
a
natural
extension
of
Mumfordâ€™s
theory
that
allows
one
to
give
meaning
to
all
the
functions
of
L|e
âŠ—K
Od
E
as
some
sort
of
â€œglobalâ€
sections
of
L?
Theorem
Asimple
provides
a
natural,
aï¬ƒrmative
answer
to
this
question:
i.e.,
it
states
these
functions
may
be
interpreted
naturally
as
the
sections
of
L
over
the
universal
extension
E
â€ 
of
torsorial
degree
<
d.
In
more
classical
terms,
to
consider
the
universal
extension
amounts
essentially
to
considering
the
derivatives
of
(classical)
theta
functions
(cf.,
e.g.,
[Katz1],
Appendix
C).
For
instance,
if
one
takes
K
=
C,
and
writes
def
Î¸Ï„
(z)
=

eÏ€iÏ„
Â·n
Â·
e2Ï€izÂ·n
2
nâˆˆZ
def
for
the
â€œstandard
theta
functionâ€
(where
z
âˆˆ
C,
Ï„
âˆˆ
H
=
{w
âˆˆ
C
|
Im(w)
>
0}),
then
up
to
the
operation
of
taking
the
Fourier
expansion,
this
theta
function
is
essentially
a
2
âˆ‚
â€œGaussian
eÏ€iÏ„
Â·n
,â€
and
its
derivatives
P
(
âˆ‚z
)
Â·
Î¸Ï„
(z)
(where
P
(âˆ’)
is
a
polynomial
with
coeï¬ƒcients
in
C)
are
given
by
polynomial
multiples
of
(which
are
equivalent
to
derivatives
of
)
the
Gaussian:
P
(2Ï€i
Â·
n)
Â·
eÏ€iÏ„
Â·n
2
Just
as
theta
functions
are
the
â€œfundamental
functions
on
an
elliptic
curveâ€
(more
precisely:
generate
the
space
of
sections
of
L
over
E),
these
derivatives
are
the
â€œfundamental
functions
on
the
universal
extension
of
the
elliptic
curveâ€
(more
precisely:
generate
the
space
of
sections
of
L
over
E
â€ 
).
This
point
of
view
is
discussed
in
more
detail
in
Chapter
III,
Â§5,
6,
7;
Chapter
VII,
Â§6.
As
one
knows
from
elementary
analysis,
the
most
natural
polynomial
multiples/derivatives
of
a
Gaussian
are
those
given
by
the
Hermite
polynomials.
It
is
thus
natural
to
expect
that
the
Hermite
polynomials
should
appear
naturally
in
the
portion
of
the
theory
of
this
paper
concerning
the
behavior
of
the
comparison
isomorphism
at
archimedean
primes.
This
intuition
is
made
rigorous
in
the
theory
of
Chapters
IX,
X.
In
fact,
more
generally:
The
essential
model
that
permeates
the
theory
of
this
paper
is
that
of
the
Gaussian
and
its
derivatives.
This
model
may
be
seen
especially
in
the
â€œGaussian
poles,â€
as
well
as
in
the
â€œHermite
modelâ€
at
the
inï¬nite
prime
(cf.
Â§1).
13
In
the
classical
theory
over
C,
the
most
basic
derivative
of
the
theta
function
is
the
socalled
Weierstrass
zeta
function
(cf.
[Katz1],
Appendix
C).
It
should
thus
not
be
surprising
to
the
reader
that
various
generalizations
of
the
Weierstrass
zeta
function
â€“
which
we
refer
to
as
Schottky-Weierstrass
zeta
functions
(cf.
Chapter
III,
Â§6,
7)
â€“
play
a
fundamental
role
in
this
paper.
So
far,
in
the
above
discussion,
we
concentrated
on
smooth
elliptic
curves.
On
the
other
hand,
when
one
wishes
to
consider
degenerating
elliptic
curves,
Zhang
has
constructed
a
theory
of
metrized
line
bundles
on
such
degenerating
elliptic
curves
(cf.
[Zh]).
In
this
theory,
one
can
consider
the
curvatures
of
such
metrized
line
bundles,
as
well
as
intersection
numbers
between
two
metrized
line
bundles
in
a
fashion
entirely
similar
to
Arakelov
intersection
theory.
Using
Zhangâ€™s
theory
of
metrized
line
bundles,
it
is
not
diï¬ƒcult
to
extend
Mumfordâ€™s
theory
of
algebraic
theta
functions
in
a
natural
fashion
to
metrized
ample
line
bundles
on
degenerating
elliptic
curves
(cf.,
e.g.,
Chapter
IV,
Â§5,
for
more
details).
Unfortunately,
however,
just
as
Mumfordâ€™s
theory
only
addresses
sections
over
the
original
elliptic
curve
(as
opposed
to
over
the
universal
extension,
as
discussed
above),
Zhangâ€™s
theory
also
only
deals
with
the
theory
of
metrized
line
bundles
over
the
original
(degenerating)
elliptic
curve.
Thus,
it
is
natural
to
ask
whether
one
can
generalize
Theorem
Asimple
to
the
case
of
degenerating
elliptic
curves
in
such
a
way
that
the
resulting
generalization
of
the
portion
of
Î“(E
â€ 
,
L)
arising
from
sections
over
E
is
compatible
with
Zhangâ€™s
theory
of
metrized
line
bundles
(and
their
sections)
over
E.
In
other
words,
it
is
natural
to
ask:
Can
one
â€œde
Rham-ifyâ€
the
theory
of
[Zh],
so
that
it
addresses
the
â€œmetricâ€
behavior
of
sections
of
L
not
only
over
E,
but
over
E
â€ 
,
as
well?
An
aï¬ƒrmative
answer
to
this
question
is
given
by
the
theory
of
Gaussian
poles,
or
â€œanalytic
torsion
at
the
divisor
at
inï¬nityâ€
â€“
cf.
Theorem
A,
(3)
in
Â§1;
Chapters
V,
VI.
Another
way
to
view
the
relation
to
Zhangâ€™s
theory
is
the
following.
One
consequence
of
the
theory
of
[Zh]
is
the
construction
of
a
natural
â€œmetricâ€
(or
integral
structure)
on
the
space
Ï‰E
of
invariant
diï¬€erentials
on
a
(degenerating)
elliptic
curve.
If
we
regard
Ï‰E
as
a
line
bundle
on
the
compactiï¬ed
moduli
space
of
elliptic
curves,
then
Zhangâ€™s
â€œadmissible
1
Â·
âˆ)
(where
âˆ
is
metricâ€
on
Ï‰E
essentially
amounts
to
the
(metrized)
line
bundle
Ï‰E
(âˆ’
12
the
divisor
at
inï¬nity
of
the
moduli
space),
i.e.,
the
line
bundle
Ï‰E
with
integral
structure
1
at
inï¬nity
modiï¬ed
by
tensoring
with
O(âˆ’
12
Â·
âˆ).
Moreover,
it
follows
from
Zhangâ€™s
theory
that
there
is
a
natural
trivialization
Ï‰E
(âˆ’
1
Â·
âˆ)
âˆ¼
=O
12
of
this
metrized
line
bundle
over
the
moduli
space.
The
12-th
tensor
power
of
this
trivialization
is
the
cuspidal
modular
form
usually
denoted
â€œÎ”â€
([KM],
Chapter
8,
Â§8.1).
Similarly,
Theorem
A,
(3),
states
that
by
allowing
â€œGaussian
polesâ€
in
the
sections
of
Î“(E
â€ 
,
L),
one
gets
a
natural
isomorphism
between
Î“(E
â€ 
,
L)
(with
this
modiï¬ed
integral
structure)
and
14
a
vector
bundle
which
is
trivial
(in
characteristic
zero)
over
some
ï¬nite
log
eÌtale
covering
of
the
compactiï¬ed
moduli
(log)
stack
of
elliptic
curves.
That
is
to
say,
One
may
regard
the
theory
of
Gaussian
poles/analytic
torsion
at
the
divisor
at
inï¬nity
in
Theorem
A,
(3),
as
a
sort
of
â€œGL2
-analogueâ€
of
1
the
isomorphism
of
line
bundles
(i.e.,
Gm
-torsors)
Ï‰E
(âˆ’
12
Â·
âˆ)
âˆ¼
=Oâ€”
or,
alternatively,
a
GL2
-analogue
of
the
modular
form
Î”.
Note:
The
reason
that
we
mention
â€œGL2
â€
is
that
the
vector
bundle
on
the
â€œeÌtale
sideâ€
of
the
comparison
isomorphism
of
Theorem
A
arises
naturally
(at
least
in
characteristic
zero)
from
a
representation
(deï¬ned
by
the
Galois
action
on
the
d-torsion
points)
of
the
fundamental
group
of
the
moduli
stack
of
elliptic
curves
into
GL2
,
whereas
the
isomorphism
1
Ï‰E
(âˆ’
12
Â·
âˆ)
âˆ¼
=
O
naturally
corresponds
to
an
abelian
representation
(i.e.,
a
representation
into
Gm
which
is,
in
fact,
of
order
12)
of
this
fundamental
group
â€“
cf.
[KM],
Chapter
8,
Â§8.1.
Â§3.
Conceptual
Roots:
the
Search
for
a
Global
Hodge
Theory
Â§3.1.
From
Absolute
Diï¬€erentiation
to
Comparison
Isomorphisms
Let
K
be
either
a
number
ï¬eld
(i.e.,
a
ï¬nite
extension
of
Q)
or
a
function
ï¬eld
in
one
variable
over
some
coeï¬ƒcient
ï¬eld
k
(which
we
assume
to
be
algebraically
closed
in
K).
Let
S
be
the
unique
one-dimensional
regular
scheme
whose
closed
points
s
correspond
naturally
(via
Zariski
localization
of
S
at
s)
to
the
set
of
all
discrete
valuations
of
K
(where
in
the
function
ï¬eld
case
we
assume
that
the
elements
of
k
Ã—
are
units
for
the
valuations).
We
shall
call
S
the
complete
model
of
K.
Of
course,
in
the
number
ï¬eld
case,
it
is
natural
to
â€œformally
appendâ€
to
S
the
set
of
archimedean
valuations
of
K.
Let
Eâ†’S
def
be
a
one-dimensional,
generically
proper
semi-abelian
scheme
over
S,
i.e.,
EK
=
E
âŠ—S
K
is
an
elliptic
curve
over
K
with
semi-stable
reduction
everywhere.
Then
E
deï¬nes
a
classifying
morphism
Î±
:
S
â†’
(M1,0
)Z
to
the
compactiï¬ed
moduli
stack
of
elliptic
curves
over
Z.
It
is
natural
to
endow
S
with
the
log
structure
arising
from
the
set
of
closed
points
at
which
E
â†’
S
has
bad
reduction.
log
Then
Î±
extends
to
a
morphism
Î±log
:
S
log
â†’
(M1,0
)Z
in
the
logarithmic
category.
15
Now,
in
the
function
ï¬eld
case,
if
we
diï¬€erentiate
Î±,
we
obtain
the
Kodaira-Spencer
morphism
of
E
â†’
S:
âŠ—2
âˆ¼
âˆ—
Îº
E
:
Ï‰E
=
Î±
Î©(Mlog
)
â†’
Î©S
log
/k
1,0
Z
(where
Ï‰E
is
the
restriction
to
the
identity
section
of
E
â†’
S
of
the
relative
cotangent
bundle
of
E
over
S).
Since
Ï‰E
is
naturally
the
pull-back
via
Î±
of
an
ample
line
bundle
on
(M1,0
)Z
,
and
ÎºE
is
typically
nonzero
(for
instance,
it
is
always
nonzero
if
K
is
of
characteristic
zero
and
E
â†’
S
is
not
isotrivial
(i.e.,
trivial
after
restriction
to
a
ï¬nite
covering
of
S)),
the
existence
of
the
Kodaira-Spencer
morphism
ÎºE
gives
rise
to
a
bound
on
the
height
of
E
â†’
S
by
the
degree
of
Î©S
log
/k
.
The
thrust
of
a
family
of
conjectures
due
to
Vojta
(cf.
[Lang],
[Vojta])
is
that
this
bound
(or
at
least,
a
bound
roughly
similar
to
this
bound)
in
the
geometric
case
(i.e.,
the
case
when
K
is
a
function
ï¬eld)
also
holds
in
the
â€œarithmetic
caseâ€
(i.e.,
the
case
when
K
is
a
number
ï¬eld).
Thus,
In
order
to
prove
Vojtaâ€™s
Conjecture
in
the
arithmetic
case,
it
is
natural
to
attempt
to
construct
some
sort
of
arithmetic
analogue
of
the
KodairaSpencer
morphism.
Indeed,
this
point
of
view
of
approaching
the
veriï¬cation
of
some
inequality
by
ï¬rst
trying
to
construct
â€œthe
theory
underlying
the
inequalityâ€
is
reminiscent
of
the
approach
to
proving
the
Weil
Conjectures
(which
may
be
thought
of
as
inequalities
concerning
the
number
of
rational
points
of
varieties
over
ï¬nite
ï¬elds)
by
attempting
to
construct
a
â€œWeil
cohomology
theoryâ€
for
varieties
over
ï¬nite
ï¬elds
which
has
enough
â€œgood
propertiesâ€
to
allow
a
natural
proof
of
the
Weil
Conjectures.
Of
course,
if
one
tries
to
construct
any
sort
of
naive
analogue
of
the
Kodaira-Spencer
morphism
in
the
arithmetic
case,
one
immediately
runs
into
a
multitude
of
fundamental
obstacles.
In
some
sense,
these
obstacles
revolve
around
the
fact
that
the
ring
of
rational
integers
Z
does
not
admit
â€œa
ï¬eld
of
coeï¬ƒcientsâ€
F1
âŠ†
Z.
If
such
a
ï¬eld
of
absolute
constants
existed,
then
one
could
consider
â€œabsolute
diï¬€erentials
Î©Z/F1
,â€
or
â€œÎ©OK
/F1
â€
Moreover,
since
moduli
spaces
tend
to
be
rather
absolute
and
fundamental
objects,
it
is
natural
to
imagine
that
if
one
had
a
ï¬eld
of
absolute
constants
â€œF1
,â€
then
(M1,0
)Z
should
descend
naturally
to
an
object
(M1,0
)F1
over
F1
,
so
that
one
could
diï¬€erentiate
the
classifying
morphism
Î±
:
S
â†’
(M1,0
)Z
in
the
arithmetic
case,
as
well,
to
obtain
an
arithmetic
Kodaira-Spencer
morphism
âŠ—2
âˆ¼
âˆ—
â€œÎºE
:
Ï‰E
=
Î±
Î©(Mlog
)
1,0
F1
â†’
Î©S
log
/F1
â€
and
then
use
this
arithmetic
Kodaira-Spencer
morphism
to
prove
Vojtaâ€™s
Conjecture
concerning
the
heights
of
elliptic
curves.
(Note:
In
this
case,
Vojtaâ€™s
Conjecture
is
also
referred
to
as
â€œSzpiroâ€™s
Conjecture.â€)
16
Unfortunately,
this
sort
of
â€œabsolute
ï¬eld
of
constants
F1
â€
does
not,
of
course,
exist
in
any
naive
sense.
Thus,
it
is
natural
to
look
for
a
more
indirect,
abstract
approach.
In
the
geometric
case,
when
k
=
C,
the
algebraic
curve
S
deï¬nes
a
Riemann
surface
S
an
.
Let
us
write
US
âŠ†
S
for
the
open
subobject
where
the
log
structure
of
S
log
is
trivial.
Then
the
ï¬rst
singular
cohomology
module
of
the
ï¬bers
of
E
â†’
S
naturally
forms
a
local
system
1
Hsing
(E/S,
Z)
on
the
Riemann
surface
USan
.
One
the
other
hand,
the
ï¬rst
de
Rham
cohomology
module
of
the
ï¬bers
of
E
â†’
S
forms
a
rank
two
vector
bundle
1
HDR
(E/S,
OE
)
on
USan
.
This
de
Rham
cohomology
admits
a
Hodge
ï¬ltration,
which
may
be
thought
of
as
a
natural
exact
sequence:
1
0
â†’
Ï‰E
â†’
HDR
(E/S,
OE
)
â†’
Ï„E
â†’
0
1
(E/S,
OE
)
on
USan
admits
a
connection
âˆ‡DR
â€”
called
the
Moreover,
this
vector
bundle
HDR
1
(E/S,
OE
).
Gauss-Manin
connection
â€”
which
allows
one
to
diï¬€erentiate
sections
of
HDR
Using
this
connection
âˆ‡DR
to
diï¬€erentiate
the
Hodge
ï¬ltration
gives
rise
to
a
natural
morphism
Î˜S
log
/k
â†’
Ï„EâŠ—2
(where
Î˜S
log
/k
is
the
dual
to
Î©S
log
/k
)
which
is
dual
to
the
Kodaira-Spencer
morphism
ÎºE
.
Thus,
Another
way
to
think
of
our
search
for
â€œF1
â€
or
â€œa
notion
of
absolute
diï¬€erentiationâ€
is
as
the
search
for
an
arithmetic
analogue
of
the
Gauss1
(E/S,
OE
).
Manin
connection
âˆ‡DR
on
the
de
Rham
cohomology
HDR
This
is
the
ï¬rst
step
towards
raising
our
search
for
an
arithmetic
Kodaira-Spencer
morphism
to
a
more
abstract
level.
Next,
let
us
recall
that
the
de
Rham
isomorphism
deï¬nes
a
natural
isomorphism
1
1
HDR
(E/S,
OE
)
âˆ¼
(E/S,
Z)
âŠ—Z
OUSan
=
Hsing
1
(in
the
complex
analytic
category)
over
USan
.
Moreover,
the
sections
of
HDR
(E/S,
OE
)
1
deï¬ned
(via
this
isomorphism)
by
sections
of
Hsing
(E/S,
Z)
are
horizontal
for
âˆ‡DR
.
Thus,
we
conclude
that:
17
To
construct
the
Gauss-Manin
connection
âˆ‡DR
,
it
is
enough
to
know
the
de
Rham
isomorphism
between
de
Rham
and
singular
cohomology.
The
de
Rham
isomorphism
is
a
special
case
of
the
general
notion
of
a
Comparison
Isomorphism
between
de
Rham
and
singular/eÌtale
cohomology.
In
the
last
few
decades,
this
sort
of
Comparison
Isomorphism
has
been
constructed
over
p-adic
bases,
as
well
(cf.,
e.g.,
[Falt1,2],
[Hyodo]).
In
the
arithmetic
case,
we
would
like
to
construct
some
sort
of
analogue
of
the
Kodaira-Spencer
morphism
over
S
which
also
has
natural
integrality
properties
at
the
archimedean
places,
as
well
(since
we
would
like
to
use
it
conclude
inequalities
concerning
the
height
of
the
elliptic
curve
EK
).
Put
another
way,
we
would
like
to
construct
some
sort
of
arithmetic
Kodaira-Spencer
morphism
in
the
context
of
Arakelov
theory.
Thus,
in
summary,
the
above
discussion
suggests
that:
In
order
to
construct
this
sort
of
arithmetic
Kodaira-Spencer
morphism,
a
natural
approach
is
to
attempt
to
construct
some
sort
of
Comparison
Isomorphism
in
the
â€œArakelov
theater,â€
analogous
to
the
wellknown
complex
and
p-adic
Comparison
Isomorphisms
between
de
Rham
and
eÌtale/singular
cohomology.
The
construction
of
such
an
Arakelov-theoretic
Comparison
Theorem
is
the
main
goal
of
this
paper.
To
a
certain
extent,
this
goal
is
achieved
by
Theorem
A
(cf.
Â§1).
For
a
detailed
explanation
of
the
sense
in
which
the
Comparison
Isomorphism
of
Theorem
A
is
analogous
to
the
well-known
complex
and
p-adic
Comparison
Isomorphisms,
we
refer
to
Chapter
IX.
Unfortunately,
however,
for
various
technical
reasons,
the
arithmetic
Kodaira-Spencer
morphism
that
naturally
arises
from
Theorem
A
is
not
well
enough
understood
at
the
time
of
writing
to
allow
its
application
to
a
proof
of
Vojtaâ€™s
Conjectures
(for
more
on
these
â€œtechnical
reasons,â€
cf.
Â§5.1
below;
Chapter
IX,
Example
3.5,
and
the
Remark
following
Example
3.5).
In
the
remainder
of
the
present
Â§3,
we
would
like
to
explain
in
detail
how
we
were
led
to
Theorem
A
as
a
global,
Arakelov-theoretic
analogue
of
the
well-known
â€œlocal
Comparison
Isomorphisms.â€
Â§3.2.
A
Function-Theoretic
Comparison
Isomorphism
In
Â§3.1,
we
saw
that
one
way
to
think
about
absolute
diï¬€erentiation
or
an
absolute/arithmetic
Kodaira-Spencer
morphism
is
to
regard
such
objects
as
natural
consequences
of
a
â€œglobal
Hodge
theory,â€
or
Comparison
Isomorphism
between
the
de
Rham
and
eÌtale
cohomologies
of
an
elliptic
curve.
The
question
then
arises:
Just
what
form
should
such
a
Global
Comparison
Isomorphism
â€”
i.e.,
in
suggestive
notation
1
1
(E)
âŠ—
??
âˆ¼
(E)
âŠ—
??
HDR
=
Het
â€”
take?
18
For
instance,
over
C,
such
a
comparison
isomorphism
exists
naturally
over
C,
i.e.,
when
one
takes
??
=
C.
In
the
p-adic
case,
one
must
introduce
rings
of
p-adic
periods
such
as
BDR
,
Bcrys
(cf.,
e.g.,
[Falt2])
in
order
to
obtain
such
an
isomorphism.
Thus,
we
would
like
to
know
over
if
there
is
some
sort
of
natural
â€œring
of
global
periodsâ€
over
which
we
may
expect
to
obtain
our
global
comparison
isomorphism.
In
fact,
in
the
comparison
isomorphism
obtained
in
this
paper
(cf.
Â§1,
Theorem
A),
unlike
the
situation
over
complex
and
p-adic
bases,
we
do
not
work
over
some
â€œglobal
ring
of
periods.â€
Instead,
the
situation
is
somewhat
more
complicated.
Roughly
speaking,
what
we
end
up
doing
is
the
following:
In
the
Hodge-Arakelov
Comparison
Isomorphism,
we
obtain
a
comparison
isomorphism
between
the
de
Rham
and
eÌtale
cohomologies
of
an
elliptic
curve
by
considering
functions
on
the
de
Rham
and
eÌtale
cohomologies
of
the
elliptic
curve
and
then
constructing
an
isomorphism
between
the
two
resulting
function
spaces
which
is
(essentially)
an
isometry
with
respect
to
natural
metrics
on
these
function
spaces
at
all
the
primes
of
the
base.
Indeed,
for
instance
over
a
number
ï¬eld,
the
de
Rham
cohomology
and
eÌtale
cohomology
are
ï¬nite
modules
over
very
diï¬€erent
sorts
of
rings
(i.e.,
the
ring
of
integers
of
the
number
ï¬eld
in
the
de
Rham
case;
the
proï¬nite
completion
of
Z,
or
one
of
its
quotients
in
the
eÌtale
case),
and
it
is
diï¬ƒcult
to
imagine
the
existence
of
a
natural
â€œglobal
arithmetic
ringâ€
containing
both
of
these
two
types
of
rings.
(Note
here
that
unlike
the
case
with
Shimura
varieties,
the
adeÌ€les
are
not
a
natural
choice
here
for
a
number
of
reasons.
Indeed,
to
consider
the
adeÌ€les
here
roughly
amounts
to
simply
forming
the
direct
product
of
the
various
local
(i.e.,
complex
and
p-adic)
comparison
isomorphisms,
which
is
not
very
interesting
in
the
sense
that
such
a
simple
direct
product
does
not
result
in
any
natural
global
structures.)
Thus:
The
idea
here
is
to
abandon
the
hope
of
obtaining
a
global
linear
isomorphism
between
the
de
Rham
and
eÌtale
cohomology
modules,
and
instead
to
look
for
an
isomorphism
(as
mentioned
above)
between
the
corresponding
function
spaces
which
does
not
necessarily
arise
from
a
linear
morphism
between
modules.
In
the
present
Â§,
we
explain
how
we
were
led
to
look
for
such
a
â€œfunction-theoretic
comparison
isomorphism,â€
while
in
Â§3.3
below,
we
examine
the
meaning
of
the
nonlinearity
of
this
sort
of
comparison
isomorphism.
In
order
to
understand
the
motivating
circumstances
that
naturally
lead
to
the
introduction
of
this
sort
of
function-theoretic
point
of
view,
we
must
ï¬rst
return
to
the
discussion
of
the
case
over
the
complexes
in
Â§3.1
above.
Thus,
in
the
following
discussion,
we
use
the
notation
of
the
discussion
of
the
complex
case
in
Â§3.1.
One
more
indirect
way
to
think
about
the
existence
of
the
Kodaira-Spencer
morphism
is
the
following.
Recall
the
exact
sequence
19
1
0
â†’
Ï‰E
â†’
HDR
(E/S,
OE
)
â†’
Ï„E
â†’
0
which
in
fact
exists
naturally
over
S
an
.
The
Gauss-Manin
connection
âˆ‡DR
acts
on
the
middle
term
of
this
exact
sequence
(as
a
connection
with
logarithmic
poles
at
the
points
of
bad
reduction),
but
does
not
preserve
the
image
of
Ï‰E
.
One
important
consequence
of
this
fact
is
that:
(If
one
imposes
certain
â€œnatural
logarithmic
conditionsâ€
on
the
splitting
at
points
of
bad
reduction,
then)
this
exact
sequence
does
not
split.
Indeed,
if
this
exact
sequence
split,
then
one
could
use
this
splitting
to
obtain
a
connection
on
Ï‰E
induced
by
âˆ‡DR
.
Moreover,
if
the
â€œnatural
logarithmic
conditionsâ€
are
satisï¬ed,
it
would
follow
that
this
connection
on
Ï‰E
has
zero
monodromy
at
the
points
of
bad
reduction,
i.e.,
that
the
connection
is
regular
over
all
of
S
an
.
But
since
Ï‰E
is
the
pull-back
to
S
of
an
ample
line
bundle
on
(M1,0
)Z
,
it
follows
(so
long
as
E
â†’
S
is
not
isotrivial)
that
deg(Ï‰E
)
=
0,
hence
that
the
line
bundle
Ï‰E
cannot
admit
an
everywhere
regular
connection.
That
is,
we
obtain
a
contradiction.
Another
(essentially
equivalent)
way
to
think
about
the
relationship
between
the
fact
that
the
above
exact
sequence
does
not
split
and
the
existence
of
the
Kodaira-Spencer
âŠ—2
-torsor
of
splittings
of
the
above
morphism
is
the
following.
If
one
considers
the
Ï‰E
exact
sequence
(together
with
the
â€œnatural
logarithmic
conditionsâ€
at
the
points
of
bad
reduction),
we
obtain
a
class
âŠ—2
)
Î·
âˆˆ
Hc1
(S,
Ï‰E
where
the
subscript
â€œcâ€
stands
for
â€œcohomology
with
compact
support.â€
(The
reason
that
we
get
a
class
with
compact
support
is
because
of
the
â€œnatural
logarithmic
conditionsâ€
at
the
points
of
bad
reduction.)
On
the
other
hand,
if
we
apply
the
functor
Hc1
(âˆ’)
to
the
Kodaira-Spencer
morphism,
we
obtain
a
morphism
âŠ—2
)
â†’
Hc1
(S,
Î©S
log
/k
)
=
Hc1
(S,
Î©S/k
)
âˆ¼
Hc1
(S,
Ï‰E
=k
Moreover,
the
image
of
Î·
under
this
morphism
can
easily
be
shown
to
be
the
element
of
Hc1
(S,
Î©S/k
)
âˆ¼
=
k
which
is
the
degree
of
the
classifying
morphism
Î±
:
S
â†’
(M1,0
)C
,
i.e.,
deg(Î±)
âˆˆ
Z
âŠ†
C
=
k,
which
is
nonzero
(so
long
as
E
â†’
S
is
not
isotrivial).
This
implies
that
Î·
is
nonzero.
Thus,
in
summary,
An
indirect
way
to
â€œwitness
the
existence
of
the
Kodaira-Spencer
morphismâ€
is
to
observe
that
the
above
exact
sequence
does
not
split,
i.e.,
âŠ—2
-torsor
of
splittings
of
this
sequence
is
nontrivial.
that
the
Ï‰E
20
This
point
of
view
is
discussed
in
more
detail
in
[Mzk2],
Introduction,
Â§2.3.
Also,
we
observe
that
this
nonsplitting
of
the
above
exact
sequence
may
also
be
regarded
as
a
sort
1
(E/S,
OE
),
âˆ‡DR
).
This
of
â€œstability
of
the
(vector
bundle
plus
connection)
pairâ€
(HDR
type
of
stability
of
a
bundle
equipped
with
connection
is
referred
to
as
â€œcrys-stabilityâ€
in
[Mzk2]
â€”
cf.
[Mzk2],
Introduction,
Â§1.3;
[Mzk2],
Chapter
I,
for
more
details.
Fig.
1:
The
split
case.
Now
let
us
return
to
the
arithmetic
case.
In
this
case,
S
=
Spec(OK
)
(where
OK
is
the
ring
of
integers
of
a
number
ï¬eld
K).
Moreover,
we
have
a
natural
exact
sequence
of
OK
-modules:
1
0
â†’
Ï‰E
â†’
HDR
(E/S,
OE
)
â†’
Ï„E
â†’
0
which
extends
naturally
to
an
exact
sequence
of
OK
-modules
with
Hermitian
metrics
at
the
inï¬nite
primes,
i.e.,
an
exact
sequence
of
arithmetic
vector
bundles
on
S
(where
S
denotes
the
formal
union
of
S
with
the
set
of
inï¬nite
primes
of
K)
in
the
sense
of
Arakelov
theory.
Then
one
can
consider
whether
or
not
this
exact
sequence
of
arithmetic
vector
bundles
splits.
Moreover,
just
as
in
the
complex
case,
one
can
think
of
this
issue
as
the
21
âŠ—2
issue
of
whether
or
not
a
certain
Arakelov-theoretic
Ï‰E
-torsor
splits.
(The
notion
and
basic
properties
of
torsors
in
Arakelov-theory
are
discussed
in
Chapter
I.)
Thus,
One
way
to
regard
the
issue
of
constructing
an
arithmetic
KodairaSpencer
morphism
is
as
the
issue
of
constructing
a
theory
that
proves
âŠ—2
-torsor
does
not
split.
that/explains
why
this
Arakelov-theoretic
Ï‰E
Indeed,
the
nonsplitting
of
this
torsor
is
very
closely
related
to
the
Conjectures
of
Vojta
and
Szpiro
â€”
in
fact,
the
existence
of
(for
instance,
an
inï¬nite
number
of)
counterexamples
to
these
conjectures
would
imply
(in
an
inï¬nite
number
of
cases)
the
splitting
of
this
torsor
(cf.
Chapter
I,
Theorem
2.4;
Chapter
I,
Â§4).
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
Fig.
2:
The
non-split
case.
From
a
more
elementary
point
of
view,
the
nonsplitting
of
this
torsor
may
be
thought
of
in
the
following
fashion.
First
of
all,
an
arithmetic
vector
bundle
over
S
may
be
thought
of
as
an
(OK
-)
lattice
in
a
real
or
complex
vector
space.
Thus,
for
instance,
in
the
case
1
K
=
Q,
one
may
think
of
HDR
(E/S,
OE
)
as
a
lattice
in
R2
,
while
the
arithmetic
line
bundles
Ï‰E
and
Ï„E
may
be
thought
of
as
lattices
in
R.
In
the
case
of
arithmetic
line
bundles,
to
say
that
the
degree
of
the
arithmetic
line
bundle
(cf.
Chapter
I,
Â§1)
is
large
22
(respectively,
small)
amounts
to
saying
that
the
points
of
the
lattice
are
rather
densely
(respectively,
sparsely)
distributed.
Note
that
since
Ï‰E
is
the
pull-back
to
S
of
an
ample
line
bundle
(M1,0
)Z
,
its
degree
tends
to
be
rather
large.
Thus,
to
say
that
the
torsor
in
1
question
splits
is
to
say
that
HDR
(E/S,
OE
)
looks
rather
like
the
lattice
of
Fig.
1,
i.e.,
it
is
dense
in
one
direction
and
sparse
in
another
(roughly
orthogonal)
direction.
We
would
1
(E/S,
OE
)
looks
more
like
the
lattice
in
Fig.
2,
i.e.:
like
to
show
that
HDR
1
We
would
like
to
show
that
the
lattice
corresponding
to
HDR
(E/S,
OE
)
is
roughly
equidistributed
in
all
directions.
Since
we
are
thinking
about
comparison
isomorphisms,
it
is
thus
tempting
to
think
of
the
comparison
isomorphism
as
something
which
guarantees
that
the
â€œdistribution
of
matterâ€
1
in
the
lattice
HDR
(E/S,
OE
)
is
as
even
in
all
directions
as
the
â€œdistribution
of
matterâ€
in
the
eÌtale
cohomology
of
E.
Also,
it
is
natural
to
think
of
the
â€œdistribution
of
matter
issuesâ€
involving
the
eÌtale
cohomology,
or
torsion
points,
of
E
as
being
related
to
the
action
of
Galois.
(The
action
of
Galois
on
the
torsion
points
is
discussed
in
Chapter
II.)
Thus,
in
summary:
It
is
natural
to
expect
that
the
global
comparison
isomorphism
should
be
some
sort
of
equivalence
between
â€œdistributions
of
matterâ€
in
the
de
Rham
and
eÌtale
cohomologies
of
an
elliptic
curve.
Typically,
in
analytic
number
theory,
probability
theory,
and
other
ï¬eld
of
mathematics
where
â€œdistributions
of
matterâ€
must
be
measured
precisely,
it
is
customary
to
measure
them
by
thinking
about
functions
â€”
i.e.,
so-called
â€œtest
functionsâ€
â€”
(and
the
resulting
function
spaces)
on
the
spaces
where
these
distributions
of
matter
occur.
It
is
for
this
reason
that
the
author
was
led
to
the
conclusion
that:
The
proper
formulation
for
a
global
comparison
isomorphism
should
be
some
sort
of
isometric
(for
metrics
at
all
the
primes
of
a
number
ï¬eld)
isomorphism
between
spaces
of
functions
on
the
de
Rham
and
eÌtale
cohomologies
of
an
elliptic
curve.
This
is
precisely
what
is
obtained
in
Theorem
A.
Â§3.3.
The
Meaning
of
Nonlinearity
In
Â§3.2
above,
we
saw
that
one
of
the
central
ideas
of
this
paper
is
that
to
obtain
a
â€œglobal
Hodge
theory,â€
one
must
sacriï¬ce
linearity
=
additivity,
and
instead
look
for
isometric
isomorphisms
between
spaces
of
functions
on
the
de
Rham
and
eÌtale
cohomology.
Put
another
way,
this
approach
amounts
to
abandoning
the
idea
that
the
de
Rham
and
eÌtale
cohomologies
are
modules,
and
instead
thinking
of
them
as
(nonlinear)
geometric
objects.
Thus,
one
appropriate
name
for
this
approach
might
be
â€œgeometric
motive
theory.â€
23
This
approach
contrasts
sharply
with
typical
approaches
to
the
â€œtheory
of
motivesâ€
or
to
â€œglobal
Hodge
theoriesâ€
which
tend
to
revolve
around
additivity/linearization,
and
involve
such
â€œlinearâ€
techniques
as
the
introduction
of
derived
categories
that
contain
motives.
In
some
sense,
since
we
set
out
to
develop
a
global
Hodge
theory
in
the
context
of
Arakelov
theory,
the
nonlinearity
of
the
Comparison
Isomorphism
of
Theorem
A
is
perhaps
not
so
surprising:
Indeed,
many
objects
in
Arakelov
theory
which
are
analogues
of
â€œlinearâ€
objects
in
usual
scheme
theory
become
â€œnonlinearâ€
when
treated
in
the
context
of
Arakelov
theory.
Perhaps
the
most
basic
example
of
this
phenomenon
is
the
fact
that
in
Arakelov
theory,
the
space
of
global
sections
of
an
arithmetic
line
bundle
is
not
closed
under
addition.
This
makes
it
diï¬ƒcult
and
unnatural
(if
not
impossible)
to
do
homological
algebra
(e.g.,
involving
derived
categories)
in
the
context
of
Arakelov
theory.
Another
way
to
think
about
the
nonlinearity
of
the
Hodge-Arakelov
Comparison
Isomorphism
is
that
it
is
natural
considering
that
the
fundamental
algebraic
object
that
encodes
the
â€œsymmetries
of
the
Gaussian,â€
namely,
the
Heisenberg
algebra
â€”
i.e.,
the
Lie
algebra
generated
by
1,
x,
y,
and
the
relations
[x,
y]
=
1,
[x,
1]
=
[y,
1]
=
0
(the
eÌtale
counterpart
of
which
is
the
theta
groups
of
Mumford)
â€”
is
closely
related
to
nonlinear
geometries.
In
the
ï¬eld
of
noncommutative
geometry,
the
object
that
represents
these
symmetries
is
known
as
the
noncommutative
torus.
Since
the
Gaussian
and
its
derivatives
lie
at
the
technical
heart
at
the
theory
of
this
paper,
it
is
thus
not
surprising
that
the
nonabelian
nature
of
the
symmetries
of
the
Gaussian
should
manifest
itself
in
the
theory.
In
fact,
in
the
portion
of
the
theory
of
this
paper
at
archimedean
primes,
it
turns
out
that
the
Comparison
Isomorphism
in
some
sense
amounts
to
a
function-theoretic
splitting
of
the
exact
sequence
0
â†’
d
Â·
Z
â†’
Z
â†’
Z/d
Â·
Z
â†’
0,
i.e.,
a
function-theoretic
version
of
a
bijection
(Z/d
Â·
Z)
Ã—
(d
Â·
Z)
âˆ¼
=Z
This
sort
of
splitting
is
somewhat
reminiscent
of
the
â€œsplittingâ€
inherent
in
regarding
Z
as
being
some
sort
of
â€œpolynomial
algebra
over
F1
.â€
Moreover,
this
archimedean
portion
of
the
theory
is
also
(not
surprisingly)
closely
related
to
the
derivatives
of
the
Gaussian
and
the
symmetries
encoded
in
the
Heisenberg
algebra.
Thus,
in
summary:
It
is
as
if
the
symmetries/twist
inherent
in
the
inclusion
â€œF1
âŠ†
Zâ€
are
precisely
the
symmetries/twist
encoded
in
the
noncommutative
torus
(of
noncommutative
geometry).
We
refer
to
the
discussion
of
Chapter
VIII,
Â§0,
for
more
details
on
this
point
of
view.
Â§3.4.
Hodge
Theory
at
Finite
Resolution
So
far,
we
have
discussed
the
idea
that
the
appropriate
way
to
think
about
Comparison
Isomorphisms
is
to
regard
them
as
(isometric)
isomorphisms
between
spaces
of
functions
24
on
the
de
Rham
and
eÌtale
cohomologies
of
an
elliptic
curve.
The
question
then
arises:
How
does
one
deï¬ne
such
a
natural
isomorphism?
The
key
idea
here
is
the
following:
Comparison
Isomorphisms
should
be
deï¬ned
as
evaluation
maps,
given
by
evaluating
functions
on
the
universal
extension
of
an
elliptic
curve
â€”
Ã—
1
which
is
a
sort
of
â€œHDR
(E,
OE
),â€
i.e.,
a
kind
of
de
Rham
cohomology
of
the
elliptic
curve
â€”
at
the
torsion
points
of
the
universal
extension
(which
may
naturally
be
identiï¬ed
with
the
eÌtale
cohomology
of
the
elliptic
curve).
In
fact,
one
of
the
main
observations
that
led
to
the
development
of
the
theory
of
this
paper
is
the
following:
The
classical
Comparison
Isomorphisms
over
complex
and
p-adic
bases
may
be
formulated
precisely
as
evaluation
maps
of
certain
functions
on
the
universal
extension
at
the
torsion
points
(or
the
â€œsingular
cohomology
analogue
of
torsion
pointsâ€)
of
the
universal
extension.
This
key
observation
is
discussed
in
detail
in
Chapter
IX,
Â§1,
2.
In
the
complex
case,
it
amounts
to
an
essentially
trivial
reformulation
of
the
classical
theory.
Perhaps
the
best
way
to
summarize
this
reformulation
is
to
state
that
the
subspace
of
functions
on
the
â€œsingular
cohomology
analogue
of
torsion
pointsâ€
arising
from
the
theta
functions
on
the
elliptic
curve
is
itself
a
sort
of
â€œfunction-theoreticâ€
representation
of
the
Hodge
ï¬ltration
induced
(by
the
de
Rham
isomorphism)
on
the
singular
cohomology
with
complex
coeï¬ƒcients
of
an
elliptic
curve.
In
fact,
this
observation
more
than
any
other
played
an
essential
role
in
convincing
the
author
that
(roughly
speaking)
â€œtheta
functions
naturally
deï¬ne
the
Comparison
Isomorphismâ€
(hence
that
any
global
Comparison
Isomorphism
should
involve
theta
functions).
In
the
p-adic
case,
this
â€œkey
observationâ€
amounts
to
what
is
usually
referred
to
as
the
p-adic
period
map
(cf.,
e.g.,
[Coln],
[Colz1,2],
[Font],
[Wint];
the
beginning
of
Chapter
IX,
Â§2,
of
the
present
paper)
of
elliptic
curves
(or
abelian
varieties).
Thus,
in
summary,
the
complex,
p-adic,
and
Hodge-Arakelov
Comparison
Isomorphisms
may
all
be
formulated
along
very
similar
lines,
i.e.,
as
evaluation
maps
of
functions
on
the
universal
extension
at
the
torsion
points
of
the
universal
extension.
Of
course,
the
diï¬€erence
between
the
Hodge-Arakelov
Comparison
Isomorphism
and
its
local
(i.e.,
complex
and
p-adic)
counterparts
is
that
unlike
in
the
local
case,
where
the
spaces
of
torsion
points
involved
are
â€œcompleted
at
some
prime,â€
in
the
Hodge-Arakelov
case,
we
work
with
a
discrete
set
of
torsion
points.
It
is
for
this
reason
that
we
ï¬nd
it
natural
to
think
of
the
theory
of
the
present
paper
as
a
â€œdiscretizationâ€
of
the
well-known
local
comparison
isomorphisms.
Another
way
that
one
might
think
of
the
theory
of
the
present
paper
is
as
a
â€œHodge
theory
at
ï¬nite
resolutionâ€
(where
we
use
the
term
â€œresolutionâ€
as
in
discussions
of
the
number
of
â€œpixelsâ€
(i.e.,
â€œpicture
elements,
dotsâ€)
of
a
computer
screen).
At
this
point,
the
reader
might
feel
motivated
to
pose
the
following
question:
25
If
the
Hodge-Arakelov
Comparison
Isomorphism
is
indeed
a
comparison
isomorphism
analogous
to
the
complex
and
p-adic
comparison
isomorphisms,
then
what
sorts
of
â€œglobal
periodsâ€
does
it
give
rise
to?
For
instance,
in
the
case
of
the
complex
comparison
isomorphism,
the
most
basic
period
is
the
period
of
the
Tate
motive,
i.e.,
of
H
1
of
Gm
,
namely,
2Ï€i.
In
the
p-adic
case,
the
corresponding
period
is
the
copy
of
Zp
(1)
that
sits
naturally
inside
Bcrys
.
The
analogous
â€œperiodâ€
resulting
from
the
theory
of
the
present
paper,
then,
is
the
following:
Let
U
be
the
standard
multiplicative
coordinate
on
Gm
.
Then
U
âˆ’
1
forms
a
section
of
some
ample
line
bundle
on
Gm
,
hence
may
be
thought
of
as
a
sort
of
â€œtheta
functionâ€
(cf.
especially,
the
Schottky
uniformization
of
an
elliptic
curve,
as
in
[Mumf4],
Â§5).
Then,
roughly
speaking,
the
â€œdiscretized
Hodge
theoryâ€
of
the
present
paper
amounts
essentially
â€”
from
the
point
of
view
of
periods
â€”
to
thinking
of
the
period
â€œ2Ï€iâ€
as
lim
n
Â·
(U
âˆ’
1)|U
=exp(2Ï€i/n)
nâ†’âˆ
i.e.,
the
evaluation
of
a
theta
function
at
an
n-torsion
point,
for
some
large
n.
For
the
elliptic
curve
analogue
(at
archimedean
primes)
of
this
representation
of
2Ï€i,
we
refer
especially
to
Chapter
VII,
Â§5,
6,
of
the
present
paper.
In
fact,
another
way
to
interpret
the
theory
of
the
present
paper
is
the
following.
First,
let
us
observe
that
the
classical
complex
comparison
isomorphism
(i.e.,
the
de
Rham
isomorphism)
is
centered
around
â€œdiï¬€erentiationâ€
and
â€œintegration,â€
i.e.,
calculus
on
the
elliptic
curve.
Moreover,
in
some
sense,
the
most
fundamental
aspect
of
calculus
as
opposed
to
algebraic
geometry
on
the
elliptic
curve
is
the
use
of
real
analytic
functions
on
the
elliptic
curve.
In
the
present
context,
however,
we
wish
to
keep
everything
â€œarithmeticâ€
and
â€œglobalâ€
over
a
number
ï¬eld.
Thus,
instead
of
performing
calculus
on
the
underlying
real
analytic
manifold
of
a
(complex)
elliptic
curve,
we
approximate
this
classical
sort
of
calculus
by
performing
calculus
on
a
ï¬nite
(but
â€œlargeâ€)
set
of
torsion
points
of
the
elliptic
curve.
That
is
to
say:
We
regard
the
set
of
torsion
points
as
an
approximation
of
the
underlying
real
analytic
manifold
of
an
elliptic
curve.
Indeed,
this
notion
of
â€œdiscrete
torsion
calculusâ€
is
one
of
the
key
ideas
of
this
paper.
For
instance,
the
universal
extension
of
a
complex
elliptic
curve
has
a
canonical
real
analytic
splitting
(cf.
Chapter
III,
Deï¬nition
3.2),
which
is
fundamental
to
the
Hodge
theory
of
the
elliptic
curve
(cf.,
e.g.,
[Mzk2],
Introduction,
Â§0.7,
0.8).
Since
this
splitting
passes
through
the
torsion
points
of
the
universal
extension
(and,
in
fact,
is
equal
to
the
closure
of
these
torsion
points
in
the
complex
topology),
it
is
thus
natural
to
regard
the
torsion
points
of
the
universal
extension
as
a
â€œdiscrete
torsion
calculus
approximationâ€
to
the
canonical
real
analytic
splitting
(cf.
Remark
1
following
Chapter
III,
Deï¬nition
3.2).
This
â€œdiscrete
torsion
calculusâ€
point
of
view
may
also
be
seen
in
the
use
of
the
operator
â€œÎ´â€
in
Chapter
III,
Â§6,7
(cf.
also
Chapter
V,
Â§4),
as
well
as
in
the
discussion
of
the
â€œdiscrete
Tchebycheï¬€
polynomialsâ€
in
Chapter
VII,
Â§3.
26
Â§3.5.
Relationship
to
Ordinary
Frobenius
Liftings
and
Anabelian
Varieties
Finally,
before
proceeding,
we
present
one
more
approach
to
thinking
about
â€œabsolute
diï¬€erentiation
over
F1
.â€
Perhaps
the
most
naive
approach
to
deï¬ning
the
derivative
of
a
number
n
âˆˆ
Z
(cf.
[Ihara])
is
to
ï¬x
a
prime
number
p,
and
then
to
compare
n
with
its
TeichmuÌˆller
representative
[n]p
âˆˆ
Zp
.
The
idea
here
is
that
TeichmuÌˆller
representatives
should
somehow
represent
something
analogous
to
a
â€œï¬eld
of
constantsâ€
inside
Zp
.
Thus,
we
obtain
a
correspondence
p
â†’
1
(n
âˆ’
[n]p
)
p
Unfortunately,
if
one
starts
from
this
naive
point
of
view,
it
seems
to
be
very
diï¬ƒcult
to
prove
interesting
global
results
concerning
this
correspondence,
much
less
to
apply
it
to
proving
interesting
results
in
diophantine
geometry.
Thus,
it
is
natural
to
attempt
to
recast
this
naive
approach
in
a
form
that
is
more
amenable
to
globalization.
To
do
this,
let
us
ï¬rst
note
that
to
consider
TeichmuÌˆller
representatives
is
very
closely
related
to
considering
the
natural
Frobenius
morphism
Î¦A
:
A
â†’
A
def
on
the
ring
of
Witt
vectors
A
=
W
(Fp
).
In
fact,
the
TeichmuÌˆller
representatives
in
A
are
precisely
the
elements
which
satisfy
the
equation:
Î¦A
(a)
=
ap
Put
another
way,
if
a
is
a
unit,
then
it
may
be
thought
of
as
an
element
âˆˆ
Gm
(A).
Moreover,
Gm
is
equipped
with
its
own
natural
Frobenius
action
Î¦Gm
,
given
by
U
â†’
U
p
(where
U
is
the
standard
multiplicative
coordinate
on
Gm
).
Thus,
the
TeichmuÌˆller
representatives
are
given
by
those
elements
of
a
âˆˆ
Gm
(A)
such
that
Î¦A
(a)
=
Î¦Gm
(a)
In
fact,
this
sort
of
situation
where
one
has
a
natural
Frobenius
action
on
a
p-adic
(formal)
scheme,
and
one
considers
natural
p-adic
liftings
of
points
on
this
scheme
modulo
p
which
are
characterized
by
the
property
that
they
are
taken
to
their
Frobenius
(i.e.,
Î¦A
)
conjugates
by
the
given
action
of
Frobenius
occurs
elsewhere
in
arithmetic
geometry.
Perhaps
the
most
well-known
example
of
this
situation
(after
Gm
)
is
the
Serre-Tate
theory
of
liftings
of
ordinary
abelian
varieties.
Recently,
this
theory
has
been
generalized
to
the
case
of
moduli
of
hyperbolic
curves
([Mzk1,2]).
We
refer
to
the
Introductions
of
[Mzk1,2]
for
more
on
this
phenomenon.
In
the
theory
of
[Mzk1,2],
this
sort
of
natural
Frobenius
action
on
a
p-adic
(formal)
scheme
is
referred
to
as
an
ordinary
Frobenius
lifting.
27
The
theory
of
ordinary
Frobenius
liftings
is
itself
a
special
(and,
in
some
sense,
the
simplest)
case
of
p-adic
Hodge
theory.
Thus,
in
summary,
from
this
point
of
view,
the
naive
approach
discussed
above
(involving
the
correspondence
p
â†’
p1
(n
âˆ’
[n]p
))
may
be
thought
of
as
the
approach
given
by
â€œlooking
at
the
p-adic
Hodge
theory
of
Gm
at
each
prime
p.â€
In
particular,
the
relationship
between
the
approach
of
this
paper
and
the
above
naive
approach
may
be
thought
of
as
the
diï¬€erence
between
discretizing
the
various
local
p-adic
Hodge
theories
into
a
global
Arakelov-theoretic
theory
(as
discussed
in
Â§3.1
â€“
3.4
above)
and
looking
at
the
full
completed
p-adic
Hodge
theories
individually.
In
fact,
there
is
another
important
diï¬€erence
between
the
approach
of
this
paper
log
and
the
above
naive
approach
â€”
namely,
the
diï¬€erence
between
Gm
and
M1,0
(the
log
moduli
stack
of
elliptic
curves).
That
is
to
say,
unlike
the
example
discussed
above,
which
is
essentially
concerned
with
rational
points
of
Gm
,
the
theory
of
this
paper
concerns
log
â€œabsolute
diï¬€erentiation
for
points
of
M1,0
.â€
At
the
present
time,
the
author
does
not
know
of
an
analogous
approach
to
â€œglobally
discretizingâ€
the
local
Hodge
theories
of
Gm
log
(i.e.,
of
doing
for
Gm
what
is
done
for
M1,0
in
this
paper).
Also,
it
is
interesting
to
observe
that,
unlike
many
theories
for
elliptic
curves
which
generalize
in
a
fairly
straightforward
manner
to
abelian
varieties
of
higher
dimension,
it
is
not
so
clear
how
to
generalize
the
theory
of
this
paper
to
higher-dimensional
abelian
varieties
(cf.
Â§5.2
below).
Thus,
it
is
tempting
to
conjecture
that
perhaps
the
existence
of
the
theory
of
the
present
paper
log
log
in
the
case
of
M1,0
is
somehow
related
to
the
anabelian
nature
of
M1,0
(cf.
[Mzk3],
[IN]).
That
is
to
say,
one
central
feature
of
anabelian
varieties
is
a
certain
â€œextraordinary
rigidityâ€
exhibited
by
their
p-adic
Hodge
theory
(cf.
[Groth];
the
Introduction
to
[Mzk3]).
In
particular,
it
is
tempting
to
suspect
that
this
sort
of
rigidity
or
coherence
is
what
allows
one
to
discretize
the
various
local
Hodge
theories
into
a
coherent
global
theory.
Another
interesting
observation
in
this
direction
is
that
the
theta
groups
that
play
an
essential
role
in
this
paper
are
essentially
the
same
as/intimately
related
to
the
quotient
Ï€1
(E
âˆ’
pt.)/[Ï€1
(E
âˆ’
pt.),
[Ï€1
(E
âˆ’
pt.),
Ï€1
(E
âˆ’
pt.)]]
of
the
fundamental
group
Ï€1
(E
âˆ’
pt.)
of
an
elliptic
curve
with
one
point
removed
(which
is
itself
an
anabelian
variety).
This
sort
of
quotient
of
the
fundamental
group
plays
a
central
role
in
[Mzk3].
Finally,
we
remark
that
one
point
of
view
related
to
the
discussion
of
the
preceding
paragraph
is
the
following:
One
fundamental
obstacle
to
â€œdiï¬€erentiating
an
integer
n
âˆˆ
Z
(or
Q-rational
point
of
Gm
)
over
F1
â€
is
that
the
residue
ï¬elds
Fp
at
the
diï¬€erent
points
of
Spec(Z)
diï¬€er,
thus
making
it
diï¬ƒcult
to
compare
the
value
of
n
at
distinct
points
of
Spec(Z).
On
the
other
hand,
the
theory
of
the
present
paper
â€”
which
involves
log
diï¬€erentiating
Z-valued
points
of
the
moduli
stack
of
log
elliptic
curves
M1,0
â€”
gets
around
this
problem
eï¬€ectively
by
taking
the
set
of
d-torsion
points
as
oneâ€™s
absolute
constants
that
do
not
vary
even
as
the
residue
ï¬eld
varies.
Note
that
relative
to
the
discussion
of
Â§3.4,
this
set
of
torsion
points
should
be
regarded
as
a
discrete
analogue/approximation
to
the
underlying
real
analytic
manifold
(which,
of
course,
remains
constant)
of
a
family
of
complex
elliptic
curves.
28
Â§4.
Guide
to
the
Text
In
this
Â§,
we
give
brief
summaries
of
the
contents
of
the
various
chapters
of
this
paper.
In
Chapter
I,
we
discuss
the
notion
of
a
â€œtorsorâ€
in
Arakelov
theory,
give
various
criteria
for
when
such
torsors
split,
and
ï¬nally,
explain
how
such
torsors
arise
naturally
in
arithmetic
geometry.
In
Chapter
II,
we
consider
the
issue
of
the
extent
to
which
the
Galois
action
on
the
torsion
points
of
an
elliptic
curve
over
a
number
ï¬eld
is
transitive.
We
remark
that
neither
of
these
two
chapters
is
logically
necessary
for
the
proof
of
the
main
results
of
this
paper.
(Thus,
the
reader
who
is
only
interested
in
the
proof
of
Theorem
A
(of
Â§1),
for
instance,
may
skip
these
two
chapters.)
The
reason
for
the
inclusion
of
these
two
chapters
is
that
they
help
to
clarify
the
background
of
the
Hodge-Arakelov
Comparison
Isomorphism,
as
explained
in
the
discussion
of
Â§3.2
above.
The
bulk
of
the
remainder
of
the
text
is
devoted
to
the
proof
of
the
Hodge-Arakelov
Comparison
Isomorphism.
In
Chapter
III,
we
review
basic
facts
concerning
the
universal
extension
of
an
elliptic
curve,
and
especially
its
relation
to
the
Schottky
uniformization
of
an
elliptic
curve.
In
Chapter
IV,
we
review
Mumfordâ€™s
theory
of
algebraic
theta
functions
([Mumf1,2,3])
and
Zhangâ€™s
theory
of
metrized
line
bundles
([Zh])
and
derive
various
consequences
of
these
theories
as
they
relate
to
the
theory
of
the
present
paper.
In
Chapter
V,
we
construct
the
evaluation
map
that
gives
rise
to
the
Hodge-Arakelov
Comparison
Isomorphism
and
verify
various
basic
properties
of
this
evaluation
map.
Finally,
in
Chapter
VI,
we
prove
the
scheme-theoretic
portion
of
the
Comparison
Isomorphism
by
means
of
(among
other
things)
a
rather
involved
computation
of
degrees
(cf.
the
discussion
immediately
following
the
statement
of
Theorem
A
in
Â§1).
The
next
two
chapters
(VII
and
VIII)
are
devoted
to
the
theory
of
the
Comparison
Isomorphism
at
archimedean
primes.
In
Chapter
VII,
we
discuss
various
natural
systems
of
orthogonal
functions,
which
provide
natural
coordinate
systems
in
the
spaces
of
functions
that
appear
in
the
study
of
the
Comparison
Isomorphism.
Many
of
these
systems
of
orthogonal
functions
are
closely
related
to
the
well-known
classical
systems
of
Legendre
and
Hermite.
Finally,
in
Chapter
VIII,
we
apply
the
theory
of
Chapter
VII
to
complete
the
proof
of
the
archimedean
portion
of
the
Hodge-Arakelov
Comparison
Isomorphism.
In
the
ï¬nal
chapter
of
the
text,
Chapter
IX,
we
explain
how
the
Hodge-Arakelov
Comparison
Isomorphism
may
be
applied
to
construct
an
arithmetic
Kodaira-Spencer
morphism
for
elliptic
curves
over
number
ï¬elds.
We
also
explain
how
the
Hodge-Arakelov
Comparison
Isomorphism
and
the
arithmetic
Kodaira-Spencer
morphism
derived
from
it
are
related
to
more
classical
comparison
isomorphisms
and
Kodaira-Spencer-type
morphisms
over
complex
and
p-adic
bases.
29
Â§5.
Future
Directions
Â§5.1.
Gaussian
Poles
and
the
Theta
Convolution
In
some
sense,
the
most
fundamental
outstanding
problem
left
unsolved
in
this
paper
is
the
following:
How
can
one
get
rid
of
the
Gaussian
poles
(cf.
Â§1)?
For
instance,
if
one
could
get
rid
of
the
Gaussian
poles
in
Theorem
A,
there
would
be
substantial
hope
of
applying
Theorem
A
to
Vojtaâ€™s
Conjectures
(cf.
Chapter
IX,
Example
3.5,
and
the
Remark
following
Example
3.5).
For
instance,
if
we
take
m
=
2d
in
Theorem
A
(so
that
the
metrized
line
bundle
L
is
symmetric),
then
one
gets
an
action
of
{Â±1}
on
the
domain
and
range
of
the
Comparison
Isomorphism
(which
is
itself
compatible
with
this
action).
If
one
then
decomposes
the
domain
without
Gaussian
poles
into
eigenspaces
for
this
action
(and
uses
the
fact
that
everything
is
compatible
with
the
action
of
the
theta
âŠ—2j
-torsors
(where
j
â‰¥
1
is
an
integer)
that
groups
involved),
then
one
obtains
natural
Ï‰E
split
if
and
only
if
these
eigenspaces
of
the
domain
split
into
direct
sums
of
nonpositive
powers
of
Ï‰E
.
Thus,
if
one
could
somehow
get
the
Galois
(i.e.,
Î S
)
action
resulting
from
the
Hodge-Arakelov
Comparison
Isomorphism
to
exist
without
the
Gaussian
poles,
then
violations
to
Vojtaâ€™s
Conjecture
would
result
in
a
complete
splitting
of
the
domain
(without
Gaussian
poles)
into
nonpositive
powers
of
Ï‰E
.
Since,
moreover,
this
Galois
action
is
not
likely
to
preserve
the
Hodge
ï¬ltration,
one
would
then
most
likely
obtain
morphisms
from
various
powers
of
Ï‰E
into
strictly
smaller
powers
of
Ï‰E
,
which
would
result
in
a
contradiction
(since
Ï‰E
tends
to
have
positive
degree).
The
above
sketch
of
an
argument
(i.e.,
that
one
might
be
able
to
apply
Theorem
A
to
Vojtaâ€™s
Conjectures
if
only
one
could
get
rid
of
the
Gaussian
poles)
provides,
in
the
opinion
of
the
author,
strong
motivation
for
investigating
the
issue
of
whether
or
not
one
can
somehow
eliminate
the
Gaussian
poles
from
Theorem
A.
Moreover,
the
following
argument
indicates
how
this
might
be
done:
As
discussed
in
Â§2,
in
some
sense,
one
may
regard
the
theory
of
this
paper
as
the
theory
of
the
Gaussian
and
its
derivatives.
The
classical
example
of
the
theory
of
the
Gaussian
and
its
derivatives
is
the
theory
of
Hermite
functions.
The
Hermite
functions,
which
are
various
derivatives
of
the
Gaussian,
are
not
themselves
polynomials,
but
rather
of
the
form:
(polynomial)
Â·
(Gaussian).
Thus,
it
is
natural
to
divide
the
Hermite
functions
by
the
Gaussian,
which
then
gives
us
polynomials
which
are
called
the
Hermite
polynomials.
In
the
theory
of
this
paper,
the
original
Gaussian
corresponds
(relative
to
taking
the
Fourier
expansion)
to
the
algebraic
theta
functions
of
Mumford
(i.e.,
before
we
consider
derivatives);
the
â€œunwantedâ€
Gaussian
that
remains
in
the
Hermite
functions
corresponds
to
the
Gaussian
poles.
Moreover,
since
multiplication
and
division
after
taking
the
Fourier
expansion
correspond
to
convolution,
it
is
natural
to
imagine
that
the
image
of
the
â€œdomain
without
Gaussian
polesâ€
of
the
Comparison
Isomorphism
(of
Theorem
A)
should
correspond
to
those
functions
on
the
torsion
points
30
that
are
in
the
image
of
(the
morphism
given
by)
convolution
with
the
(original)
theta
function
â€”
which
we
refer
to
as
the
â€œtheta
convolutionâ€
for
short.
Thus,
it
is
natural
to
conjecture
that:
By
studying
the
theta
convolution,
one
might
be
able
to
construct
a
Galois
action
like
the
one
needed
in
the
argument
above,
i.e.,
a
â€œGalois
action
without
Gaussian
poles.â€
In
[STC],
we
study
this
theta
convolution,
and
obtain,
in
particular,
a
theta-convoluted
comparison
isomorphism,
which
has
the
property
that,
in
a
neighborhood
of
the
divisor
at
inï¬nity,
when
one
works
with
an
eÌtale
(i.e.,
isomorphic
to
Z/dZ)
Lagrangian
subgroup,
and
a
multiplicative
(i.e.,
isomorphic
to
Î¼d
)
restriction
subgroup,
then
the
Gaussian
poles
vanish,
as
desired
(cf.
[STC],
especially
Remark
1
following
Theorem
10.1,
for
more
details).
In
fact,
this
point
of
view
is
already
implicit
in
the
present
paper
in
the
theory
of
the
metrics
â€œ||
âˆ¼
||w,Î¼a
â€
of
Chapter
VIII,
Â§1,2.
Even
in
the
case
of
the
theta-convoluted
comparison
isomorphism,
however,
the
Gaussian
poles
fail
to
vanish
(in
a
neighborhood
of
the
divisor
at
inï¬nity)
if
either
the
restriction
subgroup
fails
to
be
multiplicative
or
the
Lagrangian
subgroup
fails
to
be
eÌtale.
In
these
cases,
it
is
tempting
to
suspect
that
(at
least
at
p-adic
primes)
perhaps
by
working
over
some
sort
of
base
like
â€œBcrys
â€
â€”
over
which
Î¼d
and
Z/d
Â·
Z
become
isomorphic
â€”
these
technical
problems
involving
eÌtale
restriction
subgroups
and
multiplicative
Lagrangian
subgroups
may
be
overcome.
In
fact,
this
point
of
view
is
already
implicit
in
the
discussion
of
Chapter
IX,
Â§2,
of
the
present
paper.
It
is
the
hope
of
the
author
to
discuss
these
issues
in
a
sequel
to
the
present
paper
and
[STC]
devoted
to
the
p-adic
aspects
of
the
theta
convolution
(cf.
the
Introduction
to
[STC]).
Â§5.2.
Higher
Dimensional
Abelian
Varieties
and
Hyperbolic
Curves
Once
results
such
as
Theorem
A
(of
Â§1)
have
been
established
for
elliptic
curves,
it
is
natural
to
attempt
to
generalize
such
results
to
higher
dimensional
abelian
varieties
and
hyperbolic
curves.
Unfortunately,
however,
even
in
the
case
of
the
abelian
varieties,
where
one
expects
the
generalization
to
be
relatively
straightforward,
one
immediately
runs
into
a
number
of
problems.
For
instance,
if
one
considers
sections
of
an
ample
line
bundle
L
over
the
universal
extension
of
an
abelian
variety
of
dimension
g,
the
dimension
over
the
base
ï¬eld
of
the
space
of
global
sections
of
torsorial
degree
<
d
is:


dâˆ’1+g
Â·
dg
<
d2g
g
(where
we
assume
that
the
dimension
of
the
space
of
global
sections
of
L
over
the
abelian
variety
itself
is
equal
to
dg
)
if
g
>
1.
Thus,
the
naive
generalization
of
Theorem
Asimple
cannot
possibly
hold
(i.e.,
since
the
two
spaces
between
which
one
must
construct
an
isomorphism
have
diï¬€erent
dimensions).
Nevertheless,
it
is
the
hope
of
the
author
that
31
someday
this
sort
of
technical
problem
may
be
overcome,
and
that
the
theory
of
this
paper
may
be
generalized
to
arbitrary
abelian
varieties.
If
such
a
generalization
could
be
realized,
it
would
be
interesting
if,
for
instance,
just
as
the
various
models
(Hermite,
Legendre,
Binomial)
that
occur
in
the
archimedean
theory
of
the
present
paper
correspond
naturally
to
the
possible
slopes
of
the
action
of
Frobenius
(on
the
ï¬rst
crystalline
cohomology
module
of
an
elliptic
curve)
at
ï¬nite
primes
(cf.
the
discussion
of
this
phenomenon
in
Â§1),
it
were
the
case
that
the
corresponding
models
in
the
archimedean
theory
for
arbitrary
abelian
varieties
correspond
to
the
possible
Newton
polygons
of
the
action
of
Frobenius
(on
the
ï¬rst
crystalline
cohomology
module
of
an
abelian
variety
of
the
dimension
under
consideration)
at
ï¬nite
primes.
Another
natural
direction
in
which
to
attempt
to
generalize
the
theory
of
this
paper
would
be
to
extend
it
to
a
global/Arakelov-theoretic
Hodge
theory
of
hyperbolic
curves.
Indeed,
the
â€œcomplex
Hodge
theory
of
hyperbolic
curves,â€
which
revolves
around
the
KoÌˆbe
uniformization
of
(the
Riemann
surfaces
corresponding
to)
such
curves
by
the
upper
halfplane,
has
already
been
extended
to
the
p-adic
case
([Mzk1,2]).
Moreover,
the
theory
of
[Mzk1,2]
may
also
be
regarded
as
the
â€œhyperbolic
curve
analogueâ€
of
Serre-Tate
theory.
Thus,
it
is
natural
to
attempt
to
construct
a
â€œglobal
Arakelov
versionâ€
of
[Mzk1,2],
just
as
the
theory
of
the
present
paper
in
some
sense
constitutes
a
globalization
of
the
Serre-Tate
theory/p-adic
Hodge
theory
of
elliptic
curves
(cf.
Chapter
IX,
Â§2).
Bibliography
[Coln]
R.
Coleman,
Hodge-Tate
periods
and
p-adic
Abelian
integrals,
Inv.
Math.
78
(1984),
pp.
351-379.
[Colz1]
P.
Colmez,
PeÌriodes
p-adiques
des
varieÌteÌs
abeÌliennes,
Math.
Ann.
292
(1992),
pp.
629-644.
[Colz2]
P.
Colmez,
InteÌgration
sur
les
varieÌteÌs
p-adiques,
AsteÌrisque
248,
Soc.
Math.
de
France
(1998).
[Falt1]
G.
Faltings,
p-adic
Hodge
Theory,
Journal
of
the
Amer.
Math.
Soc.
1,
No.
1
(1988),
pp.
255-299.
[Falt2]
G.
Faltings,
Crystalline
Cohomology
and
p-adic
Galois
Representations,
Proceedings
of
the
First
JAMI
Conference,
Johns-Hopkins
University
Press
(1990),
pp.
25-79.
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer-Verlag
(1990).
[Font]
J.
M.
Fontaine,
Formes
diï¬€erentielles
et
modules
de
Tate
des
varieÌteÌs
abeÌliennes
sur
les
corps
locaux,
Inv.
Math.
65
(1982),
pp.
379-409.
[GGA]
L.
Schneps
and
P.
Lochak,
Geometric
Galois
Actions:
1.
Around
Grothendieckâ€™s
Esquisse
dâ€™un
Programme,
2.
The
Inverse
Galois
Problem,
Moduli
Spaces
and
Mapping
Class
Groups,
London
Math.
Soc.
Lect.
Note
Ser.
242-243,
Cambridge
Univ.
Press
(1997).
32
[Groth]
A.Grothendieck,
Letter
to
G.Faltings,
June
1983,
in
[GGA],
Vol.
1,
pp.
49-58.
[Hyodo]
O.
Hyodo,
On
variation
of
Hodge-Tate
structures,
Math.
Ann.
284
(1989),
pp.
7-22.
[Ihara]
Y.
Ihara,
Fermat-shou
to
â€œKazu
no
Bibunâ€
ni
tsuite
(=
â€œOn
Fermat
Quotients
and
â€˜Derivatives
of
Numbersâ€™
â€
â€”
in
Japanese)
in
Algebraic
Analysis
and
Number
Theory,
RIMS
Kokyuroku
810
(1992).
[IN]
Y.Ihara
and
H.
Nakamura,
Some
illustrative
examples
for
anabelian
geometry
in
high
dimensions,
in
[GGA],
Vol.1,
pp.
127-138.
[Kato]
K.
Kato,
Logarithmic
Structures
of
Fontaine-Illusie,
Proceedings
of
the
First
JAMI
Conference,
Johns
Hopkins
University
Press
(1990),
191-224.
[Katz1]
N.
Katz,
The
Eisenstein
Measure
and
p-adic
Interpolation,
Amer.
Journ.
of
Math.
99,
No.
2
(1977),
pp.
238-311.
[Katz2]
N.
Katz,
Serre-Tate
Local
Moduli,
Algebraic
Surfaces
(Orsay,
1976-78),
Lecture
Notes
in
Mathematics
868,
Springer-Verlag
(1981),
pp.
138-202.
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
University
Press
(1985).
[Lang]
S.
Lang,
Introduction
to
Arakelov
Theory,
Springer-Verlag
(1988),
Appendix
by
Vojta.
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deï¬ning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
2
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
[Mumf4]
D.
Mumford,
An
Analytic
Construction
of
Degenerating
Abelian
Varieties
over
Complete
Rings,
Appendix
to
[FC].
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
Publ.
of
RIMS
32
(1996),
pp.
957-1151.
[Mzk2]
S.
Mochizuki,
Foundations
of
p-adic
TeichmuÌˆller
Theory,
AMS/IP
Studies
in
Advanced
Mathematics
11,
American
Mathematical
Society/International
Press
(1999).
[Mzk3]
S.
Mochizuki,
The
Local
Pro-p
Anabelian
Geometry
of
Curves,
to
appear
in
Invent.
Math.
[STC]
S.
Mochizuki,
The
Scheme-Theoretic
Theta
Convolution,
manuscript.
[Vojta]
P.
Vojta,
Diophantine
Approximations
and
Value
Distribution
Theory,
Lecture
Notes
in
Mathematics
1239,
Springer-Verlag
(1987).
[Wint]
J.-P.
Wintenberger,
TheÌoreÌ€me
de
comparaison
p-adique
pour
les
scheÌmas
abeÌliens.
I:
Construction
de
lâ€™accouplement
de
peÌriodes,
PeÌriodes
p-Adiques,
AsteÌrisque
223,
Soc.
Math.
de
France
(1994).
[Zh]
S.
Zhang,
Admissible
pairing
on
a
curve,
Invent.
Math.
112
(1993),
pp.
171-193.
33
Chapter
I:
Torsors
in
Arakelov
Theory
Â§0.
Introduction
In
this
Chapter,
after
reviewing
various
well-known
facts
from
Arakelov
theory,
we
discuss
the
notion
of
a
torsor
in
the
Arakelov
context
and
prove
various
results
(Theorems
2.4,
3.2;
Corollary
2.5)
concerning
the
existence
of
splittings
of
such
torsors.
Finally,
in
Â§4,
we
discuss
how
such
torsors
arise
naturally
in
arithmetic
geometry,
and,
more
speciï¬cally,
how
they
relate
to
the
main
goal
of
this
paper,
which
is
to
understand
the
structure
of
the
arithmetic
torsor
deï¬ned
by
the
universal
extension
of
an
elliptic
curve.
Â§1.
Arakelov
Theory
in
Geometric
Dimension
Zero
In
this
Â§,
we
review
basic
facts
concerning
Arakelov
theory
in
the
case
of
geometric
dimension
zero.
Our
references
will
be
[GS]
and
[Szp].
Arakelov
theory
provides
a
convenient
language
for
expressing
many
well-known
results
in
elementary
number
theory.
We
begin
by
introducing
notation.
Let
K
be
a
number
ï¬eld,
i.e.,
a
ï¬nite
extension
def
of
Q.
Let
OK
be
its
ring
of
integers.
Let
d
=
[K
:
Q]
(i.e.,
the
degree
of
K
over
Q).
Let
r1
(respectively,
r2
)
be
the
number
of
real
(respectively,
complex)
places
of
K
(so
d
=
r1
+
2r2
).
Let
Î£
be
the
set
of
embeddings
K
â†’
C.
If
Ïƒ
âˆˆ
Î£,
we
write
Ïƒ
for
the
embedding
obtained
by
composing
Ïƒ
with
complex
conjugation.
Also,
if
Ïƒ
âˆˆ
Î£,
we
shall
write
Ïƒ
for
[KÏƒ
:
R].
Let
DK
âˆˆ
Z>0
be
the
absolute
value
of
the
discriminant
of
K
over
Q.
Deï¬nition
1.1.
We
shall
call
(cf.
[GS],
Â§2.4.1)
a
pair
M
=
(M,
h)
an
arithmetic
vector
bundle
over
K
(of
rank
r)
if
M
if
a
ï¬nite,
ï¬‚at
OK
-module
(such
that
dimK
(M
âŠ—OK
K)
=
r),
def
and
h
=
{hÏƒ
}ÏƒâˆˆÎ£
is
a
set
of
Hermitian
metrics
hÏƒ
on
MÏƒ
=
M
âŠ—OK
KÏƒ
such
that
the
metric
hÏƒ
is
the
complex
conjugate
of
the
metric
hÏƒ
.
We
shall
refer
to
an
arithmetic
vector
bundle
of
rank
one
as
an
arithmetic
line
bundle.
Example
1.2.
The
OK
-module
OK
equipped
with
the
metrics
given
by
the
absolute
value
|
|Ïƒ
deï¬ned
by
Ïƒ
âˆˆ
Î£
deï¬nes
a
natural
arithmetic
line
bundle.
We
shall
denote
this
arithmetic
line
bundle
by
OK
.
def
Example
1.3.
Consider
the
OK
-module
Ï‰K
=
HomZ
(OK
,
Z)
(cf.
[Szp],
Â§1.3).
Observe
that
the
trace
deï¬nes
a
natural
element
Tr
âˆˆ
Ï‰K
.
Moreover,
there
exists
a
unique
metric
34
on
(Ï‰K
)Ïƒ
such
that
|Tr|Ïƒ
=
Ï‰K
.
Ïƒ.
We
shall
denote
the
resulting
arithmetic
line
bundle
by
Note
that
if
L
and
M
are
arithmetic
vector
bundles,
then
one
can
form
various
new
âˆ¨
def
arithmetic
vector
bundles
as
follows:
L
âŠ—OK
M
;
HomOK
(M
,
L);
M
=
HomOK
(M
,
O
K
);
âˆ—
def
M
=
HomOK
(M
,
Ï‰
K
);
(for
i
âˆˆ
Zâ‰¥0
)
âˆ§i
M
.
(Note
that
our
notation
diï¬€ers
from
that
of
[GS].)
All
have
naturally
deï¬ned
metrics,
which
we
leave
to
the
reader
to
make
explicit.
If
L,
M
,
and
P
are
arithmetic
line
bundles,
then
we
deï¬ne
an
exact
sequence
of
arithmetic
line
bundles
0â†’Lâ†’M
â†’P
â†’0
to
be
an
exact
sequence
of
the
underlying
OK
-modules
such
that:
at
each
Ïƒ,
(i)
the
metric
on
LÏƒ
is
induced
by
restricting
the
metric
of
MÏƒ
;
(ii)
the
metric
on
PÏƒ
is
induced
by
the
metric
on
the
orthogonal
complement
to
LÏƒ
in
MÏƒ
.
Let
M
be
an
arithmetic
vector
bundle.
Then
we
would
like
to
deï¬ne
a
number
of
invariants
associated
to
M
.
Let
us
write
def
H0
(M
)
=
{m
âˆˆ
M
such
that
|m|Ïƒ
â‰¤
1
âˆ€Ïƒ
âˆˆ
Î£}
and
def
h0
(M
)
=
log(#H0
(M
))
âˆˆ
R
Next,
we
could
like
to
deï¬ne
the
degree
deg(M
)
of
M
.
First
of
all,
if
M
is
an
arithmetic
line
bundle,
then
for
any
m
âˆˆ
M
,
we
deï¬ne
(cf.
[GS],
Â§2.4.1)
def
deg(M
)
=
log(#(M/O
Â·
m))
âˆ’

log(|m|Ïƒ
)
âˆˆ
R
ÏƒâˆˆÎ£
This
real
number
is
easily
seen
(by
means
of
the
product
formula
of
elementary
number
theory)
to
be
independent
of
the
choice
of
m
âˆˆ
M
.
Note
that
if
M
is
an
arithmetic
line
bundle,
and
h0
(M
)
>
0
(so
H0
(M
)
has
at
least
one
nonzero
element),
then
it
follows
from
the
deï¬nition
of
H0
(M
)
that
deg(M
)
â‰¥
0.
def
More
generally,
for
M
of
arbitrary
rank
r,
we
let
deg(M
)
=
deg(âˆ§r
M
).
If
L
is
an
arithmetic
line
bundle,
then
deg(M
âŠ—
L)
=
deg(M
)
+
r
Â·
deg(L).
Moreover,
deg(âˆ’)
is
additive
on
exact
sequences.
Finally,
we
would
like
to
deï¬ne
the
Euler
characteristic
Ï‡(M
)
of
M
:
def
Ï‡(M
)
=
deg(M
)
+
r
Â·
Ï‡(OK
)
35
where
def
Ï‡(OK
)
=
r2
Â·
log(2)
âˆ’
1
log(DK
)
2
(In
[Szp],
Â§1.3,
a
diï¬€erent,
but
equivalent
deï¬nition
of
Ï‡(âˆ’)
is
given
in
terms
of
logarithms
of
volumes.)
The
invariant
Ï‡(âˆ’)
is
additive
on
exact
sequences.
Proposition
1.4.
We
have:
deg(Ï‰
K
)
=
âˆ’2
Â·
Ï‡(OK
)
=
log(DK
)
âˆ’
2r2
Â·
log(2).
Proof.
See
[Szp],
Lemma
1.4.

Next,
we
would
like
to
review
the
main
result
(Theorem
2)
of
[GS].
Theorem
1.5.
There
exists
a
universal
constant
C
âˆˆ
R>0
which
is
independent
of
K
such
that
the
following
inequalities
hold:
âˆ—
âˆ’C
Â·
(nd)
Â·
(log(nd)
+
1)
â‰¤
h0
(M
)
âˆ’
h0
(M
)
âˆ’
Ï‡(M
)
â‰¤
C
Â·
(nd)
Â·
(log(nd)
+
1)
for
any
arithmetic
vector
bundle
M
of
rank
n
>
0
over
a
number
ï¬eld
K.
Proof.
This
is
essentially
Theorem
2
of
[GS].
It
is
easy
to
see
(using
the
fact
that
N
!
â‰¤
N
N
and
Stirlingâ€™s
formula
(see,
e.g.,
[Ahlf],
Chapter
5,
Â§2.5
â€“
cf.
also
Chapter
VII,
Lemma
1.5)
to
estimate
the
size
of
the
Î“
function)
that
the
number
â€œC(r1
,
r2
,
n)â€
of
loc.
cit.
can
be
bounded
uniformly
(with
respect
to
n,
M
,
K)
by
C
Â·
(nd)
Â·
(log(nd)
+
1),
for
some
universal
C
âˆˆ
R>0
.

Â§2.
Deï¬nition
and
First
Properties
of
Torsors
Next,
we
would
like
to
deï¬ne
the
notion
of
an
arithmetic
torsor
over
an
arithmetic
vector
bundle.
Thus,
let
M
be
an
arithmetic
vector
bundle
over
K.
Deï¬nition
2.1.
We
shall
call
a
pair
T
=
(T,
s)
an
arithmetic
torsor
over
M
,
or,
simply,
an
M
-torsor
if
T
has
the
structure
of
an
M
-torsor
T
â†’
Spec(OK
)
on
Spec(OK
),
and
s
=
{sÏƒ
}ÏƒâˆˆÎ£
is
a
collection
of
rational
points
sÏƒ
âˆˆ
T
(KÏƒ
)
such
that
sÏƒ
is
the
complex
conjugate
of
sÏƒ
.
We
shall
refer
to
the
{sÏƒ
}
as
the
approximands
of
the
arithmetic
torsor
T.
36
Let
T
be
an
M
-torsor.
Then
we
shall
be
especially
interested
in
the
issue
of
when
T
â€œsplits,â€
or
â€œis
trivial.â€
Deï¬nition
2.2.
We
shall
say
that
T
splits
if
there
exists
a
t
âˆˆ
T
(OK
)
such
that
for
each
Ïƒ
âˆˆ
Î£,
the
element
t
âˆ’
sÏƒ
âˆˆ
MÏƒ
satisï¬es
|t
âˆ’
sÏƒ
|
â‰¤
1.
In
this
case,
t
will
be
called
a
splitting
of
T
,
and
we
shall
write
t
âˆˆ
T
(OK
).
If
>
0
and
|t
âˆ’
sÏƒ
|
â‰¤
for
all
Ïƒ
âˆˆ
Î£,
then
we
shall
call
t
a
splitting
of
proximity
,
or,
simply,
an
-splitting.
If
t
âˆ’
sÏƒ
=
0
for
all
Ïƒ
âˆˆ
Î£,
then
we
shall
say
that
the
torsor
T
is
trivial.
Example
2.3.
Suppose
that
0
â†’
M
â†’
P
â†’
OK
â†’
0
is
an
exact
sequence
of
arithmetic
vector
bundles
(over
K).
Then
the
splittings
O
K
â†’
P
of
this
exact
sequence
form
an
M
torsor
T
in
a
natural
way:
Indeed,
if
we
forget
about
metrics,
then
the
splittings
OK
â†’
P
form
an
M
-torsor
T
â†’
Spec(OK
).
Thus,
it
remains
to
deï¬ne
the
â€œsplittings
at
the
inï¬nite
prime,â€
i.e.,
the
sÏƒ
.
We
take
sÏƒ
to
be
the
splitting
deï¬ned
by
the
orthogonal
complement
to
MÏƒ
in
PÏƒ
.
This
gives
us
an
M
-torsor
T
.
In
fact,
it
is
easy
to
show
that
every
M
-torsor
arises
in
this
way.
Moreover,
T
is
trivial
if
and
only
if
P
âˆ¼
=
M
âŠ•
OK
.
Next,
we
would
like
to
use
Theorem
1.5
above
to
show
that
if
L
is
a
line
bundle
of
large
degree,
then
every
L-torsor
splits.
Theorem
2.4.
There
exists
a
universal
constant
Cd
âˆˆ
R
depending
only
on
d
=
[K
:
Q]
with
the
following
property:
Let
L
be
an
arithmetic
line
bundle
over
K
such
that
the
inequality
deg(L)
â‰¥
log(DK
)
+
Cd
is
satisï¬ed.
Then
any
L-torsor
T
splits.
Proof.
Let
Î»
âˆˆ
R>0
.
Let
us
write
Z(Î»)
for
the
arithmetic
line
bundle
over
Q
deï¬ned
as
follows:
The
underlying
Z-module
of
Z(Î»)
is
Z,
while
the
norm
of
1
âˆˆ
Z
is
given
by
|1|
=
Î»âˆ’1
.
Thus,
if
Î»
is
much
greater
than
1,
Z(Î»)
will
have
lots
of
global
sections
(i.e.,
its
h0
will
be
large).
Since
the
underlying
Z-module
of
Z(Î»)
is
Z,
one
can
regard
H0
(Z(Î»))
as
a
(ï¬nite)
subset
of
Z.
Let
NÎ»
be
the
product
of
all
the
positive
elements
of
this
subset.
Thus,
NÎ»
âˆˆ
Z,
and
every
nonzero
element
of
H0
(Z(Î»))
divides
NÎ»
.
def
Next,
let
C
be
the
universal
constant
of
Theorem
1.5.
Let
Cd
=
2C(d
+
1)(1
+
log(d
+
1))
+
1
âˆˆ
R.
Let
Î»
be
a
real
number
>
1
and
such
that
log(Î»)
â‰¥
Cd
.
Let
Cd
be
a
positive
real
number
such
that
Cd
â‰¥
Cd
and
Cd
>
log(NÎ»
).
In
the
following,
we
would
like
to
show
that
this
Cd
has
the
property
stated
in
the
theorem.
Now
let
L
be
an
arithmetic
line
bundle
over
K
satisfying
the
inequality
in
the
statement
of
the
theorem.
Then
we
wish
to
deï¬ne
a
new
arithmetic
line
bundle
LÎ»
over
K
as
37
follows:
The
underlying
OK
-module
LÎ»
will
be
the
OK
-submodule
NÎ»
Â·
L
âŠ†
L.
The
metric
on
(LÎ»
)Ïƒ
=
LÏƒ
is
deï¬ned
by
taking
Î»
times
the
metric
on
LÏƒ
.
Thus,
we
have
an
inclusion
Ï†
:
LÎ»
â†’
L
which
is
â€œglobally
integralâ€
in
the
sense
that
the
following
two
conditions
are
satisï¬ed:
(i)
Î±
âˆˆ
LÎ»
maps
to
an
element
of
L;
(ii)
Î±
âˆˆ
(LÎ»
)Ïƒ
with
absolute
value
â‰¤
1
maps
to
an
element
of
LÏƒ
with
absolute
value
â‰¤
1.
It
is
then
immediate
from
Deï¬nition
2.1
that
every
L-torsor
T
arises
from
an
LÎ»
-torsor
T
Î»
by
pushing
forward
via
Ï†.
Now
let
us
consider
the
L-torsor
T
arising
(cf.
Example
2.3)
from
an
exact
sequence
0
â†’
L
â†’
M
â†’
OK
â†’
0
By
the
remark
at
the
end
of
the
last
paragraph,
it
follows
that
this
exact
sequence
can
always
be
obtained
by
pushing
forward
(via
Ï†)
an
exact
sequence
0
â†’
LÎ»
â†’
M
Î»
â†’
O
K
â†’
0
Next,
let
us
â€œpush-forwardâ€
this
exact
sequence
via
â€œSpec(O
K
)
â†’
Spec(Z)â€
so
as
to
obtain
an
exact
sequence
of
arithmetic
vector
bundles
over
Q.
Then,
let
us
pull-back
this
exact
sequence
via
the
morphism
of
Z-modules
Z
â†’
O
K
given
by
the
structure
of
OK
as
a
Z-algebra.
This
gives
us
an
exact
sequence
0
â†’
LÎ»
â†’
P
Î»
â†’
Z
â†’
0
Finally,
let
us
tensor
this
exact
sequence
with
Z(Î»).
This
gives
us
an
exact
sequence
0
â†’
LÎ»
(Î»)
â†’
P
Î»
(Î»)
â†’
Z(Î»)
â†’
0
We
would
like
to
use
Theorem
1.5
to
compute
the
number
of
global
sections
of
the
arithmetic
vector
bundles
in
this
exact
sequence.
First,
let
us
observe
that
Ï‡(LÎ»
(Î»))
=
âˆ’log(NÎ»
)
+
Ï‡(L)
=
âˆ’log(NÎ»
)
+
deg(L)
+
Ï‡(OK
)
In
particular,
deg(LÎ»
(Î»))
=
âˆ’log(NÎ»
)
+
deg(L).
Thus,
deg(HomZ
(LÎ»
(Î»),
Z))
=
log(NÎ»
)
âˆ’
deg(L)
+
log(DK
)
âˆ’
2r2
Â·
log(2)
â‰¤
log(NÎ»
)
+
log(DK
)
âˆ’
deg(L)
<
Cd
+
log(DK
)
âˆ’
deg(L)
38
(where
the
last
inequality
follows
from
the
fact
that
we
chose
Cd
to
be
>
log(NÎ»
)).
It
thus
follows
that
HomZ
(LÎ»
(Î»),
Z))
is
an
arithmetic
line
bundle
over
K
whose
degree
is
negative.
Thus,
by
[Szp],
Lemma
1.1,
this
arithmetic
line
bundle
has
no
global
sections.
Similarly,
since
Ï‡(Z(Î»))
=
deg(Z(Î»))
=
log(Î»),
we
conclude
that
HomZ
(Z(Î»),
Z)
has
no
global
sections.
It
thus
follows
that
HomZ
(P
Î»
(Î»),
Z)
also
has
no
global
sections.
Now
we
are
ready
to
apply
Theorem
1.5.
We
thus
obtain
that
h0
(P
Î»
(Î»))
â‰¥
Ï‡(P
Î»
(Î»))
âˆ’
C(d
+
1)(1
+
log(d
+
1))
>
log(Î»)
+
Ï‡(LÎ»
(Î»))
âˆ’
Cd
+
C(d
+
1)(1
+
log(d
+
1))
â‰¥
(log(Î»)
âˆ’
Cd
)
+
Ï‡(LÎ»
(Î»))
+
Cd(1
+
log(d))
â‰¥
h0
(LÎ»
(Î»))
Thus,
there
exists
a
section
s
âˆˆ
H0
(P
Î»
(Î»))
whose
image
s
in
Z(Î»)
is
nonzero.
Thus,
s
âˆˆ
Z
divides
NÎ»
.
Then,
unraveling
all
of
the
complicated
deï¬nitions
reveals
that
if
we
divide
the
section
s
by
the
integer
s
,
we
obtain
a
section
s
âˆˆ
M
whose
image
in
OK
is
1.
Thus,
it
remains
to
analyze
s
at
the
inï¬nite
primes.
Let
us
denote
(for
Ïƒ
âˆˆ
Î£)
by
Î´Ïƒ
(respectively,
Î´Ïƒ
)
the
orthogonal
projection
of
s
(respectively,
s
)
to
(LÎ»
(Î»))Ïƒ
(respectively,
LÏƒ
).
Then
since
s
is
â€œintegral
at
Ïƒ,â€
it
follows
that
|Î´Ïƒ
|2Ïƒ
â‰¤
|Î´Ïƒ
|2Ïƒ
+
Î»âˆ’2
Â·
(s
)2
â‰¤
1
On
the
other
hand,
|Î´Ïƒ
|Ïƒ
=
(s
)âˆ’1
Â·
|Î´Ïƒ
|Ïƒ
.
Thus,
it
follows
immediately
that
|Î´Ïƒ
|Ïƒ
â‰¤
1.
In
other
words,
s
deï¬nes
a
splitting
of
the
torsor
T
.
This
completes
the
proof
of
the
theorem.

Remark.
Theorem
2.4
is
the
number-theoretic
analogue
of
the
following
well-known
fact
concerning
line
bundles
on
algebraic
curves:
If
X
is
a
smooth,
geometrically
connected,
proper
curve
over
a
ï¬eld
k,
and
L
is
a
line
bundle
on
X
such
that
deg(L)
â‰¥
deg(Ï‰X/k
)
+
1,
then
H1
(X,
L)
=
0.
Corollary
2.5.
There
exists
a
universal
constant
Cd
âˆˆ
R
depending
only
on
d
=
[K
:
Q]
with
the
following
property:
Let
E
be
an
arithmetic
vector
bundle
of
rank
r
over
a
number
ï¬eld
K
which
is
equipped
with
a
ï¬ltration
of
arithmetic
vector
bundles
0
=
E
0
âŠ†
E
1
âŠ†
E
2
âŠ†
.
.
.
âŠ†
E
râˆ’1
âŠ†
E
r
=
E
def
such
that
for
all
i
=
0,
.
.
.
,
r,
the
subquotients
Li
=
E
i
/E
iâˆ’1
are
arithmetic
line
bundles
which
satisfy
the
inequality
39
deg(Li
)
â‰¥
log(DK
)
+
d
Â·
log(r)
+
Cd
Then
any
E-torsor
T
splits.
Proof.
Given
an
E-torsor,
we
may
assume
that
the
E-torsor
arises
(by
push-forward)
def
from
some
torsor
over
E(râˆ’1
)
=
E
âŠ—Z
Z(râˆ’1
).
By
applying
Theorem
2.4
to
the
pushforward
of
this
E(râˆ’1
)-torsor
via
the
surjection
E(râˆ’1
)
â†’
Lr
(râˆ’1
)
â€“
where
we
note
that
by
assumption,
deg(Lr
(râˆ’1
))
â‰¥
log(DK
)
+
CD
so
it
is
alright
to
apply
Theorem
2.4
to
Lr
(râˆ’1
)
â€“
we
obtain
a
splitting
of
the
resulting
Lr
(râˆ’1
)-torsor.
Thus,
to
split
the
E(râˆ’1
)-torsor
in
question,
it
remains
to
split
a
certain
E
râˆ’1
(râˆ’1
)-torsor.
Continuing
in
this
fashion
(i.e.,
pushing
forward
the
E
râˆ’1
(râˆ’1
)-torsor
via
the
surjection
E
râˆ’1
(râˆ’1
)
â†’
Lrâˆ’1
(râˆ’1
),
splitting
the
resulting
Lrâˆ’1
(râˆ’1
)-torsor
by
Theorem
2.4,
etc.)
we
see
that
relative
to
the
E(râˆ’1
)-torsor
in
question,
we
obtain
a
splitting
sE
of
the
underlying
E(râˆ’1
)-torsor
whose
distance
at
an
archimedean
prime
Ïƒ
from
the
approximand
(cf.
Deï¬nition
2.1)
at
Ïƒ
is
â‰¤
1
+
1
+
...
+
1
=
r
(i.e.,
a
total
of
r
â€œ1â€â€™s),
where
the
r
â€œ1â€â€™s
arise
from
the
distance
from
the
approximands
of
the
torsors
over
L1
(râˆ’1
),
L2
(râˆ’1
),
.
.
.
,
Lr
(râˆ’1
)
that
we
split
in
the
process
of
constructing
sE
.
On
the
other
hand,
to
say
that
sE
has
distance
â‰¤
r
from
the
approximands
of
the
E(râˆ’1
)-torsor
in
question
means
precisely
(by
the
deï¬nition
of
the
â€œ(r
âˆ’1
)â€)
that
if
we
regard
sE
as
a
splitting
of
the
original
E-torsor,
the
distance
of
sE
at
an
archimedean
place
Ïƒ
from
the
approximand
(of
the
original
E-torsor)
at
Ïƒ
is
â‰¤
1,
i.e.,
that
sE
deï¬nes
a
splitting
of
the
original
E-torsor,
as
desired.

Â§3.
Splittings
with
Bounded
Denominators
Unfortunately,
Theorem
2.4
is
only
useful
when
considering
collections
of
torsors
all
of
which
are
deï¬ned
over
number
ï¬elds
of
bounded
degree
(over
Q).
Ideally,
however,
we
would
like
to
be
able
to
consider
collections
of
torsors
over
various
number
ï¬elds
of
arbitrarily
large
degree.
In
this
case,
we
are
not
able
to
obtain
as
sharp
a
result
as
Theorem
2.4,
and
instead
must
settle
for
splittings
with
denominators,
as
follows:
Let
M
be
an
arithmetic
vector
bundle
over
K.
Let
T
=
(T,
s)
be
an
M
-torsor.
Thus,
T
is
an
M
-torsor.
Since
Spec(OK
)
is
aï¬ƒne,
there
exists
a
splitting
of
T
,
i.e.,
an
OK
isomorphism
Î±
:
T
âˆ¼
=
M
.
Now
let
t
âˆˆ
T
(K)
=
TK
(K)
be
a
splitting
of
the
MK
-torsor
TK
40
(where
the
subscript
K
denotes
â€œâŠ—OK
Kâ€).
Then
we
may
deï¬ne
the
ideal
of
denominators
of
t
as
follows:
def
It
=
{a
âˆˆ
OK
|
a
Â·
Î±K
(t)
âˆˆ
M
}
(where
Î±K
:
TK
âˆ¼
=
MK
).
Since,
for
any
m
âˆˆ
M
,
we
have
aÂ·Î±K
(t)
âˆˆ
M
â‡â‡’
aÂ·Î±K
(t+
m)
âˆˆ
M
,
it
follows
that
It
does
not
depend
on
the
choice
of
Î±.
Note
that
It
will
always
be
a
nonzero
ideal
in
OK
.
Also,
let
us
write
def
Den(t)
=
log(OK
/It
)
+

max{0,
log(|t
âˆ’
sÏƒ
|Ïƒ
)}
Ïƒ
where
the
sum
ranges
over
all
Ïƒ
âˆˆ
Î£.
Note
that
t
deï¬nes
an
(integral)
splitting
(cf.
Deï¬nition
2.2)
âˆˆ
T
(OK
)
if
and
only
if
Den(t)
=
0.
Deï¬nition
3.1.
For
t
âˆˆ
TK
,
we
shall
refer
to
the
ideal
It
âŠ†
OK
as
the
ideal
of
denominators
of
t.
Morever,
we
deï¬ne
the
size
of
the
denominators
of
t
to
be
the
number
Den(t)
âˆˆ
Râ‰¥0
.
If
Î»
âˆˆ
R,
then
we
shall
call
a
section
t
âˆˆ
T
(K)
a
splitting
with
denominators
of
size
â‰¤
Î»
if
Den(t)
â‰¤
Î».
Finally,
we
shall
say
that
t
is
integral
at
a
prime
p
(respectively,
Ïƒ
âˆˆ
Î£)
of
K
if
p
does
not
lie
in
the
support
of
OK
/It
(respectively,
|t
âˆ’
sÏƒ
|Ïƒ
â‰¤
1).
Theorem
3.2.
There
exists
a
universal
constant
C
âˆˆ
R
with
the
following
property:
Let
E
be
an
arithmetic
vector
bundle
of
rank
r
over
a
number
ï¬eld
K
which
is
equipped
with
a
ï¬ltration
of
arithmetic
vector
bundles
0
=
E
0
âŠ†
E
1
âŠ†
E
2
âŠ†
.
.
.
âŠ†
E
râˆ’1
âŠ†
E
r
=
E
def
such
that
for
all
i
=
0,
.
.
.
,
r,
the
subquotients
Li
=
E
i
/E
iâˆ’1
are
arithmetic
line
bundles
which
satisfy
the
inequality
deg(Li
)
>
log(DK
)
def
(where
d
=
[K
:
Q]).
Then
any
E-torsor
T
admits
a
splitting
with
denominators
of
size
â‰¤
1
log(DK
)
+
C
Â·
rd(log(rd)
+
1)
2
(cf.
Deï¬nition
3.1).
41
Proof.
Just
as
in
the
proof
of
Theorem
2.4,
for
Î»
âˆˆ
R>0
,
we
write
OK
(Î»)
for
the
arithmetic
line
bundle
over
K
deï¬ned
as
follows:
The
underlying
OK
-module
of
O
K
(Î»)
is
OK
;
the
def
norm
of
1
âˆˆ
OK
at
each
Ïƒ
âˆˆ
Î£
is
given
by
|1|Ïƒ
=
Î»âˆ’1
.
Thus,
if
Î»
is
much
greater
than
1,
OK
(Î»)
will
have
lots
of
global
sections
(i.e.,
its
h0
will
be
large).
Observe
further
that
if
Î»
â‰¥
1,
then
one
has
a
natural
inclusion
OK
=
OK
(1)
â†’
O
K
(Î»)
(which
induces
the
identity
map
OK
â†’
OK
on
the
underlying
OK
-modules).
This
inclusion
is
integral
at
all
the
primes
(ï¬nite
and
inï¬nite)
of
K.
def
that
If
E
is
an
arithmetic
vector
bundle
on
K,
let
us
write
E(Î»)
=
E
âŠ—OK
OK
(Î»).
Note
deg(E(Î»))
=
deg(E)
+
rd
Â·
log(Î»)
If
Î»
â‰¥
1,
we
have
a
natural
inclusion
E(Î»âˆ’1
)
â†’
E
(given
by
tensoring
the
inclusion
of
the
preceding
paragraph
with
E(Î»âˆ’1
)).
Note
that
by
â€œpushing
forwardâ€
(or,
equivalently,
executing
a
â€œchange
of
structure
groupâ€)
via
this
inclusion,
any
E(Î»âˆ’1
)-torsor
induces
an
E-torsor.
Moreover,
it
follows
easily
from
the
deï¬nitions
that
every
E-torsor
arises
in
this
fashion
from
some
(not
necessarily
unique)
E(Î»âˆ’1
)-torsor.
Now
let
Î»
âˆˆ
R
be
â‰¥
1.
Let
us
assume
that
we
are
given
an
E-torsor,
together
with
an
E(Î»âˆ’1
)-torsor
from
which
it
arises.
This
E(Î»âˆ’1
)-torsor
may
be
thought
of
as
corresponding
to
an
exact
sequence
(cf.
Example
2.3)
0
â†’
E(Î»âˆ’1
)
â†’
M
â†’
O
K
â†’
0
If
we
tensor
this
exact
sequence
with
OK
(Î»),
then
we
obtain
an
exact
sequence
0
â†’
E
â†’
M
(Î»)
â†’
OK
(Î»)
â†’
0
Now
we
would
like
to
compute
(cf.
the
proof
of
Theorem
2.4)
the
various
h0
â€™s
of
this
exact
sequence.
Let
us
write
C
(>
0)
for
the
universal
constant
of
Theorem
1.5.
Then
Theorem
1.5
implies
that
h0
(M
(Î»))
â‰¥
h0
((M
(Î»))âˆ—
)
âˆ’
(r
+
1)C
d(log(d)
+
log(r
+
1)
+
1)
+
Ï‡(M
(Î»))
â‰¥
deg(M
(Î»))
âˆ’
2C
rd(log(rd)
+
2)
+
(r
+
1)Ï‡(O
K
)
=
deg(E)
+
d
Â·
log(Î»)
âˆ’
2C
rd(log(rd)
+
2)
+
(r
+
1)Ï‡(O
K
)
42
Next,
let
us
observe
that
for
i
=
0,
.
.
.
,
r,
we
have
âˆ—
deg(Li
)
=
deg(Ï‰
K
)
âˆ’
deg(Li
)
â‰¤
log(DK
)
âˆ’
deg(Li
)
<
0
(by
Proposition
1.4
and
the
assumptions
on
E).
Thus,
in
particular,
we
have
(for
i
=
âˆ—
âˆ—
0,
.
.
.
,
r)
h0
(Li
)
=
0.
Since
the
given
ï¬ltration
on
E
induces
a
ï¬ltration
on
E
with
âˆ—
subquotients
equal
to
Li
(for
i
=
0,
.
.
.
,
r),
we
thus
obtain:
âˆ—
h0
(E
)
=
0
In
particular,
Theorem
1.5
implies
that
h0
(E)
â‰¤
Ï‡(E)
+
C
rd(log(rd)
+
1)
=
deg(E)
+
r
Â·
Ï‡(OK
)
+
C
rd(log(rd)
+
1)
Putting
everything
together,
we
see
that
h0
(M
(Î»))
âˆ’
h0
(E)
â‰¥
Ï‡(OK
)
+
d
Â·
log(Î»)
âˆ’
3C
rd(log(rd)
+
2)
1
â‰¥
d
Â·
log(Î»)
âˆ’
log(DK
)
âˆ’
3C
rd(log(rd)
+
2)
2
Now
let
us
set
def
Î»
=
1
log(DK
)
+
C
Â·
r(log(rd)
+
1)
2d
def
where
C
=
7C
.
Then
we
obtain
that
h0
(M
(Î»))
âˆ’
h0
(E)
>
0,
i.e.,
there
exists
some
globally
integral
m
âˆˆ
M
(Î»)
whose
image
m
in
O
K
(Î»)
is
nonzero.
Moreover,
the
zero
locus
of
m
âˆˆ
OK
(Î»)
has
logarithmic
degree
=
deg(O
K
(Î»))
=
d
Â·
log(Î»).
Thus,
sorting
through
m
the
deï¬nitions,
we
conclude
that
m

deï¬nes
a
splitting
of
the
torsor
T
with
denominators
of
size
â‰¤dÂ·Î»=
1
log(DK
)
+
C
Â·
rd(log(rd)
+
1)
2
as
desired.

43
Â§4.
Examples
from
Geometry
In
this
Â§,
we
survey
various
examples
of
Arakelov-theoretic
torsors
that
arise
naturally
in
arithmetic
geometry.
For
a
more
detailed
discussion
of
the
ideas
surrounding
this
topic,
we
refer
to
the
Introductions
of
[Mzk1,2]
(especially,
Â§0.8,
2.3,
of
the
Introduction
to
[Mzk2]).
In
particular,
we
explain
the
relationship
of
the
general
notion
of
a
torsor
in
Arakelov
theory
to
the
main
topic
of
this
paper,
which
is,
eï¬€ectively,
the
study
of
a
speciï¬c
Arakelov-theoretic
torsor
canonically
associated
to
the
universal
extension
of
an
elliptic
curve.
Let
K
be
a
ï¬nite
extension
of
Q,
whose
ring
of
integers
we
denote
OK
.
Let
X
be
a
smooth
scheme
over
OK
.
Let
L
be
a
line
bundle
on
X.
Then
L
admits
a
connection
Zariski
locally
on
X
(since
Zariski
locally
it
is
isomorphic
to
the
trivial
line
bundle),
hence
naturally
deï¬nes
a
cohomology
class
c1
(L)
âˆˆ
H
1
(X,
Î©X/OK
)
which
is
the
Hodge-theoretic
ï¬rst
Chern
class
of
the
line
bundle
L.
More
geometrically,
one
may
think
of
the
space
of
connections
on
L
as
a
torsor
TL
â†’
X
over
the
vector
bundle
Î©X/OK
.
That
is
to
say,
Î©X/OK
acts
on
TL
(by
adding
a
diï¬€erential
Ï‰
to
a
given
connection
âˆ‡
to
form
a
new
connection
âˆ‡+Ï‰),
and
moreover,
any
two
sections
of
TL
diï¬€er
by
a
section
of
Î©X/OK
.
Typically,
this
torsor
will
not
admit
any
algebraic
sections
X
â†’
TL
over
X
(cf.,
e.g.,
[Mzk1],
Chapter
I,
Â§3,
Theorem
3.4).
In
fact,
if
the
topological
ï¬rst
Chern
class
of
L
(with
coeï¬ƒcients
in
Q)
is
nonzero,
then
it
follows
that
such
sections
do
not
exist.
For
instance,
if
L
is
ample
and
X
is
proper
(of
dimension
â‰¥
1)
over
OK
,
then
its
ï¬rst
Chern
class
will
be
nonzero,
so
TL
â†’
X
will
not
admit
any
global
sections.
Write
def
X
=
X(C)
for
the
complex
manifold
associated
to
X
over
C.
More
generally,
in
the
following
discussion,
we
shall
use
ordinary
Roman
letters
for
algebraic
objects
over
Z,
and
calligraphic
letters
for
the
associated
complex
analytic
objects.
(The
sole
exception
to
this
rule
will
be
def
the
notation
â€œOâ€
for
the
structure
sheaf.)
Thus,
we
write
TL
=
TL
(C).
Then
one
may
consider
real
analytic
sections
s
:
X
â†’
TL
44
of
the
torsor
TL
â†’
X
.
Typically,
holomorphic
sections
will
not
exist
(for
instance,
if
X
is
proper,
then
holomorphic
sections
are
equivalent
to
algebraic
ones).
However,
if
one
works
instead
in
the
real
analytic
category,
then
it
is
not
diï¬ƒcult
to
show
that
real
analytic
sections
always
exist.
For
instance,
if
|
âˆ’
|L
is
a
C
âˆ
metric
on
the
line
bundle
L,
then
it
is
a
well-known
fact
from
complex
geometry
(cf.,
e.g.,
[Wells],
Chapter
III,
Â§2)
that
|
âˆ’
|L
deï¬nes
a
natural
C
âˆ
connection
âˆ‡
on
L.
Thus,
(by
taking
the
â€œ(1,
0)-partâ€
of)
the
connection
âˆ‡
deï¬nes
a
C
âˆ
section
of
the
torsor
TL
â†’
X
.
If
|
âˆ’
|L
is
real
analytic
(and,
in
fact,
it
is
not
diï¬ƒcult
to
show
that
every
C
âˆ
metric
may
be
approximated
by
a
real
analytic
one),
then
the
corresponding
section
of
TL
â†’
X
will
be
real
analytic.
In
summary,
Real
analytic
metrics
on
L
deï¬ne
real
analytic
sections
of
TL
â†’
X
.
Moreover,
if
a
real
analytic
|
âˆ’
|L
deï¬nes
the
section
s
:
TL
â†’
X
,
then
the
real
analytic
(1,
1)-form
âˆ‚(s)
âˆˆ
Î“real
analytic
(X
,
âˆ§1,1
Î©X
)
on
X
is
(up
to
a
universal
constant
factor)
the
curvature
of
the
metric
|
âˆ’
|L
.
Next,
we
list
some
typical
examples
of
this
sort
of
situation:
Example
4.1.
X
=
an
abelian
variety
over
an
open
subset
of
Spec(OK
).
In
this
case,
there
is
a
unique
(up
to
constant
multiple)
real
analytic
metric
on
L
whose
curvature
is
invariant
with
respect
to
translation
(cf.
[Mumf3],
Â§12).
Thus,
we
have
canonical
metrics
on
L.
For
instance,
in
the
case
where
X
is
an
elliptic
curve
E,
and
L
=
OE
(eE
)
(where
eE
is
the
origin
of
E),
TL
has
a
natural
abelian
group
scheme
structure
(cf.
Chapter
III,
Â§1,
4).
This
abelian
group
scheme
is
called
the
universal
extension
of
E
and
is
denoted
by
E
â€ 
(cf.
Chapter
III
for
a
more
detailed
discussion
of
the
universal
extension).
Moreover,
in
this
case,
the
real
analytic
section
E
â†’
E
â€ 
deï¬ned
by
the
canonical
metric
on
L
is
simply
the
section
deï¬ned
by
the
real
analytic
subvariety
â€ 
ER
âŠ†
E
â€ 
which
is
the
closure
of
the
torsion
points
of
E
â€ 
.
We
refer
to
the
discussion
of
the
â€œReal
Analytic
Splittingâ€
in
Chapter
III,
Â§3,
for
more
details.
This
splitting
in
the
case
of
elliptic
curves
will
play
a
fundamental
role
in
this
paper.
Example
4.2.
X
=
Ag
,
the
moduli
stack
of
principally
polarized
abelian
varieties
of
dimension
g
over
Z.
In
this
case,
the
Siegel
upper
half-plane
uniformization
of
the
analytic
stack
Ag
carries
a
natural
KaÌˆhler
metric
which
is
the
unique
metric
on
the
Siegel
upper
half-plane
that
is
invariant
with
respect
to
the
natural
action
of
Sp2g
(R)
on
the
Siegel
45
upper
half-plane.
For
instance,
if
g
=
1,
then
this
metric
is
the
well-known
PoincareÌ
metric
dx
âˆ§
dy
y2
on
the
upper
half-plane.
This
metric
induces
a
real
analytic
metric
on
the
canonical
bundle
of
Ag
(which
is
well-known
to
be
ample).
Example
4.3.
X
is
a
hyperbolic
curve
over
an
open
subset
of
Spec(OK
).
(A
â€œhyperbolic
curveâ€
is
a
family
of
curves
obtained
by
removing
a
divisor
of
degree
r
which
is
eÌtale
over
the
base
from
a
family
of
smooth,
proper,
connected
genus
g
curves
such
that
2gâˆ’2+r
>
0.)
In
this
case,
it
follows
from
a
well-known
theorem
(â€œKoÌˆbeâ€™s
uniformization
theoremâ€)
of
complex
analysis
that
the
univeral
cover
of
the
associated
analytic
object
X
is
(a
disjoint
union
of
copies
of)
the
upper
half-plane.
Thus,
the
PoincareÌ
metric
on
the
upper
half-plane
descends
to
deï¬ne
a
real
analytic
KaÌˆhler
metric
on
X
.
Moreover,
this
real
analytic
KaÌˆhler
metric
deï¬nes
a
real
analytic
metric
on
the
canonical
bundle
of
X
(cf.
the
Introductions
to
[Mzk1,2]).
Example
4.4.
X
=
Mg,r
,
the
moduli
stack
of
hyperbolic
curves
of
type
(g,
r)
over
Z.
In
this
case,
there
is
a
canonical
real
analytic
KaÌˆhler
metric
on
the
associated
analytic
object
Mg,r
called
the
Weil-Petersson
metric.
This
real
analytic
KaÌˆhler
metric
deï¬nes
a
real
analytic
metric
on
the
canonical
bundle
of
Mg,r
(cf.
the
Introductions
to
[Mzk1,2]).
We
also
note
that
the
case
of
open
X,
or
of
X
which
have
semi-stable
reduction
over
OK
,
may
be
handled
in
a
parallel
fashion
to
the
smooth
case,
using
log
structures.
Since
we
do
not
need
to
use
log
structures
in
any
rigorous
sense
in
the
present
survey,
we
leave
this
generalization
to
the
reader.
Thus,
to
summarize,
we
see
that
canonical
line
bundles
L
on
smooth
OK
-schemes
X
naturally
deï¬ne
torsors
TL
(over
the
sheaf
of
diï¬€erentials
Î©X/OK
on
X)
which
typically
have
natural
real
analytic
sections
at
the
inï¬nite
primes
of
K
arising
from
canonical
real
analytic
KaÌˆhler
metrics
on
X(C).
In
particular,
if
one
is
given
an
OK
-rational
point
x
âˆˆ
X(OK
)
then,
by
restriction,
one
obtains
a
torsor
TL
|x
over
the
OK
-vector
bundle
Î©X/OK
|x
,
equipped
with
trivializations
at
the
inï¬nite
primes
of
K
(obtained
by
restricting
the
natural
real
analytic
section
of
TL
â†’
X
).
Since
Î©X/OK
|x
also
gets
a
metric
(obtained
by
restricting
the
KaÌˆhler
metric
on
X
=
X(C)),
we
thus
see
that
we
get
precisely
the
data
of
Deï¬nition
2.1,
i.e.,
for
each
rational
point
x,
we
obtain
an
arithmetic
torsor
(as
in
Â§2)
naturally
associated
to
x.
This
shows
how
arithmetic
torsors
arise
naturally
in
arithmetic
geometry.
46
In
the
present
paper,
we
will
especially
be
interested
in
the
cases
where
X
is
either
(i)
an
elliptic
curve
E,
or
(ii)
the
moduli
stack
of
elliptic
curves
over
Z.
In
fact,
the
torsor
arising
from
Examples
4.2,
4.3,
above
in
the
case
of
the
moduli
stack
of
elliptic
curves
may
be
thought
of
as
precisely
the
torsor
obtained
from
the
tautological
elliptic
curve
by
looking
at
tangent
space
to
the
origin
of
the
universal
extension
of
the
tautological
elliptic
curve
(cf.
Chapter
III,
Proposition
1.3;
Chapter
III,
Â§3,
â€œThe
Real
Analytic
Splittingâ€;
[Mzk2],
Introduction,
Â§0.7,
0.8).
Thus,
in
summary,
the
torsors
that
we
are
interested
in
in
the
present
paper
all
arise
as
the
restriction
to
some
sort
of
rational
point
(where
(ii)
above
corresponds
eï¬€ectively
to
the
case
where
the
rational
point
is
valued
in
some
sort
of
ring
of
â€œdual
numbersâ€)
of
the
arithmetic
torsor
â€ 
(E
â€ 
â†’
E,
ER
âŠ†
E
â€ 
)
given
by
the
universal
extension
of
an
elliptic
curve.
Put
another
way,
The
main
goal
of
the
present
paper
is
to
understand
the
arithmetic
torsor
â€ 
(E
â€ 
â†’
E,
E
âŠ†
E
â€ 
)
given
by
the
universal
extension
of
an
elliptic
curve.
R
Bibliography
[Ahlf]
L.
Ahlfors,
Complex
Analysis,
McGraw-Hill
Book
Company
(1979).
[GS]
H.
Gillet
and
C.
SouleÌ,
On
the
number
of
lattice
points
in
convex
symmetric
bodies
and
their
duals,
Israel
Journal
of
Math.
74,
pp.
347-357
(1991).
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deï¬ning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
3
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
RIMS
Preprint
1033
(September
1995);
Publ.
of
RIMS
32,
No.
6
(1996),
pp.
957-1151.
[Mzk2]
S.
Mochizuki,
Foundations
of
p-adic
TeichmuÌˆller
Theory,
AMS/IP
Studies
in
Advanced
Mathematics
11,
American
Mathematical
Society/International
Press
(1999).
[Szp]
L.
Szpiro,
DegreÌs,
intersections,
hauteurs
in
AsteÌrisque
127
(1985),
pp.
11-28.
[Wells]
R.
O.
Wells,
Diï¬€erential
Analysis
on
Complex
Manifolds,
Graduate
Texts
in
Mathematics
65,
Springer
(1980).
47
Chapter
II:
The
Galois
Action
on
Torsion
Points
Â§0.
Introduction
In
some
sense,
the
main
goal
of
the
present
paper
is
to
prove
a
comparison
theorem
that
relates
the
natural
Arakelov-theoretic
torsors
arising
from
an
elliptic
curve
(cf.
Chapter
I,
especially,
Chapter
I,
Â§4)
to
the
Galois
action
on
the
torsion
points
of
the
elliptic
curve.
In
Chapter
I,
we
introduced
the
â€œtorsor
sideâ€
of
this
comparison;
thus,
in
the
present
Chapter,
we
wish
to
discuss
the
â€œtorsion
point
sideâ€
of
the
comparison.
More
precisely,
in
this
Chapter,
we
show
that,
in
certain
situations,
the
Galois
action
on
the
torsion
points
of
an
elliptic
curve
is
as
transitive
as
possible,
i.e.,
that
(cf.
Theorem
4.4):
If
we
consider
all
elliptic
curves
over
number
ï¬elds
of
bounded
degree
which
have
semi-stable
reduction
everywhere
and
at
least
one
prime
of
bad
reduction,
then
for
any
prime
number
l
of
the
order
of
the
height
hE
of
the
elliptic
curve,
the
image
of
the
associated
Galois
representation
in
GL2
(Zl
)
contains
SL2
(Zl
).
In
particular,
the
elliptic
curve
will
not
have
any
rational
torsion
points
of
order
l.
Thus,
this
result
may
be
regarded
as
a
sort
of
â€œpoor
manâ€™s
uniform
boundedness
conjectureâ€
(now
Merelâ€™s
theorem
([Mer])
â€“
although,
in
fact,
it
is
not
strictly
implied
by
Merelâ€™s
theorem).
Alternatively,
it
may
regarded
as
an
eï¬€ective
version
of
a
theorem
of
Serre
([Ser],
Chapter
IV,
Theorem
3.2).
The
proof
is
similar
to
that
of
Faltingsâ€™
proof
of
the
Tate
Conjecture
([Falt]),
only
technically
much
simpler.
That
is
to
say,
the
main
technique
is
essentially
the
standard
one
(going
back
to
Tate)
for
proving
â€œTate
conjecture-type
results.â€
Â§1.
Some
Elementary
Group
Theory
Let
l
â‰¥
5
be
a
prime
number.
In
this
Â§,
we
review
some
well-known
results
concerning
the
group
theory
of
SL2
(Zl
).
def
1
1
0
1
,
Lemma
1.1.
Let
G
âŠ†
SL2
(Fl
)
be
the
subgroup
generated
by
the
matrices
Î±
=
def
1
0
Î²
=
1
1
.
Then
G
=
SL2
(Fl
).
Note
that
if
Î¼,
Î»
âˆˆ
Fl
,
then
Î²
Î¼
Â·
Î±Î»
(where
this
expression
makes
sense
since

Î»

def


both
Î±l
and
Î²
l
are
equal
to
the
identity
matrix)
takes
the
vector
v
=
01
to
Î¼Â·Î»+1
.
In
Proof.
48

def

particular,
if
we
let
Î³
=
01
10
,
then
for
any
Î»
âˆˆ
FÃ—
l
,
we
have
Î³
Â·
v,
Î»
Â·
Î³
Â·
v
âˆˆG
Â·
v.
We
thus
obtain
that
Î»
Â·
v
âˆˆ
G
Â·
v.
Thus,
in
summary,
we
have
proven
that
F2l
âˆ’
{
00
}
âŠ†
G
Â·
v.
Now
let
us
prove
that
an
arbitrary
element
Î´
âˆˆ
SL2
(Fl
)
is
contained
in
G.
By
the
conclusion
of
the
preceding
paragraph,
we
may
assume
that
Î´
Â·
v
=
v.
But
this
implies
that
Î´
is
an
upper
triangular
matrix
all
of
whose
diagonal
entries
are
â€œ1.â€
Thus,
Î´
is
a
power
of
Î±,
hence
contained
in
G,
as
desired.

Corollary
1.2.
The
ï¬nite
group
SL2
(Fl
)
is
simple.
2
Proof.
Let
Î»
âˆˆ
FÃ—
l
be
such
that
Î»
=
1.
(Note
that
such
Î»
exists
since
l
â‰¥
5.)
Let
2
def
Î»
0

=
0
Î»âˆ’1
.
Then
Â·
Î±
Â·
âˆ’1
Â·
Î±âˆ’1
=
Î±Î»
âˆ’1
.
Thus,
Î±
(and,
similarly,
Î²)
is
contained
in
the
commutator
subgroup
of
SL2
(Fl
),
so
Corollary
1.2
follows
from
Lemma
1.1.

def
1
1
0
1
,
as
Lemma
1.3.
Let
G
âŠ†
GL2
(Fl
)
be
a
subgroup
that
contains
the
matrix
Î±
=
well
as
at
least
one
matrix
that
is
not
upper
triangular.
Then
SL2
(Fl
)
âŠ†
G.
Proof.
Note
that
Î±
generates
an
l-Sylow
subgroup
S
of
GL2
(Fl
),
and
that
the
number
of
l-Sylow
subgroups
of
GL2
(Fl
)
is
precisely
l
+
1.
Since
the
normalizer
of
S
in
GL2
(Fl
)
is
the
set
of
upper
triangular
matrices,
and
we
have
assumed
that
G
contains
at
least
one
such
matrix,
it
follows
that
the
number
nG
of
l-Sylow
subgroups
of
G
is
â‰¥
2.
On
the
other
hand,
by
the
general
theory
of
Sylow
subgroups,
it
follows
that
nG
is
congruent
to
1
modulo
l.
Since
2
â‰¤
nG
â‰¤
l
+
1,
we
thus
obtain
that
nG
=
l
+
1.
In
particular,
in
the
notation
of
Lemma
1.1,
we
conclude
that
Î±,
Î²
âˆˆ
G.
Thus,
by
Lemma
1.1,
we
have
SL2
(Fl
)
âŠ†
G,
as
desired.

Let
l
be
a
prime
number
â‰¥
5.
Let
G
âŠ†
GL2
(Zl
)
be
a
closed
subgroup

def

whose
image
H
in
GL2
(Fl
)
contains
the
matrix
Î±
=
10
11
,
as
well
as
a
matrix
which
is
not
upper
triangular.
Then
SL2
(Zl
)
âŠ†
G.
Corollary
1.4.
Proof.
By
Lemma
1.3,
we
have
that
SL2
(Fl
)
âŠ†
H.
Let
G
âŠ†
SL2
(Zl
)
be
the
commutator
subgroup
of
G.
Thus,
by
Corollary
1.2,
G
surjects
onto
SL2
(Fl
).
Now
by
[Ser],
Chapter
IV,
Â§3.4,
Lemma
3,
this
implies
that
SL2
(Zl
)
=
G
âŠ†
G,
as
desired.

Â§2.
The
Height
of
an
Elliptic
Curve
Let
K
be
a
number
ï¬eld,
of
degree
d
over
Q.
Let
E
â†’
Spec(OK
)
be
a
semi-abelian
variety
of
dimension
1
whose
generic
ï¬ber
EK
is
proper.
Thus,
EK
is
an
elliptic
curve
over
K.
Let
us
write
49
Ï‰E
for
the
ï¬nite,
ï¬‚at
OK
-module
of
rank
one
consisting
of
the
invariant
diï¬€erentials
on
E.
def
If
Ïƒ
:
K
â†’
C
is
a
complex
embedding,
then
we
get
a
natural
metric
on
(Ï‰E
)Ïƒ
=
(Ï‰E
)
âŠ—K,Ïƒ
C
by
integration:
if
Î±
âˆˆ
(Ï‰E
)Ïƒ
,
then
def
|Î±|2
=
Î±âˆ§Î±
EÏƒ
def
(where
EÏƒ
=
E
âŠ—K,Ïƒ
C,
and
Î±
is
the
complex
conjugate
of
Î±).
Thus,
by
equipping
Ï‰E
which
this
metric
at
the
archimedean
places
of
K,
we
obtain
an
arithmetic
line
bundle
Ï‰
E
(cf.
Chapter
I,
Deï¬nition
1.1).
Let
us
write
def
hE
=
deg(Ï‰
E
)
âˆˆ
R
This
number
is
often
referred
to
as
the
Faltings
height
of
the
elliptic
curve
E.
Next,
let
us
observe
that
E
â†’
Spec(OK
)
deï¬nes
a
classifying
morphism
Ï†
:
Spec(OK
)
â†’
M1,0
where
M1,0
is
the
moduli
stack
of
semi-abelian
varieties
of
dimension
one
over
Z.
As
is
well-known,
this
stack
has
a
â€œdivisor
at
inï¬nityâ€
âˆM
âŠ†
M1,0
,
whose
complement
M1,0
âŠ†
M1,0
is
the
moduli
stack
of
elliptic
curves
over
Z.
Thus,
we
may
consider
the
divisor
âˆE
=
Ï†âˆ’1
(âˆM
)
âŠ†
Spec(OK
)
def
Moreover,
we
let
def
deg(âˆE
)
=
log(#(OâˆE
))
âˆˆ
R
Now
we
have
the
following
well-known
result:
Proposition
2.1.
There
exists
a
universal
constant
C
(independent
of
K,
d,
and
E)
1
such
that:
12
Â·
deg(âˆE
)
â‰¤
hE
+
d
Â·
C.
Proof.
This
follows
immediately
from
the
formula
of
Proposition
1.1
of
[Silv2],
together
with
the
fact
that
the
archimedean
term
on
the
right-hand
side
of
this
formula
is
universally
bounded
below
by
d
Â·
C,
where
C
is
a
universal
constant
independent
of
K,
d,
and
E.

50
Proposition
2.2.
Let
Î±
âˆˆ
R.
Then
the
number
of
isomorphism
classes
of
elliptic
curves
EK
over
number
ï¬elds
K
of
degree
â‰¤
d
such
that
hE
â‰¤
Î±
is
ï¬nite.
Proof.
This
follows
from
[Silv1],
Proposition
8.2
and
[Silv2],
Proposition
1.1.

Â§3.
The
Galois
Action
on
the
Torsion
of
a
Tate
Curve
Let
K
be
a
ï¬nite
extension
of
Qp
,
where
p
is
a
prime
number.
Let
us
denote
its
residue
ï¬eld
by
k;
the
maximal
ideal
of
its
ring
of
integers
by
mK
;
and
its
associated
valuation
map
by
vK
:
K
Ã—
â†’
Z
(normalized
so
that
vK
is
surjective).
Also,
let
us
write
K
for
def
an
algebraic
closure
of
K,
and
Î“K
=
Gal(K/K).
Let
E
â†’
Spec(OK
)
be
a
semi-abelian
scheme
of
dimension
one
over
OK
.
Let
us
assume,
moreover,
that
the
generic
ï¬ber
EK
of
E
is
proper,
while
the
special
ï¬ber
Ek
of
E
is
equal
to
(Gm
)k
,
the
multiplicative
group
over
k.
Let
l
be
a
prime
number
(possibly
equal
to
p).
Let
us
write
def
Ml
(E)
=
Hom(Z/l
Â·
Z,
E(K))
for
the
â€œmod
lâ€
Tate
module
of
EK
.
Thus,
Ml
(E)
is
(noncanonically)
isomorphic
as
an
Fl
-module
to
F2l
,
and
is,
moreover,
equipped
with
a
continuous
action
by
Î“K
(induced
by
the
natural
action
of
Î“K
on
K).
Also,
it
is
well-known
(see,
e.g.,
[FC],
Chapter
III,
Corollary
7.3)
that
Ml
(E)
ï¬ts
into
a
natural
exact
sequence
of
Î“K
-modules
0
â†’
Fl
(1)
â†’
Ml
(E)
â†’
Fl
â†’
0
where
the
â€œ(1)â€
is
a
Tate
twist,
and
â€œFl
â€
is
equipped
with
the
trivial
Galois
action.
Moreover,
the
extension
class
associated
to
this
exact
sequence
is
precisely
that
obtained
by
extracting
an
lth
root
of
the
Tate
parameter
qE
âˆˆ
mK
.
The
Tate
parameter
is
an
element
of
mK
that
is
naturally
associated
to
E
and
has
the
property
that
the
subscheme
OK
/(qE
)
is
equal
to
the
pull-back
via
the
classifying
morphism
Spec(OK
)
â†’
M1,0
of
the
divisor
âˆM
âŠ†
M1,0
.
Thus,
the
above
exact
sequence
splits
if
and
only
if
qE
has
an
lth
root
in
K.
Note
that
in
order
for
this
to
happen,
it
must
be
the
case
that
vK
(qE
)
is
divisible
by
l.
In
particular,
we
have
the
following
result:
Lemma
3.1.
Suppose
that
N
âŠ†
Ml
(E)
is
a
one-dimensional
Fl
-subspace
which
is
stabilized
by
Î“K
.
Then
either
vK
(qE
)
âˆˆ
l
Â·
Z,
or
N
is
equal
to
the
subspace
Fl
(1)
âŠ†
Ml
(E)
of
the
above
exact
sequence.
Deï¬nition
3.2.
We
shall
refer
to
vK
(qE
)
âˆˆ
Z>0
as
the
local
height
of
E.
51
Next,
let
us
recall
that
the
submodule
Fl
(1)
âŠ†
Ml
(E)
deï¬nes
a
ï¬nite,
ï¬‚at
subgroup
scheme
Î¼l
âŠ†
E
over
OK
.
Thus,
we
may
form
the
quotient
def
E
=
E/Î¼l
Then
E
â†’
Spec(OK
)
is
a
one-dimensional
semi-abelian
scheme
over
OK
whose
special
ï¬ber
is
(Gm
)k
and
whose
generic
ï¬ber
is
proper.
Moreover,
its
Tate
parameter
qE

satisï¬es
l
qE

=
qE
Let
us
write
def
deg(âˆE
)
=
log(#(OK
/(qE
)))
âˆˆ
R
Then
we
have
deg(âˆE

)
=
l
Â·
deg(âˆE
)
Â§4.
An
Eï¬€ective
Estimate
of
the
Image
of
Galois
Let
us
write
Q
for
an
algebraic
closure
of
Q.
Let
K
be
a
subï¬eld
of
Q
of
degree
d
<
âˆ
over
Q,
and
let
E
â†’
Spec(OK
)
be
as
in
Â§2.
Let
l
be
a
prime
number.
Suppose
that
we
are
given
a
subgroup
scheme
GK
âŠ†
EK
(over
K)
such
that
over
Q,
GK
becomes
isomorphic
to
Z/l
Â·
Z.
We
shall
call
such
GK
lcyclic.
Write
(EG
)K
for
the
quotient
of
EK
by
GK
.
Note
that
since
(EG
)K
is
isogenous
to
EK
,
it
has
semi-stable
reduction
at
all
the
primes
of
K,
hence
extends
to
a
one-dimensional
semi-abelian
scheme
EG
â†’
Spec(OK
).
Lemma
4.1.
Suppose
that
GK
âŠ†
EK
is
l-cyclic,
and
that
l
is
greater
than
the
local
heights
of
E
at
all
of
its
primes
of
bad
(multiplicative)
reduction.
Then
there
exists
a
universal
constant
C
(independent
of
K,
d,
and
E)
such
that
1
l
Â·
deg(âˆE
)
â‰¤
hE
+
d
Â·
C
+
2d
Â·
log(l)
12
52
Proof.
Note
that
the
assumption
on
l
implies
(by
Lemma
3.1)
that
at
all
the
primes
of
bad
reduction,
GK
corresponds
to
the
subspace
Fl
(1)
of
Lemma
3.1.
Thus,
at
primes
of
bad
reduction,
EG
may
be
identiï¬ed
with
the
elliptic
curve
E
discussed
at
the
end
of
Â§3.
In
particular,
deg(âˆEG
)
=
l
Â·
deg(âˆE
)
On
the
other
hand,
the
degree
l
covering
morphism
(EG
)K
â†’
EK
extends
(cf.,
e.g.,
[FC],
Chapter
I,
Proposition
2.7)
to
a
morphism
EG
â†’
E.
Thus,
we
have
a
natural
inclusion
Ï‰E
âŠ†
Ï‰EG
whose
cokernel
is
annihilated
by
l.
Moreover,
since
integrating
a
(1,
1)-form
over
EÏƒ
diï¬€ers
from
integrating
over
(E/G)Ïƒ
by
a
factor
of
l,
it
follows
that
deg(Ï‰
EG
)
â‰¤
deg(Ï‰
E
)
+
2d
Â·
log(l)
Thus,
Lemma
4.1
follows
from
Proposition
2.1.

Lemma
4.2.
There
exists
a
universal
(positive)
constant
C
(independent
of
d)
such
that
for
each
positive
integer
d,
there
exists
a
ï¬nite
subset
Ed
âŠ†
M1,0
(Q)
with
the
following
property:
Suppose
that
there
exists
an
l-cyclic
GK
âŠ†
EK
,
where
[K
:
Q]
=
d;
EK
is
an
elliptic
curve
over
K
with
semi-stable
reduction
at
all
primes
and
at
least
one
prime
of
bad
reduction;
and
l
â‰¥
100
Â·
(hE
+
C
Â·
d2
).
Then
the
point
of
[EK
]
âˆˆ
M1,0
(Q)
deï¬ned
by
EK
belongs
to
Ed
.
Proof.
First,
observe
that
if
v
is
any
local
height
of
EK
,
then
deg(âˆE
)
â‰¥
v
Â·
log(2).
Thus,
Proposition
2.1
implies
that
by
choosing
C
appropriately,
we
may
assume
that
1
Â·
deg(âˆE
).
Thus,
we
obtain
that
hE
+
C
Â·
d2
â‰¥
hE
+
C
Â·
d
â‰¥
12
100
Â·
deg(âˆE
)
12
100
Â·
log(2)
)Â·v
â‰¥(
12
>v
lâ‰¥
which
shows
that
the
hypotheses
of
Lemma
4.1
are
satisï¬ed.
Thus,
we
conclude
(from
Lemma
4.1)
that
if
we
choose
C
so
that
l
â‰¥
48dÂ·log(l)
(cf.
Lemma
4.3
below)
then
log(2)
1
l
Â·
deg(âˆE
)
â‰¤
hE
+
d
Â·
C
+
2d
Â·
log(l)
12
l
Â·
log(2)
â‰¤
hE
+
d
Â·
C
+
24
53
for
some
universal
constant
C
.
Next,
observe
that
since
EK
has
at
least
one
prime
of
bad
reduction,
it
follows
that
log(2)
â‰¤
deg(âˆE
).
Thus,
substituting
into
the
above
inequality,
we
obtain
that
l
Â·
log(2)
â‰¤
hE
+
d
Â·
C
24
2
On
the
other
hand,
log(2)
â‰¥
100
,
and,
by
assumption,
l
â‰¥
100
Â·
hE
,
so
(substituting)
we
24
obtain
that
2hE
â‰¤
hE
+
d
Â·
C
,
i.e.,
hE
â‰¤
d
Â·
C
.
But
this
implies,
by
Proposition
2.2,
that
[EK
]
belongs
to
some
ï¬nite
exceptional
set
Ed
,
as
desired.

Lemma
4.3.
x
â‰¥
y
Â·
log(x).
Let
x
and
y
be
real
numbers
such
that
x,
y
â‰¥
2,
and
x
â‰¥
2y
2
.
Then
Proof.
First
observe
that
y
â‰¥
12
Â·
log(2)
+
log(y)
for
y
â‰¥
2.
Indeed,
this
is
true
for
y
=
1
(since
4
â‰¥
3
â‰¥
3
Â·
log(2)),
and
the
function
Ï†(y)
=
y
âˆ’
log(y)
has
derivative
1
âˆ’
y1
,
which
1
is
â‰¥
0
for
y
â‰¥
1.
Thus
when
x
=
2y
2
,
we
have
x
=
2y
2
â‰¥
2y
Â·
log(2
2
Â·
y)
=
y
Â·
log(x),
as
desired.
Moreover,
the
function
Ïˆ(x)
=
x
âˆ’
y
Â·
log(x)
has
derivative
1
âˆ’
xy
,
which
is
â‰¥
0
for
x
â‰¥
2y
2
â‰¥
2y
â‰¥
y
(since
y
â‰¥
1).
Thus,
Ïˆ(x)
is
increasing
for
x
â‰¥
2y
2
,
so
Ïˆ(x)
â‰¥
0
for
x
â‰¥
2y
2
,
as
desired.

Theorem
4.4.
There
exist:
(1)
a
universal
(positive)
constant
C
(independent
of
d);
and
(2)
for
each
positive
integer
d,
a
ï¬nite
subset
Ed
âŠ†
M1,0
(Q)
with
the
following
property:
Suppose
that
(i.)
K
âŠ†
Q
is
a
subï¬eld
of
degree
d
<
âˆ;
(ii.)
EK
is
an
elliptic
curve
over
K
with
semi-stable
reduction
at
all
primes
and
at
least
one
prime
of
bad
reduction;
(iii.)
the
isomorphism
class
[EK
]
âˆˆ
M1,0
(Q)
does
not
belong
to
Ed
;
(iv.)
l
is
a
prime
number
â‰¥
100
Â·
(hE
+
C
Â·
d2
).
Then
the
image
of
the
Galois
representation
Gal(Q/K)
â†’
GL2
(Zl
)
associated
to
EK
contains
SL2
(Zl
).
54
Proof.
As
we
saw
in
the
proof
of
Lemma
4.2,
in
the
situation
under
consideration,
the
local
height
of
EK
at
a
ï¬nite
prime
of
EK
of
bad
reduction
can
never
be
divisible
by
l.
Since,
by
hypothesis,
at
least
one
such
ï¬nite
prime
exists,
it
follows
that

the
image
of
Galois
in
GL2
(Fl
)
contains
the
element
â€œÎ±â€
(cf.
Corollary
1.4),
i.e.,
10
11
.
Moreover,
by
Lemma
4.2,
it
follows
that
the
image
of
Galois
in
GL2
(Fl
)
contains
at
least
one
matrix
which
is
not
upper
triangular.
Thus,
we
conclude
from
Corollary
1.4
that
the
image
of
Galois
in
GL2
(Zl
)
contains
SL2
(Zl
),
as
desired.

Bibliography
[Falt]
G.
Faltings,
EndlichkeitssaÌˆtze
fuÌˆr
abelsche
VarietaÌˆten
uÌˆber
ZahlkoÌˆrpern,
Invent.
Math.
73,
pp.
349-366
(1983).
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer
(1990).
[Mer]
L.
Merel,
Bornes
pour
la
torsion
des
courbes
elliptiques
sur
les
corps
de
nombres,
Invent.
Math.
124,
pp.
437-449
(1996).
[Ser]
J.-P.
Serre,
Abelian
l-adic
Representations
and
Elliptic
Curves,
Benjamin
(1968).
[Silv1]
J.H.
Silverman,
The
Theory
of
Height
Functions
in
Arithmetic
Geometry,
ed.
by
G.
Cornell
and
J.H.
Silverman,
Springer
(1986).
[Silv2]
J.H.
Silverman,
Heights
and
Elliptic
Curves
in
Arithmetic
Geometry,
ed.
by
G.
Cornell
and
J.H.
Silverman,
Springer
(1986).
55
Chapter
III:
The
Universal
Extension
of
a
Log
Elliptic
Curve
Â§0.
Introduction
In
this
Chapter,
we
review
various
well-known
facts
concerning
the
universal
extension
of
an
elliptic
curve.
The
main
ideas
that
we
discuss
are
as
follows:
Given
a
log
elliptic
curve
(cf.
Deï¬nition
1.1)
E
â†’
S,
we
deï¬ne
its
universal
extension
E
â€ 
â†’
E
(cf.
Deï¬nition
1.2)
as
a
certain
group
scheme
of
line
bundles
on
E
of
degree
0
equipped
with
a
connection.
For
degenerating
log
elliptic
curves
(i.e.,
â€œTate
curvesâ€),
this
universal
extension
admits
a
canonical
splitting
(cf.
Theorem
2.1)
which
is
essentially
uniquely
characterized
by
the
fact
that
it
is
a
group
homomorphism.
The
universal
extension
E
â€ 
â†’
E
also
has
a
Hodgetheoretic
interpretation
(cf.
Theorem
4.2)
as
the
Hodge-theoretic
ï¬rst
Chern
class
of
the
divisor
deï¬ned
by
the
origin
of
E.
Moreover,
this
Hodge-theoretic
interpretation
of
the
universal
extension
allows
one
to
analytically
continue
(cf.
Theorem
5.6)
the
canonical
splitting,
relative
to
the
function-theoretic
context
of
[Mumf].
We
construct
this
analytic
continuation
by
studying
the
Schottky-Weierstrass
Î¶-function
(cf.
Â§5),
which
is
a
certain
analogue
of
the
classical
Weierstrass
Î¶-function,
but
for
the
Schottky
uniformization
(as
opposed
to
the
full
uniformization
by
the
complex
plane,
as
in
the
classical
case)
of
an
elliptic
curve.
This
analytic
continuation
allows
one
to
give
explicit
coordinates
for
the
torsion
points
of
the
universal
extension
(cf.
Corollary
5.9),
which
play
a
fundamental
role
in
this
paper.
During
our
analysis
of
the
universal
extension,
we
pause,
in
Â§3
(cf.
also
Remark
2
in
Â§6),
to
review
the
complex
analogues
of
the
ideas
discussed
in
this
Chapter.
Finally,
in
Â§6,
7,
we
discuss
certain
â€œhigherâ€
analogues
of
the
Schottky-Weierstrass
Î¶function.
Â§1.
Deï¬nition
of
the
Universal
Extension
In
this
Â§,
we
would
like
to
deï¬ne
a
certain
canonical
extension
of
a
â€œlog
elliptic
curveâ€
â€“
called
the
universal
extension
of
the
log
elliptic
curve
â€“
which
will
play
a
key
role
in
the
present
paper.
One
useful
reference
for
this
universal
extension
(in
the
non-logarithmic
case)
is
Appendix
C
of
[Katz].
Let
M1,1
56
be
the
moduli
stack
of
one-pointed
stable
curves
of
genus
one
over
Z
(see,
e.g.,
[Knud]
for
more
details).
Note
that
M1,1
is
equipped
with
a
natural
log
structure
(in
the
sense
of
log
[Kato])
deï¬ned
by
its
divisor
at
inï¬nity.
We
denote
the
resulting
log
stack
by
M1,1
.
Let
(C
â†’
M1,1
,
:
M1,1
â†’
C)
denote
the
tautological
one-pointed
stable
curve
of
genus
one.
Now
observe
that
the
inverse
image
on
C
of
the
divisor
at
inï¬nity
of
M1,1
is
a
divisor
with
normal
crossings
on
C,
hence
deï¬nes
in
a
natural
way
a
log
structure
on
C.
Denote
the
resulting
log
stack
by
C
log
.
Let
log
def
log
M1,0
=
M1,1
.
Thus,
we
have
a
natural
log
smooth
morphism
log
C
log
â†’
M1,0
together
with
a
section
:
M1,0
â†’
C.
Let
E
âŠ†
C
be
the
open
substack
of
C
of
points
that
are
smooth
over
M1,0
.
Since
maps
into
E,
we
have
(by
abuse
of
notation)
a
section
:
M1,0
â†’
E.
Moreover,
(E
â†’
M1,0
,
:
M1,0
â†’
E)
forms
a
semi-abelian
scheme
(see,
e.g.,
[FC],
Deï¬nition
2.3
of
Chapter
I,
for
more
details)
of
dimension
1
over
M1,0
.
log
Deï¬nition
1.1.
We
shall
refer
to
(C
log
â†’
M1,0
,
:
M1,0
â†’
E)
as
the
universal
log
elliptic
curve.
If
S
log
is
a
ï¬ne
noetherian
log
scheme
(see
[Kato]
for
more
details),
then
we
log
shall
refer
to
the
datum
of
a
morphism
Î±
:
S
log
â†’
M1,0
as
a
log
elliptic
curve.
This
deï¬nition
prompts
the
following
basic
remarks:
log
log
(1)
The
point
of
distinguishing
M1,0
from
M1,1
(even
though
both
notations
denote
the
same
log
stack)
is
that
the
natural
log
structures
of
the
tautological
objects
that
they
parametrize
diï¬€er.
This
leads
for
instance
to
diï¬€erent
canonical
p-adic
uniformization
theories
(as
in
[Mzk1]).
log
(2)
Let
Î±
:
S
log
â†’
M1,0
be
a
log
elliptic
curve.
Then
pulling
back
C
log
â†’
log
M1,0
,
E,
and
gives
rise
to
C
log
â†’
S
log
,
E
â†’
S,
e
:
E
â†’
S.
Often,
by
abuse
of
terminology,
we
shall
say
â€œlet
C
log
â†’
S
log
be
a
log
elliptic
curve.â€
This
means
that
implicitly
we
assume
that
some
Î±
has
been
given
and
that
C
log
has
been
constructed
from
Î±
in
the
fashion
just
described.
This
completes
the
discussion
of
the
deï¬nition
of
a
log
elliptic
curve.
57
Let
f
log
:
C
log
â†’
S
log
be
a
log
elliptic
curve.
Let
Ï‰E
=
eâˆ—
Î©E/S
def
Thus,
Ï‰E
is
a
line
bundle
on
S.
Let
W
â†’
S
denote
the
aï¬ƒne
group
scheme
deï¬ned
by
def
âˆ¨
(the
dual
bundle
to
Ï‰E
.
Thus,
W
is
the
spectrum
of
the
symmetric
algebra
of
Ï„E
=
Ï‰E
Ï‰E
)
over
OS
.
Now
we
would
like
to
deï¬ne
a
natural
extension
of
group
schemes
0
â†’
W
â†’
Eâ€ 
â†’
E
â†’
0
(cf.
Appendix
C,
Â§C1,
of
[Katz]),
as
follows.
First,
let
T
be
an
S-scheme.
Since
E
â€ 
will
be
deï¬ned
as
a
functor
over
E,
points
of
E
â€ 
(T
)
will
consist
of
points
of
E(T
)
plus
some
extra
information:
We
deï¬ne
E
â€ 
(T
)
to
be
the
set
of
isomorphism
classes
of
pairs
(x,
âˆ‡x
),
where
x
âˆˆ
E(T
),
and
âˆ‡x
is
a
logarithmic
connection
(with
respect
to
def
the
morphism
C
log
â†’
S
log
)
on
the
line
bundle
Lx
=
OCT
(x
âˆ’
e)
(where
CT
=
C
Ã—S
T
).
(Here
in
the
notation
â€œOCT
(x
âˆ’
e),â€
we
use
â€œeâ€
(respectively,
â€œxâ€)
to
denote
the
(Cartier)
divisor
deï¬ned
by
the
image
of
the
section
e
(respectively,
x)
in
CT
.)
It
is
immediately
clear
that
E
â€ 
is
a
torsor
over
E
under
the
group
scheme
W
(since
Ï‰E
may
be
identiï¬ed
with
the
push-forward
of
Î©C
log
/S
log
via
f
log
:
C
log
â†’
S
log
).
Moreover,
E
â€ 
has
a
natural
abelian
group
law
of
its
own
given
as
follows:
The
sum
of
(x,
âˆ‡x
)
and
(y,
âˆ‡y
)
is
the
line
bundle
Lx+y
âˆ¼
=
Lx
âŠ—OCT
Ly
equipped
with
the
connection
âˆ‡x
âŠ—
âˆ‡y
.
Deï¬nition
1.2.
We
shall
refer
to
the
exact
sequence
0
â†’
W
â†’
Eâ€ 
â†’
E
â†’
0
of
smooth,
abelian
group
schemes
over
S
as
the
universal
extension
of
E
â†’
S
(or
C
log
â†’
S
log
).
Let
def
log
OC
H
=
R1
fDR,âˆ—
58
be
the
ï¬rst
(logarithmic)
de
Rham
cohomology
module
of
f
log
:
C
log
â†’
S
log
(see,
e.g.,
[Kato]).
Then
H
is
a
rank
two
vector
bundle
on
S
equipped
with
a
ï¬ltration
called
the
Hodge
ï¬ltration.
This
ï¬ltration
gives
rise
to
an
exact
sequence
0
â†’
Ï‰E
â†’
H
â†’
Ï„E
â†’
0
Proposition
1.3.
There
is
a
canonical
isomorphism
between
H
and
the
tangent
space
to
the
group
scheme
E
â€ 
at
the
origin.
Moreover,
the
exact
sequence
above
arising
from
the
Hodge
ï¬ltration
on
H
corresponds
under
this
isomorphism
to
the
ï¬ltration
induced
on
the
tangent
space
at
the
origin
to
E
â€ 
by
the
exact
sequence
0
â†’
W
â†’
E
â€ 
â†’
E
â†’
0.
Proof.
This
follows
immediately
by
working
over
the
dual
numbers
S[Îµ]/(Îµ2
)
and
thinking
about
the
functorial
deï¬nitions
of
E
â€ 
and
de
Rham
cohomology.

Â§2.
Canonical
Splitting
at
Inï¬nity
We
maintain
the
notations
of
Â§1.
In
this
Â§,
we
would
like
to
discuss
certain
canonical
splittings
of
the
universal
extension
E
â€ 
â†’
E
of
E.
In
this
Â§,
we
assume
that
the
inverse
image
(via
the
implicit
classifying
morphism
log
Î±
:
S
log
â†’
M1,0
for
the
given
log
elliptic
curve)
of
the
divisor
at
inï¬nity
of
M1,0
is
a
(Cartier)
divisor
D
âŠ†
S.
Write
J
for
the
ideal
deï¬ning
D.
Thus,
J
is
a
line
bundle
on
S.
Moreover,
we
have
a
natural
identiï¬cation:
E|D
=
(Gm
)D
Now
let
S
be
the
completion
of
S
at
D.
Thus,
S
is
a
formal
scheme.
Let
us
write
ES
for
the
formal
object
obtained
by
pulling
back
E
â†’
S
to
S.
Then
one
knows
that
ES
âˆ¼
=
(Gm
)S
(where
the
isomorphism
is
an
isomorphism
of
J
-adic
formal
group
objects
over
the
formal
scheme
S).
Indeed,
this
is
a
relative
simple
special
case
(the
case
already
known
to
Tate)
of
the
theory
of
[FC],
Chapter
III.
In
fact,
this
isomorphism
is
the
unique
such
isomorphism
that
reduces
to
the
identity
over
D
(by
[FC],
Chapter
I,
Theorem
2.2).
Now
let
us
pull-back
the
universal
extension
E
â€ 
â†’
E
to
a
morphism
â€ 
E
â†’
ES
S
59
over
S.
We
would
like
to
construct
a
certain
canonical
section
of
this
morphism.
This
canonical
section
will
be
a
homomorphism
of
group
objects.
Thus,
by
[FC],
Chapter
I,
Theorem
2.2,
it
will
exist
and
be
unique
once
it
is
constructed
over
D.
The
deï¬nition
of
this
canonical
section
over
D
is
given
as
follows:
As
discussed
above,
we
identify
ED
with
(Gm
)D
.
Let
us
think
of
the
aï¬ƒne
ring
of
(Gm
)D
as
the
ring
of
Laurent
polynomials
in
an
indeterminate
u.
Now
let
x
be
a
D-valued
point
of
(Gm
)D
.
Then
(as
in
Appendix
C,
Â§C1,
of
[Katz])
points
of
E
â€ 
lying
over
x
may
be
identiï¬ed
with
sections
of
Ï‰C
log
/S
log
âŠ—OS
OD
that
are
regular
away
from
x
and
e,
but
have
a
simple
pole
with
residue
1
(respectively,
âˆ’1)
at
x
(respectively,
e).
For
instance,
if
x
corresponds
to
the
section
ux
Ã—
of
OD
,
then
def
Ï‰x
=
du
du
âˆ’
(u
âˆ’
ux
)
(u
âˆ’
1)
is
such
a
diï¬€erential.
Since
the
correspondence
x
â†’
Ï‰x
is
clearly
functorial,
we
thus
obtain
a
scheme-theoretic
section
â€ 
ED
â†’
ED
It
remains
to
check
that
this
is
a
homomorphism
of
group
schemes.
To
see
this,
suppose
def
that
y
âˆˆ
E(D),
z
=
x
Â·
y.
Then
the
isomorphism
between
OCD
(x
âˆ’
e)
âŠ—
OCD
(y
âˆ’
e)
and
OCD
(z
âˆ’
e)
is
given
by
division
by
the
rational
function
(u
âˆ’
1)(u
âˆ’
uz
)
(u
âˆ’
ux
)(u
âˆ’
uy
)
Moreover,
the
logarithmic
derivative
of
this
rational
function
is
clearly
equal
to
Ï‰z
âˆ’Ï‰x
âˆ’Ï‰y
.
This
observation
implies
that
the
section
constructed
is
a
homomorphism
of
group
schemes,
as
desired.
Thus,
in
summary,
we
see
that
we
have
constructed
a
homomorphism
of
group
objects
Îº
:
ES
â†’
E
â€ 
S
â€ 
in
the
formal
category
over
S
which
forms
a
section
of
E
â†’
ES
.
Moreover,
since
there
S
are
no
nontrivial
homomorphisms
from
Gm
into
W
(note:
W
is
Zariski
locally
isomorphic
to
Ga
),
it
follows
that
Îº
is
the
unique
such
section.
We
state
this
as
a
theorem:
Theorem
2.1.
The
extension
â€ 
0
â†’
WS
â†’
ES
â†’
E
â†’
0
S
60
of
group
objects
over
the
formal
scheme
S
admits
a
unique
splitting
Îº
:
ES
â†’
E
â€ 
S
â€“
which
we
shall
refer
to
as
the
canonical
splitting
of
this
extension.
In
particular,
it
follows
that
there
exists
a
natural
isomorphism
â€ 
E
âˆ¼
=
(Gm
)S
Ã—
WS
S
of
group
objects
over
S.
Now
recall
that
E
â€ 
may
be
thought
of
as
an
Ï‰E
-torsor
over
E.
Thus,
in
particular,
we
may
write
this
torsor
as
an
extension
of
coherent
OE
-modules
0
â†’
OE
â†’
T
â†’
Ï„E
|E
â†’
0
Let
R
â€ 
be
the
sheaf
of
quasi-coherent
OE
-algebras
whose
spectrum
is
E
â€ 
:
E
E
â€ 
=
Spec(R
â€ 
)
E
Thus,
Zariski
locally
on
E,
R
â€ 
is
the
symmetric
algebra
over
OE
of
Ï„E
|E
.
Moreover,
E
there
is
a
natural
inclusion
T
âŠ†R
â€ 
E
and
T
generates
R
â€ 
as
an
OE
-algebra.
If
i
is
a
positive
integer,
let
us
denote
by
E
R
â€ 
[i]
âŠ†
R
â€ 
E
E
the
OE
-submodule
of
R
â€ 
generated
by
OE
-linear
combinations
of
products
of
i
sections
E
def
of
T
.
(Also,
let
R
â€ 
[0]
=
OE
.)
E
Deï¬nition
2.2.
We
shall
refer
to
sections
of
O
â€ 
that
lie
inside
R
â€ 
[i]
as
being
of
E
E
torsorial
degree
â‰¤
i.
More
generally,
if
L
is
a
line
bundle
on
E,
then
we
shall
refer
to
sections
of
L
âŠ—OE
O
â€ 
that
lie
inside
L
âŠ—OE
R
â€ 
[i]
as
being
of
torsorial
degree
â‰¤
i.
E
E
Now
by
Theorem
2.1,
we
have
a
natural
splitting
61
â€ 
E
âˆ¼
=
ES
Ã—
WS
S
This
natural
splitting
then
induces
an
isomorphism
(R
â€ 
)S
âˆ¼
=
OE
[Ï„E
|E
]
E
S
S
(where
â€œ[âˆ’]â€
means
â€œthe
symmetric
algebra
ofâ€).
That
is
to
say,
whereas
R
â€ 
is,
in
genE
eral,
only
Zariski
locally
isomorphic
to
a
polynomial
algebra,
over
S,
it
becomes
naturally
isomorphic
to
a
polynomial
algebra
(i.e.,
the
symmetric
algebra
of
Ï„E
|E
).
Thus,
if
f
is
a
S
section
of
L
âŠ—
O
â€ 
,
one
can
make
the
following
deï¬nition:
E
S
Deï¬nition
2.3.
We
shall
refer
to
the
degree
i
term
of
f
(relative
to
the
above
isomorphism
of
(R
â€ 
)S
with
a
polynomial
algebra)
as
the
degree
i
component
E
Compi
(f
)
âˆˆ
L
âŠ—OS
Ï„EâŠ—i
|E
S
of
f
.
Â§3.
Canonical
Splittings
in
the
Complex
Case
Before
proceeding,
we
pause
to
review
the
basic
theory
of
the
universal
extension
and
its
canonical
splittings
over
the
complex
numbers
(cf.,
e.g.,
[Katz],
Appendix
C).
Thus,
let
E
be
an
elliptic
curve
over
C.
Then
its
universal
extension
E
â€ 
may
be
constructed
analytically
as
follows:
First,
recall
the
de
Rham
isomorphism
1
1
(E,
OE
)
âˆ¼
(E,
C)
HDR
=
Hsing
between
the
de
Rham
cohomology
(algebraic
or
holomorphic)
of
E
and
the
singular
cohomology
of
E
with
complex
coeï¬ƒcients.
Let
def
1
Î›
âŠ†
H
=
HDR
(E,
OE
)
be
the
subgroup
deï¬ned
(using
the
de
Rham
isomorphism)
by
1
1
Hsing
(E,
2Ï€i
Â·
Z)
âŠ†
Hsing
(E,
C)
62
Thus,
Î›
is
a
free
Z-module
of
rank
2,
and
C
âŠ—Z
Î›
âˆ¼
=
H.
Now
by
Proposition
1.3
and
the
well-known
theory
of
the
(complex
analytic)
exponential
map
of
a
complex
Lie
group,
we
have
a
natural
uniformizing
map
H
â†’
Eâ€ 
compatible
with
the
additive
group
structures
of
H
and
E
â€ 
.
Moreover,
the
kernel
of
this
homomorphism
(cf.
the
discussion
at
the
end
of
[Katz],
Appendix
C,
Â§C5)
is
Î›âŠ†H
Thus,
we
have
the
following:
Proposition
3.1.
If
E
is
an
elliptic
curve
over
C,
then
(the
complex
Lie
group
deï¬ned
by)
E
â€ 
is
naturally
isomorphic
to
the
quotient
H/Î›
where
H
is
the
ï¬rst
de
Rham
cohomology
module
of
E,
and
Î›
is
the
Z-submodule
arising
from
the
singular
cohomology
of
E
with
coeï¬ƒcients
in
2Ï€i
Â·
Z.
Next,
we
would
like
to
discuss
certain
canonical
splittings
that
exist
in
the
complex
analytic
case.
In
fact,
in
the
complex
analytic
case,
there
are
three
diï¬€erent
types
of
canonical
splitting,
all
of
which
are
well-known
and
classical,
and
all
of
which
will
be
relevant
to
the
theory
of
the
present
paper
(but
in
diï¬€erent
ways).
The
three
canonical
splittings
that
we
will
consider
are
the
following:
The
Real
Analytic
Splitting:
Write
Î›R
(respectively,
Î›C
)
for
Î›
âŠ—Z
R
(respectively,
Î›
âŠ—Z
C).
Deï¬ne
ER
=
Î›R
/Î›
âŠ†
Î›C
/Î›
=
E
â€ 
def
Thus,
ER
is
a
real
analytic
submanifold
of
E
â€ 
.
Moreover,
it
is
easy
to
see
that
ER
maps
bijectively
onto
E,
i.e.,
we
have
an
isomorphism
of
real
analytic
Lie
groups
ER
âˆ¼
=E
Unlike
E,
however,
ER
is
only
a
â€œreal
analytic
torus,â€
not
a
complex
analytic
torus
inside
E
â€ 
.
Put
another
way,
ER
deï¬nes
a
real
analytic
section
63
ÎºR
:
E
â†’
E
â€ 
of
E
â€ 
â†’
E
which
is
a
homomorphism
in
the
category
of
real
analytic
Lie
groups.
Deï¬nition
3.2.
We
shall
refer
to
ÎºR
:
E
â†’
E
â€ 
as
the
canonical
real
analytic
section
of
E
â€ 
â†’
E.
Remark
1.
Note
in
particular
that
since
ÎºR
is
a
group
homomorphism,
it
maps
torsion
points
of
E
to
torsion
points
of
E
â€ 
.
Thus,
although
ÎºR
is
only
deï¬ned
in
the
real
analytic
category,
its
restriction
to
torsion
points
can
be
deï¬ned
entirely
algebraically.
For
instance,
if
E
is
deï¬ned
over
a
number
ï¬eld,
then
the
restriction
of
ÎºR
to
torsion
points
of
E
is
also
deï¬ned
over
a
number
ï¬eld.
This
fact
will
be
of
fundamental
importance
in
this
paper.
Remark
2.
Although
the
following
discussion
will
not
be
very
relevant
to
the
present
paper,
the
reader
might
wonder
(in
view
of
the
choice
of
notation)
whether
ÎºR
is,
in
some
sense,
â€œanalogousâ€
to
the
formal
analytic
Îº
of
Theorem
2.1.
In
fact,
there
is
an
analogy:
Namely,
ER
âŠ†
E
â€ 
may
be
obtained
as
the
invariant
subset
of
a
certain
natural
complex
conjugation
morphism
on
E
â€ 
.
Moreover,
frequently
in
discussions
of
global
motives,
it
is
natural
to
think
of
complex
conjugation
as
â€œFrobenius
at
the
inï¬nite
prime.â€
On
the
other
hand,
the
splitting
Îº
may
also
be
constructed
p-adically
as
follows:
E
â€ 
may
be
thought
of
as
a
certain
crystal
in
group
schemes
on
the
log
crystalline
site
of
S
log
.
Put
another
way,
E
â€ 
is,
in
essense,
the
log
crystalline
cohomology
of
C
log
â†’
S
log
with
coeï¬ƒcients
in
O
Ã—
.
Moreover,
as
a
log
crystalline
cohomology
object,
E
â€ 
is
equipped
with
a
natural
Frobenius
action.
The
section
Îº
may
then
be
constructed
p-adically
as
the
unique
Frobenius
invariant
section
of
E
â€ 
â†’
E.
That
is
to
say,
both
Îº
and
ÎºR
may
be
constructed
as
invariant
subsets
of
Frobenius
actions
at
ï¬nite
and
inï¬nite
primes,
respectively.
We
refer
to
the
discussion
of
[Mzk2],
Introduction,
Â§1,
for
more
details.
The
Gm
-Splitting:
To
deï¬ne
this
splitting,
ï¬x
a
rank
one
Z-submodule:
Î›1
âŠ†
Î›
This
splitting
deï¬nes
an
intermediate
covering
of
the
covering
deï¬ned
by
the
exponential
map
of
E:
Ï„E
â†’
Ï„E
/Î›1
â†’
Ï„E
/Î›
=
E
(where
by
abuse
of
notation,
we
also
denote
by
Î›
the
image
of
Î›
âŠ†
H
under
the
projection
H
â†’
Ï„E
arising
from
the
Hodge
ï¬ltration).
Note
that
Ï„E
/Î›1
is
isomorphic
(by
an
isomorphism
which
is
unique
up
to
composition
with
the
inversion
map)
to
Gm
(i.e.,
the
64
multiplicative
group
Gm
over
C,
regarded
as
a
complex
analytic
Lie
group).
Thus,
in
the
following
discussion,
we
shall
make
the
following
identiï¬cation:
Ï„E
/Î›1
=
Gm
In
other
words,
the
choice
of
Î›1
deï¬nes
a
uniformization
of
E
by
Gm
.
In
particular,
we
may
think
of
this
uniformization
as
giving
a
presentation
of
E
as
follows:
E
=
Gm
/q
Z
where
q
âˆˆ
Gm
=
CÃ—
.
This
uniformization
of
E
is
referred
to
as
the
Schottky
uniformization
of
E
(and
depends
on
the
choice
of
Î›1
âŠ†
Î›).
Now
let
us
consider
the
universal
extension
E
â€ 
of
E.
Now
we
have
a
commutative
diagram:
Î›1

=
def
(Î›1
)C
=
Î›1
âŠ—Z
C
Î›1

âŠ†
Î›C
=
H
=
Î›1

âˆ’â†’
Ï„E
If
we
form
the
quotient
of
the
second
line
by
the
ï¬rst,
we
then
obtain
two
morphisms
(Î›1
)C
/Î›1
âˆ’â†’
E
â€ 
|Gm
âˆ’â†’
Gm
whose
composite
is
an
isomorphism.
Put
another
way,
we
have
constructed
a
holomorphic
section
ÎºÎ›1
:
Gm
â†’
E
â€ 
|Gm
of
the
pull-back
of
E
â€ 
â†’
E
by
Gm
â†’
E.
Deï¬nition
3.3.
We
shall
refer
to
ÎºÎ›1
as
the
Gm
-splitting
associated
to
Î›1
.
Remark.
This
splitting
is
the
complex
analogue
of
the
splitting
of
Theorem
2.1.
Indeed,
it
is
not
diï¬ƒcult
to
check
that
if,
in
the
context
of
Theorem
2.1,
i.e.,
of
a
degenerating
1
elliptic
curve,
one
takes
for
Î›1
âŠ†
Hsing
(E,
2Ï€iZ)
=
H1sing
(E,
Z)âˆ¨
(where
â€œâˆ¨â€
denotes
the
dual
Z-module)
the
Z-submodule
which
is
the
annihilator
of
the
submodule
Ker{H1sing
(E,
Z)
â†’
H1sing
(the
degenerate
elliptic
curve,
Z)
=
Z}
65
i.e.,
the
annihilator
of
the
vanishing
cycle,
then
for
this
choice
of
Î›1
,
the
splitting
ÎºÎ›1
just
constructed
coincides
with
the
complex
analytic
splitting
of
the
universal
extension
deï¬ned
by
the
Îº
of
Theorem
2.1
in
a
(complex
analytic)
neighborhood
of
the
point
at
inï¬nity
âˆ
âˆˆ
M1,0
(C).
Indeed,
the
fact
that
these
two
splittings
coincide
follows
from
the
fact
that
there
do
not
exist
any
nontrivial
homomorphisms
of
complex
Lie
groups
CÃ—
â†’
C.
The
Î·-Splitting:
Here,
we
follow
the
treatment
of
[Katz],
Appendix
C,
Â§C5.
Fix
a
Clinear
isomorphism
C
âˆ¼
=
Ï‰E
.
This
isomorphism
makes
it
easier
to
describe
the
splitting
in
question.
In
fact,
however,
the
splitting
will
be
entirely
independent
of
the
choice
of
isomorphism
C
âˆ¼
=
Ï‰E
.
Once
this
isomorphism
is
ï¬xed,
we
get
a
choice
of
invariant
diï¬€erential
Ï‰
=
dz
(where
z
is
the
standard
coordinate
on
C),
and
so
we
can
write
E
=
C/Î›
(where
by
abuse
of
notation,
we
also
denote
by
Î›
the
image
of
Î›
âŠ†
H
under
the
projection
H
â†’
Ï„E
arising
from
the
Hodge
ï¬ltration).
Moreover,
one
has
the
Weierstrass
â„˜-function
(see,
e.g.,
[Ahlf],
p.
272,
for
a
treatment)
1
â„˜(z)
=
2
+
z

def
def
0=Î»âˆˆÎ›

1
1
âˆ’
2
2
(z
âˆ’
Î»)
Î»

def
Let
us
write
x
=
â„˜(z),
and
y
=
â„˜
(z)
(the
derivative
with
respect
to
z).
Then,
as
stated
in
[Katz],
Appendix
C,
Â§C5,
the
diï¬€erentials
Ï‰=
dx
y
def
and
Î·
=
Ï‰;
Î·(Î»)
=
x
dx
y
deï¬ne
by
integration
def
Ï‰(Î»)
=
def
Î»
Î·
Î»
(for
Î»
âˆˆ
Î›)
a
basis
of
F
=
HomZ
(Î›,
C)
=
Î›C
(where
we
use
the
fact
that
the
cup
pairing
on
cohomology
deï¬nes
a
natural
isomorphism
of
Î›
with
its
dual).
Thus,
in
particular,
we
can
write
Hâˆ¼
=
(C
Â·
Ï‰)
âŠ•
(C
Â·
Î·)
Moreover,
although
Ï‰
and
Î·
depend
on
the
choice
of
isomorphism
Ï‰E
âˆ¼
=
C,
this
decomposition
does
not.
Thus,
we
get
a
natural
splitting
ÎºÎ·
:
Ï„E
â†’
H
66
of
the
exact
sequence
0
â†’
Ï‰E
â†’
H
â†’
Ï„E
â†’
0
(cf.
the
discussion
preceding
Proposition
1.3).
Here,
we
shall
often
think
of
Ï„E
and
H
as
the
universal
covering
spaces
of
E
and
E
â€ 
,
respectively.
Deï¬nition
3.4.
We
shall
refer
to
ÎºÎ·
as
the
Î·-splitting
of
H
â†’
Ï„E
.
Remark.
The
relationship
of
this
splitting
with
the
theory
of
this
paper
is
as
follows:
In
[Katz],
Appendix
C,
Â§C2,
a
certain
natural
algebraic
rational
section
of
the
universal
extension
is
constructed.
This
section
will
be
discussed
from
the
point
of
view
of
the
present
paper
in
Â§4
below.
It
is
then
shown
in
[Katz],
Appendix
C,
Â§C6,
that
the
Weierstrass
Î¶function
may
be
thought
of
as
the
diï¬€erence
between
this
algebraic
rational
section
and
the
splitting
of
Deï¬nition
3.4.
On
the
other
hand,
in
the
present
paper,
we
will
consider
(cf.
Â§5
below)
the
diï¬€erence
between
this
algebraic
rational
section
and
the
splitting
of
Theorem
2.1.
This
diï¬€erence
will
play
an
important
role
in
the
theory
of
the
present
Chapter.
Moreover,
we
would
like
to
think
of
this
diï¬€erence
â€“
which
we
will
refer
to
as
the
Schottky-Weierstrass
Î¶-function
â€“
as
being
analogous
to
the
classical
Weierstrass
Î¶function.
In
fact,
we
shall
see
below
in
Â§5
that
many
of
the
important
properties
of
the
Schottky-Weierstrass
Î¶-function
are
proven
by
arguments
exactly
analogous
to
those
used
to
prove
the
basic
properties
of
the
classical
Weierstrass
Î¶-function.
The
reason
for
the
inclusion
of
the
word
â€œSchottkyâ€
here
is
that
this
â€œSchottky-Weierstrass
Î¶-functionâ€
is
a
sort
of
Weierstrass
Î¶-function
with
respect
to
the
Schottky
uniformization
Gm
â†’
E
of
E
(cf.
the
discussion
surrounding
Deï¬nition
3.3
above).
Â§4.
Hodge-Theoretic
Interpretation
of
the
Universal
Extension
In
this
Â§,
we
show
how
to
interpret
the
universal
extension
as
the
Hodge-theoretic
ï¬rst
Chern
class
of
a
certain
divisor.
The
material
of
this
Â§
follows
immediately
from
(the
obvious
logarithmic
generalization
of)
[Falt],
Lemma
IV.4,
but,
for
the
convenience
of
the
reader,
we
give
a
self-contained
treatment
here.
In
particular,
the
theory
of
the
present
Â§
will
allow
us
to
give
a
functorial
deï¬nition
of
the
splitting
of
[Katz],
Lemma
C2.1,
which
will
play
an
important
role
in
Â§5
below.
In
[Katz],
by
contrast,
only
an
explicit
deï¬nition
of
this
splitting
in
terms
of
certain
â€œspecial
functionsâ€
was
given,
without
any
explanation
of
its
functorial
deï¬nition.
In
fact,
for
proving
the
results
of
Â§5
below,
it
will
be
important
to
know
the
deï¬nition
of
this
splitting
in
terms
of
special
functions,
but
nonetheless
it
is
interesting
to
know
that
this
splitting
can
be
deï¬ned
by
means
of
abstract
nonsense.
Let
C
log
â†’
S
log
be
a
log
elliptic
curve.
Let
Ï€1
,
Ï€2
:
C
Ã—S
E
â†’
E
be
the
projections
to
the
ï¬rst
and
second
factors,
and
denote
by
E
=
Î”E
âŠ†
E
Ã—S
E
âŠ†
C
Ã—S
E
the
diagonal
section.
(Thus,
Î”E
is
a
(closed)
divisor
in
C
Ã—S
E.)
Let
67
Z
â†’
C
Ã—S
E
be
the
torsor
of
relative
logarithmic
diï¬€erentials
(i.e.,
diï¬€erentials
with
respect
to
the
logarithmic
morphism
Ï€2log
:
C
log
Ã—S
log
E
log
â†’
E
log
)
that
are
regular
everywhere,
except
at
the
divisor
Î”E
,
where
they
have
a
simple
pole
with
residue
1.
Thus,
Z
is
an
Ï‰E
|CÃ—S
E
torsor
(where
we
think
of
the
diï¬€erentials
â€œÏ‰E
â€
as
arising
from
the
ï¬rst
factor
of
C
Ã—S
E)
on
C
Ã—S
E.
Another
way
to
think
of
Z
is
that
it
is
the
torsor
deï¬ned
by
the
Hodge-theoretic
ï¬rst
Chern
class
in
R1
(Ï€2
)âˆ—
(C
Ã—S
E,
Ï‰E
|CÃ—S
E
)
of
the
divisor
Î”E
.
Similarly,
let
Y
â†’
C
Ã—S
E
be
the
torsor
of
relative
logarithmic
diï¬€erentials
(i.e.,
diï¬€erentials
with
respect
to
the
logarithmic
morphism
Ï€2log
:
C
log
Ã—S
log
E
log
â†’
E
log
)
that
are
regular
everywhere,
except
at
the
divisor
{e}
Ã—
E
âŠ†
C
Ã—S
E,
where
they
have
a
simple
pole
with
residue
1.
(Here,
â€œeâ€
denotes
the
origin
of
E.)
Thus,
Y
is
an
Ï‰E
|CÃ—S
E
-torsor
on
C
Ã—S
E.
Another
way
to
think
of
Z
is
that
it
is
the
torsor
deï¬ned
by
the
Hodge-theoretic
ï¬rst
Chern
class
in
R1
(Ï€2
)âˆ—
(C
Ã—S
E,
Ï‰E
|CÃ—S
E
)
of
the
divisor
{e}
Ã—
E
âŠ†
C
Ã—S
E.
Note
that
in
fact,
Y
is
the
pull-back
to
C
Ã—S
E
via
Ï€1
of
the
torsor
Tor
â†’
C
which
is
the
Hodge-theoretic
ï¬rst
Chern
class
of
the
divisor
{e}
in
C.
Let
us
denote
by
ZÎ”
â†’
E;
YÎ”
â†’
E
the
restrictions
of
the
torsors
Z
and
Y
to
Î”E
âŠ†
C
Ã—S
E.
Thus,
ZÎ”
and
YÎ”
are
Ï‰E
|E
torsors
on
E.
Since
the
composite
of
E
=
Î”E
â†’
C
Ã—S
E
with
Ï€1
is
the
natural
inclusion
E
â†’
C,
it
follows
that
YÎ”
=
Tor
|E
68
i.e.,
the
torsor
associated
to
the
Hodge-theoretic
ï¬rst
Chern
class
of
the
divisor
{e}
in
C.
On
the
other
hand,
we
propose
to
show
in
the
following
that
when
2
is
invertible
on
S,
the
torsor
ZÎ”
is
trivial,
and,
moreover
that
one
can
construct
an
explicit
trivialization
of
ZÎ”
:
Let
J
be
the
sheaf
of
ideals
on
C
Ã—S
E
that
deï¬nes
Î”E
.
Then
we
have
an
exact
sequence
0
â†’
J
2
/J
3
â†’
J
/J
3
â†’
J
/J
2
â†’
0
We
will
regard
this
exact
sequence
as
an
exact
sequence
of
OE
-modules
via
the
action
of
OE
arising
from
the
second
factor
of
C
Ã—S
E.
We
would
ï¬rst
like
to
show
that
this
exact
sequence
(of
OE
-modules)
admits
a
natural
splitting
when
2
is
invertible
on
S.
We
construct
this
splitting
as
follows:
First,
observe
that
the
isomorphism
C
Ã—S
E
âˆ¼
=
C
Ã—S
E
given
by
(Î±,
Î²)
â†’
(Î±âˆ’Î²,
Î²)
(where
Î±
is
a
point
of
C,
Î²
a
point
of
E,
and
we
use
the
fact
that
the
group
scheme
E
acts
on
C)
maps
Î”E
âŠ†
C
Ã—S
E
isomorphically
onto
{e}
Ã—E
âŠ†
C
Ã—S
E.
Thus,
if
Ie
âŠ†
C
is
the
sheaf
of
ideals
deï¬ning
{e}
âŠ†
C,
then
we
have
an
exact
sequence
of
sheaves
0
â†’
Ie2
/Ie3
â†’
Ie
/Ie3
â†’
Ie
/Ie2
â†’
0
of
OS
-modules
such
that
the
exact
sequence
of
the
preceding
paragraph
is
the
pull-back
via
Ï€1
:
C
Ã—S
E
â†’
C
of
this
exact
sequence.
Thus,
it
suï¬ƒces
to
construct
a
splitting
of
this
exact
sequence.
To
do
this,
we
consider
the
automorphism
â€œâˆ’1â€
on
E,
which
extends
to
an
automorphism
of
C.
This
automorphism
induces
an
automorphism
Î±
of
the
above
exact
sequence
(which
covers
the
automorphism
â€œâˆ’1â€
of
C).
Moreover,
the
automorphism
Î±
is
of
order
2,
and
(as
one
sees
easily
by
identifying
Ie
/Ie2
with
the
cotangent
space
Ï‰E
to
C
at
e)
induces
multiplication
by
âˆ’1
(respectively,
1)
on
Ie
/Ie2
(respectively,
Ie2
/Ie3
).
Thus,
the
endomorphism
12
Â·
(1
âˆ’
Î±)
of
the
above
exact
sequence
induces
a
splitting
of
the
above
exact
sequence,
as
desired.
Thus,
we
obtain
a
splitting
SJ
:
J
/J
2
â†’
J
/J
3
of
the
exact
sequence
0
â†’
J
2
/J
3
â†’
J
/J
3
â†’
J
/J
2
â†’
0
Now
let
s
be
a
local
section
of
J
/J
2
in
a
(Zariski)
neighborhood
of
Î”E
.
Then
SJ
(s)
lifts
(noncanonically)
to
a
local
section
t
of
J
with
a
zero
of
order
1
at
Î”E
.
Thus,
if
we
form
69
the
logarithmic
derivative
dt
t
of
t
(where
we
diï¬€erentiate
with
respect
to
the
ï¬rst
factor
of
C
Ã—S
E),
we
get
a
diï¬€erential
which
is
regular
in
a
neighborhood
of
Î”E
,
except
that
it
has
a
simple
pole
at
Î”E
with
a
residue
of
order
1.
Thus,
dt
t
deï¬nes
a
section
of
Z
over
this
neighborhood.
Moreover,
one
checks
immediately
that
the
restriction
of
this
section
to
Î”E
is
independent
of
the
choice
of
s
and
t.
Thus,
we
get
a
section
SÎ”
:
E
â†’
ZÎ”
of
ZÎ”
which
is
globally
deï¬ned
over
E.
That
is
to
say,
we
have
proven
the
following:
Proposition
4.1.
If
2
is
invertible
on
S,
then
the
torsor
ZÎ”
â†’
E
admits
a
canonical
section
SÎ”
:
E
â†’
ZÎ”
(as
deï¬ned
above).
Next,
let
us
observe
that
it
follows
from
the
deï¬nition
of
the
universal
extension
E
â€ 
in
Â§1
that
the
torsor
Z
âˆ’Y
formed
by
taking
the
diï¬€erence
of
the
torsors
Y
and
Z
on
C
Ã—S
E
is
trivial
on
the
ï¬bers
of
Ï€2
:
C
Ã—S
E
â†’
E,
and,
moreover,
that
the
torsor
Z
âˆ’
Y
may
thus
be
â€œpushed
forwardâ€
via
Ï€2
to
form
an
Ï‰E
-torsor
on
E
which
is
(by
deï¬nition)
equal
to
E
â€ 
â†’
E.
In
fact,
because
Z
âˆ’
Y
is
trivial
on
the
ï¬bers
of
Ï€2
,
it
is
in
fact
equal
to
the
pull-back
by
Ï€2
of
the
torsor
E
â€ 
â†’
E.
In
particular,
since
the
composite
of
E
=
Î”E
â†’
C
Ã—S
E
with
Ï€2
is
the
identity,
it
follows
that
we
have
a
natural
equality
of
Ï‰E
-torsors
on
E:
ZÎ”
âˆ’
YÎ”
=
(Z
âˆ’
Y
)|Î”E
=
E
â€ 
Thus,
by
Proposition
4.1,
we
obtain
that:
Theorem
4.2.
torsors
on
E
If
2
is
invertible
on
S,
then
there
is
a
canonical
isomorphism
of
Ï‰E
-
Eâ€ 
âˆ¼
=
âˆ’Tor
|E
between
E
â€ 
â†’
E
and
âˆ’1
times
the
torsor
associated
to
the
Hodge-theoretic
ï¬rst
Chern
class
of
the
origin
{e}
âŠ†
E.
Next,
we
would
like
to
observe
a
certain
consequence
of
Proposition
4.2:
70
Even
if
2
is
not
invertible
on
S,
the
Ï‰E
|E
-torsor
E
â€ 
â†’
E
extends
log
â€ 
naturally
to
an
Ï‰E
|C
-torsor
EC
â†’
C.
If
S
log
=
(M1,0
)Z
,
then
this
extension
is
unique.
Corollary
4.3.
Proof.
We
begin
with
the
case
where
2
is
invertible.
Then
Theorem
4.2
implies
that
E
â€ 
â†’
E
is
isomorphic
âˆ’Tor
|E
,
which
is
just
the
restriction
to
E
âŠ†
C
of
the
torsor
âˆ’Tor
â†’
C.
This
proves
extendability.
log
Next,
we
prove
uniqueness
in
the
case
where
S
log
=
(M1,0
)Z
.
Write
DS
âŠ†
S
for
the
divisor
at
inï¬nity,
and
DC
âŠ†
C
for
the
complement
of
E
in
C
with
the
â€œreduced
inducedâ€
scheme
structure.
Thus,
DC
maps
isomorphically
down
to
DS
,
and
DC
âˆ¼
=
DS
âˆ¼
=
Spec(Z).
Uniqueness
then
follows
from
the
fact
that
DC
has
codimension
2
in
C
(which
is
a
regular
algebraic
stack).
log
Thus,
it
remains
to
prove
extendability
in
the
case
where
S
log
=
(M1,0
)Z
.
Note
that
(relative
to
the
notation
introduced
in
the
preceding
paragraph)
there
is
a
natural
exact
sequence
of
â€œlocal
cohomology
groupsâ€:
.
.
.
â†’
H1
(C,
Ï‰E
|C
)
â†’
H1
(E,
Ï‰E
|E
)
â†’
H2DC
(C,
Ï‰E
|C
)
â†’
.
.
.
where
H2DC
denotes
â€œcohomology
with
supports
in
DC
.â€
On
the
other
hand,
it
is
wellknown
that
since
the
subscheme
DC
âŠ†
C
is
a
local
complete
intersection
of
codimension
2,
the
cohomology
module
H2DC
is
ï¬‚at
over
Z.
(Indeed,
this
amounts
to
a
well-known
computation
involving
the
Koszul
complex
(cf.,
e.g.,
[Mats]):
If
t1
and
t2
are
local
parameters
on
S
at
DC
,
then
this
cohomology
is
a
direct
limit
of
Z-modules
of
the
form
Z[t1
,
t2
]/(tn1
,
tn2
),
as
n
â†’
âˆ.)
Thus,
it
follows
that
the
vanishing
of
the
obstruction
to
extending
E
â€ 
to
C
may
be
checked
after
restriction
to
Spec(Z[
12
]).
This
completes
the
proof
of
the
corollary.

Remark.
The
reader
may
ï¬nd
it
strange
that
despite
the
fact
that
we
have
shown
the
â€ 
torsors
EC
â†’
C
and
âˆ’Tor
â†’
C
to
be
isomorphic
after
one
inverts
2,
we
may
not
conclude
immediately
that
they
are
isomorphic
even
without
inverting
2.
The
reason
for
this
is
the
possibility
of
the
existence
of
2-torsion
in
H
1
(S,
Ï‰E
).
In
fact,
we
shall
see
later
that
the
â€ 
isomorphism
between
EC
â†’
C
and
âˆ’Tor
â†’
C
does,
in
fact,
fail
to
be
integral
at
the
prime
2
(cf.
the
Remark
following
Corollary
5.8).
Note
that
Corollary
4.3
thus
implies
that
the
vector
bundle
T
considered
in
the
discussion
preceding
Deï¬nition
2.3
extends
naturally
to
a
vector
bundle
TC
on
C
that
ï¬ts
into
an
exact
sequence
0
â†’
OC
â†’
TC
â†’
Ï„E
|C
â†’
0
extending
the
exact
sequence
of
loc.
cit.
71
Finally,
we
make
the
connection
with
the
splitting
of
[Katz],
Lemma
C2.1.
The
point
is
the
following:
The
torsor
âˆ’Tor
â†’
C
is
the
torsor
of
diï¬€erentials
that
are
regular
everywhere
except
for
a
simple
pole
at
the
origin
of
residue
âˆ’1.
Thus,
over
def
U
=
C
âˆ’
{e}
this
torsor
is
just
the
torsor
of
global
regular
diï¬€erentials.
In
particular,
over
U
,
it
admits
a
section
given
by
the
â€œzero
diï¬€erential.â€
Moreover,
in
a
neighborhood
of
e,
it
is
easy
to
see
that
the
zero
diï¬€erential,
regarded
as
the
sort
of
diï¬€erential
parametrized
by
âˆ’Tor
,
has
a
pole
of
order
1
at
e.
Thus,
we
get
a
section
Sor
:
U
â†’
âˆ’Tor
with
a
pole
of
order
1
at
the
origin.
Now
let
us
assume
that
6
is
invertible
on
S.
Then
one
obtains
two
sections
â€ 
S1
,
S2
:
U
â†’
EC
of
the
universal
extension
over
U
:
the
ï¬rst
is
given
by
transporting
Sor
by
means
of
the
isomorphism
of
Theorem
4.2;
the
second
is
that
of
[Katz],
Lemma
C2.1.
To
review,
this
section
of
[Katz]
is
deï¬ned
as
follows:
For
an
elliptic
curve
deï¬ned
by
the
equation
y
2
=
4x3
âˆ’g2
xâˆ’g3
,
the
section
S2
is
deï¬ned
by
associating
to
a
point
P
of
U
the
diï¬€erential
y
+
y(P
)
dx
Â·
2{x
âˆ’
x(P
)}
y
(which
is
regular
everywhere
except
at
e
and
P
,
and
has
residues
âˆ’1
at
e
and
+1
at
P
).
In
fact,
strictly
speaking,
Katz
only
deï¬nes
this
section
for
smooth
C
â†’
S,
but
one
checks
easily
that
the
above
deï¬nition
deï¬nes
a
section
for
arbitrary
C.
Moreover,
both
sections
have
a
pole
of
order
1
at
e.
Indeed,
this
follows
immediately
from
the
deï¬nition
for
S1
;
for
S2
,
it
follows
from,
say,
[Katz],
Theorem
C6,
(2).
Thus,
their
diï¬€erence
deï¬nes
a
section
Î´
âˆˆ
Î“(C,
Ï‰E
|C
(e))
We
would
like
to
show
that
Î´
=
0.
To
do
this,
it
suï¬ƒces
to
consider
the
universal
case:
log
i.e.,
S
log
=
M1,0
âŠ—Z
Z[
16
].
Then
it
follows
immediately
from
an
elementary
application
of
Riemann-Roch
on
the
ï¬bers
of
C
â†’
S
that
Î´
in
fact
lies
in
Î“(C,
Ï‰E
|C
)
=
Î“(S,
Ï‰E
).
On
the
other
hand,
it
is
well-known
(cf.,
e.g.,
[KM],
p.
227)
that
Î“(S,
Ï‰E
)
=
0.
Thus,
Î´
=
0,
as
desired.
In
other
words,
we
have
proven
the
following
result:
â€ 
Corollary
4.4.
Suppose
that
6
is
invertible
on
S.
Then
the
isomorphism
âˆ’Tor
âˆ¼
=
EC
maps
the
section
Sor
:
C
âˆ’
{e}
â†’
âˆ’Tor
deï¬ned
above
to
the
section
of
[Katz],
Lemma
C2.1.
72
â€ 
In
particular,
the
section
of
[Katz],
Lemma
C2.1,
deï¬nes
a
unique
section
C
âˆ’
{e}
â†’
EC
,
even
when
6
is
not
invertible.
Â§5.
Analytic
Continuation
of
the
Canonical
Splitting
The
purpose
of
this
Â§
is
to
show
that
the
canonical
splitting
Îº
of
Theorem
2.1
may
be
â€œanalytically
continuedâ€
to
a
splitting
in
the
category
of
â€œentire
functionsâ€
on
the
uniformization
of
a
degenerating
elliptic
curve
in
the
sense
of
[Mumf
]
(i.e.,
the
formal
algebraic
analogue
of
the
Schottky
uniformization).
Although
this
splitting
will
not
be
periodic,
it
will
satisfy
a
simple
rule
with
respect
to
the
period
of
the
degenerating
elliptic
curve
(i.e.,
shifting
by
a
period
aï¬€ects
the
splitting
by
adding
a
constant).
In
order
to
analyze
this
splitting,
we
will
also
use
the
splitting
Sor
of
Corollary
4.4.
The
diï¬€erence
between
Îº
and
Sor
will
be
a
sort
of
Weierstrass
Î¶-function
with
respect
to
the
Schottky
uniformization.
Thus,
we
will
refer
to
it
as
a
Schottky-Weierstrass
Î¶-function.
We
will
discuss
this
Î¶-function
(as
well
as
its
â€œclose
relativesâ€)
in
more
detail
in
Â§6,
7
below.
In
the
present
Â§,
we
show
how
to
translate
the
material
of
[Katz],
Appendix
C,
Â§C6,
C7
into
the
context
of
Mumfordâ€™s
construction.
Although,
strictly
speaking,
this
Schottky
version
of
the
theory
of
[Katz],
Appendix
C,
Â§C6,
C7,
is
not
logically
necessary
for
the
proofs
of
the
main
results
of
the
present
Â§
(or,
for
that
matter,
of
the
present
paper),
we
present
it
here
nevertheless
because
we
feel
it
to
be
both
interesting
and
generally
culturally
relevant
to
what
we
do
discuss
here.
Also,
we
remark
that
â€œin
principle,â€
what
we
discuss
here
is
â€œwell-known,â€
but
I
do
not
know
an
adequate
reference
for
it.
We
begin
by
reviewing
the
set-up
in
[Mumf
],
especially
[Mumf],
Â§5.
To
do
this,
we
must
introduce
some
notation.
Let
K
be
a
ï¬nite
extension
of
Q,
and
let
OK
be
its
ring
of
integers.
In
this
Â§,
we
let
O
be
a
Zariski
localization
of
OK
,
i.e.,
a
ring
such
that
Spec(O)
is
an
open
subscheme
of
Spec(OK
).
Let
def
A
=
O[[q]];
def
S
=
Spec(A)
(where
q
is
an
indeterminate).
Moreover,
we
equip
S
with
the
log
structure
deï¬ned
by
the
def
divisor
D
=
V
(q)
âŠ†
S.
Let
S
be
the
formal
scheme
obtained
by
regarding
O[[q]]
as
a
topological
ring
with
the
q-adic
topology.
Let
Eâ†’S
73
be
the
semi-abelian
scheme
obtain
by
forming
the
quotient
of
Gm
by
the
period
â€œqâ€
(as
in
[Mumf]
or
[FC],
Chapter
III).
Then
E
â†’
S
arises
in
a
natural
way
from
a
log
elliptic
curve
C
log
â†’
S
log
.
Let
us
write
def
def
LC
=
OC
(e);
LE
=
LC
|E
(where
e
is
the
divisor
deï¬ned
by
the
identity
section).
Next,
we
would
like
to
consider
various
kinds
of
analytic
functions.
First,
recall
that
we
have
a
natural
identiï¬cation
ES
=
(Gm
)S
an
Let
us
write
Ran
E
for
the
coordinate
ring
of
ES
.
Thus,
one
can
think
of
RE
as:
âˆ’1
Ran
}}
E
=
A{{U,
U
i.e.,
Laurent
series
with
coeï¬ƒcients
converging
to
zero
in
A.
Let
us
write
an
Ralg
E
âŠ†
RE
[Î¸];
(respectively,
RE
âŠ†
Ran
E
[Î¸])
where
Î¸
is
an
indeterminate,
for
the
A-subalgebra
of
Ran
E
[Î¸]
generated
(respectively,
generated
q-adically)
by
the
elements
{q
k
+k
Â·
U
2k+1
Â·
Î¸,
q
k
Â·
U
2k
Â·
Î¸,
q
k
âˆ’k
Â·
U
2kâˆ’1
Â·
Î¸}
2
2
2
where
k
ranges
over
all
elements
of
Z.
That
is
to
say,
Ralg
E
(along
with
its
q-adic
completion
RE
)
is
the
ring
â€œRÏ†,Î£
â€
used
by
Mumford
(cf.
[Mumf],
p.
306)
to
construct
E
as
a
quotient
alg
of
Gm
.
In
this
context,
it
is
natural
to
think
of
Ran
E
[Î¸],
RE
and
RE
as
graded
rings,
in
which
elements
of
Ran
E
have
degree
zero
and
Î¸
has
degree
one.
Next,
recall
from
the
theory
of
[Mumf]
that
there
is
a
natural
action
of
Z
on
C
âˆ
=
Proj(Ralg
E
)
def
and
C
âˆ
=
Proj(RE
)
def
S
deï¬ned
by
letting
1
âˆˆ
Z
act
by:
U
â†’
q
Â·
U
;
Î¸
â†’
q
Â·
U
2
Â·
Î¸
In
the
following,
we
shall
denote
this
group
of
automorphisms
by
Zet
74
Thus,
we
shall
identify
the
elements
of
Zet
with
Z
and
write,
for
instance,
â€œ1et
âˆˆ
Zet
,â€
but
we
prefer
to
use
the
notation
Zet
for
the
group
of
automorphisms,
in
order
to
distinguish
it
from,
for
instance,
Z
regarded
as
a
subring
of
O.
Now
it
follows
from
the
theory
of
[Mumf]
that
in
our
notation
CS
is
formed
by
taking
the
quotient
of
C
âˆ
by
this
action
of
Zet
.
In
fact,
the
special
ï¬ber
S
(C
âˆ
)spl
=
(C
âˆ
)spl
S
(i.e.,
ï¬ber
over
V
(q)
âŠ†
S)
of
C
âˆ
is
an
inï¬nite
chain
of
P1
â€™s,
connected
to
each
other
at
â€œ0â€
and
â€œâˆ.â€
Thus,
each
irreducible
component
of
(C
âˆ
)spl
is
a
copy
P1
,
labeled
by
an
element
of
Zet
.
The
action
of
Zet
on
the
irreducible
components
(thought
of
relative
to
this
labeling)
is
just
the
action
of
Zet
on
Zet
by
addition.
(See
[Mumf]
for
more
details.)
Another
way
to
think
of
C
âˆ
is
as
a
sort
of
NeÌron
model
for
Gm
over
S
relative
to
the
open
immersion
S
âˆ’
V
(q)
âŠ†
S.
Thus,
the
irreducible
components
of
the
special
ï¬ber
correspond
naturally
to
the
q-adic
orders
of
elements
of
A[q
âˆ’1
].
Relative
to
the
point
of
view
of
[Mumf]
(cf.
especially
[Mumf],
p.
289),
the
ample
line
bundle
â€œO(1)â€
on
C
âˆ
obtained
by
regarding
RE
as
a
graded
ring
(as
discussed
above)
may
S
be
identiï¬ed
in
a
natural
fashion
with
the
pull-back
(relative
to
the
quotient
C
âˆ
â†’
CS
)
S
LâŠ—2
Câˆ
S
âŠ—2i
âˆ
to
C
âˆ
of
LâŠ—2
C
.
Thus,
the
elements
of
RE
of
degree
i
deï¬ne
sections
of
LC
âˆ
over
C
.
S
S
S
âŠ—2i
âˆ
Conversely,
I
claim
that
all
sections
of
LC
âˆ
over
C
arise
in
this
way.
Indeed,
it
suï¬ƒces
S
S
to
note
that:
âˆ
(1)
The
global
sections
of
LâŠ—2i
C
âˆ
over
the
irreducible
component
of
(C
)spl
S
marked
â€œ0â€
are
spanned
over
O
by
the
restrictions
to
this
irreducible
component
of
the
sections
U
âˆ’i
Â·
Î¸
i
,
U
âˆ’i+1
Â·
Î¸
i
,
.
.
.
,
Î¸
i
,
U
iâˆ’1
Â·
Î¸
i
,
U
i
Â·
Î¸
i
(2)
The
sections
U
âˆ’i+1
Â·
Î¸
i
,
U
âˆ’i+2
Â·
Î¸
i
,
.
.
.
,
Î¸
i
,
U
iâˆ’1
Â·
Î¸
i
,
U
i
Â·
Î¸
i
all
vanish
when
restricted
to
any
irreducible
component
of
(C
âˆ
)spl
that
lies
on
the
same
side
of
the
component
marked
0
as
the
point
U
=
0
of
75
the
components
marked
0.
(Indeed,
acting
on
any
of
these
sections
by
a
positive
integer
âˆˆ
Zet
sends
these
sections
to
zero
modulo
q.)
By
translating
these
two
observations
over
to
the
other
irreducible
components
of
C
âˆ
spl
,
âˆ
one
sees
easily
that
one
may
construct
arbitrary
sections
of
LâŠ—2i
(C
âˆ
)spl
over
(C
)spl
by
means
of
elements
in
RE
.
This
completes
the
proof
of
the
claim.
Thus,
in
summary,
Î“(C
âˆ
,
LâŠ—2i
C
âˆ
)
=
degree
i
portion
of
RE
S
S
Put
another
way,
Î¸
deï¬nes
a
trivialization
of
the
line
bundle
LâŠ—2
C
âˆ
over
ES
=
(Gm
)S
S
with
respect
to
which
global
sections
may
be
written
as
certain
Laurent
series
in
U
whose
coeï¬ƒcients
(âˆˆ
A)
decay
fairly
rapidly.
In
particular,
suppose
that
Ïƒ
alg
âˆˆ
Î“(C,
LC
)
is
the
section
given
by
the
embedding
OC
â†’
OC
(e)
=
LC
.
Then,
by
restricting
Ïƒ
alg
to
C
âˆ
,
we
can
write
its
square
(Ïƒ
alg
)2
S
analytically
as
some
element
(Ïƒ
alg
)2
|C
âˆ
=
(Ïƒ
an
)2
Â·
Î¸
âˆˆ
RE
S
where
(Ïƒ
an
)2
âˆˆ
Ran
E
is
some
(topological)
A-linear
combination
of
the
elements
{q
k
+k
Â·
U
2k+1
,
q
k
Â·
U
2k
,
q
k
âˆ’k
Â·
U
2kâˆ’1
}{kâˆˆZ}
2
2
2
The
advantage
of
working
with
(Ïƒ
an
)2
is
that
it
is
an
explicit
Laurent
series.
For
convenience,
in
the
following,
we
shall
often
write
just
Ïƒ
2
for
(Ïƒ
an
)2
.
In
terms
of
normalizations
of
Ïƒ
alg
(relative
to
multiplication
by
elements
of
AÃ—
),
we
would
like
to
think
of
Ïƒ
alg
as
being
chosen
so
that
the
square
diï¬€erential
at
the
origin
e
of
E
determined
by
Ïƒ
2
(which
has
a
zero
of
order
2
at
the
origin)
is
equal
to
(d
log(U
))2
.
Next,
let
Rmer
Câˆ
S
denote
the
ring
of
meromorphic
functions
on
C
âˆ
.
By
this,
we
mean
those
functions
which
S
can,
Zariski
locally
on
the
formal
scheme
C
âˆ
,
be
written
as
a
quotient
of
a
regular
function
S
(i.e.,
a
section
of
OC
âˆ
)
by
a
nonzero
regular
function.
Thus,
the
zeroes
and
poles
of
a
S
meromorphic
function
on
C
âˆ
have
ï¬nite
order.
Note,
further,
that
we
have
a
natural
S
injection
an
Rmer
C
âˆ
â†’
Q(RE
)
S
76
(where
â€œQâ€
denotes
â€œthe
quotient
ï¬eld
ofâ€).
Indeed,
the
fact
that
this
morphism
is
an
injection
follows
by
considering
the
situation
at
the
nodes
of
C
âˆ
,
where
this
injectivity
S
essentially
amounts
to
the
fact
that
the
natural
map
O[[X,
Y
]]
â†’
(O[[X]](X
âˆ’1
))[[Y
]]
(where
X
and
Y
are
indeterminates)
from
power
series
over
O
in
X
and
Y
to
power
series
in
Y
with
coeï¬ƒcients
in
O[[X]](X
âˆ’1
)
is
injective.
Observe
that
if
f
is
a
function
on
C
âˆ
which
can
be
written
as
a
quotient
of
a
(regular)
S
section
of
LâŠ—2N
over
C
âˆ
by
a
nonzero
(regular)
section
of
LâŠ—2N
over
C
âˆ
(for
some
N
),
S
S
then
f
âˆˆ
Rmer
Câˆ
S
For
instance,
since
both
Î¸
(=
0)
and
Ïƒ
2
Â·
Î¸
are
regular
sections
of
L2
over
C
âˆ
,
it
follows
S
that
Ïƒ
2
=
(Ïƒ
2
Â·
Î¸)
Â·
Î¸
âˆ’1
âˆˆ
Rmer
Câˆ
S
Finally,
if
Ï†
âˆˆ
Rmer
C
âˆ
,
let
us
write
S
def
Ï†
=
U
âˆ‚Ï†
âˆ‚U
mer
Note
that
since
Ï†
âˆˆ
Rmer
C
âˆ
,
we
also
have
Ï†
âˆˆ
RC
âˆ
.
S
S
Next,
we
would
like
to
make
use
of
the
Weierstrass
normal
form
of
the
elliptic
curve
E
(as
in
[Katz],
Â§C2).
That
is
to
say,
we
ï¬x
the
diï¬€erential
d
log(U
)
=
dU
U
and
take
the
resulting
rational
functions
x
and
y
on
E
such
that
dx/y
=
d
log(U
)
(as
in
[Katz],
Â§C2).
Thus,
the
elliptic
curve
E
is
deï¬ned
by
the
equation
y
2
=
4x3
âˆ’
g2
x
âˆ’
g3
where
the
zero
section
e
is
the
point
at
inï¬nity
(of
the
aï¬ƒne
curve
deï¬ne
by
this
equation).
In
order
to
do
this,
one
must
assume
that
6âˆ’1
âˆˆ
O.
Thus,
for
the
rest
of
this
Â§,
until
stated
otherwise,
we
shall
assume
that
6âˆ’1
âˆˆ
O.
(We
will
state
explicitly
(after
Proposition
4.5)
when
this
assumption
is
no
longer
in
force.)
77
Thus,
x
is
a
rational
function
on
C
with
the
following
properties:
(i)
x
has
a
pole
of
order
two
at
the
origin,
and
no
other
poles;
(ii)
x
is
even;
(iii)
the
section
of
Ï„EâŠ—2
deï¬ned
by
looking
at
the
â€œleading
termâ€
of
x
at
âˆ‚
2
)
.
the
origin
is
equal
to
(U
âˆ‚U
âˆ‚x
Moreover,
y
is
the
rational
function
on
C
given
by
U
âˆ‚U
.
(Note
that
since
the
derivation
âˆ‚
U
âˆ‚U
is
algebraic,
this
statement
makes
sense
in
the
algebraic
category
despite
the
fact
that
â€œU
â€
is
only
deï¬ned
analytically.)
Then,
by
analogy
with
the
classical
complex
theory
(see,
e.g.,
[Ahlf],
p.
272),
we
write
â„˜
and
â„˜
for
the
analytic
representations
(i.e.,
elements
of
Rmer
C
âˆ
)
of
x
and
y,
respectively.
Also,
we
S
write
def
Î¶
=
(Ïƒ
2
)
/(2
Â·
Ïƒ
2
)
âˆˆ
Rmer
Câˆ
S
for
the
analogue
of
the
classical
Weierstrass
Î¶-function.
Note
that
since
Ïƒ
2
is
even,
while
âˆ‚
is
odd,
it
follows
that
Î¶
is
an
odd
function.
Also,
note
that
since
Ïƒ
2
has
a
zero
of
U
âˆ‚U
order
2
at
the
origin
e,
it
follows
that
Î¶
Â·
d
log(U
)
has
a
simple
pole
at
the
origin
e
whose
residue
is
1.
In
fact,
modulo
q,
it
is
easy
to
compute
Î¶
explicitly:
Indeed,
modulo
q,
Ïƒ
2
is
equal
to
a
unit
multiple
of
U
âˆ’
2
+
U
âˆ’1
(compare
zero
loci!),
so
we
obtain
that
(modulo
q)
Î¶
Â·
d
log(U
)
â‰¡
1
1
dU
Â·
d
log(U
âˆ’
2
+
U
âˆ’1
)
=
âˆ’
d
log(U
)
=
2
U
âˆ’1
2
U
1
âˆ’
U
âˆ’1
2
Â·
d
log(U
)
In
particular,
we
see
that
the
meromorphic
function
Î¶
is
regular
(i.e.,
does
not
have
a
pole)
at
the
nodes
U
=
0,
âˆ
of
the
component
of
(C
âˆ
)spl
marked
0.
S
Note
that
the
action
of
Zet
on
Î¶
may
be
determined
as
follows:
1et
âˆˆ
Zet
acts
on
Î¸
by:
Î¸
â†’
q
Â·
U
2
Â·
Î¸
Since
Ïƒ
2
Â·
Î¸
is
pulled
back
from
CS
,
it
thus
follows
that
1et
âˆˆ
Zet
ï¬xes
Ïƒ
2
Â·
Î¸.
In
particular,
the
action
of
1et
âˆˆ
Zet
on
Ïƒ
2
is
given
by:
78
Ïƒ
2
â†’
q
âˆ’1
Â·
U
âˆ’2
Â·
Ïƒ
2
This
allows
us
to
conclude
that
the
action
of
1et
âˆˆ
Zet
on
12
times
the
logarithmic
derivative
of
Ïƒ
2
,
i.e.,
on
Î¶,
is
given
by:
Î¶
â†’
Î¶
âˆ’
1
Observe
that
this
shows,
in
particular,
that
Î¶
is
regular
except
at
the
orbit
e
=
Zet
(e)
âŠ†
C
âˆ
def
S
of
e
under
the
action
of
Zet
,
where
it
is
has
a
pole
of
order
one.
Next,
we
would
like
to
check
that
certain
classical
formulas
concerning
the
various
functions
just
deï¬ned
hold
in
the
present
context,
as
well.
First
of
all,
let
us
observe
that
the
general
nonsense
concerning
meromorphic
functions
on
C
âˆ
can
be
extended
to
the
S
product
C
âˆ
Ã—S
C
âˆ
,
as
well.
We
leave
the
formulation
of
this
general
nonsense
to
the
S
S
reader.
Now
let
us
write
Î¼,
Ï€1
,
Ï€2
:
ES
Ã—S
ES
â†’
ES
for
the
obvious
multiplication
and
projection
maps,
respectively.
Write
Î½
:
ES
Ã—S
ES
â†’
ES
for
the
map
given
by
(Î±,
Î²)
â†’
Î±
âˆ’
Î².
Then
we
have
the
following
analogue
of
a
well-known
classical
formula:
Proposition
5.1.
One
has
an
equality
(âˆ’Ï€1âˆ—
â„˜
+
Ï€2âˆ—
â„˜)2
=
(Î¼âˆ—
Ïƒ
2
)
Â·
(Î½
âˆ—
Ïƒ
2
)
(Ï€1âˆ—
Ïƒ
4
)
Â·
(Ï€2âˆ—
Ïƒ
4
)
of
meromorphic
functions
on
C
âˆ
Ã—S
C
âˆ
.
S
S
Proof.
The
proof
is
entirely
similar
to
that
in
the
classical
case.
Namely,
one
uses
the
def
cubical
structure
on
L
=
LC
|E
to
ï¬rst
deduce
the
corresponding
(natural)
isomorphism
S
of
line
bundles:
Indeed,
if
79
B
=
(Î¼âˆ—
L)
âŠ—
(Ï€1âˆ—
L)âˆ’1
âŠ—
(Ï€2âˆ—
L)âˆ’1
def
is
the
corresponding
Gm
-biextension
on
the
E
Ã—S
E
(cf.
[MB]
for
more
on
cubical
structures),
then
one
has
a
natural
isomorphism

âˆ—
OEÃ—S
E
âˆ¼
=
B
âŠ—
idE
Ã—
(âˆ’idE
)
B
=
(Î¼âˆ—
L)
âŠ—
(Î½
âˆ—
L)
âŠ—
(Ï€1âˆ—
L)âŠ—âˆ’2
âŠ—
(Ï€2âˆ—
L)âŠ—âˆ’2
Taking
the
â€œsquareâ€
of
this
isomorphism
shows
that
both
sides
of
the
desired
equality
can
be
naturally
(i.e.,
algebraically
without
enlisting
the
aid
of
the
trivialization
Î¸)
regarded
as
rational
functions
on
E
Ã—S
E.
Note
that
here,
we
use
the
fact
that
the
trivialization
Î¸
is
compatible
with
the
cubical
structure
on
L
(which
follows
from
the
theory
of
[Mumf];
[FC],
Chapter
III).
Next,
observe
that
since
â„˜
is
an
even
function,
the
left-hand
side
has
zeroes
of
order
2
at
Î¼âˆ’1
(e)
and
Î½
âˆ’1
(e).
Moreover,
the
left-hand
side
has
poles
only
at
Ï€1âˆ’1
(e)
and
Ï€2âˆ’1
(e),
and
these
poles
are
both
of
order
4.
Since
this
enumeration
exhausts
all
the
poles
and
zeroes
of
the
right-hand
side,
we
thus
conclude
that
the
desired
equality
holds
up
to
muliplication
by
a
unit
of
A.
In
fact,
for
our
purposes,
this
will
be
suï¬ƒcient,
but
one
can
check
that
this
unit
must
be
=
1
be
looking
at
the
leading
term
at
the
origin.

Proposition
5.2.
One
has
an
equality
1
Ï€1âˆ—
â„˜
âˆ’
Ï€2âˆ—
â„˜
=
(Î¼âˆ—
Î¶)
âˆ’
(Ï€1âˆ—
Î¶)
âˆ’
(Ï€2âˆ—
Î¶)
âˆ—
âˆ—
2
Ï€1
â„˜
âˆ’
Ï€2
â„˜
of
meromorphic
functions
on
C
âˆ
Ã—S
C
âˆ
.
S
S
Proof.
The
proof
is
entirely
similar
to
that
in
the
classical
case:
Namely,
one
takes
the
logarithmic
derivative
of
both
sides
of
the
equality
of
Proposition
5.1
with
respect
to
the
âˆ‚
âˆ‚
)
+
Ï€2âˆ—
(U
âˆ‚U
),
and
then
divides
by
4.
Note
here
that
the
push-forward
derivation
Ï€1âˆ—
(U
âˆ‚U
âˆ‚
of
this
derivation
with
respect
to
Î¼
(respectively,
Î½)
is
equal
to
2
Â·
(U
âˆ‚U
)
(respectively,
0).

Next,
we
would
like
to
prove
the
analogue
of
Theorem
C6
of
[Katz].
The
analogue
of
the
ï¬rst
part
of
this
theorem
(i.e.,
Theorem
C6,
(1))
consists
of
making
explicit
the
diï¬€erentials
deï¬ned
by
the
canonical
splitting
in
terms
of
the
special
function
Î¶.
Recall
that
over
D,
we
already
did
this
(i.e.,
wrote
down
the
diï¬€erential
â€œÏ‰x
â€
explicitly)
in
our
construction
of
Îº
(cf.
the
discussion
preceding
Theorem
2.1).
Thus,
we
would
like
to
extend
this
discussion
to
the
situation
over
S.
To
do
this,
let
Î±
âˆˆ
Gm
(S)
be
a
point
of
ES
.
Write
80
TÎ±
:
ES
â†’
ES
for
the
morphism
given
by
translating
by
Î±.
Then
let
us
consider
the
diï¬€erential
(on
ES
)
deï¬ned
by

def

Ï‰Î±
=
TÎ±âˆ—âˆ’1
(Î¶)
âˆ’
Î¶
Â·
d
log(U
)
Note
that
since
Î¶
Â·
d
log(U
)
has
a
simple
pole
with
residue
1
at
e,
the
diï¬€erential
Ï‰Î±
has
a
simple
pole
with
residue
1
(respectively,
âˆ’1)
at
Î±
(respectively,
e).
Clearly,
the
correspondence
Î±
â†’
Ï‰Î±
is
functorial
in
Î±.
Moreover,
we
have
the
following
Lemma
5.3.
The
diï¬€erential
Ï‰Î±
is
algebraic
in
the
sense
that
it
arises
from
a
meromorphic
diï¬€erential
on
C.
Moreover,
this
meromorphic
diï¬€erential
on
C
has
no
poles
except
at
Î±
and
e.
Proof.
Indeed,
1et
âˆˆ
Zet
acts
on
both
Î¶
and
its
translate
TÎ±âˆ—âˆ’1
(Î¶)
by
adding
âˆ’1.
Thus,
1et
âˆˆ
Zet
stabilizes
Ï‰Î±
.
This
implies
that
Ï‰Î±
descends
to
an
algebraic
meromorpic
diï¬€erential
on
C.
The
description
of
the
poles
of
Ï‰Î±
follows
from
the
description
of
the
poles
of
Î¶
given
in
the
above
discussion.

Next,
let
us
observe
that
(for
Î±,
Î²
âˆˆ
Gm
(S)
=
ES
(S))
the
meromorphic
function
(TÎ±âˆ—âˆ’1
Ïƒ
2
)
Â·
(TÎ²âˆ—âˆ’1
Ïƒ
2
)
(TÎ±âˆ—âˆ’1
Â·Î²
âˆ’1
Ïƒ
2
)
Â·
Ïƒ
2
on
C
âˆ
is
â€œalgebraic,â€
i.e.,
arises
from
a
meromorphic
function
on
E.
This
follows
immeS
diately
(cf.
the
use
of
cubical
structures
in
the
proof
of
Proposition
5.1)
from
the
fact
that
the
corresponding
line
bundle
(TÎ±âˆ—âˆ’1
L)
âŠ—
(TÎ²âˆ—âˆ’1
L)
âŠ—
(TÎ±âˆ—âˆ’1
Â·Î²
âˆ’1
L)âˆ’1
âŠ—
Lâˆ’1
(and
hence
also
its
square)
is
trivial.
On
the
other
hand,
if
we
then
take
the
logarithmic
âˆ‚
)
and
multiply
by
derivative
of
this
rational
function
(with
respect
to
the
derivation
U
âˆ‚U
1
2
Â·
d
log(U
),
we
obtain
Ï‰Î±
+
Ï‰Î²
âˆ’
Ï‰Î±Â·Î²
This
implies
(cf.
the
discussion
preceding
Theorem
2.1)
that
the
correspondence
Î±
â†’
Ï‰Î±
â€ 
deï¬nes
a
homomorphism
of
ES
into
E
.
By
the
uniqueness
statement
in
Theorem
2.1,
we
S
thus
conclude
the
following
Schottky
analogue
of
[Katz],
Theorem
C6,
(1):
81
â€ 
Theorem
5.4.
The
splitting
Îº
:
ES
â†’
E
of
Theorem
2.1
is
the
splitting
deï¬ned
by
the
S
correspondence

def

Î±
â†’
Ï‰Î±
=
TÎ±âˆ—âˆ’1
(Î¶)
âˆ’
Î¶
Â·
d
log(U
)
for
Î±
âˆˆ
ES
(S).
Next,
we
would
like
to
move
on
to
proving
the
analogue
of
the
second
part
of
Theorem
C6
of
[Katz].
First,
let
us
recall
the
exact
sequence
0
â†’
OC
â†’
TC
â†’
Ï„E
|C
â†’
0
considered
in
the
discussion
following
Corollary
4.3.
If
we
tensor
this
exact
sequence
with
Ï‰E
âŠ—OS
LâŠ—2
C
,
we
obtain
an
exact
sequence
âŠ—2
0
â†’
Ï‰E
âŠ—
LâŠ—2
C
â†’
T
â†’
LC
â†’
0
Now
let
us
recall
the
section
â€ 
Sor
:
C
âˆ’
e
â†’
âˆ’Tor
âˆ¼
=
EC
of
Corollary
4.4.
Since
this
section
has
a
pole
of
order
precisely
1
(â‰¤
2)
at
e,
it
follows
from
the
deï¬nition
of
TC
that
it
deï¬nes
a
lifting
Î¾
alg
âˆˆ
Î“(C,
T
)
alg
in
terms
of
its
components
relative
of
the
section
(Ïƒ
alg
)2
âˆˆ
Î“(E,
LâŠ—2
E
).
Now
let
us
write
Î¾
to
the
canonical
splitting
(cf.
Deï¬nition
2.3):
(Î¾[0]
Â·
Î¸,
Î¾[1]
Â·
Î¸)
âˆ‚
,
we
may
regard
Î¾[0]
as
a
function,
(Here,
by
trivializing
Ï‰E
by
means
of
the
section
U
âˆ‚U
rather
than
just
a
section
of
Ï‰E
|E
.)
Thus,
by
deï¬nition,
S
Î¾[1]
=
Ïƒ
2
We
would
like
to
compute
Î¾[0].
In
fact,
one
has
the
following:
Proposition
5.5.
We
have
Î¾[0]
=
12
(Ïƒ
2
)
.
82
Proof.
The
proof
of
the
equality
Î¾[0]
=
12
(Ïƒ
2
)
is
entirely
formally
analogous
to
the
proof
of
the
second
part
of
[Katz],
Theorem
C6.
Namely,
it
is
a
formal
consequence
of
Proposition
5.2.
Indeed,
if
Î±
âˆˆ
ES
(S)
=
Gm
(S),
then
Î¾[0]
is
the
unique
function
such
that
adding
(Ïƒ
âˆ’2
Â·
Î¾[0])(Î±)
to
the
canonical
splitting
Îº(Î±)
of
Theorem
2.1
gives
rise
to
the
splitting
Sor
(Î±)
over
Î±.
But
by
Corollary
4.4
(and
the
explicit
form
of
Sor
in
terms
of
x
and
y
reviewed
in
the
discussion
preceding
Corollary
4.4),
this
splitting
Sor
(Î±)
corresponds
to
the
meromorphic
diï¬€erential
y
+
y(Î±)
Â·
d
log(U
)
2{x
âˆ’
x(Î±)}
while
by
Theorem
5.4,
the
meromorphic
diï¬€erential
given
by
adding
(Ïƒ
âˆ’2
Â·
Î¾[0])(Î±)
to
the
canonical
splitting
Îº(Î±)
of
Theorem
2.1
is
precisely
Ï‰Î±
+
(Ïƒ
âˆ’2
Â·
Î¾[0])(Î±)
Â·
d
log(U
)
=
{Î¶(Î±âˆ’1
Â·
U
)
âˆ’
Î¶(U
)
+
Ïƒ(Î±)âˆ’2
(Î¾[0])(Î±)}
Â·
d
log(U
)
Since
y
is
an
odd
function,
while
x
is
even,
it
thus
follows
from
Proposition
5.2
that
these
two
expressions
are
equal
precisely
when
Ïƒ
âˆ’2
Â·
Î¾[0]
=
Î¶,
i.e.,
Î¾[0]
=
12
(Ïƒ
2
)
,
as
desired.

2

)
âˆ
Now
let
us
recall
that
Î¶
=
(Ïƒ
2Â·Ïƒ2
deï¬nes
a
meromorphic
function
on
CS
with
a
pole
of
order
1
at
the
origin
e.
Next,
note
that
since
the
meromorphic
splitting
Sor
is
deï¬ned
over
â€ 
CS
,
its
pull-back
to
C
âˆ
is
a
meromorphic
splitting
of
EC
|C
âˆ
over
C
âˆ
which
is
regular
S
S
S
away
from
e.
On
the
other
hand,
it
follows
from
Proposition
5.5
that
the
canonical
splitting
Îº
over
ES
is
equal
to
the
diï¬€erence
between
Sor
|E
and
Î¶
Â·
d
log(U
)|E
.
Thus,
it
follows
S
S
â€ 
âˆ
that
the
canonical
splitting
Îº
extends
to
a
meromorphic
splitting
of
EC
|C
.
S
â€ 
Next,
let
us
observe
that
the
natural
action
of
Zet
on
C
âˆ
and
EC
|C
âˆ
ï¬xes
Sor
(since
S
S
Sor
is
obtained
by
pull-back
from
CS
).
The
action
of
Zet
on
the
meromorphic
extension
over
C
âˆ
of
Îº
may
thus
be
determined
by
looking
at
the
action
of
Zet
on
the
diï¬€erence
S
between
this
meromorphic
extension
and
Sor
|C
âˆ
,
i.e.,
the
action
of
Zet
on
Î¶.
Moreover,
as
S
computed
above,
the
action
of
1et
âˆˆ
Zet
on
Î¶
is
given
by:
Î¶
â†’
Î¶
âˆ’
1
Thus,
the
action
of
1et
âˆˆ
Zet
on
the
meromorphic
extension
of
Îº
(which
is,
roughly
speaking,
just
â€œSor
âˆ’
Î¶â€)
over
C
âˆ
is
given
by:
S
Îº
â†’
Îº
+
d
log(U
)
83
In
particular,
since
we
know
that
Î¶
and
Sor
|C
âˆ
are
regular
everywhere
except
e,
while
Îº
S
is
regular
at
e
âˆˆ
ES
(S)
âŠ†
C
âˆ
(S),
we
conclude
that
the
meromorphic
extension
of
Îº
over
S
C
âˆ
is,
in
fact,
regular
over
all
of
C
âˆ
.
In
other
words,
we
have
proven
the
following:
S
S
Theorem
5.6.
The
canonical
section
Îº
of
Theorem
2.1
extends
to
a
(regular)
section
of
â€ 
EC
|C
âˆ
over
C
âˆ
.
By
abuse
of
notation,
we
also
denote
this
(unique)
extension
of
Îº
by
Îº.
S
S
The
action
of
1et
âˆˆ
Zet
on
C
âˆ
induces
the
following
action
on
Îº:
S
Îº
â†’
Îº
+
d
log(U
)
The
diï¬€erence
between
Îº
and
the
pull-back
to
C
âˆ
of
the
section
Sor
of
Corollary
4.4
is
S
def
(Ïƒ
2
)
given
by
the
function
Î¶
=
2Â·Ïƒ2
,
which
is
meromorphic
on
C
âˆ
,
and
regular
everywhere
on
S
C
âˆ
except
for
a
pole
of
order
1
on
e
(the
Zet
-orbit
of
the
origin
of
ES
).
The
action
of
S
â€ 
1et
âˆˆ
Zet
on
Î¶
is
given
by
Î¶
â†’
Î¶
âˆ’
1.
Finally,
the
section
Îº
of
EC
|C
âˆ
may
also
be
thought
S
of
(relative
to
the
isomorphism
of
Theorem
4.2)
as
(âˆ’
12
times)
the
section
associated
to
the
unique
connection
on
LâŠ—2
C
âˆ
for
which
the
section
Î¸
is
horizontal.
S
Proof.
It
remains
to
prove
the
ï¬nal
assertion
concerning
the
connection.
Let
us
denote
this
connection
by
âˆ‡.
Then
âˆ‡(Ïƒ
Â·
Î¸)
=
2
Â·
Î¶
Â·
(Ïƒ
Â·
Î¸)
Â·
d
log(U
)
Since
Ïƒ
Â·
Î¸
is
nonzero
everywhere
on
C
âˆ
except
e,
it
thus
follows
that
the
connection
âˆ‡
is
S
regular
everywhere
on
C
âˆ
,
except
possibly
at
e.
On
the
other
hand,
since
1et
(Î¸)
=
q
Â·U
2
Â·Î¸,
S
it
follows
that
1et
(âˆ‡)
=
âˆ‡
âˆ’
2;
hence
that
âˆ‡
(which
we
know
to
be
regular
at
e)
is
also
â€ 
regular
over
all
of
e,
hence
over
all
of
C
âˆ
.
Thus,
âˆ‡
deï¬nes
a
regular
section
Îºâˆ‡
of
EC
|C
âˆ
S
S
which
satisï¬es
1et
(Îºâˆ‡
)
=
Îºâˆ‡
+
1.
In
particular,
Îº
âˆ’
Îºâˆ‡
âˆˆ
Î“(C
âˆ
,
Ï‰E
|C
âˆ
)
=
Ï‰E
,
i.e.,
the
S
S
diï¬€erence
Îº
âˆ’
Îºâˆ‡
is
constant.
Now
we
consider
the
automorphism
Î±
of
C
âˆ
induced
by
S
â€œmultiplication
by
âˆ’1â€
on
E.
Note
that
since
Î±(Ïƒ
Â·
Î¸)
=
Ïƒ
Â·
Î¸,
the
above
formula
for
âˆ‡(Ïƒ
Â·
Î¸)
shows
that
Î±(âˆ‡)
=
âˆ‡.
Thus,
(since
the
isomorphism
of
Theorem
4.2
is
compatible
with
the
automorphism
Î±)
we
obtain
that
the
diï¬€erential
Îº
âˆ’
Îºâˆ‡
âˆˆ
Ï‰E
=
A
Â·
d
log(U
)
is
ï¬xed
by
Î±.
On
the
other
hand,
since
Î±(d
log(U
))
=
âˆ’d
log(U
),
this
implies
that
Îº
âˆ’
Îºâˆ‡
=
0,
as
desired.

84
Corollary
5.7.
The
canonical
section
Îº
induces
an
isomorphism:
â€ 
EC
|C
âˆ
âˆ¼
=
WS
Ã—S
C
âˆ
S
S
(where
WS
is
the
geometric
object
corresponding
to
the
line
bundle
Ï‰E
|S
on
the
formal
â€ 
â€ 
scheme
S).
Moreover,
relative
to
this
isomorphism,
the
quotient
EC
|C
âˆ
â†’
EC
is
given
by
S
the
action
of
Zet
on
W
Ã—S
C
âˆ
deï¬ned
by
taking
the
product
of
the
usual
action
of
Zet
on
S
C
âˆ
with
the
action
of
Zet
on
W
given
by
letting
1
act
as
addition
by
d
log(U
).
S
Corollary
5.8.
â€ 
The
components
(cf.
Deï¬nition
2.3)
of
any
section
âˆˆ
Î“(EC
,
LâŠ—2i
C
|
â€ )
EC
with
respect
to
the
canonical
splitting
Îº
of
Theorem
2.1
form
elements
of
RE
of
degree
i.
Remark.
Note
that
the
assertions
of
Theorem
5.6
and
Corollaries
5.7,
5.8
may
be
checked
after
inverting
6,
so
in
fact,
these
results
are
all
valid
even
if
one
does
not
invert
6.
On
the
other
hand,
as
computed
above,
modulo
q,
we
have:
Î¶â‰¡
1
1
dU
Â·
d
log(U
âˆ’
2
+
U
âˆ’1
)
=
âˆ’
d
log(U
)
2
U
âˆ’1
2
i.e.,
Î¶
itself
fails
to
be
integral
at
the
prime
2.
Since
the
sections
Îº
(cf.
Theorem
2.1)
and
Sor
(cf.
the
discussion
preceding
Corollary
4.4)
are
integral
at
2,
and
Î¶
is
precisely
the
diï¬€erence
between
these
two
sections
relative
to
the
isomorphism
of
Theorem
4.2,
it
thus
â€ 
follows
that
the
isomorphism
between
EC
â†’
C
and
âˆ’Tor
â†’
C
(cf.
Theorem
4.2)
is
not
integral
at
2.
Finally,
before
proceeding,
we
apply
the
theory
developed
thus
far
to
obtain
explicit
information
concerning
liftings
of
torsion
points
of
E
to
E
â€ 
(cf.
Remark
1
following
Deï¬nition
3.2).
First,
observe
that
since
ES
is
essentially
obtained
by
dividing
Gm
by
the
action
of
Zet
obtained
by
multiplying
Gm
powers
of
the
period
q,
it
follows
that
the
inverse
images
of
the
torsion
points
of
ES
in
C
âˆ
are
the
points
the
form:
S
Î±
Â·
q
Î²
âˆˆ
Gm
(A[qÎ²
,
q
âˆ’1
])
=
C
âˆ
(A[qÎ²
])
=
C
âˆ
(A[qÎ²
])
S
where
â€œGm
(âˆ¼
[q
âˆ’1
])
=
C
âˆ
(âˆ¼)â€
follows
from
the
â€œNeÌron
model-likeâ€
property
of
C
âˆ
,
referred
to
earlier;
Î±
is
a
root
of
unity
âˆˆ
A;
and
Î²
âˆˆ
Q.
On
the
other
hand,
by
Corollary
â€ 
5.7,
E
is
essentially
obtained
by
dividing
the
abelian
object
by
W
Ã—
Gm
by
the
action
S
of
Zet
obtained
by
adding/multiplying
multiples
of
the
element
(d
log(U
),
q).
We
thus
conclude
the
following:
85
Corollary
5.9.
Relative
to
the
isomorphism
â€ 
EC
|C
âˆ
âˆ¼
=
WS
Ã—S
C
âˆ
S
S
of
Corollary
5.7,
the
inverse
images
of
the
torsion
points
of
E
â€ 
are
precisely
the
points
whose
coordinates
(on
the
right-hand
side
of
the
above
isomorphism)
are
given
by
(Î²
Â·
d
log(U
),
Î±
Â·
q
Î²
)
where
Î±
is
a
root
of
unity
âˆˆ
AÃ—
;
and
Î²
âˆˆ
Q.
Thus,
in
particular,
torsion
points
of
order
N
will,
in
general,
have
coordinates
with
denominator
N
.
Â§6.
Higher
Schottky-Weierstrass
Zeta
Functions
In
this
Â§,
we
deï¬ne
a
new
integral
structure
on
the
universal
extension
of
a
degenerating
elliptic
curve
at
ï¬nite
primes.
Using
this
new
integral
structure,
we
construct
â€œhigherâ€
analogues
of
the
Schottky-Weierstrass
zeta
function
considered
in
Â§5.
These
higher
Schottky-Weierstrass
zeta
functions
(together
with
their
twisted
analogues,
to
be
discussed
in
Chapter
IV)
will
play
a
fundamental
role
in
this
paper.
We
work
with
the
notation
of
Â§5.
Thus,
let
O
be
a
Zariski
localization
of
OK
,
where
K
is
a
ï¬nite
extension
of
Q.
Let
def
A
=
O[[q]];
def
S
=
Spec(A)
Then
we
have
a
one-dimensional
semi-abelian
scheme
Eâ†’S
over
S.
Roughly
speaking,
one
may
think
of
E
as
being
â€œGm
/q
Z
.â€
More
rigorously,
E
may
be
compactiï¬ed
to
a
log
elliptic
curve
C
log
â†’
S
log
.
Moreover,
CS
(the
result
of
base
changing
C
to
the
q-adic
completion
S
of
S)
may
be
written
as
CS
=
C
âˆ
/Zet
S
Next,
let
us
recall
the
contents
of
Theorem
5.6,
and
its
corollaries.
First
of
all,
the
universal
extension
E
â€ 
â†’
E
of
E
extends
naturally
(cf.
Corollary
4.3)
to
a
WE
-torsor
86
â€ 
EC
â†’
C.
(Here,
WE
â†’
S
is
the
geometric
line
bundle
deï¬ned
by
the
invertible
sheaf
Ï‰E
on
S,
i.e.,
it
is
the
object
denoted
â€œW
â€
in
Â§2.)
Then
Theorem
5.6,
Corollary
5.9
state
that
we
have
a
natural
isomorphism
â€ 
EC
|C
âˆ
âˆ¼
=
(WE
)S
Ã—S
C
âˆ
S
S
â€ 
â€ 
relative
to
which
the
quotient
EC
|C
âˆ
â†’
EC
of
the
left-hand
side
corresponds
to
the
S
quotient
by
the
subgroup
generated
by
(d
log(U
),
q)
â€ 
on
the
right-hand
side.
In
the
following,
we
shall
identify
EC
|C
âˆ
with
(WE
)S
Ã—S
C
âˆ
via
S
S
this
isomorphism.
Moreover,
(to
simplify
the
notation)
we
shall
trivialize
Ï‰E
by
means
of
the
section
d
log(U
).
Thus,
we
may
write
WE
=
Spec(OS
[T
])
(where
T
is
the
indeterminate
corresponding
to
the
chosen
trivialization
of
Ï‰E
).
Next,
let
us
write
(for
n
âˆˆ
Zâ‰¥0
)
def
T
[n]
=
1
T
(T
âˆ’
1)(T
âˆ’
2)
Â·
.
.
.
Â·
(T
âˆ’
(n
âˆ’
1))
n!
def
which
we
think
of
as
a
section
of
OWE
âŠ—
Q.
For
negative
n,
we
let
T
[n]
=
0.
Thus,
we
have
T
[0]
=
1;
T
[1]
=
T
;
T
[2]
=
1
T
(T
âˆ’
1)
2
Also,
if
f
(T
)
is
a
section
of
OWE
âŠ—
Q,
let
us
write
f
(T
+
n)
for
the
result
of
applying
to
f
(T
)
the
automorphism
of
WE
induced
by
net
âˆˆ
Zet
,
i.e.,
the
automorphism
deï¬ned
by
T
â†’
T
+
n.
Thus,
in
particular,
we
may
deï¬ne:
def
Î´(f
)
=
f
(T
+
1)
âˆ’
f
(T
)
Then
we
have
Î´(T
[n]
)
=
T
[nâˆ’1]
Now
we
are
ready
to
deï¬ne
new
integral
structures.
First
of
all,
let
us
write
87
R
â€ 
EC
|C
âˆ
S
â€ 
for
the
push-forward
via
EC
|C
âˆ
â†’
C
âˆ
of
the
structure
sheaf
O
â€ 
S
S
EC
|C
âˆ
.
Then
we
would
S
like
to
deï¬ne
a
new
integral
structure
on
R
â€ 
EC
|C
âˆ
âŠ—
Q
as
follows:
By
the
above
discussion,
S
the
sheaf
of
algebras
R
â€ 
EC
|C
âˆ
on
C
âˆ
may
be
identiï¬ed
with
S
S
OC
âˆ
âŠ—OS
OS
[T
]
=
OC
âˆ
âŠ—OS
S

S
OS
Â·
T
n

nâ‰¥0
Then
the
new
integral
structure
will
be
given
by
the
sheaf
OC
âˆ
âŠ—OS

S
OS
Â·
T
[n]

nâ‰¥0
Let
us
denote
by
Retâ€ 
EC
|C
âˆ
âŠ†R
â€ 
EC
|C
âˆ
S
S
the
corresponding
subsheaf
of
R
â€ 
EC
|C
âˆ
âŠ—Q
âŠ—
Q.
Note
that
Retâ€ 
has
a
natural
ï¬ltration
EC
|C
âˆ
S
S
.
.
.
âŠ†
F
n
(Retâ€ 
EC
|C
âˆ
)
âŠ†
.
.
.
âŠ†
Retâ€ 
EC
|C
âˆ
S
S
whose
n-th
member
is
given
by
the
polynomials
of
degree
<
n.
Thus,
F
n
(Retâ€ 
)
is
a
EC
|C
âˆ
S
vector
bundle
on
C
âˆ
of
rank
n
such
that
we
have
a
natural
identiï¬cation
S
(F
n+1
/F
n
)(Retâ€ 
)=
EC
|C
âˆ
1
Â·
OC
âˆ
âŠ—OS
Ï„EâŠ—n
n!
S
S
Moreover,
let
us
observe
that
the
ï¬ltered
OC
âˆ
-submodule
Retâ€ 
S
EC
|C
âˆ
S
preserved
by
the
natural
action
of
Zet
on
C
âˆ
.
S
88
âŠ†
R
â€ 
EC
|C
âˆ
âŠ—
Q
is
S
def
Indeed,
1et
âˆˆ
Zet
maps
f
(T
)
=
T
[n]
to
f
(T
+
1)
=
f
(T
)
+
Î´(f
)
=
f
(T
)
+
T
[nâˆ’1]
.
Since
T
[nâˆ’1]
also
forms
a
section
of
Retâ€ 
,
and
EC
|C
âˆ
S
Retâ€ 
EC
|C
âˆ
is
an
OC
âˆ
-module
(hence
closed
under
addition),
we
thus
conclude
that
Retâ€ 
EC
|C
âˆ
S
S
S
(as
well
as
its
ï¬ltration)
is
stabilized
by
the
action
of
Zet
,
as
desired.
We
summarize
this
as
follows:
Proposition
6.1.
The
OC
âˆ
-submodules
S
.
.
.
âŠ†
F
n
(Retâ€ 
EC
|C
âˆ
)
âŠ†
.
.
.
âŠ†
Retâ€ 
EC
|C
âˆ
S
âŠ†R
â€ 
EC
|C
âˆ
âŠ—Q
S
S
are
all
preserved
by
the
natural
action
of
Zet
.
Thus,
they
descend
to
form
natural
OC
submodules
.
.
.
âŠ†
F
n
(Retâ€ 
)
âŠ†
.
.
.
âŠ†
Retâ€ 
âŠ†
R
â€ 
âŠ—
Q
EC
EC
EC
where
the
subsheaf
F
n
(Retâ€ 
)
of
the
ï¬ltration
is
a
rank
n
vector
bundle
on
C
such
that
EC
1
(F
n+1
/F
n
)(Retâ€ 
)
=
n!
Â·
OC
âŠ—OS
Ï„EâŠ—n
.
EC
Proof.
It
remains
only
to
check
that
the
various
sheaves
that
were
constructed
on
C
âˆ
do
S
indeed
descend
to
C.
That
is
to
say,
since
the
covering
C
âˆ
â†’
CS
is
inï¬nite,
the
reader
S
may
fear
that
one
cannot
immediately
apply
the
usual
machinery
of
eÌtale
descent.
In
fact,
however,
this
is
not
a
problem
since
CS
admits
a
(ï¬nite)
Zariski
open
cover
{U
}
(in
the
category
of
formal
S-schemes)
such
that
over
each
U
,
the
covering
C
âˆ
â†’
CS
splits.
Thus,
S
there
is
no
problem
with
descent.

Deï¬nition
6.2.
The
integral
structures
denoted
by
a
superscript
â€œetâ€
will
be
referred
to
as
eÌtale-integral,
or
et-integral,
structures.
That
is
to
say,
â€œetâ€
stands
for
â€œeÌtale,â€
and
is
the
same
as
the
â€œetâ€
in
Zet
.
In
particular,
the
â€œeÌtale-integral
structureâ€
may
be
thought
of
as
the
integral
structure
arising
from
thinking
of
algebraic
functions
on
the
universal
extension
as
set-theoretic
functions
on
Zet
,
i.e.,
on
the
ï¬bers
of
the
inï¬nite
eÌtale
covering
C
âˆ
â†’
C
âˆ
/Zet
=
CS
.
S
S
The
original
integral
structure
on
the
various
â€œRâ€™sâ€
(i.e.,
the
integral
structures
without
a
label)
will
be
referred
to
as
the
de
Rham-integral,
or
DR-integral,
structures.
This
is
because
they
arise
from
the
original
natural
integral
structures
on
the
universal
extension
Ã—
1
E
â€ 
as
a
sort
of
de
Rham
cohomology
â€“
i.e.,
â€œHDR
(E,
OE
)â€
â€“
associated
to
E.
89
Now
we
are
ready
to
begin
the
construction
of
the
higher
Schottky-Weierstrass
zeta
functions.
In
the
following,
we
shall
refer
to
polynomials
Ï†r
T
[r]
+
Ï†râˆ’1
T
[râˆ’1]
+
.
.
.
+
Ï†0
(where
r
is
a
natural
number)
whose
coeï¬ƒcients
Ï†0
,
.
.
.
,
Ï†r
are
meromorphic
functions
on
C
âˆ
as
extension
polynomials.
One
may
also
think
of
extension
polynomials
as
meromorS
phic
sections
of
Retâ€ 
over
C
âˆ
.
We
would
like
to
consider
those
extension
polynomials
EC
S
which
are
invariant
under
the
natural
action
of
Zet
,
i.e.,
which
descend
to
CS
.
Note
that
since
all
OC
-torsors
on
CS
split
as
soon
as
one
allows
a
pole
of
order
1
at
the
origin
e,
it
S
follows
that
there
exist
Zet
-invariant
extension
polynomials
of
the
form:
T
[r]
+
Ï†râˆ’1
T
[râˆ’1]
+
.
.
.
+
Ï†0
where
Ï†0
,
.
.
.
,
Ï†râˆ’1
are
meromorphic
on
C
âˆ
,
regular
away
from
e
(the
Zet
-orbit
of
the
S
origin),
and
have
a
pole
of
order
at
most
1
at
the
points
of
e.
For
instance,
the
most
basic
example
(in
the
case
where
2
âˆˆ
O
Ã—
)
of
such
a
polynomial
is
the
polynomial
T
+Î¶
(where
Î¶
is
as
in
Â§5)
studied
in
Â§5.
Note
that
whereas
1et
âˆˆ
Zet
acts
on
T
by
T
â†’
T
+
1
it
acts
on
Î¶
by
Î¶
â†’
Î¶
âˆ’
1.
Thus,
T
+
Î¶
is
indeed
Zet
-invariant.
In
the
following,
we
would
like
to
study
the
case
of
arbitrary
r
â‰¥
1.
First,
let
us
introduce
some
notation:
If
f
is
an
extension
polynomial,
then
let
us
denote
the
result
of
acting
on
f
by
1et
âˆˆ
Zet
by
means
of
the
notation
Î±(f
).
Let
def
Î´(f
)
=
Î±(f
)
âˆ’
f
This
extends
the
deï¬nition
of
Î´
given
in
the
discussion
preceding
Proposition
1.1
(i.e.,
the
case
of
extension
polynomials
with
constant
coeï¬ƒcients).
Also,
if
f
and
g
are
extension
polynomials,
then
we
have
Î´(f
Â·
g)
=
Î´(f
)
Â·
Î±(g)
+
f
Â·
Î´(g)
Thus,
to
say
that
90
f=
n

Ï†nâˆ’i
Â·
T
[i]
i=0
is
Zet
-invariant
means
precisely
that
Î´(f
)
=
n

Î´(Ï†nâˆ’i
)(T
[i]
+
T
[iâˆ’1]
)
+
Ï†nâˆ’i
Â·
T
[iâˆ’1]
=
0
i=0
i.e.,
that
for
all
i,
Î´(Ï†nâˆ’i
)
+
Î´(Ï†nâˆ’iâˆ’1
)
+
Ï†nâˆ’iâˆ’1
=
0
def
(where
we
let
Ï†j
=
0
for
j
<
0,
j
>
n).
Thus,
we
obtain
the
following:
Lemma
6.3.
Let
n
be
a
nonnegative
integer.
Suppose
that
f=
n

Ï†nâˆ’i
Â·
T
[i]
i=0
is
a
Zet
-invariant
extension
polynomial
such
that
Ï†0
=
1;
and
all
the
Ï†j
â€™s
are
meromorphic
functions
on
C
âˆ
which
are
regular
away
from
e
(the
Zet
-orbit
of
the
origin),
and
have
a
S
pole
of
order
at
most
1
at
the
points
of
e.
Then
there
exists
a
Zet
-invariant
extension
polynomial
g=
n+1

Ïˆn+1âˆ’i
Â·
T
[i]
i=0
such
that
Ï†j
=
Ïˆj
for
0
â‰¤
j
â‰¤
n;
and
Ïˆn+1
is
a
meromorphic
function
on
C
âˆ
which
is
S
regular
away
from
e
(the
Zet
-orbit
of
the
origin),
and
has
a
pole
of
order
at
most
1
at
the
points
of
e.
Proof.
First
note
that,
since
for
0
â‰¤
j
â‰¤
n,
the
invariance
condition
discussed
above
(i.e.,
â€œÎ´(Ï†nâˆ’i
)
+
Î´(Ï†nâˆ’iâˆ’1
)
+
Ï†nâˆ’iâˆ’1
=
0â€)
on
the
Ï†j
â€™s
is
precisely
the
same
as
the
invariance
condition
on
the
Ïˆj
â€™s,
it
thus
follows
that
?Â·T
[0]
+
n+1

Ï†n+1âˆ’i
Â·
T
[i]
i=1
91
deï¬nes
a
Zet
-invariant
section
of
the
sheaf
of
extension
polynomials
modulo
constant
terms
on
C
âˆ
.
Moreover,
since
H
1
(CS
,
OC
(e))
=
0,
it
thus
follows
that
as
long
as
we
allow
a
S
S
pole
of
order
1
at
e,
this
section
lifts
to
a
Zet
-invariant
extension
polynomial
g=
n+1

Ïˆn+1âˆ’i
Â·
T
[i]
i=0
(where
Ïˆj
=
Ï†j
for
j
=
0,
.
.
.
,
n,
and
Ïˆn+1
has
the
desired
properties).
This
completes
the
proof.

Theorem
6.4.
Let
n
be
a
nonnegative
integer.
Then
there
exists
a
Zet
-invariant
extension
polynomial
f=
n

Î¶nâˆ’i
Â·
T
[i]
i=0
such
that
Î¶0
=
1;
Î´(Î¶nâˆ’i
)
+
Î´(Î¶nâˆ’iâˆ’1
)
+
Î¶nâˆ’iâˆ’1
=
0
(for
all
i);
and
all
the
Î¶j
â€™s
are
meromorphic
functions
on
C
âˆ
which
are
regular
away
from
S
e
(the
Zet
-orbit
of
the
origin),
and
have
a
pole
of
order
at
most
1
at
the
points
of
e.
In
particular,
we
have
Î´(Î¶j
)
=
âˆ’Î¶jâˆ’1
+
Î¶jâˆ’2
âˆ’
...
+
(âˆ’1)jâˆ’1
Î¶1
+
(âˆ’1)j
Î¶0
(for
all
j).
Finally,
if
Î¶0
,
.
.
.
,
Î¶n
satisfy
the
same
conditions
as
Î¶0
,
.
.
.
,
Î¶n
,
then
for
each
j
=
0,
.
.
.
,
n,
Î¶j
âˆ’
Î¶j
=
some
Aâˆ’linear
combination
of
Î¶0
,
.
.
.
,
Î¶jâˆ’1
(where
A
=
O[[q]]).
Proof.
The
existence
of
Î¶0
,
.
.
.
,
Î¶n
as
stated
follows
by
successively
applying
Lemma
6.3,
starting
with
the
extension
polynomial
1
(in
the
case
r
=
0).
The
second
formula
for
Î´(Î¶j
)
follows
by
induction
on
j
from
the
ï¬rst
formula
Î´(Î¶nâˆ’i
)
+
Î´(Î¶nâˆ’iâˆ’1
)
+
Î¶nâˆ’iâˆ’1
=
0.
Thus,
it
remains
to
see
what
happens
if
Î¶0
,
.
.
.
,
Î¶n
satisfy
the
same
conditions
as
Î¶0
,
.
.
.
,
Î¶n
.
We
prove
that
Î¶j
âˆ’
Î¶j
is
an
A-linear
combination
of
Î¶0
,
.
.
.
,
Î¶jâˆ’1
by
induction
92
on
j.
This
is
clear
for
j
=
0
since,
by
assumption,
Î¶0
=
Î¶0
=
1.
Now
observe
that,
by
the
induction
hypothesis,
both
Î´(Î¶j
)
=
âˆ’Î¶jâˆ’1
+
Î¶jâˆ’2
âˆ’
...
+
(âˆ’1)jâˆ’1
Î¶1
+
(âˆ’1)j
Î¶0
and
Î´(Î¶j
)
=
âˆ’Î¶jâˆ’1
+
Î¶jâˆ’2
âˆ’
...
+
(âˆ’1)jâˆ’1
Î¶1
+
(âˆ’1)j
Î¶0
are
of
the
form
â€œâˆ’Î¶jâˆ’1
plus
an
A-linear
combination
of
Î¶0
,
.
.
.
,
Î¶jâˆ’2
.â€
Thus,
by
repeated
application
of
the
formula
Î´(Î¶l
)
=
âˆ’Î¶lâˆ’1
+
Î¶lâˆ’2
âˆ’
...
+
(âˆ’1)lâˆ’1
Î¶1
+
(âˆ’1)l
Î¶0
for
l
â‰¤
j
âˆ’
1,
it
follows
that
there
exists
some
Î³
=
Î¶j
+
Î·
where
Î·
is
an
A-linear
combination
of
Î¶0
,
.
.
.
,
Î¶jâˆ’1
,
and,
moreover,
Î´(Î³)
=
Î´(Î¶j
)
def
In
particular,
it
follows
that
=
Î³
âˆ’
Î¶j
is
a
meromorphic
function
on
C
âˆ
which
is
regular
S
away
from
e,
has
a
pole
of
order
â‰¤
1
at
the
points
of
e,
and,
moreover,
satisï¬es
Î´(
)
=
0,
i.e.,
is
Zet
-invariant.
But
this
implies
that
arises
from
a
meromorphic
function
on
CS
which
is
regular
away
from
the
origin,
where
it
has
a
pole
of
order
â‰¤
1.
In
other
words,
this
meromorphic
function
on
CS
forms
a
regular
section
of
OC
(e)
over
CS
.
But
it
follows
S
from
Riemann-Roch
that
such
a
function
must
be
constant,
i.e.,
âˆˆ
A.
Thus,
=
Î³
âˆ’
Î¶j
âˆˆ
A.
This
completes
the
proof.

Remark
1.
Note
that
the
Î¶j
â€™s
of
Theorem
6.4
are
not
uniquely
deï¬ned
(except
for
j
=
0).
Nevertheless,
we
shall
often
refer
to
these
Î¶j
â€™s,
which
are
useful
for
explicit
computations,
as
higher
Schottky-Weierstrass
Î¶-functions.
Also,
we
observe
that
if
2
âˆˆ
O
Ã—
,
then
the
function
Î¶
of
Â§5
serves
as
a
â€œÎ¶1
â€
in
Theorem
6.4.
Remark
2.
By
using
the
Gm
-splitting
discussed
in
Â§3,
one
may
also
construct
complex
analytic
Schottky-Weierstrass
Î¶-functions,
as
follows.
Namely,
just
as
in
Â§5,
we
may
form
the
complex
analytic
Schottky-Weierstrass
Î¶-function
Î¶
93
by
taking
the
diï¬€erence
between
the
Gm
-splitting
of
Â§3
and
the
meromorphic
splitting
Sor
of
Corollary
4.4.
This
function
is
meromorphic
on
Gm
(in
the
usual
sense
of
complex
analysis),
regular
away
from
q
Z
âŠ†
Gm
,
and
satisï¬es
(relative
to
the
notation
in
the
discussion
of
the
Gm
-splitting
in
Â§3)
the
relation
Î¶(q
Â·
U
)
=
Î¶(U
)
âˆ’
1
(where
U
is
the
standard
multiplicative
coordinate
on
Gm
).
Indeed,
to
check
that
this
relation
is
satisï¬ed,
it
suï¬ƒces
(since
all
the
functions
involved
depend
meromorphically
on
q
and
U
)
to
check
it
as
q
â†’
0.
But
this
case
is
precisely
the
case
where
one
is
working
near
the
point
at
inï¬nity
of
M1,0
(C),
i.e.,
the
case
discussed
in
Â§5.
Thus,
by
regarding
the
various
algebraic
and
formal
algebraic
functions
of
Â§5
as
complex
analytic
functions,
we
see
that
this
relation
follows
from
the
corresponding
formal
algebraic
relation
proven
in
Theorem
5.6.
Finally,
by
performing
exactly
the
same
formal
operations
that
we
have
done
in
the
present
Â§,
but
this
time
in
the
complex
analytic
category,
we
also
obtain
complex
analytic
higher
Schottky-Weierstrass
Î¶-functions
Î¶0
,
.
.
.
,
Î¶n
as
in
Theorem
6.4.
Â§7.
Canonical
Schottky-Weierstrass
Zeta
Functions
In
this
Â§,
we
continue
the
discussion
of
higher
Schottky-Weierstrass
zeta
functions
begun
in
Â§6.
The
purpose
of
the
present
Â§
is
to
construct
two
collections
of
canonical
higher
Schottky-Weierstrass
zeta
functions
by
means
of
various
diï¬€erential
operators
acting
on
the
line
bundle
under
consideration.
The
ï¬rst
type
of
canonical
zeta
function,
which
we
refer
to
as
divided
power
canonical
zeta
functions,
is
the
most
basic
type
of
canonical
zeta
function.
These
divided
power
canonical
zeta
functions
do
not
satisfy
quite
the
same
relations
(concerning
the
operator
Î´)
as
the
functions
of
Theorem
6.4
(although
they
do
satisfy
certain
relations
similar
to
the
relations
in
Theorem
6.4),
and,
moreover,
are
not
integral,
i.e.,
are
only
deï¬ned
over
Q.
The
second
type
of
canonical
zeta
function,
which
we
refer
to
as
binomial,
is
of
the
sort
considered
in
Theorem
6.4,
and,
moreover,
is
integral
except
at
the
prime
2.
Both
the
divided
power
and
binomial
canonical
zeta
functions
of
the
present
Â§
(as
well
as
various
other
types,
to
be
introduced
later)
play
an
important
role
in
the
theory
of
this
paper
(cf.,
especially,
Chapter
V,
Â§4;
Chapter
VII;
Chapter
VIII).
We
maintain
the
notation
of
Â§6,
except
that
in
this
Â§,
we
assume,
until
mentioned
otherwise,
that
O
is
a
number
ï¬eld.
In
particular,
O
âŠ‡
Q.
As
usual,
we
will
write
LC
âˆ
=
OC
âˆ
(e)
S
S
94
def
where
e
=
Zet
(e)
âŠ†
C
âˆ
.
Note
that
Zet
acts
on
the
global
sections
of
LC
âˆ
over
C
âˆ
.
S
S
S
Thus,
in
particular,
the
operator
Î´
of
Â§6
deï¬ned
by
def
Î´(f
)
=
1et
(f
)
âˆ’
f
acts
on
Î“(C
âˆ
,
LC
âˆ
).
Just
as
in
Â§6,
we
would
like
to
study
sections
of
LC
âˆ
over
C
âˆ
which
S
S
S
S
satisfy
certain
properties
with
respect
to
the
operator
Î´.
Next,
let
us
observe
that
we
also
have
another
operator
on
sections
of
LC
âˆ
given
by
S
the
connection
âˆ‡
on
LC
âˆ
deï¬ned
by
the
canonical
section
âˆ’Îº
(cf.
Theorem
5.6).
That
S
is
to
say,
by
Theorem
5.6,
âˆ’2
Â·
Îº
determines
a
connection
on
LâŠ—2
C
âˆ
,
so
âˆ’Îº
determines
a
S
connection
on
LC
âˆ
which
is
deï¬ned
whenever
2
âˆˆ
O
Ã—
(as
is
the
case
here).
Let
us
denote
S
âˆ‚
the
operator
on
sections
of
LC
âˆ
given
by
applying
the
connection
âˆ‡
in
the
direction
U
âˆ‚U
S
by
f
â†’
Î´
âˆ—
(f
)
=
âˆ‡(U
âˆ‚
)
(f
)
def
âˆ‚U
Note
that
since
(cf.
Theorem
5.6),
1et
(Îº)
=
Îº
+
d
log(U
),
we
obtain
that
1et
(âˆ‡)
=
âˆ‡
âˆ’
d
log(U
).
Thus,
1et
(Î´
âˆ—
)
=
Î´
âˆ—
âˆ’
1
(i.e.,
1et
(Î´
âˆ—
(f
))
=
Î´
âˆ—
(1et
(f
))
âˆ’
1et
(f
)),
so
we
obtain:
[Î´
âˆ—
,
Î´](f
)
=
[Î´
âˆ—
,
1et
](f
)
=
Î´
âˆ—
(1et
(f
))
âˆ’
1et
(Î´
âˆ—
(f
))
=
1et
(f
)
i.e.,
[Î´
âˆ—
,
Î´]
=
1et
.
Roughly
speaking,
It
is
natural
to
think
of
Î´
âˆ—
as
â€œdiï¬€erentiation
âˆ‚
with
respect
to
the
holomorphic
variableâ€
and
Î´
as
â€œdiï¬€erentiation
âˆ‚
with
respect
to
the
antiholomorphic
variable.â€
Alternatively,
one
may
think
of
the
operator
Î´
âˆ—
as
a
sort
of
adjoint
to
the
operator
Î´.
This
point
of
view
is
motivated
by
the
complex
analytic
theory,
which
we
will
discuss
in
more
detail
in
Chapter
VII,
Â§4.
Next,
let
us
observe
that
if
we
let
Î¶0PD
âˆˆ
Î“(C
âˆ
,
LC
âˆ
)
be
the
section
deï¬ned
by
â€œ1
âˆˆ
O
S
Câˆ
(e),â€
then
it
follows
from
Theorem
5.6
that
S
S
Î´
âˆ—
(Î¶0PD
)
=
Î¶1
(where
Î¶1
is
as
in
Â§5).
Thus,
it
is
natural
to
set
(for
any
integer
n
â‰¥
0)
95
def
Î¶nPD
=
1
âˆ—
n
PD
(Î´
)
Î¶0
n!
Here,
â€œPDâ€
stands
for
â€œpuissances
diviseÌsâ€
(i.e.,
â€œdivided
powersâ€
in
French).
Just
as
was
the
case
with
the
higher
Schottky-Weierstrass
zeta
functions
of
Theorem
6.4,
the
canonical
Schottky-Weierstrass
zeta
functions
ï¬t
together
to
form
â€œZet
-invariant
extension
polynomialsâ€
as
follows:
First,
observe
that
in
the
above
discussion,
we
worked
with
various
functions/sections
of
line
bundles
over
C
âˆ
.
In
order
to
obtain
Zet
-invariant
S
â€ 
extension
polynomials,
we
must
instead
work
with
objects
over
EC
|C
âˆ
.
Recall
that
by
S
â€ 
Corollary
5.7,
EC
|C
âˆ
â†’
C
âˆ
admits
a
natural
splitting
which
allows
us
to
regard
the
S
S
push-forward
of
O
â€ 
to
C
âˆ
as
the
OC
âˆ
-algebra
S
E
|
âˆ
S
C
C
S
OC
âˆ
[T
]
S
(cf.
the
discussion
at
the
beginning
of
Â§6).
Note
that
by
Theorem
4.2
(which
we
are
at
liberty
to
apply
since
here,
we
are
working
in
characteristic
zero),
the
pull-back
to
â€ 
EC
|C
âˆ
of
the
line
bundle
LC
admits
a
tautological
connection
âˆ‡taut
.
Here,
just
as
in
the
S
above
discussion
involving
âˆ‡,
we
use
the
notation
â€œ(Î´
taut
)âˆ—
â€
for
the
tautological
connection
âˆ‚
âˆ‡taut
applied
in
the
direction
U
âˆ‚U
.
Since
the
natural
isomorphism
of
Corollary
5.7
is
an
isomorphism
of
WS
-torsors,
it
follows
easily
from
the
deï¬nitions
that,
relative
to
the
connection
âˆ‡
considered
above
(arising
from
âˆ’Îº),
we
have:
(Î´
taut
)âˆ—
=
Î´
âˆ—
+
T
â€ 
Note
that
unlike
Î´
âˆ—
,
the
operator
(Î´
taut
)âˆ—
descends
(since
it
is
â€œtautologicalâ€)
to
EC
,
hence
is
Zet
-invariant.
Now
we
have
the
following
result:
Lemma
7.1.
We
have
(for
n
â‰¥
0):
PD
(i)
Î´
âˆ—
(Î¶nPD
)
=
(n
+
1)
Â·
Î¶n+1
;
def
n
i=0
(ii)
Î¶nPD
[T
]
=
(iii)
Î´(Î¶nPD
)
=
nâˆ’i
T
Î¶iPD
Â·
(nâˆ’i)!
is
Zet
-invariant.
nâˆ’1
1
1
i+n
PD
PD
PD
=
âˆ’Î¶nâˆ’1
+
12
Â·
Î¶nâˆ’2
+
.
.
.
+
(âˆ’1)n
Â·
n!
Â·
Î¶0PD
.
i=0
(âˆ’1)
(nâˆ’i)!
Î¶i
In
particular,
Î´
n
(Î¶nPD
)
=
(âˆ’1)n
Â·
Î¶0PD
.
Proof.
First,
we
observe
that:
(i)
follows
immediately
from
the
deï¬nition
of
Î¶nPD
;
(iii)
follows
from
the
Zet
-invariance
of
(ii)
by
evaluating
the
expression
of
(ii)
at
â€œU
â€
equals
96
q
Â·U
,
â€œT
â€
equals
0
(which
yields
1et
(Î¶nPD
)),
and
noting
that
this
is
equal
to
the
expression
of
i+n
n
PD
(ii)
at
â€œU
â€
equals
U
,
â€œT
â€
equals
âˆ’1
(which
yields
i=0
(âˆ’1)
(nâˆ’i)!
Â·
Î¶i
).
Thus,
it
suï¬ƒces
to
prove
(ii).
But
(ii)
follows
from
the
Zet
-invariance
of
(Î´
taut
)âˆ—
:
Indeed,
since
[
Î´
âˆ—
,
T
]
=
0,
1
if
we
apply
n!
Â·
((Î´
taut
)âˆ—
)n
to
Î¶0PD
(which
is
clearly
Zet
-invariant),
we
obtain:
n


1

n
1
taut
âˆ—
n
PD
)
)
(Î¶0
)
=
Â·
((Î´
Â·
(Î´
âˆ—
)i
(Î¶0PD
)
Â·
T
nâˆ’i
n!
n!
i=0
i
=
n

Î¶iPD
Â·
i=0
T
nâˆ’i
(n
âˆ’
i)!
as
desired.

Any
Ï†
âˆˆ
Î“(C
âˆ
,
LC
âˆ
)
such
that
Î´
n+1
(Ï†)
=
0
for
some
nonnegative
Lemma
7.2.
S
S
integer
n
may
be
written
as
a
unique
A-linear
combination
of
Î¶0PD
,
.
.
.
,
Î¶nPD
.
In
particular,
Î¶0PD
,
.
.
.
,
Î¶nPD
are
linearly
independent
over
A.
Proof.
This
follows
by
induction
on
n.
It
is
clear
when
n
=
0
(since
Î“(C,
LC
)
(âŠ†
Î“(C
âˆ
,
LC
âˆ
))
is
a
free
A-module
of
rank
1
generated
by
Î¶0PD
).
For
arbitrary
n
â‰¥
1,
S
n+1
S
if
Î´
(Ï†)
=
0,
then
by
the
induction
hypothesis,
Î´(Ï†)
may
be
written
as
an
A-linear
nâˆ’1
combination
i=0
ci
Â·
Î¶iPD
.
Thus,
by
Lemma
7.1,
it
follows
that
for
some
appropriate
nâˆ’1
PD
ci
âˆˆ
A,
the
function
Ï†
âˆ’
i=0
ci
Â·
Î¶i+1
is
contained
in
the
kernel
of
Î´,
hence
can
be
written
PD
as
an
A-multiple
of
Î¶0
,
as
desired.
Linear
independence
follows
similarly
by
applying
Î´,
using
the
induction
hypothesis
and
Lemma
7.1.

Deï¬nition
7.3.
We
shall
refer
the
functions
Î¶nPD
âˆˆ
Î“(C
âˆ
,
LC
âˆ
)
as
divided
power
(canonS
ical
Schottky-Weierstrass)
zeta
functions.
S
Thus,
putting
everything
together,
we
see
that
we
have
proven
the
following
result:
Theorem
7.4.
(Divided
Power
Canonical
Schottky-Weierstrass
Functions)
Let
Î¶0PD
âˆˆ
Î“(C
âˆ
,
LC
âˆ
)
be
the
function
â€œ1â€
âˆˆ
OC
âˆ
(e).
Write
(for
n
âˆˆ
Zâ‰¥0
)
S
S
S
def
Î¶nPD
=
1
âˆ—
n
PD
(Î´
)
Î¶0
n!
def
(and
let
Î¶nPD
=
0
if
n
<
0).
(Thus,
in
particular,
the
function
Î¶1PD
here
is
the
same
as
the
PD
function
â€œÎ¶1
â€
of
Theorem
5.6.)
Then
Î´
âˆ—
(Î¶nPD
)
=
(n
+
1)
Â·
Î¶n+1
,
Î´
n
(Î¶nPD
)
=
(âˆ’1)n
Â·
Î¶0PD
(if
n
â‰¥
0);
97
Î´(Î¶nPD
)
=
nâˆ’1
1
1
i+n
PD
PD
PD
=
âˆ’Î¶nâˆ’1
+
12
Â·
Î¶nâˆ’2
+
.
.
.
+
(âˆ’1)n
Â·
n!
Â·
Î¶0PD
i=0
(âˆ’1)
(nâˆ’i)!
Î¶i
(for
all
n
âˆˆ
Z).
Moreover,
the
A-submodule
of
Î“(C
âˆ
,
LC
âˆ
)
generated
by
Î¶0PD
,
.
.
.
,
Î¶nPD
is
S
S
equal
to
the
A-submodule
of
sections
of
Î“(C
âˆ
,
LC
âˆ
)
which
are
annihilated
by
Î´
n+1
.
In
S
S
particular,
this
submodule
is
equal
to
the
A-submodule
of
Î“(C
âˆ
,
LC
âˆ
)
generated
by
the
S
S
functions
denoted
â€œÎ¶0
,
.
.
.
,
Î¶n
â€
in
Theorem
6.4.
Finally,
the
polynomial
def
Î¶nPD
[T
]
=
n

Î¶iPD
Â·
i=0
T
nâˆ’i
Tn
T
(nâˆ’1)
PD
=
Î¶0PD
Â·
+
Î¶1PD
Â·
+
.
.
.
+
Î¶nâˆ’1
Â·
T
+
Î¶nPD
(n
âˆ’
i)!
n!
(n
âˆ’
1)!
(âˆˆ
Î“(C
âˆ
,
LC
âˆ
[T
]))
is
Zet
-invariant
(relative
to
the
natural
action
of
Zet
on
C
âˆ
,
LC
âˆ
,
S
S
S
and
the
action
of
Zet
on
T
given
by
1et
(T
)
=
T
+
1).
S
Remark
1.
Just
as
was
the
case
with
Theorem
6.4,
Theorem
7.4
also
has
a
complex
analytic
version.
We
leave
the
routine
details
to
the
reader.
Remark
2.
It
is
clear
from
the
formula
for
Î´(Î¶nPD
)
that
the
denominators
that
occur
are
â€œessentialâ€
(i.e.,
they
cannot
be
eliminated
as
in
the
case
of
Theorem
6.4
simply
by
â€œredeï¬ning
the
integral
structureâ€
as
in
Deï¬nition
6.2).
In
fact,
we
shall
see
(cf.
Chapter
VI)
that
the
functions
of
Theorem
6.4
are
more
suited
to
the
study
of
the
universal
extension
at
ï¬nite
primes
(i.e.,
in
mixed
characteristic),
where
as
the
functions
of
Theorem
7.4
are
more
suited
to
the
study
of
the
universal
extension
at
inï¬nite
primes
(cf.
Chapter
VII;
Chapter
VIII).
Remark
3.
One
â€œgenerating
function-theoreticâ€
way
to
summarize
the
content
of
Theorem
7.4
is
the
following:
Let
s
be
an
indeterminate.
Note
that
[
Î´,
(Î´
taut
)âˆ—
]
=
[
Î´,
Î´
âˆ—
+
T
]
=
0
Thus,
since
Î´(Î¶0PD
)
=
0,
Î´
also
annihilates
e
(Î´
âˆ—
+T
)Â·s
Â·
Î¶0PD
=
n


nâ‰¥0
i=0
Î¶iPD
Â·
T
nâˆ’i

n
Â·s
(n
âˆ’
i)!
=
Î¶0PD
[T
]
+
Î¶1PD
[T
]
Â·
s
+
Î¶2PD
[T
]
Â·
s2
+
.
.
.
+
Î¶nPD
[T
]
Â·
sn
+
.
.
.
98
The
coeï¬ƒcients
of
this
series
are
precisely
the
functions
discussed
in
Theorem
7.4.
Next,
we
would
like
to
construct
the
binomial
canonical
Schottky-Weierstrass
functions.
First,
recall
the
polynomials
def
T
[n]
=
1
T
(T
âˆ’
1)(T
âˆ’
2)
Â·
.
.
.
Â·
(T
âˆ’
(n
âˆ’
1))
n!
discussed
in
Â§6.
If
D
is
any
operator,
we
shall
denote
by


D
n
the
operator
obtained
by
substituting
D
into
the
polynomial
T
[n]
.
If
D1
and
D2
are
any
two
commuting
operators,
we
have
(for
n
a
positive
Lemma
7.5.
integer)

D1
+
D
2
n





n

D1
D2
=
Â·
m
nâˆ’m
m=0
Proof.
This
identity
is
essentially
an
equality
between
two
polynomials
(i.e.,
the
expressions
on
the
left-
and
right-hand
sides)
in
two
variables
(i.e.,
D1
,
D2
).
Thus,
it
holds
if
and
only
if
holds
when
D1
and
D2
are
arbitrary
positive
integers.
But
for
such
D1
and
D2
,
this
identity
may
be
checked
by
considering
the
coeï¬ƒcients
of
xn
in
the
equality
(1
+
x)D1
+D2
=
(1
+
x)D1
Â·
(1
+
x)D2
(where
x
is
an
indeterminate).

def
Î´
âˆ—

PD
n
(Î¶0
);
def
Now
we
deï¬ne
Î¶0BI
=
Î¶0PD
;
(for
n
a
positive
integer)
Î¶nBI
=
def
Î¶nBI
[T
]
=

âˆ—

n

Î´
+T
PD
BI
Î¶m
Â·
T
[nâˆ’m]
(Î¶0
)
=
n
m=0
Note
that
the
Zet
-invariance
of
(Î´
taut
)âˆ—
=
Î´
âˆ—
+
T
implies
that
Î¶nBI
[T
]
is
also
Zet
-invariant.
In
particular,
the
Î¶nBI
are
higher
Schottky-Weierstrass
zeta
functions
in
the
sense
of
the
Theorem
6.4.
From
a
â€œgenerating
function-theoreticâ€
point
of
view,
one
can
write
âˆ—
(1
+
s)(Î´
+T
)
Â·
Î¶0BI
=

Î¶nBI
[T
]
Â·
sn
nâ‰¥0
=
Î¶0BI
[T
]
+
Î¶1BI
[T
]
Â·
s
+
Î¶2BI
[T
]
Â·
s2
+
.
.
.
+
Î¶nBI
[T
]
Â·
sn
+
.
.
.
99
Finally,
we
observe
that
the
Î¶nBI
are
integral
over
Z[
12
].
Indeed,
to
see
this,
we
reason
as

âˆ—
follows:
Recall
the
section
Ïƒ
alg
âˆˆ
Î“(C,
LC
)
of
Â§5.
If
we
apply
Î´n
to
(Ïƒ
alg
)2
|C
âˆ
=
(Ïƒ
an
)2
Â·Î¸,
S
which
is
a
series
with
Z-integral
coeï¬ƒcients
in
the
monomials
{q
k
+k
Â·
U
2k+1
Â·
Î¸,
q
k
Â·
U
2k
Â·
Î¸,
q
k
âˆ’k
Â·
U
2kâˆ’1
Â·
Î¸}
2
2
2
Î´
âˆ—


âˆ—


acts
on
U
k
by
multiplication
by
nk
,
we
obtain
that
Î´n
(Ïƒ
alg
)2
|C
âˆ
is
ZS

âˆ—
integral.
On
the
other
hand,
Î¶nBI
is
essentially
Î´n
(Ïƒ
alg
)|C
âˆ
,
so
the
Z[
12
]-integrality
of
Î¶nBI
S

âˆ—
follows
formally
by
solving
for
2
Â·
sn
Î´n
(Ïƒ
alg
)|C
âˆ
(and
applying
induction
on
n)
in
the
then
since
n
S
formal
identity
âˆ—
âˆ—
(1
+
s)Î´
{(Ïƒ
alg
)2
}
=
{(1
+
s)Î´
(Ïƒ
alg
)}2
(where
we
note
that
this
formal
identity
follows
from
the
general
fact
that
if
X
is
any
â€œoperatorâ€
on
â€œ(commuting)
functionsâ€
A,
B
which
satisï¬es
the
Leibniz
rule,
then
the
identity
eX
(A
Â·
B)
=
eX
(A)
Â·
eX
(B)
is
a
formal
consequence
of
the
Leibniz
rule).
Deï¬nition
7.6.
We
shall
refer
the
functions
Î¶nBI
âˆˆ
Î“(C
âˆ
,
LC
âˆ
)
as
binomial
(canonical
S
Schottky-Weierstrass)
zeta
functions.
S
Theorem
7.7.
(Binomial
Canonical
Schottky-Weierstrass
Functions)
Let
Î¶0BI
âˆˆ
def

âˆ—

Î“(C
âˆ
,
LC
âˆ
)
be
the
function
â€œ1â€
âˆˆ
OC
âˆ
(e).
Write
(for
n
âˆˆ
Zâ‰¥0
)
Î¶nBI
=
Î´n
(Î¶0BI
);
S
S
S
def
Î¶nBI
[T
]
=

âˆ—

n

Î´
+T
BI
BI
Î¶m
Â·
T
[nâˆ’m]
(Î¶0
)
=
n
m=0
Then
the
Î¶nBI
,
Î¶nBI
[T
]â€™s
satisfy
the
properties
of
Theorem
6.4
(where
we
take
â€œÎ¶n
â€
of
Theorem
6.4
to
be
Î¶nBI
;
â€œf
â€
of
Theorem
6.4
to
be
Î¶nBI
[T
]).
In
particular,
the
Î¶nBI
[T
]â€™s
are
Zet
-invariant.
Finally,
the
Î¶nBI
[T
]â€™s
are
integral
over
Z[
12
].
100
Bibliography
[Ahlf]
L.
Ahlfors,
Complex
Analysis,
McGraw-Hill
Book
Company
(1979).
[Falt]
G.
Faltings,
Stable
G-Bundles
and
Projective
Connections,
Journal
of
Algebraic
Geometry
2,
No.
3
(1993),
pp.
507-568.
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer
(1990).
[Kato]
K.
Kato,
Logarithmic
Structures
of
Fontaine-Illusie,
Proceedings
of
the
First
JAMI
Conference,
Johns
Hopkins
Univ.
Press
(1990),
pp.
191-224.
[Katz]
N.
Katz,
The
Eisenstein
Measure
and
p-adic
Interpolation,
Amer.
Journ.
of
Math.
99,
No.
2
(1977),
pp.
238-311.
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
Univ.
Press
(1985).
[Knud]
F.
F.
Knudsen,
The
Projectivity
of
the
Moduli
Space
of
Stable
Curves,
II,
Math.
Scand.
52
(1983),
pp.
161-199.
[Mats]
H.
Matsumura,
Commutative
Algebra
(Second
Edition),
The
Benjamin/Cummings
Publishing
Company
(1980).
[MB]
L.
Moret-Bailly,
Pinceaux
de
varieÌteÌs
abeÌliennes,
AsteÌrisque
129,
Soc.
Math.
France
(1985).
[Mumf]
D.
Mumford,
An
Analytic
Construction
of
Degenerating
Abelian
Varieties
over
Complete
Rings,
Appendix
to
[FC].
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
RIMS
Preprint
1033
(September
1995);
Publ.
of
RIMS
32,
No.
6
(1996),
pp.
957-1151.
[Mzk2]
S.
Mochizuki,
Foundations
of
p-adic
TeichmuÌˆller
Theory,
AMS/IP
Studies
in
Advanced
Mathematics
11,
American
Mathematical
Society/International
Press
(1999).
101
Chapter
IV:
Theta
Groups
and
Theta
Functions
Â§0.
Introduction
In
this
Chapter,
we
discuss
theta
groups
in
various
contexts.
These
groups
will
play
a
key
role
in
this
paper.
In
Â§1,
we
review
the
â€œclassical
theoryâ€
of
theta
groups
and
algebraic
theta
functions
of
[Mumf1,2,3],
specialized
to
the
case
of
elliptic
curves.
In
Â§2,
we
discuss
the
relationship
between
this
sort
of
theta
action,
and
the
theta
action
that
one
considers
in
the
case
of
the
Schottky
uniformization
of
a
degenerating
elliptic
curve.
In
Â§3,
we
use
the
theory
of
Â§2
to
deï¬ne
twisted
Schottky-Weierstrass
zeta
functions,
which
will
play
an
important
role
in
the
calculations
of
Chapter
V.
In
Â§4,
we
review
Zhangâ€™s
theory
([Zh])
of
metrized
line
bundles.
Finally,
in
Â§5,
we
discuss
the
relationship
between
Zhangâ€™s
theory
and
the
theory
of
Mumford
reviewed
in
Â§1.
We
then
apply
this
discussion
to
compute
various
degrees
of
push-forwards
of
metrized
line
bundles.
Â§1.
Mumfordâ€™s
Algebraic
Theta
Functions
In
this
Â§,
we
review
the
deï¬nitions
and
basic
properties
of
theta
groups
(cf.,
e.g.,
[MB],
Chapitres
V,
VI)
and
algebraic
theta
functions
(cf.
[Mumf1,2,3]).
See
also
[Mumf4]
for
basic
facts
concerning
abelian
varieties.
Let
f
:Eâ†’S
be
an
elliptic
curve
over
a
scheme
S,
with
identity
section
e
:
S
â†’
E.
Let
L
be
a
relatively
ample,
symmetric
line
bundle
on
E,
of
relative
degree
d
(over
S).
Then
it
is
not
diï¬ƒcult
to
show
that
L
is
necessarily
of
the
form:
def
L
=
OE
((d
âˆ’
1)
Â·
[e]
+
[Ï„
])
âŠ—OS
M
where
Ï„
âˆˆ
E(S)
is
a
section
such
that
2
Â·
Ï„
=
0,
and
M
is
a
line
bundle
on
S.
For
any
point
Î±
âˆˆ
E(T
)
over
an
S-scheme
T
,
the
line
bundle
(TÎ±âˆ—
L)
âŠ—
Lâˆ’1
def
(where
ET
=
E
Ã—S
T
;
TÎ±
:
ET
â†’
ET
is
translation
by
Î±)
on
ET
is
of
relative
degree
0
over
T
,
hence
deï¬nes
(by
Î±
â†’
(TÎ±âˆ—
L)
âŠ—
Lâˆ’1
)
a
homomorphism
102
Ï†L
:
E
â†’
E
whose
kernel
KL
=
Ker([d]
:
E
â†’
E)
is
the
kernel
of
multiplication
by
d
on
E.
In
particular,
KL
is
a
ï¬nite,
ï¬‚at
group
scheme
over
S.
Next,
we
deï¬ne
the
scheme
GL
to
be
the
scheme
that
represents
pairs
(Î±,
Î¹),
where
Î±
âˆˆ
E(T
)
belongs
to
KL
(T
),
and
Î¹
:
TÎ±âˆ—
L
âˆ¼
=
L
is
an
isomorphism
of
line
bundles
on
ET
.
Then
GL
has
a
natural
structure
of
group
scheme
over
S
which
ï¬ts
into
an
exact
sequence
(in,
say,
the
ï¬nite
ï¬‚at
topology
of
S):
1
â†’
(Gm
)S
â†’
GL
â†’
KL
â†’
1
where
the
projection
GL
â†’
KL
is
given
by
(Î±,
Î¹)
â†’
Î±,
and
the
inclusion
(Gm
)S
â†’
GL
is
given
by
the
natural
action
of
(Gm
)S
on
L.
Although
(Gm
)S
lies
in
the
center
of
GL
,
in
general,
GL
will
not
be
commutative.
Indeed,
the
commutator
map
(Î±,
Î²)
â†’
Î±Â·Î²
Â·Î±âˆ’1
Â·Î²
âˆ’1
(for
Î±,
Î²
âˆˆ
GL
(T
))
deï¬nes
a
bilinear
nondegenerate
pairing
[âˆ’,
âˆ’]
:
KL
Ã—
KL
â†’
(Gm
)S
The
group
scheme
GL
is
called
the
theta
group
associated
to
the
line
bundle
L.
Next,
we
would
like
to
consider
quasi-coherent
OS
-modules
equipped
with
an
action
of
GL
such
that
(Gm
)S
âŠ†
GL
acts
via
the
â€œidentity
characterâ€
(Gm
)S
â†’
(Gm
)S
.
We
shall
refer
to
such
modules
as
â€œOS
[GL
]-modules,â€
for
short.
Note
that
it
follows
from
the
deï¬nition
of
GL
that
def
V
=
fâˆ—
L
has
a
natural
structure
of
OS
[GL
]-module.
Moreover,
one
has
the
following
(cf.
[MB],
Chapitre
V,
Corollaire
2.4.3):
Theorem
1.1.
The
operation
â€œâŠ—OS
Vâ€
induces
an
equivalence
of
categories
between
the
category
of
quasi-coherent
OS
-modules
and
the
category
of
OS
[GL
]-modules.
Moreover,
103
up
to
tensor
product
with
a
line
bundle
on
S,
V
is
the
unique
OS
[GL
]-module
with
this
property.
Example
1.2.
Now
suppose
that
we
have
an
isomorphism
KL
âˆ¼
=
Î¼d
Ã—
(Z/dZ)
such
that
the
pairing
discussed
above
is
given
by
(Î±,
Î²)
â†’
Î±Î²
,
for
Î±
âˆˆ
Î¼d
,
Î²
âˆˆ
Z/dZ,
Î»
âˆˆ
Gm
(T
).
Then
one
may
construct
GL
,
as
well
as
the
GL
-module
V
explicitly,
as
follows.
First
of
all,
the
T
-valued
points
(for
an
S-scheme
T
)
GL
(T
)
of
the
group
scheme
GL
may
be
thought
of
as
the
set
of
triples
(Î±,
Î²,
Î»),
where
Î±
âˆˆ
Î¼d
,
Î²
âˆˆ
Z/dZ,
Î»
âˆˆ
Gm
(T
),
and
the
multiplication
law
is
given
by:
(Î±1
,
Î²1
,
Î»1
)
Â·
(Î±2
,
Î²2
,
Î»2
)
=
(Î±1
Â·
Î±2
,
Î²1
+
Î²2
,
Î»1
Â·
Î»2
Â·
Î±2âˆ’Î²1
)
Now
deï¬ne
the
GL
-module
W
as
the
free
OS
-module
def
W
=
OS
Â·
e0
âŠ•
OS
Â·
e1
âŠ•
.
.
.
âŠ•
OS
Â·
edâˆ’1
(where
we
think
of
the
indices
of
the
ei
as
elements
of
Z/dZ)
on
which
(0,
0,
Î»)
âˆˆ
GL
(T
)
acts
via
the
OS
-module
structure;
(Î±,
0,
1)
acts
on
ei
via
ei
â†’
Î±i
Â·
ei
;
and
(0,
Î²,
1)
maps
ei
to
ei+Î²
.
Then
the
resulting
OS
[GL
]-module
W
is
isomorphic
to
M
âŠ—OS
fâˆ—
L
where
M
is
a
line
bundle
on
S.
Next,
we
consider
Lagrangian
subgroups
of
GL
.
Let
KH
âŠ†
KL
be
a
subgroup
scheme
of
KL
which
is
eÌtale
locally
(on
S)
isomorphic
to
either
to
Î¼d
or
to
Z/dZ,
and,
moreover,
has
the
property
that
the
restriction
of
the
pairing
KL
Ã—
KL
â†’
(Gm
)S
discussed
above
to
KH
is
trivial.
Then
the
inverse
image
GH
âŠ†
GL
of
KH
deï¬nes
an
abelian
group
scheme
over
S
which
ï¬ts
into
an
exact
sequence
1
â†’
(Gm
)S
â†’
GH
â†’
KH
â†’
1
If
KH
is
eÌtale
locally
isomorphic
to
Î¼d
,
then
(Gm
)S
and
KH
are
both
group
schemes
of
multiplicative
type.
Hence,
it
follows
that
the
splittings
of
this
exact
sequence
are
equivalent
to
splittings
of
the
corresponding
exact
sequence
of
character
groups
(i.e.,
the
exact
104
sequence
given
by
applying
Hom(âˆ’,
(Gm
)S
)
to
the
above
exact
sequence).
In
particular,
we
see
that
the
above
exact
sequence
splits
eÌtale
locally
on
S.
If
KH
is
eÌtale
locally
isomorphic
to
Z/dZ,
then
the
issue
of
whether
or
not
this
sequence
splits
is
more
delicate,
but
in
the
cases
that
we
are
interested
in,
this
sequence
will,
in
fact,
split.
Suppose
that
H
âŠ†
GH
is
a
splitting
of
the
above
exact
sequence.
Then
we
have
a
natural
isomorphism
H
âˆ¼
=
KH
.
Deï¬nition
1.3.
We
shall
refer
to
a
subgroup
KH
âŠ†
KL
as
above
as
a
Lagrangian
subgroup
of
KL
.
We
shall
refer
to
splittings
H
âŠ†
GH
as
Lagrangian
subgroups
of
GL
.
Remark.
Note
that
the
deï¬nition
of
â€œLagrangianâ€
here
is
somewhat
diï¬€erent
from
that
of
[MB].
Nevertheless,
when
applied
to
H
(as
opposed
to
KH
),
any
Lagrangian
subgroup
relative
to
Deï¬nition
1.3
is
also
Lagrangian
for
[MB],
Chapitre
V,
DeÌï¬nition
2.5.1.
The
following
result
is
proven
in
[MB],
Chapitre
V,
TheÌoreÌ€me
3.2,
(i);
Chapitre
VI,
Propositions
1.2,
1.4.5:
Theorem
1.4.
Let
H
âŠ†
GL
be
Lagrangian.
Then
the
correspondence
M
â†’
MH
deï¬nes
a
equivalence
of
categories
between
the
category
of
OS
[GL
]-modules
and
the
category
of
quasi-coherent
OS
-modules.
Moreover,
H
âŠ†
GL
deï¬nes
a
line
bundle
LH
on
the
elliptic
def
curve
EH
=
E/KH
together
with
an
isomorphism
LH
|E
âˆ¼
=
L.
Finally,
this
isomorphism
induces
an
isomorphism
(fâˆ—
L)H
âˆ¼
=
(fH
)âˆ—
(LH
)
(where
fH
:
EH
â†’
S
is
the
structure
morphism).
Remark.
In
fact,
to
give
a
line
bundle
LH
on
EH
=
E/KH
together
with
an
isomorphism
LH
|E
âˆ¼
=
L
is
equivalent
to
giving
the
datum
of
the
lifting
H
âŠ†
GL
of
KH
âŠ†
KL
.
Thus,
often
instead
of
specifying
(respectively,
showing
the
existence
of)
the
lifting
H
âŠ†
GL
,
we
will
specify
(respectively,
show
the
existence
of)
the
line
bundle
LH
on
EH
=
E/KH
.
Theorem
1.4
is
convenient
for
reducing
proofs
concerning
fâˆ—
L
to
proofs
concerning
(fH
)âˆ—
(LH
).
105
We
are
now
ready
to
review
Mumfordâ€™s
construction
of
algebraic
theta
functions
(cf.
[Mumf1,2,3]).
In
the
remainder
of
this
Â§,
we
assume,
for
simplicity,
that
Ï„
=e
If
N
âˆˆ
Z,
let
us
write
[N
]
:
E
â†’
E
for
the
map
given
by
multiplication
by
N
.
Note
that
the
map
[âˆ’1]
:
E
â†’
E
is
an
automorphism
of
E
of
order
2
such
that
[âˆ’1]âˆ—
L
=
L,
i.e.,
by
â€œ=,â€
we
mean
the
isomorphism
between
[âˆ’1]âˆ—
L
and
L
arising
from
the
fact
that
(up
to
tensor
product
with
a
line
bundle
on
S)
L
is
the
line
bundle
associated
to
the
divisor
d
Â·
[e],
which
is
ï¬xed
by
[âˆ’1].
Thus,
from
the
deï¬nition
of
GL
,
it
follows
that
[âˆ’1]
gives
rise
to
an
automorphism
Î´L
:
GL
â†’
GL
of
order
2
whose
restriction
to
(Gm
)S
is
the
identity
and
which
induces
the
inverse
morphism
on
the
quotient
KL
of
GL
.
Let
us
write
SL
âŠ†
G
L
for
the
subscheme
of
T
-valued
points
(where
T
is
an
S-scheme)
Î³
âˆˆ
GL
satisfying
Î´L
(Î³)
=
Î³
âˆ’1
.
Such
points
Î³
are
often
referred
to
as
symmetric
(cf.
[Mumf1],
Deï¬nition,
p.
309).
One
checks
easily
that
the
projection
SL
â†’
KL
is
surjective,
ï¬nite,
and
ï¬‚at,
and
that
it
is,
in
fact,
a
torsor
over
Î¼2
(âŠ†
Gm
).
In
the
following
discussion,
we
would
like
to
show
that
this
torsor
admits
a
natural
section
over
2
Â·
KL
âŠ†
KL
.
The
construction
of
this
section,
as
well
as
the
sort
of
section
obtained,
diï¬€er
slightly,
depending
on
whether
d
is
even
or
odd.
We
begin
by
making
the
following
construction,
which
is
valid
regardless
of
the
parity
of
d:
For
Î±
âˆˆ
KL
(T
)
(where
T
is
an
S-scheme),
if
Î±
âˆˆ
GL
(T
)
is
any
element
that
lifts
Î±,
then
the
assignment
Î±
â†’
Î±
Â·
Î´L
(Î±âˆ’1
)
(where
we
note
that
the
right-hand
side
is
independent
of
the
choice
of
Î±
since
Î´L
induces
the
identity
on
(Gm
)S
âŠ†
GL
)
deï¬nes
a
morphism
Ïƒ1
:
KL
â†’
GL
which
factors
through
SL
âŠ†
GL
,
and
whose
composite
with
the
projection
GL
â†’
KL
is
the
morphism
[2]
:
KL
â†’
KL
(multiplication
by
2
on
KL
).
(Note,
that
here
we
write
the
group
106
law
of
KL
additively.)
Indeed,
these
facts
follow
from
the
fact
that
Î´L
is
an
automorphism
of
the
group
scheme
GL
of
order
2
which
induces
the
automorphism
[âˆ’1]
on
the
quotient
KL
of
GL
.
This
morphism
Ïƒ1
is
not
(in
general)
a
group
homomorphism,
but
does
satisfy
the
following
property:
Lemma
1.5.
Let
Î±,
Î²
âˆˆ
KL
(T
)
(where
T
is
an
S-scheme).
Then
Ïƒ1
(Î±
+
Î²)
=
[Î±,
Î²]âˆ’2
Â·
Ïƒ1
(Î±)
Â·
Ïƒ1
(Î²)
(where
we
write
the
group
law
of
KL
(respectively,
GL
)
additively
(respectively,
multiplicately)).
In
particular,
it
follows
that:
(i.)
if
[Î±,
Î²]2
=
1
âˆˆ
Gm
,
then
Ïƒ1
(Î±
+
Î²)
=
Ïƒ1
(Î±)
Â·
Ïƒ1
(Î²);
(ii.)
the
restriction
of
Ïƒ1
to
any
subgroup
scheme
of
KL
on
which
the
pairing
[âˆ’,
âˆ’]
(discussed
above)
is
trivial
â€”
we
shall
call
such
subgroup
schemes
â€œ[âˆ’,
âˆ’]-trivialâ€
â€”
is
a
group
homomorphism.
Proof.
Indeed,
if
Î²
âˆˆ
GL
(T
)
lifts
Î²,
then
Î±
Â·
Î²
lifts
Î±
+
Î²,
so
we
have:
Ïƒ1
(Î±
+
Î²)
=
Î±
Â·
Î²
Â·
Î´L
(Î²
âˆ’1
Â·
Î±âˆ’1
)
=
Î±
Â·
(Î²
Â·
Î´L
(Î²
âˆ’1
))
Â·
Î´L
(Î±âˆ’1
)
=
[Î±,
Î²]âˆ’2
Â·
Î±
Â·
Î´L
(Î±âˆ’1
)
Â·
(Î²
Â·
Î´L
(Î²
âˆ’1
))
=
[Î±,
Î²]âˆ’2
Â·
Ïƒ1
(Î±)
Â·
Ïƒ1
(Î²)
as
desired.
The
remaining
assertions
follow
immediately.

Thus,
at
any
rate,
if
d
is
odd,
then
multiplication
by
[2]
deï¬nes
an
automorphism
on
KL
,
so
we
obtain
by
Ïƒ1
deï¬nes
a
section
Ïƒ
:
KL
(=
2
Â·
KL
)
â†’
GL
(such
that
Ïƒ
Â·
[2]
=
Ïƒ1
),
as
desired.
Next,
we
consider
the
case
when
d
is
even.
First,
we
introduce
some
notation:
Let
us
write
def
1
d0
=
2
d
For
N
âˆˆ
Z,
let
us
denote
the
kernel
of
[N
]
:
E
â†’
E
by
NE
def
=
ker([N
]
:
E
â†’
E)
107
Then
I
claim
that
the
morphism
Ïƒ1
:
KL
=
d
E
â†’
GL
factors
through
KL
/2
E
âˆ¼
=
d0
E.
Indeed,
it
suï¬ƒces
to
prove
that
for
any
Î±,
Î²
âˆˆ
KL
(T
)
(for
T
an
S-scheme)
such
that
2Î²
=
0,
we
have
Ïƒ1
(Î±
+
Î²)
=
Ïƒ1
(Î±).
But
by
Lemma
1.5,
we
have
Ïƒ1
(Î±
+
Î²)
=
Ïƒ1
(Î±)
Â·
Ïƒ1
(Î²)
(since
[Î±,
Î²]2
=
[Î±,
2Î²]
=
[Î±,
0]
=
1).
Thus,
it
suï¬ƒces
to
show
that
Ïƒ1
(Î²)
=
1.
But
this
follows
from
the
fact
that
since
the
line
bundle
L
is
totally
symmetric
(cf.
[Mumf1],
Â§2,
Propositions
3,
6;
Corollary
2),
after
ï¬nite
ï¬‚at
localization,
we
may
choose
the
lift
Î²
âˆˆ
GL
(T
)
of
Î²
âˆˆ
KL
(T
)
to
lie
inside
SL
(T
)
âŠ†
GL
(T
)
and
(at
the
same
time)
satisfy
Î²
2
=
1.
Thus,
Ïƒ1
(Î²)
=
Î²
Â·
Î´L
(Î²)âˆ’1
=
Î²
2
=
1,
as
desired.
This
completes
the
proof
of
the
claim.
Note
that
we
have:
def
2
Â·
KL
=
d0
E
âŠ†
d
E
=
KL
In
particular,
we
obtain
a
morphism
Ïƒ
:
2
Â·
KL
â†’
GL
which
factors
through
SL
âŠ†
GL
,
and
whose
composite
with
the
projection
GL
â†’
KL
is
the
natural
injection
2
Â·
KL
âŠ†
KL
.
That
is
to
say,
in
the
even
case,
we
obtain
a
section
of
GL
â†’
KL
over
the
subgroup
scheme
2
Â·
KL
âŠ†
KL
.
This
completes
our
discussion
of
the
even
case.
Observe
that
in
both
the
even
and
odd
cases,
the
section
Ïƒ
over
2
Â·
KL
that
we
constructed
satisï¬es
the
following
property:
If
Î±
=
2Î±1
,
Î²
=
2Î²1
âˆˆ
2
Â·
KL
(T
)
(where
T
is
an
S-scheme),
then
Ïƒ(Î±
+
Î²)
Â·
Ïƒ(Î±)âˆ’1
Â·
Ïƒ(Î²)âˆ’1
=
[Î±1
,
Î²1
]2
(where
we
note
that
since
[KL
,
2
E]2
=
[KL
,
0]
=
1,
it
follows
(a
priori!)
that
[Î±1
,
Î²1
]2
depends
only
on
Î±,
Î²).
Indeed,
this
relation
follows
immediately
from
Lemma
1.5.
Let
us
observe
that
although
the
proof
of
Lemma
1.5
depends
on
the
explicit
deï¬nition
of
Ïƒ
in
terms
of
Î´L
,
the
square
of
the
above
relation,
i.e.,
{Ïƒ(Î±
+
Î²)
Â·
Ïƒ(Î±)âˆ’1
Â·
Ïƒ(Î²)âˆ’1
}2
=
[Î±,
Î²]
may
be
proven
solely
from
the
assumption
that
Ïƒ
maps
into
SL
âŠ†
GL
:
Indeed,
let
us
denote
Ïƒ(Î±
+
Î²)
Â·
Ïƒ(Î±)âˆ’1
Â·
Ïƒ(Î²)âˆ’1
âˆˆ
Gm
(T
)
by
Î».
Then
since
Ïƒ(Î±
+
Î²)
âˆˆ
SL
(T
),
we
obtain
Î´L
(Ïƒ(Î²))
Â·
Î´L
(Ïƒ(Î±))
Â·
Î»
=
Î»âˆ’1
Â·
Ïƒ(Î±)âˆ’1
Â·
Ïƒ(Î²)âˆ’1
.
If
we
combine
this
with
Î´L
(Ïƒ(Î±))
=
Ïƒ(Î±)âˆ’1
,
Î´L
(Ïƒ(Î²))
=
Ïƒ(Î²)âˆ’1
,
then
the
result
follows
immediately.
Next,
note
that
if
Î±
âˆˆ
E(S),
then
transport
of
structure
deï¬nes
a
natural
isomorphism
GÎ±
:
GTÎ±âˆ—
L
âˆ¼
=
GL
108
which
is
compatible
with
the
injections
of
Gm
,
and
projections
to
KL
=
KTÎ±âˆ—
L
on
both
sides.
Thus,
by
conjugating
by
GÎ±
,
we
see
that
Ïƒ
:
2
Â·
KL
â†’
GL
deï¬nes
a
section
ÏƒÎ±
:
2
Â·
KTÎ±âˆ—
L
â†’
GTÎ±âˆ—
L
In
summary,
we
have
proven
the
following
result
(which
is
implicit
in
the
theory
of
[Mumf1],
Â§2):
Theorem
1.6.
Let
E
â†’
S
be
an
elliptic
curve
over
a
scheme
S.
Let
d
be
a
positive
integer.
Let
M
be
a
line
bundle
on
S.
Write
def
L
=
OE
(d
Â·
[e])
âŠ—OS
M
Then:
(1)
There
is
a
canonical
section
Ïƒ
:
2
Â·
KL
â†’
GL
of
the
projection
GL
â†’
KL
over
2
Â·
KL
âŠ†
KL
that
maps
into
SL
âŠ†
GL
,
is
functorial
in
S,
and
whose
restriction
to
[âˆ’,
âˆ’]-trivial
subgroup
schemes
of
2
Â·
KL
is
a
group
homomorphism.
Moreover,
these
properties
uniquely
determine
Ïƒ
over
4
Â·
KL
.
(2)
The
section
Ïƒ
is
related
to
the
pairing
[âˆ’,
âˆ’]
:
KL
Ã—
KL
â†’
(Gm
)S
by
the
following
formula:
If
Î±
=
2Î±1
,
Î²
=
2Î²1
âˆˆ
2
Â·
KL
(T
)
(where
T
is
an
S-scheme),
then
Ïƒ(Î±
+
Î²)
Â·
Ïƒ(Î±)âˆ’1
Â·
Ïƒ(Î²)âˆ’1
=
[Î±1
,
Î²1
]2
In
particular,
we
have:
{Ïƒ(Î±
+
Î²)
Â·
Ïƒ(Î±)âˆ’1
Â·
Ïƒ(Î²)âˆ’1
}2
=
[Î±,
Î²].
(3)
Finally,
if
Î±
âˆˆ
E(S),
then
Ïƒ
deï¬nes
a
section
ÏƒÎ±
:
2
Â·
KTÎ±âˆ—
L
â†’
GTÎ±âˆ—
L
by
transport
of
structure
via
the
translation
morphism
TÎ±
:
E
â†’
E.
def
Now
suppose
that
d
is
odd
(respectively,
even).
Then
KL0
=
KL
/2
Â·
KL
is
=
S
(respectively,
âˆ¼
=
2
E).
If
one
thinks
of
Ïƒ
as
a
2
Â·
KL
-valued
point
of
GL
,
then
it
follows
from
the
deï¬nition
of
GL
that
if
Î±
âˆˆ
E(S)
is
any
S-valued
point,
then
Ïƒ
induces
an
isomorphism
109
L|TÎ±âˆ—
KL
âˆ¼
=
(L|Î±0
)
âŠ—OK
0
OKL
L
for
some
line
bundle
L|Î±0
on
the
quotient
KL0
of
KL
.
Thus,
put
another
way,
the
canonical
section
Ïƒ
determines
natural
descent
data
for
L|TÎ±âˆ—
KL
from
KL
to
KL0
.
(Thus,
if
d
is
odd,
then
we
may
think
of
this
isomorphism
as
a
trivialization
of
the
restriction
of
the
line
bundle
L
to
the
subscheme
TÎ±âˆ—
KL
.)
In
particular,
restriction
to
TÎ±âˆ—
KL
deï¬nes
(by
composing
with
the
above
isomorphism)
a
morphism
of
OKL0
-modules
with
natural
GL
-action:
fâˆ—
L
â†’
(L|Î±0
)
âŠ—OK
0
OKL
L
In
other
words,
this
morphism
allows
us
to
think
of
global
sections
of
L
over
E
as
being
(essentially)
functions
on
the
subscheme
TÎ±âˆ—
KL
.
These
functions
are
the
algebraic
theta
functions
of
[Mumf1,2,3].
Â§2.
Theta
Actions
and
the
Schottky
Uniformization
In
this
Â§,
we
discuss
the
relationship
between
torsion
actions
on
line
bundles
(i.e.,
as
in
Â§1)
and
the
uniformization
theory
reviewed
in
Chapter
III,
Â§5.
Thus,
in
this
Â§,
we
will
use
the
same
notation
as
in
Chapter
III,
Â§5.
We
begin
by
reviewing
this
notation.
First
of
all,
O
is
a
Zariski
localization
of
the
ring
of
integers
of
a
ï¬nite
extension
of
Q;
def
A
=
O[[q]];
def
S
=
Spec(A);
def
S
=
Spf(A)
(where
q
is
an
indeterminate,
and
we
regard
A
as
equipped
with
the
q-adic
topology).
Over
S,
we
had
a
natural
elliptic
curve
E
â†’
S,
together
with
a
compactiï¬cation
C
â†’
S
whose
pull-back
CS
â†’
S
to
S
may
be
obtained
as
a
quotient
of
an
object
C
âˆ
with
respect
S
to
the
natural
action
of
the
group
Zet
on
C
âˆ
.
Moreover,
we
have
a
natural
identiï¬cation
S
ES
=
(Gm
)S
.
The
special
ï¬ber
(C
âˆ
)spl
of
C
âˆ
(i.e.,
the
zero
locus
of
the
function
q)
is
a
S
S
chain
of
P1
â€™s
over
Spec(O)
indexed
by
Z
and
permuted
by
the
action
of
Zet
in
a
fashion
which
is
compatible
with
the
indexing
by
Z
and
the
natural
action
of
Zet
=
Z
on
Z
(by
addition).
Recall
that
we
denoted
the
origin
of
E
by
e.
This
origin,
regarded
as
a
divisor
def
def
in
E
or
C,
gives
rise
to
line
bundles
LE
=
OE
(e),
LC
=
OC
(e).
The
inverse
image
of
e
in
C
âˆ
(via
the
quotient
map
C
âˆ
â†’
CS
)
is
denoted
by
e
âŠ†
C
âˆ
.
In
Chapter
III,
Â§5,
we
S
S
S
also
discussed
how
Î“(C
âˆ
,
LâŠ—2i
Câˆ
)
S
110
S
def
(where
LC
âˆ
=
LC
|C
âˆ
)
may
be
described
explicitly
as
the
degree
i
portion
of
a
certain
S
S
graded
ring
RE
.
This
explicit
description
will
play
a
key
role
in
this
Â§,
and,
indeed,
in
the
proof
of
the
main
results
of
this
paper.
In
the
following,
we
ï¬x
a
positive
even
number
n
=
2m.
Then
let
us
recall
(cf.
[Mumf5],
p.
289)
that
there
is
a
natural
action
of
(Gm
)S
=
ES
on
C
âˆ
and
LâŠ—2
C
âˆ
.
In
particular,
S
S
we
obtain
a
natural
action
of
(Î¼n
)S
(i.e.,
the
kernel
of
multiplication
by
n
on
the
abelian
group
object
(Gm
)S
)
on
C
âˆ
and
LC
âˆ
.
On
the
other
hand,
one
also
has
a
natural
action
S
of
Zet
in
C
âˆ
and
LâŠ—2
Câˆ
.
S
S
Moreover,
it
is
easy
to
see
from
the
deï¬nitions
of
these
actions
S
of
Zet
and
(Î¼n
)S
(i.e.,
(Î¼n
)S
acts
trivially
on
Î¸
â€“
cf.
[Mumf5],
p.
289;
the
action
of
Zet
,
namely,
1et
(Î¸)
=
q
Â·
U
2
Â·
Î¸,
is
discussed
in
Chapter
III,
Â§5)
that
they
commute
on
C
âˆ
and
S
LâŠ—n
C
âˆ
.
Thus,
it
follows
that
we
may
form
the
quotients
S
C
âˆ
=
C
âˆ
/Î¼n
;
def
S
S
def
def
CS
=
CS
/Î¼n
;
ES
=
ES
/Î¼n
;

def
M
=
LâŠ—n
C
/Î¼n
S
S
âˆ
of
C
âˆ
,
CS
,
ES
,
and
LâŠ—n
C
,
respectively,
by
(Î¼n
)S
.
Indeed,
in
the
case
of
C
,
if
we
think
S
S
S
of
C
âˆ
as
the
q-adic
completion
of
a
sort
of
NeÌron
model
of
Gm
over
A[q
âˆ’1
]
(cf.
the
S
discussion
in
Chapter
III,
Â§5),
then
the
quotient
C
âˆ
â†’
C
âˆ
is
just
the
quotient
induced
S
S
on
completions
of
NeÌron
models
by
the
morphism
Gm
â†’
Gm
given
by
multiplication
by

deï¬nes
a
line
bundle
of
degree
1
on
C
whose
pull-back
to
C
n.
Finally,
note
that
M
S
S
S
âŠ—n
is
LC
.
S
Next,
let
us
write
C
=
C
âˆ
/(n
Â·
Zet
)
[n]
def
S
S
Thus,
we
obtain
covering
morphisms
Câˆ
â†’
C
S
[n]
S
â†’
CS
â†’
CS
def
where
the
ï¬rst
two
morphisms
are
eÌtale
with
Galois
groups
nÂ·Zet
and
Zet
/n
=
Zet
/nÂ·Zet
,
respectively,
and
the
last
morphism
is
the
quotient
by
the
action
of
(Î¼n
)S
.
Moreover,

on
C
)
into
the
last
two
morphisms
may
be
algebraized
(along
with
the
line
bundle
M
S
S
morphisms
C
[n]
â†’
C
â†’
C

on
C)
which
compactify
isogenies
of
smooth
group
schemes
(and
a
line
bundle
M
111
E
[n]
Zet
/n
âˆ’â†’
Î¼n
âˆ’â†’
E
E
over
S.
Here,
the
groups
over
the
arrows
denote
the
kernels
of
the
respective
arrows,
or,
alternatively,
the
ï¬nite
group
schemes
with
respect
to
which
the
arrows
are
torsors.
The
group
schemes
E
and
E
have
connected
special
ï¬bers,
while
the
group
of
connected
components
of
the
special
ï¬ber
of
E
[n]
may
be
identiï¬ed
with
Zet
/n.
Moreover,
def
Î n
=
(Zet
/n)
Ã—
Î¼n
acts
on
C
[n]
and
E
[n]
,
and
E
[n]
â†’
E
is
naturally
a
Î n
-torsor.
Next,
observe
that
the
group
of
line
bundles
on
E
whose
pull-back
to
E
[n]
is
trivial
may
be
identiï¬ed
with
the
group
of
characters
Hom(Î n
,
(Gm
)S
)
=
Hom(Î n
,
(Î¼n
)S
)
(where
the
â€œHomâ€
is
with
respect
to
group
schemes
over
S,
or
equivalently
in
this
case,
over
Spec(A[q
âˆ’1
])).
Indeed,
this
correspondence
may
be
given
explicitly
as
follows.
Given
a
character
Ï‡
âˆˆ
Hom(Î n
,
(Î¼n
)S
)
one
obtains
an
action
of
Î n
on
the
trivial
OE
[n]
-module
OE
[n]
that
covers
the
natural
action
of
Î n
on
E
[n]
by
multiplying
the
trivial
action
of
Î n
on
OE
[n]
by
Ï‡.
Let
us
denote
Ï‡
Ï‡
OE
[n]
equipped
with
this
action
by
OE
[n]
.
Then
taking
Î n
-invariants
of
OE
[n]
gives
us
(since
E
[n]
â†’
E
is
a
Î n
-torsor)
a
line
bundle
O
Ï‡
on
E
whose
restriction
to
E
[n]
is
equal
E
Ï‡
Ï‡
may
be
thought
of
as
the
to
OE
[n]
and
whose
n-th
power
is
trivial.
Put
another
way,
O
E
sheaf
of
functions
f
(
)
on
E
[n]
which
satisfy
the
transformation
rule:
f
(Î±
Â·
)
=
Ï‡(Î±)âˆ’1
Â·
f
(
)
(for
all
points
Î±
(valued
in
some
scheme)
of
Î n
).
This
correspondence
Ï‡
â†’
O
Ï‡
E
induces
the
natural
bijection
between
characters
and
line
bundles
referred
to
above.
Also,
note
that
although
it
is
not
clear
whether
or
not
O
Ï‡
extends
to
a
line
bundle
on
C,
it
E
Ï‡
[n]
is
clear
that
the
line
bundle
with
Î n
-action
OE
extends
to
a
line
bundle
with
[n]
on
E
Ï‡
[n]
Î n
-action
OC
[n]
on
C
.
Next,
let
us
observe
that
the
line
bundle
112
def
LC
=
OC
(e)
(where
e
is
the
identity
of
E)
satisï¬es

LC
|C
[n]
=
OC
[n]
([Î n
])
âˆ¼
=
OC
[n]
(n
Â·
[Zet
/n])
=
LâŠ—n
C
|C
[n]
=
M|C
[n]
(where
[Î n
]
and
[Zet
/n]
denote
the
divisors
in
C
[n]
deï¬ned
by
the
respective
subgroup
schemes
of
E
[n]
).
Here,
the
isomorphism
â€œâˆ¼
=â€
in
the
middle
follows
from
the
fact
that,
since
the
image
of
Î¼n
forms
a
subgroup
scheme
in
C
[n]
annihilated
by
n,
and
OC
[n]
([Zet
/n])
is
a
line
bundle
of
degree
n
on
C
[n]
,
we
obtain
that
translation
by
Î¼n
ï¬xes
the
isomorphism
class
of
OC
[n]
([Zet
/n]),
hence
that
OC
[n]
([Î n
])
âˆ¼
=
OC
[n]
(n
Â·
[Zet
/n]),
as
desired.
Thus,
it
follows
from
the
discussion
above
concerning
characters
that
there
exists
a
unique
Ï‡
âˆˆ
Hom(Î n
,
(Î¼n
)S
)
such
that

)
LE
=
O
Ï‡
âŠ—O
(M|
E
E
E
We
are
now
ready
to
state
the
main
result
of
this
Â§:
Theorem
2.1.
The
character
Ï‡
âˆˆ
Hom(Î n
,
(Î¼n
)S
)
such
that

)
LE
=
O
Ï‡
âŠ—O
(M|
E
E
E
(is
the
unique
character
which)
satisï¬es:
Ï‡(1et
)
=
âˆ’1;
Ï‡|Î¼n
:
Î¼n
â†’
Î¼n
is
the
character
given
by
raising
to
the
m-th
power.
def
Proof.
To
simplify
notation,
write
Ïˆ
=
Î¸
m
.
Recall
(cf.
[Mumf5],
especially
p.
289)
that

is
the
trivial
action.
In
the
action
of
Zet
Ã—
Î¼n
on
Ïˆ
which
gives
rise
to
the
line
bundle
M
the
following,
we
shall
wish
to
take
objects
which
have
some
action
of
Zet
Ã—
Î¼n
deï¬ned
in
[Mumf5],
and
twist
this
action
by
the
character
Ï‡
described
in
the
statement
of
Theorem
2.1.
We
shall
denote
the
resulting
objects
with
twisted
action
by
means
of
a
superscript
or
subscript
Ï‡
(whichever
is
more
convenient),
and
write,
for
instance,
[âˆ’1](Ïˆ)
=
Ïˆ;
[âˆ’1](ÏˆÏ‡
)
=
âˆ’ÏˆÏ‡
(where
[âˆ’1]
is
a
generator
of
Î¼n
/Î¼m
=
Î¼2
).
Since
L
has
a
unique
(up
to
constant
multiples)
nonzero
global
section
whose
zero
locus
is
precisely
e,
it
suï¬ƒces
to
check
that
the
set
of
âˆ
Zet
Ã—
Î¼n
-invariant
sections
of
(LâŠ—m
C
âˆ
)Ï‡
on
(C
)spl
has
a
generator
whose
zero
locus
on
the
S
S
113
Gm
inside
(C
âˆ
)spl
which
contains
the
identity
is
precisely
the
zero
locus
of
U
n
âˆ’
1
(i.e.,
S
the
inverse
image
of
e
âŠ†
E).
To
show
this,
recall
from
Chapter
III,
Â§5,
that
the
image
of
Î“(C
âˆ
,
LâŠ—m
C
âˆ
)
under
reS
striction
to
this
Gm
is
the
O-module
generated
by
S
U
m
Â·
ÏˆÏ‡
,
U
mâˆ’1
Â·
ÏˆÏ‡
,
.
.
.
,
U
Â·
ÏˆÏ‡
,
ÏˆÏ‡
,
U
âˆ’1
Â·
ÏˆÏ‡
,
.
.
.
,
U
âˆ’m+1
Â·
ÏˆÏ‡
,
U
âˆ’m
Â·
ÏˆÏ‡
Since
the
only
Î¼m
-invariant
(where
Î¼m
âŠ†
Î¼n
)
U
i
are
those
for
which
i
is
divisible
by
m,
and,
moreover,
[âˆ’1](ÏˆÏ‡
)
=
âˆ’ÏˆÏ‡
=
ÏˆÏ‡
(where
[âˆ’1]
is
a
generator
of
Î¼n
/Î¼m
=
Î¼2
),
it
follows
that
the
Î¼n
-invariant
subspace
of
this
image
is
given
by
the
O-module
generated
by
the
two
elements:
U
m
Â·
ÏˆÏ‡
,
U
âˆ’m
Â·
ÏˆÏ‡
Moreover,
we
have
1et
(U
âˆ’m
Â·
ÏˆÏ‡
)
=
Ï‡(1et
)
Â·
(q
Â·
U
)âˆ’m
Â·
(q
Â·
U
2
)m
Â·
ÏˆÏ‡
=
Ï‡(1et
)
Â·
U
m
Â·
ÏˆÏ‡
=
âˆ’U
m
Â·
ÏˆÏ‡
Thus,
the
Zet
Ã—
Î¼n
-invariant
subspace
is
generated
by
(U
m
âˆ’
U
âˆ’m
)
Â·
ÏˆÏ‡
whose
zero
locus
is
the
same
as
that
of
U
n
âˆ’
1,
as
desired.

Before
concluding
this
Â§,
we
make
some
ï¬nal
remarks
which
will
be
helpful
for
the
computations
that
we
will
perform
later.
First,
observe
that
it
is
a
consequence
of
the
discussion
at
the
beginning
of
Chapter
III,
Â§5,
that
Î“(C
âˆ
,
LâŠ—n
C
âˆ
)
is
topologically
A-generated
S
S
by
the
sections
U
m
Â·
Î¸
m
,
U
mâˆ’1
Â·
Î¸
m
,
.
.
.
,
U
Â·
Î¸
m
,
Î¸
m
,
U
âˆ’1
Â·
Î¸
m
,
.
.
.
,
U
âˆ’m+1
Â·
Î¸
m
,
U
âˆ’m
Â·
Î¸
m
and
their
Zet
-translates.
Let
us
compute
these
Zet
-translates.
Since
1et
(U
)
=
q
Â·
U
,
1et
(Î¸)
=
q
Â·
U
2
Â·
Î¸,
we
obtain,
for
k,
i
âˆˆ
Z,
|i|
â‰¤
m:
ket
(U
i
)
=
q
ik
Â·
U
i
;
2
ket
(Î¸
m
)
=
q
mÂ·k
Â·
U
2mk
Â·
Î¸
m
114
Thus,
we
obtain
the
following:
Proposition
2.2.
The
A-module
Î“(C
âˆ
,
LâŠ—n
C
âˆ
)
is
topologically
A-generated
by
the
sections
S
S
2
ket
(U
i
Â·
Î¸
m
)
=
q
mÂ·k
+ik
Â·
U
2mk+i
Â·
Î¸
m
where
k,
i
âˆˆ
Z,
|i|
â‰¤
m.
(For
instance,
the
case
m
=
1
of
Proposition
2.2
is
essentially
stated
in
the
discussion
at
the
beginning
of
Chapter
III,
Â§5.)
We
will
ultimately
use
Proposition
2.2
to
compute
the
image
in
ES
=
(Gm
)S
of
Ï‡
sections
of
LâŠ—n
C
âˆ
âŠ—OC
âˆ
OC
âˆ
for
various
characters
Ï‡
âˆˆ
Hom(Î n
,
(Î¼n
)S
).
S
S
S
Â§3.
Twisted
Schottky-Weierstrass
Zeta
Functions
In
this
Â§,
we
generalize
the
discussion
of
Schottky-Weierstrass
zeta
functions
of
Chapter
III,
Â§6,
7,
to
the
â€œtwistedâ€
context
of
Â§2.
We
maintain
the
notation
of
Â§2.
First,
let
us
recall
the
isogeny
Eâ†’E
discussed
in
Â§2.
This
kernel
of
this
isogeny
is
Î¼n
.
Moreover,
this
isogeny
may
be
compactiï¬ed
to
a
morphism
C
â†’
C.
Recall
(Chapter
III,
Â§1)
that
the
universal
extension
E
â€ 
of
E
is
deï¬ned
by
considering
certain
line
bundles
with
connection
on
C.
Given
such
a
line
bundle
with
connection
on
C,
by
taking
the
norm
of
this
line
bundle
(relative
to
the
ï¬nite
morphism
C
â†’
C),
we
obtain
a
line
bundle
on
C;
moreover,
taking
the
trace
of
the
connection
on
the
line
bundle
on
C,
we
get
a
connection
on
the
norm
on
this
line
bundle
on
C.
Thus,
by
performing
these
operations,
we
obtain
a
push-forward
homomorphism
Eâ€ 
â†’
Eâ€ 
which
covers
(since
taking
the
norm
of
the
line
bundle
deï¬ned
by
a
divisor
on
E
is
the
same
as
taking
the
line
bundle
associated
to
the
image
of
this
divisor
in
E)
the
given
isogeny
E
â†’
E.
Moreover,
since
taking
the
trace
of
diï¬€erentials
on
ES
=
(Gm
)S
via
what
amounts
to
the
multiplication
by
n
map
(Gm
)S
=
ES
â†’
(Gm
)S
=
ES
on
(Gm
)S
induces
an
isomorphism
of
the
invariant
diï¬€erentials
on
ES
onto
the
invariant
diï¬€erentials
on
ES
(i.e.,
the
trace
of
dU/U
is
n
Â·
dU/U
=
d(U
n
)/(U
n
)),
it
follows
that
the
push-forward
map
115
deï¬ned
above
maps
WE
âŠ†
E
â€ 
(i.e.,
WE
is
what
we
called
â€œW
â€
when
E
was
the
only
elliptic
curve
under
discussion)
isomorphically
onto
WE
âŠ†
E
â€ 
.
That
is
to
say,
we
have
a
commutative
diagram
0
âˆ’â†’
WE
â
â

âˆ’â†’
Eâ€ 
â
â

âˆ’â†’
E
â
â

âˆ’â†’
0
0
âˆ’â†’
WE
âˆ’â†’
Eâ€ 
âˆ’â†’
E
âˆ’â†’
0
where
the
vertical
arrow
on
the
left
is
an
isomorphism,
and
Ker(E
â€ 
â†’
E
â€ 
)
âˆ¼
=
Î¼n
=
Ker(E
â†’
E)
âˆ¼
â€ 
â€ 
Next,
we
would
like
to
consider
the
canonical
splittings
Îº
:
ES
â†’
E
,
Îº
:
ES
â†’
E
of
S
S
Chapter
III,
Â§2,
Theorem
2.1.
Now
I
claim
that
Îº(Ker(E
â†’
E))
âŠ†
Ker(E
â€ 
â†’
E
â€ 
)
Indeed,
since
Îº
is
a
homomorphism,
it
follows
that
the
image
Im(Îº(Ker(E
â†’
E)))
âŠ†
E
â€ 
S
is
annihilated
by
n
and
vanishes
when
projected
to
ES
,
hence
is
contained
in
(WE
)S
.
On
the
other
hand,
the
image
in
(WE
)S
âˆ¼
=
A1
of
any
A-ï¬‚at
group
scheme
annihilated
by
n
S
is
necessarily
trivial.
Indeed,
this
may
be
checked
(by
A-ï¬‚atness)
in
characteristic
zero,
where
it
is
obvious.
This
completes
the
proof
of
the
claim.
Note
that
the
claim
then
implies
â€ 
â€ 
that
Îº
:
ES
â†’
E
descends
to
a
homomorphism
ES
â†’
E
which
splits
the
projection
S
S
â€ 
E
â†’
ES
.
Since
Îº
is
the
unique
such
homomorphism
(cf.
Chapter
III,
Â§2),
it
thus
follows
S
that
we
have
a
commutative
diagram:
Îº
ES
â
â

âˆ’â†’
ES
âˆ’â†’
Îº
â€ 
E
S
â
â

E
â€ 
S
Next,
we
consider
line
bundles.
For
convenience,
we
assume
that
O
has
enough
primes
inverted
so
that
Pic(O)
=
{1}
116
(Here,
we
use
the
well-known
fact
from
elementary
algebraic
number
theory
that
â€œPicâ€
of
the
ring
of
integers
of
a
number
ï¬eld
is
a
ï¬nite
group,
i.e.,
â€œthe
ï¬niteness
of
the
class
group.â€)
Note
that
since
Pic(O)
is
trivial,
it
follows
immediately
that
Pic(A)
is
also
trivial.
Now
recall
the
line
bundle

M
on
C.
If
Ï‡
âˆˆ
Hom(Î n
,
(Î¼n
)S
),
then
we
shall
write

)
Ï‡
def
=
O
Ï‡
âŠ—O
(M|
M
E
E
E
E
Note
that
since
C
is
regular,
and
C
âˆ’
E
is
of
codimension
2
in
C,
it
follows
that
the
line
Ï‡
on
C.
Moreover,
since
E
â†’
E
Ï‡
|E
extends
(uniquely)
to
a
line
bundle
M
bundle
M
C
E
Ï‡

is
a
Î¼n
-torsor,
we
obtain
an
action
of
Î¼n
on
MC
.
Since
Î¼n
is
of
multiplicative
type,
hence
reductive
(i.e.,
its
representations
split
up
into
direct
sums
of
representations
by
characters),
we
thus
obtain
that
the
Î¼n
-invariant
subspace
Ï‡
)Î¼n
âŠ†
Î“(C,
M
Ï‡
)
Î“(C,
M
C
C
Ï‡
)
(which,
by
Riemann-Roch,
is
a
projective
is
a
direct
summand
of
the
A-module
Î“(C,
M
C
A-module
of
rank
n).
Since,
after
one
inverts
q,
this
invariant
subspace
may
be
identiï¬ed
Ï‡
)âŠ—A
A[q
âˆ’1
]
(which,
by
Riemann-Roch,
is
a
projective
A[q
âˆ’1
]-module
of
rank
with
Î“(E,
M
E
Ï‡
)Î¼n
is
a
projective
A-module
of
1),
we
thus
obtain
that
this
invariant
subspace
Î“(C,
M
C
Ï‡
)Î¼n
is
a
free
A-module
of
rank
rank
1.
Since
Pic(A)
is
trivial,
we
thus
obtain
that
Î“(C,
M
C
1.
Thus,
we
may
choose
a
generator
sÏ‡
of
this
module,
i.e.:
Ï‡
)Î¼n
A
Â·
sÏ‡
=
Î“(C,
M
C
Thus,
if
one
pulls
sÏ‡
back
to
C
âˆ
,
we
see
that
S
sÏ‡
|C
âˆ
S
may
be
thought
of
as
a
topological
A-linear
combination
ÏƒÏ‡
of
the
elements
discussed
in
Proposition
2.2
which
satisï¬es,
for
all
points
Î±
of
Zet
Ã—
Î¼n
(valued
in
some
scheme),
Î±(ÏƒÏ‡
)
=
Ï‡âˆ’1
(Î±)
Â·
ÏƒÏ‡
117
where
the
action
of
Î±
on
the
left-hand
side
is
via
the
usual
action
of
Zet
Ã—Î¼n
on
expressions
as
in
Proposition
2.2,
and
we
regard
the
character
Ï‡
as
a
character
on
Zet
Ã—
Î¼n
via
the
natural
surjection
Zet
Ã—
Î¼n
â†’
(Zet
/n)
Ã—
Î¼n
=
Î n
.
Next,
let
us
recall
the
exact
sequence
0
â†’
OC
â†’
TC
â†’
Ï„E
|C
â†’
0
of
the
discussion
following
Chapter
III,
Corollary
4.3.
The
extension
class
of
this
exact
â€ 
sequence
is
precisely
the
torsor
deï¬ned
by
the
universal
extension
EC
â†’
C.
By
the
discussion
above
concerning
the
relationship
between
the
universal
extensions
E
â€ 
and
E
â€ 
,
it
follows
that
this
exact
sequence
descends
naturally
to
an
exact
sequence
0
â†’
OC
â†’
TC
â†’
Ï„E
|C
â†’
0
Ï‡
).
Then
just
Thus,
we
see
that
we
obtain
a
natural
action
of
Î¼n
on
Î“(C,
TC
âŠ—OC
M
C
Ï‡
,
we
obtain
(by
applying
Riemann-Roch
and
the
as
in
the
discussion
of
sections
of
M
reductiveness
of
Î¼n
)
that
the
Î¼n
-invariant
subspace
Ï‡
)Î¼n
âŠ†
Î“(C,
TC
âŠ—
M
Ï‡
)
Î“(C,
TC
âŠ—
M
C
C
ï¬ts
into
an
exact
sequence
of
A-modules:
Ï‡
)Î¼n
â†’
Î“(C,
M
Ï‡
)Î¼n
âŠ—A
(A
Â·
U
âˆ‚
)
â†’
0
Ï‡
)Î¼n
â†’
Î“(C,
TC
âŠ—
M
0
â†’
Î“(C,
M
C
C
C
âˆ‚U
In
particular,
we
may
choose
a
section
Ï‡
)Î¼n
SÏ‡
âˆˆ
Î“(C,
TC
âŠ—
M
C
Ï‡
)Î¼n
âŠ—A
(A
Â·
U
âˆ‚
)
is
equal
to
sÏ‡
Â·
U
âˆ‚
.
If
we
pull-back
SÏ‡
to
C
âˆ
,
whose
image
in
Î“(C,
M
C
âˆ‚U
âˆ‚U
then
we
may
think
of
SÏ‡âˆ
as
a
section
of
TC
âŠ—
LâŠ—n
C
âˆ
which
satisï¬es
S
Î±(SÏ‡âˆ
)
=
Ï‡(Î±)âˆ’1
Â·
SÏ‡âˆ
for
all
points
Î±
of
Zet
Ã—
Î¼n
(valued
in
some
scheme).
On
the
other
hand,
Îº
deï¬nes
a
section
ÎºT
âˆˆ
Î“(C
âˆ
,
TC
|C
âˆ
)
S
118
S
S
âˆ‚
whose
image
in
Î“(C
âˆ
,
Ï„E
|C
âˆ
)
is
U
âˆ‚U
.
Since
Îº
descends
to
Îº
(as
discussed
above),
the
S
S
natural
action
of
Î¼n
on
ÎºT
is
trivial.
Moreover,
by
Chapter
III,
Theorem
5.6,
it
follows
that
1et
(ÎºT
)
=
ÎºT
+
1
In
particular,
the
section
ÏƒÏ‡
Â·
ÎºT
âˆˆ
Î“(C
âˆ
,
LâŠ—n
C
âˆ
âŠ—OC
TC
)
S
S
satisï¬es
1et
(ÏƒÏ‡
Â·
ÎºT
)
=
Ï‡(1et
)âˆ’1
Â·
ÏƒÏ‡
Â·
(ÎºT
+
1);
Î±(ÏƒÏ‡
Â·
ÎºT
)
=
Ï‡(Î±)âˆ’1
Â·
ÏƒÏ‡
Â·
ÎºT
(where
Î±
is
a
point
of
Î¼n
valued
in
some
scheme).
Thus,
if
we
form
the
diï¬€erence
Î¶
Ï‡
=
SÏ‡âˆ
âˆ’
ÏƒÏ‡
Â·
ÎºT
âˆˆ
Î“(C
âˆ
,
LâŠ—n
Câˆ
)
def
S
S
then
we
have:
1et
(Î¶
Ï‡
)
=
Ï‡(1et
)âˆ’1
Â·
(Î¶
Ï‡
âˆ’
ÏƒÏ‡
);
Î±(Î¶
Ï‡
)
=
Ï‡(Î±)âˆ’1
Â·
Î¶
Ï‡
(where
Î±
is
a
point
of
Î¼n
valued
in
some
scheme).
Let
us
deï¬ne
def
Î´
Ï‡
(f
)
=
{Ï‡(1et
)
Â·
1et
(f
)}
âˆ’
f
(Thus,
formally,
Î´
Ï‡
(f
Â·
g)
=
Î´
Ï‡
(f
)
Â·
1et
(g)
+
f
Â·
Î´(g),
where
Î´(g)
=
1et
(g)
âˆ’
g
is
as
in
Chapter
III,
Â§6.)
Then
we
have
Î´
Ï‡
(Î¶
Ï‡
)
=
âˆ’ÏƒÏ‡
Note
that
if
Ï‡
is
the
trivial
character,
n
=
2,
and
2
âˆˆ
O
Ã—
,
then
Î¶
Ï‡
is
simply
(in
the
notation
of
Chapter
III,
Â§5)
â€œ(Î¶
+
C)
Â·
Ïƒ
2
â€
for
some
C
âˆˆ
A.
119
Now
we
would
like
to
generalize
Î¶
Ï‡
in
precisely
the
way
we
generalized
Î¶
in
Chapter
III,
Â§6.
To
do
this,
we
would
like
to
consider
extension
polynomials
â€“
i.e.,
sections
of
the
sheaf
Retâ€ 
of
Chapter
III,
Proposition
6.1
â€“
but
this
time
(unlike
in
Chapter
III,
Â§6)
with
EC
âˆ
coeï¬ƒcients
that
are
sections
of
LâŠ—n
C
âˆ
over
C
.
In
other
words,
we
would
like
to
consider
sections
of
R
âŠ—n
â€ 
âŠ—OC
LC
et
EC
S
S
over
C
âˆ
.
S
Also,
whereas
before
we
considered
Zet
-invariant
extension
polynomials,
this
time
we
would
like
to
consider
extension
polynomials
on
which
Zet
Ã—
Î¼n
acts
via
the
character
Ï‡
â€“
i.e.,
polynomials
which
are
(Zet
Ã—
Î¼n
)-invariant
when
Ï‡
considered
as
sections
of
Retâ€ 
âŠ—OC
(LâŠ—n
C
âˆ
)
.
Other
than
these
formal
changes,
however,
EC
S
the
proofs
proceed
just
as
for
Chapter
III,
Â§6,
Lemma
6.3,
Theorem
6.4.
The
end
result
is
the
following:
Theorem
3.1.
Let
r
be
a
nonnegative
integer,
and
Ï‡
âˆˆ
Hom(Î n
,
(Î¼n
)S
).
Then
there
exists
a
(Zet
Ã—
Î¼n
)-invariant
extension
polynomial
r

f=
Ï‡
Î¶râˆ’i
Â·
T
[i]
i=0
Ï‡
Ï‡
(where
the
coeï¬ƒcients
lie
in
Î“(C
âˆ
,
(LâŠ—n
C
âˆ
)
)),
such
that
Î¶0
=
ÏƒÏ‡
;
S
S
Ï‡
Ï‡
Ï‡
Î´
Ï‡
(Î¶râˆ’i
)
+
Î´
Ï‡
(Î¶râˆ’iâˆ’1
)
+
Î¶râˆ’iâˆ’1
=0
Ï‡
(for
all
i);
and
all
the
Î¶jÏ‡
âˆˆ
Î“(C
âˆ
,
(LâŠ—n
C
âˆ
)
)
are
Î¼n
-invariant.
In
particular,
we
have
S
S
Ï‡
Ï‡
Î´
Ï‡
(Î¶jÏ‡
)
=
âˆ’Î¶jâˆ’1
+
Î¶jâˆ’2
âˆ’
...
+
(âˆ’1)jâˆ’1
Î¶1Ï‡
+
(âˆ’1)j
Î¶0Ï‡
(for
all
j).
Finally,
if
Î¶0Ï‡
,
.
.
.
,
Î¶rÏ‡
satisfy
the
same
conditions
as
Î¶0Ï‡
,
.
.
.
,
Î¶rÏ‡
,
then
for
each
j
=
0,
.
.
.
,
r,
Ï‡
Î¶jÏ‡
âˆ’
Î¶jÏ‡
=
some
Aâˆ’linear
combination
of
Î¶0Ï‡
,
.
.
.
,
Î¶jâˆ’1
(where
A
=
O[[q]]).
Remark.
Just
as
in
the
non-twisted
case
(cf.
Chapter
III,
Â§6,
Theorem
6.4),
we
may
take
Î¶1Ï‡
=
Î¶
Ï‡
.
Also,
(just
as
in
Chapter
III,
Â§6,
Remark
2)
everything
we
did
here
can
also
be
done
in
the
complex
analytic
context.
120
Similarly,
one
may
generalize
the
canonical
Schottky-Weierstrass
zeta
functions
of
Chapter
III,
Â§7,
to
the
present
twisted
context,
as
follows.
First,
we
assume
for
the
remainder
of
the
Â§
that
O
is
a
ï¬nite
extension
of
Q.
Then
we
deï¬ne
the
operator
Î´
âˆ—
on
LâŠ—n
C
âˆ
by
S
f
â†’
Î´
âˆ—
(f
)
=
def
1
Â·
âˆ‡(U
âˆ‚
)
(f
)
âˆ‚U
n
âŠ—2m
âŠ—2
where
âˆ‡
is
the
connection
induced
on
LâŠ—n
C
âˆ
=
LC
âˆ
by
the
connection
on
LC
âˆ
of
Chapter
S
S
S
III,
Theorem
5.6;
and
U
is
the
standard
multiplicative
coordinate
on
ES
(as
in
Â§2).
One
checks
easily
that
the
natural
action
of
Î¼n
on
Î´
âˆ—
is
trivial
and
that:
[Î´
âˆ—
,
Î´
Ï‡
]
=
Ï‡(1et
)
Â·
1et
Also,
just
as
in
Chapter
III,
Â§7,
we
may
also
deï¬ne
a
tautological
connection
(on
the
universal
extension),
as
well
as
a
corresponding
diï¬€erential
operator
(Î´
taut
)âˆ—
.
Thus,
by
the
same
formal
arguments
as
those
used
to
derive
Chapter
III,
Theorem
7.4,
in
Chapter
III,
we
obtain
the
following
result:
Theorem
3.2.
(Divided
Power
Twisted
Canonical
Schottky-Weierstrass
FuncÏ‡
tions)
Let
Ï‡
âˆˆ
Hom(Î n
,
(Î¼n
)S
),
Î¶0PD,Ï‡
=
ÏƒÏ‡
âˆˆ
Î“(C
âˆ
,
(LâŠ—n
C
âˆ
)
).
Write
(for
r
âˆˆ
Zâ‰¥0
)
def
S
def
Î¶rPD,Ï‡
=
S
1
âˆ—
r
PD,Ï‡
(Î´
)
Î¶0
r!
def
PD,Ï‡
(and
let
Î¶rPD,Ï‡
=
0
if
r
<
0).
Then
Î´
âˆ—
(Î¶rPD,Ï‡
)
=
(r+1)Â·Î¶r+1
,
(Î´
Ï‡
)r
(Î¶rPD,Ï‡
)
=
(âˆ’1)r
Â·Î¶0PD,Ï‡
(if
r
â‰¥
0);
Î´
Ï‡
(Î¶rPD,Ï‡
)
=
râˆ’1
PD,Ï‡
PD,Ï‡
PD,Ï‡
1
1
i+r
=
âˆ’Î¶râˆ’1
+
12
Â·
Î¶râˆ’2
+
.
.
.
+
(âˆ’1)r
Â·
r!
Â·
Î¶0PD,Ï‡
i=0
(âˆ’1)
(râˆ’i)!
Î¶i
(for
all
r
âˆˆ
Z).
Moreover,
all
of
the
Î¶iPD,Ï‡
(for
i
âˆˆ
Z)
are
Î¼n
-invariant,
and,
in
fact,
the
APD,Ï‡
Ï‡
,
.
.
.
,
Î¶rPD,Ï‡
is
equal
to
the
A-submodule
of
submodule
of
Î“(C
âˆ
,
(LâŠ—n
C
âˆ
)
)
generated
by
Î¶0
S
S
Ï‡
Ï‡
r+1
.
In
particular,
Î¼n
-invariant
sections
of
Î“(C
âˆ
,
(LâŠ—n
C
âˆ
)
)
which
are
annihilated
by
(Î´
)
S
S
Ï‡
this
submodule
is
equal
to
the
A-submodule
of
Î“(C
âˆ
,
(LâŠ—n
C
âˆ
)
)
generated
by
the
functions
S
S
PD,Ï‡
PD,Ï‡
denoted
â€œÎ¶0
,
.
.
.
,
Î¶r
â€
in
Theorem
3.1.
Finally,
the
polynomial
def
Î¶rPD,Ï‡
[T
]
=
r

i=0
Î¶iPD,Ï‡
Â·
T
râˆ’i
Tr
T
(râˆ’1)
PD,Ï‡
Â·
T
+
Î¶rPD,Ï‡
=
Î¶0PD,Ï‡
Â·
+
Î¶1PD,Ï‡
Â·
+
.
.
.
+
Î¶râˆ’1
(r
âˆ’
i)!
r!
(r
âˆ’
1)!
121
Ï‡
(âˆˆ
Î“(C
âˆ
,
(LâŠ—n
C
âˆ
)
[T
]))
is
(Zet
Ã—
Î¼n
)-invariant
relative
to
the
natural
action
of
Zet
Ã—
Î¼n
S
S
âˆ
Ï‡
on
C
,
(LâŠ—n
âˆ
C
)
,
and
the
action
of
Zet
Ã—
Î¼n
on
T
S
(âˆ€Î±
âˆˆ
Î¼n
).
given
by
1et
(T
)
=
T
+
1,
Î±(T
)
=
T
S
Remark.
Just
as
was
the
case
with
Theorem
3.1,
Theorem
3.2
also
has
a
complex
analytic
version.
We
leave
the
routine
details
to
the
reader.
Also,
just
as
was
the
case
for
Chapter
III,
Theorem
7.4,
it
is
clear
from
the
formula
for
Î´
Ï‡
(Î¶rPD,Ï‡
)
that
the
denominators
that
occur
are
â€œessentialâ€
(i.e.,
they
cannot
be
eliminated
as
in
the
case
of
Theorem
3.1
simply
by
â€œredeï¬ning
the
integral
structureâ€).
Finally,
just
as
in
Chapter
III,
Â§7,
we
may
also
deï¬ne
the
twisted
version
of
binomial
canonical
Schottky-Weierstrass
zeta
functions
as
follows.
First,
let
us
observe
that
there
is
a
unique
integer
iÏ‡
satisfying
âˆ’m
â‰¤
iÏ‡
<
m
such
that
the
monomials
of
Propostion
Ï‡
2.2,
when
considered
as
sections
of
(LâŠ—n
C
âˆ
)
),
are
Î¼n
-invariant
if
and
only
if
the
integer
i
S
(âˆˆ
{âˆ’m,
âˆ’m
+
1,
.
.
.
,
0,
.
.
.
,
m
âˆ’
1}
â€“
cf.
Proposition
2.2)
is
equal
to
iÏ‡
.
Then
we
have
the
following
result:
Theorem
3.3.
(Binomial
Twisted
Canonical
Schottky-Weierstrass
Functions)
Ï‡
BI,Ï‡
Let
Ï‡
âˆˆ
Hom(Î n
,
(Î¼n
)S
),
Î¶0BI,Ï‡
=
ÏƒÏ‡
âˆˆ
Î“(C
âˆ
,
(LâŠ—n
=
C
âˆ
)
).
Write
(for
r
âˆˆ
Zâ‰¥0
)
Î¶r
S
S
Î´âˆ—
âˆ’
iÏ‡

BI,Ï‡
n
(Î¶
);
0
r
def
def
Î¶rBI,Ï‡
[T
]
=
def

âˆ—
r
i


Î´
+
T
âˆ’
nÏ‡
BI,Ï‡
Î¶jBI,Ï‡
Â·
T
[râˆ’j]
(Î¶0
)
=
r
j=0
Then
the
Î¶nBI,Ï‡
,
Î¶nBI,Ï‡
[T
]â€™s
satisfy
the
properties
of
Theorem
3.1
(where
we
take
â€œÎ¶nÏ‡
â€
of
Theorem
6.4
to
be
Î¶nBI,Ï‡
;
â€œf
â€
of
Theorem
6.4
to
be
Î¶nBI,Ï‡
[T
]).
In
particular,
the
Î¶nBI,Ï‡
[T
]â€™s
are
Zet
-invariant.
Finally,
the
Î¶nBI,Ï‡
[T
]â€™s
are
integral
over
Z.
Proof.
It
remains
only
to
verify
integrality
over
Z.
But
this
follows
from
observing
that,
by
the
deï¬nition
of
iÏ‡
,
Î¶0BI,Ï‡
may
be
thought
of
as
a
series
in
the
monomials
ket
(U
iÏ‡
Â·
Î¸
m
)
i
(for
k
âˆˆ
Z)
of
Proposition
2.2.
Moreover,
the
operator
Î´
âˆ—
âˆ’
nÏ‡
acts
on
the
monomial
ket
(U
iÏ‡
Â·
Î¸
m
)
=
q
mÂ·k
+iÏ‡
Â·k
Â·
U
2mk+iÏ‡
Â·
Î¸
m
2
i
by
multiplication
by
n1
(2mk
+
iÏ‡
)
âˆ’
nÏ‡
=
k.
Thus,
the
operator


monomial
by
multiplication
by
nk
âˆˆ
Z,
as
desired.

122
Î´âˆ—
âˆ’
iÏ‡

r
n
acts
on
this
Â§4.
Zhangâ€™s
Theory
of
Metrized
Line
Bundles
In
this
Â§,
we
review
the
theory
of
[Zh]
in
the
case
of
elliptic
curves.
Roughly
speaking,
this
theory
allows
one
to
compute
intersection
numbers
of
vertical
divisors
in
the
special
ï¬ber
of
an
elliptic
curve
with
multiplicative
reduction
using
the
techniques
of
classical
harmonic
analysis
on
a
circle.
In
fact,
here,
we
will
use
a
slight
generalization
of
Zhangâ€™s
1-dimensional
theory
to
the
2-dimensional
case,
so
in
the
following,
we
will
give
precise
deï¬nitions
and
statements
of
basic
facts.
The
proofs,
however,
will
be
omitted
since
they
are
entirely
the
same
as
those
of
[Zh].
Let
R
be
a
valuation
ring
whose
valuation
group
is
an
ordered
submodule
of
R.
We
denote
its
valuation
|
âˆ’
|R
:
R
â†’
R
and
assume
that
we
are
given
an
element
Ï€
âˆˆ
R
such
that
|Ï€|R
=
eâˆ’1
,
and
all
positive
rational
powers
of
the
ideal
Ï€
Â·
R
exist
(as
ideals
of
R).
In
other
words,
we
want
to
think
of
the
copy
of
R
that
contains
the
valuation
group
of
R
as
being
â€œâˆ’R
Â·
log(Ï€)â€
(where
log(Ï€)
is
to
be
regarded
as
a
formal
symbol).
We
denote
the
quotient
ï¬eld
of
R
by
F
.
Let
V
be
a
ï¬nite
dimensional
F
-vector
space.
Then
we
will
refer
to
as
a
metric
on
V
any
map
|
âˆ’
|V
:
V
â†’
R
such
that:
(i)
|Î»
Â·
v|V
=
|Î»|R
Â·
|v|V
,
for
all
Î»
âˆˆ
R,
v
âˆˆ
V
;
(ii)
|v
+
w|V
â‰¤
max(|v|V
,
|w|V
),
for
all
v,
w
âˆˆ
V
;
(iii)
the
set
def
MV
=
{v
âˆˆ
V
|
|v|V
â‰¤
1}
is
nbounded
(i.e.,
given
any
basis
v1
,
.
.
.
,
vn
of
V
,
there
exists
a
Î»
âˆˆ
R
such
that
MV
âŠ†
i=1
R
Â·
Î»
Â·
vi
).
Thus,
MV
forms
an
R-submodule
of
V
which
is
bounded,
saturated
â€”
in
the
sense
that
M=

(Ï€
âˆ’r
M
)
râˆˆQ>0
â€”
and
generates
V
over
F
.
Conversely,
given
any
bounded,
saturated
R-submodule
M
of
V
which
generates
V
over
F
,
one
can
naturally
deï¬ne
a
metric
|
âˆ’
|V
on
V
such
that
M
=
MV
as
follows:
For
any
nonzero
rational
section
v
âˆˆ
V
,
we
let
|v|V
=
eâˆ’r0
def
123
where
r0
âˆˆ
R
is
the
supremum
of
the
set
of
rational
numbers
r
such
that
the
section
Ï€
âˆ’r
Â·
v
âˆˆ
M
.
In
other
words,
metrics
on
V
are
equivalent
to
bounded,
saturated
Rsubmodules
of
V
that
generate
V
over
F
.
This
makes
it
clear,
for
instance,
how
to
deï¬ne
tensor
products
of
metrics.
Indeed,
the
tensor
product
of
|
âˆ’
|V
,
|
âˆ’
|W
on
V
âŠ—F
W
is
the
metric
corresponding
to
the
saturation
(i.e.,
the
smallest
saturated
module
containing
the
given
module)
of
the
bounded
R-submodule
Image(MV
âŠ—R
MW
)
âŠ†
V
âŠ—F
W
.
If
dimF
(V
)
=
1,
then
a
metric
|
âˆ’
|V
on
V
is
completely
determined
by
its
value
on
any
ï¬xed
nonzero
element
v
âˆˆ
V
.
Thus,
it
follows
that
the
metrics
on
V
naturally
form
an
(additive)
torsor
over
R.
Moreover,
the
metrics
on
the
F
-vector
space
F
may
be
naturally
identiï¬ed
(by
looking
at
the
value
of
the
metric
on
1
âˆˆ
F
)
with
R
itself.
Next,
let
us
return
to
the
set-up
of
Â§2.
Recall
that
we
have
a
one-dimensional
semiabelian
variety
Eâ†’S
equipped
with
a
compactiï¬cation
C
â†’
S.
Here,
S
=
Spec(A),
A
=
O[[q]].
Now
let
(for
N
â‰¥
1
an
integer)
def
AN
=
A[q
1/N
];
def
Aâˆ
=

AN
;
def
SN
=
Spec(AN
);
def
Sâˆ
=
Spec(Aâˆ
)
N
â‰¥1
Thus,
SN
is
a
ï¬nite,
ï¬‚at
S-scheme,
and
Sâˆ
is
the
projective
limit
of
the
SN
â€™s.
Also,
let
us
write
US
=
Spec(A[q
âˆ’1
])
âŠ†
S
def
and
USN
,
USâˆ
,
etc.
for
the
inverse
images
in
SN
,
Sâˆ
,
etc.
of
US
.
Note
that
E|US
Ã—US
USN
has
a
unique
regular
semi-stable
model
CN
â†’
SN
over
SN
.
We
denote
the
complement
of
the
nodes
of
CN
by
EN
â†’
SN
Thus,
the
special
ï¬ber
(i.e.,
the
zero
locus
of
q
1/N
)
of
EN
is
a
union
of
N
copies
of
(Gm
)O
.
Write
def
Câˆ
=
lim
CN
â†’
Sâˆ
=
lim
SN
â†âˆ’
â†âˆ’
124
for
the
inverse
limit
of
the
CN
â†’
SN
,
where
N
ranges
over
the
multiplicative
semigroup
of
positive
integers.
Thus,
note
that
we
have
natural
open
immersions
EN
Ã—SN
Sâˆ
â†’
Câˆ
If
we
take
the
union
of
these
open
subschemes
of
Câˆ
over
N
,
we
obtain
an
open
subscheme
Eâˆ
âŠ†
Câˆ
which
has
the
structure
of
a
smooth
group
scheme
over
Sâˆ
.
Let
us
refer
to
the
prime
of
Aâˆ
generated
by
the
q
r
for
all
positive
rational
numbers
r
as
the
central
prime
of
Aâˆ
.
The
localization
of
Aâˆ
at
the
central
prime
is
a
valuation
ring
with
value
group
Q.
For
geometric
objects
over
Sâˆ
,
we
shall
refer
to
the
ï¬ber
of
such
an
object
over
the
central
prime
of
Sâˆ
as
the
special,
or
central,
ï¬ber
of
the
object.
Observe
that
the
connected
components
of
the
special
ï¬ber
of
EN
may
be
naturally
identiï¬ed
with
1
Z/Z
N
Here,
the
Z
should
be
thought
of
as
â€œZ
Â·
log(q)â€
(where
log(q)
is
a
formal
symbol).
Indeed,
[n]
just
as
in
Â§2,
C
âˆ
formed
a
Galois
cover
of
C
with
Galois
group
n
Â·
Zet
such
that
the
S
S
(irreducible)
components
of
the
special
ï¬ber
of
C
[n]
could
be
naturally
identiï¬ed
with
Zet
/N
Â·
Zet
,
there
exists
a
natural
inï¬nite
Galois
cover
of
(CN
)S
with
Galois
group
Z
N
(which
is
a
blow-up
of
the
pull-back
to
SN
of
the
Z-Galois
cover
C
âˆ
â†’
CS
)
such
that
the
S
components
of
the
special
ï¬ber
of
CN
may
be
identiï¬ed
with
N1
Z/Z,
as
desired.
By
taking
the
limit
over
N
,
we
thus
obtain
that
the
components
of
the
special
ï¬ber
of
Câˆ
may
be
identiï¬ed
with
Q/Z
âŠ†
R/Z
=
S1
In
the
following,
we
would
like
to
do
functional
analysis
on
S1
.
To
this
end,
we
deï¬ne
Func(S1
)
to
be
the
set
of
piecewise
smooth
continuous
functions
on
S1
,
i.e.,
continuous
functions
that
are
inï¬nitely
diï¬€erentiable,
except
at
a
ï¬nite
number
of
points
of
S1
.
A
crucial
ingredient
of
the
theory
of
[Zh]
is
the
notion
of
â€œdivisors
on
S1
â€
(cf.
[Zh],
Â§2.1).
Let
us
write
125
Div(S1
)
=
Z[Q/Z]
def
for
the
set
of
ï¬nite
formal
sums
of
elements
of
Q/Z
with
Z-coeï¬ƒcients.
We
will
regard
such
formal
sums
as
divisors
on
S1
.
Next,
we
let
Div(S1
)
=
Div(S1
)
âŠ•
Func(S1
)
def
be
the
group
of
compactiï¬ed
divisors
on
S1
.
Given
a
compactiï¬ed
divisor
D
+
g
(i.e.,
D
âˆˆ
Div(S1
),
g
âˆˆ
Func(S1
),
we
deï¬ne
the
curvature
of
D
+
g
to
be
def
hD+g
=
Î´D
âˆ’
Î”(g)
Here,
Î´D
is
the
delta
distribution
associated
to
the
divisor
D,
i.e.,
if
f
âˆˆ
Func(S1
),
and
D
=
i
ci
Â·
pi
(for
ci
âˆˆ
Z;
pi
âˆˆ
Q/Z),
then
def
<
Î´D
,
f
>
=

ci
Â·
f
(pi
)
i
while
Î”(g)
is
the
distribution
obtained
by
applying
the
Laplacian
operator
Î”
to
g,
i.e.,
if
f
âˆˆ
Func(S1
),
then
âˆ‚2g
<
Î”(g),
f
>
=
âˆ’
fÂ·
2
âˆ‚Î¸
S1
def
(where
âˆ‚/âˆ‚Î¸
is
the
standard
unit
tangent
vector
on
S1
,
i.e.,
the
tangent
vector
whose

reciprocal
dÎ¸
satisï¬es
S1
dÎ¸
=
1).
One
also
deï¬nes
an
intersection
pairing
on
compactiï¬ed
divisors
on
S1
by:
def
(D1
+
g1
,
D2
+
g2
)
=
<
Î´D1
,
g2
>
+
<
Î´D2
,
g1
>
âˆ’
S1
g1
Î”(g2
)
Next,
we
would
like
to
consider
line
bundles
on
Eâˆ
|US
.
First,
if
p
denotes
a
prime
of
the
special
ï¬ber
of
Eâˆ
,
then
we
shall
write
Op
for
the
completion
of
OEâˆ
at
p,
and
Kp
for
its
quotient
ï¬eld.
Thus,
Op
is
a
valuation
ring
with
valuation
group
equal
to
Q
(times
â€œlog(q)â€).
By
the
above
discussion,
such
p
are
in
natural
bijective
correspondence
with
the
set
Q/Z.
126
Deï¬nition
4.1.
We
deï¬ne
a
pre-metrized
line
bundle
(L,
|
âˆ’
|L
)
on
Eâˆ
to
be
a
pair
(L,
|
âˆ’
|L
)
consisting
of
a
line
bundle
L
on
Eâˆ
|US
,
together
with
a
set
of
metrics
(as
deï¬ned
above)
|
âˆ’
|L
=
{|
âˆ’
|Lp
}p
(where
p
ranges
over
all
primes
in
the
special
ï¬ber
of
Eâˆ
)
for
the
one-dimensional
Kp
def
vector
space
Lp
=
L
âŠ—OEâˆ
Kp
.
We
will
call
a
pre-metrized
line
bundle
(L,
|
âˆ’
|L
)
a
metrized
line
bundle
if
for
some
nonzero
rational
section
Ï†
of
L
over
Eâˆ
,
the
real-valued
function
deï¬ned
on
Q/Z
âŠ†
S1
by
p
â†’
âˆ’log(|Ï†|Lp
)
is
the
restriction
to
Q/Z
âŠ†
S1
of
a
function
in
Func(S1
).
We
denote
the
group
of
metrized
line
bundles
on
Eâˆ
by
Pic(Eâˆ
).
Remark
1.
The
deï¬nition
of
a
metrized
line
bundle
given
here
is
slightly
diï¬€erent
from
that
of
[Zh].
Nevertheless,
the
metrized
line
bundles
that
are
ultimately
dealt
with
in
[Zh]
(cf.
[Zh],
Â§2.5)
are
precisely
the
sort
deï¬ned
in
Deï¬nition
4.1.
In
[Zh],
however,
such
bundles
are
not
given
an
explicit
name.
Remark
2.
If
L
is
a
line
bundle
(in
the
usual
sense)
on
Eâˆ
obtained
by
pull-back
from
a
line
bundle
on
CN
for
some
N
,
then
the
metrics
|
âˆ’
|Lp
given
by
letting
the
absolute
value
of
a
generator
of
L
at
p
be
equal
to
1
deï¬ne
on
L
the
structure
of
a
metrized
line
bundle.
Thus,
the
notion
of
a
metrized
line
bundle
on
Eâˆ
generalizes
the
notion
of
a
line
bundle
on
Eâˆ
obtained
by
pull-back
from
a
line
bundle
on
CN
.
One
also
has
a
notion
of
compactiï¬ed
divisors
on
Eâˆ
,
corresponding
to
the
notion
of
a
metrized
line
bundle.
This
group
of
compactiï¬ed
divisors
is
deï¬ned
by
Div(Eâˆ
)
=
Div(Eâˆ
|US
)
âŠ•
Func(S1
)
def
(where
â€œDiv(Eâˆ
|US
)â€
is
the
usual
group
of
Weil
divisors
on
the
US
-smooth
scheme
Eâˆ
|US
).
Any
divisor
compactiï¬ed
divisor
D
+g
on
Eâˆ
deï¬nes
a
metrized
line
bundle
OEâˆ
(D
+g)
=
(L,
|
âˆ’
|L
)
as
follows:
First
of
all,
if
D
is
a
Weil
divisor
on
Eâˆ
|US
,
then
taking
the
closures
of
its
irreducible
components
deï¬nes
a
Weil
divisor
D
âŠ†
Eâˆ
on
Eâˆ
.
Moreover,
since
Eâˆ
|US
is
quasi-compact,
and
Eâˆ
is
an
inverse
limit
of
regular
schemes,
it
follows
that
D
is,
in
fact,
a
Cartier
divisor
(cf.
the
discussion
of
the
morphism
Ï
below
for
more
details).
Thus,
we
obtain
a
line
bundle
L
on
Eâˆ
.
Let
L
be
the
restriction
of
L
to
Eâˆ
|US
.
Then
it
127
remains
to
deï¬ne,
for
each
p
âˆˆ
Q/Z,
a
metric
|
âˆ’
|Lp
on
Lp
.
This
metric
is
obtained
by
letting
generators
of
L
at
p
have
absolute
value
exp(âˆ’g(p)).
This
correspondence
D
+
g
â†’
OEâˆ
(D
+
g)
thus
deï¬nes
a
surjection
Div(Eâˆ
)
â†’
Pic(Eâˆ
)
Under
this
correspondence,
if
v
âˆˆ
N1
Z/Z
is
a
component
in
the
special
ï¬ber
of
CN
â€“
which
thus
deï¬nes
a
line
bundle
on
CN
â€“
then
the
element
of
Pic(Eâˆ
)
corresponding
to
this
line
bundle
(cf.
Remark
2
above)
is
the
image
under
the
above
surjection
of
the
compactiï¬ed
divisor
g
âˆˆ
Func(S1
),
where
g
is
the
piecewise
linear
function
on
S1
which
is
linear
on
the
complement
of
N1
Z/Z,
equal
to
N1
at
v,
and
equal
to
0
at
all
points
of
(
N1
Z/Z)\{v}.
Next,
we
recall
that
one
has
a
natural
morphism
Ï
:
Div(Eâˆ
|US
)
â†’
Div(S1
)
deï¬ned
as
follows:
To
deï¬ne
Ï,
it
suï¬ƒces
to
deï¬ne
Ï
on
each
prime
divisor
in
Eâˆ
|US
.
First,
we
set
Ï
to
be
0
on
all
prime
divisors
which
are
not
US
-ï¬‚at.
If
DUS
âŠ†
Eâˆ
|US
is
US
-ï¬‚at,
then
since
Eâˆ
|US
is
an
inverse
limit
of
regular
schemes,
DUS
will
be
a
Cartier
divisor,
hence,
in
particular,
a
US
-scheme
of
ï¬nite
presentation.
Thus,
DUS
will
arise
by
base
change
from
some
divisor
(DUS
)N
âŠ†
EN
|US
.
Write
DN
âŠ†
CN
for
the
closure
of
(DUS
)N
in
CN
.
Let
DN
â†’
DN
be
the
normalization
of
DN
.
Thus,
DN
â†’
SN
is
ï¬nite
and
ï¬‚at
(since
SN
is
regular
of
dimension
2
and
DN
is
normal,
hence
has
depth
2).
Note
that
since
the
prime
V
(q
1/N
)
âŠ†
SN
is
regular
of
height
1
and
has
characteristic
zero
residue
ï¬eld,
it
follows
(by
Abhyankarâ€™s
Lemma)
that
the
ramiï¬cation
of
any
ramiï¬ed
extension
of
the
localization
of
OSN
at
this
prime
may
be
annihilated
by
adjoining
roots
of
q
to
OSN
.
In
particular,
by
taking
N
suï¬ƒciently
large,
we
may
assume
that
DN
â†’
SN
is
eÌtale
at
all
characteristic
0
primes
of
height
1.
But
then
it
follows
from
the
fact
that
CN
is
regular,
that
no
characteristic
0
height
1
prime
of
DN
can
map
to
a
node
of
CN
.
(Indeed,
if
R
is
a
complete
discrete
valuation
ring,
and
R
is
an
unramiï¬ed
extension
of
R
(so
R
is
also
a
complete
discrete
valuation
ring),
then
any
R
-valued
point
of
R[[x,
y]]/(xy
âˆ’
Ï€)
(where
x,
y
are
indeterminates,
Ï€
is
a
uniformizer
of
R)
would
imply
the
existence
of
an
R-homomorphism
R[[x,
y]]/(xy
âˆ’
Ï€)
â†’
R
for
which
the
images
of
x
and
y
lie
in
the
maximal
ideal
mR
.
But
this
implies
that
the
image
of
Ï€
in
R
lies
in
m2R
,
which
contradicts
the
assumption
that
R
is
unramiï¬ed
over
R.)
Thus,
there
exists
a
closed
subscheme
FN
âŠ†
DN
of
positive
characteristic
(i.e.,
such
that
FN
âŠ—
Q
=
âˆ…)
such
that
DN
\FN
âŠ†
EN
.
In
particular,
the
closure
Dâˆ
of
DUS
in
Câˆ
will
also
satisfy:
Dâˆ
\Fâˆ
âŠ†
Eâˆ
128
for
some
closed
subscheme
of
positive
characteristic
Fâˆ
âŠ†
Dâˆ
.
For
each
characteristic
0
height
1
prime
p
of
DN
,
let
us
write
Comp(p)
âˆˆ
Q/Z
for
the
irreducible
component
of
the
special
ï¬ber
Eâˆ
that
contains
p.
Then
we
deï¬ne
def
Ï(DUS
)
=

p
[k(p)
:
Q(O)]
Â·
Comp(p)
where
p
ranges
over
the
characteristic
0
height
one
primes
of
DN
;
k(p)
is
the
residue
ï¬eld
of
p;
Q(O)
is
the
quotient
ï¬eld
of
O
=
AN
/(q
1/N
);
and
â€œ[âˆ¼:âˆ¼]â€
denotes
the
degree
of
a
ï¬eld
extension.
One
checks
easily
that
(for
N
suï¬ƒciently
large)
this
deï¬nition
is
independent
of
N
.
This
completes
the
deï¬nition
of
Ï.
Now
that
we
have
the
morphism
Ï,
we
may
deï¬ne
an
intersection
pairing
on
Div(Eâˆ
)
def
Div(Eâˆ
)
Ã—
Div(Eâˆ
)
â†’
Div(Sâˆ
)
=
Div(Sâˆ
)
âŠ•
R
(where
â€œÃ—
â€
denotes
pairs
of
compactiï¬ed
divisors
D1
+
g1
,
D2
+
g2
such
that
the
generic
points
of
the
supports
of
D1
and
D2
do
not
intersect)
as
follows:
If
D1
,
D2
are
(Cartier)
divisors
on
Eâˆ
|US
such
that
the
generic
points
of
their
supports
do
not
intersect,
then
taking
the
closures
of
their
supports
deï¬nes
(Cartier)
divisors
D
1
,
D
2
on
Eâˆ
|US
(cf.
the
discussion
above).
Thus,
we
deï¬ne
i(D1
,
D2
)
âˆˆ
Div(Sâˆ
)
as
the
usual
intersection
divisor
D
1
Â·
D
2
of
D1
and
D
2
.
Then
the
intersection
pairing
for
compactiï¬ed
divisors
is
deï¬ned
by:
def
(D1
+
g1
,
D2
+
g2
)
=
i(D1
,
D2
)
+
(Ï(D1
)
+
g1
,
Ï(D2
)
+
g2
)
(where
the
second
â€œ(âˆ’,
âˆ’)â€
is
an
intersection
number
of
compactiï¬ed
divisors
on
S1
,
hence
âˆˆ
R).
Ultimately,
we
shall
wish
to
do
intersection
theory
not
over
â€œlocal
objectsâ€
such
as
S,
but
over,
for
instance,
(M1,0
)Z
or
ï¬nite
ï¬‚at
coverings
of
(M1,0
)Z
.
In
that
sort
of
global
context,
one
can
â€œglue
togetherâ€
the
usual
intersection
theory
over
(M1,0
)Z
with
the
intersection
theory
of
[Zh]
to
obtain
a
global
intersection
theory
for
line
bundles
on
the
tautological
log
elliptic
curve
over
coverings
of
(M1,0
)Z
which
are
equipped
with
a
metric
â€œat
inï¬nity.â€
We
leave
the
â€œgeneral
nonsenseâ€
details
to
the
reader.
Next,
we
would
like
to
consider
the
curvatures
of
compactiï¬ed
divisors
and
metrized
line
bundles.
If
D
+
g
âˆˆ
Div(Eâˆ
),
then
its
curvature
is
deï¬ned
to
be:
def
hD+g
=
hÏ(D)+g
129
(where
the
right-hand
side
is
the
curvature
of
the
compactiï¬ed
divisor
Ï(D)+g
âˆˆ
Div(S1
)).
If
L
=
OEâˆ
(D
+
g)
is
a
metrized
line
bundle,
then
we
deï¬ne
the
curvature
of
L
to
be:
def
hL
=
hD+g
This
deï¬nition
is
independent
of
the
choice
of
D
+
g
(cf.
[Zh],
Â§2.5).
Note
that
in
both
cases,
the
curvature
is
a
distribution
on
S1
.
Its
integral
over
S1
is
given
by
(cf.
[Zh],
Â§2.5):
S1
hL
=
deg(L|US
)
the
degree
of
L
on
the
generic
ï¬ber
of
Eâˆ
.
Intuitively
speaking,
The
value
of
the
curvature
hL
at
a
point
a
âˆˆ
Q/Z
âŠ†
S1
should
be
thought
of
as
the
degree
of
the
â€œrestrictionâ€
of
L
to
the
irreducible
component
of
the
special
ï¬ber
of
Câˆ
corresponding
to
a.
Deï¬nition
4.2.
A
metrized
line
bundle
or
compactiï¬ed
divisor
on
Eâˆ
is
said
to
be
admissible
if
its
curvature
is
the
distribution
given
by
a
constant
function
on
S1
.
If
a
metrized
line
bundle
L
is
admissible,
then
its
curvature
hL
is,
in
fact,
the
constant
given
by
deg(L|US
).
Proposition
4.3.
If
L1
=
(L1
,
|âˆ’|L1
)
and
L2
=
(L2
,
|âˆ’|L2
)
are
metrized
line
bundles
on
Eâˆ
such
that
L1
âˆ¼
=
L2
(as
line
bundles
on
Eâˆ
|US
)
and
hL1
=
hL2
,
then
L1
âˆ¼
=
L2
âŠ—OEâˆ
(C)
1
(as
metrized
line
bundles),
where
C
âˆˆ
Func(S
)
is
a
constant
function.
In
particular,
if
L1
=
(L1
,
|
âˆ’
|L1
)
and
L2
=
(L2
,
|
âˆ’
|L2
)
are
both
admissible
metrized
line
bundles
on
Eâˆ
such
that
L1
âˆ¼
=
L2
(as
line
bundles
on
Eâˆ
|US
),
then
L1
âˆ¼
=
L2
âŠ—
OEâˆ
(C)
(as
metrized
line
bundles),
where
C
âˆˆ
Func(S1
)
is
a
constant
function.
âˆ’1
Proof.
By
considering
L1
âŠ—
L2
,
it
suï¬ƒces
to
consider
the
case
where
L1
is
the
trivial
metrized
line
bundle.
Then
L2
is
deï¬ned
by
some
compactiï¬ed
divisor
g
âˆˆ
Func(S1
).
Moreover,
since
hL1
=
0,
we
have
hg
=
âˆ’Î”(g)
=
0,
i.e.,
g
is
a
continuous
function
on
S1
whose
second
(distributional)
derivative
is
zero.
But
it
is
easy
to
see
that
such
a
function
g
is
necessarily
constant.

The
notion
of
admissible
metrized
line
bundles
will
be
of
fundamental
importance
in
the
following
discussion.
Thus,
it
is
of
interest
to
construct
admissible
metrized
line
bundles.
For
instance,
given
a
horizontal
(i.e.,
Sâˆ
-ï¬‚at)
divisor
130
D
âŠ†
Eâˆ
one
would
like
to
know
explicitly
which
function
gD
âˆˆ
Func(S1
)
is
the
unique
function
such
that
(i)

S1
gD
=
0
2
(ii)
D+gD
is
admissible
â‡â‡’
hD+gD
=
Î´Ï(D)
âˆ’Î”(gD
)
=
Î´ÏD
+
âˆ‚âˆ‚Î¸g2D
is
constant
Such
a
function
gD
will
be
called
the
Greenâ€™s
function
for
D.
Note
that
gD
depends
only
on
the
divisor
Ï(D)
on
S1
.
Thus,
we
will
also
write
gÏ(D)
for
gD
.
Let
D
âˆˆ
Div(S1
)
be
a
divisor
on
S1
.
We
would
like
to
consider
its
Green
function
gD
.
The
simplest
case
is
the
case
where
D
=
[0]
i.e.,
the
origin
of
[0]
âˆˆ
Q/Z
âŠ†
R/Z
=
S1
.
In
this
case,
we
will
denote
the
associated
Greenâ€™s
function
by
Ï†1
.
Proposition
4.4.
|Î¸|
â‰¤
12
,
by:
The
Greenâ€™s
function
Ï†1
associated
to
the
origin
[0]
is
given,
for
Ï†1
(Î¸)
=
1
1
2
1
Î¸
âˆ’
|Î¸|
+
2
2
12
where
Î¸
is
the
standard
coordinate
on
R
(regarded
as
a
covering
of
R/Z
=
S1
).
In
particular,
Ï†1
(Î¸)
âˆˆ
Q,
for
all
Î¸
âˆˆ
Q.
Alternatively,
in
terms
of
Fourier
expansions
on
S1
,
it
is
given
by:
Ï†1
(Î¸)
=

1
Â·
4Ï€
2
0=nâˆˆZ
1
2Ï€inÎ¸
e
n2
1
In
particular,
Ï†1
(0)
=
12
(where
we
recall
that
we
think
of
the
values
of
Ï†1
as
being
in
1
â€œlog(q)â€
units)
is
the
maximum
value
attained
by
Ï†1
,
and
Ï†1
(
12
)
=
âˆ’
24
is
the
minimum
value
attained
by
Ï†1
.
Proof.
The
polynomial
representation
of
the
Greenâ€™s
function
Ï†1
is
given
in
[Zh],
Â§a.8,
p.
193.
The
Fourier
expansion
may
be
derived
as
the
unique
(topological)
linear
combination
of
e2Ï€in
â€™s
(for
n
âˆˆ
Z)
whose
ï¬rst
derivative
is
square
integrable
on
S1
(hence
is
continuous),
1
,
and
whose
second
derivative
is
the
distribution
deï¬ned
by
whose
value
at
0
is
12
131
1
âˆ’
Î´[0]
=
âˆ’

e2Ï€in
0=nâˆˆZ
on
S1
.
The
assertions
concerning
the
maximum
and
minimum
values
of
Ï†1
follow
from
elementary
calculus.

Corollary
4.5.
Let
a,
b
âˆˆ
Q/Z.
Then
the
Greenâ€™s
function
Ï†a,b
associated
to
the
divisor
a
âˆ’
b
on
S1
is
the
unique
piecewise
linear
function
on
S1
which
is
linear
(with
respect
to
Î¸)
away

from
a
and
b,
has
second
(distributional)
derivative
equal
to
Î´b
âˆ’
Î´a
,
and
is
such
that
S1
Ï†a,b
=
0.
Moreover,
Ï†a,b
has
a
global
minimum
at
b
and
a
global
maximum
at
a.
Proof.
This
follows
from
the
polynomial
representation
of
Proposition
4.4
by
direct
computation.

Corollary
4.6.
Let
N
be
a
positive
integer.
Write
Ï†N
for
the
Greenâ€™s
function
of
the
N
âˆ’1
divisor
i=0
[
Ni
].
Then
the
Fourier
expansion
of
Ï†N
is
given
by:
Ï†N
(Î¸)
=

1
Â·
4Ï€
2
Â·
N
0=nâˆˆZ
1
1
2Ï€inÎ¸Â·N
e
=
Ï†1
(N
Â·
Î¸)
2
n
N
1
In
particular,
Ï†N
(0)
=
12Â·N
(where
we
recall
that
we
think
of
the
values
of
Ï†1
as
being
1
1
in
â€œlog(q)â€
units)
is
the
maximum
value
attained
by
Ï†N
,
and
Ï†N
(
2N
)
=
âˆ’
24N
is
the
minimum
value
attained
by
Ï†1
.
Proof.
The
assertion
concerning
the
Fourier
expansion
follows
by
adding
up
the
translates
of
the
Fourier
expansion
of
Proposition
4.4.
The
assertions
concerning
the
maximum
and
minimum
values
of
Ï†N
follow
by
thinking
of
Ï†N
(Î¸)
as
N1
Â·
Ï†1
(N
Â·
Î¸).

Note
that
the
use
of
Greenâ€™s
functions
allows
one
to
construct
metrized
line
bundles
with
arbitrary
prescribed
restrictions
to
the
special
ï¬ber
of
Eâˆ
.
Indeed,
suppose
we
start
out
with
two
horizontal
divisors
D1
,
D2
âŠ†
Eâˆ
,
both
of
degree
d
(on
Eâˆ
|US
).
Then
consider
the
metrized
line
bundle
def
L
=
OEâˆ
(D1
+
gD1
âˆ’
gD2
)
The
restriction
of
L
to
a
component
of
the
special
ï¬ber
of
Eâˆ
,
which
amounts
to
the
curvature
hL
of
L
evaluated
at
the
point
of
S1
corresponding
to
that
component,
is
given
(cf.
Deï¬nition
4.2)
by:
132
hL
=
Î´D1
âˆ’
Î”(gD1
)
+
Î”(gD2
)
=
hD1
+gD1
âˆ’
hD2
+gD2
+
Î´D2
=
d
âˆ’
d
+
Î´D2
=
Î´D2
i.e.,
despite
the
fact
that
on
the
generic
ï¬ber
Eâˆ
|US
of
Eâˆ
,
L
is
just
the
line
bundle
associated
to
the
divisor
D1
,
on
the
special
ï¬ber
of
Eâˆ
,
L
looks
as
if
it
is
the
line
bundle
associated
to
the
divisor
D2
!
This
sort
of
metrized
line
bundle
will
play
a
key
role
in
this
paper.
Â§5.
Theta
Groups
and
Metrized
Line
Bundles
We
maintain
the
notation
of
Â§4.
Let
d
be
a
positive
integer;
g
âˆˆ
Func(S1
).
In
this
Â§,
we
would
like
to
study
the
metrized
line
bundle
on
Eâˆ
given
by:
def
L
=
OEâˆ
(d[e]
+
g)
(where
e
âˆˆ
Eâˆ
(Sâˆ
)
is
the
origin
of
the
group
object
Eâˆ
â†’
Sâˆ
,
and
[e]
is
the
horizontal
divisor
deï¬ned
by
its
image).
In
particular,
we
will
discuss
the
case
where
the
theta
groups
of
Â§1
act
on
L,
and
compute
(when
the
base
is
global)
the
degree
of
the
push-forward
of
L
to
such
a
global
base.
We
observe
that
although
the
issue
of
the
behavior
of
theta
groups
for
degenerating
elliptic
curves
is
also
discussed
in
[MB],
it
is
the
opinion
of
the
author
that
the
use
of
Zhangâ€™s
theory
of
metrized
line
bundles
substantially
clariï¬es
the
behavior
of
theta
groups
for
degenerating
elliptic
curves.
Note
ï¬rst
of
all
that
when
we
restrict
to
US
,
we
are
in
the
situation
discussed
in
Â§1.
In
particular,
there
is
a
theta
group
(GL
)US
associated
to
OE|US
(d
Â·
[e]).
The
group
scheme
(KL
)US
of
d-torsion
points
of
E|US
ï¬ts
into
an
exact
sequence
0
â†’
(Î¼d
)US
â†’
(KL
)US
â†’
(Z/dZ)US
â†’
0
Although
this
exact
sequence
does
not
extend
over
S,
if
one
base-changes
to
Sâˆ
,
then
it
extends
naturally
to
an
exact
sequence
of
group
schemes
over
Sâˆ
:
0
â†’
Î¼d
|Sâˆ
â†’
KL
|Sâˆ
â†’
(Z/dZ)|Sâˆ
â†’
0
where
KL
|Sâˆ
âŠ†
Eâˆ
is
a
closed
subgroup
scheme.
In
fact,
this
exact
sequence
splits,
so
we
have
a
noncanonical
isomorphism
KL
|Sâˆ
âˆ¼
=
{Î¼d
Ã—
(Z/dZ)}|Sâˆ
In
the
following,
we
will
denote
KL
|Sâˆ
by
133
KL
Thus,
the
action
of
KL
on
Eâˆ
preserves
the
line
bundle
L|US
.
We
would
like
to
investigate
the
extent
to
which
it
preserves
L:
Proposition
5.1.
The
action
of
KL
on
Eâˆ
preserves
L
if
and
only
if
translation
by
1
1
1
1
1
d
âˆˆ
d
Z/Z
âŠ†
S
on
S
preserves
the
curvature
hL
.
We
shall
call
such
distributions
on
S
d-invariant.
For
instance,
if
g
=
d
Â·
Ï†1
or
g
=
d
Â·
Ï†1
âˆ’
Ï†d
(cf.
Corollary
4.6),
then
the
resulting
curvature
will
be
d-invariant.
Proof.
The
automorphisms
of
S1
induced
by
the
action
of
KL
on
Eâˆ
are
precisely
those
given
by
adding
(integer)
multiples
of
d1
.
Thus,
the
necessity
of
the
condition
hL
(Î¸)
=
hL
(Î¸
+
d1
)
is
clear.
To
see
that
it
is
suï¬ƒcient,
we
reason
as
follows.
First
of
all,
since
SN
is
regular
of
dimension
2,
it
suï¬ƒces
to
prove
the
result
in
characteristic
0,
i.e.,
in
the
case
where
O
is
a
ï¬nite
extension
of
Q.
But
then
KL
is
eÌtale
over
Sâˆ
,
so
it
suï¬ƒces
to
prove
that
the
â€œphysicalâ€
automorphisms
of
Eâˆ
induced
by
Sâˆ
-rational
points
of
KL
preserve
L.
Let
Î±
be
such
an
automorphism
of
Eâˆ
that
induces
the
automorphism
Î¸
â†’
Î¸
+
d1
def
on
S1
.
Then
LÎ±
=
Î±âˆ—
L
is
a
metrized
line
bundle
on
Eâˆ
which
is
isomorphic
to
L
over
US
.
Moreover,
by
hypothesis,
hL
=
hLÎ±
.
Thus,
by
Proposition
4.3,
it
follows
that
L
and
LÎ±
diï¬€er
by
a
constant
C
âˆˆ
R.
If
this
constant
C
âˆˆ
Q,
then
multiplying
by
q
C
shows
that
L
âˆ¼
=
LÎ±
.
If
not,
then
since
Î±
has
order
d,
it
follows
that
C
deï¬nes
a
class
in
H
1
(Z/dZ,
R/Q)
=
Hom(Z/dZ,
R/Q)
=
0.
In
order
words,
it
follows
from
the
fact
that
the
automorphism
Î±
has
ï¬nite
order
(while
R/Q
is
torsion-free)
that
C
âˆˆ
Q,
so
L
âˆ¼
=
LÎ±
,
as
desired.
Thus,
it
remains
to
see
that
if
g
=
d
Â·
Ï†1
or
dÏ†1
âˆ’
Ï†d
,
then
hL
is
invariant
under
Î¸
â†’
Î¸
+
d1
.
But
if
g
=
d
Â·
Ï†1
,
then
hL
is
a
constant,
so
this
is
clear.
Moreover,
Ï†d
itself
is
invariant
under
Î¸
â†’
Î¸
+
d1
,
so
adding
Î”(Ï†d
)
does
not
eï¬€ect
the
invariance
under
Î¸
â†’
Î¸
+
d1
.
This
completes
the
proof.

Thus,
if
hL
is
d-invariant,
then
by
considering
pairs
(Î±,
Î¹),
where
Î±
is
a
point
of
KL
and
Î¹
:
TÎ±âˆ—
L
âˆ¼
=
L
(cf.
Â§1),
we
obtain
a
theta
group
scheme
GL
over
Sâˆ
which
extends
(GL
)USâˆ
.
In
particular,
if
f
:
Eâˆ
â†’
Sâˆ
is
the
structure
morphism,
then
we
may
deï¬ne
the
push-forward
fâˆ—
L
134
as
the
(quasi-coherent)
OS
-submodule
of
the
rank
d
vector
bundle
(f
|US
)âˆ—
(L|US
)
on
USâˆ
consisting
of
sections
whose
absolute
value
is
â‰¤
1
with
respect
to
the
|âˆ’|Lp
for
all
p
âˆˆ
Q/Z.
Then
fâˆ—
L
is
equipped
with
a
natural
action
of
GL
.
Since
it
is
not
diï¬ƒcult
to
construct
a
GL
-module
V
which
is
a
rank
d
vector
bundle
on
Sâˆ
and
on
which
Gm
âŠ†
GL
acts
via
the
standard
character
(cf.
Example
1.2),
it
follows
(cf.
Theorem
1.1
of
Â§1;
[MB],
Chapitre
V,
Corollaire
2.4.3)
that
fâˆ—
L
âˆ¼
=
M
âŠ—OSâˆ
V
Here,
M
and
its
restriction
MU
to
USâˆ
satisfy
the
following:
MU
is
a
line
bundle
on
USâˆ
;
and
M
is
a
quasi-coherent
OSâˆ
-submodule
of
jâˆ—
MU
(where
j
:
USâˆ
â†’
Sâˆ
is
the
natural
inclusion).
Note
that
since
USâˆ
is
quasi-compact
and
MU
(being
a
line
bundle)
is
of
ï¬nite
presentation,
it
follows
that
MU
arises
as
the
pull-back
of
a
line
bundle
on
some
USN
.
Thus,
MU
extends
to
a
line
bundle
M
on
Sâˆ
.
In
fact,
we
may
even
assume
that
M
âŠ†
M
(in
such
a
way
that
M
|US
=
M|US
).
Next,
let
us
observe
that
M
is
bounded
in
the
sense
that
there
exists
some
positive
rational
number
C
such
that
M
âŠ†
M
âŠ†
q
âˆ’C
Â·
M
(Indeed,
this
follows
from
the
fact
that
L
itself
is
â€œbounded.â€)
Moreover,
M
has
the
property
that
a
rational
section
of
M
is
integral
over
Sâˆ
if
and
only
if
it
is
integral
over
USâˆ
as
well
as
at
the
central
prime
V
({q
r
}râˆˆQ>0
)
âŠ†
Sâˆ
.
Since
the
localization
of
Aâˆ
at
the
central
prime
is
a
valuation
ring
with
value
group
Q,
it
thus
follows
that
M
is
of
the
form
M=

q
âˆ’r
Â·
M
r0
â‰¤râˆˆQ
where
r0
âˆˆ
Râ‰¥0
.
In
other
words,
the
datum
of
M
is
equivalent
to
the
datum
of
MU
,
together
with
a
metric
on
MU
at
the
central
prime
of
Sâˆ
.
Deï¬nition
5.2.
We
shall
refer
to
as
a
metrized
vector
bundle
on
Sâˆ
any
pair
(F,
|
âˆ’
|F
)
consisting
of
a
vector
bundle
F
on
USâˆ
,
together
with
a
metric
on
F
at
the
central
prime
of
Sâˆ
.
The
rank
of
a
metrized
vector
bundle
(F,
|
âˆ’
|F
)
is
deï¬ned
to
be
the
rank
of
the
vector
bundle
F.
If
(F,
|
âˆ’
|F
)
is
a
metrized
vector
bundle,
then
by
considering
the
sheaf
of
(nonzero)
sections
of
F
whose
|
âˆ’
|F
â‰¤
1
at
the
central
prime,
we
naturally
obtain
a
quasi-coherent
OSâˆ
-module.
Moreover,
it
follows
from
the
discussion
of
metrics
at
the
beginning
of
Â§4
â€“
i.e.,
â€œmetrics
are
equivalent
to
bounded,
saturated
submodules
that
generate
over
the
quotient
ï¬eldâ€
â€“
that
the
metric
|
âˆ’
|F
may
be
recovering
from
this
quasi-coherent
module.
135
In
other
words,
metrized
vector
bundles
may
be
thought
of
as
a
special
kind
of
quasi-coherent
OSâˆ
-module.
On
the
other
hand,
any
vector
bundle
F
on
Sâˆ
(in
the
usual
sense)
naturally
deï¬nes
a
metrized
vector
bundle
on
Sâˆ
(FU
,
|
âˆ’
|FU
)
as
follows:
we
let
FU
be
the
restriction
of
F
to
USâˆ
;
|
âˆ’
|FU
be
the
metric
corresponding
to
the
module
of
integral
sections
at
the
central
prime
of
Sâˆ
.
Thus,
the
(nonzero)
sections
of
F
may
be
recovered
as
those
sections
of
FU
whose
|
âˆ’
|FU
â‰¤
1
at
the
central
prime.
In
particular,
we
see
that
the
notion
of
a
metrized
vector
bundle
on
Sâˆ
is
a
generalization
of
the
usual
notion
of
a
vector
bundle
on
Sâˆ
.
def
Corollary
5.3.
Let
L
=
OEâˆ
(d[e]+g)
be
a
metrized
line
bundle
on
Eâˆ
whose
curvature
hL
is
d-invariant.
Then
the
push-forward
sheaf
fâˆ—
L
on
Sâˆ
has
a
natural
structure
of
metrized
vector
bundle
of
rank
d
on
Sâˆ
equipped
with
an
action
of
GL
.
Moreover,
there
exists
an
isomorphism
fâˆ—
L
âˆ¼
=
M
âŠ—OSâˆ
V
of
GL
-modules
where
M
is
a
metrized
line
bundle
on
Sâˆ
with
trivial
GL
-action,
and
V
is
a
vector
bundle
(in
the
usual
sense)
on
Sâˆ
with
GL
-action
on
which
Gm
âŠ†
GL
acts
via
the
standard
character.
Finally,
if
L
is,
in
fact,
a
line
bundle
(i.e.,
is
the
metrized
line
bundle
arising
from
some
line
bundle
on
some
CN
),
then
fâˆ—
L
(respectively,
M)
is
a
vector
bundle
(respectively,
line
bundle)
in
the
usual
sense.
Now
suppose
(just
for
the
remainder
of
this
paragraph)
that
L
is
symmetric,
i.e.,
preserved
(up
to
isomorphism)
by
the
automorphism
of
Eâˆ
given
by
multiplication
by
âˆ’1.
It
is
easy
to
see
that
this
is
equivalent
to
the
assertion
that
the
curvature
hL
satisï¬es
hL
(âˆ’Î¸)
=
hL
(Î¸)
(cf.
the
proof
of
Proposition
5.1).
Then
(just
as
in
the
discussion
of
Â§1)
the
automorphism
[âˆ’1]
of
Eâˆ
given
by
multiplication
by
âˆ’1
induces
an
automorphism
of
GL
.
Thus,
just
as
in
Â§1
(cf.
especially
the
discussion
following
Theorem
1.6),
if
Î±
âˆˆ
Eâˆ
(Sâˆ
)
is
any
Sâˆ
-valued
point,
then
we
get
an
isomorphism
(of
metrized
vector
bundles
on
Sâˆ
)
L|TÎ±âˆ—
KL
âˆ¼
=
(L|Î±0
)
âŠ—OK
0
OKL
L
def
(where
KL0
=
KL
/2
Â·
KL
,
and
L|Î±0
is
the
line
bundle
on
KL0
obtained
by
descending
L|TÎ±âˆ—
KL
).
Thus,
for
instance,
if
d
is
odd,
then
we
obtain
a
trivialization
of
the
restriction
of
L
to
the
subscheme
TÎ±âˆ—
KL
.
In
particular,
restriction
to
TÎ±âˆ—
KL
deï¬nes
(by
composing
with
the
above
isomorphism)
a
morphism
of
metrized
vector
bundles
on
Sâˆ
with
GL
-action:
fâˆ—
L
â†’
(L|Î±0
)
âŠ—OK
0
OKL
L
136
In
other
words,
this
morphism
allows
us
to
think
of
global
sections
of
L
over
E
as
being
(essentially)
functions
on
the
subscheme
TÎ±âˆ—
KL
.
These
functions
may
thus
be
thought
of
as
a
sort
of
â€œmetrizedâ€
or
â€œZhang-theoreticâ€
version
of
the
algebraic
theta
functions
of
[Mumf1,2,3].
The
following
standard
line
bundles
will
be
important
in
this
paper,
so
we
give
them
explicit
names.
First,
let
us
write
def
Ï†ev
d
(Î¸)
=
Ï†d
(Î¸
+
1
)
2d
(notation
as
in
Corollary
4.6).
In
the
following,
the
objects
with
a
superscript
â€œevâ€
(for
â€œevenâ€)
will
be
important
in
the
case
when
d
is
even.
Nevertheless,
all
the
deï¬nitions
(of
both
the
objects
with
a
superscript
â€œevâ€
and
the
objects
without
a
superscript
â€œevâ€)
may
be
made
regardless
of
whether
d
is
even
or
odd.
Let
def
gst
=
d
Â·
Ï†1
âˆ’
Ï†d
;
def
ev
gst
=
d
Â·
Ï†1
âˆ’
Ï†ev
d
(notation
as
in
Corollary
4.6).
Write
def
Lst
=
OEâˆ
(d[e]
+
gst
);
ev
def
ev
Lst
=
OEâˆ
(d[e]
+
gst
)
ev
In
other
words
(cf.
the
discussion
at
the
end
of
Â§4),
Lst
(respectively,
Lst
)
is
the
metrized
line
bundle
whose
restriction
to
the
special
ï¬ber
of
Câˆ
looks
like
the
divisor
dâˆ’1

i
[
]
d
i=0
(respectively,
dâˆ’1

i=0
[(
1
i
)
+
(
)]
)
2d
d
In
particular,
it
is
easy
to
see
that
if
one
takes
a
point
Î±
âˆˆ
KL
(Sâˆ
)
whose
image
under
the
projection
KL
â†’
(Z/dZ)
is
1
âˆˆ
Z/dZ,
and
a
point
Î²
âˆˆ
Eâˆ
(Sâˆ
)
such
that
2
Â·
Î²
=
Î±,
then
we
have
the
following:
dâˆ’1
ev
Lemma
5.4.
If
d
is
odd,
then
Lst
âˆ¼
=
OEâˆ
(
i=0
[i
Â·
Î±]).
If
d
is
even,
then
Lst
âˆ¼
=
dâˆ’1
OEâˆ
(
i=0
[Î²
+
i
Â·
Î±]).
Proof.
Indeed,
one
calculates
easily
that
both
sides
are
isomorphic
generically
and
have
the
same
curvatures.
(Note
here
that
in
the
case
of
d
even,
if
one
does
not
shift
by
Î²,
then
both
sides
will
not
even
be
isomorphic
generically.
Indeed,
they
will
diï¬€er
generically
by
a
line
bundle
of
order
precisely
2.)
Thus,
we
conclude
by
Proposition
4.3
that
the
two
sides
diï¬€er
by
some
OEâˆ
(C),
for
C
âˆˆ
R
a
constant.
But
now
observe
(cf.
Proposition
4.4)
that
ev
gst
(respectively,
gst
)
takes
rational
values
on
Q/Z.
On
the
other
hand,
for
any
irreducible
component
p
of
the
special
ï¬ber
of
Eâˆ
,
the
order
ordp
at
p
of
a
rational
function
on
Eâˆ
137
dâˆ’1
dâˆ’1
whose
divisor
on
Eâˆ
|US
is
d[e]
âˆ’
i=0
[i
Â·
Î±]
(respectively,
d[e]
âˆ’
i=0
[Î²
+
i
Â·
Î±])
lies
in
Q.
Thus,
it
follows
that
C
may
be
taken
to
be
in
Q,
hence
(by
multiplying
by
q
C
)
it
may
be
taken
to
be
0.
Thus,
the
two
metrized
line
bundles
are
isomorphic,
as
desired.

Note,
in
particular,
that
if
d
is
odd
(respectively,
even),
then
there
exists
a
section
s
ev
of
fâˆ—
Lst
(respectively,
fâˆ—
Lst
)
whose
order
ordp
at
any
prime
p
âˆˆ
Q/Z
âŠ†
S1
is
precisely
0.
Indeed,
such
an
s
is
given
by
applying
the
isomorphism
of
Lemma
5.4
to
the
section
given
by
the
natural
inclusion
dâˆ’1

OCd
âŠ†
OCd
(
dâˆ’1

[i
Â·
Î±])
(respectively,
OCd
âŠ†
OCd
(
i=0
[Î²
+
i
Â·
Î±]))
i=0
It
is
clear
that
this
section
is
nonzero
at
all
the
nodes
of
Cd
,
hence
at
every
prime
p
âˆˆ
Q/Z,
as
desired.
Lemma
5.5.
Suppose
that
L
=
OEâˆ
(d[e]
+
g),
where
g
=
gst
+
Ïˆ
(respectively,
ev
g
=
gst
+
Ïˆ)
if
d
is
odd
(respectively,
even),
and
Ïˆ
âˆˆ
Func(S1
)
is
â‰¥
0
and
d-invariant
on
S1
.
Suppose,
moreover,
that
Ïˆ
vanishes
at
some
point
of
Q/Z.
Then
the
natural
ev
identiï¬cation
between
fâˆ—
L
and
fâˆ—
Lst
(respectively,
fâˆ—
Lst
)
over
USâˆ
extends
to
an
equality
fâˆ—
L
=
fâˆ—
Lst
ev
(resp
fâˆ—
L
=
fâˆ—
Lst
)
over
Sâˆ
.
Proof.
To
simplify
notation,
we
assume
in
this
proof
that
d
is
odd.
(The
even
case
is
entirely
similar.)
Now
note
that
because
Ïˆ
is
d-invariant,
it
follows
that
GL
acts
on
both
fâˆ—
L
and
fâˆ—
Lst
.
Thus,
(cf.
Corollary
5.3)
it
follows
that
for
some
r
âˆˆ
R,
we
have:
fâˆ—
L
=
q
âˆ’r
Â·
fâˆ—
Lst
(i.e.,
the
metrics
on
the
two
sides
diï¬€er
by
a
factor
of
er
).
Since
Ïˆ
â‰¥
0,
it
follows
that
r
â‰¥
0.
Suppose
that
r
>
0.
Then
if
s
is
any
section
of
fâˆ—
Lst
,
then
there
exists
a
rational
number
>
0
such
that
q
âˆ’
Â·
s
forms
an
integral
section
of
fâˆ—
L.
Now
suppose
that
Ïˆ
vanishes
at
the
point
p
of
Q/Z.
By
the
preceding
discussion,
there
exists
an
s
such
that
s
does
not
vanish
(as
a
section
of
Lst
)
at
p.
Thus,
q
âˆ’
Â·
s
does
not
deï¬ne
an
integral
section
of
Lst
at
p.
On
the
other
hand,
since
Ïˆ(p)
=
0,
it
follows
that
Lst
and
L
have
the
same
integral
structure
at
p.
Thus,
q
âˆ’
Â·
s
is
not
integral
for
L
at
p
â€“
a
contradiction.
This
completes
the
proof.

138
Theorem
5.6.
Suppose
that
L
=
OEâˆ
(d[e]
+
g),
where
g
=
gst
+
Ïˆ
(respectively,
g
=
ev
+
Ïˆ)
if
d
is
odd
(respectively,
even),
and
Ïˆ
âˆˆ
Func(S1
)
is
d-invariant
on
S1
.
Let
gst
def
r0
=
inf
1
Ïˆ(Î±)
Î±âˆˆS
ev
Then
the
natural
identiï¬cation
between
fâˆ—
L
and
fâˆ—
Lst
(respectively,
fâˆ—
Lst
)
over
USâˆ
extends
to
an
equality
fâˆ—
L
=
q
âˆ’r0
Â·
fâˆ—
Lst
ev
(respectively,
fâˆ—
L
=
q
âˆ’r0
Â·
fâˆ—
Lst
)
ev
(i.e.,
the
metric
on
fâˆ—
L
is
eâˆ’r0
times
the
metric
on
fâˆ—
Lst
(respectively,
fâˆ—
Lst
))
over
Sâˆ
.
Proof.
For
simplicity,
we
assume
that
d
is
odd.
First,
consider
the
case
where
r0
âˆˆ
Q
and
there
exists
an
Î±
âˆˆ
Q/Z
such
that
Ïˆ(Î±)
=
r0
.
Then
by
multiplying
through
by
q
r0
we
see
that
we
reduce
to
the
case
r0
=
0.
Moreover,
the
hypotheses
of
Lemma
5.5
are
satisï¬ed,
so
we
see
that
the
result
follows
from
Lemma
5.5.
This
completes
the
case
where
r0
âˆˆ
Q
and
âˆƒÎ±
âˆˆ
Q/Z
such
that
Ïˆ(Î±)
=
r0
.
To
handle
the
general
case,
one
simply
approximates
Ïˆ
by
piecewise
linear
functions
Ïˆi
in
Func(S1
)
which
satisfy
the
hypotheses
of
the
preceding
paragraph.
As
Ïˆi
â†’
Ïˆ,
it
is
clear
that
the
metric
on
the
resulting
fâˆ—
Li
converges
to
the
metric
on
the
original
fâˆ—
L
(corresponding
to
Ïˆ).
This
completes
the
proof.

Corollary
5.7.
Suppose
that
L
=
OEâˆ
(d[e]
+
d
Â·
Ï†1
).
Then
we
have
(on
Sâˆ
)
1
fâˆ—
L
=
q
24d
Â·
fâˆ—
Lst
1
ev
(respectively,
fâˆ—
L
=
q
24d
Â·
fâˆ—
Lst
)
if
d
is
odd
(respectively,
even).
def
Proof.
For
simplicity,
we
assume
that
d
is
odd.
Then
we
have
Ïˆ
=
d
Â·
Ï†1
âˆ’
gst
=
Ï†d
.
1
Moreover,
by
Corollary
4.6,
the
r0
(as
in
Theorem
5.6)
for
this
Ïˆ
is
equal
to
âˆ’
24d
.
Thus
Corollary
5.7
follows
from
Theorem
5.6.

Next,
we
would
like
to
switch
gears,
and
consider
the
following
situation.
Suppose
that
we
are
given
a
ï¬nite
ï¬‚at
covering
B
â†’
(M1,0
)Z
which
is
eÌtale
over
(M1,1
)Q
(i.e.,
away
from
the
divisor
at
inï¬nity
and
ï¬nite
primes).
For
simplicity,
we
will
also
assume
that
B
is
regular,
and
that
the
completion
of
B
at
the
139
inverse
image
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
is
a
disjoint
union
of
â€œSN
â€™sâ€
as
in
the
above
discussion
(for
some
appropriate
N
and
base
ring
O).
Let
us
write
IB
for
the
set
of
connected
components
of
this
union.
Thus,
for
each
Î¹
âˆˆ
IB
,
we
have
a
completion
BÎ¹
âˆ¼
=
SNÎ¹
,
where
SNÎ¹
is
understood
to
be
over
a
base
ring
OÎ¹
.
Let
EB
âŠ†
CB
â†’
B
be
the
tautological
log
elliptic
curve
over
B.
Also,
let
us
write
UB
âŠ†
B
for
the
complement
of
the
divisor
at
inï¬nity
of
B.
By
gluing
together
EB
|UB
and
(Eâˆ
)Î¹
at
each
Î¹,
we
thus
obtain
a
smooth
group
scheme
Eâˆ,B
â†’
Bâˆ
over
Bâˆ
.
(Thus,
strictly
speaking,
Bâˆ
is
an
algebraic
stack
in
the
ï¬nite,
ï¬‚at
topology.)
Then
let
us
observe
that
one
can
glue
together
the
theory
discussed
above
over
â€œSâ€
with
the
usual
theory
of
line
bundles
and
vector
bundles
on
EB
and
B
to
obtain
a
theory
of
metrized
line
bundles
on
Eâˆ,B
and
metrized
vector
bundles
on
Bâˆ
.
Indeed,
we
shall
not
write
out
the
routine
details,
but
the
point
is
that
a
metrized
line
bundle
on
Eâˆ,B
is
a
line
bundle
on
Eâˆ,B
|UB
,
together
with
a
metric
on
the
pull-back
of
this
line
bundle
to
each
Eâˆ,B
|USâˆ,Î¹
(where
we
use
the
notation
â€œUSâˆ,Î¹
â€
relative
to
the
understanding
that
each
BÎ¹
âˆ¼
=
SNÎ¹
has
its
associated
USâˆ,Î¹
âŠ†
Sâˆ,Î¹
â†’
SNÎ¹
,
etc.).
Similarly,
a
metrized
vector
bundle
on
Bâˆ
is
a
vector
bundle
on
UB
,
together
with
a
metric
on
the
pull-backs
of
this
vector
bundle
to
each
USâˆ,Î¹
.
Thus,
if
we
are
given,
for
each
Î¹
âˆˆ
IB
,
a
function
gÎ¹
âˆˆ
Func(S1Î¹
)
then
we
may
form
a
metrized
line
bundle
def
LB
=
OEâˆ,B
(d[e]
+

gÎ¹
)
Î¹
in
the
obvious
way.
If
we
then
push-forward
this
line
bundle
via
fB
:
Eâˆ,B
â†’
Bâˆ
,
we
obtain
a
metrized
vector
bundle
(fB
)âˆ—
LB
whose
local
structure
was
studied
in
Corollary
5.3
and
Theorem
5.6
above.
In
particular,
let
us
note
that
it
makes
sense
to
speak
of
the
degree
of
a
metrized
vector
bundle
on
Bâˆ
.
140
This
degree
will,
in
general,
be
a
real
number.
There
are
many
ways
that
one
can
deï¬ne
this
degree.
For
instance,
one
may
deï¬ne
it
as
the
degree
of
the
metrized
line
bundle
which
is
the
determinant
of
the
given
metrized
vector
bundle.
Thus,
it
suï¬ƒces
to
deï¬ne
the
degree
of
a
metrized
line
bundle
on
Bâˆ
.
But
a
metrized
line
bundle
on
Bâˆ
can
easily
be
seen
to
be
equivalent
(up
to
torsion)
to
an
element
of
Pic(B)
âŠ—Z
R.
Thus,
the
degree
of
a
metrized
line
bundle
may
be
deï¬ned
by
tensoring
(over
Z
with
R)
the
usual
degree
map
Pic(B)
â†’
Pic(BQ
)
â†’
Z
on
the
smooth
proper
curve
BQ
.
Here,
because
(M1,0
)Z
is
an
algebraic
stack,
and
B
is
a
covering
of
this
stack,
it
is
each
to
get
confused
about
â€œwhat
unitsâ€
the
degree
is
measured
in.
In
this
paper,
we
adopt
the
convention
of
expressing
all
degrees
in
â€œlog(q)â€
units.
In
other
words,
in
these
units,
the
degree
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
is
equal
to
1.
Theorem
5.8.
Let
d
be
an
odd
(respectively,
even)
positive
integer,
and
suppose
that
we
are
given
functions
gÎ¹
âˆˆ
Func(S1Î¹
)
def
def
ev
)Î¹
)
is
d-invariant.
for
each
Î¹
âˆˆ
IB
such
that
ÏˆÎ¹
=
gÎ¹
âˆ’
(gst
)Î¹
(respectively,
ÏˆÎ¹
=
gÎ¹
âˆ’
(gst
Let
def
rÎ¹
=
inf
1
ÏˆÎ¹
(Î±)
Î±âˆˆSÎ¹
and
def
LB
=
OEâˆ,B
(d[e]
+

gÎ¹
);
Î¹
def
(Lst
)B
=
OEâˆ,B
(d[e]
+

(gst
)Î¹
)
ev
def
(respectively,
(Lst
)B
=
OEâˆ,B
(d[e]
+
Î¹

ev
(gst
)Î¹
))
Î¹
Then
the
natural
identiï¬cation
of
push-forwards
between
(fB
)âˆ—
LB
and
(fB
)âˆ—
(Lst
)B
(reev
spectively,
(fB
)âˆ—
(Lst
)B
)
over
UB
extends
to
an
equality

qÎ¹âˆ’rÎ¹
)
Â·
(fB
)âˆ—
(Lst
)B
(fB
)âˆ—
LB
=
(
Î¹
141

ev
(respectively,
(fB
)âˆ—
LB
=
(
qÎ¹âˆ’rÎ¹
)
Â·
(fB
)âˆ—
(Lst
)B
)
Î¹
(i.e.,
the
metric
on
(fB
)âˆ—
LB
at
Î¹
is
eâˆ’rÎ¹
times
the
metric
on
(fB
)âˆ—
(Lst
)B
(respectively,
ev
(fB
)âˆ—
(Lst
)B
))
over
Sâˆ
.
Moreover,
we
have
deg((fB
)âˆ—
LB
)
=
âˆ’

1
(d
âˆ’
1)
+
d
Â·
rÎ¹
24
Î¹
where
the
degree
is
in
â€œlog(q)â€
units.
Proof.
The
assertion
concerning
integral
structures
is
a
formal
consequence
of
Theorem
5.6.
Moreover,
this
assertion
concerning
integral
structures
allows
one
to
immediately
ev
reduce
the
assertion
concerning
degrees
to
the
â€œstandard
casesâ€
of
(Lst
)B
,
(Lst
)B
.
In
these
cases,
the
assertion
concerning
the
degree
is
an
immediate
consequence
of
GrothendieckRiemann-Roch.
We
will
carry
out
this
computation
in
the
following
paragraph.
Before
doing
this,
however,
we
note
that
when
working
with
metrized
line
bundles,
one
does
not
necessarily
get
the
correct
answer
if
one
applies
Grothendieck-Riemann-Roch
to
an
arbitrary
metrized
line
bundle,
since
for
an
arbitrary
metrized
line
bundle,
â€œR1
(fB
)âˆ—
â€
is
not
well-deï¬ned
(i.e.,
one
might
get
various
â€œanalytic
torsion
eï¬€ectsâ€).
This
is
why
we
ev
reduced
to
the
â€œstandard
casesâ€
(Lst
)B
,
(Lst
)B
which
are
(by
Lemma
5.4),
in
fact,
line
bundles
in
the
usual
sense
(whose
R1
(fB
)âˆ—
is
zero)
over
any
covering
of
(M1,0
)Z
over
which
the
d-torsion
points
of
Eâˆ,B
become
rational.
Let
us
ï¬rst
treat
the
case
of
d
odd.
The
case
of
d
even
is
quite
similar,
and
we
will
remark
at
the
end
of
the
proof
what
must
be
modiï¬ed
in
this
case.
By
Grothendieck-Riemann-Roch,
we
have
1
deg((fB
)âˆ—
LB
)
=
deg(R(fCB
)âˆ—
OCB
)
+
[LB
]
Â·
([LB
]
âˆ’
[Ï‰E
])
2
def
(where
fCB
:
CB
â†’
B
is
the
structure
morphism;
we
take
LB
=
(Lst
)B
;
and
we
use
brackets
â€œ[âˆ’]â€
to
denote
the
Chern
class
of
a
line
bundle).
Here,
Ï‰E
denotes
the
line
bundle
on
B
given
by
considering
the
invariant
diï¬€erentials
on
EB
.
Then
Serre
duality
gives:
deg(R(fCB
)âˆ—
OCB
)
=
deg(Ï‰E
)
Next,
we
compute
the
various
intersection
numbers
that
appear
by
using
the
intersection
theory
of
compactiï¬ed
divisors
reviewed
in
Â§4.
First
of
all,
since
Ï‰E
is
a
line
bundle
on
B
âŠ—12
(as
opposed
to
CB
),
and
Ï‰E
is
well-known
to
be
isomorphic
to
the
line
bundle
associated
to
the
divisor
at
inï¬nity,
we
have
142
[LB
]
Â·
[Ï‰E
]
=
d
Â·
deg(Ï‰E
)
=
d
12
Next,
we
have
[LB
]
Â·
[LB
]
=
d
Â·
[LB
]
Â·
[e]
+
S1
gst
Â·
hLst
On
the
other
hand,
[LB
]
Â·
[e]
=
d
Â·
[e]2
+
gst
(0)
=
âˆ’d
Â·
deg(Ï‰E
)
+
d
Â·
Ï†1
(0)
âˆ’
Ï†d
(0)
1
1
1
1
=âˆ’
=
âˆ’d
Â·
(
)
+
(d
âˆ’
)
Â·
12
d
12
12d
while
S1
gst
Â·
hLst
=
dâˆ’1

i
gst
(
)
=
d
Â·
Ï†d
(0)
âˆ’
d
Â·
Ï†d
(0)
=
0
d
i=0
1
,
so
Thus,
we
obtain
that
[LB
]2
=
âˆ’
12
deg((fB
)âˆ—
LB
)
=
1
1
1
Â·
(2
âˆ’
1
âˆ’
d)
Â·
=
âˆ’
(d
âˆ’
1)
2
12
24
as
desired.
def
ev
Finally,
we
consider
the
case
of
d
even.
In
this
case,
we
take
LB
=
(Lst
)B
.
It
is
then
immediate
that
[LB
]
Â·
[Ï‰E
]
=
d
12
(just
as
in
the
odd
case).
Thus
the
only
intersection
number
that
remains
to
be
computed
is
[LB
]2
.
We
have
[LB
]
Â·
[LB
]
=
d
Â·
[LB
]
Â·
[e]
+
Moreover,
143
S1
ev
gst
Â·
hLev
st
ev
[LB
]
Â·
[e]
=
d
Â·
[e]2
+
gst
(0)
=
âˆ’d
Â·
deg(Ï‰E
)
+
d
Â·
Ï†1
(0)
âˆ’
Ï†ev
d
(0)
1
=
âˆ’d
Â·
deg(Ï‰E
)
+
d
Â·
Ï†1
(0)
âˆ’
Ï†d
(
)
2d
1
1
1
1
=
=
âˆ’d
Â·
(
)
+
(d
+
)
Â·
12
2d
12
24d
while
S1
ev
gst
Â·
hLev
=
dâˆ’1

st
ev
gst
(
i=0
=
d
Â·
Ï†d
(
i
1
+
)
2d
d
1
1
1
1
)
âˆ’
d
Â·
Ï†d
(0)
=
Ï†1
(
)
âˆ’
Ï†1
(0)
=
âˆ’
âˆ’
2d
2
24
12
1
1
1
1
)âˆ’
24
âˆ’
12
=
âˆ’
12
(just
as
in
the
odd
case),
as
desired.
This
completes
Thus,
[LB
]2
=
dÂ·(
24d
the
proof
in
the
even
case.

Bibliography
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer
(1990).
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
University
Press
(1985).
[MB]
L.
Moret-Bailly,
Pinceaux
de
varieÌteÌs
abeÌliennes,
AsteÌrisque
129,
Soc.
Math.
France
(1985).
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deï¬ning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
2
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
[Mumf4]
D.
Mumford,
Abelian
Varieties,
Oxford
University
Press
(1974).
[Mumf5]
D.
Mumford,
An
Analytic
Construction
of
Degenerating
Abelian
Varieties
over
Complete
Rings,
Appendix
to
[FC].
[Zh]
S.
Zhang,
Admissible
pairing
on
a
curve,
Invent.
Math.
112
(1993),
pp.
171-193.
144
Chapter
V:
The
Evaluation
Map
Â§0.
Introduction
In
this
Chapter,
we
prepare
for
the
proof
of
the
Comparison
Isomorphism
(which
is
the
main
topic
of
this
paper)
in
Chapter
VI
by
studying
the
morphism
which
is
to
be
the
â€œcomparison
isomorphism.â€
We
refer
to
this
morphism
as
the
evaluation
map.
Our
study
of
the
evaluation
map
consists
of
several
parts.
First,
we
must
set
up
the
notation
and
deï¬ne
the
evaluation
map.
This
is
done
in
Â§1,
2,
3.
The
evaluation
map
essentially
consists
of
restricting
global
sections
of
a
certain
natural
metrized
line
bundle
on
the
universal
extension
of
an
elliptic
curve
to
the
torsion
points
of
the
elliptic
curve.
In
Â§1,
we
discuss
the
deï¬nition
of
the
natural
metrized
line
bundles
that
we
use,
and
in
Â§2,
we
construct
and
study
the
elementary
properties
of
the
â€œevaluation
map.â€
In
Â§3,
we
observe
that
the
â€œeÌtale-integral
structuresâ€
deï¬ned
in
Chapter
III,
Â§6,
are
deï¬ned
for
arbitrary
elliptic
curves
(i.e.,
not
just
for
degenerating
elliptic
curves,
as
in
the
discussion
of
Chapter
III,
Â§6),
and,
moreover,
that
the
functions
in
these
eÌtale-integral
structures
assume
integral
values
at
the
torsion
points
appearing
in
the
deï¬nition
of
the
evaluation
map.
This
integrality
property
will
be
important
in
the
proof
of
the
comparison
isomorphism
in
Chapter
VI.
After
we
have
deï¬ned
the
evaluation
map,
we
commence
our
study
of
the
extent
to
which
it
is
an
isomorphism.
We
begin,
in
Â§4,
by
studying
the
extent
to
which
a
certain
version
of
the
evaluation
map
deï¬ned
for
degenerating
elliptic
curves
is
an
isomorphism
modulo
various
powers
of
the
q-parameter.
This
essentially
amounts
to
studying
the
extent
to
which
the
twisted
Schottky-Weierstrass
zeta
functions
of
Chapter
IV,
Â§3,
satisfy
linear
relations
modulo
various
powers
of
the
q-parameter.
It
turns
out
that
the
calculations
of
linear
relations
that
we
carry
out
in
this
Â§
will
yield
the
key
technical
machinery
behind
the
main
result
of
this
paper.
Next,
in
Â§5,
we
study
the
determinant
of
the
evaluation
map
in
the
case
when
the
base
of
the
spectrum
of
an
algebraically
closed
ï¬eld.
We
then
use
the
theory
of
Â§5
to
determine,
in
Â§6,
precisely
when
the
evaluation
map
is
an
isomorphism
for
â€œsuï¬ƒciently
genericâ€
elliptic
curves.
Â§1.
Construction
of
Certain
Metrized
Line
Bundles
In
this
Â§,
we
continue
the
discussion
of
Chapter
IV,
Â§4,5,
on
metrized
line
bundles.
In
particular,
we
introduce
certain
speciï¬c
metrized
line
bundles
which
we
will
need
in
order
to
construct
the
evaluation
maps
of
Â§2
below.
These
metrized
line
bundles
L
are
natural
in
the
sense
that
(it
is
not
diï¬ƒcult
to
show
that)
they
may
be
uniquely
characterized
(up
to
tensor
product
with
a
line
bundle
pulled
back
from
the
base)
by
the
following
two
conditions:
145
(i.)
They
are
symmetric
up
to
torsion
(i.e.,
the
pull-back
of
L
via
the
â€œmultiplication
by
âˆ’1â€
map
of
an
elliptic
curve
diï¬€ers
from
L
by
a
line
bundle
which
deï¬nes
a
torsion
element
of
the
Picard
group),
of
relative
degree
d.
(ii.)
Their
curvatures
(at
inï¬nity)
are
invariant
with
respect
to
and
â€œconcentrated
atâ€
(in
the
sense
of
â€œdelta
functionsâ€)
the
d-torsion
points
to
which
we
will
restrict
them
when
we
consider
â€œevaluation
mapsâ€
in
Â§2.
Condition
(ii.)
is
natural
considering
that
the
main
purpose
of
constructing
these
line
bundles
is
to
restrict
them
(and
their
sections)
to
the
subscheme
of
d-torsion
points
of
an
elliptic
curve.
In
fact,
the
â€œconcentrated
atâ€
part
of
Condition
(ii.)
is
inessential
in
the
sense
that,
by
Chapter
IV,
Theorem
5.6,
even
if
the
curvature
is
not
concentrated
at
the
d-torsion
points,
the
push-forward
of
the
metrized
line
bundle
â€“
which
is
what
we
are
ultimately
interested
in
â€“
is
the
same
as
that
of
the
â€œmaximal
metrized
subsheaf
inside
the
original
line
bundle
among
those
subsheaves
which
are
concentrated
at
the
d-torsion
points.â€
Let
m
â‰¥
1
be
an
integer.
We
would
like
to
consider
the
moduli
of
pairs
(E
â†’
S,
Î·
âˆˆ
E(S))
where
E
â†’
S
is
an
elliptic
curve,
and
Î·
âˆˆ
E(S)
generates
a
cyclic
subgroup
of
order
m
in
1
E.
Over
Z[
m
],
there
is
no
problem
in
deï¬ning
an
algebraic
stack
of
such
pairs.
Moreover,
it
follows
from
the
theory
of
[KM],
Chapter
5
(cf.
especially
Theorem
5.1.1),
that
this
stack
extends
(uniquely)
to
a
ï¬nite,
ï¬‚at
covering
B
â†’
(M1,0
)Z
1
of
proper
algebraic
stacks
over
Z
which
is
eÌtale
over
Z[
m
]
away
from
the
divisor
at
inï¬nity;
1
near
inï¬nity,
is
obtained
by
adjoining
some
q
r
,
where
r
divides
m
to
the
ring
of
integers
in
some
cyclotomic
extension
of
Q;
and,
at
primes
dividing
m,
parametrizes
â€œpoints
of
exact
order
m.â€
Moreover,
the
stack
B
is
regular.
In
particular,
B
satisï¬es
the
hypotheses
of
the
discussion
following
Chapter
IV,
Corollary
5.7.
Next,
let
d
be
a
positive
integer.
Then
let
us
recall
the
metrized
line
bundles
def
(Lst
)B
=
OEâˆ,B
(d[e]
+

(gst
)Î¹
)
Î¹
ev
def
(Lst
)B
=
OEâˆ,B
(d[e]
+

Î¹
146
ev
(gst
)Î¹
)
(where
e
is
the
origin
of
the
group
object
fB
:
Eâˆ,B
â†’
Bâˆ
;
Î¹
ranges
over
the
connected
ev
=
d
Â·
Ï†1
âˆ’
Ï†ev
components
of
the
divisor
at
inï¬nity
of
B;
and
gst
=
d
Â·
Ï†1
âˆ’
Ï†d
,
gst
d
are
the
â€œstandard
Greenâ€™s
functionsâ€
studied
in
Chapter
IV,
Â§4,5)
of
Chapter
IV,
Theorem
5.8.
Recall
from
the
theory
of
Chapter
IV,
Â§4,5
(especially
Chapter
IV,
Lemma
5.4),
that
on
each
S1Î¹
(i.e.,
the
â€œlimitâ€
of
the
set
of
irreducible
components
of
the
semi-stable
models
ev
over
the
component
at
inï¬nity
Î¹),
(Lst
)B
(respectively,
(Lst
)B
)
looks
like
the
(line
bundle
associated
to)
the
divisor
dâˆ’1

i
[
]
d
i=0
(respectively,
dâˆ’1

[(
i=0
i
1
)
+
(
)]
)
2d
d
on
S1Î¹
.
Finally,
in
Chapter
IV,
Theorem
5.8,
we
showed
that
if
d
is
odd
(respectively,
even),
then
deg((fB
)âˆ—
(Lst
)B
)
=
âˆ’
1
1
ev
(d
âˆ’
1)
(respectively,
deg((fB
)âˆ—
(Lst
)B
)
=
âˆ’
(d
âˆ’
1)
)
24
24
in
â€œlog(q)â€
units.
Next,
let
us
observe
that
from
the
deï¬nition
of
the
moduli
stack
B,
we
have
a
tautological
m-torsion
point
Î·
âˆˆ
Eâˆ,B
(B)
For
each
Î¹,
one
then
has
a
divisor
ÏÎ¹
(Î·)
âˆˆ
Div(S1Î¹
)
given
by
the
unique
point
of
(Q/Z)Î¹
âŠ†
S1Î¹
deï¬ned
by
Î·
at
Î¹.
Let
us
denote
this
unique
point
by
Î·Î¹
âˆˆ
(Q/Z)Î¹
âŠ†
S1Î¹
.
Thus,
ÏÎ¹
(Î·)
=
[Î·Î¹
].
Now,
if
d
is
odd
(respectively,
even),
then
let
us
consider
the
divisor
dâˆ’1

dâˆ’1
i


i

[Î·Î¹
+
]
âˆ’
[
]
âˆˆ
Div(S1Î¹
)
d
d
i=0
i=0
(respectively,
i


i

1
+
]
âˆ’
[Î·Î¹
+
[
]
âˆˆ
Div(S1Î¹
)
)
2d
d
d
i=0
i=0
dâˆ’1

dâˆ’1
Let
us
write
Ï†Î·Î¹
(respectively,
Ï†ev
Î·Î¹
)
for
the
Greenâ€™s
function
associated
to
this
divisor
(cf.
âˆ‚2Ï†
the
discussion
preceding
Chapter
IV,
Proposition
4.4).
Thus,
Î”(Ï†Î·Î¹
)
=
âˆ’
âˆ‚Î¸2Î·Î¹
(where
147
Î¸
is
the
standard
coordinate
on
S1Î¹
)
is
equal
to
the
delta
distribution
associated
to
this
divisor.
Moreover,
by
Chapter
IV,
Corollary
4.5,
the
function
Ï†Î·Î¹
is
piecewise
linear
on
S1Î¹
,
d-invariant
(i.e.,
Ï†Î·Î¹
(Î¸
+
d1
)
=
Ï†Î·Î¹
(Î¸)),
and
attains
its
maximum
at
the
points
Î·Î¹
+
di
1
(respectively,
Î·Î¹
+
2d
+
di
),
and
its
minimum
at
the
points
di
,
for
i
=
0,
.
.
.
,
d
âˆ’
1.
Indeed,
it
follows
immediately
from
the
deï¬nitions
that
Ï†Î·Î¹
(Î¸)
=
1
1
Ï†dÂ·Î·Î¹
,0
(d
Â·
Î¸)
(respectively,
Ï†ev
Î·Î¹
(Î¸)
=
Ï†dÂ·Î·Î¹
+
12
,0
(d
Â·
Î¸)
)
d
d
where
Ï†??,0
(Î¸)
is
the
function
considered
in
Chapter
IV,
Corollary
4.5.
Let
us
deï¬ne
def
ÏˆÎ·Î¹
(Î¸)
=
Ï†Î·Î¹
(Î¸)
âˆ’
Ï†Î·Î¹
(0)
def
ev
(respectively,
ÏˆÎ·evÎ¹
(Î¸)
=
Ï†ev
Î·Î¹
(Î¸)
âˆ’
Ï†Î·Î¹
(0)
)
Thus,
ÏˆÎ·Î¹
â‰¥
0
(respectively,
ÏˆÎ·evÎ¹
â‰¥
0)
on
S1Î¹
;
ÏˆÎ·Î¹
(0)
=
0
(respectively,
ÏˆÎ·evÎ¹
(0)
=
0).
We
are
now
ready
to
deï¬ne
the
metrized
line
bundles
which
are
the
main
topic
of
the
present
Â§.
Let

def
ÏˆÎ·Î¹
)
(Lst,Î·
)B
=
{TÎ·âˆ—
((Lst
)B
)}
âŠ—OEâˆ,B
OEâˆ,B
(
Î¹

ev
ev
def
(respectively,
(Lst,Î·
)B
=
{TÎ·âˆ—
((Lst
)B
)}
âŠ—OEâˆ,B
OEâˆ,B
(
ÏˆÎ·evÎ¹
)
)
Î¹
(where
TÎ·
:
Eâˆ,B
â†’
Eâˆ,B
is
the
morphism
given
by
translation
by
Î·
âˆˆ
Eâˆ,B
(B)).
Note
that
the
curvature
of
this
metrized
line
bundle
at
Î¹
is
given
by:
Î´
dâˆ’1
i=0

âˆ’
Î”(ÏˆÎ·
)
=
Î´
dâˆ’1
[Î·Î¹
+
di
]
(respectively,
Î´
dâˆ’1
i=0
Î¹
i=0

[
di
]

âˆ’
Î”(Ïˆ
ev
)
=
Î´
dâˆ’1
1
[Î·Î¹
+
2d
+
di
]
Î·Î¹
i=0
)
[
di
]
ev
That
is
to
say,
although,
over
US
,
Lst,Î·
(respectively,
Lst,Î·
)
is
â€œtwisted,â€
i.e.,
diï¬€ers
from
ev
(Lst
)B
(respectively,
(Lst,Î·
)B
)
by
translation
by
Î·,
â€œmetrically
speakingâ€
(i.e.,
in
the
special
ï¬bers
at
inï¬nity)
it
looks
as
though
it
was
never
twisted
by
translation
by
Î·
(respectively,
1
or
even
by
the
â€œ
2d
â€™sâ€
on
the
S1Î¹
â€™s
at
inï¬nity).
Now
Chapter
IV,
Theorems
5.6,
5.8,
imply
the
following:
Proposition
1.1.
If
d
is
odd
(respectively,
even),
then
the
automorphism
of
Eâˆ,B
given
by
translation
by
Î·
induces
a
natural
equality:
148
(fB
)âˆ—
(Lst,Î·
)B
=
(fB
)âˆ—
(Lst
)B
ev
ev
(respectively,
(fB
)âˆ—
(Lst,Î·
)B
=
(fB
)âˆ—
(Lst
)B
)
1
of
metrized
vector
bundles
on
Bâˆ
.
In
particular,
deg((fB
)âˆ—
(Lst,Î·
)B
)
=
âˆ’
24
(d
âˆ’
1)
(reev
1
spectively,
deg((fB
)âˆ—
(Lst,Î·
)B
)
=
âˆ’
24
(d
âˆ’
1)).
Remark.
We
note
here,
for
future
reference,
that
Proposition
1.1
implies
that
1
1
1

i)
+
deg((fB
)âˆ—
(Lst,Î·
)B
)
=
âˆ’d
Â·
{d(d
âˆ’
1)
+
(d
âˆ’
1)}
=
âˆ’
d(d2
âˆ’
1)
âˆ’
(
12
i=0
24
24
dâˆ’1
dÂ·
if
d
is
odd
(respectively,
1
1
1

ev
i)
+
deg((fB
)âˆ—
(Lst,Î·
)B
)
=
âˆ’d
Â·
{d(d
âˆ’
1)
+
(d
âˆ’
1)}
=
âˆ’
d(d2
âˆ’
1)
âˆ’
(
12
i=0
24
24
dâˆ’1
dÂ·
if
d
is
even).
This
computation
will
be
of
fundamental
importance
in
the
proof
of
the
comparison
isomorphism
in
Chapter
VI.
Note,
moreover,
that
since
the
ÏˆÎ·Î¹
â€™s
are
d-invariant,
one
can
glue
together
the
theories
of
theta
groups
discussed
in
Chapter
IV,
Â§1,
and
Chapter
IV,
Â§5,
to
obtain
a
theta
group
G(Lst
)B
=
G(Lst,Î·
)B
(if
d
is
odd)
which
ï¬ts
into
an
exact
sequence
1
â†’
(Gm
)B
â†’
G(Lst
)B
=
G(Lst,Î·
)B
â†’
K(Lst
)B
=
K(Lst,Î·
)B
â†’
1
where
K(Lst
)B
=
K(Lst,Î·
)B
is
the
kernel
of
multiplication
by
d
on
Eâˆ,B
.
Naturally,
the
equality
of
metrized
vector
bundles
in
Proposition
1.1
is,
in
fact,
an
equality
of
modules
ev
ev
over
this
group
scheme
G(Lst
)B
=
G(Lst,Î·
)B
.
Similar
statements
hold
for
(Lst
)B
,
(Lst,Î·
)B
,
if
d
is
even.
Next,
let
us
compute
some
intersection
numbers
(cf.
the
theory
of
Chapter
IV,
Â§4,5).
Proposition
1.2.
Suppose
that
Ï„
is
any
d-torsion
point
âˆˆ
Eâˆ,B
(T
)
(i.e.,
d
Â·
Ï„
=
0)
over
some
B-scheme
T
,
where
T
â†’
B
is
a
ï¬nite,
ï¬‚at
covering
that
satisï¬es
the
same
hypotheses
as
B
(i.e.,
the
hypotheses
in
the
discussion
following
Chapter
IV,
Corollary
5.7).
Suppose
that
d
is
odd;
then
we
have
149
[Ï„
]
Â·
(Lst,Î·
)B
=
âˆ’
1

Ï†1
(âˆ’d
Â·
Î·Î¹
)
d
Î¹
i.e.,
[Ï„
]
Â·
(Lst,Î·
)B
=
0
if
m
does
not
divide
d;
[Ï„
]
Â·
(Lst,Î·
)B
=
âˆ’
1
12d
(in
â€œlog(q)â€
units)
if
m
divides
d.
Suppose
that
d
is
even;
then
we
have
ev
[Ï„
]
Â·
(Lst,Î·
)B
=
âˆ’
1

1
Ï†1
(âˆ’d
Â·
Î·Î¹
+
)
d
Î¹
2
(in
â€œlog(q)â€
units).
Proof.
For
simplicity,
we
shall
assume
that
d
is
odd.
The
even
case
is
entirely
similar.
The
only
diï¬€erence
is
that,
unlike
in
the
odd
case,
the
sum
that
one
obtains
in
the
even
1
if
m
case
cannot
be
described
in
â€œclosed
formâ€
(i.e.,
â€œ=
0
if
m
does
not
divide
d,
=
âˆ’
12d
divides
dâ€).
By
the
above
discussion
on
theta
groups,
it
follows
that
for
some
line
bundle
N
on
T
such
that
N
âŠ—d
âˆ¼
=
OT
,
we
have:
TÏ„âˆ—
((Lst,Î·
)B
)
=
((Lst,Î·
)B
)
âŠ—OT
N
Since
[Ï„
]
Â·
[N
]
=
0,
it
thus
suï¬ƒces
to
consider
the
case
T
=
B;
Ï„
=
e
(i.e.,
the
origin
of
Eâˆ,B
).
Since
ÏˆÎ·Î¹
(0)
=
0,
it
follows
that
[e]
Â·
[(Lst,Î·
)B
]
=
[e]
Â·
TÎ·âˆ—
[(Lst
)B
]
=
[âˆ’Î·]
Â·
[(Lst
)B
]

=
d
Â·
[âˆ’Î·]
Â·
[e]
+
[âˆ’Î·Î¹
]
Â·
(dÏ†1
âˆ’
Ï†d
)
Î¹
=
d
Â·
[âˆ’Î·]
Â·
[e]
+

[âˆ’Î·Î¹
]
Â·
Ï†1
âˆ’
Î¹
1

[âˆ’d
Â·
Î·Î¹
]
Â·
Ï†1
)
Â·
d
Î¹
(where
in
the
ï¬nal
equality,
we
use
the
fact
that
Ï†d
(Î¸)
=
d1
Â·
Ï†1
(d
Â·
Î¸)
(cf.
Chapter
IV,
Corollary
4.6)).
150
Next,
let
us
observe
that
since
the
curvature
at
each
Î¹
of
the
metrized
line
bundle
OEâˆ,B
(e
+
Ï†1
)
is
(constant,
hence)
m-invariant,
it
follows
(cf.
Chapter
IV,
Proposition
5.1)
that
the
m2
-th
power
of
OEâˆ,B
(e
+
Ï†1
)
is
stabilized
by
translation
by
Î·
and
d
Â·
Î·
(cf.
the
discussion
at
the
beginning
of
the
proof
involving
the
line
bundle
â€œN
â€).
On
the
other
hand,
[OEâˆ,B
(e
+
Ï†1
)]
Â·
[e]
=
[e]2
+
Ï†1
(0)
=
âˆ’
1
+
Ï†1
(0)
=
0
12
Thus,
we
obtain
that
0
=
[OEâˆ,B
(e
+
Ï†1
)]
Â·
[âˆ’Î·]
=
[OEâˆ,B
(e
+
Ï†1
)]
Â·
[âˆ’d
Â·
Î·]
This
implies,
in
particular,
that
the
expression
in
large
brackets
in
the
above
equalities
concerning
[e]
Â·
[(Lst,Î·
)B
]
vanishes.
Thus,
in
summary,
we
have:
1

[âˆ’d
Â·
Î·Î¹
]
Â·
Ï†1
[e]
Â·
[(Lst,Î·
)B
]
=
âˆ’
Â·
d
Î¹
1

=âˆ’
Â·
Ï†1
(âˆ’d
Â·
Î·Î¹
)
d
Î¹
=
1
[e]
Â·
[âˆ’d
Â·
Î·]
d
But
note
that
âˆ’d
Â·
Î·
=
e
if
and
only
if
m
divides
d.
Moreover,
since
âˆ’d
Â·
Î·
is
a
torsion
1
point,
it
follows
that
[e]
Â·
[âˆ’d
Â·
Î·]
is
0
if
âˆ’d
Â·
Î·
=
e,
and
âˆ’
12
if
âˆ’d
Â·
Î·
=
e.
This
completes
the
proof.

Finally,
we
note
the
following
consequence
of
the
above
discussion:
Suppose
that
ev
m
=
2d.
Write
L
for
(Lst,Î·
)B
(respectively,
(Lst,Î·
)B
)
if
d
is
odd
(respectively,
even).
Note
that
the
fact
that
m
=
2d
implies
that
L
is
symmetric.
Thus,
we
can
use
the
action
of
the
theta
group
GL
to
construct
algebraic
theta
functions
(cf.
Chapter
IV,
Â§1;
Chapter
IV,
the
discussion
following
Corollary
5.3),
as
follows.
If
Î±
âˆˆ
Eâˆ,B
(T
)
is
any
T
-valued
point
for
a
B-scheme
T
as
in
Proposition
1.2,
then
we
get
an
isomorphism
(of
metrized
vector
bundles
on
Tâˆ
)
L|TÎ±âˆ—
KL
âˆ¼
=
(L|Î±0
)
âŠ—OK
0
OKL
L
def
(where
KL0
=
KL
/2
Â·
KL
,
and
L|Î±0
is
the
metrized
line
bundle
on
KL0
Ã—B
T
obtained
by
descending
L|TÎ±âˆ—
KL
).
Thus,
for
instance,
if
d
is
odd,
then
we
obtain
a
trivialization
of
the
151
restriction
of
L
to
the
subscheme
TÎ±âˆ—
KL
.
In
particular,
restriction
to
TÎ±âˆ—
KL
deï¬nes
(by
composing
with
the
above
isomorphism)
a
morphism
of
metrized
vector
bundles
on
Tâˆ
with
GL
-action:
(fB
)âˆ—
L|T
â†’
(L|Î±0
)
âŠ—OK
0
OKL
L
For
instance,
if
T
=
B,
and
Î±
=
e,
then
we
get
a
morphism
(fB
)âˆ—
L
â†’
(L|e0
)
âŠ—OK
0
OKL
L
i.e.,
this
morphism
allows
us
to
think
of
global
sections
of
L
over
Eâˆ,B
as
being
(essentially)
functions
on
the
B-ï¬nite
scheme
KL
.
Â§2.
The
Deï¬nition
of
the
Evaluation
Map
In
this
Â§,
we
set
up
the
morphism
which
will
be
the
principal
topic
of
the
comparison
isomorphism
to
be
proven
in
Chapter
VI.
Roughly
speaking,
this
morphism
is
the
morphism
given
by
evaluating
global
sections
of
an
ample
line
bundle
on
the
universal
extension
of
a
(log)
elliptic
curve
at
the
torsion
points
of
the
universal
extension.
Let
d
â‰¥
1
be
an
integer.
Suppose
that
S
log
is
a
ï¬ne
noetherian
scheme,
and
let
C
log
â†’
S
log
be
a
log
elliptic
curve
over
S
log
such
that
the
â€œdivisor
at
inï¬nityâ€
D
âŠ†
S
(i.e.,
the
pullback
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
via
the
classifying
morphism
S
â†’
(M1,0
)Z
)
is
a
Cartier
divisor
(i.e.,
locally
deï¬ned
by
a
non-zero
divisor)
on
S.
Also,
let
us
assume
that
eÌtale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root.
Next,
observe
that
by
pulling
back
the
corresponding
objects
in
the
universal
case,
we
obtain
E
â†’
S;
Eâˆ,S
â†’
Sâˆ
(cf.
Chapter
IV,
Â§4,5).
By
considering
objects
which
are
(eÌtale
locally
on
S)
obtained
by
def
pulling
back
metrized
line
bundles
on
the
tautological
Eâˆ,M
over
M
=
(M1,0
)Z
(cf.
the
theory
of
Chapter
IV,
Â§4,5),
we
obtain
a
notion
of
â€œmetrized
line
bundles
on
Eâˆ,S
.â€
We
leave
the
routine
details
of
the
precise
formulation
of
this
notion
to
the
reader.
Let
152
L
be
a
metrized
line
bundle
on
Eâˆ,S
of
relative
degree
d
whose
curvatures
at
all
the
components
of
D
are
d-invariant
(cf.
Chapter
IV,
Proposition
5.1).
In
fact,
ultimately
we
will
mainly
be
interested
in
the
cases
where
S
is
a
covering
B
(as
in
the
discussion
following
Chapter
IV,
Corollary
5.7),
or
an
object
derived
from
such
a
B
(i.e.,
a
completion/localization
of
such
a
B;
a
point
of
such
a
B,
etc.),
and
where
L
is
one
of
the
bundles
ev
â€œLst,Î·
â€
or
â€œLst,Î·
â€
of
Â§1
(or
the
pull-back
of
this
bundle
to
an
object
derived
from
such
a
B).
Next,
we
introduce
some
new
notation.
Recall
the
universal
extension
E
â€ 
â†’
E
of
the
log
elliptic
curve
E
(cf.
Chapter
III,
Deï¬nition
1.2).
Recall
that
the
S-group
scheme
E
â€ 
is
an
extension
of
E
by
the
aï¬ƒne
group
scheme
WE
corresponding
to
the
line
bundle
Ï‰E
.
Then
for
n
â‰¥
1
an
integer,
let
us
denote
by
â›
WE
âˆ’â†’
âœ
â
ânÂ·
â€ 
def
E[n]
=
lim
âœ

âˆ’â†’
â
Eâ€ 
â
âŸ
âŸ
â 
WE
â€ 
the
WE
-torsor
E[n]
â†’
E
obtained
by
applying
a
â€œpush-outâ€
to
this
extension
via
the
morphism
nÂ·
:
WE
â†’
WE
given
by
multiplication
by
n.
Note
that
it
follows
from
the
deï¬nitions
that
the
morphism
dÂ·
:
E
â€ 
â†’
E
â€ 
(â€œmultipliâ€ 
cation
by
dâ€)
factors
through
E[d]
.
Thus,
we
get
a
homomorphism
â€ 
E[d]
â†’
E
â€ 
of
group
schemes
over
S
which
induces
an
isomorphism
(since
dÂ·
induces
multiplication
by
â€ 
d
on
W
)
between
W
âŠ†
E
and
W
âŠ†
E
â€ 
.
Put
another
way,
this
morphism
exhibits
E
E
[d]
E
â€ 
the
WE
-torsor
E[d]
as
the
pull-back
to
E
via
the
multiplication
by
d
map
on
E
of
the
â€ 
W
-torsor
E
â€ 
.
Moreover,
since
E
â€ 
extends
naturally
to
a
W
-torsor
E
â†’
C
(Chapter
E
E
C
III,
Corollary
4.3),
and
the
morphism
â€œmultiplication
by
dâ€
on
E
extends
naturally
to
a
morphism
Cd
â†’
C
(i.e.,
Cd
is
the
semi-stable
model
of
E
over
S
with
d
irreducible
components
in
the
special
ï¬ber
â€“
cf.
the
notation
of
Chapter
IV,
Â§4),
we
thus
obtain
(by
â€ 
pulling
back
EC
â†’
C
via
Cd
â†’
C)
a
natural
WE
-torsor
â€ 
ECd
,[d]
â†’
Cd
â€ 
extending
the
WE
-torsor
E[d]
â†’
E
over
E
âŠ†
Cd
.
Note
that
the
restriction
153
â€ 
EEd
,[d]
â†’
Ed
â€ 
of
ECd
,[d]
to
Ed
âŠ†
Cd
(i.e.,
the
complement
of
the
nodes
of
Cd
â€“
cf.
the
notation
of
Chapter
IV,
Â§4)
has
a
natural
structure
of
group
scheme
over
S
with
respect
to
which
the
â€ 
â€ 
homomorphism
E
â†’
E
â€ 
considered
above
extends
to
a
homomorphism
E
â†’
Eâ€ .
[d]
Ed
,[d]
On
the
other
hand,
since
Eâˆ,S
is
obtained
by
removing
the
nodes
of
an
object
Câˆ,S
,
â€ 
which,
in
turn,
is
obtained
by
blowing
up
Cd
,
we
thus
see
that
the
WE
-torsor
ECd
,[d]
â†’
Cd
â€ 
restricts
to
an
object
ECâˆ,S
,[d]
â†’
Câˆ,S
,
which,
in
turn,
restricts
to
an
object
def
â€ 
â€ 
Eâˆ,[d]
=
EEâˆ,S
,[d]
â†’
Eâˆ,S
â€ 
(which
extends
(EEd
,[d]
â†’
Ed
)
Ã—S
Sâˆ
).
Let
us
denote
the
kernel
of
the
homomorphism
Ed
â†’
E
(i.e.,
the
open
version
of
the
morphism
Cd
â†’
C
considered
above)
by
d
E
âŠ†
Ed
It
follows
from
the
assumption
concerning
the
existence
of
roots
of
the
Tate
parameter
that
d
E
forms
a
ï¬nite,
ï¬‚at
group
scheme
over
S.
Lemma
2.1.
There
is
a
natural
subgroup
scheme
dE
â€ 
âŠ†
Eâ€ 
Cd
,[d]
which
maps
isomorphically
to
d
E
âŠ†
Cd
.
â€ 
Proof.
Indeed,
observe
that
the
homomorphism
EEd
,[d]
â†’
E
â€ 
ï¬ts
into
the
following
commutative
diagram:
0
âˆ’â†’
0
âˆ’â†’
â€ 
WE
âˆ’â†’
EEd
,[d]
â
â
â
â

id
WE
âˆ’â†’
Eâ€ 
âˆ’â†’
Ed
â
â

âˆ’â†’
0
âˆ’â†’
E
âˆ’â†’
0
â€ 
where
the
vertical
arrow
on
the
left
is
the
identity.
Thus,
we
conclude
that
EEd
,[d]
â†’
E
â€ 
is
ï¬nite
and
ï¬‚at,
and
that
its
kernel
maps
isomorphically
down
to
the
kernel
of
Ed
â†’
E,
which
is
simply
d
E
(cf.
the
discussion
at
the
beginning
of
Chapter
IV,
Â§3).

154
We
are
now
ready
to
deï¬ne
the
evaluation
map,
which
is
the
main
topic
of
this
Â§,
and,
indeed,
of
this
paper.
By
abuse
of
notation,
let
us
write
fS
for
all
structure
morphisms
of
objects
over
Sâˆ
down
to
Sâˆ
.
If
n
â‰¥
1
is
an
integer,
let
us
denote
by
(fS
)âˆ—
(L|
â€ 
)<n
Eâˆ,[d]
the
subsheaf
of
(fS
)âˆ—
(L|
â€ 
)
consisting
of
those
sections
whose
torsorial
degree
<
n
(cf.
Eâˆ,[d]
Chapter
III,
Deï¬nition
2.2).
Thus,
(fS
)âˆ—
(L|
â€ 
)<n
forms
a
metrized
vector
bundle
on
Eâˆ,[d]
Sâˆ
of
rank
d
Â·
n
(cf.
the
theory
of
Chapter
IV,
Â§5).
Moreover,
this
metrized
bundle
admits
a
natural
action
of
the
theta
group
GL
associated
to
L.
â€ 
On
the
other
hand,
for
Î±
âˆˆ
E
â€ 
(S)
âŠ†
Eâˆ,[d]
(Sâˆ
),
let
us
consider
the
push-forward
to
Sâˆ
of
the
restriction
of
the
metrized
line
bundle
L
on
Eâˆ,S
to
the
(result
of
base-changing
â€ 
âŠ‡)
T
âˆ—
(d
E
â€ 
)
âˆ¼
by
Sâˆ
â†’
S
the)
subscheme
(E
=
T
âˆ—
(d
E)
âŠ†
Ed
:
Î±
Ed
,[d]
Î±
(fS
)âˆ—
(L|
â€ 
)
TÎ±âˆ—
(d
Eâˆ
)
â€ 
def
(where
d
Eâˆ
=
d
E
â€ 
Ã—S
Sâˆ
;
â€œT??
â€
denotes
â€œtranslation
by
??â€).
One
sees
easily
that
2
L|
â€ 
forms
a
metrized
vector
bundle
on
Sâˆ
of
rank
d
.
Moreover,
since
the
action
of
TÎ±âˆ—
(d
Eâˆ
)
GL
on
L
covers
the
action
of
KL
=
d
E
on
TÎ±âˆ—
(d
E),
we
thus
see
that
this
metrized
vector
bundle
admits
a
natural
action
of
the
theta
group
GL
.
â€ 
Proposition
2.2.
Under
the
above
conditions,
restriction
of
sections
over
Eâˆ,[d]
to
the
â€ 
â€ 
subscheme
TÎ±âˆ—
(d
Eâˆ
)
âŠ†
Eâˆ,[d]
deï¬nes
a
natural
morphism
ÎL,d,Î±
:
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
â†’
(fS
)âˆ—
(L|
â€ 
)
TÎ±âˆ—
(d
Eâˆ
)
of
metrized
vector
bundles
of
rank
d2
on
Sâˆ
which
is
compatible
with
the
actions
of
the
theta
group
GL
on
both
sides.
(When
the
various
subscripts
of
Î
are
ï¬xed
in
a
discussion,
they
will
often
be
omitted,
especially
in
the
case
where
Î±
is
taken
to
be
the
origin.)
The
main
purpose
of
this
paper
is
to
investigate
the
extent
to
which
this
restriction
morphism
ÎL,d,Î±
is
an
isomorphism.
Next,
suppose
that
155
H
âŠ†
GL
is
a
Lagrangian
subgroup
scheme
(cf.
Chapter
IV,
Deï¬nition
1.3
â€“
note
that
the
theory
of
Lagrangian
subgroups
reviewed
in
Chapter
IV,
Â§1,
extends
immediately
to
the
metrized
case).
Let
KH
âŠ†
KL
âˆ¼
=
KH
.)
Let
=
d
E
âŠ†
Ed
be
the
image
of
H
in
KL
.
(Thus,
H
âˆ¼
def
EâˆH
,S
=
Eâˆ,S
/(KH
)Sâˆ
def
(where
(KH
)Sâˆ
=
KH
Ã—S
Sâˆ
).
Note
that
the
immediate
extension
of
Chapter
IV,
Theorem
1.4,
to
the
metrized
case
shows
that
there
exists
a
metrized
line
bundle
LH
(of
relative
degree
1)
on
EâˆH
,S
(deï¬ned
by
H
âŠ†
GL
).
Write
d
EH
def
=
d
E/KH
(so
d
EH
Ã—S
Sâˆ
âŠ†
EâˆH
,S
).
Thus,
d
EH
is
a
ï¬nite
ï¬‚at
group
scheme
over
S.
Next,
observe
that
since
KH
âŠ†
d
E
is
annihilated
by
d,
it
follows
that
the
ï¬nite
morphism
Cd
â†’
C
considered
above
(which
compactiï¬es
multiplication
by
d)
factors
(uniquely)
as
a
composite
Cd
â†’
CH
â†’
C
of
ï¬nite
morphisms,
where
CH
is
S-ï¬‚at,
and,
after
base-change
via
Sâˆ
â†’
S
and
restriction
def
to
US
=
S
âˆ’
D,
the
morphism
Cd
â†’
CH
may
be
identiï¬ed
with
the
morphism
Eâˆ,S
â†’
â€ 
â€ 
EâˆH
,S
.
Thus,
since
Eâˆ,[d]
â†’
Eâˆ,S
is
obtained
from
ECd
,[d]
â†’
Cd
which,
in
turn,
is
â€ 
obtained
by
pulling
back
EC
â†’
C
via
Cd
â†’
C,
it
follows
that
we
obtain
natural
WE
torsors
â€ 
ECH
,[d]
â†’
CH
;
â€ 
EâˆH
,[d]
â†’
EâˆH
,S
â€ 
â€ 
whose
pull-backs
to
Cd
,
Eâˆ,S
may
be
identiï¬ed
with
ECd
,[d]
â†’
Cd
,
Eâˆ,[d]
â†’
Eâˆ,S
.
Note,
moreover,
that
(it
is
immediate
from
the
deï¬nitions
that)
the
lifting
E
â€ 
of
E
deï¬nes
a
d
d
lifting
â€ 
â€ 
d
EâˆH
âŠ†
EâˆH
,[d]
â€ 
of
d
EH
Ã—S
Sâˆ
âŠ†
EâˆH
,S
.
Finally,
let
us
write
Î±H
for
the
image
of
Î±
in
EâˆH
,[d]
(Sâˆ
).
156
Thus,
by
taking
the
H-invariants
of
the
domain
and
range
of
ÎL,d,Î±
in
Proposition
2.2
(and
applying
the
immediate
extension
of
Chapter
IV,
Theorem
1.4,
to
the
metrized
case),
we
obtain
the
following:
â€ 
Proposition
2.3.
Under
the
above
conditions,
restriction
of
sections
over
EâˆH
,[d]
to
the
â€ 
â€ 
subscheme
TÎ±âˆ—
(d
EâˆH
)
âŠ†
EâˆH
,[d]
deï¬nes
a
natural
morphism
:
(fS
)âˆ—
(LH
|
â€ 
ÎH
L,d,Î±
Eâˆ
)<d
â†’
(fS
)âˆ—
(LH
|
â€ 
TÎ±âˆ—
(d
EâˆH
)
H
,[d]
)
H
of
metrized
vector
bundles
of
rank
d
on
Sâˆ
which
may
be
identiï¬ed
with
the
morphism
obtained
from
the
restriction
map
ÎL,d,Î±
of
Proposition
2.2
by
taking
H-invariants.
Since,
in
this
case,
taking
H-invariants
is
a
faithful
operation
(cf.
Chapter
IV,
Theorem
1.4),
it
follows
that,
for
instance,
the
bijectivity
of
ÎL,d,Î±
is
equivalent
to
that
of
ÎH
.
L,d,Î±
Often,
it
will
be
technically
easier
to
analyze
the
restriction
morphism
Î
after
taking
H-invariants.
Finally,
to
prepare
for
Â§5,
6
below,
we
consider
the
dependence
of
Î
on
Î±.
Let
w
be
a
section
of
WE
.
Then
note
that
translation
by
w
induces
natural
identiï¬cations
Twâˆ—
(L|
â€ 
Eâˆ,[d]
)
=
L|
â€ 
;
Eâˆ,[d]
Twâˆ—
(LH
|
â€ 
Eâˆ
)
=
LH
|
â€ 
Eâˆ
H
,[d]
H
,[d]
Thus,
translation
by
w
eï¬€ects
automorphisms
Twâˆ—
of
the
metrized
vector
bundles
(fS
)âˆ—
(L
â€ 
(fS
)âˆ—
(LH
|
â€ 
)<d
;
Eâˆ,[d]
Eâˆ
)<d
H
,[d]
which
are
unipotent
with
respect
to
the
ï¬ltration
(on
(fS
)âˆ—
(âˆ’)<d
)
by
torsorial
degree.
In
other
words,
these
automorphisms
Twâˆ—
induce
the
identity
on
each
of
the
subquotients
(fS
)âˆ—
(âˆ’)<i
/(fS
)âˆ—
(âˆ’)<iâˆ’1
(for
i
âˆˆ
Z).
Indeed,
this
follows
immediately
from
the
deï¬nition
of
a
WE
-torsor.
Thus,
since
both
the
domain
and
range
of
the
morphisms
of
Proposition
2.2
(respectively,
2.3)
are
the
same
(i.e.,
not
just
isomorphic)
for
Î±
and
Î±
+
w,
it
makes
sense
to
compare
these
two
morphisms,
and,
in
particular,
to
compare
their
determinants.
Note,
moreover,
that
the
morphisms
of
Propositions
2.2
(respectively,
2.3)
for
Î±,
Î±
+
w
diï¬€er
precisely
by
composition
with
the
automorphism
Twâˆ—
.
Thus,
we
obtain
the
following:
Lemma
2.4.
For
any
section
w
of
WE
,
we
have:
det(ÎL,d,Î±
)
=
det(ÎL,d,Î±+w
);
det(ÎH
)
=
det(ÎH
)
L,d,Î±
L,d,Î±+w
157
(where
â€œdet(âˆ’)â€
is
a
section
of
the
metrized
line
bundle
det(range)
âŠ—
det(domain)âˆ’1
on
Sâˆ
).
Â§3.
Extension
of
the
EÌtale-Integral
Structure
In
this
Â§,
we
show
that
the
eÌtale-integral
structures
â€œRet
â€
discussed
in
Chapter
III,
Â§6,
are
deï¬ned
for
arbitrary
elliptic
curves
(i.e.,
not
just
for
degenerating
elliptic
curves,
as
in
the
discussion
of
Chapter
III,
Â§6),
and,
moreover,
are
that
the
functions
in
these
eÌtaleintegral
structures
assume
integral
values
at
the
torsion
points
appearing
in
the
deï¬nition
of
the
evaluation
map.
It
will
be
relative
to
this
eÌtale-integral
structure
(deï¬ned
for
arbitrary
elliptic
curves)
that
we
will
prove
the
comparison
isomorphism
in
Chapter
VI.
We
work
with
the
notation
of
Chapter
III,
Â§5,
6.
Thus,
let
O
be
a
Zariski
localization
of
OK
,
where
K
is
a
ï¬nite
extension
of
Q.
Let
def
A
=
O[[q]];
def
S
=
Spec(A)
Then
we
have
a
one-dimensional
semi-abelian
scheme
Eâ†’S
over
S.
Roughly
speaking,
one
may
think
of
E
as
being
â€œGm
/q
Z
.â€
More
rigorously,
E
may
be
compactiï¬ed
to
a
log
elliptic
curve
C
log
â†’
S
log
.
Moreover,
CS
(the
result
of
base
changing
C
to
the
q-adic
completion
S
of
S)
may
be
written
as
CS
=
C
âˆ
/Zet
S
Recall
that
in
Chapter
III,
Â§6,
we
used
the
natural
isomorphism
of
Chapter
III,
Theorem
5.6,
Corollary
5.9:
â€ 
EC
|C
âˆ
âˆ¼
=
(WE
)S
Ã—S
C
âˆ
S
S
to
deï¬ne
a
new
integral
structure
Retâ€ 
EC
on
R
â€ 
âŠ—
Q
(cf.
Chapter
III,
Proposition
6.1).
If
one
trivializes
Ï‰E
by
means
of
the
EC
section
d
log(U
),
then
we
may
write
158
WE
=
Spec(OS
[T
])
(where
T
is
the
indeterminate
corresponding
to
the
chosen
trivialization
of
Ï‰E
).
The
new
integral
structure
was
obtained
by
essentially
adjoining
the
polynomials
def
T
[n]
=
1
T
(T
âˆ’
1)(T
âˆ’
2)
Â·
.
.
.
Â·
(T
âˆ’
(n
âˆ’
1))
n!
(for
n
âˆˆ
Zâ‰¥0
)
to
the
original
integral
structure.
Now
let
us
write
(for
d
â‰¥
1
an
integer)
(Cd
)S
=
C
âˆ
/(d
Â·
Zet
)
def
S
Since
(Cd
)S
â†’
S
is
proper,
it
algebrizes
to
some
Cd
â†’
S.
Let
E
â†’
S
be
the
open
subscheme
of
Cd
obtained
by
removing
from
Cd
the
irreducible
components
of
the
special
ï¬ber
(i.e.,
the
ï¬ber
over
q
=
0)
that
do
not
contain
the
image
of
the
identity
element
eC
âˆ
âˆˆ
C
âˆ
(S)
of
C
âˆ
.
Let
Ed
â†’
S
denote
the
complement
of
the
nodes
of
the
special
S
S
S
ï¬ber
of
Cd
.
Thus,
Ed
and
E
have
a
natural
structure
of
group
scheme
over
S,
and
E
is
a
semi-abelian
scheme
over
S.
Moreover,
let
us
observe
that
we
have
a
natural
ï¬nite
eÌtale
covering
Ed
â†’
E
of
degree
d
which
compactiï¬es
to
a
ï¬nite
morphism
Cd
â†’
C.
Relative
to
the
notation
of
Â§2,
if
one
takes
â€œEâ€
in
loc.
cit.
to
be
E
(in
the
notation
of
the
present
discussion),
then
the
resulting
â€œEd
â€
(respectively,
â€œCd
â€)
in
the
notation
of
loc.
cit.
corresponds
to
Ed
(respectively,
Cd
)
in
the
present
discussion.
Moreover,
I
claim
that:
â€ 
â€ 
â€ 
â€ 
The
resulting
â€œE[d]
,â€
â€œECd
,[d]
â€
of
loc.
cit.
correspond
to
EC
|C
,
EC
|E
d
d
in
the
notation
of
the
present
discussion.
Indeed,
to
prove
this,
one
reasons
as
follows:
The
multiplication
by
d
morphism
Ed
â†’
E
factors
as
the
composite
of
the
ï¬nite
eÌtale
isogeny
Ed
â†’
E
under
consideration
with
some
other
ï¬nite
isogeny
E
â†’
E
(of
degree
d,
whose
kernel
may
be
naturally
identiï¬ed
with
Î¼d
).
Moreover,
the
push-forward
morphism
associated
to
the
isogeny
E
â†’
E
induces
a
natural
isomorphism
between
the
universal
extensions
of
E
and
E
(cf.
the
discussion
at
the
beginning
of
Chapter
IV,
Â§3).
Thus,
it
follows
that
the
pull-back
of
the
universal
extension
of
E
to
Ed
via
the
multiplication
by
d
map
may
be
identiï¬ed
with
the
pull-back
of
the
universal
extension
of
E
to
Ed
via
the
ï¬nite
eÌtale
isogeny
E
â†’
E
under
consideration.
159
â€ 
On
the
other
hand,
the
former
pull-back
is,
by
the
deï¬nition
of
â€œE[d]
â€
given
in
Â§2,
none
â€ 
other
than
the
â€œE[d]
â€
associated
to
Ed
.
(One
concludes
the
corresponding
statement
for
â€ 
â€œECd
,[d]
â€
by
using
the
fact
that
the
complement
of
Ed
in
(the
normal
scheme)
Cd
is
of
codimension
2.)
This
completes
the
proof
of
the
claim.
Thus,
in
the
following,
we
will
write
E
â€ 
Cd
,[d]
â€ 
for
the
WE
-torsor
over
Cd
which
is
the
â€œECd
,[d]
â€
(in
the
notation
of
Â§2)
for
the
case
where
one
takes
â€œEâ€
(in
Â§2)
to
be
E
(in
the
notation
of
the
present
discussion).
In
particular,
we
see
that
by
pulling
back
the
new
integral
structure
of
Chapter
III,
Proposition
6.1,
on
Retâ€ 
via
Cd
â†’
C,
we
obtain
a
new
integral
structure
EC
âŠ†R
â€ 
Retâ€ 
E
E
âŠ—Q
Cd
,[d]
Cd
,[d]
Moreover,
this
integral
structure
has
the
property
that:
If
f
is
any
section
of
Retâ€ 
(over,
say,
Ed
),
then
the
restriction
of
f
E
Cd
,[d]
to
any
d-torsion
point
Ï„
âˆˆ
Ed
(S)
deï¬nes
an
integral
section
of
OS
.
Indeed,
pulling
everything
back
to
C
âˆ
,
we
see
this
amounts
to
the
observation
that
the
S
pull-backs
to
C
âˆ
of
the
d-torsion
points
of
Ed
have
coordinates,
relative
to
the
decompoS
â€ 
âˆâˆ¼
sition
EC
|C
=
(WE
)S
Ã—S
C
âˆ
,
given
by
S
S
(Î²,
Î±
Â·
q
Î²
)
where
Î²
âˆˆ
Z,
and
Î±
is
a
d-th
root
of
unity.
(Indeed,
this
follows
from
Chapter
III,
Corollary
5.9,
and
the
fact
that
the
â€œq-parameterâ€
of
E
is
given
by
q
d
.)
Thus,
the
above
property
follows
from
the
fact
that
any
T
[n]
has
integral
values
at
Î²
âˆˆ
Z.
(In
fact,
for
Î²
âˆˆ
Zâ‰¥0
,


the
value
of
T
[n]
at
T
=
Î²
is
0
(if
Î²
<
n),
1
(if
Î²
=
n),
Î²n
(i.e.,
binomial
coeï¬ƒcients,
if
Î²
>
n).)
Next,
let
us
observe
that
the
semi-abelian
scheme
E
â†’
S
is
universal
among
degenerating
one-dimensional
semi-abelian
schemes
whose
q-parameters
admit
a
d-th
root.
Thus,
what
we
have
done
above
already
deï¬nes
a
new
integral
structure
on
â€œR
â€ 
â€
for
any
EC
,[d]
d
degenerating
one-dimensional
semi-abelian
scheme
E
â†’
S
(for
which
the
base
S
is
Z-ï¬‚at)
160
whose
q-parameter
admits
a
d-th
root.
In
fact,
we
would
like
to
extend
this
new
integral
from
a
formal
neighborhood
of
the
divisor
at
inï¬nity
(where
the
new
structure
on
R
â€ 
EC
,[d]
d
integral
structure
has
already
been
deï¬ned)
to
the
whole
of
(M1,0
)Z
.
That
is
to
say,
in
the
following
discussion,
we
propose
to
do
the
following:
We
would
like
to
â€œp-adically
analytically
continueâ€
the
new
integral
âŠ—
Qâ€
from
a
formal
neighborhood
of
the
divisor
structure
on
â€œR
â€ 
EC
,[d]
d
at
inï¬nity
to
the
whole
of
(M1,0
)Z
.
More
precisely,
given
any
one-dimensional
semi-abelian
scheme
ET
â†’
T
,
where
T
is
Z-ï¬‚at,
and
the
q-parameters
of
ET
â†’
T
are
non-zero
divisors
that
admit
d-th
roots,
we
would
like
to
deï¬ne
a
new
integral
structure
on
the
associated
R
â€ 
âŠ—
Q.
Clearly,
since
E(C
T
)d
,[d]
n
for
a
ï¬xed
n,
the
new
integral
structure
on
F
(R
â€ 
E(C
âŠ—
Q)
diï¬€ers
from
the
integral
T
)d
,[d]
n
structure
deï¬ned
by
F
(R
â€ 
)
at
only
ï¬nitely
many
primes,
it
suï¬ƒces
to
deï¬ne
these
E(C
T
)d
,[d]
new
integral
structure
locally,
p-adically,
at
each
rational
prime
p.
Thus,
we
may
assume
that
T
is
a
Zp
-scheme.
Next,
let
us
observe
that
in
the
discussion
of
Chapter
III,
Â§6,
of
the
new
integral
structure
in
the
case
of
a
degenerating
ET
â†’
T
(i.e.,
Chapter
III,
Proposition
6.1),
the
key
object
that
we
needed
in
order
to
deï¬ne
the
new
integral
structure
was
the
canoniâ€ 
cal
decomposition
E
|C
âˆ
âˆ¼
=
(WE
)
Ã—
C
âˆ
,
i.e.,
the
canonical
section
Îº
(cf.
Chapter
III,
C
S
S
S
S
Theorem
2.1).
It
is
precisely
because
this
canonical
section
is
only
deï¬ned
in
a
formal
neighborhood
of
the
divisor
at
inï¬nity
that
the
discussion
of
Chapter
III,
Â§6
(i.e.,
Chapter
III,
Proposition
6.1)
could
only
be
carried
out
over
such
a
formal
neighborhood.
In
fact,
however,
careful
inspection
reveals
that
really,
for
a
ï¬xed
n,
in
order
to
deï¬ne
F
n
(Retâ€ 
)
E(C
T
)d
,[d]
N
at
a
ï¬xed
prime
p,
it
suï¬ƒces
to
have
Îº
only
modulo
p
,
for
some
suï¬ƒciently
large
N
.
Moreover,
in
the
notation
of
the
above
discussion
in
the
degenerating
case,
if
we
let
G
âŠ†
C
âˆ
/(pN
Â·
d
Â·
Zet
)
S
be
the
group
scheme
over
S
obtained
by
removing
the
nodes
from
C
âˆ
/(pN
Â·dÂ·Zet
),
then
we
S
get
a
ï¬nite
eÌtale
covering
G
â†’
E
(of
degree
pN
)
with
the
property
that
Îº
is
already
deï¬ned
modulo
pN
after
pull-back
via
G
â†’
E
(or
over
the
compactiï¬cation
C
âˆ
/(pN
Â·dÂ·Zet
)
â†’
Cd
).
S
Indeed,
this
follows
from
the
fact
that
1et
âˆˆ
Zet
acts
on
Îº
by
Îº
â†’
Îº
+
1
(cf.
Chapter
III,
Theorem
5.6),
so
elements
of
pN
Â·
d
Â·
Zet
preserve
Îº
modulo
pN
.
Note,
moreover,
that
since
the
isogeny
G
â†’
E
is
of
degree
pN
,
there
exists
an
isogeny
of
group
schemes
H
â†’
G
which
is
ï¬nite
of
degree
pN
such
that
the
composite
161
Hâ†’E
is
isomorphic
to
the
â€œmultiplication
by
pN
â€
map
on
E
over
US
=
Spec(A[q
âˆ’1
])
(âŠ†
S).
Thus,
in
summary,
The
canonical
section
Îº
is
deï¬ned
modulo
pN
after
pull-back
from
E
to
H.
With
these
preparatory
remarks
behind
us,
we
are
now
ready
to
begin
the
â€œanalytic
continuationâ€
argument:
Analytic
Continuation
Argument:
Let
ET
â†’
T
be
a
family
of
elliptic
curves,
where
T
is
a
ï¬nite,
ï¬‚at
(hence,
in
particular,
aï¬ƒne)
scheme
over
(M1,0
)Zp
(i.e.,
the
complement
of
the
divisor
at
inï¬nity
of
(M1,0
)Zp
).
To
simplify
the
discussion,
we
shall
also
assume
that
T
is
normal.
Write
HT
â†’
ET
for
the
isogeny
given
by
multiplication
by
pN
.
(Thus,
HT
is
abstractly
isomorphic
as
a
T
-scheme
to
ET
.)
â€ 
â€ 
Consider
the
torsor
ET,[d]
â†’
ET
(i.e.,
the
â€œE[d]
â€
associated
to
ET
).
This
torsor
deï¬nes
a
class
Î·
âˆˆ
H
1
(ET
,
Ï‰ET
|ET
)
âˆ¼
=
OT
(where
the
â€œâˆ¼
=â€
follows
from
relative
Serre
duality
for
the
morphism
ET
â†’
T
).
If
we
pull
this
class
back
to
HT
,
then
we
obtain
a
class
def
Î·H
âˆˆ
E
=
H
1
(HT
,
Ï‰ET
|HT
)
where
E
is
a
line
bundle
on
T
.
I
claim
that
Î·H
is
â‰¡
0
modulo
pN
.
There
are
many
ways
to
verify
this
claim.
One
way
is
the
following:
Since
E
is
a
line
bundle
on
T
,
and
T
is
normal,
it
suï¬ƒces
to
verify
that
Î·H
vanishes
modulo
pN
after
restricting
Î·H
to
the
p-adic
completion
OT,p
of
the
localization
of
T
at
any
generic
point
pT
of
T
âŠ—
Fp
.
On
the
other
hand,
the
discrete
valuation
ring
OT,pT
is
clearly
dominated
by
a
discrete
valuation
ring
which
arises
as
the
p-adic
completion
OW,pW
of
some
W
at
a
generic
point
pW
of
W
âŠ—
Fp
,
where
W
is
the
base
of
some
degenerating
elliptic
curve
whose
classifying
morphism
to
(M1,0
)Z
deï¬nes
a
162
ï¬nite
morphism
W
â†’
Spec(Zp
[[q]]).
On
the
other
hand,
for
bases
such
as
OW,pW
,
the
fact
that
Î·H
vanishes
modulo
pN
follows
from
the
above
discussion
of
the
degenerating
case
(i.e.,
where
we
saw
that
the
canonical
section
Îº
is
deï¬ned
modulo
pN
after
pull-back
via
â€œH
â†’
Eâ€).
This
concludes
the
proof
of
the
claim.
â€ 
Thus,
the
Ï‰E
-torsor
ET,[d]
â†’
ET
splits
modulo
pN
after
pull-back
via
HT
â†’
ET
.
We
would
like
to
show
that
this
torsor
not
only
splits
modulo
pN
,
but
that
it
admits
a
splitting
which
extends
the
canonical
splitting
Îº
(modulo
pN
)
in
the
degenerating
case.
To
do
this,
we
must
characterize
the
canonical
splitting
Îº
in
terms
that
make
sense
even
for
nonâ€ 
degenerating
elliptic
curves.
We
do
this
as
follows:
Note
that
since
ET,[d]
has
a
structure
def
of
abelian
group
scheme
over
T
,
it
admits
an
action
by
Î£
=
{Â±1}.
Of
course,
HT
and
ET
are
also
commutative
group
schemes
over
T
,
hence
admit
natural
actions
by
Î£
=
{Â±1}.
Then
let
us
observe
that
since
the
canonical
splitting
Îº
is
a
group
homomorphism
(cf.
Chapter
III,
Theorem
2.1),
it
commutes
with
the
respective
actions
of
Î£
=
{Â±1}.
Let
us
regard
the
line
bundle
Ï‰ET
on
T
as
an
OT
-module
with
Î£
action,
where
Î£
acts
via
the
tautological
character
Î£
â†’
{Â±1}
âŠ†
OTÃ—
.
Then
it
follows
by
general
nonsense
that
the
â€ 
obstruction
to
deï¬ning
a
Î£-equivariant
splitting
of
ET,[d]
over
HT
modulo
pN
is
a
class
Î·Î£
âˆˆ
H
1
(Î£,
Ï‰ET
âŠ—
(Z/pN
))
=
{Ï‰ET
âŠ—
(Z/pN
)}
âŠ—
(Z/2)
Moreover,
if
this
class
vanishes,
then
such
a
splitting
will
be
unique
modulo
H
0
(Î£,
Ï‰ET
âŠ—
(Z/pN
))
=
ker(2
:
Ï‰ET
âŠ—
(Z/pN
))
(i.e.,
modulo
the
kernel
of
multiplication
by
2
on
Ï‰ET
âŠ—
(Z/pN
)).
Thus,
we
would
like
to
see
that
Î·Î£
vanishes.
Of
course,
this
is
only
a
problem
when
p
=
2.
In
this
case,
since
Ï‰ET
is
a
line
bundle
on
T
,
one
proves
that
Î·Î£
vanishes
in
precisely
the
same
way
as
we
proved
above
that
Î·H
vanishes
modulo
pN
â€“
i.e.,
by
reducing
to
the
degenerating
case,
where
we
know
the
result
to
be
true.
This
completes
the
proof
that
Î·Î£
is
always
zero.
As
for
uniqueness,
in
general,
we
only
get
uniqueness
modulo
pN
âˆ’1
(of
course,
if
p
is
odd,
we
get
uniqueness
modulo
pN
).
However,
by
taking
N
suï¬ƒciently
large
(e.g.,
one
larger
than
the
original
N
necessary
to
deï¬ne
the
integral
structure),
this
is
not
a
problem.
This
uniqueness
thus
shows,
by
the
same
argument
as
that
used
above
to
prove
that
Î·H
â‰¡
0
modulo
pN
â€“
i.e.,
by
comparing
with
the
degenerating
case
â€“
that:
â€ 
There
exists
a
splitting
of
the
torsor
ET,[d]
over
HT
modulo
pN
which
extends
the
canonical
splitting
Îº
considered
in
the
degenerating
case
modulo
pN
âˆ’1
.
Thus,
by
taking
N
suï¬ƒciently
large,
we
see
that
all
the
functions
â€œT
[i]
â€
(for
i
<
our
ï¬xed
n)
may
be
deï¬ned
modulo
a
suï¬ƒciently
large
power
of
p
so
that
we
may
form
a
new
integral
structure
163
F
n
(Retâ€ 
ET
,[d]
)âŠ†R
â€ 
ET
,[d]
âŠ—Q
which
extends
the
integral
structure
of
Chapter
III,
Proposition
6.1
in
the
degenerating
case
â€“
at
least
after
pulling
back
from
ET
to
HT
.
But
then,
by
using
the
â€œOT,pT
â€™s,â€
reduction
to
the
degenerating
case,
and
ï¬nite
ï¬‚at
descent
(of
coherent
sheaves)
for
the
morphism
HT
â†’
ET
,
it
is
easy
to
see
that
these
integral
structures
descend
back
down
to
ET
,
as
desired.
This
completes
the
â€œp-adic
analytic
continuation
argument.â€
In
other
words,
we
have
proven
the
following:
Theorem
3.1.
Let
d
â‰¥
1
be
an
integer.
Let
C
log
â†’
S
log
be
any
log
elliptic
curve
as
at
the
beginning
of
Â§2
â€“
i.e.,
the
associated
q-parameter
âˆˆ
OS
(where
S
is
the
completion
of
S
along
the
divisor
at
inï¬nity
D
âŠ†
S
deï¬ned
by
C
log
â†’
S
log
)
is
a
non-zero
divisor
which,
eÌtale
locally,
admits
a
d-th
root.
Suppose
further
that
S
is
Zâ€ 
(cf.
Â§2,
for
the
deï¬nition
of
ECd
,[d]
)
and
its
ï¬ltration
ï¬‚at.
Then
the
resulting
R
â€ 
E
Cd
,[d]
admit
natural
integral
structures
.
.
.
âŠ†
F
n
(Retâ€ 
EC
,[d]
)
âŠ†
.
.
.
âŠ†
Retâ€ 
EC
,[d]
d
where
F
n
(Retâ€ 
d
âŠ†R
â€ 
EC
,[d]
âŠ—Q
d
)
is
a
rank
n
vector
bundle
on
Cd
such
that
EC
,[d]
d
(F
n+1
/F
n
)(Retâ€ 
)=
EC
,[d]
1
Â·
OCd
âŠ—OS
Ï„EâŠ—n
n!
d
These
integral
structures
are
uniquely
characterized
by
the
properties
that
they
are
functorial
in
C
log
â†’
S
log
,
and
they
extend
the
integral
structures
deï¬ned
in
the
degenerating
case
in
Chapter
III,
Proposition
6.1.
Finally,
the
functions
of
Retâ€ 
assume
integral
values
EC
,[d]
d
â€ 
at
the
d-torsion
points
of
ECd
,[d]
(S).
Proof.
It
remains
only
to
remark
that
the
ï¬nal
assertion
concerning
the
integrality
of
the
values
at
d-torsion
points
may
be
veriï¬ed
for
normal
T
as
in
the
analytic
continuation
argument
above
by
checking
integrality
at
the
various
OT,pT
(where
pT
is
a
generic
point
164
of
T
âŠ—
Fp
).
Moreover
the
integrality
at
OT,pT
may
be
veriï¬ed
by
reduction
to
the
degenerating
case,
where
it
has
already
been
veriï¬ed
(cf.
the
discussion
following
Chapter
III,
Proposition
6.1).

Deï¬nition
3.2.
(Just
as
in
Chapter
III,
Deï¬nition
6.2)
the
integral
structures
denoted
by
a
superscript
â€œetâ€
will
be
referred
to
as
eÌtale-integral,
or
et-integral,
structures.
That
is
to
say,
â€œetâ€
stands
for
â€œeÌtale,â€
and
is
the
same
as
the
â€œetâ€
in
Zet
.
In
particular,
the
â€œeÌtale-integral
structureâ€
may
be
thought
of
as
the
integral
structure
arising
from
thinking
of
algebraic
functions
on
the
universal
extension
as
set-theoretic
functions
on
Zet
,
i.e.,
on
the
ï¬bers
of
the
inï¬nite
eÌtale
covering
C
âˆ
â†’
C
âˆ
/Zet
=
CS
.
S
S
The
original
integral
structure
on
the
various
â€œRâ€™sâ€
(i.e.,
the
integral
structures
without
a
label)
will
be
referred
to
as
the
de
Rham-integral,
or
DR-integral,
structures.
This
is
because
they
arise
from
the
original
natural
integral
structures
on
the
universal
extension
Ã—
1
E
â€ 
as
a
sort
of
de
Rham
cohomology
â€“
i.e.,
â€œHDR
(E,
OE
)â€
â€“
associated
to
E.
Remark.
In
fact,
even
though
in
Theorem
3.1,
we
assumed
that
S
was
Z-ï¬‚at,
by
working
in
the
universal
case
and
then
pulling
back,
one
sees
that
the
various
sheaves
we
constructed
with
a
superscript
â€œetâ€
are
deï¬ned
for
any
C
log
â†’
S
log
as
in
Theorem
3.1
even
without
the
assumption
of
Z-ï¬‚atness.
Â§4.
Linear
Relations
Among
Higher
Schottky-Weierstrass
Zeta
Functions
In
this
Â§,
we
consider
the
extent
to
which
the
twisted
Schottky-Weierstrass
zeta
functions
of
Chapter
IV,
Â§3,
satisfy
linear
relations
modulo
various
powers
of
q
over
the
base
ring
A
(notation
as
in
Chapter
IV,
Â§3).
Thus,
throughout
this
Â§,
we
will
use
the
notation
and
conventions
of
Chapter
IV,
Â§2,3.
The
calculations
of
linear
relations
that
we
carry
out
in
this
Â§
will
turn
out
to
yield
the
key
technical
machinery
behind
the
main
result
of
this
paper.
We
begin
by
ï¬xing
our
base
ring
O
as
in
Chapter
IV,
Â§2,3).
Thus,
O
is
a
Zariski
localization
of
the
ring
of
integers
of
a
ï¬nite
extension
of
Q
such
that
Pic(O)
=
{1}.
We
also
ï¬x
a
positive
even
integer
n
=
2m.
Then
over
S
=
Spec(A)
(where
A
=
O[[q]]),
we
constructed
in
Chapter
IV,
Â§2,
an
isogeny
Eâ†’E
whose
kernel
is
equal
to
Î¼n
.
Over
E,
we
considered
various
line
bundles
such
as:
def
LE
=
OE
(e);
165

M
E

was
deï¬ned
as
the
restriction
to
E
âŠ†
C
of
a
line
bundle
M

on
C
obtained
by
Here,
M
E
âˆ
descending
the
line
bundle
LâŠ—n
via
the
â€œstandard
actionâ€
of
Zet
Ã—
Î¼n
on
LâŠ—n
C
âˆ
on
C
Câˆ
.
S
S
S
âŠ—n
Recall
that
the
line
bundle
LC
âˆ
is
the
line
bundle
whose
global
sections
over
C
âˆ
can
be
S
S
written
as
topological
A-linear
combinations
of
certain
special
monomials
2
q
mÂ·k
+ik
Â·
U
2mk+i
Â·
Î¸
m
(where
k,
i
âˆˆ
Z,
|i|
â‰¤
m)
discussed
in
Chapter
IV,
Proposition
2.2.
Moreover,
for
any
character
Ï‡
âˆˆ
Hom(Î n
,
(Î¼n
)S
)
(where
Î n
=
(Zet
/n)
Ã—
Î¼n
),
we
deï¬ned
a
line
bundle
Ï‡
M
E
and
we
saw
in
Chapter
IV,
Theorem
2.1
that
for
a
certain
particular
character,
which
we
denote
by
Ï‡Î¸
âˆˆ
Hom(Î n
,
(Î¼n
)S
),
we
have
an
isomorphism
Ï‡
LE
âˆ¼
=M
Î¸
E
of
degree
1
line
bundles
on
E.
In
the
following
discussion,
we
would
like
to
ï¬x
a
character
Ï‡L
âˆˆ
Hom(Î n
,
(Î¼n
)S
)
def
Let
us
write
Ï‡M
=
Ï‡L
Â·
Ï‡Î¸
and
denote
the
restrictions
of
Ï‡M
and
Ï‡L
to
Î¼n
âŠ†
(Zet
/n)
Ã—
Î¼n
=
Î n
by
Ï‡M,Î¼
:
Î¼n
â†’
Î¼n
and
Ï‡L,Î¼
:
Î¼n
â†’
Î¼n
,
respectively.
Thus,
we
have
Ï‡M
LÏ‡L
âˆ¼
=M
E
E
Recall
that
there
is
a
standard
action
of
Î¼n
on
the
special
monomials
2
q
mÂ·k
+ik
Â·
U
2mk+i
Â·
Î¸
m

Note
that
for
this
action,
Î¼
acts
trivially
on
Î¸
m
.
Let
(i.e.,
the
action
used
to
deï¬ne
M).
n
us
refer
to
the
special
monomials
on
which
Î¼n
acts
via
(Ï‡M,Î¼
)âˆ’1
as
Ï‡L
-special
monomials.
For
j
a
positive
integer,
let
us
write
cj
(Ï‡L
)
âˆˆ
Q
166
for
the
maximal
nonzero
rational
number
c
such
that
modulo
q
nÂ·c
,
the
number
of
nonzero
Ï‡L
-special
monomials
is
<
j.
Let
us
denote
this
set
of
<
j
nonzero
(modulo
q
nÂ·cj
(Ï‡L
)
)
Ï‡L
-special
monomials
by
Cj
(Ï‡L
)
We
remark
that,
here
(and
in
the
following
discussion):
By
â€œmoduloâ€
we
mean,
strictly
speaking,
when
restricted
to
sections
of
LâŠ—n
C
âˆ
|E
over
ES
=
(Gm
)S
.
S
S
When
(as
in
the
following
discussion),
the
character
Ï‡L
is
ï¬xed,
we
shall
often
just
write
cj
,
Cj
for
cj
(Ï‡L
)
and
Cj
(Ï‡L
),
respectively.
Schola
4.1.
Computation
of
Special
Monomials
Modulo
Powers
of
q
Let
us
compute
Cj
and
cj
.
There
are
three
cases
to
consider:
Case
I:
Ï‡L,Î¼
=
1.
In
this
case,
the
Ï‡L
-special
monomials
are
those
for
which
i
=
Â±m.
Thus,
the
monomials
for
which
the
exponent
m
Â·
k
2
+
ik
of
q
is
0
are
precisely:
def
M
=
U
m
Â·
Î¸m
,
def
M
=
U
âˆ’m
Â·
Î¸
m
=
(âˆ’1)et
(M
)
The
other
Ï‡L
-special
monomials
2
ket
(M
)
=
q
mÂ·k
+mk
Â·
U
2mk+m
Â·
Î¸
m
,
(âˆ’k)et
(M
)
=
q
mÂ·k
+mk
Â·
U
âˆ’2mkâˆ’m
Â·
Î¸
m
2
are
given
by
applying
(Â±k)et
(for
k
â‰¥
0)
to
these
original
two.
In
particular,
there
are
precisely
2
+
2k
monomials
obtained
by
applying
ket
(for
|k
|
â‰¤
k)
to
the
original
two
monomials.
Thus,
for
k
â‰¥
0,
we
have
c2k+1
=
c2k+2
=
1
1
(m
Â·
k
2
+
mk)
=
(k2
+
k)
n
2
while
the
set
C2k+1
=
C2k+2
is
given
by
{ket
(M
)}0â‰¤k
<k

{ket
(M
)}âˆ’k<k
â‰¤0
Case
II:
Ï‡L,Î¼
=
Ï‡Î¸
|Î¼n
.
In
this
case,
the
Ï‡L
-special
monomials
are
those
for
which
i
=
0.
Thus,
the
only
monomial
for
which
the
exponent
m
Â·
k
2
+
ik
of
q
is
0
is
the
monomial:
167
def
M
=
Î¸m
The
other
Ï‡L
-special
monomials
(âˆ’k)et
(M
)
=
q
mÂ·k
Â·
U
âˆ’2mk
Â·
Î¸
m
2
2
ket
(M
)
=
q
mÂ·k
Â·
U
2mk
Â·
Î¸
m
,
are
given
by
applying
(Â±k)et
(for
k
â‰¥
0)
to
this
original
monomial.
In
particular,
there
are
precisely
1+2k
monomials
obtained
by
applying
ket
(for
|k
|
â‰¤
k)
to
the
original
monomial.
Thus,
we
have
c1
=
0
and,
for
k
â‰¥
1,
c2k
=
c2k+1
=
1
1
Â·
m
Â·
k2
=
k2
n
2
while
C1
=
âˆ…;
the
set
C2k
=
C2k+1
is
given
by
{ket
(M
)}0â‰¤|k
|<k
Case
III:
Ï‡L,Î¼
2
=
1.
In
this
case,
the
Ï‡L
-special
monomials
are
those
for
which
i
=
iÏ‡
,
for
some
ï¬xed
integer
iÏ‡
such
that
0
<
|iÏ‡
|
<
m.
Thus,
the
only
monomial
for
which
the
exponent
m
Â·
k
2
+
ik
of
q
is
0
is
the
monomial:
def
M
=
U
iÏ‡
Â·
Î¸
m
The
other
Ï‡L
-special
monomials
ket
(M
)
=
q
mÂ·k
+iÏ‡
Â·k
Â·
U
2mk+iÏ‡
Â·
Î¸
m
,
2
(âˆ’k)et
(M
)
=
q
mÂ·k
âˆ’iÏ‡
Â·k
Â·
U
âˆ’2mk+iÏ‡
Â·
Î¸
m
2
are
given
by
applying
(Â±k)et
(for
k
â‰¥
0)
to
this
original
monomial.
Note
that
(for
k
â‰¥
1)
m
Â·
k
2
+
|iÏ‡
|
Â·
k
>
m
Â·
k
2
âˆ’
|iÏ‡
|
Â·
k
>
m
Â·
(k
âˆ’
1)2
+
|iÏ‡
|
Â·
(k
âˆ’
1)
(Indeed,
the
second
inequality
follows
from
the
fact
that
2mk
=
m
+
m
Â·
(2k
âˆ’
1)
>
m
+
|iÏ‡
|
Â·
(2k
âˆ’
1).)
In
other
words,
the
exponent
of
q
induces
a
total
ordering
on
the
set
of
Ï‡L
-special
monomials.
The
ï¬rst
2k
monomials
are
given
by
applying
ket
(for
integers
168
k
such
that
either
|k
|
<
k
or
|k
|
=
k,
k
Â·
iÏ‡
<
0)
to
the
original
monomial,
while
the
ï¬rst
1
+
2k
monomials
are
given
by
applying
ket
(for
integers
k
such
that
|k
|
â‰¤
k)
to
the
original
monomial.
Thus,
we
have
c1
=
0
and,
for
k
â‰¥
1,
c2k
=
1
Â·
(m
Â·
k
2
âˆ’
|iÏ‡
|
Â·
k);
n
c2k+1
=
1
Â·
(m
Â·
k
2
+
|iÏ‡
|
Â·
k)
n
Moreover,
C1
=
âˆ…;
the
set
C2k
is
given
by
{ket
(M
)}0â‰¤|k
|<k
while
the
set
C2k+1
is
given
by
{ket
(M
)}0â‰¤|k
|<k

{ket
(M
)}|k
|=k,
k
Â·iÏ‡
<0
This
completes
the
computation
of
Cj
and
cj
.
Lemma
4.2.
For
any
choice
of
character
Ï‡L
âˆˆ
Hom(Î n
,
(Î¼n
)S
),
we
have:
j

a=1
ca
=
1
j(j
2
âˆ’
1)
24
for
any
odd
integer
j
â‰¥
1.
Proof.
First,
we
observe
that
for
any
even
integer
a
=
2k
â‰¥
2,
we
have
ca
+
ca+1
=
k
2
.
Indeed,
in
the
cases
where
Ï‡L,Î¼
=
1
(i.e.,
Cases
II
and
III),
it
is
immediate
from
the
formulas
for
ca
and
ca+1
that
we
have
ca
+
ca+1
=
k
2
.
On
the
other
hand,
in
Case
I,
we
have
ca
+
ca+1
=
12
{k
2
+
k
+
(k
âˆ’
1)2
+
(k
âˆ’
1)}
=
k
2
,
as
asserted.
Thus,
if
we
let
def
j
=
12
(j
âˆ’
1),
then
we
have
j


ca
=
a=1
j

b=1
b2
=
1
1
1
j
(j
+
1)(2j
+
1)
=
(j
âˆ’
1)(j
+
1)j
=
j(j
2
âˆ’
1)
6
24
24
as
desired.

169
Note
that
in
the
above
analysis,
Cj
was
always
obtained
by
applying
various
ket
â€™s
to
certain
ï¬xed
monomials
M
,
M
which
were
the
unique
Ï‡L
-special
monomials
that
were
nonzero
modulo
q.
Let
us
write
(for
j
â‰¥
3
in
Case
I;
for
j
â‰¥
2
in
Cases
II,
III)
Max(Cj
)
(respectively,
Min(Cj
))
for
the
maximum
(respectively,
minimum)
integer
k
such
that
the
symbol
ket
(M
)
or
ket
(M
)
appears
in
the
lists
of
elements
of
Cj
that
were
given
in
Schola
4.1.
(Here,
by
â€œsymbol,â€
we
simply
mean
that
in
Case
I,
we
wish
to
distinguish
the
symbol
M
from
(âˆ’1)et
(M
).)
Note
that
Max(Cj
)
â‰¥
0
â‰¥
Min(Cj
)
Also,
let
us
write
def
Span(Cj
)
=
Max(Cj
)
âˆ’
Min(Cj
)
Thus,
in
Case
I,
we
have
(for
k
â‰¥
1)
Max(C2k+1
=
C2k+2
)
=
k
âˆ’
1;
Min(C2k+1
=
C2k+2
)
=
âˆ’(k
âˆ’
1)
Span(C2k+1
=
C2k+2
)
=
2k
âˆ’
2
In
Case
II,
we
have
(for
k
â‰¥
1)
Max(C2k
=
C2k+1
)
=
k
âˆ’
1;
Min(C2k
=
C2k+1
)
=
âˆ’(k
âˆ’
1)
Span(C2k
=
C2k+1
)
=
2k
âˆ’
2
In
Case
III,
we
have
(for
k
â‰¥
1)
Max(C2k
)
=
k
âˆ’
1;
Min(C2k
)
=
âˆ’(k
âˆ’
1);
Span(C2k
)
=
2k
âˆ’
2
and
Max(C2k+1
)
=
k
âˆ’
1
+
Max
;
Min(C2k+1
)
=
âˆ’(k
âˆ’
1)
âˆ’
Min
Span(C2k+1
)
=
2k
âˆ’
1
170
where
Max
+
Min
=
1,
and
Max
is
1
(respectively,
0)
if
iÏ‡
<
0
(respectively,
iÏ‡
>
0).
In
particular,
we
observe
that
if
Min(Cj
)
â‰¤
a
â‰¤
Max(Cj
),
then
aet
(M
)
âˆˆ
Cj
(in
all
Cases);
aet
(M
)
âˆˆ
Cj
(in
Case
I).
Now
let
a
be
an
integer
such
that
Min(Cj
)
â‰¤
a
â‰¤
Max(Cj
),
for
some
integer
j
such
that
Max(Cj
),
Min(Cj
)
are
deï¬ned.
Let
ket
(M
)
be
an
arbitrary
Ï‡L
-special
monomial
(so
k
may
be
any
integer).
Then
observe
that:
If
(âˆ’a)et
(ket
(M
))
=
(âˆ’a
+
k)et
(M
)
is
nonzero
modulo
q,
then
it
follows
that
ket
(M
)
âˆˆ
Cj
.
Indeed,
if
(âˆ’a)et
(ket
(M
))
is
nonzero
modulo
q,
then
(by
the
discussion
in
Schola
4.1)
we
deduce
that
(âˆ’a)et
(ket
(M
))
is
M
or
M
(in
Case
I);
(âˆ’a)et
(ket
(M
))
=
M
(in
Cases
II,
III).
Thus,
ket
(M
)
is
aet
(M
)
or
aet
(M
)
(in
Case
I);
ket
(M
)
=
aet
(M
)
(in
Cases
II,
III).
In
particular,
ket
(M
)
âˆˆ
Cj
,
as
desired.
This
observation
implies
the
following:
Lemma
4.3.
Let
j
be
an
integer
which
is
â‰¥
3
(in
Case
I);
â‰¥
2
(in
Cases
II,
III).
If
Ïˆ
is
any
topological
A-linear
combination
of
Ï‡L
-special
monomials
which
is
â‰¡
0
modulo
q
nÂ·cj
,
then
(âˆ’a)et
(Ïˆ)
is
â‰¡
0
modulo
q,
for
any
a
such
that
Min(Cj
)
â‰¤
a
â‰¤
Max(Cj
).
Proof.
Indeed,
such
a
Ïˆ
is
a
topological
A-linear
combination
of
ket
(M
)â€™s,
where
k
ranges
over
all
elements
of
Z.
If
ket
(M
)
âˆˆ
Cj
,
then
it
follows
from
the
above
observation
that
(âˆ’a)et
(ket
(M
))
â‰¡
0
modulo
q.
Thus,
the
only
terms
in
the
topological
A-linear
combination
of
ket
(M
)â€™s
that
might
yield
a
nonzero
contribution
to
(âˆ’a)et
(Ïˆ)
modulo
q
are
those
for
which
ket
(M
)
âˆˆ
Cj
.
But
since
Ïˆ
â‰¡
0
modulo
q
nÂ·cj
,
it
follows
(from
the
deï¬nition
of
the
set
Cj
!)
that
the
coeï¬ƒcients
of
those
terms
must
be
â‰¡
0
modulo
q.
Thus,
(âˆ’a)et
(Ïˆ)
â‰¡
0
modulo
q,
as
desired.
(Note
that
in
this
argument,
we
make
essential
use
of
the
fact
that
the
elements
of
the
set
{ket
(M
)}kâˆˆZ
are
(topologically)
linearly
independent
over
A
â€“
a
fact
which
follows
immediately
from
the
observation
that
the
exponents
of
U
which
appear
in
distinct
elements
of
this
set
are
distinct.)

def
Now
recall
the
operator
Î´
Ï‡
(i.e.,
given
by
Î´
Ï‡
(?)
=
{Ï‡(1et
)
Â·
1et
(?)}âˆ’
?,
where
here
we
def
take
Ï‡
=
Ï‡M
)
of
Chapter
IV,
Â§3.
Note
that
if,
for
instance,
Ïˆ
is
a
topological
A-linear
combination
of
Ï‡L
-special
monomials
which
is
zero
modulo
q
nÂ·cj
,
then
one
can
compute
Î´
Ï‡
(Ïˆ)
modulo
q
as
soon
as
one
knows
Ïˆ
and
1et
(Ïˆ)
modulo
q.
By
induction,
one
sees
easily
that
one
can
compute
the
b-th
iterate
of
this
operator
(Î´
Ï‡
)b
(Ïˆ)
(for
some
positive
integer
b)
modulo
q
as
soon
as
one
knows
Ïˆ,
1et
(Ïˆ),
.
.
.
,
bet
(Ïˆ)
modulo
q.
Thus,
Lemma
4.3
has
the
following
consequence/generalization:
Corollary
4.4.
Let
j
be
an
integer
which
is
â‰¥
3
(in
Case
I);
â‰¥
2
(in
Cases
II,
III).
If
Ïˆ
is
any
topological
A-linear
combination
of
Ï‡L
-special
monomials
which
is
â‰¡
0
modulo
q
nÂ·cj
,
then
171
(âˆ’a)et
((Î´
Ï‡
)b
(Ïˆ))
â‰¡
0
(modulo
q)
for
any
integers
a,
b
such
that
0
â‰¤
b
â‰¤
Span(Cj
),
b
+
Min(Cj
)
â‰¤
a
â‰¤
Max(Cj
).
Next,
let
us
recall
the
twisted
Schottky-Weierstrass
zeta
functions
Î¶iÏ‡
(of
Chapter
IV,
def
Theorem
3.1)
associated
to
the
character
Ï‡
=
Ï‡M
.
In
the
following
discussion,
we
shall
think
of
these
functions
as
sections
of
LâŠ—n
C
âˆ
(i.e.,
without
the
superscripted
Ï‡
â€“
contrary
to
S
the
notation
of
Chapter
IV,
Theorem
3.1)
on
which
Zet
Ã—
Î¼n
acts
via
Ï‡âˆ’1
.
Note
that
(by
Chapter
IV,
Theorem
3.1)
the
Î¶iÏ‡
are
all
topological
A-linear
combinations
of
Ï‡L
-special
monomials,
i.e.,
satisfy
the
assumptions
on
Ïˆ
in
Corollary
4.4.
Now
let
us
suppose
that
for
some
integer
r
â‰¥
0,
we
are
given
an
A-linear
combination
r

Î³i
Â·
Î¶iÏ‡
i=0
(where
the
Î³i
âˆˆ
A)
which
is
â‰¡
0
modulo
q
nÂ·cj
,
for
j
as
in
Corollary
4.4.
Let
Case
be
1
if
we
are
in
Case
I,
and
0
otherwise.
Suppose,
moreover,
that
for
some
s
â‰¤
Span(Cj
)
+
Case
,
we
have:
Î³s
â‰¡
0;
Î³i
â‰¡
0
modulo
q
for
all
i
>
s.
Then,
by
applying
Corollary
4.4
to
the
above
sum,
we
obtain
that
for
some
integer
a:
0
â‰¡
aet
r

i=0
Î³i
Â·
(Î´
)
Ï‡
sâˆ’Case
(Î¶iÏ‡
)
s

â‰¡
aet
Î³i
Â·
(Î´
Ï‡
)sâˆ’Case
(Î¶iÏ‡
)
modulo
q
i=sâˆ’Case
i.e.,
the
terms
such
that
i
>
s
vanish
modulo
q
because
of
the
assumptions
on
the
Î³i
;
the
terms
such
that
i
<
s
âˆ’
Case
vanish
because
(Î´
Ï‡
)sâˆ’Case
(Î¶iÏ‡
)
=
0
(by
the
formula
for
Î´
Ï‡
(Î¶iÏ‡
)
given
in
Chapter
IV,
Theorem
3.1)
for
such
i.
If
we
are
in
Cases
II
or
III,
then
since
(Î´
Ï‡
)s
(Î¶sÏ‡
)
=
Â±Î¶0Ï‡
,
and
Î´
Ï‡
(Î¶0Ï‡
)
=
Ï‡M
(1)
Â·
1et
(Î¶0Ï‡
)
âˆ’
Î¶0Ï‡
=
0,
we
obtain
that
0
â‰¡
Î³s
Â·
aet
(Î¶0Ï‡
)
=
Î³s
Â·
Ï‡M
(a)âˆ’1
Â·
Î¶0Ï‡
modulo
q
i.e.,
Î³s
â‰¡
0
modulo
q,
which
is
a
contradiction.
In
Case
I,
we
have
(Î´
Ï‡
)sâˆ’1
(Î¶sÏ‡
)
=
Â±Î¶1Ï‡
+Î³Â·Î¶0Ï‡
(for
some
Î³
âˆˆ
A),
(Î´
Ï‡
)s
(Î¶sÏ‡
)
=
Â±Î¶0Ï‡
,
so
we
obtain
that
0
â‰¡
Î³sâˆ’1
Â·
aet
(Â±Î¶1Ï‡
+
Î³
Â·
Î¶0Ï‡
)
Â±
Î³s
Â·
aet
(Î¶0Ï‡
)
modulo
q
172
(where
the
various
â€œÂ±â€™sâ€
which
appear
are
not
necessarily
â€œcoordinatedâ€).
Moreover,
aet
(Î¶1Ï‡
)
is
clearly
equal
to
a
root
of
unity
times
Î¶1Ï‡
plus
an
A-multiple
of
Î¶0Ï‡
,
while
aet
(Î¶0Ï‡
)
is
equal
to
a
root
of
unity
times
Î¶0Ï‡
.
On
the
other
hand,
by
Lemma
4.5
below,
we
know
that
in
Case
I,
Î¶0Ï‡
and
Î¶1Ï‡
are
O-linearly
independent
modulo
q.
Thus,
we
obtain
that
Î³sâˆ’1
and
Î³s
are
â‰¡
0
modulo
q,
which
is
again
a
contradiction.
Lemma
4.5.
In
Case
I,
the
reductions
modulo
q
of
Î¶0Ï‡
and
Î¶1Ï‡
are
linearly
independent
over
every
residue
ï¬eld
of
O.
Proof.
Write
Î¶0Ï‡
=
Ïƒ0
Â·
Î¸
m
,
Î¶1Ï‡
=
Ïƒ1
Â·
Î¸
m
.
Then
from
1et
(Î¸
m
)
=
q
m
Â·
U
n
Â·
Î¸
m
,
1et
(Î¶0Ï‡
)
=
Ï‡M
(1)âˆ’1
Â·
Î¶0Ï‡
,
we
obtain
that
if
we
set
def
1
Î¶Ï‡
=
2
+
U
âˆ‚Ïƒ0
Â·
n
Â·
Ïƒ0
âˆ‚U
then
1et
(Î¶
Ï‡
)
=
Î¶
Ï‡
âˆ’
1
(cf.
the
case
of
â€œclassical
Schottky-Weierstrass
zeta
function
Î¶â€
discussed
in
Chapter
III,
Â§5
â€“
especially
Theorem
5.6).
Note,
here,
that
the
operator
1
U
âˆ‚
2
+
n
Â·
âˆ‚U
is
integral
(even
at
primes
of
O
which
divide
2
or
n)
on
Ï‡L
-special
monomials
in
Case
I:
Indeed,
in
the
notation
of
Schola
4.1,
above,
this
operator
acts
on
ket
(M
)
by
multiplication
by
12
+
n1
Â·
(2mk
+
m)
=
k
+
1,
and
on
(âˆ’k)et
(M
)
by
multiplication
by
1
1
2
+
n
(âˆ’2mk
âˆ’
m)
=
âˆ’k.
In
other
words,
in
the
terminology
of
Chapter
IV,
Â§3,
â€œ(Ïƒ0
Â·Î¸
m
)Â·T
+(Ïƒ0
Â·Î¶
Ï‡
Â·Î¸
m
)â€
is
an
â€œextension
polynomial
on
which
Zet
Ã—Î¼n
acts
via
Ï‡M
.â€
Thus,
we
may
take
Î¶1Ï‡
=
Ïƒ0
Â·Î¶
Ï‡
Â·Î¸
m
.
On
the
other
hand,
Î¶0Ï‡
modulo
q
may
be
computed
as
in
the
proof
of
Chapter
IV,
Theorem
2.1,
to
be
equal
to
(an
AÃ—
-multiple
of)
(U
m
+
Î³
Â·
U
âˆ’m
)
Â·
Î¸
m
âˆ‚
(where
Î³
is
a
root
of
unity).
If
we
apply
the
operator
12
+
Un
Â·
âˆ‚U
to
the
coeï¬ƒcient
of
Î¸
m
in
this
expression,
we
obtain
U
m
Â·
Î¸m
Thus,
since
Î³
is
a
root
of
unity,
hence
âˆˆ
O
Ã—
,
we
obtain
that
these
two
expressions
are
linearly
independent
over
every
residue
ï¬eld
of
O,
as
desired.

Thus,
we
see
that
we
have
essentially
proven
the
following
result:
Theorem
4.6.
Let
Ï‡L
âˆˆ
Hom(Î n
,
(Î¼n
)S
)
be
a
character.
Let
j
â‰¥
2
be
an
integer.
Then
Ï‡
the
twisted
Schottky-Weierstrass
Î¶-functions
Î¶0Ï‡
,
.
.
.
,
Î¶jâˆ’1
(cf.
Chapter
IV,
Theorem
3.1)
def
associated
to
Ï‡
=
Ï‡M
satisfy
the
following:
173
Case
I:
Ï‡L,Î¼
=
1.
If
j
=
2,
then
the
reductions
modulo
q
of
Î¶0Ï‡
and
Î¶1Ï‡
def
are
linearly
independent
over
A/(q)
=
O.
If
j
â‰¥
3,
let
j0
=
2k
+
1
â‰¥
3
be
any
odd
integer
such
that
j
â‰¥
j0
â‰¥
3.
Let
def
Case
=
1.
def
Case
II:
Ï‡L,Î¼
=
Ï‡Î¸
|Î¼n
.
Let
j0
=
2k
â‰¥
2
be
any
even
integer
such
that
j
â‰¥
j0
â‰¥
2.
Let
def
Case
=
0.
Case
III:
Ï‡L,Î¼
2
=
1.
Let
j0
â‰¥
2
be
any
integer
such
that
j
â‰¥
j0
â‰¥
2.
Let
def
Case
=
0.
def
In
all
the
Cases,
let
B
=
A/(q
nÂ·cj0
).
Then
there
exists
a
B-submodule
R
âŠ†
B
j
â€“
i.e.,
a
submodule
of
relations
â€“
such
that:
(i)
jâˆ’1
i=0
Î³i
Â·
Î¶iÏ‡
â‰¡
0
modulo
q
nÂ·cj0
for
all
(Î³0
,
.
.
.
,
Î³jâˆ’1
)
âˆˆ
R;
(ii)
the
projection
R
â†’
B
jâˆ’j0
+1
onto
the
last
j
âˆ’
j0
+
1
factors
is
an
isomorphism.
Finally,
we
have:
(âˆ—)
Any
(Î³0
,
.
.
.
,
Î³jâˆ’1
)
âˆˆ
B
j
such
that
(Î³0
,
.
.
.
,
Î³jâˆ’1
)
âˆˆ
q
Â·
B
j
,
and
jâˆ’1
Ï‡
nÂ·cj0
has
at
least
one
i
â‰¥
Span(Cj0
)
+
i=0
Î³i
Â·
Î¶i
â‰¡
0
modulo
q
1
+
Case
=
j0
âˆ’
1
=
|Cj0
|
(i.e.,
the
cardinality
of
Cj0
)
such
that
Î³i
â‰¡
0
modulo
q.
In
fact,
this
statement
(âˆ—)
holds
â€œmodulo
pâ€
for
any
maximal
prime
p
of
O,
i.e.:
(âˆ—p
)
Any
(Î³0
,
.
.
.
,
Î³jâˆ’1
)
âˆˆ
B
j
such
that
(Î³0
,
.
.
.
,
Î³jâˆ’1
)
âˆˆ
(q,
p)
Â·
B
j
,
and
jâˆ’1
Ï‡
nÂ·cj0
,
p)
has
at
least
one
i
â‰¥
Span(Cj0
)
+
i=0
Î³i
Â·
Î¶i
â‰¡
0
modulo
(q
1
+
Case
=
j0
âˆ’
1
=
|Cj0
|
(i.e.,
the
cardinality
of
Cj0
)
such
that
Î³i
â‰¡
0
modulo
(q,
p).
Proof.
Indeed,
the
statement
(âˆ—)
was
precisely
what
we
proved
above;
its
â€œmodulo
pâ€
version
(âˆ—p
)
follows
by
precisely
the
same
argument.
When
j
=
2
in
Case
I,
Theorem
4.6
follows
from
Lemma
4.5.
Thus,
let
us
assume
that
we
are
in
Case
I
and
j
â‰¥
3,
or
that
we
are
in
Cases
II
or
III
and
j
â‰¥
2.
To
see
that
there
exists
a
B-submodule
R
in
each
Case
satisfying
properties
(i)
and
(ii),
let
us
ï¬rst
observe
that
the
map
174
(Î³0
,
.
.
.
,
Î³jâˆ’1
)
â†’
jâˆ’1

Î³i
Â·
Î¶iÏ‡
modulo
q
nÂ·cj0
i=0
deï¬nes
a
B-linear
morphism
Î
:
B
j
â†’
Bâˆ’linear
combinations
of
the
monomials
âˆˆ
Cj0
modulo
q
nÂ·cj0
Note
that
because
of
the
way
in
which
j0
was
chosen
in
each
of
the
three
cases
(and
because
of
the
way
in
which
we
deï¬ned
Cj0
)
it
follows
that
Cj0
has
cardinality
j0
âˆ’
1.
We
would
like
to
show
that
the
kernel
of
Î
is
isomorphic
(as
a
B-module)
to
B
jâˆ’j0
+1
(via
the
projection
of
(ii)).
Suppose
that
we
can
show
this
after
base-changing
from
O
to
an
arbitrary
residue
ï¬eld
of
O.
Then
it
will
follow
from
elementary
commutative
algebra
(by
thinking
about
ï¬nitely
generated
modules
over
the
principal
ideal
domain
O)
that
the
kernel
of
Î
is
abstractly
isomorphic
to
B
jâˆ’j0
+1
as
an
O-module;
moreover,
the
projection
of
(ii)
will
then
be
a
morphism
between
free
O-modules
of
the
same
rank
which
is
bijective
modulo
all
of
the
maximal
primes
of
O.
Thus,
it
will
follow
that
the
projection
of
(ii)
is
bijective
over
O,
hence
that
Ker(Î)
is
isomorphic
as
a
B-module
to
B
jâˆ’j0
+1
via
the
projection
of
(ii),
as
desired.
Thus,
it
suï¬ƒces
to
show
(i)
and
(ii)
after
base-changing
to
an
arbitrary
residue
ï¬eld
of
O.
Let
us
denote
the
objects
obtained
by
executing
this
base-change
by
means
of
a
j0
âˆ’1
.
subscript
â€œres.â€
Then
the
range
of
Îres
is
a
Bres
-module
which
is
a
quotient
of
Bres
In
particular,
it
follows
from
elementary
commutative
algebra
(since
Bres
is
a
quotient
j
that
of
the
principal
ideal
domain
Ares
)
that
there
exists
a
Bres
-submodule
Rres
âŠ†
Bres
jâˆ’j0
+1
âˆ¼
satisï¬es
(i)
and
which
is
=
Bres
.
The
fact
that
such
an
Rres
also
satisï¬es
(ii)
is
a
formal
consequence
of
(âˆ—p
).
This
completes
the
proof
of
the
â€œresâ€
case,
and
hence
of
the
entire
Theorem.

Remark.
From
a
certain
point
of
view,
Theorem
4.6
is
the
key
technical
result
behind
the
main
theorems
of
this
paper.
Corollary
4.7.
Let
Ï‡L
âˆˆ
Hom(Î n
,
(Î¼n
)S
)
be
a
character.
Let
j
â‰¥
2
be
an
integer.
Then
Ï‡
the
twisted
Schottky-Weierstrass
Î¶-functions
Î¶0Ï‡
,
.
.
.
,
Î¶jâˆ’1
(cf.
Chapter
IV,
Theorem
3.1)
satisfy
the
following
property:
Let
j
be
deï¬ned
as
follows:
Case
I:
Let
j
be
the
smallest
odd
integer
â‰¥
j
+
1.
Case
II:
Let
j
be
the
smallest
even
integer
â‰¥
j
+
1.
def
Case
III:
Let
j
=
j
+
1.
175
Let
p
be
a
maximal
prime
of
O.
Then
if
Î³0
,
.
.
.
,
Î³jâˆ’1
âˆˆ
A
are
such
that
jâˆ’1

Î³i
Â·
Î¶iÏ‡
â‰¡
0
modulo
q
nÂ·cj

(respectively,
modulo
(q
nÂ·cj

,
p))
i=0
then
all
of
the
Î³i
â€™s
are
â‰¡
0
modulo
q
(respectively,
modulo
(q,
p)).
Finally,
j
satisï¬es
the
property:
|Cj

|
=
j
âˆ’
1
â‰¤
j
+
1;
if
j
is
odd,
then
|Cj

|
is
=
j
+
1
(in
Case
I),
=
j
(in
Cases
II,
III);
if
j
is
even,
then
|Cj

|
is
=
j
+
1
(in
Case
II),
=
j
(in
Cases
I,
III).
Proof.
The
ï¬nal
statement
follows
immediately
from
the
deï¬nitions.
Thus,
let
us
prove
the
statement
concerning
linear
independence.
To
simplify
the
notation,
we
prove
the
result
in
the
â€œnon-respâ€™dâ€
case.
(The
proof
in
the
â€œrespâ€™dâ€
case
is
entirely
similar.)
First,
def
j
is
deï¬ned
as
â€œthe
smallest
j0
(as
in
Theorem
4.6)
which
is
â‰¥
j
+1.â€
Then
if
we
let
Î³i
=
0
for
i
â‰¥
j,
suppose
that
there
exists
some
Î³i
â‰¡
0
modulo
q,
and
apply
the
statement
(âˆ—)
of
Theorem
4.6,
we
obtain
that
there
exists
some
i
â‰¥
j
âˆ’
1
â‰¥
j
for
which
Î³i
â‰¡
0
modulo
q.
But
in
light
of
the
deï¬nition
of
the
Î³i
,
this
is
absurd.
This
contradiction
completes
the
proof.

Finally,
we
close
this
Â§
by
observing
that,
although
in
the
above
discussion,
we
took
an
abstract
point
of
view
with
respect
to
showing
the
existence
of
linear
combinations
of
the
Î¶iÏ‡
satisfying
certain
congruence
property
modulo
powers
of
q,
in
fact,
it
is
possible
to
give
an
explicit
description
of
the
linear
combinations
of
Î¶iÏ‡
â€™s
that
arise.
Indeed,
one
has
the
following
result:
Theorem
4.8.
(Congruence
Canonical
Schottky-Weierstrass
Zeta
Functions)
Ï‡
Let
ÏƒÏ‡
âˆˆ
Î“(C
âˆ
,
(LâŠ—n
C
âˆ
)
)
be
as
in
Chapter
IV,
Â§3.
Let
iÏ‡
âˆˆ
{âˆ’m,
âˆ’m
+
1,
.
.
.
,
m
âˆ’
1}
be
S
S
as
in
Chapter
IV,
Theorem
3.3.
(Note
that
this
notation
is
consistent
with
the
notation
of
the
present
Â§
for
Case
III.)
Then,
up
to
an
AÃ—
-multiple,
ÏƒÏ‡
is
equal
to
the
series

q
mÂ·k
+iÏ‡
Â·k
Â·
U
2mk+iÏ‡
Â·
Î¸
m
Â·
Ï‡(ket
)
=
2
kâˆˆZ

ket
(U
iÏ‡
Â·
Î¸
m
)
Â·
Ï‡(ket
)
kâˆˆZ
def
i
Ï‡
Now
if
r
is
a
nonnegative
integer,
let
Lr
(T
)
=
T
+
Î»r
âˆ’
2m
,
where
Î»r
âˆˆ
Z
is
deï¬ned
as
follows:
def
Î»r
=
r
2
+
iÏ‡

2m
i.e.,
the
greatest
integer
â‰¤
the
number
in
brackets.
Then
if
we
set
Î¶0CG
to
be
equal
to
the
above
series,
and
176
def
Î¶rCG
=



k
+
Î»r

2
Lr
(Î´
âˆ—
)
CG
(Î¶0
)
=
Â·
q
mÂ·k
+iÏ‡
Â·k
Â·
U
2mk+iÏ‡
Â·
Î¸
m
Â·
Ï‡(ket
)
r
r
kâˆˆZ
def
Î¶rCG
[T
]
=


r

Lr
(Î´
âˆ—
+
T
)
CG
Î¶iCG
Â·
T
[râˆ’i]
(Î¶0
)
=
r
i=0
(where
Î´
âˆ—
,
T
are
as
in
Chapter
IV,
Theorem
3.3),
then
for
any
positive
integer
j,
we
have
CG
â‰¡
0
modulo
q
nÂ·cj0
Î¶jâˆ’1
(where
j0
is
as
in
Theorem
4.6).
Finally,
the
Î¶rCG
are
integral
over
Z,
and
form
a
collection
of
twisted
higher
Schottky-Weierstrass
zeta
functions
as
in
Chapter
IV,
Theorem
3.1.
Proof.
Note
that
the
series
given
for
(an
AÃ—
-multiple
of)
ÏƒÏ‡
is
Zet
-invariant.
On
the
other
Ï‡
hand,
since
the
set
of
Zet
-invariant
elements
of
Î“(C
âˆ
,
(LâŠ—n
C
âˆ
)
)
forms
a
free
A-module
of
S
Ã—
S
rank
1,
it
follows
immediately
that
ÏƒÏ‡
is
an
A
-multiple
of
this
series.
The
explicit
series
iÏ‡
)
will
always
be
formula
for
Î¶rCG
then
follows
immediately.
In
particular,
since
Lr
(k
+
2m
âˆˆ
Z,
it
follows
immediately
that
Î¶rCG
is
integral
over
Z.
Since
Î´
âˆ—
+
T
is
Zet
-invariant,
it
follows
immediately
that
the
Î¶rCG
form
a
collection
of
twisted
higher
Schottky-Weierstrass
zeta
functions
as
in
Chapter
IV,
Theorem
3.1.
In
fact,
one
can
even
write
the
Î¶rCG
as
explicit
linear
combinations
of
the
Î¶iBI,Ï‡
â€™s
(of
Chapter
IV,
Theorem
3.3)
by
using
Chapter
III,
Lemma
7.5.
CG
Thus,
it
remains
only
to
show
that
Î¶jâˆ’1
has
the
desired
congruence
property.
The
point
here
is
to
observe
that
if
we
deï¬ne
a
ï¬ltration
F
r
(Z)
(for
r
â‰¥
0
an
integer)
on
Z
by:
def
F
r
(Z)
=
{0
âˆ’
Î»r
,
1
âˆ’
Î»r
,
.
.
.
,
r
âˆ’
1
âˆ’
Î»r
}
then
F
r+1
(Z)
is
obtained
from
F
r
(Z)
by
appending
one
more
integer
â€œk[r]â€
directly
to
the
left/right
of
F
r
(Z)
(where
â€œleft/rightâ€
depends
only
on
the
parity
of
r),
and,
moreover,
the
exponent
of
q
in
the
Ï‡L
-special
monomial
corresponding
to
this
â€œk[r]â€
is
â‰¥
the
exponents
of
q
in
the
Ï‡L
-special
monomial
corresponding
to
the
integers
â€œkâ€
in
F
r
(Z).
In
particular,
it
follows
that
for
each
of
the
Ï‡L
-special
monomials
q
mÂ·k
+iÏ‡
Â·k
Â·
U
2mk+iÏ‡
Â·
Î¸
m
2
iÏ‡


iÏ‡
(k+
2m
)
=
0.
belonging
to
Cj0
,
Ljâˆ’1
(k
+
2m
)
is
a
nonnegative
integer
â‰¤
j
âˆ’
2.
Thus,
Ljâˆ’1jâˆ’1
CG
That
is
to
say,
the
coeï¬ƒcients
(in
the
series
deï¬ning
Î¶jâˆ’1
)
of
all
the
Ï‡L
-special
monomials
in
Cj0
are
zero.
This
proves
the
desired
congruence
property.

177
Â§5.
The
Determinant
of
the
Evaluation
Map
In
this
Â§,
we
prepare
for
the
discussion
of
the
following
Â§
by
showing
that
(at
least
if
the
base
is
an
algebraically
closed
ï¬eld,
and
the
elliptic
curve
in
question
is
â€œsuï¬ƒciently
generic,â€
then)
the
determinants
of
the
evaluation
maps
of
Propositions
2.2,
2.3,
have
a
particularly
simple
form,
so
long
as
they
are
not
identically
zero
(Theorem
5.6).
Here,
we
use
the
notation
of
Â§2,
except
that
we
also
assume
(unless
speciï¬ed
otherwise)
that
S
=
Spec(k),
where
k
is
an
algebraically
closed
ï¬eld.
Remark.
In
fact,
logically
speaking,
we
shall
only
use
the
theory
of
this
Â§
in
the
case
where
char(k)
=
0.
Thus,
the
reader
who
is
only
interested
in
material
that
is
logically
necessary
for
the
proofs
of
the
main
theorems
of
this
paper
may
assume
in
this
Â§
that
char(k)
=
0.
In
particular,
in
this
Â§,
E
â†’
S
will
be
a
(proper!)
elliptic
curve,
and
S
=
Sâˆ
.
Thus,
since
we
do
not
have
to
deal
with
log
structures,
metrized
line
bundles,
etc.,
the
discussion
of
Â§2
simpliï¬es
substantially.
Also,
in
this
Â§,
we
will
assume
that
L
=
L
=
OE
(d
Â·
[e])
and
that
we
are
given
a
symmetric
Lagrangian
subgroup
H
âŠ†
GL
i.e.,
a
Lagrangian
subgroup
which
is
mapped
to
itself
under
the
automorphism
of
GL
induced
by
the
automorphism
(âˆ’1)
:
E
â†’
E
(â€œmultiplication
by
âˆ’1â€)
of
E.
Also,
we
assume
that
H
is
of
multiplicative
type,
i.e.,
that
H
is
eÌtale
locally
isomorphic
to
Î¼d
.
Since,
however,
k
is
algebraically
closed,
this
implies
that
H
âˆ¼
=
Î¼d
.
Let
us
ï¬x
an
identiï¬cation:
H
=
KH
=
Î¼d
Then
âˆ¼
d
EH
=
d
E/KH
=
H
âˆ—
=
Z/dZ
(where
the
â€œâˆ—â€
denotes
the
Cartier
dual).
In
particular,
under
these
assumptions,
if
char(k)
=
p
>
0,
then
it
follows
that
E
is
an
ordinary
elliptic
curve
(i.e.,
its
Hasse
invariant
is
nonzero).
Conversely,
if
char(k)
=
0
or
E
is
ordinary,
then
I
claim
that
there
exists
a
symmetric
Lagrangian
subgroup
H
âŠ†
GL
of
multiplicative
type.
Indeed,
by
the
discussion
preceding
Chapter
IV,
Deï¬nition
1.3,
it
follows
that
the
existence
of
such
an
H
amounts
to
the
issue
of
whether
or
not
a
certain
exact
sequence
Z-modules
(character
groups)
178
0
â†’
Z/dZ
â†’??
â†’
Z
â†’
0
equipped
with
a
Z/2Z
=
{Â±1}-action
splits.
If
d
is
odd,
then
the
existence
of
such
a
splitting
follows
from
the
fact
that
H
1
(Z/2Z,
Z/dZ)
=
0.
If
d
is
even,
and
k
is
of
characteristic
0,
the
existence
of
such
a
splitting
follows
from
â€œthe
existence
of
a
symmetric
Î¸-structure
on
a
totally
symmetric
ample
line
bundleâ€
[Mumf1],
Remark
2,
p.
318.
If
d
is
even,
and
k
is
of
positive
characteristic,
then
the
existence
of
such
a
splitting
follows
from
the
fact
that
the
relevant
class
in
H
1
(Z/2Z,
Z/dZ)
is
locally
constant,
hence
may
be
computed
after
lifting
the
elliptic
curve
in
question
to
characteristic
0.
This
completes
the
veriï¬cation
of
the
claim.
Thus,
other
than
the
condition
that
E
be
ordinary
if
char(k)
>
0,
the
assumption
of
the
existence
of
an
H
as
above
does
not
result
in
any
loss
of
generality.
The
Lagrangian
subgroup
H
âŠ†
GL
deï¬nes
a
line
bundle
LH
on
EH
=
E/KH
which
descends
L.
Since
L
and
H
âŠ†
GL
are
symmetric,
it
follows
that
LH
is
also
symmetric.
Since
LH
is
of
degree
1,
it
thus
follows
that
LH
âˆ¼
=
OEH
(
H
)
for
some
unique
H
âˆˆ
EH
(k),
which
satisï¬es
2
Â·
H
=
0.
If
G
is
a
ï¬nite,
ï¬‚at
subgroup
scheme
of
E
or
EH
,
let
us
write
[G]
for
the
divisor
in
E
or
EH
deï¬ned
by
G.
We
will
also
use
this
notation
for
translates
of
G.
Before
continuing
our
discussion,
we
need
certain
basic
facts
concerning
the
various
line
bundles
that
appear:
Lemma
5.1.
We
have:
[KH
]
âˆ¼
(d
âˆ’
1)
Â·
[e]
+
[Î´]
where
â€œâˆ¼â€
denotes
linear
equivalence
of
divisors
on
E;
Î´
=
e
if
d
is
odd;
and
Î´
=
(
12
)Î¼
âˆˆ
KH
(k)
âŠ†
E(k),
i.e.,
the
unique
generator
of
the
subgroup
Î¼2
(k)
âŠ†
Î¼d
(k)
=
KH
(k),
if
d
is
even.
Proof.
Indeed,
this
sort
of
equality
may
be
proven
by
lifting
to
characteristic
0.
Thus,
for
the
rest
of
the
proof,
we
assume
that
char(k)
=
0.
Then
KH
is
eÌtale
over
k,
so
[KH
]
=

[Î±]
Î±âˆˆKH
(k)
If
Î±
âˆˆ
KH
(k)
is
such
that
Î±
=
âˆ’Î±,
then
both
[Î±]
and
[âˆ’Î±]
appear
in
the
sum,
and
[Î±]
+
[âˆ’Î±]
âˆ¼
2[e].
Moreover,
the
only
[Î±]â€™s
such
that
Î±
=
âˆ’Î±
are
[e]
and
[Î´].
Substituting
these
two
observations
into
the
above
sum
thus
yields
the
result.

179
Lemma
5.2.
We
have:
even
and
char(k)
=
2;
and
char(k)
=
2.
(the
origin
of
EH
)
if
d
is
odd;
H
âˆˆ
d
EH
(k)
if
d
is
âˆˆ
E
(k)\
H
H
d
EH
(k)
is
of
order
precisely
2
if
d
is
even
and
H
=
eH
Proof.
Suppose
ï¬rst
that
d
is
odd.
Then
since
the
line
bundle
L
=
OE
(d
Â·
[e])
is
not
ï¬xed
by
translation
by
any
point
of
E(k)
of
order
precisely
2,
and,
moreover,
the
points
of
order
2
of
E(k)
are
in
bijective
correspondence
with
the
points
of
order
2
of
EH
(k),
the
fact
that
âˆ¼
H
=
eH
follows
from
the
fact
that
L
=
OE
([KH
])
(cf.
Lemma
5.1).
Now
suppose
that
d
is
even
and
char(k)
=
2.
In
this
case,
Z/2Z
âŠ†
Z/dZ
âˆ¼
=
d
EH
(k)
is
equal
to
the
entire
set
of
points
in
EH
(k)
annihilated
by
2.
Thus,
H
âˆˆ
d
EH
(k).
Finally,
suppose
that
d
is
even
and
char(k)
=
2.
Since
we
know
that
2
Â·
H
=
0,
it
follows
that
it
suï¬ƒces
to
prove
that
H
âˆˆ
d
EH
(k).
Next,
observe
that
since
there
exists
an
isomorphism
d
E
âˆ¼
=
H
Ã—
H
âˆ—
such
that
the
projection
to
the
factor
H
âˆ—
coincides
with
the
morphism
d
E
â†’
d
EH
âˆ¼
=
H
âˆ—
,
it
follows
that
there
exists
an
element
âˆˆ
E(k)
whose
order
is
precisely
2
and
which
maps
to
the
nonzero
element
of
Z/2Z
âŠ†
Z/dZ
âˆ¼
=
d
EH
(k)
âŠ†
EH
(k).

L,
so
On
the
other
hand,
by
Lemma
5.1,
we
have
OE
([KH
])
=
(d
âˆ’
1)
Â·
[e]
+
[(
12
)Î¼
]
âˆ¼
=
âˆ—
âˆ¼
H
=
eH
.
Since
T
(L)
=
L
(here
we
use
the
fact
that
d
is
even),
it
thus
follows
that

OE
([
+
KH
])
âˆ¼

L,
which
implies
that
H
is
not
equal
to
the
image
of
in
EH
(k).
Thus,
=
we
conclude
that
H
âˆˆ
d
EH
(k),
as
desired.

Corollary
5.3.
Suppose
that
d
is
odd,
or
that
d
is
even
and
char(k)
=
2.
Then
[
H
+
d
EH
]
=
[d
EH
]
(an
equality,
not
just
a
linear
equivalence,
of
divisors
on
EH
).
def
Let
us
write
M
=
OEH
([
H
+
d
EH
]).
Note
that
there
is
an
evident
action
of
d
EH
on
M
(resulting
from
the
fact
that
d
EH
stabilizes
the
divisor
[
H
+
d
EH
]).
If
one
descends
to
M
to
E
=
EH
/d
EH
via
this
action,
then
the
resulting
line
bundle
on
E
is
simply
OEH
([
])
where
âˆˆ
E(k)
is
the
image
of
H.
Lemma
5.4.
Suppose
that
d
is
even,
and
char(k)
=
2.
Let
LÏ‡
be
the
line
bundle
on
E
=
EH
/d
EH
given
by
descending
the
line
bundle
M
relative
to
the
action
of
d
EH
âˆ¼
=
Z/dZ
on
M
given
by
twisting
the
evident
action
by
the
unique
nontrivial
character
Ï‡
:
d
EH
âˆ¼
=
Ï‡
âˆ¼
Z/dZ
â†’
Î¼2
=
{Â±1}
of
order
2.
Then
L
=
OE
(e).
Proof.
Clearly,
deg(LÏ‡
)
=
1.
Since
2
Â·
H
=
0,
and
Ï‡âŠ—2
=
1,
it
follows
that
LÏ‡
is
symmetric.
Thus,
LÏ‡
âˆ¼
=
OE
(
Ï‡
),
for
some
unique
Ï‡
âˆˆ
E(k),
which
is
necessarily
of
order
2.
As
observed
above,
if
one
descends
M
via
the
evident
action
of
d
EH
on
M,
one
gets
OEH
([
]),
where
âˆˆ
E(k)
is
the
image
of
H
.
Moreover,
=
(
12
)Î¼
(by
Lemma
5.2).
Since
180
the
kernel
of
the
morphism
Pic0
(E)
â†’
Pic0
(EH
)
induced
by
EH
â†’
E
=
EH
/d
EH
has
a
unique
element
of
order
precisely
2,
it
follows
that
Ï‡
is
the
unique
element
of
E(k)
of
order
â‰¤
2
such
that
Ï‡
=
,
OE
(
Ï‡
)|EH
âˆ¼
=M
=
M.
But
observe
that
OE
(e)|EH
=
OEH
([d
EH
])
âˆ¼
(where
the
last
isomorphism
follows
from
the
fact
that
M
is
of
even
degree,
hence
ï¬xed
by
translation
by
H
,
which
is
order
2).
Thus,
we
conclude
that
Ï‡
=
e,
as
desired.

Corollary
5.5.
Suppose
that
0
=
s
âˆˆ
Î“(EH
,
M)
has
the
following
property
with
respect
to
the
evident
action
of
d
EH
on
M:
s
is
ï¬xed
by
this
action
if
d
is
odd,
or
if
d
is
even
and
char(k)
=
2;
d
EH
acts
on
s
by
the
character
Ï‡
(of
Lemma
5.4)
if
d
is
even
and
char(k)
=
2.
Then
the
inverse
image
in
E
via
E
â†’
EH
=
E/KH
of
the
zero
locus
V
(s)
of
s
is
equal
to
the
divisor
[d
E].
Proof.
Indeed,
if
d
is
odd,
or
if
d
is
even
and
char(k)
=
2,
then
s
descends
to
a
nonzero
section
s
âˆˆ
Î“(EH
,
OE
(
)).
Since
OE
(
)
is
of
degree
1,
V
(s
)
=
[
].
Thus,
V
(s)
=
[
H
+
d
EH
]
=
[d
EH
]
(by
Corollary
5.3),
so
the
inverse
image
in
E
of
V
(s)
is
[d
E],
as
desired.
If
d
is
even
and
char(k)
=
2,
then
(by
Lemma
5.4)
s
descends
to
a
nonzero
section
s
âˆˆ
Î“(EH
,
OE
(e)).
Since
OE
(e)
is
of
degree
1,
V
(s
)
=
[e],
so
the
inverse
image
in
E
of
V
(s)
is
[d
E],
as
desired.

Now
we
are
ready
to
return
to
our
discussion
of
the
evaluation
maps
of
Â§2.
In
the
present
discussion,
we
shall
omit
the
symbol
â€œâˆâ€
from
the
various
notations
of
Â§2,
since
here,
S
=
Sâˆ
,
E
=
Eâˆ
,
etc.
We
would
like
to
consider
the
morphism
ÎH
L,d,Î±
of
Proposition
2.3,
for
a
point
Î±
âˆˆ
E
â€ 
(k).
Write
def
â€ 
V
=
Î“(EH,[d]
,
LH
|
â€ 
)<d
EH,[d]
Also,
let
us
denote
the
elements
of
d
EH
=
Z/dZ
by
(
di
)H
,
for
i
=
0,
.
.
.
,
d
âˆ’
1.
Then
the
morphism
of
Proposition
2.3
becomes
ÎH
Î±
:V
â†’
dâˆ’1

i=0
i
OEH
([
H
+
(
)H
])|Î±
d
(where
we
identify
LH
with
OEH
([
H
])).
â€ 
Now
let
Î²
âˆˆ
d
EH
(k)
âˆ¼
=
d
EH
(k).
We
would
like
to
consider
the
relationship
between
H
H
ÎÎ±
and
ÎÎ±+Î²
.
Note
that
both
maps
involve
restricting
sections
âˆˆ
V
to
the
same
points
â€ 
inside
EH,[d]
,
except
in
a
diï¬€erent
order.
Thus,
one
may
think
of
ÎH
Î±+Î²
as
the
result
of
H
composing
ÎÎ±
with
the
permutation
of
the
summands
in
the
direct
sum
on
the
right
(which
are
indexed
by
i
=
0,
.
.
.
,
d
âˆ’
1)
by
the
permutation
i
â†’
i
+
iÎ²
modulo
d
(where
181
i
(
dÎ²
)H
âˆˆ
d
EH
(k)
is
the
element
deï¬ned
by
Î²).
Thus,
if
one
takes
determinants,
one
obtains
that
the
determinant
âˆ’1
det(ÎH
âŠ—k
OEH
([
H
+
d
EH
])|Î±
Î±+Î²
)
âˆˆ
det(V
)
is
equal
to
âˆ’1
(âˆ’1)sgn(Î²)
Â·
det(ÎH
âŠ—k
OEH
([
H
+
d
EH
])|Î±
Î±
)
âˆˆ
det(V
)
where
sgn(Î²)
is
the
sign
of
the
permutation
i
â†’
i
+
iÎ²
modulo
d.
Note
that
if
d
is
odd,
or
if
d
is
even
and
char(k)
=
2,
then
(âˆ’1)sgn(Î²)
is
always
1.
If
d
is
even
and
char(k)
=
2,
then
(âˆ’1)sgn(Î²)
=
Ï‡(Î²),
where
Ï‡
is
the
character
of
Lemma
5.4.
Thus,
if
one
lets
Î±
be
the
tautological
point
âˆˆ
E
â€ 
(E
â€ 
),
one
gets
a
section
âˆ’1
det(ÎH
âŠ—k
Î“(E
â€ 
,
OEH
([
H
+
d
EH
])|Î±
)
Î±
)
âˆˆ
det(V
)
which,
by
Lemma
2.4,
descends
to
E.
Moreover,
clearly
this
determinant
of
ÎH
Î±
only
depends
on
the
image
of
Î±
in
EH
.
Thus,
since
this
image
is
just
the
tautological
point
âˆˆ
EH
(EH
),
we
get
a
section
âˆ’1
âŠ—k
Î“(EH
,
OEH
([
H
+
d
EH
]))
=
det(V
)âˆ’1
âŠ—k
Î“(EH
,
M)
det(ÎH
Î±
)
âˆˆ
det(V
)
which,
by
the
above
discussion,
satisï¬es
the
hypotheses
of
Corollary
5.5
(as
soon
as
it
is
nonzero).
In
other
words,
we
see
that
the
zero
locus
of
det(ÎH
Î±
)
on
E
is
equal
either
to
all
of
E
or
to
[d
E].
That
is
to
say,
we
have
proven
the
following:
Theorem
5.6.
Let
E
be
an
elliptic
curve
over
an
algebraically
closed
ï¬eld
k.
Suppose
def
that
E
is
ordinary
if
char(k)
>
0.
Let
d
â‰¥
1
be
an
integer;
L
=
OE
(dÂ·[e]);
and
Î±
âˆˆ
E
â€ 
(k).
Then
if
the
morphism
â€ 
ÎL,d,Î±
:
Î“(E[d]
,
L|
â€ 
)<d
â†’
L|
âˆ—
E[d]
TÎ±
(d
E
â€ 
)
is
an
isomorphism
for
any
single
Î±
âˆˆ
E
â€ 
(k),
then
it
follows
that
it
is
an
isomorphism
for
all
Î±
âˆˆ
E
â€ 
(k)
except
for
those
which
map
to
d
E(k)
âŠ†
E(k).
Moreover,
if
this
morphism
is
an
isomorphism
for
any
single
Î±
âˆˆ
E
â€ 
(k),
then
the
scheme-theoretic
zero
locus
of
the
determinant
of
this
morphism
in
the
case
where
Î±
is
the
tautological
point
âˆˆ
E
â€ 
(E
â€ 
)
is
precisely
d
times
the
divisor
E
â€ 
Ã—E
(d
E)
âŠ†
E
â€ 
.
Finally,
the
same
(except
with
â€œd
timesâ€
in
the
preceding
sentence
deleted)
assertions
hold
for
the
morphism
182
â€ 
ÎH
L,d,Î±
:
Î“(EH,[d]
,
LH
|
â€ 
EH,[d]
)<d
â†’
LH
|
â€ 
TÎ±âˆ—
(d
EH
)
where
H
âŠ†
GL
is
any
Lagrangian
subgroup
(cf.
Chapter
IV,
Deï¬nition
1.3).
Proof.
It
remains
only
to
note
that,
in
the
statement
of
Theorem
5.6,
it
is
not
necessary
to
assume
that
the
Lagrangian
subgroup
is
symmetric
or
of
multiplicative
type.
Indeed,
the
assertions
in
the
statement
of
Theorem
5.6
concerning
the
Lagrangian
subgroup
follow
immediately
from
the
general
theory
of
Â§2,
especially
Proposition
2.3;
Chapter
IV,
Theorem
1.4.
Note
that
we
need
the
â€œd
timesâ€
in
the
â€œnon-Lagrangian
caseâ€
because
the
matrices
appearing
in
the
non-Lagrangian
case
amount
essentially
to
d
copies
(arranged
diagonally)
of
the
matrices
appearing
in
the
Lagrangian
case.
Thus,
the
determinants
must
be
raised
to
the
d-th
power.

Â§6.
The
Generic
Case
In
this
Â§,
we
give
an
explicit
computation
of
a
certain
evaluation
map
(i.e.,
a
map
like
that
deï¬ned
in
Â§2)
deï¬ned
for
certain
degenerating
elliptic
curves
in
mixed
characteristic.
In
particular,
we
will
show
that
the
determinant
of
this
map
is
nonzero
in
mixed
characteristic.
This
result,
combined
with
the
results
of
Â§5,
will
allow
us
to
conclude
the
generic
bijectivity
of
certain
evaluation
maps
in
mixed
characteristic.
Moreover,
this
sort
of
generic
bijectivity
result
will
be
the
crucial
technical
ingredient
in
the
proof
of
the
main
results
of
Chapter
VI.
In
this
Â§,
we
use
the
notation
of
the
ï¬rst
portion
of
Â§3,
i.e.,
the
discussion
of
the
degenerating
case
(preceding
the
â€œAnalytic
Continuation
Argumentâ€).
Let
N
â‰¥
1
be
an
integer
which
is
prime
to
d
and
invertible
in
the
base
ring
O
(a
Zariski
localization
of
the
ring
of
integers
of
a
number
ï¬eld).
Let
p
be
a
prime
number
that
appears
as
the
characteristic
of
a
residue
ï¬eld
of
O.
We
would
like
to
concentrate
our
attention,
in
this
Â§,
on
integral
structures
at
the
prime
p.
Let
def
1
AN
=
O[[q
N
Â·d
]];
def
1
SN
=
Spec(O[[q
N
Â·d
]])
=
Spec(AN
)
Thus,
we
have
a
natural
ï¬nite
morphism
SN
â†’
S,
which
we
regard
as
a
â€œbase
extensionâ€
of
the
base
S
=
Spec(O[[q]])
of
(the
ï¬rst
portion
of)
Â§3.
Note
that
if
one
thinks
of
E
as
def
being
â€œGm
/q
dÂ·Z
â€
then
q
d/N
âˆˆ
Gm
(USN
)
(where
USN
=
Spec(AN
[q
âˆ’1
])
(âŠ†
SN
))
deï¬nes
a
rational
point
Î·
âˆˆ
Cd
(SN
)
183
which,
relative
to
the
group
structure
on
Cd
over
US
,
is
annihilated
by
N
.
Similarly,
q
âˆˆ
Gm
(USN
)
deï¬nes
a
rational
point
Ï„
âˆˆ
Ed
(S)
âŠ†
Cd
(SN
)
which
is
a
torsion
point
of
order
d.
In
particular,
by
using
the
group
scheme
structure
on
Ed
(together
with
the
fact
that
the
action
of
Ed
on
itself
extends
to
an
action
of
Ed
on
Cd
),
we
may
also
form
the
points
Î·
Â·
Ï„
Î²
âˆˆ
Cd
(SN
)
(for
Î²
âˆˆ
Z).
(Here,
we
use
the
letter
â€œÎ²â€
so
that
our
notation
will
be
consistent
with
the
notation
in
the
discussion
of
d-torsion
points
in
Â§3.)
Note
that,
relative
to
the
theory
of
Chapter
IV,
Â§4,
the
point
of
the
â€œS1
â€
associated
to
E
deï¬ned
by
Ï„
(respectively,
Î·
Â·
Ï„
Î²
)
is
equal
to
d1
(respectively,
N1
+
Î²d
).
Next,
let
us
write
eE
âŠ†
E(S)
for
the
identity
element
of
the
group
scheme
E.
Write
d
def
L
=
OC
(eE
)
d
d
for
the
corresponding
line
bundle
on
Cd
.
Note
that
since
the
points
Î·
Â·
Ï„
Î²
do
not
intersect
eE
,
it
follows
that
the
restriction
of
the
line
bundle
L
to
any
of
these
points
Î·
Â·
Ï„
Î²
admits
d
a
natural
trivialization.
In
this
Â§,
we
would
like
to
consider
the
following
evaluation
map
(cf.
the
evaluation
maps
deï¬ned
in
Â§2):
ÎÎ·
:
Î“(Cd
,
L
âŠ—O
Cd
))
âŠ—OS
OSN
âˆ’â†’
F
d
(Retâ€ 
E
dâˆ’1

Î²=0
Cd
,[d]
(L|Î·Â·Ï„
Î²
)
=
dâˆ’1

O
SN
Î²=0
given
by
restriction.
Note
that
here,
to
deï¬ne
the
evaluation
map
ÎÎ·
,
we
use
the
facts
that
(i)
Retâ€ 
âŠ—Q
=
R
â€ 
âŠ—
Q;
(ii)
in
characteristic
zero,
the
torsion
points
Î·,
Ï„
âˆˆ
Cd
(SN
)
E
E
Cd
,[d]
Cd
,[d]
lift
naturally
to
torsion
points
of
E
structure
on
E
â€ 
Cd
,[d]
â€ 
Cd
,[d]
(SN
âŠ—
Q)
(where
â€œtorsionâ€
refers
to
the
group
|USN
).
This
much
gives
us
a
map
ÎÎ·
âŠ—
Q;
to
see
that
ÎÎ·
is,
in
fact,
deï¬ned
without
tensoring
with
Q,
we
need
an
integrality
statement
like
that
at
the
end
of
Theorem
3.1.
The
reason
we
cannot
apply
the
integrality
statement
at
the
end
of
Theorem
3.1
directly
is
that
instead
of
restricting
to
d-torsion
points
(i.e.,
Ï„
Î²
â€™s),
we
are
restricting
to
d-torsion
points
shifted
by
Î·.
This
is
not
a
problem,
however,
since,
just
as
in
the
proof
of
the
integrality
statement
at
the
end
of
Theorem
3.1,
we
see
that
it
suï¬ƒces
to
prove
that
the
â€œT
[n]
â€™sâ€
(notation
of
the
ï¬rst
part
of
Â§3)
take
on
integral
values
for
T
=
Nd
+
Î².
But
184
since
we
assumed
that
N
âˆˆ
O
Ã—
,
this
is
an
easy
exercise.
(For
instance,
it
may
be
proven
by
observing
that
it
suï¬ƒces
to
prove
it
locally
at
an
arbitrary
prime
number
l
not
dividing
N
;
but
then
Nd
may
be
l-adically
approximated
by
an
integer,
and
it
is
well-known
that
T
[n]
takes
integral
values
at
integers;
thus,
the
integrality
of
T
[n]
for
T
=
Nd
+
Î²
at
the
prime
l
follows
from
the
fact
that
Zl
is
l-adically
closed
in
Ql
.)
This
completes
the
deï¬nition
of
ÎÎ·
.
In
this
Â§,
we
would
like
to
study
the
extent
to
which
ÎÎ·
is
an
isomorphism.
To
do
this,
we
would
like
to
compute
the
determinant
of
ÎÎ·
.
To
compute
this
determinant
explicitly,
we
must
introduce
various
explicit
bases
of
the
domain
and
range
of
ÎÎ·
.
Note
that
the
range
of
ÎÎ·
already
has
a
natural
basis
(over
OSN
)
given
by
the
fact
that
it
is
naturally
a
direct
sum
of
copies
of
OSN
.
Next,
we
consider
the
domain
of
ÎÎ·
.
To
simplify
notation,
let
us
write
def
V
=
Î“(Cd
,
L
âŠ—O
Cd
F
d
(Retâ€ 
E
))
âŠ—OS
OSN
Cd
,[d]
Note
that
V
has
a
natural
ï¬ltration
F
n
(V
),
induced
by
the
ï¬ltration
on
Retâ€ 
(cf.
E
Cd
,[d]
Theorem
3.1).
For
0
â‰¤
n
â‰¤
d
âˆ’
1,
the
subquotient
(F
n+1
/F
n
)(V
)
is
a
(locally)
free
OSN
module
of
rank
1.
By
further
localizing
O,
we
may
assume
that
these
modules
are,
in
fact,
free,
hence
generated
(over
OSN
)
by
some
Ï†n
âˆˆ
F
n+1
(V
),
where
0
â‰¤
n
â‰¤
d
âˆ’
1.
Thus,
Ï†0
,
.
.
.
,
Ï†dâˆ’1
form
a
basis
of
V
over
OSN
.
Next,
let
us
recall
the
inï¬nite
eÌtale
covering
C
âˆ
â†’
C
âˆ
/(d
Â·
Zet
)
=
(Cd
)S
.
We
would
S
S
def
like
to
pull-back
the
various
sections
Ï†i
(for
i
=
0,
.
.
.
,
d
âˆ’
1)
over
(Cd
)SN
=
Cd
Ã—S
SN
to
def
C
âˆ
=
C
âˆ
Ã—S
SN
.
If
we
do
this,
then
it
follows
from
the
deï¬nition
of
the
â€œRet
â€
in
Â§3
SN
S
(and
Chapter
III,
Â§6)
that
we
can
write
Ï†i
=
i

Î¶i,j
Â·
T
[j]
j=0
where
Î¶i,j
âˆˆ
Î“(C
âˆ
,
L|C
âˆ
).
Note,
moreover,
that
for
each
i
=
0,
.
.
.
,
d
âˆ’
1,
the
section
Î¶i,i
SN
SN
descends
to
(Cd
)SN
(cf.
the
theory
of
Chapter
III,
Â§6).
Since
Ï†i
generates
(F
i+1
/F
i
)(V
),
and
restriction
of
sections
of
Î“((Cd
)SN
,
L(C
)
)
to
Î·
clearly
deï¬nes
an
isomorphism
d
SN
Î“((Cd
)SN
,
L(C
)
d
SN
185
)âˆ¼
=
O
SN
it
follows
that
Î¶i,i
(Î·)
âˆˆ
OSÃ—N
.
Thus,
by
replacing
Ï†i
by
an
appropriate
OSÃ—N
-multiple
of
Ï†i
,
we
may
assume
that
the
Ï†i
â€™s
have
been
normalized
so
that,
for
i
=
0,
.
.
.
,
d
âˆ’
1,
we
have
Î¶i,i
(Î·)
=
1
(cf.
the
theory
of
Chapter
III,
Â§6).
Now
we
are
ready
to
compute
the
determinant
of
ÎÎ·
.
Relative
to
the
bases
chosen
above,
this
amounts
to
computing
the
determinant
of
the
matrix
M
=
{Mi,Î²
}
where
i,
Î²
=
0,
.
.
.
,
d
âˆ’
1,
and
def
Î²
Mi,Î²
=
Ï†i
(Î·âˆ
Â·
Ï„âˆ
)=
i

Î²
Î¶i,j
(Î·âˆ
Â·
Ï„âˆ
)
Â·
(T
[j]
|T
=
d
+Î²
)
N
j=0
Here,
Î·âˆ
âˆˆ
C
âˆ
(SN
),
Ï„âˆ
âˆˆ
C
âˆ
(SN
)
are
the
points
deï¬ned
by
q
N
,
q
âˆˆ
Gm
(USN
),
respecd
SN
SN
tively,
by
thinking
of
C
âˆ
as
(the
q-adic
completion
of)
a
sort
of
NeÌron
model
for
Gm
over
SN
USN
(cf.
the
discussion
at
the
beginning
of
Chapter
III,
Â§5).
Thus,
Î·âˆ
,
Ï„âˆ
project
to
Î·,
Ï„
,
respectively.
We
would
like
to
show
that
the
determinant
in
question
is
invertible
as
a
section
of
1
OSN
.
Since
sections
of
OSN
are
invertible
if
and
only
if
they
are
invertible
modulo
q
N
,
1
it
thus
follows
that
it
suï¬ƒces
to
show
that
det(M)
is
invertible
modulo
q
N
.
Thus,
in
the
1
following
computations,
we
will
work
modulo
q
N
.
1
Î²
Next,
let
us
observe
that,
modulo
q
N
,
the
rational
points
Î·âˆ
Â·
Ï„âˆ
(for
Î²
=
0,
.
.
.
,
d
âˆ’
1)
âˆ
of
C
over
SN
all
lie
in
the
irreducible
components
of
the
special
ï¬ber
of
C
âˆ
labeled
SN
SN
1,
.
.
.
,
d
âˆ’
1
(cf.
the
discussion
at
the
beginning
of
Chapter
III,
Â§5).
Indeed,
these
d
âˆ’
1
irreducible
components
include
a
total
of
precisely
d
nodes,
and
it
is
these
d
nodes
which
1
Î²
(for
Î²
=
0,
.
.
.
,
d
âˆ’
1)
modulo
q
N
.
On
the
other
hand,
the
are
images
of
the
Î·âˆ
Â·
Ï„âˆ
restriction
of
the
line
bundle
L
to
the
union
of
these
d
âˆ’
1
irreducible
components
is
clearly
equal
to
the
trivial
bundle.
Let
us
write
U
for
the
union
of
these
d
âˆ’
1
components.
Then
U
is
a
chain
of
d
âˆ’
1
copies
of
P1
over
O.
In
particular,
U
is
reduced
and
connected,
so
it
follows
that
Î“(U
,
L|U
)
=
O
i.e.,
sections
of
L
are
constant
over
U
,
hence,
in
particular,
assume
the
same
values
at
the
Î²
points
Î·âˆ
Â·
Ï„âˆ
(for
Î²
=
0,
.
.
.
,
d
âˆ’
1)
that
we
are
interested
in.
1
Thus,
modulo
q
N
,
we
have:
186
Mi,Î²
â‰¡
i

Î¶i,j
(Î·âˆ
)
Â·
(T
[j]
|T
=
d
+Î²
)
N
j=0
Now
we
would
like
to
perform
various
elementary
row
operations
on
this
matrix.
Here,
we
think
of
the
matrix
entries
(i,
Î²)
where
i
is
ï¬xed
and
Î²
varies
as
a
row.
Thus,
we
will
speak
of
â€œthe
row
(i,
âˆ¼).â€
Note
ï¬rst
of
all
that
the
row
(0,
âˆ¼)
consists
of
1â€™s,
i.e.,
(0,
Î²)
â‰¡
Î¶0,0
(Î·âˆ
)
Â·
(T
[0]
|T
=
d
+Î²
)
=
1
N
1
(where
â€œâ‰¡â€
in
the
following
discussion
will
always
mean
â€œmodulo
q
N
â€).
Now
I
claim
that
by
performing
elementary
row
operations
on
the
matrix
M,
one
may
transform
this
matrix
1
(modulo
q
N
)
into
a
matrix
M
=
{Mi,Î²
},
where
Mi,Î²
â‰¡
Î¶i,i
(Î·âˆ
)
Â·
(T
[i]
|T
=
d
+Î²
)
=
T
[i]
|T
=
d
+Î²
N
N
Indeed,
we
prove
this
for
each
row
(i,
âˆ¼)
by
induction
on
i.
First
of
all,
it
is
clearly
already
true
for
i
=
0.
The
induction
step
is
then
proven
by
observing
that
the
diï¬€erence
between
the
original
row
(i,
âˆ¼)
of
M
and
the
row
(i,
âˆ¼)
of
M
is
â‰¡
iâˆ’1

Î¶i,j
(Î·âˆ
)
Â·
(T
[j]
|T
=
d
+Î²
)
N
j=0
i.e.,
the
â€œdiï¬€erence
rowâ€
may
be
thought
of
as
the
sum
(for
j
=
0,
.
.
.
,
i
âˆ’
1)
of
rows
of
the
form:
â€œthe
constant
Î¶i,j
(Î·âˆ
)
times
the
row
(j,
âˆ¼)
of
M
.â€
Since
for
j
<
i,
we
have
already
converted
the
row
(j,
âˆ¼)
of
M
into
the
row
(j,
âˆ¼)
of
M
by
means
of
elementary
row
operations
(by
the
induction
hypothesis),
we
thus
see
that
further
elementary
row
operations
will
allow
us
to
convert
the
row
(i,
âˆ¼)
of
M
into
the
row
(i,
âˆ¼)
of
M
,
as
desired.
This
completes
the
proof
of
the
claim.
Thus,
it
suï¬ƒces
to
prove
that
det(M
)
is
invertible.
Since
Mi,Î²
â‰¡
T
[i]
|T
=
d
+Î²
N
this
amounts
to
an
elementary
and
explicit
calculation.
Of
course,
one
may
perform
this
calculation
explicitly,
but
one
indirect
way
to
show
that
this
determinant
is
invertible
is
the
following:
It
suï¬ƒces
to
show
that
this
determinant
is
invertible
at
every
prime
l
that
does
not
divide
N
.
At
such
an
l,
Nd
may
be
l-adically
approximated
by
integers.
Moreover,
since
ZÃ—
l
is
an
l-adically
closed
subset
of
Ql
,
it
thus
suï¬ƒces
to
prove
that
the
determinant
is
invertible
when
Nd
is
replaced
by
an
arbitrary
I
âˆˆ
Z.
Thus,
it
suï¬ƒces
to
show
the
invertibility
of
the
matrix
M
[I]
=
{Mi,Î²
[I]},
where
187
Mi,Î²
[I]
=
T
[i]
|T
=I+Î²
But
now
let
us
note
that
by
repeated
application
of
the
relation
Î´(T
[i]
)
=
T
[iâˆ’1]
,
one
veriï¬es
easily
that
M
[I]
may
be
converted
into
M
[I
+
1]
by
means
of
elementary
row
operations.
In
particular,
det(M
[I])
is
independent
of
I,
so
it
suï¬ƒces
to
show
that
det(M
[0])
is
invertible.
But
Mi,Î²
[0]
=
T
[i]
|T
=Î²
is
0
if
Î²
<
i,
and
1
if
Î²
=
i.
That
is
to
say,
the
matrix
M
[0]
is
upper
triangular,
with
1â€™s
along
the
diagonal.
Thus,
det(M
[0])
=
1
as
desired.
In
other
words,
we
have
proven
the
following
result:
Lemma
6.1.
The
evaluation
map
ÎÎ·
:
Î“(Cd
,
L
âŠ—O
Cd
d
))
âŠ—OS
OSN
âˆ’â†’
et
F
(R
â€ 
E
dâˆ’1

Î²=0
Cd
,[d]
(L|Î·Â·Ï„
Î²
)
=
dâˆ’1

O
SN
Î²=0
is
an
isomorphism.
Now
we
would
like
to
consider
the
consequences
of
Lemma
6.1,
in
light
of
the
theory
of
Â§5.
To
do
this,
let
p
be
a
generic
point
of
SN
âŠ—
Fp
.
Write
def
W
=
Spec(OSN
,p
)
Thus,
W
is
a
trait,
i.e.,
the
spectrum
of
a
discrete
valuation
ring
(of
mixed
characteristic).
Let
us
write
pW
for
the
closed
point
of
W
.
In
the
following,
we
would
like
to
work
over
W
.
To
do
this,
we
ï¬rst
pull-back
the
various
objects
that
we
have
been
working
with
over
SN
to
W
.
Thus,
we
obtain
a
torsor
â€ 
EW,[d]
â†’
EW
together
with
a
line
bundle
LW
on
EW
,
and
a
d-torsion
point
Ï„W
âˆˆ
EW
(W
).
In
the
def
following
discussion,
we
will
often
wish
to
base-change
from
W
to
the
bases
X
=
EW
,
188
def
â€ 
Y
=
EW,[d]
.
When
we
wish
to
think
of
these
objects
not
as
group
schemes
over
W
,
but
â€ 
rather
as
base
extensions
of
W
,
we
will
use
the
notation
â€œX,â€
â€œY
â€
for
EW
,
EW,[d]
.
We
will
denote
the
result
of
base-changing
objects
over
W
(which
have
a
subscript
â€œW
â€)
to
objects
over
X
and
Y
by
means
of
a
subscript
X
or
Y
.
Finally,
let
us
write
Î´X
âˆˆ
EX
(X)
=
EW
(X);
def
Î´Y
=
Î´X
|Y
âˆˆ
EW
(Y
);
â€ 
â€ 
â€ 
Î´Y
âˆˆ
EY,[d]
(Y
)
=
EW,[d]
(Y
)
for
the
tautological
points
given
by
the
respective
identity
maps.
Next,
we
would
like
to
consider
the
following
evaluation
map
(where
the
requisite
integrality
follows
from
the
statement
at
the
end
of
Theorem
3.1):
ÎTX
:
def
VXT
=
Î“(EX
,
(TÎ´âˆ—X
LX
)
âŠ—O
d
EX
et
F
(R
â€ 
))
âˆ’â†’
EX,[d]
dâˆ’1

(TÎ´âˆ—X
LX
)|Ï„
Î²
X
Î²=0
(where
TÎ´X
:
EX
â†’
EX
is
the
morphism
given
by
translation
by
the
point
Î´X
âˆˆ
EX
(X))
of
locally
free
OX
-modules
of
rank
d.
Write
Î·W
for
the
pull-back
of
the
torsion
point
Î·
of
Ã—
Lemma
6.1
to
a
point
of
X(W
)
=
EW
(W
).
Note
that
since
N
âˆˆ
OW
,
and
Î·W
is
an
N
â€ 
â€ 
torsion
point,
it
follows
that
Î·W
lifts
naturally
to
a
unique
N
-torsion
point
Î·W
âˆˆ
EW,[d]
(W
)
(cf.
Chapter
III,
Corollary
5.9).
Moreover,
since
Nd
is
a
p-adic
integer,
translation
by
Nd
preserves
the
â€œT
[n]
â€
(over
SN
or
over
W
).
Thus,
we
see
that
the
morphism
T
â€ 
(translation
Î·W
â€ 
â€ 
by
Î·W
)
on
EW,[d]
induces
a
ï¬ltration-preserving
automorphism
T
âˆ—â€ 
[Ret
]
:
Retâ€ 
E
Î·
W
W,[d]
â†’
Retâ€ 
E
W,[d]
Thus,
we
get
an
isomorphism
T
âˆ—â€ 
[V
]
:
Î·W
Î“(EW
,
LW
âŠ—O
EW
F
d
(Retâ€ 
))
âˆ¼
=
Î“(EW
,
(TÎ·âˆ—W
LW
)
âŠ—O
EW
EW,[d]
F
d
(Retâ€ 
))
EW,[d]
But
now
observe
that
the
domain
of
T
âˆ—â€ 
[V
]
is
simply
VW
(i.e.,
the
pull-back
to
W
of
the
Î·W
âˆ—
OSN
-module
â€œV
â€
that
we
considered
earlier),
while
the
range
of
T
âˆ—â€ 
[V
]
is
Î·W
(VXT
),
i.e.,
the
restriction
of
the
OX
-module
VXT
Î·W
considered
above
to
the
point
Î·W
âˆˆ
X(W
).
Relative
189
to
these
observations,
we
thus
see
that
the
restriction
to
W
of
the
morphism
ÎÎ·
of
Lemma
6.1
may
be
thought
of
as:
âˆ—
ÎÎ·
|W
=
Î·W
(ÎTX
)
â—¦
T
âˆ—â€ 
[V
]
Î·W
In
particular,
it
follows
from
Lemma
6.1
that
det(ÎTX
)
(which
is
naturally
a
section
of
a
certain
line
bundle
on
the
scheme
X)
is
not
identically
zero
on
(the
irreducible
scheme)
X
âŠ—
(OW
/pW
).
In
other
words,
the
vanishing
locus
of
det(ÎTX
)
is
ï¬nite
and
ï¬‚at
over
W
,
hence
is
determined
by
its
restriction
to
the
generic
ï¬ber
of
X
=
EW
â†’
W
.
â€ 
Next,
we
would
like
to
work
over
the
base
Y
=
EW,[d]
.
Note
that
over
Y
,
translation
â€ 
by
Î´Y
deï¬nes
an
isomorphism
T
âˆ—â€ 
[V
]
:
Î“(EY
,
LY
âŠ—O
EY
Î´Y
F
d
(Retâ€ 
EY,[d]
))
âŠ—
Q
âˆ¼
=
Î“(EY
,
(TÎ´âˆ—Y
LY
)
âŠ—O
EY
F
d
(Retâ€ 
))
âŠ—
Q
EY,[d]
â€ 
Note
that
here,
we
must
tensor
with
Q
since
(one
may
easily
check
that)
Î´Y
does
not
preserve
the
â€œet-integral
structure
Ret
â€
of
Â§3.
Next,
let
us
consider
the
â€œcomposite
evaluation
mapâ€:
ÎTX
|Y
â—¦
T
âˆ—â€ 
[V
]
:
Î´Y
Î“(EY
,
LY
âŠ—O
EY
d
et
F
(R
â€ 
))
âŠ—
Q
âˆ’â†’
EY,[d]
dâˆ’1

(TÎ´âˆ—Y
LY
)|Ï„
Î²
âŠ—
Q
Î²=0
Y
Now,
sorting
through
the
notation,
one
sees
that
this
composite
evaluation
map
is
(up
to
translation
by
the
torsion
point
â€œ
H
â€
of
Â§5)
the
same
as
the
evaluation
map
denoted
â€œÎH
Î±
â€
in
Â§5.
Since
the
determinant
of
this
evaluation
map
is
not
identically
zero
(by
what
we
did
in
the
preceding
paragraph),
it
thus
follows
from
Theorem
5.6,
that
(if
we
denote
by
W
âˆˆ
EW
(W
)
=
X(W
)
the
point
denoted
by
â€œ
H
â€
in
Â§5),
we
thus
obtain
that
the
vanishing
locus
of
the
determinant
of
this
composite
evaluation
map
is
given
by
the
divisor
dâˆ’1
Î²
Î²=0
[
W
Â·
Ï„W
]
on
EW
âŠ—
Q.
Combining
this
with
what
we
did
in
the
preceding
paragraph,
we
thus
conclude
that:
The
vanishing
locus
of
det(ÎTX
)
is
given
by
the
divisor
dâˆ’1
Î²
Î²=0
[
W
Â·
Ï„W
]
on
X
=
EW
.
Now
recall
the
semi-abelian
scheme
E
â†’
S
considered
at
the
beginning
of
Â§3.
One
may
think
of
E
as
being
the
quotient
E
â†’
E
of
E
by
a
subgroup
scheme
of
E
which
is
naturally
isomorphic
to
Î¼d
.
Alternatively,
relative
to
Schottky
uniformizations,
one
may
190
think
of
the
isogeny
E
â†’
E
as
corresponding
to
the
morphism
Gm
/q
Z
â†’
Gm
/q
dÂ·Z
induced
by
the
morphism
â€œraising
to
the
d-th
powerâ€
on
Gm
.
If
we
pull-back
the
isogeny
E
â†’
E
to
W
,
we
get
an
isogeny
EW
â†’
EW
When
we
wish
to
think
of
EW
â†’
W
as
a
base
extension
of
W
,
we
will
denote
EW
by
def
Z
=
EW
,
and
write
Î³Z
âˆˆ
EW
(Z)
for
the
identity
morphism.
Finally,
we
will
denote
the
â€ 
â€ 
â€ 
pull-backs
of
the
torsor
E[d]
â†’
E
to
W
,
Z
by
EW,[d]
â†’
EW
,
EZ,[d]
â†’
EZ
,
respectively.
def
If
we
let
LW
=
OEW
(eEW
)
(where
eEW
is
the
origin
of
EW
),
then
we
have
an
evaluation
map
for
EZ
(where
the
requisite
integrality
follows
from
the
statement
at
the
end
of
Theorem
3.1):
d
et
Î TZ
:
Î“(EZ
,
(TÎ³âˆ—Z
LâŠ—d
Z
)
âŠ—OEZ
F
(R
â€ 
))
âˆ’â†’
EZ,[d]
(TÎ³âˆ—Z
LâŠ—d
Z
)|(d
EZ
)
(Here
d
EZ
âŠ†
EZ
is
the
subgroup
scheme
of
d-torsion
points
in
EZ
.)
Thus,
one
observes,
relative
to
the
theory
of
Â§5,
that
for
an
appropriate
choice
of
â€œLagrangian
subgroup
Hâ€
(which
lifts
Î¼d
âŠ†
E),
the
evaluation
maps
Î TZ
and
ÎTX
correspond
to
one
another
(up
to
translation
by
W
)
with
respect
to
the
operation
of
â€œtaking
invariants
with
respect
to
the
Lagrangian
subgroupâ€
(cf.
the
discussion
of
Â§5).
Thus,
we
obtain
the
following
result,
which
is
the
main
result
of
this
Â§:
Theorem
6.2.
For
any
integer
d
â‰¥
1,
the
scheme-theoretic
zero
locus
of
the
determinant
of
the
evaluation
map
d
et
Î TZ
:
Î“(EZ
,
(TÎ³âˆ—Z
LâŠ—d
Z
)
âŠ—OEZ
F
(R
â€ 
EZ,[d]
))
âˆ’â†’
(TÎ³âˆ—Z
LâŠ—d
Z
)|(d
EZ
)
on
Z
=
EW
is
given
precisely
by
d
Â·
[d
EZ
]
âŠ†
EZ
,
where
[d
EZ
]
is
the
divisor
deï¬ned
by
the
kernel
of
multiplication
by
d
on
EZ
.
Here,
W
is
a
trait
of
mixed
characteristic
(0,
p);
EW
â†’
W
is
an
elliptic
curve
with
the
property
that
the
moduli
of
the
special
ï¬ber
over
W
are
generic
in
characteristic
p;
LW
def
is
the
line
bundle
deï¬ned
by
the
identity
element
on
EW
;
EZ
=
EW
Ã—W
Z,
LZ
=
LW
|Z
;
Î³Z
âˆˆ
EZ
(Z)
=
EW
(Z)
is
the
point
deï¬ned
by
the
identity
morphism;
TÎ³Z
is
translation
by
â€ 
â€ 
the
point
Î³Z
;
EZ,[d]
is
the
torsor
â€œE[d]
â€
(cf.
Â§2)
for
the
elliptic
curve
EZ
;
and
Retâ€ 
is
E
Z,[d]
the
â€œet-integral
structureâ€
(cf.
Deï¬nition
3.2)
on
the
ï¬ltered
sheaf
of
functions
R
â€ 
EZ,[d]
â€ 
EZ,[d]
.
191
on
Note
that
in
the
above
proof,
we
made
essential
use
of
the
Î¼d
-isogeny
(i.e.,
isogeny
whose
kernel
may
be
identiï¬ed
with
Î¼d
)
Eâ†’E
That
is
to
say,
we
proved
Theorem
6.2,
which
essentially
concerns
objects
over
E,
by
descending
objects
on
E
to
E
via
this
isogeny,
and
then
analyzing
the
resulting
objects
over
E
(cf.
the
discussion
preceding
Lemma
6.1).
In
fact,
however,
one
can
also
give
a
proof
of
Theorem
6.2
by
descending
with
respect
to
the
Z/dZ-isogeny
Ed
â†’
E
(cf.
Â§3
for
an
explanation
of
the
notation
â€“
roughly
speaking,
this
is
the
isogeny
that
looks
like
the
isogeny
â€œGm
/q
dZ
â†’
Gm
/q
Z
â€
arising
from
the
identity
Gm
â†’
Gm
on
Gm
),
and
then
applying
the
theory
developed
in
Â§4
to
the
descended
objects
on
E.
The
advantage
of
the
Î¼d
-isogeny
proof
given
above
is
that
it
allows
one
to
calculate
the
relevant
matrix
very
explicitly
(up
to
the
elementary
row
operations)
without
much
preparation,
and
is
independent
of
the
rather
technical
theory
discussed
in
Â§4.
On
the
other
hand,
once
one
assumes
the
theory
of
Â§4,
the
proof
of
Theorem
6.2
is
relatively
short
and
proceeds
as
follows:
Alternate
Proof
of
Theorem
6.2:
We
omit
various
â€œgeneral
nonsenseâ€
details
concerning
â€œdescent
with
respect
to
the
isogeny
in
questionâ€
and
â€œbase-change
to
W
â€
that
were
discussed
extensively
in
the
preceding
proof
of
Theorem
6.2
and
which
are
the
same
in
both
proofs.
Recall
from
the
discussion
of
Â§3
that
E
â€ 
Cd
,[d]
â€ 
,
i.e.,
the
â€œE[d]
â€
for
Cd
,
is
precisely
the
pull
â€ 
back
via
the
compactiï¬ed
isogeny
Cd
â†’
C
of
the
usual
universal
extension
torsor
EC
â†’
C
over
C
(âŠ‡
E).
Moreover,
it
also
follows
from
the
discussion
of
Â§3
that
the
eÌtale-integral
â€ 
â€ 
is
precisely
the
pull-back
of
the
eÌtale-integral
structure
deï¬ned
on
EC
structure
on
E
Cd
,[d]
in
Chapter
III,
Proposition
6.1.
Thus,
in
summary,
although
we
are
ultimately
interested
in
proving
the
result
(i.e.,
bijectivity)
for
the
evaluation
map
for
functions
in
Retâ€ 
,
it
E
Cd
,[d]
suï¬ƒces
(assuming
that
we
can
descend
the
relevant
line
bundle
on
Cd
down
to
C
â€“
cf.
the
following
paragraph)
to
prove
the
result
for
the
evaluation
map
for
functions
in
Retâ€ 
.
EC
192
The
ï¬nal
detail
that
we
must
take
care
of
before
we
discuss
the
relevant
evaluation
map
on
C
is
the
speciï¬cation
of
the
relevant
line
bundle
on
Cd
.
More
precisely,
this
â€œline
bundle
on
Cd
â€
will
be
a
metrized
line
bundle
on
Eâˆ,S
.
Moreover,
we
want
this
metrized
line
bundle
to
descend
to
a
metrized
line
bundle
on
Eâˆ,S
via
the
Z/dZ-isogeny
Ed
â†’
E.
We
take
this
metrized
line
bundle
on
Eâˆ,S
to
be
Lst,Î·
ev
(respectively,
Lst,Î·
)
ev
if
d
is
odd
(respectively,
even)
â€“
i.e.,
the
metrized
line
bundles
â€œLst,Î·
,â€
â€œLst,Î·
â€
of
Â§1
for
Eâˆ,S
(as
opposed
to
Eâˆ,S
).
Here,
Î·
is
the
torsion
point
of
Eâˆ,S
(SN
)
deï¬ned
by
q
N
âˆˆ
Gm
(USN
)
(where
we
think
of
Eâˆ,S
as
â€œGm
/q
dZ
).
Thus,
it
remains
only
to
see
that
the
metrized
line
bundle
that
we
have
chosen
descends
via
Ed
â†’
E.
Going
back
to
the
deï¬nition
of
ev
Lst,Î·
,
Lst,Î·
in
Â§1,
we
see
that
these
metrized
line
bundles
are
obtained
by
translating
â€œLst
,â€
ev
â€œLst
â€
by
Î·
and
then
adding
various
d-invariant
Ïˆâ€™s.
Since
it
is
clear
that
the
d-invariant
ev
Ïˆâ€™s
descend,
it
thus
suï¬ƒces
to
see
that
Lst
,
Lst
descend.
But
this
is
clear
from
the
explicit
forms
of
these
line
bundles
given
in
Chapter
IV,
Lemma
5.4.
Let
us
denote
the
resulting
descended
metrized
line
bundle
on
Eâˆ,S
by
L
Note
that
L
has
relative
degree
1
over
the
base.
Moreover,
the
curvature
of
L
is
the
same
same
as
the
curvature
of
OC
(eC
)
(where
eC
is
the
identity
element
âˆˆ
C(S)
of
C).
Thus,
one
may
think
of
L
as
a
sort
of
twisted
form
of
OC
(eC
).
This
â€œtwistâ€
may
be
resolved
by
pulling
back
to
an
appropriate
covering
of
C
(cf.
Chapter
IV,
Â§2,3;
Â§4
of
the
present
def
Chapter).
Since
this
twist
is
deï¬ned
by
Î·
(
=
the
image
of
Î·
in
Eâˆ,S
),
and
Î·
does
not
lie
in
the
identity
component
of
the
special
ï¬ber
of
Eâˆ,S
(a
consequence
of
the
fact
that
N
is
assumed
to
be
prime
to
d),
it
follows
that
the
twist
applied
to
OC
(eC
)
to
obtain
L
is
of
the
sort
eï¬€ected
by
a
character
â€œÏ‡L
â€
which
falls
under
Case
III
(relative
to
the
terminology
of
Â§4).
Thus,
to
summarize,
the
above
discussion
shows
that
it
suï¬ƒces
to
consider
the
evaluation
map
given
by
evaluating
sections
of
L
âŠ—OC
F
d
(Retâ€ 
)
(over
Eâˆ,S
)
on
Î¼d
âŠ†
(Gm
)S
=
EC
ES
â†’
E
â€ 
S
(where
ES
â†’
E
â€ 
S
is
the
canonical
section
Îº
of
Chapter
III,
Theorem
2.1).
Since
this
evaluation
map
is
between
vector
bundles
of
rank
d
on
Sâˆ
,
it
follows
that
it
suï¬ƒces
to
prove
that
it
is
injective
modulo
any
prime
p
of
O,
at
least
after
one
inverts
q.
def
But
this
injectivity
follows
immediately
from
Corollary
4.7
(applied
in
the
case
j
=
d).
Indeed,
to
see
this,
we
break
up
the
evaluation
map
of
sections
of
L
âŠ—OC
F
d
(Retâ€ 
)
on
EC
Î¼d
âŠ†
Gm
=
ES
âŠ†
E
â€ 
S
into
two
steps:
193
(1)
First,
we
restrict
sections
of
L
âŠ—OC
F
d
(Retâ€ 
)
to
ES
=
(Gm
)S
âŠ†
E
â€ 
S
.
EC
(2)
Then,
we
strict
functions
on
ES
=
(Gm
)S
to
Î¼d
âŠ†
(Gm
)S
=
ES
.
Strictly
speaking,
the
linear
independence
assertion
of
Corollary
4.7
implies
that
the
ï¬rst
restriction
(1)
is
injective.
(That
is,
if
it
were
not,
then
there
would
be
some
A-linear
Ï‡
with
at
least
one
coeï¬ƒcient
which
is
nonzero
modulo
(q,
p).
relation
among
Î¶0Ï‡
,
.
.
.
,
Î¶dâˆ’1
Thus,
in
particular,
we
would
get
a
linear
relation
modulo
(q
nÂ·cj

,
p)
(with
at
least
one
coeï¬ƒcient
which
is
nonzero
modulo
(q,
p)),
but
this
contradicts
Corollary
4.7.)
Thus,
it
remains
to
see
that
the
second
restriction
(2)
is
injective.
To
see
this,
ï¬rst
observe
that
since
we
are
in
Case
III,
the
number
â€œ|Cj

|â€
(notation
of
Corollary
4.7)
is
equal
to
j
=
d,
i.e.,
â€œmodulo
q
nÂ·cj

â€
(notation
of
Corollary
4.7)
the
only
Ï‡L
-special
monomials
that
may
occur
(i.e.,
are
nonzero)
are
OS
-multiples
of
â€œU
I+iÂ·n
â€
(where
U
,
n
are
as
in
Corollary
4.7;
i
=
0,
.
.
.
,
d
âˆ’
1;
and
I
is
some
ï¬xed
constant,
independent
of
i)
â€“
cf.
Schola
4.1.
Moreover,
â€œU
n
â€
(notation
of
Â§4)
corresponds
precisely
to
the
standard
multiplicative
coordinate
on
ES
=
(Gm
)S
(notation
of
the
present
discussion).
Let
us
denote
this
standard
coordinate
by
V
.
Thus,
we
see
that
the
assertion
that
the
second
restriction
(2)
is
injective
amounts
to
the
following
fact:
For
any
prime
p
of
O,
every
polynomial
in
V
of
degree
â‰¤
d
âˆ’
1
which
vanishes
modulo
p
on
Î¼d
âŠ†
(Gm
)S
=
ES
is
identically
0
modulo
p.
But
this
follows
immediately
from
elementary
algebraic
geometry
as
follows:
If
we
compactify
Gm
by
P1
,
then
we
see
that
we
are
reduced
to
verifying
the
assertion
that
every
global
section
over
P1
of
the
line
bundle
OP1
(âˆ’[Î¼d
]
+
(d
âˆ’
1)[âˆ])
(where
â€œ[Î¼d
]â€
is
the
degree
d
divisor
in
Gm
âŠ†
P1
deï¬ned
by
Î¼d
,
and
â€œ[âˆ]â€
is
the
(degree
1)
divisor
on
P1
at
â€œinï¬nityâ€)
is
identically
zero
(in
every
characteristic).
But
since
this
line
bundle
has
degree
âˆ’1,
this
assertion
is
an
immediate
consequence
of
elementary
algebraic
geometry.
This
completes
the
proof
of
the
various
injectivity
assertions
mentioned
above,
and
hence
of
the
entire
alternate
proof
of
Theorem
6.2.

Bibliography
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
University
Press
(1985).
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deï¬ning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
2
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
194
Chapter
VI:
The
Scheme-Theoretic
Comparison
Theorem
Â§0.
Introduction
In
this
Chapter,
we
prove
the
Scheme-Theoretic
Comparison
Isomorphism.
This
result
essentially
asserts
that:
There
is
a
natural
bijection
between
certain
natural
types
of
algebraic
functions
on
the
universal
extension
of
an
elliptic
curve
and
the
â€œsettheoretic
functionsâ€
on
the
torsion
points
of
the
elliptic
curve.
This
natural
bijection
is
given
by
restricting
the
algebraic
functions
on
the
universal
extension
to
the
torsion
points
of
the
universal
extension.
This
restriction
morphism
is
referred
to
as
the
evaluation
map
(and
is
the
main
topic
of
Chapter
V).
Ultimately,
the
goal
of
this
paper
is
to
show
that
the
evaluation
map
is
not
only
a
bijection,
say,
in
characteristic
zero
(cf.
Theorem
3.1),
but
that
it
preserves
natural
integral
structures
on
both
sides
at
all
the
primes
of
the
rational
number
ï¬eld.
In
the
present
Chapter,
we
address
the
schemetheoretic
portion
of
this
goal,
namely,
we
show
that
we
essentially
get
an
isomorphism
schematically
over
(M1,0
)Z
(cf.
Theorem
4.1).
In
other
words,
we
show
that
the
integral
structures
at
all
of
the
ï¬nite
primes
(essentially)
coincide.
In
Â§1,
we
deï¬ne
the
algebraic
functions
on
the
universal
extension
that
we
are
interested
in.
The
sheaves
of
such
functions
are
called
the
â€œ{v,
et}-push
forwardsâ€
of
a
metrized
line
bundle.
In
Â§2,
we
study
the
various
basic
properties
of
these
push-forwards,
with
an
eye
to
proving
(in
Â§4)
that
they
are
compatible
with
base-change.
In
Â§3,
we
prove
the
comparison
isomorphism
in
characteristic
zero,
i.e.,
that
the
evaluation
map
is
bijective
in
characteristic
zero
(Theorem
3.1).
Finally,
in
Â§4,
we
complete
the
proof
of
compatibility
with
base-change,
and
show
that
the
evaluation
map
also
(essentially)
preserves
integral
structures
on
both
sides
at
all
ï¬nite
primes
(Theorem
4.1).
Â§1.
Deï¬nition
of
a
New
Integral
Structure
at
Inï¬nity
In
this
Â§,
we
prepare
for
the
comparison
isomorphism
results
in
the
remainder
of
this
Chapter
by
introducing
a
new
integral
structure
in
a
neighborhood
of
the
divisor
at
inï¬nity
(i.e.,
the
locus
on
the
base
where
the
log
elliptic
curve
in
question
degenerates).
It
will
be
relative
to
this
new
integral
structure
that
the
evaluation
map
of
Chapter
V,
Â§2,
will
turn
out
to
be
an
isomorphism.
195
In
this
Â§,
we
use
the
notations
of
Chapter
V,
Â§2.
Let
us
ï¬rst
recall
the
WE
-torsor
â€ 
ECd
,[d]
â†’
Cd
â€ 
â€ 
considered
in
Chapter
V,
Â§2.
Note
that
since
ECd
,[d]
extends
the
torsor
E[d]
â†’
E,
which
is
obtained
from
E
â€ 
â†’
E
by
â€œpushing
outâ€
with
respect
to
multiplication
by
d
on
WE
,
it
follows
that
the
canonical
splitting
Îº
(of
Chapter
III,
Theorem
2.1)
of
E
â€ 
â†’
E
over
E
S
deï¬nes
a
canonical
splitting
â€ 
Îº
â€ 
:
ES
â†’
(E[d]
)S
E[d]
Note
that
since
the
eÌtale-integral
structure
of
Chapter
V,
Theorem
3.1,
is
deï¬ned
using
this
canonical
splitting
(cf.
Chapter
V,
Â§3;
Chapter
III,
Â§6),
it
follows
that
Îº
â€ 
deï¬nes,
E[d]
for
any
integer
i
â‰¥
0,
a
direct
sum
decomposition
i
et
F
(R
â€ 
(E
)
iâˆ’1

)
âˆ¼
=
j=0
[d]
S
1
Â·
Ï„
âŠ—j
|E
j!
E
S
(cf.
Chapter
V,
Theorem
3.1).
Similarly,
one
sees
easily
that
by
translation
by
d-torsion
points,
we
get
analogous
direct
sum
decompositions
of
F
i
(Ret
â€ 
)
over
the
q-adic
(EE
,[d]
)
d
S
completions
of
Ed
at
the
other
d
âˆ’
1
connected
components
of
the
special
ï¬ber
of
Ed
.
Note,
however,
that
these
translated
decompositions
do
not
glue
together
at
the
nodes:
indeed,
if
they
did,
then
we
would
obtain
that
Îº
â€ 
extends
over
Cd
,
which
is
absurd
(cf.
E[d]
Chapter
III,
Theorem
5.6).
Now
let
us
suppose
that
we
are
given
a
â€œvaluationâ€
v
âˆˆ
Qâ‰¥0
Â·
log(q)
(where
Qâ‰¥0
is
the
set
of
nonnegative
rational
numbers,
and
â€œlog(q)â€
is
a
formal
symbol).
In
the
following,
we
will
write
exp(v)
=
q
v/log(q)
def
We
would
like
to
construct,
for
each
integer
i
â‰¥
0,
an
S-ï¬‚at
coherent
sheaf
{v})
F
i
(Retâ€ 
EC
,[d]
d
196
on
Cd
associated
to
v,
as
follows.
First
of
all,
over
US
=
S
âˆ’
D,
we
have
F
i
(Retâ€ 
EC
,[d]
def
{v})|US
F
i
(Retâ€ 
=
EC
,[d]
d
Next,
let
us
deï¬ne
F
i
(Retâ€ 
EC
,[d]
d
{v})
over
ES
by
using
the
direct
sum
decomposition
given
d
{v})|E
the
integral
structure
(relative
to
above
in
the
following
way:
We
give
F
i
(Retâ€ 
S
EC
,[d]
d
this
decomposition)
deï¬ned
by:
i
{v})|E
et
F
(R
â€ 
EC
,[d]
d
|US
)
S
def
=
iâˆ’1


1
âŠ—j
Â·
exp(âˆ’v)
Â·
Ï„E
|E
OE
âŠ•
S
S
j!
j=1
{v})
over
the
completions
of
Ed
at
the
other
d
âˆ’
1
connected
We
then
deï¬ne
F
i
(Retâ€ 
EC
,[d]
d
components
of
Ed
in
a
similar
way,
using
the
translated
direct
sum
decompositions
discussed
above.
{v})
over
all
of
Ed
.
Thus,
it
remains
to
Now
observe
that
we
have
deï¬ned
F
i
(Retâ€ 
EC
,[d]
d
extend
the
resulting
vector
bundle
over
Ed
over
Cd
(in
some
sort
of
natural
fashion).
But
this
is
just
a
matter
of
elementary
commutative
algebra,
which
we
review
in
Lemma
1.1
below.
In
fact,
Lemma
1.1
will
also
show
that
there
is
a
unique
extension
of
this
vector
bundle
on
Ed
over
Cd
which
is
S-ï¬‚at,
coherent,
and
satisï¬es
the
property
that
any
length
2
regular
sequence
of
local
sections
of
OCd
is
also
regular
on
this
extension.
Relative
to
the
application
of
Lemma
1.1,
we
remark
that:
(1)
All
of
the
notation
used
in
Lemma
1.1
is
strictly
internal
to
Lemma
1.1
and
has
nothing
to
do
with
the
notation
in
the
remainder
of
the
discussion
of
this
Â§.
(2)
Of
course,
in
general,
Cd
need
not
be
regular,
but
it
suï¬ƒces
to
prove
extendability
in
the
universal
case
(e.g.,
the
â€œEN
â†’
SN
â€
of
Chapter
IV,
Â§4,
for
â€œN
â€
taken
to
be
d),
in
which
case
Cd
is
regular,
and
the
nodes
of
Cd
(with
the
reduced
induced
scheme
structure)
are
regular
of
dimension
dim(Cd
)
âˆ’
2.
This
completes
the
deï¬nition
of
the
S-ï¬‚at
coherent
sheaf
{v})
F
i
(Retâ€ 
EC
,[d]
d
on
Cd
.
197
def
Lemma
1.1.
Let
A
be
a
regular
local
ring
of
dimension
â‰¥
2.
Let
B
=
A/(s,
t)
be
a
quotient
which
is
regular
local
ring
of
dimension
dim(A)
âˆ’
2.
Let
F
be
a
vector
bundle
def
def
on
U
=
Spec(A)\Spec(B)
âŠ†
X
=
Spec(B).
Then
iâˆ—
F
is
a
coherent
sheaf
on
X
with
the
property
that
any
A-regular
sequence
of
length
2
in
A
is
also
(iâˆ—
F)-regular.
Thus,
in
particular,
if
dim(A)
=
2,
then
iâˆ—
F
is
a
vector
bundle
on
X.
Proof.
It
is
well-known
that
in
this
situation,
iâˆ—
F
is
a
coherent
sheaf
(cf.,
e.g.,
[SGA2],
p.
97,
Proposition
3.2).
As
for
the
assertions
concerning
depth,
we
reason
as
follows:
Let
a,
b
âˆˆ
A
be
regular
on
A.
Then
b
acts
injectively
on
any
localization
of
A/(a).
Thus,
the
long
exact
sequence
obtained
by
applying
the
derived
functors
of
iâˆ—
to
0
a
âˆ’â†’
F
âˆ’â†’
F
âˆ’â†’
F/a
Â·
F
âˆ’â†’
0
shows
that
a
acts
injectively
on
iâˆ—
F,
and
that
we
have
an
inclusion
(iâˆ—
F)/a
â†’
iâˆ—
(F/a
Â·
F).
On
the
other
hand,
F/a
Â·
F
is
just
a
vector
bundle
over
some
open
subscheme
of
Spec(A/(a)),
so
multiplication
by
b
is
injective
on
F/a
Â·
F,
hence
also
on
iâˆ—
(F/a
Â·
F),
as
well
as
(iâˆ—
F)/a.
This
shows
that
a,
b
is
regular
on
iâˆ—
F,
as
desired.
If
dim(A)
=
2,
then
this
shows
that
iâˆ—
F
has
depth
2
as
an
A-module,
hence
(by
the
Auslander-Buchsbaum
formula
â€“
see,
e.g.,
[Mats])
is
a
vector
bundle.
This
completes
the
proof.

{v})
has
a
ï¬ltration
As
remarked
above,
F
i
(Retâ€ 
EC
,[d]
d
0
âŠ†
.
.
.
âŠ†
F
j
(Retâ€ 
EC
,[d]
{v})
âŠ†
.
.
.
âŠ†
F
i
(Retâ€ 
{v})
EC
,[d]
d
d
(where
1
â‰¤
j
â‰¤
i)
whose
subquotients
admit
natural
inclusions
{v})
âŠ†
(F
j+1
/F
j
)(Retâ€ 
EC
,[d]
1
Â·
exp(âˆ’v)
Â·
Ï„EâŠ—j
|Cd
j!
d
Moreover,
if
v1
â‰¤
v2
,
then
we
have
a
natural
inclusion
F
i
(Retâ€ 
EC
,[d]
{v1
})
âŠ†
F
i
(Retâ€ 
{v2
})
EC
,[d]
d
d
We
denote
the
union
of
all
of
these
sheaves
(as
v
ranges
over
all
elements
of
Qâ‰¥0
Â·
log(q))
by
{âˆ})
F
i
(Retâ€ 
EC
,[d]
d
198
We
summarize
the
properties
of
these
sheaves
as
follows:
Proposition
1.2.
The
quasi-coherent
sheaf
of
OCd
-modules
Retâ€ 
{v}

def
=
EC
,[d]
iâ‰¥0
d
{v})
F
i
(Retâ€ 
EC
,[d]
d
comes
equipped
with
an
exhaustive
ï¬ltration
{v})
F
i
(Retâ€ 
EC
,[d]
d
(for
i
â‰¥
0)
whose
i-th
member
is
an
S-ï¬‚at
coherent
sheaf
(of
generic
rank
i)
on
Cd
.
Moreover,
this
quasi-coherent
sheaf
restricts
(as
a
ï¬ltered
object)
to
Retâ€ 
(as
in
Chapter
EC
,[d]
d
V,
Theorem
3.1)
away
from
the
divisor
at
inï¬nity.
Finally,
the
natural
morphisms
{v})
â†’
(F
i+1
/F
i
)(Retâ€ 
EC
,[d]
1
Â·
exp(âˆ’v)
Â·
OCd
âŠ—OS
Ï„EâŠ—i
i!
d
(if
i
â‰¥
1)
and
F
1
(Retâ€ 
EC
,[d]
{v})
â†’
OCd
d
arising
from
Chapter
V,
Theorem
3.1,
are
isomorphisms
over
Ed
,
i.e.,
away
from
the
nodes
of
Cd
.
By
pulling
back
these
various
objects
from
Cd
to
Câˆ,S
and
Eâˆ,S
,
we
obtain
corâ€ 
â€ 
responding
sheaves
over
Câˆ,S
and
Eâˆ,S
(cf.
the
construction
of
ECâˆ,S
,[d]
,
Eâˆ,[d]
=
â€ 
EEâˆ,S
,[d]
â†’
Eâˆ,S
in
Chapter
V,
Â§2).
Naturally,
if
we
are
given
diï¬€erent
sequences
vÎ¹
at
the
various
connected
components
Î¹
of
the
divisor
at
inï¬nity
of
S,
then
we
may
adjust
the
integral
structure
according
to
the
sequence
vÎ¹
at
Î¹,
and
thus
obtain
global
objects
suï¬ƒxed
def
by
â€œ{v},â€
where
v
=
{vÎ¹
}Î¹
.
(We
leave
the
formal
details
to
the
reader.)
In
particular,
if
L
is
a
metrized
line
bundle
on
Eâˆ,S
of
relative
degree
d
and
whose
curvatures
are
d-invariant
(i.e.,
a
metrized
line
bundle
of
the
sort
considered
in
Chapter
V,
Â§2),
then
by
taking
global
sections
over
Eâˆ,S
of
199
L
âŠ—OEâˆ,S
F
i
(Retâ€ 
{v})
Eâˆ,[d]
(for
i
â‰¥
0)
we
obtain
a
natural
metrized
vector
bundle
(of
rank
d
Â·
i)
with
GL
-action
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<i
{v,
et}
(
âŠ‡
(fS
)âˆ—
(L|
â€ 
)<i
)
Eâˆ,[d]
on
Sâˆ
.
Deï¬nition
1.3.
forwards.
In
the
following,
we
shall
refer
to
these
push-forwards
as
{v,
et}-push
Â§2.
Compatibility
with
Base-Change
In
this
Â§,
we
study
the
push-forwards
deï¬ned
in
Â§1
and
show,
in
particular,
that
these
push-forwards
are
compatible
with
base-change
if
and
only
if
they
are
compatible
with
base-change
â€œmodulo
p.â€
We
will
then
show,
in
certain
special
cases,
compatibility
with
base-change
modulo
p
in
Â§4
below,
and
thus
conclude
(in
Â§4)
that
(at
least
in
these
cases)
the
various
push-forwards
deï¬ned
in
Â§1
are
compatible
with
base-change.
In
this
Â§,
we
continue
to
use
the
notation
of
Â§1.
Let
us
suppose
that
we
are
also
given
an
m-torsion
point
Î·
âˆˆ
Eâˆ,S
(Sâˆ
)
(where
m
â‰¥
1
is
an
integer)
as
in
Chapter
V,
Â§1.
Then,
by
pulling
back
the
metrized
line
bundles
constructed
in
the
universal
case
in
Chapter
V,
Â§1,
we
obtain
metrized
line
bundles
Lst,Î·
;
ev
Lst,Î·
on
Eâˆ,S
.
Let
us
take
the
metrized
line
bundle
L
(in
the
discussion
at
the
end
of
Â§1)
to
be
ev
Lst,Î·
(respectively,
Lst,Î·
)
if
d
is
odd
(respectively,
even).
Then,
in
this
Â§,
we
would
like
to
study
the
{v,
et}-push
forwards
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
200
)<j
{v,
et}
(for
j
â‰¥
1)
on
Sâˆ
.
In
particular,
we
would
like
to
study
the
extent
to
which
these
pushforwards
are
compatible
with
base-change,
among
bases
S
log
as
in
Â§1
(=as
in
Chapter
V,
Â§2),
i.e.,
bases
such
that
the
pull-back
of
divisor
at
inï¬nity
of
(M1,0
)Z
is
a
Cartier
divisor
on
S
and
for
which
the
q-parameter
locally
admits
a
d-th
root.
def
First
observe
that
over
US
=
S
âˆ’
D,
compatibility
with
base-change
follows
immediately
from
elementary
algebraic
geometry
(cf.,
e.g.,
[Harts],
Chapter
III,
Corollary
12.9,
Theorem
12.11),
since:
(i)
the
sheaf
Ret
admits
a
ï¬ltration
with
subquotients
which
are
(locally
on
S)
isomorphic
to
the
structure
sheaf
(Proposition
1.2);
(ii)
the
higher
direct
image
sheaves
of
the
line
bundle
L|US
with
respect
to
the
morphism
E|US
â†’
US
vanish.
Thus,
it
suï¬ƒces
to
localize
S
to
a
neighborhood
of
an
arbitrary
point
of
D.
In
the
following
discussion,
we
will
often
carry
out
such
localizations
without
further
justiï¬cation.
In
particular,
we
may
assume
that
â€œthere
is
only
one
Î¹,â€
i.e.,
that
D
is
irreducible.
Let
us
consider
the
line
bundle
L.
Without
loss
of
generality,
we
assume
in
the
case
of
d
even
that
the
q-parameter
has
a
2d-th
root
on
S.
(This
may
always
be
achieved
by
replacing
S
by
a
ï¬nite,
ï¬‚at
covering
of
S;
since
this
covering
will
be
ï¬‚at,
it
will
not
eï¬€ect
compatibility
with
base-change
issues.)
If
d
is
even,
then
we
let
Î²
âˆˆ
Eâˆ,S
(S)
be
a
2d-torsion
point
as
in
Chapter
IV,
Lemma
5.4.
Now,
we
let
M
ev
be
the
metrized
line
bundle
Lst
(respectively,
TÎ²âˆ—
Lst
)
if
d
is
odd
(respectively,
even).
(Here,
â€œTÎ²
â€
is
the
automorphism
of
Eâˆ,S
given
by
translation
by
Î².)
Note
that
the
curvature
of
M
is
the
same
as
that
of
L
(cf.
Chapter
V,
the
discussion
preceding
Proposition
1.1,
for
a
computation
of
the
curvature
of
L;
Chapter
IV,
Lemma
5.4,
for
a
computation
of
the
curvature
of
M).
Moreover,
it
is
clear
from
the
deï¬nitions
of
L
and
M
on
Eâˆ,S
|US
(namely,
both
are
obtained
by
translating
a
multiple
of
the
divisor
deï¬ned
by
the
identity
element
by
some
torsion
point)
that
there
exists
an
integer
N
â‰¥
1
such
that
(after
possibly
localizing
S
further)
we
obtain
an
isomorphism
of
metrized
line
bundles:
L
âŠ—N
âŠ—N
âˆ¼
=M
In
particular,
it
follows
that
we
may
write
L=MâŠ—Q
âŠ—N
is
trivial.
Note,
moreover,
that
where
Q
is
a
metrized
line
bundle
on
Eâˆ,S
such
that
Q
M
is
represented
by
a
line
bundle
on
Cd
in
the
usual
sense
(cf.
Chapter
IV,
Lemma
5.4).
The
point
here
(cf.
the
proof
of
Chapter
IV,
Theorem
5.8)
is
that
we
would
like
to
reduce
compatibility
with
base-change
assertions
concerning
the
metrized
line
bundle
L
(which
is
a
delicate
issue)
to
compatibility
with
base-change
assertions
for
the
â€œline
bundle
in
the
usual
sense
Mâ€
(an
issue
which
is
well-known
from
elementary
algebraic
geometry).
201
Thus,
M
is
a
line
bundle
in
the
usual
sense
on
Cd
.
Let
us
assume
(without
loss
of
generality)
that
the
q-parameter
on
S
admits
an
2N
Â·
d-th
root.
Then
it
follows
that
there
exists
a
ï¬nite
isogeny
Ed
â†’
Ed
(of
degree
N
)
whose
kernel
is
isomorphic
to
Î¼N
.
Moreover,
this
isogeny
compactiï¬es
to
a
diagram
Ed
â
â

âŠ†
Cd
â
â

Ed
âŠ†
Cd
The
purpose
of
introducing
Ed
is
that
the
pull-back
of
the
metrized
line
bundle
Q
to
Eâˆ,S
is
a
line
bundle
in
the
usual
sense.
Indeed,
to
see
this,
one
reasons
as
follows:
First
of
all,
observe
(from
the
general
theory
of
abelian
schemes)
that
the
kernel
of
the
pull-back
morphism
on
Picard
groups
induced
by
the
isogeny
Eâˆ,S
|US
â†’
Eâˆ,S
|US
is
the
Cartier
dual
of
Ker(Eâˆ,S
|US
â†’
Eâˆ,S
|US
)
=
Î¼N
.
Thus,
the
kernel
of
the
pull-back
morphism
is
Z/N
Z
(cf.
the
discussion
in
Chapter
IV,
Â§2,
of
the
isogenies
â€œE
[n]
â†’
E
â†’
Eâ€
and
line
bundles
on
E
which
become
trivial
when
pulled
back
to
E
[n]
).
In
other
words,
if
one
thinks
of
the
subscheme
of
N
-torsion
points
of
Eâˆ,S
|US
as
Î¼N
Ã—
(Z/N
Z),
then
this
kernel
is
generated
by
the
line
bundle
corresponding
to
a
divisor
of
the
form
Ï„
âˆ’
eEâˆ,S
,
where
eEâˆ,S
is
the
identity
element
of
Eâˆ,S
,
and
Ï„
is
an
N
-torsion
point
whose
projection
to
Z/N
Z
generates
Z/N
Z.
In
particular,
this
means
that
the
pull-back
of
Q|US
to
Eâˆ,S
|US
is
isomorphic
to
the
pull-back
to
Eâˆ,S
|US
of
the
line
bundle
associated
to
a
divisor
of
the
form
Ï„
âˆ’
eEâˆ,S
,
where
Ï„
âˆˆ
Î¼N
(S)
âŠ†
E(S)
âŠ†
Eâˆ,S
(S).
On
the
other
hand,
note
that
for
such
a
Ï„
,
the
line
bundle
(in
the
usual
sense)
OCd
(Ï„
âˆ’
eCd
)
already
forms
a
metrized
line
bundle
on


Eâˆ,S
whose
curvature
is
zero.
Thus,
in
summary,
Q|Eâˆ,S
and
OCd
(Ï„
âˆ’
eCd
)|Eâˆ,S
have
isomorphic
restrictions
to
Eâˆ,S
|US
and,
moreover,
both
have
curvature
zero.
In
particular,
by
Chapter
IV,
Proposition
4.3,
it
follows
that
these
two
metrized
line
bundles
on
Eâˆ,S

are
isomorphic,
i.e.,
that
the
metrized
line
bundle
Q|Eâˆ,S
is
represented
by
a
line
bundle
in
the
usual
sense
on
Cd
,
as
desired.
Thus,
to
summarize,
we
have
L
=
M
âŠ—
Q,
where
M
arises
from
a
line
bundle
in

the
usual
sense
on
Cd
;
and
Q|Eâˆ,S
arises
from
a
line
bundle
in
the
usual
sense
on
Cd
.
In
particular,
we
conclude
that:

The
metrized
line
bundle
L|Eâˆ,S
arises
from
a
line
bundle
P
in
the
usual
sense
on
Cd
.
Moreover,
the
restriction
of
P
to
each
to
the
irreducible
components
of
the
special
ï¬ber
of
Cd
is
of
degree
N
(since
Ed
â†’
Ed
is
of
degree
N
).
Now
ï¬x
an
integer
j
â‰¥
1,
and
let
def
F
=
F
j
(Retâ€ 
EC
,[d]
d
202
{v})|Cd
Thus,
F
is
an
S-ï¬‚at
coherent
sheaf
on
Cd
whose
restriction
to
Ed
is
a
vector
bundle
of
rank
j
which
admits
a
ï¬ltration
whose
subquotients
are
isomorphic
to
OEd
.
Moreover,
the
push-forwards
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<j
{v,
et}
that
we
are
interested
in
are
simply
the
Î¼N
-invariant
portions
of
fâˆ—
(F
âŠ—OC

P)
d
(where,
in
the
following,
we
shall
write
fâˆ—
for
the
push-forwards
to
S
of
objects
on
Cd
or
Ed
)
with
respect
to
the
evident
natural
Î¼N
-action.
Thus,
since
the
group
scheme
Î¼N
is
of
multiplicative
type,
hence
reductive
(so
the
operation
of
â€œtaking
the
Î¼N
-invariant
partâ€
commutes
with
base-change),
it
follows
that:
The
issue
of
the
compatibility
of
the
push-forward
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<j
{v,
et}
with
base-change
may
be
reduced
to
the
issue
of
the
compatibility
of
the
push-forward
fâˆ—
(F
âŠ—OC

P)
=
fâˆ—
{(F
âŠ—OC

P)|Ed
}
with
base-change.
d
d
At
this
point,
before
we
continue
to
study
compatibility
with
base-change
issues
further,
we
pause
to
note
the
following
important
lemma:
Lemma
2.1.
The
metrized
vector
bundle
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<j
{v,
et}
(which
a
priori
â€“
cf.
Chapter
IV,
Deï¬nition
5.2
â€“
is
just
a
quasi-coherent
sheaf
on
Sâˆ
)
is,
in
fact,
a
coherent
sheaf
on
Sâˆ
.
If,
moreover,
the
classifying
morphism
S
â†’
(M1,0
)Z
is
ï¬‚at,
then
this
coherent
sheaf
is,
in
fact,
a
vector
bundle
on
Sâˆ
.
Proof.
Indeed,
the
above
discussion
shows
that
this
metrized
vector
bundle
is
just
the
Î¼N
-invariant
portion
of
the
push-forward
fâˆ—
(F
âŠ—OC

P)
d
203
On
the
other
hand,
this
latter
push-forward
is
clearly
a
coherent
sheaf
of
OSâˆ
-modules.
Thus,
the
metrized
vector
bundle
(fS
)âˆ—
(L|
â€ 
)<j
{v,
et}
is,
in
fact,
a
coherent
sheaf
of
Eâˆ,[d]
OSâˆ
-modules,
as
desired.
If
the
classifying
morphism
is
ï¬‚at,
then
formation
of
push-forwards
is
compatible
with
base-change,
so
we
reduce
immediately
to
the
â€œuniversal
caseâ€
â€“
i.e.,
where
S
is,
say,
of
1
the
form
Spec(O[[q
2N
Â·d
]]),
and
O
is
the
Zariski
localization
of
the
ring
of
integers
of
a
number
ï¬eld.
In
this
case,
Sâˆ
is
a
projective
limit
of
regular
schemes
of
dimension
2,
so
we
conclude
from
from
Lemma
1.1
that
â€œany
metrized
vector
bundle
on
Sâˆ
which
is
a
coherent
sheaf
of
OSâˆ
-modules
is,
in
fact,
a
vector
bundle
on
Sâˆ
,â€
as
desired.

Next,
we
consider
base-change
issues.
The
following
result
follows
from
elementary
homological
algebra:
Lemma
2.2.
Let
A
be
a
quasi-coherent
OS
-algebra.
Then
we
have
an
exact
sequence:
fâˆ—
{(F
âŠ—OC

P)|Ed
}
âŠ—OS
A
â†’
fâˆ—
{(F
âŠ—OC

P)|Ed
âŠ—OS
A}
d
d
1
S
â†’
T
or
O
1
(R
fâˆ—
{(F
âŠ—OC

P)|Ed
},
A)
â†’
0
d
Moreover,
when
j
=
1,
i.e.,
F
=
OCd
,
we
have
R1
fâˆ—
(F
âŠ—OC

P)
=
0,
and
fâˆ—
(F
âŠ—OC

d
P)
âŠ—OS
A
=
fâˆ—
(F
âŠ—OC

P
âŠ—OS
A).
d
d
Proof.
Indeed,
the
exact
sequence
follows
by
considering
the
usual
spectral
sequence
relating
H
âˆ—
(C
Â·
)
âŠ—OS
A
and
H
âˆ—
(C
Â·
âŠ—OS
A),
where
C
Â·
is
a
complex
of
ï¬‚at,
coherent
OS
modules.
In
this
case,
since
the
push-forward
functor
fâˆ—
has
cohomological
dimension
â‰¤
1,
the
complex
C
Â·
may,
in
fact,
be
taken
to
consist
of
just
two
terms,
i.e.,
C
Â·
may
be
written
C
0
â†’
C
1
.
The
case
j
=
1
follows
by
considering
the
fact
that
P
is
a
line
bundle
whose
restriction
to
each
of
the
irreducible
components
of
the
special
ï¬ber
of
Cd
is
of
degree
N
â‰¥
1,
and
applying
[Harts],
Chapter
III,
Corollary
12.9,
Theorem
12.11.

Now
let
us
suppose
that
S
is
the
spectrum
of
a
regular
local
ring
of
dimension
2.
Suppose
that
Î±,
Î²
are
a
system
of
regular
parameters
for
this
regular
local
ring,
and
that
V
(Î²)
âŠ†
S
is
set-theoretically
equal
to
the
divisor
at
inï¬nity
D
âŠ†
S.
Suppose,
moreover,
that
we
know
that
the
morphism
fâˆ—
{(F
âŠ—OC

P)|Ed
}
âŠ—OS
A
â†’
fâˆ—
{(F
âŠ—OC

P)|Ed
âŠ—OS
A}
d
d
is
surjective
when
A
is
taken
to
be
OS
/(Î±).
Then
I
claim
that
it
follows
that
this
morphism
is
surjective
for
all
A
on
which
Î²
acts
injectively.
Indeed,
our
assumption
concerning
the
case
when
A
=
OS
/(Î±)
implies
that
204
1
S
T
orO
1
(R
fâˆ—
{(F
âŠ—OC

P)|Ed
},
OS
/(Î±))
=
0
d
def
i.e.,
that
Î±
acts
injectively
on
the
coherent
sheaf
B
=
R1
fâˆ—
{(F
âŠ—OC

P)|Ed
}.
Note
that
d
although
B
itself
might
not
be
ï¬nitely
generated
over
OS
,
it
may
be
written
as
a
direct
limit
of
ï¬nitely
generated
OS
-submodules
B
âŠ†
B.
Note
that
since
Î±
acts
injectively
on
B,
it
also
acts
injectively
on
B
.
Similarly,
since
B
is
set-theoretically
supported
on
D,
it
follows
that
B
is
also
set-theoretically
supported
on
D.
But
this
implies
that
the
OS
-module
B
has
depth
â‰¥
1,
hence
(by
the
â€œAuslander-Buchsbaum
Formulaâ€
â€“
cf.,
e.g.,
[Mats])
that
the
OS
-module
B
has
cohomological
dimension
â‰¤
1.
Since,
moreover,
B
is
(set-theoretically)
supported
on
D,
we
thus
conclude
that
there
exists
an
exact
sequence
0
âˆ’â†’
OSr
Ï†
âˆ’â†’
OSr
âˆ’â†’
B
âˆ’â†’
0
(where
r
is
an
integer).
Moreover,
since
the
zero
locus
of
det(Ï†)
âˆˆ
OS
is
set-theoretically
equal
to
D,
we
conclude
that
there
exists
an
OS
-linear
morphism
Ïˆ
:
OSr
â†’
OSr
such
that
Ïˆ
â—¦
Ï†
=
Î²
a
,
for
some
integer
a
â‰¥
0.
In
particular,
we
conclude
that
the
above
exact
sequence
remains
exact
after
tensoring
with
any
A
on
which
Î²
acts
injectively.
But
this
S
implies
that
for
such
an
A,
we
have
T
orO
1
(B
,
A)
=
0,
hence
(since
T
or
commutes
with
S
ï¬ltered
direct
limits)
that
T
orO
1
(B,
A)
=
0,
as
claimed.
In
fact,
in
our
situation,
instead
of
being
given
that
the
entire
morphism
fâˆ—
{(F
âŠ—OC

P)|Ed
}
âŠ—OS
A
â†’
fâˆ—
{(F
âŠ—OC

P)|Ed
âŠ—OS
A}
d
d
is
surjective
when
A
=
O/(Î±),
we
will
instead
just
be
given
that
its
Î¼N
-invariant
portion
is
surjective
when
A
=
O/(Î±).
But
since
Î¼N
is
of
multiplicative
type,
it
is
clear
that
the
argument
of
the
preceding
paragraph
then
allows
one
to
conclude
the
surjectivity
of
the
Î¼N
-invariant
portion
of
this
morphism
for
any
A
on
which
Î²
acts
injectively.
In
other
words,
we
have
proven
the
following:
Lemma
2.3.
Suppose
that
S
is
the
spectrum
of
a
regular
local
ring
of
dimension
2.
Suppose
that
Î±,
Î²
are
a
system
of
regular
parameters
for
this
regular
local
ring,
and
that
V
(Î²)
âŠ†
S
is
set-theoretically
equal
to
the
divisor
at
inï¬nity
D
âŠ†
S.
Suppose,
moreover,
that
we
know
that
the
morphism
fâˆ—
{(F
âŠ—OC

P)|Ed
}
âŠ—OS
A
â†’
fâˆ—
{(F
âŠ—OC

P)|Ed
âŠ—OS
A}
d
d
is
surjective
on
Î¼N
-invariant
parts
when
A
is
taken
to
be
OS
/(Î±).
Then
it
follows
that
this
morphism
is
surjective
on
Î¼N
-invariant
parts
for
all
A
on
which
Î²
acts
injectively.
205
Â§3.
The
Comparison
Isomorphism
in
Characteristic
Zero
The
purpose
of
the
present
Â§
is
to
show
that
for
appropriate
choices
of
the
metrized
line
bundle
L
(cf.
Chapter
V,
Â§1),
certain
slightly
modiï¬ed
versions
of
the
evaluation
maps
of
Chapter
V,
Propositions
2.2,
2.3,
are
isomorphisms
in
characteristic
zero.
In
this
Â§,
we
use
the
notation
of
Â§1.
Let
us
suppose
that
we
are
also
given
an
m-torsion
point
Î·
âˆˆ
Eâˆ,S
(Sâˆ
)
(where
m
â‰¥
1
is
an
integer)
as
in
Chapter
V,
Â§1.
Then,
by
pulling
back
the
metrized
line
bundles
constructed
in
the
universal
case
in
Chapter
V,
Â§1,
we
obtain
metrized
line
bundles
Lst,Î·
;
ev
Lst,Î·
on
Eâˆ,S
.
We
are
now
ready
to
state
and
prove
the
following
result:
Theorem
3.1.
(Comparison
Isomorphism
in
Characteristic
Zero)
Let
d,
m
â‰¥
1
be
integers
such
that
m
does
not
divide
d.
Suppose
that
S
log
is
a
ï¬ne
noetherian
log
scheme,
and
let
C
log
â†’
S
log
be
a
log
elliptic
curve
over
S
log
such
that
the
â€œdivisor
at
inï¬nityâ€
D
âŠ†
S
(i.e.,
the
pullback
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
via
the
classifying
morphism
S
â†’
(M1,0
)Z
)
is
a
Cartier
divisor
on
S.
Also,
let
us
assume
that
eÌtale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root,
and
that
the
classifying
morphism
S
â†’
(M1,0
)Z
associated
to
C
log
â†’
S
log
is
ï¬‚at
in
a
neighborhood
of
D.
(Note
that
this
ï¬‚atness
automatically
holds
whenever
S
is
of
characteristic
zero.)
Suppose,
moreover,
we
are
given
a
torsion
point
Î·
âˆˆ
Eâˆ,S
(Sâˆ
)
of
order
precisely
m
which
(according
to
the
discussion
preceding
Chapter
V,
Proposition
ev
def
1.1)
deï¬nes
line
bundles
Lst,Î·
,
Lst,Î·
.
If
d
is
odd
(respectively,
even),
then
let
L
=
Lst,Î·
def
ev
(respectively,
L
=
Lst,Î·
).
Then:
(1)
For
any
collection
v
=
{vÎ¹
}Î¹
of
elements
of
Qâ‰¥0
Â·
log(q)
âˆ
(one
for
each
connected
component
Î¹
of
the
divisor
at
inï¬nity
D),
the
evaluation
map
of
Chapter
V,
Proposition
2.2
(for
â€œÎ±â€
taken
to
be
0)
factors
206
through
the
metrized
vector
bundle
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{v,
et}
of
Â§1
to
de-
ï¬ne
a
natural
morphism
Î{v,
et}
:
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{v,
et}
â†’
(fS
)âˆ—
(L|
â€ 
)
(d
Eâˆ
)
(2)
If
vÎ¹
=
âˆ
for
all
Î¹,
then
Î{v,
et}
âŠ—
Q
is
an
isomorphism.
Moreover,
at
each
Î¹,
there
exists
a
unique
sequence
aÎ¹
=
{(aÎ¹
)0
,
.
.
.
,
(aÎ¹
)dâˆ’1
}
of
elements
of
Qâ‰¥0
Â·log(q)
such
that
the
natural
inclusions
F
j
((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{(aÎ¹
)jâˆ’1
,
et})
âŠ†
F
j
((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et})
are
all
equalities
and
the
natural
projections
(F
j
/F
jâˆ’1
)((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{(aÎ¹
)jâˆ’1
,
et})
âˆ’â†’
1
Â·
exp(âˆ’(aÎ¹
)jâˆ’1
)
Â·
(fS
)âˆ—
(L|Eâˆ,S
)
âŠ—OS
Ï„EâŠ—jâˆ’1
(j
âˆ’
1)!
(where
j
=
1,
.
.
.
,
d)
are
surjective
(hence
bijective).
(3)
Finally,
these
sequences
aÎ¹
satisfy
the
following
condition:
for
each
connected
component
Î¹,
there
is
an
XÎ¹
âˆˆ
{I,
II,
III}
such
that
(aÎ¹
)jâˆ’1
=
1
Â·
cj
d
where
cj
is
as
in
Chapter
V,
Â§4,
for
Case
XÎ¹
.
Proof.
First,
let
us
observe
that
since
the
classifying
morphism
S
â†’
(M1,0
)Z
is
ï¬‚at
in
a
neighborhood
of
inï¬nity,
the
various
push-forwards
(fS
)âˆ—
(along
with
their
ï¬ltrations)
207
are
compatible
with
base-change
(cf.
Lemma
2.2).
(Note
that
in
characteristic
zero,
the
classifying
morphism
factors
through
(M1,0
)Q
,
which
is
regular
of
dimension
one.
Thus,
ï¬‚atness
follows
from
the
assumption
that
the
q-parameter
is
a
non-zero
divisor,
i.e.,
that
the
closed
subscheme
D
is
a
Cartier
divisor
on
S.)
Thus,
it
suï¬ƒces
to
prove
Theorem
def
3.1
in
the
â€œuniversal
caseâ€
â€“
for
instance,
in
the
case
of
S
=
T
,
where
T
â†’
B
is
any
â€œnice
covering,â€
as
in
Chapter
V,
Proposition
1.2,
such
that
at
each
Î¹,
the
corresponding
q-parameter
has
a
d-th
root
in
OT
.
Next,
note
that
to
see
that
the
evaluation
map
of
Chapter
V,
Proposition
2.2,
factors
as
claimed
in
(1),
it
suï¬ƒces
to
prove
that
it
factors
in
characteristic
zero.
Indeed,
once
it
factors
in
characteristic
zero,
the
fact
that
it
also
factors
away
from
the
divisor
at
inï¬nity
(cf.
Proposition
1.2;
the
integrality
statement
at
the
end
of
Chapter
V,
Theorem
3.1)
implies
â€“
since
S
=
T
is
ï¬nite,
ï¬‚at
over
(M1,0
)Z
,
which
is
regular
â€“
that
it
factors
over
all
of
S
=
T
.
Similarly,
the
natural
inclusions
of
(2)
are
equalities
if
and
only
if
they
are
equalities
in
characteristic
zero.
Indeed,
if
they
are
equalities
in
characteristic
zero,
then
both
sides
are
vector
bundles
(cf.
Lemma
2.1)
which
are
tautologically
equal
away
from
the
divisor
at
inï¬nity.
Thus,
in
summary,
except
for
the
surjectivity
of
the
natural
projections
in
(2),
it
suï¬ƒces
to
prove
Theorem
3.1
in
characteristic
zero.
In
particular,
for
the
remainder
of
the
proof
(except
where
speciï¬ed
otherwise),
We
assume
that
S
is
T
âŠ—
Q,
where
T
is
as
above.
Also,
to
simplify
the
discussion,
we
assume
that
S
is
connected.
Thus,
the
base
S
is
a
smooth,
proper
curve
over
a
ï¬eld
of
characteristic
zero.
Now
we
divide
the
proof
into
parts:
Local
Assertions:
Let
us
ï¬rst
show
that
the
evaluation
map
factors
as
stated
in
(1)
for
any
choice
of
v,
and
that
the
natural
projections
of
(2)
(F
j
/F
jâˆ’1
)((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{(aÎ¹
)jâˆ’1
,
et})
âˆ’â†’
1
Â·
exp(âˆ’(aÎ¹
)jâˆ’1
)
Â·
(fS
)âˆ—
(L|Eâˆ,S
)
âŠ—OS
Ï„EâŠ—jâˆ’1
(j
âˆ’
1)!
are
surjective
for
the
special
choice
of
v
referred
in
(2)
and
(3).
Since
these
are
local
issues
at
inï¬nity,
we
assume
(just
for
this
â€œLocal
Assertionsâ€
part
of
the
proof)
that
S
=
Spec(A)
208
def
1
where
A
=
O[[q
N
Â·d
]]
(where
N
=
2m
Â·
d),
and
O
is
a
Zariski
localization
of
the
ring
of
integers
of
a
number
ï¬eld.
Let
KH
=
Z/dZ
âŠ†
d
E
be
the
subgroup
corresponding
to
the
1
d-th
root
q
d
of
q.
Thus,
we
have
a
ï¬nite
eÌtale
isogeny
Ed
â†’
Ed
/KH
=
EH
One
checks
easily
(using
Chapter
IV,
Lemma
5.4
â€“
cf.
the
argument
in
the
â€œAlternate
Proof
of
Theorem
6.2â€
in
Chapter
V,
Â§6)
that
L
descends
to
a
metrized
line
bundle
LH
of
relative
degree
1
on
EâˆH
,S
.
Thus,
there
exists
a
Lagrangian
subgroup
(cf.
the
discussion
of
such
subgroups
in
Chapter
IV,
Â§1)
H
âŠ†
GL
Note
that
the
{v,
et}-push
forwards,
as
well
as
the
evaluation
maps
Î{v,
et}
all
have
â€œsubscript
H
versionsâ€
(obtained
by
taking
â€œH-invariantsâ€
of
the
original
versions
discussed
above).
We
leave
the
routine
details
to
the
reader.
â€ 
â€ 
Next,
let
us
note
that
d
EâˆH
âŠ†
EâˆH
,[d]
lies
inside
the
canonical
section
derived
from
Îº.
Indeed,
this
follows
from
the
facts
that:
(i)
the
canonical
section
is
a
group
homomorphism
(Chapter
III,
Theorem
2.1);
(ii)
WE
has
no
torsion
since
our
base
S
is
Z-ï¬‚at;
and
â€ 
(iii)
the
image
of
d
EâˆH
in
EâˆH
,S
lies
in
the
identity
component
of
the
special
ï¬ber
of
EâˆH
,S
.
Since
the
modiï¬cations
in
integral
structure
that
one
performs
in
order
to
construct
the
{v,
et}-push-forward
(for
any
v)
are
all
done
using
the
splittings
deï¬ned
by
the
canonical
section
(derived
from
Îº),
it
is
a
tautology
that
all
sections
of
the
{v,
et}-push-forward
which
have
â€œdenominatorsâ€
relative
to
the
usual
push-forward
vanish
(i.e.,
modulo
the
sections
which
do
not
have
denominators
relative
to
the
usual
push-forward)
when
restricted
to
â€ 
the
canonical
section,
hence
when
restricted
to
d
EâˆH
.
Thus,
it
follows
that
the
evaluation
map
of
Chapter
V,
Proposition
2.2,
factors
as
claimed
in
(1)
(for
any
v).
Next,
let
us
observe
that
â€œmetrically
speakingâ€
LH
is
the
same
as
the
metrized
line
bundle
OEâˆH
,S
([eEâˆH
,S
]).
More
precisely,
we
have:
âŠ—mÂ·d
LH
âˆ¼
=
OEâˆH
,S
(m
Â·
d
Â·
[eEâˆH
,S
])
Indeed,
if
we
forget
about
metrics,
this
follows
from
the
linear
equivalence
m(d
Â·
[Î·])
âˆ¼
m
Â·
d
Â·
[e]
on
Eâˆ,S
|US
pushed
forward
from
Eâˆ,S
to
EâˆH
,S
.
Moreover,
it
follows
from
the
209
computation
of
the
curvature
of
L
(in
the
discussion
preceding
Chapter
V,
Proposition
1.1)
that
both
sides
have
the
same
curvature.
Thus,
by
Chapter
IV,
Proposition
4.3,
it
follows
that
these
two
metrized
line
bundles
are
isomorphic.
(Indeed,
it
is
easy
to
check
that
the
constant
â€œCâ€
in
Chapter
IV,
Proposition
4.3,
may
be
taken
to
be
zero
in
this
case).
In
particular,
it
follows
that
LH
diï¬€ers
from
OEâˆH
,S
([eEâˆH
,S
])
by
a
metrized
line
bundle
on
EâˆH
,S
whose
(m
Â·
d)-th
power
is
trivial.
But,
in
the
language
of
Chapter
V,
Â§4,
if
we
think
of
EH
here
as
the
curve
â€œEâ€
of
Chapter
V,
Â§4,
then
this
amounts
to
saying
that
LH
is
the
same
as
the
â€œstandard
line
bundle
LE
â€
of
Chapter
V,
Â§4,
twisted
by
some
appropriate
character
Ï‡L
of
order
â€œnâ€
where
we
take
the
â€œnâ€
of
Chapter
V,
Â§4,
to
be
N
=
2m
Â·
d,
relative
to
the
notation
used
here.
This
character
Ï‡L
falls
into
one
of
the
three
â€œCasesâ€
treated
in
Chapter
V,
Â§4.
We
take
XÎ¹
âˆˆ
{I,
II,
III}
to
be
the
â€œCaseâ€
that
Ï‡L
falls
under
(cf.
Chapter
V,
Theorem
4.6).
Now
let
def
1
(aÎ¹
)jâˆ’1
=
d
Â·
cj
Â·
log(q)
(where
cj
is
as
in
Chapter
V,
Â§4),
and
apply
Chapter
V,
Theorem
4.6.
Note
that
the
â€œqâ€
N
of
Chapter
V,
Â§4,
which
we
write
qCh.
V,Â§4
,
is
such
that
qCh.
is
the
q-invariant
of
E,
V,Â§4
which
corresponds
to
EH
in
the
present
discussion.
Since
the
q-invariant
qEH
of
EH
is
1
equal
to
q
d
,
we
thus
see
that
1
N
q
d
=
qEH
=
qCh.
V,Â§4
Thus,
the
various
adjustments
of
integral
structure
used
to
form
the
{v,
et}-push-forward
are
of
the
form
exp((aÎ¹
)jâˆ’1
)
=
q
d
Â·cj
=
qEjH
=
q
c
1
N
Â·cj
Ch.
V,Â§4
Note,
moreover,
that
cj
=
Maxj0
â‰¤j
(cj0
)
(where
j0
ranges
over
all
integers
â‰¤
j
which
are
admissible
as
â€œj0
â€™sâ€
for
Chapter
V,
Theorem
4.6,
and
we
deï¬ne
the
â€œMaxâ€
of
the
empty
set
to
be
0).
Note
that
Chapter
V,
Theorem
4.6,
addresses
the
case
of
â€œtorsorial
degreeâ€
(cf.
Chapter
III,
Deï¬nition
2.2)
<
j
and
states
that
in
this
case,
there
exist
generators
of
the
portion
of
the
â€œusualâ€
pushforward
(i.e.,
without
the
{vÎ¹
})
corresponding
to
torsorial
degrees
j0
âˆ’
1,
.
.
.
,
j
âˆ’
1
which
1
vanish
modulo
exp((aÎ¹
)j0
âˆ’1
)
=
q
d
Â·cj
when
restricted
to
the
canonical
section
derived
from
Îº
over
(EH
)S
.
Moreover,
if
j0
is
the
largest
â€œadmissible
j0
â€
(for
Chapter
V,
Theorem
4.6)
210
which
is
â‰¤
j,
then
exp((aÎ¹
)j

)
=
exp((aÎ¹
)j0
âˆ’1
),
for
all
j
âˆˆ
{j0
âˆ’
1,
.
.
.
,
j
âˆ’
1}.
Thus,
if
we
divide
these
generators
by
exp((aÎ¹
)j0
âˆ’1
),
we
see
that
we
get
integral
sections
of
the
(aÎ¹
)jâˆ’1
-push-forward.
In
particular,
we
see
that
for
this
choice
of
(aÎ¹
)jâˆ’1
,
the
natural
projections
(F
j
/F
jâˆ’1
)((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{(aÎ¹
)jâˆ’1
,
et})
âˆ’â†’
1
Â·
exp(âˆ’(aÎ¹
)jâˆ’1
)
Â·
(fS
)âˆ—
(L|Eâˆ,S
)
âŠ—OS
Ï„EâŠ—jâˆ’1
(j
âˆ’
1)!
are
surjective,
as
desired.
This
completes
the
proof
of
the
local
assertions.
Reduction
to
the
Computation
of
Degrees:
Let
us
now
return
to
our
global,
universal,
characteristic
zero
S.
Next,
let
us
observe
that,
by
Chapter
V,
Theorems
5.6
and
6.2,
it
follows
from
the
fact
that
m
does
not
divide
d
(so
d
Â·
Î·
=
0)
that
in
the
present
universal
situation,
the
evaluation
map
of
Chapter
V,
Proposition
2.2,
is
an
isomorphism
over
the
generic
point
of
S.
Thus,
now
that
we
have
shown
that
the
evaluation
map
factors
as
stated,
to
show
that
Î{v,
et}
is
an
isomorphism
over
all
of
S,
it
will
suï¬ƒce
to
compute
the
degrees
of
the
metrized
vector
bundles
(of
rank
d2
)
on
both
sides,
and
show
that:
deg(domain)
â‰¥
deg(range)
Note,
moreover,
that:
The
surjectivity
assertion
of
(2)
(proven
above)
is
necessary
in
order
to
bound
from
below
the
degree
of
the
{v,
et}-push-forward
(for
v
=
âˆ)
by
the
sum
of
the
degrees
of
the
various
exp(âˆ’(aÎ¹
)jâˆ’1
)
Â·
(fS
)âˆ—
(L|Eâˆ,S
)
âŠ—OS
Ï„EâŠ—jâˆ’1
.
It
turns
out
that
the
computation
of
the
degree
diï¬€ers
quite
substantially,
depending
on
whether
d
is
odd
or
even.
Thus,
in
the
following
we
carry
out
the
computations
in
these
two
cases
separately.
Computation
of
the
Degree
in
the
Odd
Case:
To
complete
the
proof
of
Theorem
3.1
for
d
odd,
it
suï¬ƒces
(as
noted
above)
to
show
that
in
the
situation
discussed
above,
the
degree
of
the
domain
of
Î{v,
et}
is
â‰¥
the
degree
of
the
range.
Let
us
ï¬rst
observe
that
Chapter
V,
Proposition
1.2,
implies
that:
The
degree
of
the
range
of
Î{v,
et}
is
equal
to
0.
211
Thus,
it
remains
to
show
that
the
degree
of
the
{v,
et}-push-forward
(for
v
=
âˆ)
is
â‰¥
0.
First,
let
us
note
that
the
surjectivity
assertion
already
proven
implies
that:
deg(vâˆ’push
âˆ’
forward)
âˆ’
deg(usual
push
âˆ’
forward)
â‰¥
d
Â·
dâˆ’1

Î¹
=
d

Î¹
=
(aÎ¹
)j
j=0
cj
(Case
XÎ¹
)
j=1
1
d(d2
âˆ’
1)
24
(in
log(q)
units),
where:
(1)
In
the
ï¬rst
inequality,
the
extra
factor
of
d
out
in
front
arises
from
the
fact
that
the
push-forward
of
the
metrized
line
bundle
L
on
Eâˆ,S
has
rank
d.
(2)
In
the
last
equality,
we
apply
Chapter
V,
Lemma
4.2.
On
the
other
hand,
the
usual
push-forward
admits
a
ï¬ltration
(by
torsorial
degree)
whose
subquotients
are
Ï„EâŠ—j
âŠ—OS
(fS
)âˆ—
(L|Eâˆ,S
),
for
j
=
0,
.
.
.
,
d
âˆ’
1.
Since
the
line
bundle
Ï„E
on
1
S
has
degree
(in
log(q)
units)
given
by
âˆ’
12
(cf.
the
proof
of
Chapter
IV,
Theorem
5.8),
we
thus
obtain
that
the
degree
of
the
usual
push-forward
is
given
by:
dâˆ’1
d

1
j)
+
d
Â·
deg((fS
)âˆ—
(L|Eâˆ,S
))
=
âˆ’
d(d2
âˆ’
1)
âˆ’
Â·(
12
j=0
24
(cf.
the
Remark
following
Chapter
V,
Proposition
1.1).
Thus,
putting
everything
together,
we
obtain
that
the
{v,
et}-push-forward
has
degree
â‰¥
0,
as
desired.
This
completes
the
proof
of
the
fact
that
Î{v,
et}
is
an
isomorphism
for
v
=
âˆ.
It
also
shows
that
the
natural
inclusions
of
(2)
F
j
((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{(aÎ¹
)jâˆ’1
})
âŠ†
F
j
((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ})
are
all
equalities
(for
if
any
one
of
them
were
not
an
inequality,
it
would
follow
that
the
degree
of
the
domain
of
Î{âˆ}
is
>
the
degree
of
the
range,
which
is
absurd).
(Note
that
here
we
use
the
fact
that
the
function
j
â†’
(aÎ¹
)j
is
â€œmonotone
increasingâ€
(i.e.,
preserves
the
relation
â€œâ‰¤â€).)
This
completes
the
proof
of
Theorem
3.1,
for
d
odd.
212
Computation
of
the
Degree
in
the
Even
Case:
In
the
even
case,
the
computations
become
somewhat
more
complicated.
First,
let
us
note
that
by
Chapter
V,
Proposition
1.2,
we
have:
deg(range)
=
âˆ’d

Î¹
=
âˆ’d

Î¹
1
Ï†1
(âˆ’d
Â·
Î·Î¹
+
)
2
1
{Ï†1
(âˆ’d
Â·
Î·Î¹
+
)
âˆ’
Ï†1
(âˆ’d
Â·
Î·Î¹
)}
2
where
we
note
that:
(1)
The
intersection
number
of
Chapter
V,
Proposition
1.2,
must
be
multiplied
by
d2
,
since
we
have
d2
torsion
points
annihilated
by
d.
(2)
In
the
second
line,
the
sum
over
all
Î¹
of
the
second
term
is
zero,
since
m
does
not
divide
d
â€“
cf.
the
(proof
of
the)
odd
part
of
Chapter
V,
Proposition
1.2.
Next,
observe
that
for
|Î¸|
â‰¤
12
,
the
function
Î¸
â†’
Ï†1
(Î¸
+
12
)
âˆ’
Ï†1
(Î¸)
is
linear,
except
at
0
and
12
(cf.
Chapter
IV,
Corollary
4.5),
and
takes
the
value
âˆ’
18
(respectively,
18
)
at
Î¸
=
0
(respectively,
Î¸
=
12
)
â€“
cf.
Chapter
IV,
Proposition
4.4.
It
is
easy
to
see
that
these
properties
determine
this
function
uniquely,
namely:
1
1
1
Ï†1
(Î¸
+
)
âˆ’
Ï†1
(Î¸)
=
|Î¸|
âˆ’
2
2
8
for
|Î¸|
â‰¤
12
.
On
the
other
hand,
we
have

1
cj
(Case
XÎ¹
)
deg(domain)
â‰¥
âˆ’
d(d2
âˆ’
1)
+
24
Î¹
j=1
d


1
cj
(Case
XÎ¹
)
+
cd
(Case
XÎ¹
)
=
âˆ’
d(d2
âˆ’
1)
+
24
Î¹
j=1
Î¹
dâˆ’1

1
1
d(d2
âˆ’
1)
+
(d
âˆ’
1)((d
âˆ’
1)2
âˆ’
1)
+
cd
(Case
XÎ¹
)
24
24
Î¹

1
d(d
âˆ’
1){âˆ’(d
+
1)
+
d
âˆ’
2}
+
cd
(Case
XÎ¹
)
=
24
Î¹

1
cd
(Case
XÎ¹
)
=
âˆ’
d(d
âˆ’
1)
+
8
Î¹
=âˆ’
213
where:
(1)
The
ï¬rst
line
follows
by
the
same
general
reasoning
as
in
the
odd
case.
(2)
The
third
line
follows
from
the
computation
of
the
sum
of
the
cj
â€™s
in
the
odd
case,
applied
to
the
odd
number
d
âˆ’
1.
Thus,
to
summarize,
we
would
like
to
prove
that


1
1
1
âˆ’
k(k
âˆ’
)
+
c2k
(Case
XÎ¹
)
â‰¥
âˆ’d
{Ï†1
(âˆ’d
Â·
Î·Î¹
+
)
âˆ’
Ï†1
(âˆ’d
Â·
Î·Î¹
)}
2
2
2
Î¹
Î¹
def
where
we
set
k
=
d2
.
Now,
for
each
Î¹,
we
would
like
to
deï¬ne
a
number
iÎ¹
,
as
follows.
If
XÎ¹
=
I
(i.e.,
we
are
in
Case
I
at
Î¹),
then
let
def
iÎ¹
=
m
Â·
d
=
mCh.
V,Â§4
(i.e.,
â€œm
Â·
dâ€
in
the
notation
of
the
present
discussion
corresponds
to
â€œmâ€
in
the
notation
of
Chapter
V,
Â§4
(=
mCh.
V,Â§4
)
â€“
cf.
the
discussion
of
the
â€œLocal
Assertionsâ€
part
of
the
proof).
If
XÎ¹
=
II,
then
let
def
iÎ¹
=
0
If
XÎ¹
=
III,
then
let
def
iÎ¹
=
|iÏ‡
|
(where
|iÏ‡
|
<
mCh.
V,Â§4
is
as
in
the
discussion
of
Case
III
in
Chapter
V,
Â§4).
Then
let
us
observe
that
it
follows
immediately
from
the
explicit
formulas
for
cd
(Case
XÎ¹
)
in
Chapter
V,
Â§4,
that
we
have
cd
(Case
XÎ¹
)
=
1
2
1
1
iÎ¹
iÎ¹
=
k(k
âˆ’
)
k
âˆ’
kÂ·
2
2
mCh.
V,Â§4
2
mCh.
V,Â§4
(where
we
use
here
the
fact
that
d
=
2k
is
even).
Thus,
we
see
that
the
left-hand
side
of
the
inequality
that
we
would
like
to
show
may
be
written
as
follows:

1
1

1
1
1

1
iÎ¹
iÎ¹
iÎ¹
)=
)=âˆ’
âˆ’1)
âˆ’
k(kâˆ’
)+
k(kâˆ’
k(
âˆ’
d(2
2
2
2
m
2
2
m
8
m
Ch.
V,
Â§
4
Ch.
V,
Â§
4
Ch.
V,
Â§
4
Î¹
Î¹
Î¹
214
(where
we
note
that
in
our
conventions,
the
â€œsumsâ€
over
Î¹
are
â€œto
be
in
log(q)
units,â€
hence
amount,
in
fact,
to
averages;
thus,
a
sum
over
Î¹
of
a
constant
C
is
equal
to
the
constant
C
itself).
Thus,
by
dividing
by
âˆ’d,
we
see
that
it
suï¬ƒces
to
show
that

1
Î¹
(
2iÎ¹
8
mCh.
V,Â§4
âˆ’
1)
=

1
1
(
|Î¸Î¹
|
âˆ’
)
2
8
Î¹
where
Î¸Î¹
is
the
unique
rational
number
of
absolute
value
â‰¤
12
that
deï¬nes
the
same
element
as
âˆ’d
Â·
Î·Î¹
in
S1Î¹
.
In
particular,
it
suï¬ƒces
to
verify
that
iÎ¹
1
=
|Î¸Î¹
|
2
mCh.
V,Â§4
for
each
Î¹.
But
if
one
unravels
the
deï¬nitions,
it
is
easy
to
see
that
this
is
essentially
a
tautology:
Indeed,
it
follows
from
the
even
part
of
Chapter
IV,
Lemma
5.4,
that
the
character
Ï‡L
of
Chapter
V,
Â§4,
is
precisely
that
determined
by
the
torsion
point
âˆ’d
Â·
Î·Î¹
+
12
of
S1Î¹
,
i.e.,
Ï‡L
â†â†’
âˆ’d
Â·
Î·Î¹
+
1
2
On
the
other
hand,
it
follows
from
the
deï¬nitions
of
Chapter
V,
Â§4,
that
Â±
2m
iÎ¹
precisely
the
â€œcoordinateâ€
on
S1Î¹
corresponding
to
the
character
Ï‡M
,
i.e.,
Ï‡M
â†â†’
Â±
Â§
is
Ch.
V,
4
iÎ¹
2mCh.
V,Â§4
Moreover,
the
character
Ï‡M
is
the
result
of
shifting
the
character
Ï‡L
by
the
character
deï¬ned
by
12
:
Ï‡M
âŠ—
Ï‡L
âˆ’1
â†â†’
1
2
Thus,
putting
everything
together,
the
two
â€œ
21
â€™sâ€
cancel,
and
we
see
that
the
rational
(â‰¤
12
)
deï¬nes
the
same
element
(up
to
sign)
as
âˆ’d
Â·
Î·Î¹
in
S1Î¹
,
hence
is
number
2m
iÎ¹
Ch.
V,Â§4
equal
to
|Î¸Î¹
|,
as
desired.
This
completes
the
proof
of
the
fact
that
Î[âˆ]
is
an
isomorphism
in
the
case
of
d
even.
The
fact
that
the
natural
inclusions
of
Theorem
3.1,
(2),
are,
in
fact,
equalities
follows
by
the
same
argument
as
in
the
odd
case.
Thus,
the
proof
of
Theorem
3.1
is
complete.

Remark.
One
may
regard
the
computation
of
the
sequences
aÎ¹
in
Theorem
3.1,
(2),
(3),
such
that
the
natural
inclusions
and
natural
projections
of
(2)
are
surjective
as
a
computation
215
of
the
analytic
torsion
of
the
{v,
et}-push
forwards
(i.e.,
the
push-forwards
equipped
with
the
new
integral
structure/metric
deï¬ned
at
the
beginning
of
this
Â§).
This
point
of
view
is
very
much
in
line
with
what
we
will
do
in
Chapter
VII,
Chapter
VIII,
where
we
compute
analogous
analytic
torsion-type
quantities
at
the
archimedean
primes
of
a
number
ï¬eld.
Â§4.
The
Comparison
Isomorphism
in
Mixed
Characteristic
In
this
Â§,
we
prove
the
Comparison
Isomorphism
in
Mixed
Characteristic.
Put
another
way,
we
show
in
this
Â§
that
the
characteristic
zero
isomorphism
of
Â§3,
Theorem
3.1,
(2),
preserves
certain
natural
integral
structures
(at
all
ï¬nite
primes)
on
both
sides.
In
this
Â§,
we
shall
continue
to
use
the
notations
of
Â§3.
The
following
result
is
the
main
result
of
this
Chapter:
Theorem
4.1.
(Comparison
Isomorphism
in
Mixed
Characteristic)
Let
d,
m
â‰¥
1
be
integers
such
that
m
does
not
divide
d.
Suppose
that
S
log
is
a
ï¬ne
noetherian
log
scheme,
and
let
C
log
â†’
S
log
be
a
log
elliptic
curve
over
S
log
such
that
the
â€œdivisor
at
inï¬nityâ€
D
âŠ†
S
(i.e.,
the
pullback
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
via
the
classifying
morphism
S
â†’
(M1,0
)Z
)
is
a
Cartier
divisor
on
S.
Also,
let
us
assume
that
eÌtale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root,
and
that
we
are
given
a
torsion
point
Î·
âˆˆ
Eâˆ,S
(Sâˆ
)
ev
of
order
precisely
m
which
deï¬nes
line
bundles
Lst,Î·
,
Lst,Î·
(cf.
Chapter
V,
Â§1).
If
d
is
odd
def
def
ev
(respectively,
even),
then
let
L
=
Lst,Î·
(respectively,
L
=
Lst,Î·
).
Then:
(1)
(Compatibility
with
Base-Change)
For
any
collection
v
=
{vÎ¹
}Î¹
of
elements
of
Qâ‰¥0
Â·
log(q)
âˆ
(one
for
each
connected
component
Î¹
of
the
divisor
at
inï¬nity
D)
such
that
for
each
Î¹,
vÎ¹
â‰¥
(aÎ¹
)dâˆ’1
(notation
of
Theorem
3.1,
(3)),
the
formation
of
the
push-forward
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
216
)<d
{v,
et}
(along
with
its
ï¬ltration)
commutes
with
base-change
(among
bases
S
log
satisfying
the
hypotheses
given
above).
(2)
(Zero
Locus
of
the
Determinant)
Assume
that
S
is
Z-ï¬‚at.
If
vÎ¹
=
âˆ
for
all
Î¹,
then
the
scheme-theoretic
zero
locus
of
det(Î{v,
et}),
i.e.,
the
determinant
of
the
morphism
Î{v,
et}
:
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{v,
et}
â†’
(fS
)âˆ—
(L|
â€ 
)
(d
Eâˆ
)
of
Theorem
3.1,
(1),
is
given
by
the
divisor
d
Â·
[Î·

(d
E)]
(where
d
E
is
the
kernel
of
multiplication
by
d
on
Ed
).
In
fact,
the
divisor
of
poles

of
the
inverse
morphism
to
Î{v,
et}
is
contained
in
the
divisor
[Î·
(d
E)].
(3)
(Analytic
Torsion
Properties)
For
each
Î¹,
let
us
write
aÎ¹
=
{(aÎ¹
)0
,
.
.
.
,
(aÎ¹
)dâˆ’1
}
for
the
sequence
of
elements
of
Qâ‰¥0
Â·
log(q)
discussed
in
Theorem
3.1,
(2),
(3).
Then
the
natural
inclusions
F
j+1
((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{(aÎ¹
)j
,
et})
âŠ†
F
j+1
((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et})
are
all
equalities
and
the
natural
projections
(F
j+1
/F
j
)((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{(aÎ¹
)j
,
et})
âˆ’â†’
1
Â·
exp(âˆ’(aÎ¹
)j
)
Â·
(fS
)âˆ—
(L|Eâˆ,S
)
âŠ—OS
Ï„EâŠ—j
j!
(where
j
=
0,
.
.
.
,
d
âˆ’
1)
are
bijective.
Moreover,
the
sections
of
L|
â€ 
Eâˆ,[d]
that
realize
these
bijections
have
q-expansions
in
a
neighborhood
of
inï¬nity
that
are
given
explicitly
in
Chapter
V,
Theorem
4.8.
217
Remark.
Relative
to
the
bound
on
the
poles
of
the
inverse
morphism
to
Î{v,
et}
(i.e.,
Theorem
4.1,
(2)),
we
remark
that
these
denominators
tend
to
be
very
small.
Indeed,
typically
an
intersection
between
torsion
points
will
look
like
the
zero
locus
of
some
1
âˆ’
Ï‰,
where
Ï‰
is
a
root
of
unity.
In
fact,
by
taking
m
to
have
at

least
two
prime
factors
that
do
not
divide
d,
it
is
easy
to
see
that
one
can
arrange
that
Î·
(d
E)
=
âˆ….
Remark.
Note
that
compatibility
with
base-change
is
extremely
important
for
applications.
For
instance,
base-change
from
(M1,0
)Z
to
a
point
of
(M1,0
)Z
valued
in
the
ring
of
integers
of
a
number
ï¬eld
is
a
typical
case
of
a
situation
where
one
must
use
the
â€œfull
powerâ€
of
compatibility
with
base-change.
Remark.
The
poles
â€œexp(âˆ’(aÎ¹
)j
)â€
appearing
in
Theorem
4.1,
(3),
are
clearly
of
fundamental
importance
in
Theorems
3.1
and
4.1,
and
indeed,
of
fundamental
importance
to
this
entire
paper.
We
shall
refer
to
these
poles
as
Gaussian
poles,
since
they
grow
roughly
like
a
Gaussian
(i.e.,
(aÎ¹
)j
is
roughly
quadratic
in
j).
Proof.
First,
let
us
observe
that
once
one
proves
the
base-change
assertion
(1),
assertions
(2)
and
(3)
will
follow
as
soon
as
they
have
been
proven
in
the
â€œuniversal
caseâ€
â€“
i.e.,
say,
for
S
regular
of
dimension
2
such
that
the
classifying
morphism
S
â†’
(M1,0
)Z
is
ï¬‚at.
But
in
this
â€œuniversal
case,â€
assertion
(3)
already
follows
from
Theorem
3.1,
(2).
Also,
in
the
â€œuniversal
case,â€
assertion
(2)
follows
from
Theorem
3.1,
(2),
and
Chapter
V,
Theorem
6.2.
Indeed,
both
the
domain
and
range
of
Î{v,
et}
are
vector
bundles
of
the
same
rank
over
a
two-dimensional
regular
base
(cf.
Lemma
2.1),
so
the
scheme-theoretic
zero
locus
of
the
determinant
of
Î{v,
et}
is
known
as
soon
as
it
is
known
at
the
height
1
primes.
But
at
the
height
1
primes,
the
zero
locus
of
det(Î{v,
et})
is
known
by
Theorem
3.1,
(2),
and
Chapter
V,
Theorem
6.2.
Thus,
in
summary,
to
complete
the
proof
of
Theorem
4.1,
it
suï¬ƒces
to
prove
assertion
(1)
under
the
hypothesis
that
assertions
(2)
and
(3)
are
known
in
the
â€œuniversal
case.â€
On
the
other
hand,
by
what
we
did
in
Â§2,
we
know
that
assertion
(1)
holds
away
from
the
divisor
at
inï¬nity.
Thus,
by
Lemma
2.3,
it
suï¬ƒces
to
prove
compatibility
with
base-change
in
the
special
case
where
S
is
regular
of
dimension
2,
and
the
classifying
morphism
S
â†’
(M1,0
)Z
is
ï¬nite
and
ï¬‚at
(cf.
the
theory
of
[KM],
Chapter
5).
Let
O
be
the
normalization
of
Z
in
S.
Then
we
may
even
assume
that
the
ï¬bers
of
S
â†’
Spec(O)
are
geometrically
reduced,
and
even
smooth
near
inï¬nity.
Indeed,
by
ï¬‚atness
over
(M1,0
)Z
,
it
suï¬ƒces
to
check
this
near
inï¬nity,
where
S
may
be
taken
to
be
such
that
its
completion
at
inï¬nity
is
the
spectrum
of
1
O[[q
M
]]
for
some
positive
integer
M
.
In
fact,
Lemma
2.3
tells
us
that
it
suï¬ƒces
to
prove
compatibility
with
base-change
for
the
particular
base-change
218
S
Ã—O
Spec(O/p)
â†’
S
where
p
is
an
arbitrary
maximal
prime
of
O.
In
the
following,
we
will
denote
the
result
of
def
base-changing
objects
via
O
â†’
k
=
O/p
by
means
of
a
subscript
k.
Next,
let
us
observe
that
the
morphism
â€œfâˆ—
(F
âŠ—OC

P)âŠ—OS
A
â†’
fâˆ—
(F
âŠ—OC

P
âŠ—OS
A)â€
d
d
studied
in
Â§2
is
always
injective.
Indeed,
this
follows
from
the
fact
that
both
sides
inject
into
their
restrictions
to
US
=
S\D,
where
they
are
equal.
Thus,
compatibility
with
basechange
issues
amount
to
the
surjectivity
of
the
â€œÎ¼N
-invariant
part
ofâ€
(terminology
of
Â§2)
this
morphism.
Thus,
in
summary,
it
suï¬ƒces
to
show
that
the
morphism
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<j
{v,
et}
âŠ—O
k
â†’
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
âŠ—O
k)<j
{v,
et}
is
surjective
for
all
j
=
1,
.
.
.
,
d.
Let
us
write
Rj
(respectively,
Dj
;
Ij
)
for
the
range
(respectively,
domain;
image)
of
this
morphism.
Note
that
Rj
,
Dj
,
and
Ij
are
all
vector
bundles
on
Sk
.
Indeed,
this
is
clear
away
from
inï¬nity;
near
inï¬nity,
it
follows
from
the
fact
that
Sk
is
smooth
over
k
near
inï¬nity.
Thus,
we
have
an
inclusion
Ij
âŠ†
Rj
of
vector
bundles
on
Sk
which
is
an
equality
away
from
inï¬nity.
We
wish
to
show
that
this
inclusion
is
an
equality
over
all
of
Sk
.
Now
let
us
suppose
that:
Id
=
Rd
Then
I
claim
that
it
follows
that
Ij
=
Rj
for
all
j
=
1,
.
.
.
,
d.
Indeed,
this
follows
by
considering
degrees,
as
in
the
proof
of
Theorem
3.1.
That
is
to
say,
the
fact
that
the
natural
projections
of
(3)
are
surjective
(over
S),
combined
with
the
fact
that
the
push-forward
(fS
)âˆ—
(L|Eâˆ,S
)
commutes
with
base-change
(cf.
the
last
part
of
Lemma
2.2),
implies
that
if
there
were
a
single
j
such
that
Ij
=
Rj
=
F
j
(Rd
),
then
summing
up
over
the
various
(F
j
/F
jâˆ’1
)(Rd
)â€™s
and
Ij
/Ijâˆ’1
â€™s,
we
obtain
that
219
deg(Rd
)
>
d


Î¹
{d
Â·
(aÎ¹
)jâˆ’1
+
deg((fS
)âˆ—
(L|Eâˆ,S
âŠ—OS
Ï„EâŠ—jâˆ’1
))}
j=1
=
deg((fS
)âˆ—
(L|
â€ 
)<j
{v,
et}
âŠ—O
Q)
=
deg((fS
)âˆ—
(L|
â€ 
)<j
{v,
et}
âŠ—O
k)
Eâˆ,[d]
Eâˆ,[d]
=
deg(Dd
)
=
deg(Rd
)
(where
the
ï¬rst
equality
follows
from
Theorem
3.1,
(2);
the
second
equality
follows
from
the
fact
that
the
degree
of
a
vector
bundle
on
S
is
locally
constant
over
Spec(O);
the
third
equality
follows
from
the
deï¬nition
of
Dd
;
and
the
fourth
equality
follows
from
the
assumption
Id
=
Rd
).
Thus,
we
get
a
contradiction;
this
completes
the
proof
of
the
claim.
Thus,
it
suï¬ƒces
to
prove
that
Id
=
Rd
Since
this
assertion
is
local
at
inï¬nity,
we
will
assume
in
the
rest
of
the
proof
that
1
S
=
Spec(O[[q
M
]])
for
some
positive
integer
M
.
To
conclude
that
Id
=
Rd
,
we
would
like
to
use
the
fact
that
Î{v,
et}
is
an
isomorphism
over
S
(by
(2)
in
the
â€œuniversal
caseâ€),
so
long
as
Î·
does
not
intersect
d
E.
Now
of
course,
in
the
case
under
consideration
Î·
might
intersect
d
E.
Note,
however,
that
if
we
modify
Î·
by
some
torsion
point
Î·Î´
âˆˆ
Ed
(S)
whose
restriction
to
the
special
ï¬ber
of
Ed
lies
in
the
same
connected
component
as
that
of
the
identity,
then
this
problem
can
be
avoided.
Note
that
(after
possibly
enlarging
O)
such
an
Î·Î´
always
exists
(since
we
have
localized
near
inï¬nity).
Moreover,
we
may
even
assume
that
Î·Î´
is
def
such
that
Î·
=
Î·
+
Î·Î´
does
not
intersect
d
E.
Next,
note
that,
by
(2)
in
the
â€œuniversal
case,â€
the
â€œÎ{v,
et}â€
corresponding
to
such
an
Î·
is
an
isomorphism.
Since
in
fact,
we
are
interested
in
the
situation
with
the
original
Î·,
we
observe
that
(by
translating
by
âˆ’Î·Î´
)
we
can
interpret
the
fact
that
we
get
an
isomorphism
when
Î·
is
replaced
by
Î·
as
saying
that
the
evaluation
map
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{v,
et}
â†’
(fS
)âˆ—
(L|
â€ 
â€ 
)
(âˆ’Î·Î´
+d
Eâˆ
)
â€ 
â€ 
(where
Î·Î´
is
the
natural
lifting
of
Î·Î´
to
Eâˆ,[d]
)
is
an
isomorphism.
Tensoring
with
k,
we
thus
obtain
that
the
evaluation
map
220
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{v,
et}
âŠ—O
k
=
Dd
â†’
(fS
)âˆ—
(L|
â€ 
â€ 
âŠ—O
k)
(âˆ’Î·Î´
+d
Eâˆ
)
is
an
isomorphism
(since
push-forwards
for
ï¬nite
morphisms
always
commute
with
basechange).
But
this
morphism
clearly
factors
through
Rd
(since
sections
of
(L
âŠ—OEâˆ,S
Retâ€ 
Eâˆ,[d]
{v})
âŠ—O
k
â€ 
â€ 
over
Eâˆ,S
âŠ—O
k
can
always
be
restricted
to
(âˆ’Î·Î´
+
d
Eâˆ
)
âŠ—O
k).
In
other
words,
the
morphism
Dd
â†’
Rd
is
bijective,
so
Id
=
Rd
,
as
desired.
This
completes
the
proof
of
Theorem
4.1.

Remark.
In
fact,
compatibility
of
base-change,
i.e.,
Theorem
4.1,
(1),
may
itself
be
regarded
as
a
sort
of
â€œanalytic
torsion
property.â€
Thus,
it
is
not
surprising
that
the
proof
of
Theorem
4.1,
(1),
makes
essential
use
of
Theorem
4.1,
(3),
in
the
â€œuniversal
case.â€
Bibliography
[Harts]
R.
Hartshorne,
Algebraic
Geometry,
Graduate
Texts
in
Mathematics
52,
Springer
(1977).
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
University
Press
(1985).
[Mats]
H.
Matsumura,
Commutative
Algebra
(Second
Edition),
The
Benjamin/Cummings
Publishing
Company
(1980).
[SGA2]
A.
Grothendieck
et
al.,
Cohomologie
locale
des
faisceaux
coheÌrents
et
theÌoreÌ€mes
de
Lefshetz
locaux
et
globaux,
North-Holland,
Amsterdam
(1968).
221
Chapter
VII:
The
Geometry
of
Function
Spaces:
Systems
of
Orthogonal
Functions
Â§0.
Introduction
The
purpose
of
the
present
Chapter
is
to
prepare
for
the
discussion
of
the
Arakelovtheoretic
extension
of
the
theory
of
Chapter
VI
in
Chapter
VIII
by
developing
the
theory
of
systems
of
orthogonal
functions
in
the
form
in
which
we
will
use
it
in
this
paper.
Such
systems
of
orthogonal
functions
are
central
to
the
archimedean
portion
of
the
theory
of
this
paper.
The
reason
for
this
is
that
the
main
result
of
this
paper,
i.e.,
the
comparison
isomorphism
between
â€œde
Rham
functionsâ€
(i.e.,
functions
on
the
universal
extension
of
an
elliptic
curve,
which
is
a
sort
of
de
Rham
cohomology
group
of
the
elliptic
curve)
and
â€œeÌtale
functionsâ€
(i.e.,
functions
on
the
torsion
points
of
the
elliptic
curve)
is,
after
all,
an
isomorphism
between
function
spaces.
To
consider
such
function
spaces
in
an
Arakelovtheoretic
context
thus
amounts
to
considering
such
function
spaces
equipped
with
some
metric.
Thus,
in
order
to
develop
the
natural
Arakelov-theoretic
extension
of
the
theory
of
Chapter
VI,
we
must
study
the
relationship
between
the
natural
metrics
induced
from
the
de
Rham
and
eÌtale
sides
of
the
comparison
isomorphism.
Because
function
spaces
tend
to
be
rather
large
and
unwieldy,
in
order
to
study
their
geometry
as
metrized
spaces,
it
is
of
crucial
importance
to
have
natural
and
explicit
orthonormal
coordinate
systems
at
our
disposal
which
allow
us
to
express
the
diï¬€erence
between
the
geometries
induced
by
diï¬€erent
metrics
in
a
precise
and
quantitative
fashion.
Such
orthonormal
coordinate
systems
are
provided
by
systems
of
orthogonal
functions.
It
turns
out
that
the
natural
metrics
arising
from
the
de
Rham
and
eÌtale
sides
of
the
comparison
isomorphism
are
rather
alien
in
nature
to
one
another.
It
is
thus
diï¬ƒcult
to
compare
them
to
one
another
directly.
Thus,
in
order
to
interpolate
the
diï¬€erence
between
them,
we
must
introduce
various
intermediate
systems
of
orthogonal
functions.
This
is
the
main
goal
of
the
present
Chapter.
In
Â§1,
we
begin
by
discussing
the
â€œgeneral
nonsenseâ€
aspects
of
the
theory
of
orthogonal
functions.
In
Â§2,
we
review
the
theory
of
Legendre
and
Hermite
polynomials,
not
only
because
they
are
perhaps
the
most
fundamental
examples
of
orthogonal
functions,
but
also
because
they
play
a
crucial
role
in
the
theory
of
the
comparison
isomorphism
at
the
inï¬nite
prime.
In
Â§3,
we
discuss
the
theory
of
the
â€œdiscrete
Tchebycheï¬€
polynomials,â€
which
are
a
sort
of
discrete
analogue
of
Legendre
polynomials.
These
polynomials
also
play
an
important
role
in
the
theory
of
this
paper.
In
Â§4,
we
discuss
the
metric
arising
from
the
de
Rham
side
of
the
comparison
isomorphism.
Then
in
Â§5,
we
discuss
the
relationship
between
this
geometry
and
the
theory
of
canonical
SchottkyWeierstrass
zeta
functions.
Finally,
in
Â§6,
we
begin
our
study
of
the
geometry
of
the
space
of
canonical
Schottky-Weierstrass
zeta
functions.
The
geometry
of
this
function
space
will
be
studied
further
in
Chapter
VIII.
222
In
fact,
the
introduction
of
various
types
of
canonical
Schottky-Weierstrass
zeta
functions
is
the
ï¬rst
and
most
crucial
step
in
the
interpolation
between
de
Rham
and
eÌtale
metrics
referred
to
above.
One
way
to
think
of
this
interpolation
is
the
following:
The
de
Rham
side
of
the
comparison
isomorphism
involves
functions
on
continuous
spaces,
i.e.,
more
precisely,
on
the
underlying
real
analytic
manifold
â€“
which
we
denote
ER
â€“
of
a
complex
elliptic
curve
E.
On
the
other
hand,
the
eÌtale
side
of
the
comparison
isomorphism
involves
functions
on
some
ï¬nite,
discrete
set
of
torsion
points.
Thus,
in
order
to
develop
an
Arakelov-theoretic
extension
of
the
theory
of
Chapter
VI,
we
must
somehow
bridge
this
gap
between
continuous
and
ï¬nite,
discrete
spaces.
Now
note
that
ER
has
precisely
two
real
dimensions.
The
passage
(Â§5)
from
the
de
Rham-theoretic
function
space
geometry
of
Â§4
to
the
canonical
Schottky-Weierstrass
zeta
function-based
geometry
of
Â§6
â€“
which
is
a
sort
of
function
theory
on
S1
(which
has
precisely
one
real
dimension)
â€“
then
amounts
to
the
discretization
of
one
of
these
two
real
dimensions.
This
discretization,
which
we
refer
to
as
the
ï¬rst
discretization,
turns
out
to
be
the
most
essential.
The
second
discretization,
i.e.,
the
discretization
of
the
remaining
S1
,
will
be
carried
out
in
Chapter
VIII.
Thus,
schematically:
de
Rham-based
function
theory
on
ER
(dim/R
=
2)
â‡“
canonical
Schottky-Weierstrass
zeta
function-based
function
theory
on
S1
(dim/R
=
1)
â‡“
function
theory
of
functions
on
a
discrete
set
of
torsion
points
(dim/R
=
0)
In
some
sense,
this
diagram
represents
the
main
theme
behind
the
theory
of
the
present
and
following
Chapters.
Â§1.
The
Orthogonalization
Problem
In
this
Â§,
we
introduce
the
basic
ideas
and
terminology
surrounding
the
theory
of
systems
of
orthogonal
functions.
We
begin
by
discussing
what
we
call
the
orthogonalization
problem.
That
is
to
say,
given
a
Hilbert
space
equipped
with
a
ï¬ltration
and
an
operator
satisfying
certain
properties,
one
wishes
to
construct
a
corresponding
system
of
orthogonal
elements
of
the
Hilbert
space.
We
then
discuss
various
basic
invariants
that
one
can
associate
to
such
data
â€“
namely,
the
means
and
submeans
of
the
system
(cf.
Deï¬nition
1.1).
When
the
given
operator
is
self-adjoint
up
to
a
constant
multiple,
it
turns
out
that
the
system
of
orthogonal
elements
is
completely
determined
by
a
relatively
small
amount
of
data,
namely,
the
means
and
â€œprincipal
submeansâ€
(cf.
Proposition
1.2).
Finally,
we
discuss
various
examples
of
this
theory.
We
remark
that
the
material
that
we
treat
here
is
223
in
essence
well-known
(cf.,
e.g.,
[Sze],
[Bate]),
but
I
do
not
know
of
a
reference
that
treats
this
material
from
the
point
of
view
that
we
take
here.
We
begin
with
a
Hilbert
space
H
over
a
base
ï¬eld
K,
which
we
assume
to
be
either
R
or
C.
We
will
denote
the
inner
product
on
H
by
(âˆ’,
âˆ’)
and
its
corresponding
norm
by
|
âˆ’
|.
Let
us
assume
that
H
is
equipped
with
a
ï¬ltration
of
(not
necessarily
closed)
K-subspaces:
F
âˆ’1
(H)
=
0
âŠ†
F
0
(H)
âŠ†
F
1
(H)
âŠ†
.
.
.
âŠ†
F
n
(H)
âŠ†
.
.
.
âŠ†
H
where
n
ranges
over
all
integers
<
some
ï¬xed
N
(where
N
âˆˆ
Z
def
n
n
that
the
subquotients
Q
(H)
=
(F
/F
nâˆ’1
âˆ).
Moreover,
we
assume
)(H)
satisfy:
dimK
(Qn
(H))
=
1
for
all
0
â‰¤
n
<
N
.
Thus,
in
particular,
if
0
â‰¤
n
<
N
,
dimK
(F
n
(H))
=
n
+
1.
In
the
following,
we
will
write
âˆ
def
F
(H)
=
N
âˆ’1
i
F
(H);
F
âˆâˆ’1
def
(H)
=
i=0
N
âˆ’2
F
i
(H)
i=0
for
the
union
of
all
the
(respectively,
all
but
the
last)
subspace(s)
in
the
ï¬ltration.
Note
that
this
data
of
Hilbert
space
plus
ï¬ltration
already
determines
splittings
of
the
ï¬ltration
n
F
(H)
=
n

Qi
(H)
i=0
(for
0
â‰¤
n
<
N
)
given
by
taking
the
orthogonal
complement
of
F
nâˆ’1
(H)
in
F
n
(H).
Thus,
one
can
think
of
the
Qn
(H)
as
subspaces
of
H.
In
its
most
basic
form,
The
orthogonalization
problem
is
the
problem
of
explicitly
determining
these
splittings
of
the
ï¬ltration
F
âˆ—
(H).
What
does
to
mean
to
â€œexplicitly
determineâ€
the
splittings?
To
give
meaning
to
this
expression,
it
is
typical
to
assume
that
one
is
also
given
a
(K-linear,
but
not
necessarily
continuous)
operator
X
:
F
âˆâˆ’1
(H)
â†’
F
âˆ
(H)
Moreover,
we
assume
that,
for
0
â‰¤
n
<
N
,
X(F
nâˆ’1
(H))
âŠ†
F
n
(H),
and,
moreover,
that
the
induced
morphism
224
Qnâˆ’1
(H)
â†’
Qn
(H)
is
an
isomorphism.
Put
another
way,
if
F
0
(H)
=
K
Â·
,
then
F
n
(H)
=
{Ï†(X)
Â·
}
where
Ï†(X)
ranges
over
all
polynomials
in
X
with
coeï¬ƒcients
in
K
of
degree
â‰¤
n.
Thus,
if
one
is
given
such
an
operator
X,
then
it
makes
sense
to
ask:
Can
one
explicitly
determine
some
set
of
polynomials
{Ï†n
(X)}
(where
deg(Ï†n
(X))
=
n;
n
ranges
over
all
nonnegative
integers)
such
that
Ï†n
(X)
Â·

generates
the
one-dimensional
K-subspace
Qn
(H)
âŠ†
H?
This
is
the
form
of
the
orthogonalization
problem
that
will
appear
most
frequently
in
the
present
Chapter.
A
mild
variant
of
this
problem
involves
ï¬nding
Ï†n
(X)
as
above
such
that
Ï†n
(X)
Â·

not
only
generates
Qn
(H),
but
has
norm
equal
to
1.
Let
us
assume
that
the
set
{Ï†n
(X)
Â·
}
is
orthonormal.
Then
we
shall
denote
the
coeï¬ƒcient
of
X
nâˆ’i
in
Ï†n
(X)
by
Îºn,i
âˆˆ
K
(cf.
[Sze],
Theorem
12.7.1).
Thus,
Ï†n
(X)
=
Îºn,0
Â·
X
n
+
Îºn,1
Â·
X
nâˆ’1
+
.
.
.
+
Îºn,n
def
Note
(cf.
[Sze],
Â§12.3)
that
the
number
Î¼n
=
|Îºn,0
|âˆ’2
may
also
be
characterized
as
the
inï¬mum
inf
|Ï†(X)
Â·
|2
Ï†(X)
where
Ï†(X)
=
X
n
+
.
.
.
is
a
polynomial
in
X
(with
coeï¬ƒcients
in
K)
of
degree
n
with
leading
coeï¬ƒcient
equal
to
1.
Note
that
this
inï¬mum
is
attained
for
Ï†(X)
=
Îºâˆ’1
n,0
Â·
Ï†n
(X).
def
Deï¬nition
1.1.
We
shall
refer
to
the
number
Î¼n
=
|Îºn,0
|âˆ’2
as
the
n-th
mean
of
the
data
def
(H,
F
âˆ—
(H),
X).
We
shall
refer
to
the
number
rn,i
=
Îºn,i
/Îºn,0
(for
0
â‰¤
i
â‰¤
n
<
N
)
as
the
((n,
i)-)submean
of
the
data
(H,
F
âˆ—
(H),
X).
The
(n,
1)-submean
will
be
referred
to
as
the
n-th
principal
submean.
Note
that
the
means
and
submeans
are
uniquely
determined
by
the
data
(H,
F
âˆ—
(H),
X).
Moreover,
if
one
knows
the
means
and
submeans
of
this
data,
then
one
can
immediately
reconstruct
the
system
{Ï†n
(X)},
up
to
multiplication
(of
each
Ï†n
(X))
by
an
element
of
K
of
absolute
value
1.
225
The
reason
for
the
terminology
â€œmeansâ€
is
the
following:
In
a
certain
very
basic
and
representative
case
(cf.
Example
(3)
below;
[Sze],
Â§12.3)
involving
polynomials
which
are
orthogonal
with
respect
to
a
given
weight
function
on
the
circle
S1
,
the
zeroth
mean
Î¼0
is,
in
fact,
the
arithmetic
mean
of
the
weight
function
(i.e.,
in
the
notation
of
Example
(3)

2Ï€
1
Â·
0
w(Î¸)
dÎ¸).
Moreover,
in
this
case,
the
higher
means
satisfy
below,
the
quantity
2Ï€
def
Î¼n
â‰¤
Î¼nâˆ’1
(for
all
positive
integers
n)
and
their
limit
Î¼âˆ
=
limnâ†’âˆ
Î¼n
is
the
geometric
mean
of
the
weight
function
(i.e.,
in
the
notation
of
Example
(3)
below,
the
quantity

2Ï€
1
Â·
0
log(w(Î¸))
dÎ¸)).
exp(
2Ï€
One
of
the
most
important
cases
of
the
orthogonalization
problem
is
the
case
where
the
operator
X
is
self-adjoint
up
to
a
constant
multiple,
i.e.,
there
exists
some
ï¬xed
constant
Î±X
âˆˆ
K
such
that
(X
Â·
v,
w)
=
Î±X
Â·
(v,
X
Â·
w),
for
all
v,
w
âˆˆ
F
âˆ
(H).
In
this
case,
the
polynomials
{Ï†n
(X)}
satisfy
a
recurrence
relation:
Proposition
1.2.
Assume
that
the
operator
X
is
self-adjoint
up
to
a
constant
multiple
Î±X
âˆˆ
K.
Then
for
1
â‰¤
n
<
N
âˆ’
1,
we
have
Ï†n+1
(X)
=
(An
X
+
Bn
)
Â·
Ï†n
(X)
âˆ’
Cn
Â·
Ï†nâˆ’1
(X)
where
An
=
Îºn+1,0
/Îºn,0
;
Bn
=
An
Â·
(rn+1,1
âˆ’
rn,1
);
Cn
=
Î±X
Â·
An
/Anâˆ’1
(where
the
bar
denotes
complex
conjugation).
That
is
to
say,
the
polynomials
Ï†n
(X)
are
entirely
determined
by
the
means
and
principal
submeans.
Proof.
The
proof
is
essentially
given
in
[Bate],
pp.
158-9.
In
fact,
[Bate]
only
treats
the
case
where
H
is
some
space
of
real-valued
functions
on
an
interval
(a,
b)
âŠ†
R
equipped
def

b
with
the
norm
(f,
g)
=
a
f
Â·
g
Â·
w
arising
from
some
weight
function
w
on
(a,
b),
and
X
is
the
operator
given
by
multiplying
by
the
standard
coordinate
on
R.
In
fact,
however,
it
is
not
diï¬ƒcult
to
see
that
the
only
properties
of
this
data
that
are
used
in
this
proof
are
the
properties
that
we
have
assumed
here.
For
instance,
to
see
that
(X
Â·Ï†n
(X)Â·,
Ï†(X)Â·)
=
0
for
all
Ï†(X)
of
degree
â‰¤
n
âˆ’
2,
it
suï¬ƒces
to
apply
the
self-adjointness
(up
to
a
constant
multiple)
of
X,
which
implies
that
(Ï†n
(X)
Â·
,
X
Â·
Ï†(X)
Â·
)
=
0
since
X
Â·Ï†(X)
is
of
degree
â‰¤
nâˆ’1.
The
coeï¬ƒcients
An
,
Bn
,
and
Cn
may
then
be
determined
in
the
obvious
fashion
â€“
cf.
[Bate],
pp.
158-9.

We
conclude
this
Â§
by
listing
some
examples
of
the
theory
discussed
so
far.
Some
examples
are
well-known;
others
are
to
be
treated
in
the
present
and
following
Chapters.
226
Examples
of
Orthogonal
Systems:
(1)
Polynomials
on
intervals
of
the
real
line:
Let
(a,
b)
âŠ†
R
be
an
open
interval
in
R
(where
a,
b
âˆˆ
R
{Â±âˆ}).
Write
x
for
the
standard
coordinate
on
R.
Suppose
that
w(x)
is
positive
integrable
function
on
(a,
b).
Then
we
may
form
the
Hilbert
space
L2w
(a,
b)
of
b
K-valued
functions
f
on
(a,
b)
which
satisfy
a
|f
|2
Â·
w
Â·
dx
<
âˆ.
The
inner
product
of
this
Hilbert
space
is
given
by
b
def
f
Â·
g
Â·
w
Â·
dx
(f,
g)
=
a
(where
g
denotes
the
complex
conjugate
of
g).
Let
us
assume
that
for
all
n
â‰¥
0,
xn
âˆˆ
L2w
(a,
b).
Then
if
we
take
def
H
=
L2w
(a,
b);
def
F
n
(H)
=
{cn
xn
+
.
.
.
+
c1
x
+
c0
|
c0
,
.
.
.
,
cn
âˆˆ
K};
def
X
=
xÂ·
(i.e.,
X
is
the
self-adjoint
operator
given
by
multiplication
by
x),
we
obtain
data
as
in
def
the
above
discussion.
The
resulting
Ï†n
(x)
=
Ï†n
(X)
Â·
1â€™s
are
thus
orthonormal
with
respect
to
the
weight
function
w(x).
This
special
case
of
the
above
discussion
is
the
most
fundamental.
Two
of
the
most
basic
examples
of
this
sort
of
orthogonal
system
are
the
Legendre
polynomials
(where
a
=
âˆ’1,
b
=
1,
w(x)
=
1)
and
the
Hermite
polynomials
(where
1
2
a
=
âˆ’âˆ,
b
=
âˆ,
w(x)
=
eâˆ’
2
x
).
These
two
cases
will
be
discussed
in
Â§2
below.
(2)
Polynomials
on
a
ï¬nite
set
of
points:
This
case
is
similar
to
(1).
Instead
of
working
with
an
interval
in
R,
however,
we
work
with
the
ï¬nite
set
of
points
{0,
.
.
.
,
d
âˆ’
1}
âŠ†
R.
We
then
consider
a
positive
weight
function
w(x)
on
{0,
.
.
.
,
d
âˆ’
1}.
The
Hilbert
space
H
is
taken
to
be
the
set
of
K-valued
functions
f
on
{0,
.
.
.
,
d
âˆ’
1}
with
the
inner
product
given
by
def
(f,
g)
=
dâˆ’1

f
(x)
Â·
g(x)
Â·
w(x)
x=0
Here,
we
take
N
=
d,
and
for
0
â‰¤
n
<
N
,
we
let
F
n
(H)
âŠ†
H
be
the
subspace
of
polynomials
in
x
of
degree
â‰¤
n;
and
X
the
self-adjoint
operator
given
by
multiplication
by
x.
Just
as
was
the
case
with
(1),
the
present
set-up
(2)
also
has
a
long
history,
dating
back
to
the
nineteenth
century.
The
most
basic
example
of
this
sort
of
orthogonal
system
is
the
system
of
discrete
Tchebycheï¬€
polynomials
(where
w(x)
=
1),
to
be
reviewed
in
Â§3
below
(cf.
also
[Sze],
Â§2.8;
[Bate],
p.
223).
As
one
might
expect
from
the
weight
functions,
the
discrete
Tchebycheï¬€
polynomials
are
a
sort
of
discrete
analogue
of
the
Legendre
polynomials.
Another
basic
example
of
(2)
is
the
case
of
Krawtchouk
polynomials,
which
are
a
sort
of
discrete
analogue
of
the
Hermite
polynomials
(cf.
[Sze],
Â§2.82).
227
(3)
Polynomials
on
the
circle
S1
:
Another
important
case
is
the
case
of
a
positive
weight
def
function
w(Î¸)
on
the
unit
circle
S1
.
We
let
H
=
L2w
(S1
)
be
the
Hilbert
space
of
comdef
plex
square
integrable
functions
with
respect
to
w
on
S1
;
F
n
(H)
=
{cn
z
n
+
.
.
.
+
c1
z
+
def
c0
|
c0
,
.
.
.
,
cn
âˆˆ
C},
where
n
â‰¥
0,
and
z
=
eiÎ¸
;
and
X
the
operator
given
by
multiplication
by
z.
There
is
a
rich
and
well-developed
concerning
the
resulting
orthogonal
system
Ï†n
(z)
â€“
see,
e.g.,
[Sze],
Chapters
XI,
XII
â€“
which
is
in
some
senses
more
transparent
then
the
theory
of
Example
(1).
For
instance,
this
theory
gives
rise
to
asymptotic
formulas
for
the
Ï†n
(z)
in
terms
of
w(Î¸)
(cf.
[Sze],
Chapter
XII).
Historically,
one
of
the
ï¬rst
cases
in
which
this
situation
was
investigated
in
detail
was
the
case
in
which
w(Î¸)
is
given
by
a
theta
function
on
S1
(cf.
[Sze2]).
This
case
is
particularly
interesting
in
that
it
foreshadowed
the
subsequent
development
of
q-analogues
of
the
classical
orthogonal
polynomials
(such
as
those
of
Legendre
and
Hermite).
def
(4)
Derivatives
of
a
weight
function
on
the
circle
S1
:
In
this
case,
we
let
H
=
L2
(S1
)
be
the
usual
L2
-space
of
square-integrable
complex
functions
on
S1
.
Moreover,
we
assume
that
we
are
given
a
function
w(Î¸)
on
S1
which
is
inï¬nitely
diï¬€erentiable
(i.e.,
of
class
C
âˆ
).
def
def
âˆ‚
Let
X
=
âˆ‚Î¸
be
the
usual
diï¬€erentiation
operator,
and
let
F
n
(H)
=
{cn
X
n
+
.
.
.
+
c1
X
+
c0
|
c0
,
.
.
.
,
cn
âˆˆ
C}
Â·
w(Î¸),
for
n
â‰¥
0.
Note
that
the
adjoint
of
X
is
âˆ’X,
so
Proposition
1.2
applies.
Thus,
the
Ï†n
(X)
are
entirely
determined
by
the
means
and
principal
submeans.
In
the
present
paper,
the
case
where
w(Î¸)
is
a
theta
function
will
play
an
important
role
(cf.
Â§6,
Deï¬nition
6.3;
Chapter
VIII).
(5)
Sections
of
a
line
bundle
on
an
elliptic
curve:
Let
E
be
an
elliptic
curve
over
C,
and
L
be
the
line
bundle
deï¬ned
by
the
origin.
Then
L
admits
a
Hermitian
metric
(unique
up
to
constant
multiple)
||
âˆ¼
||L
whose
curvature
is
translation
invariant
(cf.
Â§4
for
more
details).
This
Hermitian
metric
allows
us
to
deï¬ne
the
L2
-space
of
square-integrable
sections
s
of
H

satisfying
E
||s||2L
<
âˆ.
We
take
H
to
be
this
L2
-space,
and
(for
n
â‰¥
0)
F
n
(H)
to
be
the
n+1
space
of
sections
annihilated
by
âˆ‚
.
It
may
be
shown
that
dimC
(F
n
(H))
=
n
+
1.
Now
one
wishes
to
compute
the
splittings
of
this
ï¬ltration
deï¬ned
by
the
inner
product
on
H.
âˆ—
This
is
done
in
Â§4
by
using
the
adjoint
âˆ‚
of
âˆ‚
(with
respect
to
the
inner
product
of
H).
In
particular,
it
is
shown
that
if
s
is
a
generator
of
F
0
(H),
then
Qn
(H)
âŠ†
H
is
generated
âˆ—
âˆ—
by
(âˆ‚
)n
(s)
(cf.
Theorem
4.5
of
Â§4
below).
Thus,
if
we
take
X
to
be
âˆ‚
,
then
we
see
that
in
this
case,
Ï†n
(X)
is
a
constant
multiple
of
X
n
.
This
example
will
also
play
a
key
role
in
the
present
paper
and
will
be
treated
in
detail
in
Â§4.
(6)
The
discrete
version
of
(5):
Let
E
and
L
be
as
in
(5),
and
write
HR
for
the
Hilbert
space
â€œHâ€
of
(5).
Fix
a
positive
integer
N
,
and
let
G
âŠ†
E
be
a
cyclic
subgroup
of
order
N
.
Let
Î·
âˆˆ
E
be
a
torsion
point
which
is
âˆˆ
/
G.
Then
it
follows
from
Chapter
VI,
Theorem
3.1
(2),
together
with
the
theory
of
Â§4
of
the
present
Chapter,
that
the
restriction
map
ÎR
:
F
N
âˆ’1
(HR
)
â†’
L|Î·+G
228
is
bijective.
Note
that
||
âˆ¼
||L
deï¬nes
a
natural
inner
product
on
the
N
-dimensional
Cdef
vector
space
L|Î·+G
.
Thus,
L|Î·+G
is
a
ï¬nite-dimensional
Hilbert
space
H.
Let
F
n
(H)
=
ÎR
(Fn
(HR
))
âˆ¼
=
F
n
(HR
)
for
0
â‰¤
n
<
N
,
and
write
X
:
F
âˆâˆ’1
(H)
â†’
F
âˆ
(H)
for
the
operator
induced
by
the
â€œXâ€
of
(5)
(via
the
isomorphisms
F
n
(H)
âˆ¼
=
F
n
(HR
)).
Then
one
wishes
to
compute
the
resulting
Ï†n
(X).
Indeed,
The
computation
of
the
Ï†n
(X)
in
this
case
is
the
ultimate
goal
of
the
theory
of
the
present
and
following
Chapters.
In
fact,
it
is
essentially
a
tautology
that
concretely
speaking,
the
comparison
of
the
metrized
function
spaces
of
â€œde
Rham
functionsâ€
and
â€œeÌtale
functionsâ€
(cf.
Â§0)
amounts
to
estimating
the
coeï¬ƒcients
of
the
Ï†n
(X).
Since
this
ultimate
goal
of
comparing
Examples
(5)
and
(6)
is
too
diï¬ƒcult
to
achieve
directly,
we
relate
Examples
(5)
and
(6)
by
using
a
certain
intermediate
orthogonal
system
which
is
a
special
case
of
Example
(4)
(i.e.,
the
case
where
â€œw(Î¸)â€
is
a
theta
function).
Finally,
we
analyze
this
special
case
of
Example
(4)
(cf.
Â§6;
Chapter
VIII)
by
using
the
well-known
theories
of
Examples
(1)
and
(2).
Â§2.
Review
of
Legendre
and
Hermite
Polynomials
In
this
Â§,
we
review
the
classical
orthogonal
polynomials
of
Legendre
and
Hermite.
These
examples
are
important
not
only
because
they
serve
to
illustrate
the
general
theory
of
orthogonal
systems
of
functions,
but
also
because
they
appear
naturally
in
the
theory
of
the
Hodge-Arakelov
comparison
isomorphism
(Chapter
VIII)
as
limiting
cases
of
the
orthogonal
functions
arising
from
diï¬€erential
calculus
on
the
â€œtheta-weighted
circleâ€.
We
begin
with
the
polynomials
of
Legendre:
Proposition
2.1.
(Legendre
Polynomials)
For
every
integer
n
â‰¥
0,
we
deï¬ne:



[2]

2n
âˆ’
2j
def
1
j
n
Pn
(T
)
=
n
Â·
(âˆ’1)
Â·
T
nâˆ’2j
2
j=0
j
n
n
(where
[âˆ¼]
denotes
the
greatest
integer
less
than
the
real
number
inbrackets).
Thus,
Pn
(T
)
n
is
a
polynomial
of
degree
n
whose
leading
term
is
given
by
2âˆ’n
Â·
2n
n
Â·T
and
which
satisï¬es
Pn
(1)
=
1.
In
particular,
P0
(T
)
=
1;
P1
(T
)
=
T
Moreover,
the
system
of
polynomials
{Pn
(T
)}
satisï¬es
the
following
properties:
229

(1)
(Orthogonality
and
Norms)
[âˆ’1,1]
2
Pm
(T
)
Â·
Pn
(T
)
=
2n+1
Â·
Î´mn
.
(2)
(Recurrence
Formula)
(n
+
1)
Â·
Pn+1
(T
)
âˆ’
(2n
+
1)T
Â·
PN
(T
)
+
n
Â·
Pnâˆ’1
(T
)
=
0
for
n
â‰¥
1.
(3)
(Diï¬€erential
Equation)
(1
âˆ’
T
2
)Pn
(T
)
âˆ’
2T
Â·
Pn
(T
)
+
n(n
+
1)
Â·
Pn
(T
)
=
0.
(4)
(Rodriguesâ€™
Formula)
d
n
)
{(T
2
âˆ’
1)n
}.
Pn
(T
)
=
2n1Â·n!
Â·
(
dT
Proof.
See,
e.g.,
[Rice],
pp.
47-48.
Note
that
up
to
constant
multiples,
the
Pn
(T
)
are
determined
uniquely
by
the
following
two
properties:
(i)
Pn
(T
)
is
of
degree
precisely
n;
(ii)
if
m
=
n,
then
tm
(T
)
and
tn
(T
)
are
orthogonal
with
respect
to
L2
([âˆ’1,
1]).

Next,
we
consider
the
polynomials
of
Hermite:
Proposition
2.2.
def
Write
D
=
(Hermite
Polynomials)
Let
X
be
the
standard
coordinate
on
R.
d
dX
.
For
n
â‰¥
0,
deï¬ne
Hn
(X)
=
e
2
X
Â·
D
n
(eâˆ’
2
X
)
def
1
2
def
1
2
Thus,
H0
(X)
=
1;
H1
(X)
=
âˆ’X.
Let
dÎ±
=
eâˆ’
2
X
Â·
dX,
which
we
think
of
as
a
metric/measure
on
R.
Then
for
n
â‰¥
0,
1
2
(1)
(Orthogonality
and
Norms)
+âˆ
âˆ’âˆ
1
Hn
(X)
Â·
Hm
(X)
Â·
dÎ±
=
(2Ï€)
2
Â·
n!
Â·
Î´mn
.
(2)
(Explicit
Formula)

(âˆ’2)âˆ’m
Â·
X
nâˆ’2m
m!
(n
âˆ’
2m)!
m=0
[n/2]
Hn
(X)
=
(âˆ’1)
Â·
n!
Â·
n
230
where
[n/2]
is
n/2
(respectively,
(n
âˆ’
1)/2)
if
n
is
even
(respectively,
odd).
Hn
(X)
=
(D
âˆ’
X)n
(1).
(3)
(Alternate
Deï¬nition)
(4)
(Recurrence
Formula)
Hn+1
(X)
+
X
Â·
Hn
(X)
=
D(Hn
(X))
=
âˆ’n
Â·
Hnâˆ’1
(X).
def
(5)
(Diï¬€erential
Relations)
If
we
set
Î¦n
(X)
=
Hn
(X)
Â·
eâˆ’
4
X
,
then
1
(D
âˆ’
X)
Â·
Î¦n
(X)
=
Î¦n+1
(X);
2
(D2
âˆ’
1
2
1
(D
+
X)
Â·
Î¦n
(X)
=
âˆ’n
Â·
Î¦nâˆ’1
(X);
2
1
1
Â·
X
2
âˆ’
)
Â·
Î¦n
(X)
=
âˆ’(n
+
1)
Â·
Î¦n
(X).
4
2
Proof.
The
properties
here
all
follow
essentially
from
[Bate],
p.
193.
Since,
however,
we
use
diï¬€erent
normalizations
here
from
those
of
[Bate],
we
sketch
the
proofs
here.
First,
deï¬ne
the
operator:
D
exp
=
e
2
X
Â·
D
Â·
eâˆ’
2
X
def
1
2
1
2
Then
by
deï¬nition,
Hn
(X)
=
(Dexp
)n
(1).
But
one
computes
easily
that
D
exp
=
e
2
X
Â·
(eâˆ’
2
X
Â·
D
+
[D,
eâˆ’
2
X
])
1
2
1
2
1
2
=
D
+
e
2
X
Â·
D(eâˆ’
2
X
)
=Dâˆ’X
1
2
1
2
This
proves
the
â€œAlternate
Deï¬nition.â€
The
â€œRecurrence
Formulaâ€
follows
by
applying
the
operator-theoretic
relation
D
Â·
(D
âˆ’
X)n
=
(D
âˆ’
X)n
Â·
D
+
[D,
(D
âˆ’
X)n
]
=
(D
âˆ’
X)n
Â·
D
+
n
Â·
(D
âˆ’
X)nâˆ’1
Â·
[D,
D
âˆ’
X]
=
(D
âˆ’
X)n
Â·
D
âˆ’
n
Â·
(D
âˆ’
X)nâˆ’1
to
the
constant
function
1.
The
â€œDiï¬€erential
Relationsâ€
follow
by
using
(D
âˆ’
X)(Hn
)
=
Hn+1
;
D(Hn
)
=
âˆ’n
Â·
Hnâˆ’1
;
and
the
operator-theoretic
relation
(D2
âˆ’
14
X
2
)
âˆ’
12
=
D
2
âˆ’
1
2
1
1
1
4
X
âˆ’
2
[D,
X]
=
(D
+
2
X)(D
âˆ’
2
X).
This
operator
231
1
1
(D
+
X)(D
âˆ’
X)
2
2
is
a
sort
of
Laplacian
operator,
and
is
self-adjoint
for
the
L2
-norm
on
R
equipped
with
the
usual
measure
(i.e.,
dX).
Thus,
the
fact
that
the
Î¦n
(X)â€™s
are
eigenfunctions
for
this
operator
implies
that
they
are
mutually
orthogonal.
The
integrals
+âˆ
âˆ’âˆ
Î¦2n
dX
may
then
be
computed
by
using
the
fact
that
D
+
12
X
(respectively,
D
âˆ’
12
X)
is
adjoint
to
âˆ’(D
âˆ’
12
X)
(respectively,
âˆ’(D
+
12
X)).
Finally,
the
â€œExplicit
Formulaâ€
may
be
proven
by
applying
induction
on
n
and
the
relation
Hn+1
(X)
=
(D
âˆ’
X)
Â·
Hn
(X).

Remark
1.
In
fact,
the
explicit
formula
given
above
(i.e.,
Proposition
2.2,
(2))
may
be
interpreted
as
a
formula
for
any
two
operators
A
and
B
satisfying
[A,
B]
=
c
âˆˆ
C
and
A
Â·
v
=
0,
for
some
vector
v.
That
is
to
say,
the
explicit
formula
implies
that

(c/2)m
Â·
B
nâˆ’2m
Â·v
m!
(n
âˆ’
2m)!
m=0
[n/2]
(A
+
B)
Â·
v
=
n!
Â·
n
Indeed,
this
follows
by
thinking
of
A
as
Î»âˆ’1
Â·
D
and
of
B
as
âˆ’Î»âˆ’1
Â·
X,
where
Î»âˆ’2
=
âˆ’c.
Remark
2.
Thus,
the
theory
of
Hermite
polynomials
essentially
amounts
to
harmonic
analysis
with
respect
to
the
metric
dÎ±
=
eâˆ’
2
X
Â·
dX
def
1
2
on
R.
This
is
interesting
relative
to
the
main
theme
of
this
work,
i.e.,
of
a
â€œcomparison
2
1
isomorphism
via
theta
functions,â€
since
this
sort
of
factor
eâˆ’
2
X
(i.e.,
an
exponential
with
a
quadratic
exponent)
appears
frequently
in
the
theory
of
theta
functions
(cf.,
e.g.,
[Mumf3],
Â§12,
proof
of
Lemma
2,
(II)).
Indeed,
from
this
point
of
view,
one
may
think
of
this
factor
as
being
essentially:
exp
(Chern
class
of
L)
=
exp
(Riemann
form
of
L)
Note
that
this
sort
of
factor
also
appears
in
the
adjustment
of
integral
structure
at
inï¬nity
in
Chapter
VI,
Theorem
3.1,
(3),
i.e.,
this
adjustment
of
integral
structure
varies
roughly
232
as
the
exponential
of
the
â€œcj
â€™sâ€
of
loc.
cit.,
which
(cf.
Chapter
V,
Schola
4.1)
are
quadratic
functions
of
j.
This
appearance
of
the
exponential
of
a
quadratic
function
in
all
of
these
places
is
by
no
means
a
coincidence,
as
will
become
increasingly
apparent
to
the
reader
as
he/she
studies
the
material
of
this
and
the
following
Chapters.
Â§3.
Discrete
Tchebycheï¬€
Polynomials
and
the
Fundamental
Combinatorial
Model
In
this
Â§,
we
discuss
the
theory
of
discrete
Tchebycheï¬€
polynomials.
This
theory
may
be
regarded
as
the
archimedean
portion
of
the
fundamental
combinatorial
model
underlying
the
theory
of
this
paper.
This
combinatorial
model
is
the
evaluation
map
Î
cb
<d
:
Z[T
]
dâˆ’1

âˆ’â†’
Z
i=0
T
â†’
(0,
1,
2,
.
.
.
,
d
âˆ’
1)
given
by
evaluating
polynomials
in
the
indeterminate
T
of
degree
<
d
(for
d
a
positive
integer)
with
integral
coeï¬ƒcients
at
the
points
T
=
0,
1,
2,
.
.
.
,
d
âˆ’
1.
In
Chapter
V
(cf.,
especially,
Chapter
V,
Â§6),
we
discussed
the
evaluation
map
Îcb
at
ï¬nite
primes.
In
particular,
we
saw
that
if
we
adjust
the
integral
structure
in
an
appropriate
fashion
(cf.
Chapter
III,
Â§6;
Chapter
V,
Â§3)
â€“
i.e.,
if
we
consider
the
submodule
of
Z[T
]
âŠ—Z
Q
generated
by
the
polynomials
def
T
[n]
=
1
T
(T
âˆ’
1)(T
âˆ’
2)
Â·
.
.
.
Â·
(T
âˆ’
n
+
1)
n!
â€“
then
the
matrix
corresponding
to
the
evaluation
map
Îcb
takes
on
the
simple
upper
triangular
form
â›
1
âœ
âœ
0
âœ
[i]
{T
|T
=j
}{i,j=0,1,2,...,dâˆ’1}
=
âœ
âœ...
â
0
âˆ—
...
âˆ—
1
...
âˆ—
...
0
...
0
âˆ—
â
âŸ
âˆ—
âŸ
âŸ
âŸ
...âŸ
â 
1
which
is
manifestly
both
integral
and
invertible
at
all
ï¬nite
primes.
Unfortunately,
however,
although
the
polynomials
T
[n]
are
very
well-suited
to
analyzing
the
eï¬€ect
of
Îcb
on
the
integral
structures
at
ï¬nite
primes,
they
are
not
well-suited
to
analyzing
Îcb
at
the
inï¬nite
233
(archimedean)
prime.
At
the
inï¬nite
prime,
the
range
of
Îcb
has
a
natural
â€œL2
-metricâ€
given
by:
1
||(a0
,
.
.
.
,
adâˆ’1
)||
=
(a20
+
.
.
.
+
a2dâˆ’1
)
2
(where
a0
,
.
.
.
,
adâˆ’1
âˆˆ
R).
In
the
present
Â§,
we
would
like
to
analyze
Îcb
relative
to
this
L2
-metric
on
the
range,
i.e.,
we
would
like
to
discuss
the
metric
induced
on
Z[T
]<d
via
Îcb
by
this
L2
-metric.
In
the
theory
of
Îcb
at
archimedean
primes,
the
polynomials
that
play
the
role
of
the
T
are
the
discrete
Tchebycheï¬€
polynomials
discussed
in
[Bate],
[Sze].
We
summarize
their
deï¬nition
and
basic
properties
in
the
following
Proposition:
[n]
Proposition
3.1.
(Discrete
Tchebycheï¬€
Polynomials)
Fix
a
positive
integer
d.
Then
we
deï¬ne,
for
n
=
0,
1,
2,
.
.
.
,
d
âˆ’
1,
(1)
(â€œRodriguesâ€™
Formulaâ€)
def
tn
(T
)
=
n!
Â·
Î´
n



T
T
âˆ’d
n
n
def
where,
as
usual,
if
f
(T
)
is
a
polynomial
in
T
,
then
Î´(f
)(T
)
=
f
(T
+1)âˆ’f
(T
).
(When
it
is
necessary
to
specify
the
dependence
on
d,
we
write
tn,d
(T
)
for
tn
(T
).)
Thus,
for
instance,
t0
(T
)
=
1;
t1
(T
)
=
2T
âˆ’
(d
âˆ’
1)


n
and
(for
all
n
=
0,
1,
2,
.
.
.
,
d
âˆ’
1)
the
leading
term
of
tn
(T
)
is
2n
n
Â·
T
.
The
polynomials
2
tn
(T
)
form
an
orthogonal
system
of
polynomials
for
the
L
-norm
(as
deï¬ned
above)
on
the
space
of
functions
on
the
set
{0,
1,
2,
.
.
.
,
d
âˆ’
1}:
(2)
(Orthogonality
and
Norms)
def

tn
(T
),
tm
(T
)

=
dâˆ’1

tn
(T
)
Â·
tm
(T
)
=
(2n
+
1)âˆ’1
Â·
d(d2
âˆ’
12
)(d2
âˆ’
22
)
.
.
.
(d2
âˆ’
n2
)
Â·
Î´mn
T
=0
for
m,
n
=
0,
1,
2,
.
.
.
,
d
âˆ’
1
(where
Î´mn
is
=
0
if
m
=
n
and
=
1
if
m
=
n).
Moreover,
these
polynomials
also
satisfy
the
following
properties:
(3)
(Recurrence
Formula)
(n
+
1)
Â·
tn+1
(T
)
âˆ’
(2n
+
1)(2T
âˆ’
d
+
1)
Â·
tn
(T
)
+
n(d2
âˆ’
n2
)tnâˆ’1
(T
)
=
0
234
for
n
=
1,
2,
.
.
.
,
d
âˆ’
1.
(4)
(Diï¬€erence
Equation)
(T
+
2)(T
âˆ’
d
+
2)
Î´
2
(tn
(T
))
+
[2T
âˆ’
d
+
3
âˆ’
n(n
+
1)]
Î´(tn
(T
))
âˆ’
n(n
+
1)
tn
(T
)
=
0
for
n
=
0,
1,
2,
.
.
.
,
d
âˆ’
1.
(5)
(Connection
with
Legendre
Polynomials)
lim
dâˆ’n
tn
(d
Â·
T
)
=
Pn
(2T
âˆ’
1)
dâ†’âˆ
for
n
=
0,
1,
2,
.
.
.
,
d
âˆ’
1.
Here
Pn
(T
)
is
the
n-th
Legendre
polynomial
(cf.
Proposition
2.1).
(6)
(Connection
with
usual
Monomials)
For
any
real
number


2n
âˆ’n(1+)
1+
lim
d
tn
(d
Â·
T)
=
Â·
Tn
dâ†’âˆ
n
>
0,
for
n
=
0,
1,
2,
.
.
.
,
d
âˆ’
1.
Proof.
See,
e.g.,
[Bate],
p.
223.
The
symbol
T
(respectively,
Î´(âˆ’);
d)
in
our
notation
corresponds
to
x
(respectively,
Î”;
N
)
in
the
notation
of
loc.
cit.
Note
that
up
to
constant
multiples,
the
tn
(T
)
are
determined
uniquely
by
the
following
two
properties:
(i)
tn
(T
)
is
of
degree
precisely
n;
(ii)
if
m
=
n,
then
tm
(T
)
and
tn
(T
)
are
orthogonal
with
respect
to
L2
({0,
1,
.
.
.
,
d
âˆ’
1}).
The
only
result
listed
in
Proposition
3.1
that
cannot
be
found
in
[Bate]
is
the
connection
with
â€œthe
usual
monomials
T
n
.â€
But
this
follows
immediately
from
Rodriguesâ€™
formula,
which,
in
the
limit,
takes
on
the
form
1
d
Â·
(
)n
(T
2n
)
=
n!
dT


2n
Â·
Tn
n
as
desired.

Remark
1.
Note
that
the
various
properties
of
the
Legendre
polynomials
listed
in
Proposition
2.1
may
all
be
obtained
by
passing
to
the
limit
d
â†’
âˆ
from
the
corresponding
properties
listed
in
Proposition
3.1.
Thus,
the
discrete
Tchebycheï¬€
polynomials
are
discrete
versions
of
the
Legendre
polynomials.
The
Legendre
polynomials
appear
(by
substituting
â€œcos(Î¸)â€
for
T
)
as
eigenfunctions
of
the
Laplacian
operator
on
the
sphere
(equipped
with
its
unique
rotation
invariant
metric).
Indeed,
the
diï¬€erential
equation
which
states
that
Pn
(cos(Î¸))
is
an
eigenfunction
of
this
Laplacian
with
eigenvalue
n(n
+
1)
may
be
written
235
entirely
in
terms
of
T
and
is,
in
fact,
the
diï¬€erential
equation
that
appears
in
Proposition
2.1.
Thus,
the
discrete
Tchebycheï¬€
polynomials
may
be
regarded
as
discrete
versions
of
the
eigenfunctions
of
the
Laplacian
on
the
sphere.
Remark
2.
Note
that
while
the
limit
of
the
discrete
Tchebycheï¬€
polynomials
as
the
length
of
the
interval
under
consideration
remains
ï¬xed
and
equal
to
1
is
given
by
the
Legendre
polynomials
(Proposition
3.1,
(5)),
the
limit
of
the
discrete
Tchebycheï¬€
polynomials
as
the
length
of
the
interval
under
consideration
â†’
0
is
simply
the
system
of
â€œusual
monomialsâ€
T
n
(up
to
constant
multiples
â€“
cf.
Proposition
3.1,
(6)).
That
is
to
say,
just
as
the
Legendre
polynomials
are
â€œmetrically
suitedâ€
to
reï¬‚ect
the
geometry
of
the
unit
interval,
the
usual
monomials
are
functions
which
are
â€œmetrically
suitedâ€
to
reï¬‚ect
the
geometry
of
an
inï¬nitesimal
neighborhood
of
a
point.
It
is
for
this
reason
that
such
functions
appear
naturally
in
the
theory
of
Taylor
series,
i.e.,
the
theory
of
expansions
of
functions
in
an
inï¬nitesimal
neighborhood
of
a
point.
The
main
result
that
we
wish
to
prove
in
this
Â§
is
the
following
(Proposition
3.2),
concerning
a
bound
on
the
coeï¬ƒcients
of
the
discrete
Tchebycheï¬€
polynomials.
First,
let
us
introduce
some
notation:
Write
cnk
[d]
for
the
coeï¬ƒcient
of
T
k
in
the
polynomial
dâˆ’n
Â·
tn,d
(d
Â·
T
)
(cf.
Proposition
2.1).
Thus,
cnk
[d]
=
Coeï¬€
T
k
1
1
Â·
t
(d
Â·
T
)
=
Â·
Coeï¬€
T
k
tn
(T
)
n
dn
dnâˆ’k
(where
â€œCoeï¬€
A
(B)â€
denotes
â€œthe
coeï¬ƒcient
of
the
monomial
A
in
the
polynomial
Bâ€).
Proposition
3.2.
Let
us
write
1
d2
tn
(T
)
=
Â·
tn
(d
Â·
T
)
||
tn
||
def
(where
â€œ||
âˆ¼
||â€
denotes
the
L2
-norm
on
{0,
1,
.
.
.
d
âˆ’
1}).
Then:
(i.)
cnk
[d]
â‰¤
e2n
;
n+
1
1
(ii.)
1
â‰¤
||d
tn
2||
â‰¤
(2n
+
1)
2
Â·
en+1
â‰¤
3
Â·
e2n
;
1
Coeï¬€
T
k
tn
(T
)
â‰¤
(2n
+
1)
2
Â·
e3n+1
â‰¤
3
Â·
e4n
;
(iii.)
Coeï¬€
T
n
tn
(T
)
â‰¥
cnn
[d]
=
2n
n
â‰¥
1;
for
all
integers
d,
n,
k
such
that
0
â‰¤
k
â‰¤
n
â‰¤
d
âˆ’
1.
236
Proof.
Let
us
ï¬rst
prove
(i.).
First,
note
that
d0
Â·
t0
(d
Â·
T
)
=
1;
dâˆ’1
Â·
t1
(d
Â·
T
)
=
dâˆ’1
(2d
Â·
T
+
1
âˆ’
d)
=
T
âˆ’
1
+
dâˆ’1
,
so
the
inequality
of
(i.)
is
satisï¬ed
for
n
=
0,
1.
Now
we
apply
the
â€œRecurrence
Formulaâ€
(cf.
Proposition
3.1,
(3)),
and
induction
on
n.
This
gives
us:
!
!
!
Coeï¬€
T
k
dâˆ’nâˆ’1
Â·
tn+1
(d
Â·
T
)
!
!
2n
+
1
!
!
)(2d
Â·
T
âˆ’
d
+
1)
Â·
dâˆ’nâˆ’1
Â·
tn
(d
Â·
T
)
!
=
!
Coeï¬€
T
k
(
n+1
!
n
!
2
2
âˆ’nâˆ’1
)(d
âˆ’
n
)d
Â·
tnâˆ’1
(d
Â·
T
)
!
âˆ’(
!
!
n+1
!
!
âˆ’1
âˆ’n
â‰¤
!
Coeï¬€
T
k
2(2T
âˆ’
1
+
d
)
Â·
d
Â·
tn
(d
Â·
T
)
!
!
!
!
!
+
!
Coeï¬€
T
k
dâˆ’(nâˆ’1)
Â·
tnâˆ’1
(d
Â·
T
)
!
!
!
!
!
âˆ’n
â‰¤
4
Â·
!
Coeï¬€
T
kâˆ’1
d
Â·
tn
(d
Â·
T
)
!
!
!
!
!
+
2
Â·
!
Coeï¬€
T
k
dâˆ’n
Â·
tn
(d
Â·
T
)
!
!
!
!
!
âˆ’(nâˆ’1)
+
!
Coeï¬€
T
k
d
Â·
tnâˆ’1
(d
Â·
T
)
!
â‰¤
4
Â·
7n
+
2
Â·
7n
+
7nâˆ’1
â‰¤
7n
Since
e2
â‰¥
7,
this
completes
the
proof
of
(i.).
To
derive
(ii.)
from
(i.),
it
suï¬ƒces
(by
Proposition
3.1,
(2))
to
bound
1
(2n
+
1)
2
Â·
dn
1â‰¤
1
1
1
(d2
âˆ’
12
)
2
Â·
(d2
âˆ’
22
)
2
Â·
.
.
.
Â·
(d2
âˆ’
n2
)
2
1
2
(d
âˆ’
n
âˆ’
1)!
Â·
d
(d
+
n)!
=
(2n
+
1)
Â·
d
Â·
n
1
2
By
Stirlingâ€™s
Formula
(reviewed
below
â€“
cf.
Lemma
3.5),
it
follows
that
this
last
expression
may
be
bounded
by
d2n+1
Â·
(d
âˆ’
n
âˆ’
1)dâˆ’nâˆ’1
Â·
eâˆ’(dâˆ’nâˆ’1)
Â·
(d
âˆ’
n
âˆ’
1)
2
Â·
e
1
1
2
(2n+1)
Â·
(d
+
n)d+n
Â·
eâˆ’(d+n)
Â·
(d
+
n)
1
2
1
2
1
â‰¤
(2n+1)
2
Â·en+1
â‰¤
3Â·e2n
as
desired.
This
completes
2n
the
proof
of
(ii.)
(as
well
as
the
proof
of
the
ï¬rst
inequality
of
n
(iii.)).
That
cn
[d]
=
n
â‰¥
1
follows
immediately
from
Proposition
3.1,
(1)
(and
the
fact




1
n
that
the
leading
term
of
Tn
,
T
nâˆ’d
is
n!
T
).

Before
proceeding,
we
would
also
like
to
bound
the
coeï¬ƒcients
of
the
polynomials
T
[n]
.
237
Proposition
3.3.
Let
n
be
a
positive
integer.
Then
the
coeï¬ƒcients
of
the
polynomial
def
T
[n]
=
1
Â·
T
(T
âˆ’
1)
Â·
.
.
.
Â·
(T
âˆ’
(n
âˆ’
1))
n!
satisfy
(for
k
=
0,
.
.
.
,
n)
Coeï¬€
T
k
(T
[n]
)
â‰¤
e2n
nk
In
particular,
if
n
â‰¤
d,
then
Coeï¬€
(T
/d)k
(T
[n]
)â‰¤e
2n
Â·

d
k
n
â‰¤e
2n
Â·

d
n
n
â‰¤
e2n+d
Proof.
n
If
one
expands
the
polynomial
T
(T
âˆ’
1)
Â·
.
.
.
Â·
(T
âˆ’
(n
âˆ’
1)),
one
sees
that
there
are
â‰¤
k
terms
of
degree
k,
each
of
which
has
a
coeï¬ƒcient
whose
absolute
value
is
a
product
of
n
âˆ’
k
positive
integers
â‰¤
n.
It
thus
follows
that
Coeï¬€
T
k
(T
[n]


nâˆ’k
n
n
)â‰¤
Â·
k
n!
â‰¤
2n
Â·
â‰¤
e2n
nk
nnâˆ’k
nn
Â·
eâˆ’n
(where
in
the
second
inequality,
we
use
Lemma
3.5
below).
If
n
â‰¤
d,
then
(d/n)k
â‰¤
(d/n)n
.
Finally,
by
Lemma
3.6,
(d/n)n
â‰¤
ed
.

Next,
we
return
to
the
combinatorial
evaluation
map:
Î
cb
<d
:
Z[T
]
âˆ’â†’
dâˆ’1

Z
i=0
As
discussed
earlier,
the
range
admits
a
natural
â€œL2
-norm,â€
hence
deï¬nes
an
arithmetic
vector
bundle
(cf.
Chapter
I,
Deï¬nition
1.1)
over
Q,
which
we
denote
by
Î¦et
(for
â€œeÌtale
function
spaceâ€).
Next,
let
us
denote
by
Î¦DR
(for
â€œde
Rham
function
spaceâ€)
the
arithmetic
vector
bundle
deï¬ned
by
Q[T
]<d
equipped
with:
(i.)
the
metric
induced
by
the
L2
-metric
on
Î¦et
via
Îcb
at
the
inï¬nite
prime
of
Q;
(ii.)
the
integral
structure
deï¬ned
238
by
T
[0]
,
T
[1]
,
.
.
.
,
T
[dâˆ’1]
at
the
ï¬nite
primes
of
Q.
Thus,
Îcb
induces
an
isomorphism
of
arithmetic
vector
bundles:
Î¦DR
âˆ¼
=
Î¦et
Let
us
denote
the
ï¬ltration
on
Î¦DR
given
by
considering
polynomials
of
degree
<
n
by
F
n
(Î¦DR
).
Note
that
since
Î¦et
is
a
direct
sum
of
trivial
arithmetic
line
bundles,
it
follows
that
dâˆ’1

deg{(F
n+1
/F
n
)(Î¦DR
)}
=
deg(Î¦DR
)
=
deg(Î¦et
)
=
0
n=0
In
fact,
if
we
compute
the
â€œzeroes
and
polesâ€
of
the
rational
section
of
the
arithmetic
line
bundle
def
Ln
=
(F
n+1
/F
n
)(Î¦DR
)
deï¬ned
by
T
n
,
we
see
(cf.
Proposition
3.1,
(2);
Proposition
3.2,
(iii.))
that
deg(Ln
)
=
log(n!)
+
log(||tn
||âˆ’1
Â·
Coeï¬€
T
n
(tn
(T
)))
2n
(2n
+
1)
12
Â·
((d
âˆ’
n
âˆ’
1)!)
12

=
log(n!)
+
log
Â·
1
n
((d
+
n)!)
2
(where
the
ï¬rst
(respectively,
second)
â€œlogâ€
represents
the
contribution
arising
from
the
ï¬nite
(respectively,
inï¬nite)
places).
In
fact,
the
fact
that
the
sum
of
the
deg(Ln
)â€™s
is
0
may
be
checked
directly
as
follows:
Proposition
3.4.
The
degree
of
Ln
deg(Ln
)
=
log(n!)
+
log(||tn
||âˆ’1
Â·
Coeï¬€
T
n
(tn
(T
)))
satisï¬es
|
n
Â·
log(n/d)
+
1
Â·
log(d)
âˆ’
deg(Ln
)
|
â‰¤
4n
+
2
2
Moreover,
the
sum
of
the
deg(Ln
)â€™s
satisï¬es:



2n
(2n
+
1)
Â·
(d
âˆ’
1
âˆ’
n)!

12
exp(deg(Ln
))
=
n!
Â·
Â·
=1
(d
+
n)!
n
n=0
n=0
dâˆ’1

dâˆ’1

239
(for
any
positive
integer
n).
Proof.
The
inequality
concerning
deg(Ln
)
follows
immediately
from
Proposition
3.2,
(ii.),
and
Lemma
3.5
below.
Thus,
it
remains
to
prove
the
assertion
concerning
the
sum
of
the
deg(Ln
)â€™s.
Although
it
is
not
logically
necessary
for
the
proof,
we
ï¬rst
observe
that
the
fact
that
the
sum
of
the
deg(Ln
)â€™s
is
zero
is
compatible
with
the
inequalities
just
proven.
Indeed,
we
have

dâˆ’1


d
n
n=1
n
Â·d
1
2

â‰¥1
while
(by
Lemma
3.6
below)

dâˆ’1


d
n
n=1
n


dâˆ’1


dâˆ’1



2
2
1
1
âˆ’4nâˆ’2
Â·d
Â·
e
ed
Â·
e
2
Â·log(d)
Â·
eâˆ’2d
â‰¤
ed(d+
2
Â·d)âˆ’2d
â‰¤
1
â‰¤
1
2
n=0
n=1
as
desired.
Now
we
prove
exact
equality.
For
simplicity,
we
treat
the
case
of
d
odd;
the
case
of
d
even
is
similar
(only
easier).
We
compute:


1!
Â·
2!
Â·
.
.
.
Â·
(d
âˆ’
1)!
(2n
+
1)
Â·
(d
âˆ’
1
âˆ’
n)!
=
1
Â·
3
Â·
5
Â·
.
.
.
Â·
(2d
âˆ’
1)
Â·
(d
+
n)!
d!
Â·
(d
+
1)!
Â·
.
.
.
Â·
(2d
âˆ’
1)!
n=0
dâˆ’1

=
{1
Â·
3
Â·
5
Â·
.
.
.
Â·
(d
âˆ’
2)}2
Â·

(2!)2
Â·
(4!)2
Â·
.
.
.
Â·
((d
âˆ’
3)!)2
Â·
(d
âˆ’
1)!

(d
âˆ’
1)!
Â·
((d
+
1)!)2
Â·
((d
+
3)!)2
Â·
.
.
.
Â·
((2d
âˆ’
2)!)2
If
we
multiply
the
square
root
of
this
expression
by
"dâˆ’1
2n
n=0
n
,
we
obtain:


2!
Â·
4!
Â·
.
.
.
Â·
(2d
âˆ’
2)!


(2!)
Â·
(4!)
Â·
.
.
.
Â·
(d
âˆ’
3)!
Â·
(d
âˆ’
1)!
Â·
1
Â·
3
Â·
.
.
.
Â·
(d
âˆ’
2)
Â·
(1!
Â·
2!
Â·
.
.
.
Â·
(d
âˆ’
1)!)2
(d
âˆ’
1)!
Â·
(d
+
1)!
Â·
(d
+
3)!
Â·
.
.
.
Â·
(2d
âˆ’
2)!

2!
Â·
4!
Â·
.
.
.
Â·
(d
âˆ’
1)!
2

1
Â·
3
Â·
5
Â·
.
.
.
Â·
(d
âˆ’
2)

Â·
=
1!
Â·
2!
Â·
3!
Â·
.
.
.
Â·
(d
âˆ’
1)!
(d
âˆ’
1)!

(2!
Â·
4!
Â·
.
.
.
Â·
(d
âˆ’
3)!)2



1
Â·
=
1!
Â·
2!
Â·
3!
Â·
.
.
.
Â·
(d
âˆ’
1)!
(2!
Â·
4!
Â·
.
.
.
Â·
(d
âˆ’
3)!)2
1
=
1!
Â·
2!
Â·
3!
Â·
.
.
.
Â·
(d
âˆ’
1)!
240
as
desired.

Before
continuing,
we
review
the
following
well-known
elementary
Lemmas,
which
we
will
use
often
throughout
this
Chapter:
Lemma
3.5.
(Stirlingâ€™s
Formula)
If
n
is
a
positive
integer,
then
n!
=
nn
Â·
eâˆ’n
Â·
âˆš
nÂ·
âˆš
2Ï€
Â·
Î˜n
where
Î˜n
is
a
real
number
satisfying
1
â‰¤
Î˜n
â‰¤
e.
Proof.
For
a
precise
statement
of
Stirlingâ€™s
formula,
we
refer
to
[Ahlf],
Chapter
5,
Â§2.5,
Ex.
2.
The
inequalities
stated
here
are
formal
consequences
of
Stirlingâ€™s
formula
stated
in
this
form.

Lemma
3.6.
Proof.
y
If
x,
y
are
positive
real
numbers,
then
(
xy
)x
â‰¤
e
e
.
def
u
By
letting
u
=
xy
,
we
see
that
it
suï¬ƒces
to
prove
that
u
â‰¤
e
e
,
or,
equivalently,
def
that
f
(u)
=
u
âˆ’
e
Â·
log(u)
is
â‰¥
0
for
all
positive
real
u.
Now
note
that
f
(u)
=
1
âˆ’
ue
is
0
if
and
only
if
u
=
e.
Moreover,
since
f
(e)
=
0,
f
(0)
=
+âˆ,
f
(+âˆ)
=
+âˆ,
we
thus
conclude
that
f
(u)
â‰¥
0
for
all
positive
real
u,
as
desired.

The
above
discussion
of
the
fundamental
combinatorial
model
at
ï¬nite
and
inï¬nite
primes,
together
with
Remark
2
following
Proposition
3.1,
motivate
the
following
point
of
view:
Fix
an
integer
n
â‰¥
2.
Then
let
us
consider
the
limit
lim
dâ†’âˆ
tn,d
(dÎ»
Â·
T
)
dÎ»Â·n
Â·
Coeï¬€
T
n
(tn,d
(T
))
where
Î»
âˆˆ
R,
and
â€œCoeï¬€
T
n
(âˆ’)â€
denotes
the
coeï¬ƒcient
of
T
n
in
the
polynomial
in
parentheses.
Proposition
3.1,
(6),
states
that
when
Î»
>
1,
this
limit
exists
and
is
equal
to
T
n
.
Proposition
3.1,
(5),
states
that
when
Î»
=
1,
this
limit
exists
and
is
equal
to
a
polynomial
of
degree
n
whose
leading
term
is
T
n
,
but
which
has
(as
one
sees
from
the
explicit
formula
for
the
Legendre
polynomials
given
in
Proposition
2.1)
nonzero
terms
of
lower
degree.
The
fact
that
there
exist
nonzero
terms
of
lower
degree
implies
that
if
Î»
<
1,
then
the
above
limit
diverges.
Thus,
we
see
that
â€œÎ»
=
1â€
is
a
distinguished
value
associated
to
the
family
of
systems
of
discrete
Tchebycheï¬€
polynomials
that
one
obtains
as
d
varies.
Terminology
3.7.
We
shall
refer
to
this
special
exponent
Î»
of
the
scaling
factor
d
as
the
slope
of
this
family
of
orthogonal
systems
on
ï¬nite
discrete
sets.
241
Later
in
this
Chapter
(cf.
Â§6,
especially
Theorem
6.7),
we
shall
encounter
another
family
of
orthogonal
systems
on
ï¬nite
discrete
sets
whose
slope
is
12
and
whose
limit
is
the
Hermite
polynomials.
On
the
other
hand,
the
natural
system
of
polynomials
at
the
ï¬nite
primes,
i.e.,
the
binomial
coeï¬ƒcient
polynomials
T
[n]
(cf.
the
discussion
at
the
beginning
of
this
Â§),
have
slope
0,
i.e.,
the
exact
same
polynomials
T
[n]
capture
the
integral
structure
at
ï¬nite
primes
of
Z-valued
functions
on
the
set
{0,
.
.
.
,
d
âˆ’
1},
regardless
of
the
size
of
d.
It
turns
out
that
the
combinatorics
of
these
three
types
of
systems,
i.e.,
Legendre,
Hermite,
and
binomial,
are
fundamental
to
the
theory
of
the
comparison
isomorphism
at
archimedean
places
(cf.
Chapter
VIII).
Moreover,
in
Chapter
VIII,
we
shall
see
that
these
three
types
of
systems
form
the
fundamental
models
of
approximation
that
allow
us
to
estimate
the
diï¬€erence
between
the
natural
metrics
on
the
spaces
of
â€œde
Rham
functionsâ€
and
â€œeÌtale
functionsâ€
(cf.
Â§0).
Also,
it
is
interesting
to
note
that
the
slopes
of
these
three
models,
i.e.,
1,
12
,
and
0,
are
exactly
the
same
as
the
slopes
of
Frobenius
that
appear
in
the
Frobenius
action
on
the
ï¬rst
crystalline
cohomology
group
associated
to
an
elliptic
curve
in
characteristic
p.
Indeed,
it
is
precisely
because
we
feel
that
there
is
a
deep
analogy
between
these
two
notions
of
â€œslopeâ€
that
we
chose
the
name
â€œslopeâ€
for
the
invariant
Î»
of
the
above
discussion.
For
more
on
this
analogy,
we
refer
to
the
discussion
of
Â§6.
Â§4.
The
KaÌˆhler
Geometry
of
a
Polarized
Elliptic
Curve
In
this
Â§,
we
study
the
KaÌˆhler
geometry
of
a
polarized
elliptic
curve
(i.e.,
an
elliptic
curve
equipped
with
a
line
bundle
of
degree
1)
over
C.
Since
the
underlying
real
analytic
manifold
of
such
an
elliptic
curve
is
a
two
(real)
dimensional
torus,
it
is
natural
to
expect
that
the
topology
of
the
torus
will
play
a
fundamental
role
in
our
analysis.
In
fact,
the
key
technology
that
we
will
use
in
this
Â§
is
a
sort
of
Lie
algebra
version
of
the
theta
groups
discussed
in
Chapter
IV,
Â§1.
That
is
to
say,
just
as
the
theta
group
of
a
line
bundle
may
essentially
be
thought
of
as
the
extension
of
(a
certain
portion
of)
the
eÌtale
fundamental
2
group
of
the
elliptic
curve
determined
by
the
eÌtale
cohomological
ï¬rst
Chern
class
(âˆˆ
Het
â€“
i.e.,
the
â€œWeil
pairingâ€)
of
the
line
bundle
in
question,
the
â€œdiï¬€erential
theta
groupâ€
that
we
consider
here
may
be
thought
of
as
the
extension
of
the
topological
fundamental
group
tensored
with
C
determined
by
the
diï¬€erential-geometric
ï¬rst
Chern
class
of
the
line
bundle
in
question.
This
technology
will
allow
us
to
analyze
(in
terms
of
various
diï¬€erential
operators)
the
structure
of
certain
natural
metrics
on
the
space
of
sections
of
the
line
bundle
in
question
over
the
universal
extension
of
the
elliptic
curve.
This
analysis
will
be
important
in
the
following
Â§â€™s
since
it
will
allow
us
to
relate
these
natural
metrics
to
the
canonical
Schottky-Weierstrass
zeta
functions
of
Chapter
III,
Â§7;
Chapter
IV,
Â§3.
We
remark
that
the
material
of
this
Â§
is
â€œin
principle
well-known,â€
but
we
do
not
know
an
adequate
reference
for
it.
242
Let
E
be
an
elliptic
curve
over
C.
We
shall
often
write
E
for
the
complex
manifold
â€ 
deï¬ned
by
the
given
(algebraic)
elliptic
curve.
Let
us
write
ER
(respectively,
ER
)
for
the
underlying
real
analytic
manifold
associated
to
E
(respectively,
the
universal
extension
E
â€ 
of
E).
Then
recall
(cf.
Chapter
III,
Deï¬nition
3.2)
that
we
have
a
canonical
real
analytic
section
â€ 
ÎºR
:
ER
â†’
ER
of
the
universal
extension
E
â€ 
â†’
E
of
E.
This
section
ÎºR
is
the
unique
real
analytic
section
â€ 
that
respects
the
group
structures
of
ER
,
ER
.
Let
us
write
R
â€ 
for
the
subsheaf
of
the
push-forward
of
O
â€ 
to
OE
consisting
of
E
E
sections
of
ï¬nite
torsorial
degree
(cf.
Chapter
III,
Deï¬nition
2.2).
Thus,
R
â€ 
admits
an
E
exhaustive
ï¬ltration
{F
n
(R
â€ 
)},
where
F
n
(R
â€ 
)
is
the
subsheaf
of
sections
of
torsorial
E
E
degree
<
n.
In
particular,
F
n
(R
â€ 
)
is
a
holomorphic
vector
bundle
of
rank
n
on
E.
E
Moreover,
(F
n+1
/F
n
)(R
â€ 
)
=
Ï„EâŠ—n
âŠ—C
OE
E
âˆ¨
(where
Ï„E
=
Ï‰E
,
and
Ï‰E
is
the
cotangent
space
to
E
at
the
origin).
Next,
let
us
observe
that
the
real
analytic
splitting
ÎºR
of
the
torsor
E
â€ 
â†’
E
induces
a
real
analytic
splitting
of
the
ï¬ltration
on
R
â€ 
:
E
R
â€ 
âŠ—OE
OER
=
E

Ï„EâŠ—n
âŠ—C
OER
nâ‰¥0
Here,
we
write
OER
for
the
sheaf
of
complex-valued
real
analytic
functions
on
ER
.
Now
let
dÎ¼
be
the
unique
(real
analytic)
(1,
1)-form
on
E
which
is
invariant
with
respect
to
translation
by
elements
of
E
and
whose
integral
satisï¬es:
dÎ¼
=
1
E
Write
def
L
=
OE
(eE
)
def
(where
eE
is
the
origin
of
E).
Thus,
L
is
a
holomorphic
line
bundle
on
E.
Write
LR
=
L
âŠ—OE
OER
.
Let
||
âˆ¼
||L
be
a
Hermitian
metric
on
L
whose
curvature
Î˜L
(i.e.,
the
(1,
1)form
given
locally
by
âˆ‚âˆ‚
log(||s||L
),
where
s
is
a
nonvanishing
holomorphic
section
of
L)
satisï¬es:
243
1
Â·
Î˜L
=
dÎ¼
2Ï€i
(Such
a
Hermitian
metric
always
exists,
and,
moreover,
is
unique
up
to
a
positive
real
constant
multiple
â€“
cf.,
e.g.,
[Mumf1,2,3],
Â§12,
Corollary
to
Lemma
1.)
Note
that
dÎ¼
induces
def
a
metric
||
âˆ¼
||Ï„
on
Ï„E
;
||
âˆ¼
||L
and
dÎ¼
induce
a
metric
||
âˆ¼
||VR
on
VR
=
Î“(ER
,
LR
):
def
||Ï†||2VR
=
E
||Ï†||2L
Â·
dÎ¼
(for
Ï†
âˆˆ
VR
).
In
the
following
discussion,
it
will
be
useful
to
trivialize
Ï‰E
once
and
for
all
by
some
diï¬€erential
form
Î¸
such
that
||Î¸||Ï‰
=
1
(where
||
âˆ¼
||Ï‰
is
the
dual
metric
to
||
âˆ¼
||Ï„
).
âˆ¨
Thus,
Î¸
also
deï¬nes
a
trivialization
Î¸
âˆ¨
of
Ï„E
,
as
well
as
trivializations
Î¸,
Î¸
of
the
complex
conjugates
of
Ï‰E
and
Ï„E
.
Moreover,
one
checks
easily
that
Î¸
âˆ§
Î¸
is
imaginary
(i.e.,
complex
conjugation
acts
on
it
by
multiplication
by
âˆ’1).
Thus,
Î¸
âˆ§
Î¸
=
âˆ’i
Â·
dÎ¼
(where
the
sign
preceding
â€œiâ€
may
be
checked
by
computing
using
local
coordinates).
Moreover,
the
trivialization
Î¸
âˆ¨
allows
us
to
think
of
R
â€ 
âŠ—OE
OER
=
E

Ï„EâŠ—n
âŠ—C
OER
nâ‰¥0
as
the
OER
-algebra
OER
[TDR
]
of
polynomials
in
the
indeterminate
TDR
.
Now
write
def
Vn
=
Î“(E,
L
âŠ—OE
F
n
(R
â€ 
))
E
Then
we
can
deï¬ne
two
natural
metrics
on
Vn
,
as
follows:
(1)
Let
s
âˆˆ
Vn
.
Then
the
above
real
analytic
splitting
of
the
ï¬ltration
on
R
â€ 
induces
a
decomposition
of
s
into
components:
s
=
s[0]
+
s[1]
Â·
E
nâˆ’1
,
where
s[i]
âˆˆ
VR
.
Now
we
deï¬ne
TDR
+
.
.
.
+
s[n
âˆ’
1]
Â·
TDR
def
||s||L2DR
=

||s[i]||VR
i
We
shall
refer
to
this
metric
as
the
L2DR
-metric
on
Vn
.
244
(2)
Let
s
âˆˆ
Vn
.
Then
one
may
think
of
s
as
a
(holomorphic)
section
of
L
over
E
â€ 
.
If
we
pull-back
this
section
via
ÎºR
,
we
obtain
a
real
analytic
section
sR
âˆˆ
VR
.
(Note
that
in
the
notation
of
(1)
above,
sR
=
s[0].)
Then
we
deï¬ne
def
||s||L2R
=
||sR
||VR
We
shall
refer
to
this
metric
as
the
L2R
-metric
on
Vn
.
One
of
the
goals
of
this
Â§
is
to
describe
the
precise
relationship
between
the
L2DR
-
and
L2R
-metrics.
To
do
this,
we
must
introduce
various
diï¬€erential
operators,
as
follows.
First,
let
us
denote
by
âˆ‡R
:
LR
â†’
LR
âŠ—OER
Î©ER
(where
Î©ER
is
the
rank
two
locally
free
OER
-module
of
(complex-valued)
diï¬€erentials
on
ER
)
naturally
associated
to
the
metric
||
âˆ¼
||L
(cf.,
e.g.,
[Wells],
Chapter
III,
Theorem
2.1).
Then
the
decomposition
0,1
Î©ER
=
Î©1,0
ER
âŠ•
Î©ER
0,1
1,0
(where
Î©1,0
ER
=
Î©E
âŠ—OE
OER
,
and
Î©ER
is
the
complex
conjugate
of
Î©ER
)
induces
a
decomposition
âˆ‡R
=
âˆ‡1,0
âŠ•
âˆ‡0,1
where
âˆ‡0,1
is
simply
the
âˆ‚-operator
on
L.
If
we
think
of
E
â€ 
â†’
E
as
the
torsor
of
holomorphic
connections
on
Lâˆ’1
(cf.
Chapter
III,
Theorem
4.2),
then
we
see
that
the
(1,
0)-component
âˆ‡1,0
induces
a
real
analytic
section
â€ 
Îºâˆ‡
R
:
ER
â†’
ER
Moreover:
Proposition
4.1.
We
have:
ÎºR
=
Îºâˆ‡
R
,
i.e.,
the
canonical
real
analytic
section
ÎºR
of
Chapter
III,
Deï¬nition
3.2,
is
the
same
as
the
real
analytic
section
deï¬ned
by
the
canonical
connection
âˆ‡R
associated
to
||
âˆ¼
||L
.
245
Proof.
Since
E
â€ 
â†’
E
is
a
holomorphic
torsor,
we
may
consider
âˆ‚
of
real
analytic
sections
s
of
this
torsor.
Such
a
âˆ‚(s)
will
be
a
real
analytic
(1,
1)-form
on
E
whose
integral
âˆ‚(s)
=
âˆ’1
E
is
precisely
the
class
in
H
1
(E,
Î©E
)
âˆ¼
=
C
corresponding
to
the
torsor
E
â€ 
â†’
E.
Next,
let
us
observe
that
(it
follows
from
the
deï¬nitions
that)
âˆ‚(Îºâˆ‡
R
)
is
a
constant
multiple
of
the
curvature
Î˜L
,
hence
is
translation
invariant.
On
the
other
hand,
one
sees
immediately
from
the
deï¬nition
of
ÎºR
(cf.
Chapter
III,
Deï¬nition
3.2)
â€“
which
is
essentially
a
matter
def
of
linear
algebra
â€“
that
âˆ‚(ÎºR
)
is
also
translation
invariant.
Thus,
if
we
write
Î·
=
ÎºR
âˆ’
Îºâˆ‡
R
for
the
(1,
0)-form
on
E
given
by
the
diï¬€erence
between
the
two
sections
in
question,
we
see
that
âˆ‚(Î·)
is
a
translation
invariant
(1,
1)-form
whose
integral
is
zero.
Thus,
âˆ‚(Î·)
=
0,
i.e.,
Î·
is
holomorphic.
Moreover,
Î·
âˆˆ
Î“(E,
Î©E
)
=
Ï‰E
will
be
zero
if
it
is
invariant
under
pull-back
by
the
automorphism
Î±
:
E
â†’
E
given
by
multiplication
by
âˆ’1.
On
the
other
hand,
it
is
clear
from
the
deï¬nitions
that
both
ÎºR
and
Îºâˆ‡
R
are
invariant
with
respect
to
Î±.
Thus,
Î±(Î·)
=
Î·,
which
implies
that
Î·
=
0,
as
desired
(cf.
the
proof
of
Chapter
III,
Theorem
5.6).

Remark.
Note
that
if
Gm
â†’
E
=
Gm
/q
Z
is
a
Schottky
uniformization
(as
in
the
discussion
preceding
Chapter
III,
Deï¬nition
3.3),
then
the
splitting
ÎºÎ›1
:
Gm
â†’
E
â€ 
|Gm
of
Chapter
III,
Deï¬nition
3.3,
coincides
with
ÎºR
on
S1
âŠ†
CÃ—
=
Gm
.
(Here,
note
that

since
S1
q
Z
=
{1},
we
also
have
an
inclusion
S1
â†’
Gm
/q
Z
=
E.)
Indeed,
this
follows
from
the
fact
that
both
ÎºR
|S1
and
ÎºÎ›1
|S1
are
continuous
group
homomorphisms.
Thus,
their
diï¬€erence
is
a
continuous
group
homomorphism
S1
â†’
Ï‰E
(âˆ¼
=
C),
hence
is
zero.
1
This
coincidence
of
ÎºR
and
ÎºÎ›1
on
S
âŠ†
Gm
,
E
will
be
important
in
the
computations
of
this
Chapter
since
it
will
allow
us
to
relate
the
real
analytic
theory
of
the
present
Â§
to
the
arithmetic
Schottky
uniformizations
over
Z
that
appeared
throughout
Chapters
III-VI.
Now
we
would
like
to
study
the
various
diï¬€erential
operators
introduced
above.
Recall
that
in
the
above
discussion,
we
chose
trivializations
Î¸,
Î¸
of
Ï‰E
,
Ï‰
E
(the
complex
conjugate
of
Ï‰E
).
These
trivializations
allow
us
to
regard
the
operators
âˆ‡1,0
and
âˆ‡0,1
as
operators
on
VR
=
Î“(ER
,
LR
).
Note
that
the
L2
-norm
||
âˆ¼
||VR
deï¬ned
above
on
VR
corresponds
naturally
to
an
inner
product

âˆ’,
âˆ’
VR
on
VR
.
Proposition
4.2.
We
have:
(âˆ‡1,0
)âˆ—
=
âˆ‡0,1
;
(âˆ‡0,1
)âˆ—
=
âˆ‡1,0
(where
â€œâˆ—â€
denotes
the
adjoint
of
an
operator
on
VR
equipped
with
the
inner
product

âˆ’,
âˆ’
VR
).
Proof.
Indeed,
if
Ï†,
Ïˆ
âˆˆ
VR
,
then
246

âˆ‡1,0
(Ï†),
Ïˆ
VR
=
i
Â·

âˆ‡1,0
(Ï†)
Â·
Î¸,
Ïˆ
Â·
Î¸
L
E
i
Â·

âˆ‡R
(Ï†),
Ïˆ
Â·
Î¸
L
=
E
=âˆ’
i
Â·

Ï†,
âˆ‡R
(Ïˆ
Â·
Î¸)
L
+
E
=âˆ’
i
Â·
d

Ï†,
Ïˆ
Â·
Î¸
L
E
i
Â·

Ï†,
âˆ‡R
(Ïˆ
Â·
Î¸)
L
E
i
Â·

Ï†,
âˆ‡0,1
(Ïˆ)
Â·
Î¸
âˆ§
Î¸
L
=
E

Ï†,
âˆ‡0,1
(Ïˆ)
L
Â·
dÎ¼
=

Ï†,
âˆ‡0,1
(Ïˆ)
VR
=
E
Here,
the
second
(respectively,
third;
fourth;
ï¬fth)
equality
follows
from
the
fact
that
all
(0,
2)-forms
are
identically
zero
(respectively,
the
fact
that
âˆ‡R
preserves
the
metric
||
âˆ¼
||L
;
Stokesâ€™
theorem;
the
fact
that
all
(2,
0)-forms
are
identically
zero),
and
we
recall
that
Î¸
âˆ§
Î¸
=
âˆ’i
Â·
dÎ¼
Thus,
(âˆ‡1,0
)âˆ—
=
âˆ‡0,1
,
as
desired.
The
relation
(âˆ‡0,1
)âˆ—
=
âˆ‡1,0
follows
similarly.

Thus,
in
the
following,
we
shall
simply
write:
âˆ—
def
âˆ‚
=
âˆ‡1,0
;
def
âˆ‚
=
âˆ‡0,1
âˆ—
Put
another
way,
âˆ‚
(respectively,
âˆ‚)
is
simply
âˆ‡R
evaluated
in
the
direction
Î¸
âˆ¨
(respecâˆ¨
tively,
Î¸
).
âˆ—
Proposition
4.3.
We
have:
[âˆ‚
,
âˆ‚]
=
âˆ’2Ï€.
âˆ¨
Proof.
Note
that
[Î¸
âˆ¨
,
Î¸
]
=
0.
(Indeed,
this
follows
from
the
fact
that
the
Lie
algebra
of
the
complex
Lie
group
E
â€ 
is
abelian!)
Thus,
it
follows
from
the
deï¬nitions
(cf.
[Wells],
âˆ—
Chapter
III,
Proposition
1.9)
that
[âˆ‚
,
âˆ‚]
is
simply
the
curvature
Î˜L
(which
is
a
(1,
1)-form)
âˆ—
divided
by
Î¸
âˆ§
Î¸
=
âˆ’i
Â·
dÎ¼,
i.e.,
[âˆ‚
,
âˆ‚]
=
âˆ’2Ï€,
as
desired.

Remark.
One
can
now
deï¬ne
the
Lie
algebra
GLdiï¬€
to
be
the
Lie
algebra
(over
C)
of
âˆ—
operators
on
VR
generated
by
1,
âˆ‚,
âˆ‚
.
Thus,
we
have
an
exact
sequence
0
â†’
C
Â·
1
â†’
GLdiï¬€
â†’
Lie(E
â€ 
)
â†’
0
247
âˆ—
where
C
Â·
1
is
central
in
GLdiï¬€
,
and
Lie(E
â€ 
)
=
C
Â·
âˆ‚
+
C
Â·
âˆ‚
is
the
Lie
algebra
of
E
â€ 
.
Moreover,
the
commutator
product
of
GLdiï¬€
deï¬nes
a
bilinear
morphism
Lie(E
â€ 
)
Ã—
Lie(E
â€ 
)
â†’
C
âˆ—
that
maps
(âˆ‚
,
âˆ‚)
â†’
âˆ’2Ï€
(by
Proposition
4.3).
This
bilinear
form
is
essentially
the
â€œdifferential
geometricâ€
ï¬rst
Chern
class
of
the
line
bundle
L.
Thus,
this
â€œdiï¬€erential
theta
groupâ€
GLdiï¬€
is
very
much
analogous
to
the
â€œeÌtale
theta
groupsâ€
reviewed
in
Chapter
IV,
Â§1.
Next,
we
would
like
to
consider
the
following
Laplacian
operator
on
VR
:
def
Î”
=
1
âˆ—
Â·âˆ‚
Â·âˆ‚
2Ï€
Then
we
have
the
following:
Proposition
4.4.
We
have:
(i.)
Î”âˆ—
=
Î”
(ii.)
Î”
Â·
âˆ‚
=
âˆ‚
Â·
(Î”
âˆ’
1)
âˆ—
âˆ—
(iii.)
Î”
Â·
âˆ‚
=
âˆ‚
Â·
(Î”
+
1)
In
particular,
the
eigenvalues
of
Î”
are
all
real
and
nonnegative,
and
eigenfunctions
of
Î”
with
distinct
eigenvalues
are
orthogonal
to
one
another
(with
respect
to

âˆ’,
âˆ’
VR
).
Moreover,
if,
for
s
âˆˆ
VR
,
Î»
âˆˆ
R,
we
have
Î”(s)
=
Î»
Â·
s,
then
Î”(âˆ‚(s))
=
(Î»
âˆ’
1)
Â·
(âˆ‚(s));
âˆ—
âˆ—
Î”(âˆ‚
(s))
=
(Î»
+
1)
Â·
(âˆ‚
(s)).
âˆ—
âˆ—
Proof.
(i.)
Since
(âˆ‚)âˆ—
=
âˆ‚
,
(âˆ‚
)âˆ—
=
âˆ‚,
we
obtain
immediately
that
Î”âˆ—
=
Î”.
âˆ—
âˆ—
(ii.)
Compute
(using
Proposition
4.3):
2Ï€
Â·Î”Â·âˆ‚
=
âˆ‚
Â·âˆ‚
Â·âˆ‚
=
âˆ‚
Â·âˆ‚
Â·âˆ‚
âˆ’2Ï€
Â·âˆ‚
=
2Ï€
Â·(âˆ‚
Â·Î”âˆ’âˆ‚).
âˆ—
âˆ—
âˆ—
âˆ—
âˆ—
âˆ—
(iii.)
Compute
(using
Proposition
4.3):
2Ï€
Â·
Î”
Â·
âˆ‚
=
âˆ‚
Â·
âˆ‚
Â·
âˆ‚
=
âˆ‚
Â·
âˆ‚
Â·
âˆ‚
+
2Ï€
Â·
âˆ‚
=
âˆ—
âˆ—
2Ï€
Â·
(âˆ‚
Â·
Î”
+
âˆ‚
).
The
ï¬nal
remarks
â€”
except
for
the
fact
that
the
eigenvalues
are
â‰¥
0,
but
this
follows
from
the
well-known
argument:
Î”(s)
=
Î»
Â·
s
=â‡’
Î»

s,
s
VR
=

s,
Î”(s)
VR
=
248

âˆ‚(s),
âˆ‚(s)
VR
â‰¥
0
â€”
in
Proposition
4.4
are
formal
consequences
of
(i.),
(ii.),
and
(iii.).

We
are
now
ready
to
prove
the
following
result:
Theorem
4.5.
The
pull-back
morphism
Îºâˆ—R
:
Vn
â†’
VR
n
is
injective,
and
its
image
is
equal
to
the
kernel
of
âˆ‚
(as
an
operator
on
VR
).
In
fact,
to
apply
âˆ‚
to
an
element
of
the
image
of
Îºâˆ—R
:
Vn
â†’
VR
corresponds
to
applying
the
âˆ¨
relative
exterior
diï¬€erential
operator
(in
the
direction
Î¸
)
of
the
morphism
E
â€ 
â†’
E
to
the
corresponding
element
of
Vn
.
In
particular,
Ker(âˆ‚)
âˆ¼
=
V1
is
a
one-dimensional
complex
DR
vector
space.
If
Î¶0
âˆˆ
Ker(âˆ‚)
is
nonzero,
write
def
Î¶nDR
=
1
âˆ—
Â·
(âˆ‚
)n
(Î¶0DR
)
n!
def
if
n
>
0,
Î¶nDR
=
0
if
n
<
0.
Then
for
n
â‰¥
0,
we
have:
C
Â·
Î¶nDR
=
Ker(Î”
âˆ’
n),
and
n+1
âˆ—
DR
Î¶0DR
,
.
.
.
,
Î¶nDR
form
an
orthogonal
basis
of
Ker(âˆ‚
)
such
that
âˆ‚
(Î¶nDR
)
=
(n
+
1)
Â·
Î¶n+1
;
n
(2Ï€)
DR
DR
DR
2
DR
2
âˆ‚(Î¶n
)
=
2Ï€
Â·
Î¶nâˆ’1
;
||Î¶n
||VR
=
n!
Â·
||Î¶0
||VR
.
Proof.
That
Îºâˆ—R
:
Vn
â†’
VR
is
injective
follows
from
the
fact
that
if
it
were
not,
then
the
image
of
ÎºR
would
be
contained
inside
a
one-dimensional
complex
subvariety
of
E
â€ 
,
which
is
absurd
(cf.
the
deï¬nition
of
ÎºR
in
Chapter
III,
Â§3).
The
statement
concerning
the
correspondence
between
âˆ‚
and
the
relative
exterior
diï¬€erential
operator
for
E
â€ 
â†’
E
follows
immediately
from
the
deï¬nitions
(cf.
also
the
discussion
of
Chapter
III,
Â§3).
n
To
see
that
the
image
Îºâˆ—R
(Vn
)
is
equal
to
Ker(âˆ‚
),
we
reason
as
follows:
First,
the
statement
concerning
the
relationship
between
âˆ‚
and
the
relative
exterior
diï¬€erenn
tial
operator
of
E
â€ 
â†’
E
implies
that
Îºâˆ—R
(Vn
)
âŠ†
Ker(âˆ‚
).
Thus,
in
particular,
we
see
n
that
dimC
(Ker(âˆ‚
))
â‰¥
n.
On
the
other
hand,
one
proves
easily
by
induction
on
n
that
n
dimC
(Ker(âˆ‚
))
â‰¤
n:
Indeed,
this
is
clear
if
n
=
1,
since
(by
deï¬nition)
Ker(âˆ‚)
=
Î“(E,
L).
n
nâˆ’1
If
n
â‰¥
2,
then
note
that
âˆ‚
deï¬nes
a
morphism
Ker(âˆ‚
)
â†’
Ker(âˆ‚
)
whose
kernel
has
n
dimension
â‰¤
1.
Thus,
by
the
induction
hypothesis,
we
conclude
that
dimC
(Ker(âˆ‚
))
â‰¤
n
1
+
(n
âˆ’
1)
=
n,
as
desired.
This
completes
the
proof
that
Îºâˆ—R
(Vn
)
=
Ker(âˆ‚
).
That
Î”(Î¶nDR
)
=
n
Â·
Î¶nDR
(for
n
â‰¥
0)
follows
from
Proposition
4.4,
(iii.),
induction
on
n,
and
the
fact
that
Î”(Î¶0DR
)
=
0.
If,
for
s
âˆˆ
VR
,
we
have
Î”(s)
=
n
Â·
s
(for
n
â‰¥
1),
then
by
Proposition
4.4,
(ii.),
Î”(âˆ‚(s))
=
(n
âˆ’
1)
Â·
âˆ‚(s).
Thus,
by
induction
on
n,
we
obtain
that
n
Î”(s)
=
n
Â·
s
(for
n
â‰¥
1)
implies
âˆ‚
(s)
âˆˆ
Ker(Î”).
But
if
Î”(t)
=
0,
then
249
âˆ—

âˆ‚(t),
âˆ‚(t)
VR
=

t,
âˆ‚
Â·
âˆ‚(t)
VR
=

t,
Î”(t)
VR
=
0
n+1
).
On
the
other
hand,
this
imso
âˆ‚(t)
=
0.
Thus,
in
summary,
Ker(Î”
âˆ’
n)
âŠ†
Ker(âˆ‚
DR
DR
plies
that
Î¶0
,
.
.
.
,
Î¶n
(which
are
mutually
orthogonal
by
Proposition
4.4,
hence
linearly
n+1
),
which
(as
we
saw
above)
has
dimension
n
+
1.
independent
over
C)
are
âˆˆ
Ker(âˆ‚
n+1
DR
DR
Thus,
we
conclude
that
Î¶0
,
.
.
.
,
Î¶n
form
an
orthogonal
basis
of
Ker(âˆ‚
),
and
that
DR
Ker(Î”
âˆ’
n)
=
C
Â·
Î¶n
,
as
desired.
âˆ—
DR
DR
follows
from
the
deï¬nitions.
That
âˆ‚(Î¶nDR
)
=
2Ï€
Â·
Î¶nâˆ’1
That
âˆ‚
(Î¶nDR
)
=
(n
+
1)
Â·
Î¶n+1
follows
by
computing
(using
Proposition
4.3):
âˆ—
DR
DR
DR
âˆ‚(Î¶nDR
)
=
nâˆ’1
Â·
âˆ‚
Â·
âˆ‚
(Î¶nâˆ’1
)
=
2Ï€
Â·
nâˆ’1
Â·
(Î”
+
1)(Î¶nâˆ’1
)
=
2Ï€
Â·
Î¶nâˆ’1
n
DR
2
Finally,
||Î¶nDR
||2VR
=
(2Ï€)
n!
Â·
||Î¶0
||VR
follows
by
computing:
DR
DR
,
Î¶nâˆ’1

2Ï€
Â·
n
Â·

Î¶nDR
,
Î¶nDR

=
2Ï€
Â·

Î”(Î¶nDR
),
Î¶nDR

=

âˆ‚(Î¶nDR
),
âˆ‚(Î¶nDR
)

=
(2Ï€)2
Â·

Î¶nâˆ’1
This
completes
the
proof
of
Theorem
4.5.

We
are
now
ready
to
analyze
the
relationship
between
the
L2DR
-
and
L2R
-metrics:
Corollary
4.6.
Let
Î¶nDR
[TDR
]
âˆˆ
Vn
be
the
unique
element
such
that
Îºâˆ—R
(Î¶nDR
[TDR
])
=
Î¶nDR
.
Then,
relative
to
the
above
decomposition
of
R
â€ 
âŠ—OE
OER
,
we
have:
E
Î¶nDR
[TDR
]
=
n

Î¶iDR
Â·
nâˆ’i

DR
)

(2Ï€
Â·
T
(n
âˆ’
i)!

(2Ï€
Â·
T
)n


(2Ï€
Â·
T
)nâˆ’1

DR
DR
DR
+
Î¶1DR
Â·
+
.
.
.
+
Î¶nâˆ’1
=
Î¶0DR
Â·
Â·
(2Ï€
Â·
TDR
)
+
Î¶nDR
n!
(n
âˆ’
1)!
i=0
In
particular,
Î¶0DR
[TDR
],
Î¶1DR
[TDR
],
.
.
.
,
Î¶nDR
[TDR
],
.
.
.
are
mutually
orthogonal
with
respect
to
both
the
L2DR
-
and
L2R
-metrics,
and
their
norms
are
given
as
follows:
If
we
rescale
the
metric
on
Ï„E
so
that
|TDR
|
=
Ï
âˆˆ
R>0
(note
that
in
the
above
discussion
Ï
=
1),
then
||
Î¶nDR
[TDR
]
||L2R
=
||Î¶nDR
||VR
=
250

(2Ï€)n

12
n!
Â·
||Î¶0DR
||VR
n


(2Ï€
Â·
Ï)nâˆ’i
2

(2Ï€)i

12
Â·
Â·
||Î¶0DR
||VR
(n
âˆ’
i)!
i!
i=0
n



n
(2Ï€
Â·
Ï2
)i

12
DR
=
||
Î¶n
[TDR
]
||L2R
Â·
i
i!
i=0
||
Î¶nDR
[TDR
]
||L2DR
=
=
||
Î¶nDR
[TDR
]
||L2R
Â·
Cn
(Ï)
n
where
1
â‰¤
Cn
(Ï)
â‰¤
eÏ€
Â·
2
2
Â·
Max(1,
Ïn
).
Proof.
Let
us
ï¬rst
show
that
Î¶nDR
[TDR
]
=
Î¶0DR
Â·

(2Ï€
Â·
T
n
DR
)
n!
+
Î¶1DR
Â·

(2Ï€
Â·
T
nâˆ’1

DR
)
(n
âˆ’
1)!
DR
+
.
.
.
+
Î¶nâˆ’1
Â·
(2Ï€
Â·
TDR
)
+
Î¶nDR
We
use
induction
on
n.
The
result
is
clear
for
n
=
0,
so
assume
the
result
known
for
â€œn
âˆ’
1.â€
The
fact
that
the
constant
term
of
Î¶nDR
[TDR
]
is
Î¶nDR
follows
from
the
deï¬nition
of
Î¶nDR
[TDR
].
Thus,
to
prove
the
above
equality,
it
suï¬ƒces
to
prove
it
after
applying
âˆ‚
âˆ‚
âˆ—
âˆ‚TDR
.
Since
applying
âˆ‚TDR
corresponds
(relative
to
pull-back
via
ÎºR
)
to
applying
âˆ‚
to
the
DR
corresponding
element
of
VR
(cf.
Theorem
4.5),
it
follows
(since
âˆ‚(Î¶nDR
)
=
2Ï€
Â·
Î¶nâˆ’1
by
Theorem
4.5)
that
it
suï¬ƒces
to
show
that
DR
2Ï€
Â·
Î¶nâˆ’1
[TDR
]
=
Î¶0DR
Â·
nâˆ’1

DR
)

2Ï€
Â·
(2Ï€
Â·
T
(n
âˆ’
1)!
+
Î¶1DR
Â·
nâˆ’2

DR
)

2Ï€
Â·
(2Ï€
Â·
T
(n
âˆ’
2)!
DR
+
.
.
.
+
Î¶nâˆ’1
Â·
(2Ï€)
But
this
follows
from
the
induction
hypothesis.
This
completes
the
computation
of
the
components
of
Î¶nDR
[TDR
].
The
statement
concerning
orthogonality
then
follows
from
the
statement
concerning
the
orthogonality
of
the
Î¶nDR
â€™s
in
Theorem
4.5.
The
computation
of
the
norms
also
follows
from
the
norm
computation
of
Theorem
4.5
(together
with
the
elementary
facts
that
n
n
xi
n
x
i=0
i!
â‰¤
e
for
x
â‰¥
0).

i
â‰¤
2
,
Remark
1.
One
can
regard
the
results
of
Corollary
4.6
as
the
computation
of
the
analytic
def
torsion
of
Vn
=
Î“(E,
L
âŠ—OE
F
n
(R
â€ 
)).
If
there
were
â€œno
analytic
torsion,â€
then
the
norm
E
of
Î¶nDR
[TDR
]
would
go
roughly
as
the
norm
of
its
â€œleading
term,â€
i.e.,
roughly
as
(2Ï€)n
n!
251
n
1
2
not
as
(
(2Ï€)
n!
)
(as
in
Corollary
4.6).
Remark
2.
The
reader
may
already
have
noticed
many
formal
similarities
between
Theorem
4.5,
Corollary
4.6
above
and
Chapter
III,
Theorem
7.4.
These
similarities
are
by
no
means
an
accident.
In
Â§5
below,
we
will
discuss
the
relationship
between
the
theory
of
the
present
Â§
and
the
theory
of
the
canonical
Schottky-Weierstrass
functions
of
Chapter
III,
Â§7.
Remark
3.
Just
as
in
Chapter
III,
Remark
3
(following
Chapter
III,
Theorem
7.4),
one
can
give
a
more
â€œgenerating
function-theoreticâ€
formulation
of
the
Corollary
4.6
as
follows:
Let
s
be
an
indeterminate.
Let
us
write
âˆ‚
â€ 
for
the
â€œâˆ‚-operatorâ€
acting
on
real
analytic
E
â€ 
sections
of
the
holomorphic
line
bundle
L
over
ER
.
Thus,
we
may
regard
âˆ‚
â€ 
as
an
E
operator
on
LR
[TDR
]
âˆ—
If
we
write
âˆ‚,
âˆ‚
for
the
operators
obtained
on
LR
[TDR
]
by
acting
on
the
coeï¬ƒcients,
then
one
computes
easily
that
âˆ‚
â€ 
=âˆ‚âˆ’
E
âˆ‚
âˆ‚TDR
hence
that
âˆ—
âˆ—
[
âˆ‚
â€ 
,
âˆ‚
+
2Ï€
Â·
TDR
]
=
[
âˆ‚,
âˆ‚
]
âˆ’
[
E
âˆ‚
,
2Ï€
Â·
TDR
]
=
2Ï€
âˆ’
2Ï€
=
0
âˆ‚TDR
(by
Proposition
4.3).
Thus,
since
(âˆ‚
â€ 
)(Î¶0DR
)
=
0,
âˆ‚
â€ 
also
annihilates
E
e
âˆ—
(âˆ‚
+2Ï€Â·TDR
)Â·s
Â·
Î¶0DR
=
n


nâ‰¥0
i=0
E
nâˆ’i

DR
(2Ï€
Â·
TDR
)
Â·
sn
Î¶i
Â·
(n
âˆ’
i)!
=
Î¶0DR
[TDR
]
+
Î¶1DR
[TDR
]
Â·
s
+
Î¶2DR
[TDR
]
Â·
s2
+
.
.
.
+
Î¶nDR
[TDR
]
Â·
sn
+
...
The
coeï¬ƒcients
of
this
series
are
precisely
the
functions
discussed
in
Corollary
4.6.
The
norms
computed
in
Corollary
4.6
may
also
be
computed
directly
from
these
exponential
expressions.
We
leave
this
as
an
exercise
for
the
reader.
252
Â§5.
The
Relationship
Between
de
Rham
and
Canonical
Schottky-Weierstrass
Zeta
Functions
In
this
Â§,
we
study
the
relationship
between
the
canonical
Schottky-Weierstrass
(â€œSW
â€
for
short)
zeta
functions
of
Chapter
III,
Â§7,
and
the
de
Rham
(â€œDRâ€
for
short)
zeta
functions
of
Â§4
(i.e.,
the
Î¶nDR
â€™s).
In
a
word,
the
combinatorics
of
this
relationship
are
described
by
the
Hermite
polynomials
(cf.
Proposition
2.2).
Using
the
well-known
explicit
form
of
the
Hermite
polynomials,
we
give
explicit
equations
relating
the
two
types
of
zeta
functions,
and
use
these
equations
to
bound
the
norm
of
the
canonical
SW
zeta
functions
in
terms
of
the
L2DR
-metric
(of
Â§4).
One
way
to
think
about
the
material
of
the
present
Â§
is
to
regard
it
as
corresponding
to
the
usual
Hodge
comparison
theorem
(i.e.,
the
â€œde
Rham
isomorphismâ€
between
de
Rham
cohomology
and
singular
cohomology
â€“
cf.
Chapter
VIII,
Â§1)
over
C,
expressed
at
the
level
of
diï¬€erential
operators,
i.e.,
âˆ—
as
the
relationship
between
the
â€œde
Rham-theoreticâ€
operators
âˆ‚,
âˆ‚
of
Â§4,
which
correspond
to
diï¬€erentiation
in
the
direction
of
the
Hodge
ï¬ltration
and
its
complex
conjugate,
and
the
operator
Î´
âˆ—
of
Chapter
III,
Â§7,
which
corresponds
to
diï¬€erentiation
along
a
topological
cycle
of
the
elliptic
curve.
This
relationship
between
diï¬€erential
operators
is
expressed
at
the
function-theoretic
level
as
the
relationship
between
the
DR
zeta
functions
of
Â§4
and
the
canonical
SW
zeta
functions
of
Chapter
III,
Â§7.
We
continue
with
the
notation
of
Â§4.
Thus,
E
is
an
elliptic
curve
over
C.
Recall
from
the
discussion
of
Chapter
III,
Â§3,
that
one
has
a
natural
isomorphism
â€“
called
the
de
Rham
isomorphism
â€“
1
1
(E,
OE
)
âˆ¼
(E,
2Ï€i
Â·
R)
âŠ—R
C
=
Î›
âŠ—Z
C
HDR
=
Hsing
def
1
(where
Î›
=
Hsing
(E,
2Ï€i
Â·
Z))
of
complex
vector
spaces.
The
left-hand
side
of
this
isomor1
phism,
i.e.,
HDR
(E,
OE
),
may
be
regarded
as
the
tangent
space
to
the
universal
extension
1
(E,
OE
)
â†’
Ï„E
arising
from
the
projection
E
â€ 
,
and
thus
admits
a
natural
surjection
HDR
â€ 
1
E
â†’
E.
Note
that
since
the
right-hand
side
of
this
isomorphism
Hsing
(E,
2Ï€i
Â·
C)
admits
def
a
natural
real
structure
(given
by
Î›R
=
Î›
âŠ—Z
R),
it
follows
that
the
isomorphism
induces
1
on
HDR
(E,
OE
)
a
natural
complex
conjugation
automorphism.
If
we
use
this
automor1
phism
to
conjugate
the
projection
HDR
(E,
OE
)
â†’
Ï„E
,
we
thus
obtain
a
natural
direct
sum
decomposition:
1
(E,
OE
)
=
Ï„E
âŠ•
Ï„Ec
HDR
(where
Ï„Ec
is
the
complex
conjugate
C-vector
space
to
Ï„E
).
Note
that
here
we
use
the
notation
â€œÏ„Ec
â€
rather
than
Ï„
E
because
we
wish
to
think
of
Ï„Ec
here
as
a
â€œholomorphic
253
dimensionâ€
(which
just
happens
to
be
isomorphic
to
the
complex
conjugate
of
Ï„E
),
not
as
an
â€œanti-holomorphic
dimensionâ€
(which
is
the
interpretation
most
commonly
given
to
a
â€œbar,â€
as
in
Ï„
E
).
Next,
suppose
that
we
are
given
a
rank
one
Z-submodule
Î›1
âŠ†
Î›
(cf.
Chapter
III,
Â§3,
the
discussion
of
the
â€œGm
-splittingâ€).
Choose
a
generator
Î»1
âˆˆ
Î›1
.
Then
there
exists
a
unique
isomorphism
of
Ï„E
with
C
relative
to
which
E
may
be
written
in
the
form
E
=
C/

1,
Ï„

=
CÃ—
/q
Z
def
where
the
â€œ1â€
corresponds
to
Î»1
,
q
=
e2Ï€iÏ„
,
and
Im(Ï„
)
>
0.
Relative
to
the
de
Rham
1
isomorphism
and
the
direct
sum
decomposition
of
HDR
(E,
OE
)
discussed
above,
Î»1
corresponds
to
some
element
1
(E,
OE
)
(v,
u
Â·
v
c
)
âˆˆ
Ï„E
âŠ•
Ï„Ec
=
HDR
where
v
c
is
the
element
of
Ï„Ec
deï¬ned
by
v;
u
âˆˆ
C
satisï¬es
|u|
=
1.
Moreover,
the
length
of
v
(relative
to
the
metric
||
âˆ¼
||Ï„
)
of
Â§4)
may
be
computed
as
follows:
Lemma
5.1.
If
Î»1
corresponds
under
the
de
Rham
isomorphism
to
(v,
u
Â·
v
c
)
(where
u
âˆˆ
C
satisï¬es
|u|
=
1),
then
the
length
of
v
is
given
by:
||v||Ï„
=
1
1
{8Ï€
2
Â·
Im(Ï„
)}
2
Proof.
Let
us
think
of
E
as
C/

1,
Ï„

=
CÃ—
/q
Z
,
and
write
z
(respectively,
U
)
for
the
standard
coordinate
on
C
(respectively,
CÃ—
).
Thus,
U
=
exp(2Ï€iz).
Moreover,
the
def
diï¬€erential
corresponding
to
Î»1
âˆˆ
Î›1
is
given
by
d
log(U
)
=
dU
U
=
2Ï€i
Â·
dz.
That
is
to
say,
||v||âˆ’1
=
||d
log(U
)||
=
2Ï€
Â·
||dz||
.
Moreover,
the
deï¬nition
of
||
âˆ¼
||Ï‰
is
such
that
Ï‰
Ï‰
Ï„
def
||dz||2Ï‰
=
!
!
!
!
!
dz
âˆ§
dz
!
=
2
Â·
Im(Ï„
)
E
as
desired.

Now
we
would
like
to
consider
the
relationship
between
the
canonical
SW
zeta
functions
of
Chapter
III,
Â§7,
and
the
DR
zeta
functions
introduced
in
Â§4.
To
avoid
confusion,
let
254
us
denote
the
indeterminate
â€œT
â€
of
Chapter
III,
Â§7,
by
TSW
.
Thus,
we
would
like
to
investigate
the
relationship
between
Î¶nPD
[TSW
]
(cf.
Chapter
III,
Theorem
7.4)
and
Î¶nDR
[TDR
]
(Corollary
4.6).
It
follows
immediately
from
the
deï¬nitions
that
this
essentially
amounts
to
investigating
the
relationship
between
the
diï¬€erential
operators:
âˆ—
âˆ‚
+
TDR
and
Î´
âˆ—
+
TSW
(where
Î´
âˆ—
is
as
in
Chapter
III,
Â§7).
This
relationship
may
be
described
as
follows:
Lemma
5.2.
As
operators
on
the
holomorphic
sections
of
L
over
E
â€ 
,
the
above
two
operators
are
related
as
follows:
âˆ—
L
Â·
(âˆ‚
+
u
Â·
âˆ‚
+
TDR
)
=
Î´
âˆ—
+
TSW
for
some
u,
L
âˆˆ
C,
where
|u|
=
1,
|L|
=
{8Ï€
2
Â·
Im(Ï„
)}âˆ’
2
.
1
Proof.
Note
that
Î´
âˆ—
+
TSW
is
(by
deï¬nition)
the
tautological
connection
on
L|
â€ 
applied
E
in
the
direction
(d
log(U
))âˆ¨
.
Put
another
way,
this
operator
is
the
operator
given
by
1
diï¬€erentiation
in
the
direction
deï¬ned
by
Î»1
âˆˆ
Î›1
âŠ†
Î›C
âˆ¼
(E,
OE
)
(where
we
regard
=
HDR
1
â€ 
HDR
(E,
OE
)
as
the
tangent
space
to
E
).
By
deï¬nition,
the
tangent
space
to
ER
âŠ†
E
â€ 
is
1
given
by
Î›
âŠ—
R
â†’
HDR
(E,
OE
).
Thus,
it
follows
that
this
tangent
direction
is
contained
inside
the
real
analytic
submanifold
ER
âŠ†
E
â€ 
deï¬ned
by
the
section
ÎºR
.
Moreover,
since
Î»1
corresponds
to
(v,
uÂ·v
c
)
under
the
de
Rham
isomorphism,
diï¬€erentiation
in
this
tangent
âˆ—
direction
on
ER
is
given
by
the
operator
L
Â·
(âˆ‚
+
u
Â·
âˆ‚),
for
some
L,
u
as
in
the
statement
of
Lemma
5.2.
Note
that
here,
L
is
deï¬ned
by
the
relation
L
Â·
Î¸
=
(d
log(U
))âˆ¨
.
Similarly,
relative
to
the
decomposition
of
E
â€ 
induced
by
ÎºR
,
the
tautological
connection
(applied
in
the
tangent
direction
in
question)
at
points
of
E
â€ 
with
relative
coordinate
(i.e.,
the
coordinate
of
E
â€ 
over
E)
TDR
is
given
by
adding
to
the
connection
at
the
section
ÎºR
the
))âˆ¨
.â€
But
this
quantity
is
simply
L
Â·
TDR
,
as
desired.

quantity
â€œTDR
times
(d
log(U
Î¸
Remark.
Note
that
the
equality
of
operators
in
Lemma
5.2
does
not
necessarily
hold
when
applied
to
arbitrary
real
analytic
sections
of
L
over
E
â€ 
.
Indeed,
roughly
speaking,
the
operator
on
the
right-hand
side
of
the
formula
in
Lemma
5.2
is
the
â€œholomorphic
portionâ€
of
the
operator
on
the
left-hand
side
of
this
formula.
We
are
now
ready
to
compute
the
precise
relationship
between
Î¶nPD
[TSW
]
and
Î¶nDR
[TDR
].
It
turns
out
that
the
combinatorics
of
this
relationship
are
described
by
the
Hermite
polynomials
(cf.
Proposition
2.2).
Let
us
begin
by
observing
ï¬rst
of
all
that
both
Î¶nPD
[TSW
]
and
Î¶nDR
[TDR
]
are
holomorphic
(hence,
in
particular,
real
analytic)
sections
of
the
line
bundle
L
over
E
â€ 
.
Thus,
it
makes
255
sense
to
compare
them.
Here,
by
Î¶nPD
[TSW
]
we
mean
the
complex
analytic
version
of
the
canonical
Schottky-Weierstrass
zeta
functions
(cf.
Chapter
III,
Remark
1
following
Theorem
7.4).
That
is
to
say,
these
functions
are
the
functions
obtained
by
regarding
the
(clearly
convergent
â€“
since
diï¬€erentiation
does
not
eï¬€ect
convergence)
formal
series
in
q
of
Chapter
III,
Â§7,
as
holomorphic
functions
of
q
=
e2Ï€iÏ„
(where
the
family
of
elliptic
curves
def
in
question
is
given
by
CÃ—
/q
Z
,
and
Ï„
âˆˆ
H
=
{Ï„
âˆˆ
C
|
Im(Ï„
)
>
0}.
Theorem
5.3.
Let
n
â‰¥
0
be
an
integer.
Choose
Î¶0DR
,
Î¶0PD
to
be
the
same
section
Î¶0
âˆˆ
Î“(E,
L).
Then
we
have
the
following
equality
of
holomorphic
(hence,
in
particular,
real
analytic)
sections
of
L
over
E
â€ 
:
def
Î¶nPD
[TSW
]
=
[n/2]

(Ï€
Â·
u)m
Â·
(âˆ‚
âˆ—
+
TDR
)nâˆ’2m
(Î¶
DR
)
1
0
âˆ—
n
PD
n
Â·
(Î´
+
TSW
)
(Î¶0
)
=
L
Â·
n!
m!
(n
âˆ’
2m)!
m=0

(Ï€
Â·
u)m
DR
Â·
Î¶nâˆ’2m
[TDR
]
m!
m=0
[n/2]
=L
Â·
n
where
u,
L
âˆˆ
C
satisfy
|u|
=
1,
|L|
=
{8Ï€
2
Â·
Im(Ï„
)}âˆ’
2
.
1
Similarly,
def
Î¶nDR
[TDR
]
=
[n/2]

(âˆ’Ï€
Â·
u)m
Â·
(Î´
âˆ—
+
TSW
)nâˆ’2m
(Î¶
PD
)
1
âˆ—
0
n
DR
Â·
(âˆ‚
+
TDR
)
(Î¶0
)
=
nâˆ’2m
n!
L
Â·
m!
(n
âˆ’
2m)!
m=0

[n/2]
=
(âˆ’Ï€
Â·
u)m
PD
Â·
Î¶nâˆ’2m
[TSW
]
nâˆ’2m
Â·
m!
L
m=0
Proof.
Indeed,
the
ï¬rst
formula
follows
immediately
by
applying
the
identity

(c/2)m
Â·
B
nâˆ’2m
Â·v
m!
(n
âˆ’
2m)!
m=0
[n/2]
(A
+
B)
Â·
v
=
n!
Â·
n
def
def
âˆ—
(cf.
Remark
1
following
Proposition
2.2)
with
A
=
u
Â·
âˆ‚
and
B
=
âˆ‚
+
TDR
(which
satisfy
âˆ—
A(Î¶0
)
=
u
Â·
âˆ‚(Î¶0
)
=
0
and
[A,
B]
=
u
Â·
[âˆ‚,
âˆ‚
]
=
2Ï€
Â·
u
(by
Proposition
4.3))
to
compute
1
1
âˆ—
Â·
(âˆ‚
+
u
Â·
âˆ‚
+
TDR
)n
(Î¶0DR
)
=
Lâˆ’n
Â·
Â·
(Î´
âˆ—
+
TSW
)n
(Î¶0PD
)
=
Lâˆ’n
Â·
Î¶nPD
[TSW
]
n!
n!
(where
the
ï¬rst
equality
follows
from
Lemma
5.2).
256
def
def
The
second
formula
follows
similarly,
by
letting
A
=
âˆ’u
Â·
âˆ‚,
B
=
Lâˆ’1
Â·
(Î´
âˆ—
+
TSW
).
âˆ—
Thus,
A
+
B
=
âˆ‚
+
TDR
(cf.
Lemma
5.2),
[A,
B]
=
âˆ’2Ï€
Â·
u
(cf.
Proposition
4.3).
Note
that
Lemma
5.2
applies
here
since
the
operator
âˆ‚
(as
we
have
deï¬ned
it
here)
maps
all
of
the
holomorphic
sections
of
L
(over
E
â€ 
)
in
question
to
holomorphic
sections
of
L
(over
E
â€ 
).
Indeed,
this
may
be
veriï¬ed
immediately
by
applying
âˆ‚
to
the
expression
on
the
right-hand
side
of
the
ï¬rst
formula
of
Corollary
4.6
(cf.
also
the
proof
of
Corollary
4.6).

Corollary
5.4.
Let
n
â‰¥
0
be
an
integer.
Choose
Î¶0DR
,
Î¶0PD
to
be
the
same
section
Î¶0
âˆˆ
Î“(E,
L).
Then
if
we
rescale
the
metric
on
Ï„E
so
that
|TDR
|
=
Ï
âˆˆ
R>0
(note
that
in
the
above
discussion
Ï
=
1;
cf.
Corollary
4.6),
then
||
n!
Â·
Î¶nPD
[TSW
]
||L2DR
â‰¤
||Î¶0
||L2DR
Â·
eÏ€
Â·
Max(1,
Ïn
)
Â·

8Ï€
Â·
n

n2
Im(Ï„
)
Proof.
We
compute,
using
Theorem
5.3
and
Corollary
4.6:

[n/2]
1
||
n!
Â·
Î¶nPD
[TSW
]
||L2DR
â‰¤
|n
2
Â·
L|n
Â·
Ï€
n
Â·
â‰¤

n!
DR
[TDR
]
||L2DR
Â·
||
Î¶nâˆ’2m
n
Â·
(m!)
m=0
n
2

n2
n
n
2
2
Â·
eÏ€
Â·
Max(1,
Ïn
)
Â·
||
Î¶
Â·
(2
Â·
Ï€
Â·
2Ï€)
0
||L2DR
8Ï€
2
Â·
Im(Ï„
)


[n/2]
Â·
m=0

12
n!
Â·
n!
nn
Â·
(m!)2
Â·
(n
âˆ’
2m)!
n
n

n2
â‰¤
Â·
(Ï€/2)
2
Â·
eÏ€
Â·
Max(1,
Ïn
)
Â·
||
Î¶0
||L2DR
Im(Ï„
)



[n/2]
Â·
m=0

12
n!
(m!)2
Â·
(n
âˆ’
2m)!
n
n

n2
â‰¤
Â·
(Ï€/2)
2
Â·
eÏ€
Â·
Max(1,
Ïn
)
Â·
||
Î¶0
||L2DR
Â·
3n
Im(Ï„
)

8Ï€
Â·
n

n2
â‰¤
||
Î¶0
||L2DR
Â·
eÏ€
Â·
Max(1,
Ïn
)
Â·
Im(Ï„
)

as
desired.

257
Â§6.
Diï¬€erential
Calculus
on
the
Theta-Weighted
Circle
In
this
Â§,
we
commence
our
study
of
the
function
theory
of
canonical
SW
zeta
functions.
We
begin
by
giving
various
estimates
(which
will
be
useful
to
us
in
Chapter
VIII,
as
well
as
in
the
present
Â§)
of
the
coeï¬ƒcients
of
the
q-expansions
of
several
types
of
canonical
SW
zeta
functions
(Lemmas
6.1,
6.2).
Next,
we
introduce
what
we
call
orthogonal
canonical
SW
zeta
functions.
This
new
type
of
canonical
SW
zeta
function
is
obtained
by
applying
the
orthogonalization
process
discussed
in
Â§1
(cf.,
especially,
Example
(4))
to
(a
slight
variant
of)
the
divided
power
canonical
SW
zeta
functions
of
Chapter
III,
Theorem
7.4,
and
Chapter
IV,
Theorem
3.2.
Certain
limits
(in
which
the
scaling
factor
has
slope
12
â€“
cf.
the
discussion
surrounding
â€œTerminology
3.7â€)
of
the
orthogonal
SW
zeta
functions
give
rise
to
canonical
SW
zeta
functions
based
on
the
Hermite
polynomials
(Theorem
6.7).
Finally,
we
relate
this
fact
to
the
discussion
of
Â§5
(which
may
be
summarized
as
stating
that
the
de
Rham
zeta
functions
are
essentially
Hermite
polynomial-based
canonical
SW
zeta
functions).
Write
def
A
=
C{{qsc
}}
(i.e.,
convergent
series
in
qsc
).
In
fact,
in
this
Â§,
we
shall
think
of
qsc
=
exp(2Ï€iÏ„sc
)
as
def
a
complex
variable
on
the
unit
disc
|qsc
|
<
1,
i.e.,
Ï„sc
âˆˆ
H
=
{z
âˆˆ
C
|
Im(z)
>
0}.
def
Let
S
=
Spec(A)
(cf.
the
notation
of
Chapter
IV,
Â§2,3).
We
would
like
to
think
of
qsc
as
the
q-parameter
associated
to
the
elliptic
curve
E
of
Chapter
IV,
Â§2,3.
Thus,
qsc
is
equal
to
â€œq
n
â€
in
the
notation
of
Chapter
IV,
Â§2,3.
In
the
following,
we
shall
write
qcv
(where
â€œcvâ€
stands
for
â€œcoveringâ€)
for
the
â€œqâ€
of
Chapter
IV,
Â§2,3.
Thus,
in
the
present
complex
analytic
context,
the
elliptic
curve
â€œEâ€
(respectively,
â€œEâ€)
of
Chapter
IV,
Â§2,3,
def
def
Z
Z
corresponds
to
Ecv
=
Gm
/qcv
(respectively,
Esc
=
Gm
/qsc
).
Also,
we
shall
write
Ucv
for
the
standard
multiplicative
coordinate
on
the
copy
(Gm
)cv
of
Gm
which
uniformizes
Z
,
and
Usc
for
the
multiplicative
coordinate
on
the
copy
(Gm
)sc
of
Gm
Ecv
=
(Gm
)cv
/qcv
def
Z
which
uniformizes
Esc
=
(Gm
)sc
/qsc
.
Thus,
n
;
Usc
=
Ucv
n
qsc
=
qcv
and
Esc
=
Ecv
/Î¼n
.
Fix
a
character
Ï‡
âˆˆ
Hom(Î n
,
(Î¼n
)S
)
Ï‡
as
in
Chapter
IV,
Theorem
3.2,
where
n
=
2m
âˆˆ
2Z.
Let
ÏƒÏ‡
âˆˆ
Î“(C
âˆ
,
(LâŠ—n
C
âˆ
)
),
iÏ‡
âˆˆ
S
S
{âˆ’m,
âˆ’m
+
1,
.
.
.
,
m
âˆ’
1}
be
as
in
Chapter
V,
Theorem
4.8.
Note
that
the
action
of
258
Ï‡
âˆ
Zet
Ã—
Î¼n
on
(LâŠ—n
C
âˆ
)
is
compatible
with
the
Galois
action
of
Zet
Ã—
Î¼n
on
C
,
regarded
as
S
S
a
covering
space
of
the
elliptic
curve
E
of
Chapter
IV,
Â§2,3.
Thus,
if
we
descend
and
then
translate
into
the
complex
analytic
language
of
the
present
section,
we
obtain
a
natural
line
bundle
LÏ‡sc
of
degree
1
on
Esc
.
Note
that
the
section
â€œÎ¸
m
â€
may
then
be
thought
of
as
a
section
of
the
line
bundle
LÏ‡sc
over
the
cover
(Gm
)cv
â†’
(Gm
)sc
â†’
Esc
n
(where
(Gm
)cv
â†’
(Gm
)sc
is
the
map
Ucv
â†’
Usc
=
Ucv
).
Thus,
if
we
divide
the
series
for
m
ÏƒÏ‡
in
Chapter
V,
Theorem
4.8,
by
Î¸
,
we
obtain
the
(twisted)
theta
function
Î˜Ï‡
:

1
Â·k2
+(iÏ‡
/n)Â·k
2
qsc
2mk+iÏ‡
Â·
Ucv
Â·
Ï‡(ket
)
=
kâˆˆZ

1
(
1
Â·k2
+(iÏ‡
/n)Â·k)
d
2
qor
2mk+iÏ‡
Â·
Ucv
Â·
Ï‡(ket
)
kâˆˆZ
def
def
d
where
qor
=
qsc
,
and
d
is
a
ï¬xed
positive
integer.
(We
shall
also
write
Ï„or
=
d
Â·
Ï„sc
.)
The
point
of
introducing
these
two
â€œqâ€™sâ€
(i.e.,
qsc
and
qor
)
is
that
we
want
to
think
of
ourselves
def
Z
as
being
interested
in
degree
d
line
bundles
on
the
elliptic
curve
Eor
=
Gm
/qor
.
To
study
such
bundles,
it
is
convenient
to
take
invariants
with
respect
to
â€œZet
/dâ€
(cf.
Chapter
IV,
Theorem
1.4)
and
work
with
degree
d
line
bundles
on
the
quotient
Eor
/(Zet
/d)
=
Esc
.
Thus,
we
would
like
to
think
of
the
d
as
a
scaling
factor.
That
is
to
say,
qor
is
our
â€œoriginal
q,â€
while
qsc
is
our
â€œscaled
q.â€
Recall
the
diï¬€erential
operator
Î´
âˆ—
of
Chapter
IV,
Theorem
3.2.
This
operator
satisï¬es
N
nÂ·N
Î´
(Ucv
)
=
N
Â·
Ucv
(for
N
âˆˆ
Z).
Let
us
deï¬ne
the
â€œÏ‡-shifted
operatorâ€
âˆ—
Î´Ï‡âˆ—
=
Î´
âˆ—
âˆ’
def
iÏ‡
n
Thus,
nÂ·N
+iÏ‡
nÂ·N
+iÏ‡
)
=
N
Â·
Ucv
Î´Ï‡âˆ—
(Ucv
(for
N
âˆˆ
Z).
Our
ï¬rst
goal
in
this
Â§
is
to
bound
the
coeï¬ƒcients
in
the
expansion
of
the
â€œshifted
and
scaled
monomialâ€
canonical
SW
zeta
functions
def
Î¶rSS
Â·
Î¸
âˆ’m
=

Î´
âˆ—
r
Ï‡
d
(Î˜Ï‡
)
=


k
r
kâˆˆZ
d
259
1
(
1
Â·k2
+(iÏ‡
/n)Â·k)
d
2
Â·
qor
2mk+iÏ‡
Â·
Ucv
Â·
Ï‡(ket
)
(where
r
is
a
nonnegative
integer).
2mk+iÏ‡
Lemma
6.1.
Let
a
be
a
positive
integer.
Then
the
coeï¬ƒcient
CkSS
of
Ucv
satisï¬es
the
following:
in
Î¶rSS
(1)
If
|k|
â‰¤
a
Â·
d,
then
|CkSS
|
â‰¤
eâˆ’
d
Â·Im(Ï„or
)Â·(k
+(iÏ‡
/m)Â·k)
Â·
ar
â‰¤
ar
.
2
Ï€
(2)
Let
>
0
be
a
real
number.
If
|k|
â‰¥
Max(
1+

,
a
Â·
d),
r
â‰¤
d,
and
a
â‰¥
12
Â·
(b
+
1)
Â·
Qâˆ’1
,
where
b
âˆˆ
Râ‰¥1
,
and
def
Q
=
Ï€
Â·
Im(Ï„or
)
2(1
+
)
then
|CkSS
|
â‰¤
eâˆ’bÂ·|k|
.
In
particular,
in
this
case,
we
have:
âˆ

âˆ

|CkSS
|
â‰¤
4
Â·
eâˆ’aÂ·bÂ·d
;
|k|=aÂ·d
|CkSS
|2
â‰¤
4
Â·
eâˆ’2aÂ·bÂ·d
|k|=aÂ·d
Proof.
The
estimates
of
(1)
follow
immediately
from
the
facts
that
|qor
|
â‰¤
1;
|k|
â‰¤
aÂ·d
=â‡’
(|k|/d)r
â‰¤
ar
.
The
estimates
of
(2)
are
obtained
as
follows:
First,
we
observe
that
since
|k|
â‰¥
a
Â·
d,
1
1
2
2
|k|
â‰¥
1+

(so
k
âˆ’
|k|
â‰¥
1+
Â·
k
),
r
â‰¤
d,
and
a
Â·
Q
â‰¥
2
Â·
(b
+
1),
1
2
(k
+
(2
Â·
iÏ‡
/n)
Â·
k)
2d
1
â‰¤
r
Â·
log(|k|/r)
âˆ’
2Ï€
Â·
Im(Ï„or
)
Â·
(k2
âˆ’
|k|)
2d
2
k
â‰¤
|k|
âˆ’
2Ï€
Â·
Im(Ï„or
)
Â·
2d(1
+
)
log(|CkSS
|)
=
r
Â·
log(|k|/d)
âˆ’
2Ï€
Â·
Im(Ï„or
)
Â·
=
|k|
âˆ’
2Q
Â·
(|k|/d)
Â·
|k|
â‰¤
|k|
âˆ’
2Q
Â·
a
Â·
|k|
â‰¤
âˆ’b
Â·
|k|
(where
in
the
third
line,
we
use
Lemma
3.6),
as
desired.
The
inequalities
concerning
the
sums
then
follow
immediately.
Note
that
here
we
use
the
facts
that
260
âˆ

e
âˆ’k
=
(1
âˆ’
e
âˆ’1
âˆ’1
)
â‰¤
2;
k=0
âˆ

eâˆ’2k
=
(1
âˆ’
eâˆ’2
)âˆ’1
â‰¤
2
k=0
(which
follow
from
e2
â‰¥
e
â‰¥
2).

Next,
although
it
will
not
be
logically
necessary
in
the
following
discussion,
we
observe
that
the
estimates
of
Lemma
6.1
allow
us
to
estimate
the
coeï¬ƒcients
of
the
congruence
canonical
SW
zeta
functions
of
Chapter
V,
Theorem
4.8
(cf.
Chapter
VIII,
Â§3,4,5,
for
more
details
on
the
archimedean
properties
of
these
functions):
Lemma
6.2.
2mk+iÏ‡
The
coeï¬ƒcient
C
CG
[r]k
of
Ucv
Î¶rCG
Â·
Î¸
âˆ’m
=
in
the
series

âˆ—


k
+
Î»r

1
Â·k2
+(iÏ‡
/n)Â·k
Î´Ï‡
+
Î»r
2mk+iÏ‡
2
Â·
Ucv
Â·
Ï‡(ket
)
(Î˜Ï‡
)
=
Â·
qsc
r
r
kâˆˆZ
of
Chapter
V,
Theorem
4.8,
satisï¬es
the
following:
(1)
If
|k|
â‰¤
a
Â·
d,
then
|C
CG
[r]k
|
â‰¤
ar
Â·
e3r
Â·

r
d
r
â‰¤
ar
Â·
e3r+d
.
(2)
Let
>
0
be
a
real
number.
If
|k|
â‰¥
Max(
1+

,
a
Â·
d),
1
â‰¤
r
â‰¤
d,
and
1
âˆ’1
a
â‰¥
2
Â·
(b
+
5)
Â·
Q
,
where
b
âˆˆ
Râ‰¥1
,
and
def
Q
=
then
|C
[r]k
|
â‰¤
e
we
have:
CG
âˆ

|k|=aÂ·d
|C
CG
âˆ’(b+1)Â·|k|
[r]k
|
â‰¤
4
Â·
e
Â·
Ï€
Â·
Im(Ï„or
)
2(1
+
)

r
d
r
âˆ’aÂ·bÂ·d
â‰¤
eâˆ’bÂ·|k|
.
In
particular,
in
this
case,
âˆ

;
|C
CG
[r]k
|2
â‰¤
4
Â·
eâˆ’2aÂ·bÂ·d
|k|=aÂ·d
Proof.
of
the
polynomial
T
+Î»r

To
apply
Lemmai
6.1,
it
suï¬ƒces
to
estimate
the
coeï¬ƒcients
r
in
terms
of
(T
/d)
.
One
sees
easily
(since
|Î»r
|
â‰¤
2
;
for
N
=
0,
1,
.
.
.
,
r
âˆ’
1,
r
261
N
+
Î»r
|
â‰¤
r)
that
T
+Î»the

estimates
of
Proposition
3.3
for
the
coeï¬ƒcients
of
the
polynomial
|
âˆ’
T
r
also
hold
for
(by
the
same
proof
as
that
given
for
Proposition
3.3).
Thus,
these
r
r

r
â‰¤
e2r+d
.
Since
there
are
a
total
of
r
+
1
â‰¤
er
coeï¬ƒcients
may
be
bounded
by
e2r
Â·
dr
terms
to
contend
with,
we
thus
see
that
in
order
to
get
estimates
for
C
CG
[r]k
,
it
suï¬ƒces


to
multiply
the
estimates
for
CkSS
in
Lemma
6.1
by
e3r
Â·
d
r
r
â‰¤
e3r+d
.
This
takes
care
of
(1).
For
(2),
we
note
further
that
if
we
take
the
â€œbâ€
of
Lemma
6.1
to
be
b
+
4
(in
the
notation
of
the
present
Corollary),
then
using
r
â‰¤
d
â‰¤
a
Â·
d
â‰¤
|k|,
we
obtain
|C
CG
[r]k
|
â‰¤
eâˆ’(b+4)Â·|k|+3r
Â·

d
r
r

d
r
â‰¤
eâˆ’(b+4)Â·|k|+3Â·|k|
Â·
r

d
r
â‰¤
eâˆ’(b+1)Â·|k|
Â·
r
âˆ’(b+1)Â·|k|+d
â‰¤e
â‰¤
eâˆ’(b+1)Â·|k|+|k|
=
eâˆ’bÂ·|k|
as
desired.

Next,
we
would
like
to
introduce
the
orthogonal
canonical
SW
zeta
functions,
as
follows.
First,
in
the
following
discussion,
we
would
like
to
restrict
the
variable
Ucv
âˆˆ
CÃ—
to
the
unit
circle;
we
shall
write
Ucv
|(S1
)cv
=
exp(2Ï€itcv
)
(where
tcv
âˆˆ
[0,
2Ï€))
for
this
restricted
Ucv
.
Then
observe
that
Î˜Ï‡
|(S1
)cv
is
a
smooth
function
on
(S1
)cv
(varying
with
the
parameter
q).
Recall
that
L2
((S1
)cv
)
is
equipped
with
a
natural
inner
product
given
by
def
(f,
g)
=
1
Â·
2Ï€
(S1
)cv
f
Â·
g
Â·
dt
Now
we
would
like
to
apply
the
theory
of
Â§1,
especially
Example
(4).
That
is
to
say,
we
take
def
def
H
=
L2
((S1
)cv
),
X
=
Î´
âˆ—
,
and
(for
r
â‰¥
0)
F
r
(H)
to
be
the
complex
vector
subspace
of
H
generated
by
functions
of
the
form
P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
,
where
P
(âˆ’)
is
a
polynomial
(with
complex
coeï¬ƒcients)
of
degree
â‰¤
r.
Put
another
way,
we
would
like
to
consider
the
(C-)linear
combinations
of
the
â€œstandard
monomialâ€
canonical
SW
zeta
functions
def
Î¶rSM
Â·
Î¸
âˆ’m
=

r

2
1
1
iÏ‡
2mk+iÏ‡
d
(
2
Â·k
+(iÏ‡
/n)Â·k)
Î´
âˆ—
(Î˜Ï‡
)
=
(k
+
)r
Â·
qor
Â·
Ucv
Â·
Ï‡(ket
)
n
kâˆˆZ

1
2
iÏ‡
âˆ’
1
Â·(i
/n)2
kÏ‡
2
kÏ‡
Â·
kÏ‡r
Â·
qsc
Â·
Usc
Â·
Ï‡((kÏ‡
âˆ’
)et
)
=
qsc
2
Ï‡
n
iÏ‡
kÏ‡
âˆˆ
Z+
n
âˆ’
1
Â·(iÏ‡
/n)2
=
qor
2d

Â·
1
i
kÏ‡
âˆˆ
Z+
nÏ‡
262
k2
kÏ‡
2d
Ï‡
kÏ‡r
Â·
qor
Â·
Usc
Â·
Ï‡((kÏ‡
âˆ’
iÏ‡
)et
)
n
def
n
(where
Usc
=
Ucv
)
whose
restrictions
to
(S1
)cv
are
orthonormal
with
respect
to
the
inner
product
just
deï¬ned
on
L2
((S1
)cv
).
If
we
normalize
the
orthonormal
system
that
we
deal
with
by
assuming
that
the
leading
coeï¬ƒcient
(i.e.,
the
coeï¬ƒcient
of
Î¶rSM
)
in
the
degree
r
member
of
this
system
is
a
positive
real
number,
then
we
see
that
we
obtain
uniquely
deï¬ned
functions
1
1
Î¶0OR,S
,
.
.
.
,
Î¶rOR,S
,
.
.
.
(for
r
â‰¥
0).
Because
these
functions
are
a
sort
of
prototype
of
the
orthogonal
functions
that
we
will
consider
in
Chapter
VIII(cf.,
especially,
Â§2),
we
give
them
a
name:
1
Deï¬nition
6.3.
We
refer
to
the
Î¶rOR,S
as
the
orthogonal
canonical
Schottky-Weierstrass
zeta
functions.
1
Note
that
it
follows
from
the
general
theory
of
Â§1
(e.g.,
Proposition
1.2)
that
the
Î¶rOR,S
are
completely
determined
by
their
means
and
principal
submeans.
In
the
following
discussion,
we
would
like
to
consider
the
trivialization
Î¸
m
of
the
line
bundle
LÏ‡sc
over
the
covering
(Gm
)cv
â†’
(Gm
)sc
â†’
Esc
,
where
(Gm
)cv
â†’
(Gm
)sc
is
the
n
map
Ucv
â†’
Usc
=
Ucv
.
Note
that
this
line
bundle
LÏ‡sc
on
the
elliptic
curve
Esc
admits
a
unique
(up
to
a
positive
real
multiple)
metric
with
translation-invariant
curvature
(cf.
the
discussion
of
the
metric
||
âˆ¼
||L
in
Â§4).
This
metric
thus
deï¬nes
a
function
||Î¸m
||
of
Ucv
.
For
simplicity,
let
us
assume
that
our
metric
has
been
normalized
so
that
||Î¸m
||
=
1
at
Ucv
=
1.
Note
that
since
the
natural
action
of
Î¼âˆ
on
â€œLâŠ—n
C
âˆ
â€
(cf.
the
discussion
at
the
S
beginning
of
Chapter
IV,
Â§2)
ï¬xes
Î¸
m
(as
well
as
the
metric
||
âˆ¼
||),
we
thus
see
that
||Î¸m
||
is
invariant
under
translation
by
elements
of
(S1
)cv
.
In
particular,
it
follows
that
we
may
regard
||Î¸m
||
as
a
function
of
Usc
.
Lemma
6.4.
Ï
At
Usc
=
qsc
Â·
exp(2Ï€itcv
)
(where
tcv
âˆˆ
[0,
2Ï€),
Ï
âˆˆ
Râ‰¥0
),
we
have
||Î¸m
||
=
|qsc
|
2
Â·Ï
1
2
Proof.
First,
observe
that
the
section
Î¸
m
(of
the
line
bundle
LÏ‡sc
over
the
cover
(Gm
)cv
â†’
(Gm
)sc
â†’
Esc
)
is
nonzero
for
all
values
of
Ucv
âˆˆ
CÃ—
(i.e.,
it
really
is
a
â€œtrivializationâ€).
Indeed,
this
follows,
for
instance,
from
the
fact
that
the
holomorphic
connection
deï¬ned
by
Î¸
is
regular
(i.e.,
has
no
poles)
for
all
Ucv
âˆˆ
CÃ—
(cf.
Chapter
III,
Theorem
5.6),
which
would
not
be
the
case
if
Î¸
had
zeroes.
Thus,
Î¸
m
constitutes
a
trivialization
of
the
line
bundle
in
question
at
all
values
of
Ucv
âˆˆ
CÃ—
.
In
particular,
since
the
curvature
of
the
metric
that
we
âˆ‚2
âˆ‚2
are
using
is
translation-invariant
(i.e.,
â€œconstantâ€),
it
follows
that
the
Laplacian
âˆ‚Ï
2
+
âˆ‚t2
263
def
Ï
of
the
function
Ï†(Ï,
t)
=
log(||Î¸m
||)
(where
Usc
=
qsc
Â·
exp(2Ï€itcv
))
is
constant.
Since
2
Ï†(Ï,
t)
=
Ï†(Ï)
is
independent
of
tcv
,
we
thus
obtain
that
ddÏÏ†2
is
constant.
But
this
implies
that
Ï†(Ï)
is
a
quadratic
function
of
Ï,
hence
determined
as
soon
as
it
is
determined
for
Z
Z
,
i.e.,
for
Ucv
=
qcv
.
Thus,
it
suï¬ƒces
to
prove
Lemma
6.4
for
such
values
of
Usc
.
Usc
=
qsc
N
mÂ·N
2
nÂ·N
Â·
Ucv
Â·
Î¸
m
||
But
for
Ucv
=
qcv
,
we
may
calculate
||Î¸m
||
as
the
value
of
||Net
(Î¸
m
)||
=
||qcv
2
2
1
N
at
Ucv
=
1,
which
is
just
|qcv
|mÂ·N
=
|qsc
|
2
Â·N
,
as
desired
(since
Ucv
=
qcv
corresponds
to
N
Usc
=
qsc
).
This
completes
the
proof.

Now
that
we
have
computed
the
absolute
value
of
our
trivialization
Î¸
m
,
we
would
like
compute
various
L2
-norms
of
canonical
zeta
functions
as
follows.
First,
let
P
(s)
be
a
polynomial
with
complex
coeï¬ƒcients
in
the
indeterminate
s.
Then
let
us
write
âˆ’
1
Â·(iÏ‡
/n)2
Î¶
P
[T
]Â·Î¸
âˆ’m
=
P
(Î´
âˆ—
+T
)Â·(Î˜Ï‡
)
=
qsc
2
def

Â·
1
k2
kÏ‡
2
Ï‡
P
(kÏ‡
+T
)Â·qsc
Â·Usc
Â·Ï‡((kÏ‡
âˆ’
i
kÏ‡
âˆˆ
Z+
nÏ‡
iÏ‡
)et
)
n
(where
the
indeterminate
â€œT
â€
is
as
in
Chapter
IV,
Â§3).
We
would
like
to
consider
the
Ï
Â·
exp(2Ï€itcv
)
(where
tcv
âˆˆ
[0,
2Ï€),
Ï
âˆˆ
Râ‰¥0
),
i.e.,
value
of
this
zeta
function
at
Ucv
=
qcv
n
Ï
Usc
=
Ucv
=
qsc
Â·
exp(2Ï€itcv
Â·
n).
Since
at
this
value
of
Ucv
,
the
indeterminate
T
takes
on
the
value
Ï
(cf.
Chapter
III,
Corollary
5.9,
for
rational
Ï;
since
T
is
a
continuous
function,
we
thus
obtain
the
result
for
arbitrary
real
Ï).
Thus,
âˆ’
1
Â·(i
/n)2
Ï‡
2
Ï
Î¶
P
[T
]Â·Î¸
âˆ’m
|U
=qcv
Â·
Â·exp(2Ï€itcv
)
=
qsc

1
2
iÏ‡
2
kÏ‡
+kÏ‡
Â·Ï
P
(kÏ‡
+
Ï)
Â·
qsc
Â·
exp(2Ï€itcv
Â·
n
Â·
kÏ‡
)
Â·
Ï‡((kÏ‡
âˆ’
)et
)
n
iÏ‡
kÏ‡
âˆˆ
Z+
n
Ï
In
particular,
by
applying
Lemma
6.4,
for
Ucv
=
qcv
Â·
exp(2Ï€itcv
),
we
obtain:
||Î¶
P
[T
]||
=
|qsc
|âˆ’
2
Â·(iÏ‡
/n)
+
2
Â·Ï
!
!

1
2
iÏ‡
!
!
2
kÏ‡
+kÏ‡
Â·Ï
Â·!
P
(kÏ‡
+
Ï)
Â·
qsc
Â·
exp(2Ï€itcv
Â·
n
Â·
kÏ‡
)
Â·
Ï‡((kÏ‡
âˆ’
)et
)!
n
iÏ‡
1
2
1
2
kÏ‡
âˆˆ
Z+
n
2
=
|qsc
|âˆ’
2
Â·(iÏ‡
/n)
!

!
Â·!
1
1
k2
2
Ï‡,Ï
P
(kÏ‡,Ï
)
Â·
qsc
Â·
exp(2Ï€itcv
Â·
n
Â·
kÏ‡,Ï
)
Â·
Ï‡((kÏ‡,Ï
âˆ’
Ï
âˆ’
i
kÏ‡,Ï
âˆˆ
Z+Ï+
nÏ‡
264
!
iÏ‡
!
)et
)!
n
Thus,
by
squaring
and
integrating
over
(S1
)cv
,
we
obtain
the
following:
Ï
Lemma
6.5.
Write
Ucv
=
qcv
Â·
exp(2Ï€itcv
),
where
we
ï¬x
Ï,
and
let
exp(2Ï€itcv
)
âˆˆ
(S1
)cv
Ï
vary.
Then
for
|Ucv
|
=
|qcv
|
,
we
have:

2
||Î¶
P
[T
]||2L2
((S1
)cv
)
=
|qsc
|âˆ’(iÏ‡
/n)
Â·
2
|P
(kÏ‡,Ï
)|2
Â·
|qsc
|kÏ‡,Ï
i
kÏ‡,Ï
âˆˆ
Z+Ï+
nÏ‡
If,
moreover,
we
integrate
these
L2
((S1
)cv
)
norms
as
Ï
ranges
from
0
to
1,
we
obtain:
||Î¶
P
[T
]||2L2
(Esc
)
=
|qsc
|âˆ’(iÏ‡
/n)
Â·
2
2
kÏ‡
âˆˆ
=
e
d
Â·Im(Ï„or
)Â·(iÏ‡
/n)
Â·
2
2Ï€
|P
(kÏ‡
)|2
Â·
|qsc
|kÏ‡
Â·
dkÏ‡
i
R+
nÏ‡
|P
(k)|2
Â·
eâˆ’
d
Â·Im(Ï„or
)Â·k
Â·
dk
2
2Ï€
R
(where
the
L2
-norm
L2
(Esc
)
is
deï¬ned
by
integrating
the
L2
((S1
)cv
)
norms
as
a
function
of
Ï,
where
Ï
ranges
from
0
to
1).
Next,
we
would
like
to
see
what
happens
if
we
replace
(S1
)cv
in
the
above
discussion
by
def
Î¼d
.
Let
us
write
tsc
=
n
Â·
tcv
,
and
think
of
Î¼d
âŠ†
(S1
)sc
as
a
subset
of
the
circle
(S1
)sc
with
coordinate
exp(2Ï€itsc
).
Then
by
restricting
Î¶
P
to
Î¼d
and
dividing
by
a(n)
(unnecessary)
factor
of
exp(2Ï€i
Â·
iÏ‡
Â·
tcv
)
Â·
Î¸
m
,
we
obtain
Î¶
P,Î¼d
=
exp(âˆ’2Ï€i
Â·
iÏ‡
Â·
tcv
)
Â·
Î¸
âˆ’m
Â·
P
(Î´
âˆ—
)
Â·
(Î˜Ï‡
)|Î¼d

âˆ’
1
Â·(i
/n)2
=
qsc
2
Ï‡
Â·
exp(2Ï€itsc
Â·
kmod
)
Â·
def
kmod
âˆˆZ/dZ
Â·
Ï‡((kÏ‡
âˆ’

1
k2
2
Ï‡
P
(kÏ‡
)
Â·
qsc
i
kÏ‡
âˆˆ
kmod
+
nÏ‡
iÏ‡
)et
)
n
Let
us
deï¬ne
the
inner
product
on
L2
(Î¼d
)
by
def
1
(f,
g)
=
d
Â·

Î±âˆˆÎ¼d
f
(Î±)
Â·
g(Î±)
Note
that,
just
as
in
Lemma
6.5,
we
have:
||Î¶
P,Î¼d
||2L2
(Î¼
)
=
|qsc
|âˆ’(iÏ‡
/n)
Â·
2
d

kmod
âˆˆZ/dZ
!
!
!

1
i
kÏ‡
âˆˆ
kmod
+
nÏ‡
265
k2
2
Ï‡
P
(kÏ‡
)
Â·
qsc
Â·
Ï‡((kÏ‡
âˆ’
!2
iÏ‡
!
)et
)!
n
Now
assume
(just
for
this
discussion
of
functions
on
Î¼d
)
that
iÏ‡
=
0.
By
Chapter
VI,
Theorem
3.1,
(2),
this
assumption
implies
that
as
P
(âˆ’)
ranges
over
the
polynomials
of
degree
<
d,
the
resulting
Î¶
P,Î¼d
form
a
basis
of
L2
(Î¼d
).
Thus,
we
may
orthonormalize
these
Î¶
P,Î¼d
â€™s
to
obtain
OR,Î¼
Î¶0
OR,Î¼
Deï¬nition
6.6.
We
refer
to
the
Î¶r
zeta
functions.
OR,Î¼
,
.
.
.
,
Î¶dâˆ’1
as
the
Î¼d
-orthogonal
canonical
Schottky-Weierstrass
We
are
now
ready
to
state
the
main
result
of
this
Â§:
First,
let
us
write
LÏ‡sc
|(S1
)cv
for
the
restriction
of
LÏ‡sc
to
the
circle
(S1
)cv
âŠ†
(Gm
)cv
which
is
parametrized
by
Ucv
.
Note
that
this
bundle
LÏ‡sc
|(S1
)cv
over
(S1
)cv
admits
a
natural
trivialization
deï¬ned
by
Î¸
m
.
In
the
following
theorem,
we
would
like
to
consider
the
analogue
for
the
line
bundle
LÏ‡sc
on
Esc
of
the
real
analytic
sections
Î¶rDR
of
Â§4,
5,
of
the
line
bundle
associated
to
the
origin
of
an
elliptic
curve.
Since
the
pair
(Esc
,
LÏ‡sc
)
is
isomorphic
(by
translation)
to
the
pair
(Esc
,
OEsc
(eEsc
))
(where
eEsc
is
the
origin
of
E),
we
thus
see
that,
by
transport
of
structure,
the
theory
of
Â§4,5,
also
applies
to
the
pair
(Esc
,
LÏ‡sc
).
Thus,
by
abuse
of
notation,
we
denote
by
Î¶rDR
the
resulting
real
analytic
section
of
LÏ‡sc
on
Esc
(associated
to
the
choice
of
Î¶0DR
deï¬ned
by
ÏƒÏ‡
).
The
following
theorem
concerns
the
restriction
Î¶rDR
|(S1
)cv
of
Î¶rDR
to
(S1
)cv
âŠ†
(Gm
)cv
.
Theorem
6.7.
Write
Let
r
â‰¥
0
be
an
integer.
Let
us
ï¬x
qor
,
and
consider
d
â‰¥
1
as
variable.
def
Î³d
=
d
4Ï€
Â·
Im(Ï„or
)
1
2
and
Pr,d
(s)
=
Hr
(s
Â·
Î³dâˆ’1
),
where
Hr
(âˆ’)
is
the
Hermite
polynomial
of
Proposition
2.2.
Let
def
def
Î¶rHMd
=
Î¶
Pr,d
;
HMd
,Î¼d
def
Î¶r
=
Î¶
Pr,d
,Î¼d
Then
if
we
regard
sections
of
LÏ‡sc
|(S1
)cv
as
functions
on
(S1
)cv
by
means
of
the
trivialization
Î¸
m
,
we
have:
âˆ’1
1
âˆ’1
1
âˆ’1
lim
Î³d
2
Â·
(r!)
2
Â·
Î¶rOR,S
=
lim
Î³d
2
Â·
Î¶rHMd
=
lim
Î³d
2
Â·
dâ†’âˆ
dâ†’âˆ
dâ†’âˆ
r!
Â·
Î¶
DR
(2Ï€)r/2
r
(where
the
convergence
is
relative
to
the
sup
norm
for
functions
on
(S1
)cv
).
If,
moreover,
iÏ‡
=
0,
then
(if
we
trivialize
LÏ‡sc
|Î¼âˆ
by
means
of
exp(2Ï€i
Â·
iÏ‡
Â·
tcv
)
Â·
Î¸
m
)
we
have:
266
HMd
,Î¼d
lim
Î³d
2
Â·
(r!)
2
Â·
Î¶rOR,Î¼
=
lim
Î³d
2
Â·
Î¶r
âˆ’1
âˆ’1
1
dâ†’âˆ
dâ†’âˆ
âˆ’1
=
lim
Î³d
2
Â·
dâ†’âˆ
r!
Â·
Î¶rDR
|Î¼d
r/2
(2Ï€)
(where
the
convergence
is
relative
to
the
sup
norm
for
functions
on
Î¼âˆ
).
Remark.
It
is
not
diï¬ƒcult
to
see
that
in
the
latter
part
of
Theorem
6.7,
if
Ï‡
is
of
order
precisely
m,
and
one
takes
the
limit
over
d
which
are
not
divisible
by
m,
then
the
latter
part
of
Theorem
6.7
holds
even
if
iÏ‡
=
0.
Indeed,
the
only
place
where
we
used/will
use
that
iÏ‡
=
0
is
in
the
application
of
Chapter
VI,
Theorem
3.1,
(2).
Proof.
Let
us
ï¬rst
consider
the
(S1
)cv
case.
Recall
from
Lemma
6.5
that
for
|Ucv
|
=
|qcv
|Ï
,
Ï
=
0,
we
have:

Î³dâˆ’1
Â·
||Î¶
P
||2L2
((S1
)cv
)
=
Î³dâˆ’1
Â·
e
d
Â·Im(Ï„or
)Â·(iÏ‡
/n)
Â·
2
2Ï€
|P
(kÏ‡
)|2
Â·
eâˆ’
d
Â·Im(Ï„or
)Â·kÏ‡
2
2Ï€
i
kÏ‡
âˆˆ
Z+
nÏ‡

=
e
d
Â·Im(Ï„or
)Â·(iÏ‡
/n)
Â·
2
2Ï€

2
|PÎ³d
(k
)|2
Â·
eâˆ’
2
Â·(k
)
Â·
Î³dâˆ’1
1
k
âˆˆ
Î³dâˆ’1
(Z+
nÏ‡
)
i
where
k
=
kÏ‡
Â·
Î³dâˆ’1
;
PÎ³d
(k
)
=
P
(k
Â·
Î³d
).
Thus,
as
d
â†’
âˆ,
def
def
lim
dâ†’âˆ
Î³dâˆ’1
Â·
||Î¶
P
||2L2
((S1
)cv
)
=
lim
dâ†’âˆ
1
k
âˆˆR

2
|PÎ³d
(k
)|2
Â·
eâˆ’
2
Â·(k
)
Â·
dk
Put
another
way,
this
is
the
L2
-norm
of
PÎ³d
(âˆ’)
for
the
measure
on
R
that
appears
in
Proposition
2.2.
Since
all
the
norms
considered
here
are
on
the
ï¬nite-dimensional
Cvector
space
of
Î¶
P
for
P
(âˆ’)
of
degree
â‰¤
r,
we
thus
see
that
if
we
take
the
basis
for
this
vector
space
given
by
letting
P
(s)
=
1,
.
.
.
,
(s/Î³d
)j
,
.
.
.
,
(s/Î³d
)r
1
and
we
divide
the
norms
by
Î³d2
,
then
this
normed
vector
space
converges
to
the
normed
vector
space
spanned
by
the
ï¬rst
r
+1
Hermite
polynomials
of
Proposition
2.2.
This
proves
1
1
âˆ’1
âˆ’1
limdâ†’âˆ
Î³d
2
Â·
(r!)
2
Â·
Î¶rOR,S
=
limdâ†’âˆ
Î³d
2
Â·
Î¶rHMd
.
(Note
that
here
we
use
the
fact
that
1
the
L2
-norm
of
the
Hermite
polynomial
Hr
is
a
constant
(independent
of
r)
times
(r!)
2
.)
âˆ’1
âˆ’1
r!
DR
To
prove
that
limdâ†’âˆ
Î³d
2
Â·
Î¶rHMd
=
limdâ†’âˆ
Î³d
2
Â·
(2Ï€)
,
it
suï¬ƒces
to
observe
that
r/2
Â·
Î¶r
(by
the
latter
part
of
Lemma
6.5)
267
dâ†’âˆ

2
|PÎ³d
(k
)|2
Â·
eâˆ’
2
Â·(k
)
Â·
dk
=
lim
1
lim
k
âˆˆR
dâ†’âˆ
Î³dâˆ’1
Â·
||Î¶
P
||2L2
(Esc
)
and
that
the
L2
-norm
L2
(Esc
)
of
Lemma
6.5
coincides
with
the
norm
||
âˆ¼
||L2R
of
Â§4.
(Note
that
we
use
here
the
fact
that
the
L2
-norm
of
the
Hermite
polynomial
Hr
is
a
constant

12

r
1
(independent
of
r)
times
(r!)
2
,
while
the
L2R
-norm
of
Î¶rDR
is
a
constant
times
(2Ï€)
.)
(r!)
Thus,
it
remains
to
prove
the
analogous
results
for
Î¼d
when
iÏ‡
=
0.
These
results
follow
similarly
by
applying
the
formula
||Î¶
P,Î¼d
||2L2
(Î¼
)
d
1
âˆ’d
Â·(iÏ‡
/n)2
=
|qor
|
Â·
!
!
!

kmod
âˆˆZ/dZ

1
2
2d
kÏ‡
P
(kÏ‡
)
Â·
qor
i
kÏ‡
âˆˆ
kmod
+
nÏ‡
!2
iÏ‡
!
Â·
Ï‡((kÏ‡
âˆ’
)et
)!
n
together
with
the
estimates
of
Lemma
6.1.
When
we
apply
Lemma
6.1,
we
take
â€œd,â€
â€œrâ€
(notation
of
Lemma
6.1)
to
be
r
(in
the
present
notation),
and
â€œaâ€
(notation
of
Lemma
d
6.1)
to
be
[
2r
]
(in
the
present
notation).
This
allows
us
to
take
â€œbâ€
(notation
of
Lemma
6.1)
arbitrarily
large
as
d
â†’
âˆ.
Also,
note
that
the
factor
of
â€œdr
â€
(notation
of
Lemma
6.1)
in
Î¶rSS
does
not
bother
us
here,
since
in
the
present
notation,
this
factor
corresponds
to
r
r
which
is
constant
as
d
â†’
âˆ.
Thus,
we
obtain:
lim
dâ†’âˆ

kmod
âˆˆZ/dZ
!
!
!

1
k2
2d
Ï‡
P
(kÏ‡
)
Â·
qor
Â·
Ï‡((kÏ‡
âˆ’
i
kÏ‡
âˆˆ
kmod
+
nÏ‡
=
lim
dâ†’âˆ
!2
iÏ‡
!
)et
)!
n
!
1
2
!2
!
2d
kÏ‡
!
!P
(kÏ‡
)
Â·
qor
!

i
kÏ‡
âˆˆ
Z+
nÏ‡
,
|kÏ‡
|â‰¤
d
2
=
lim
!
1
2
!2
!
2d
kÏ‡
!
!P
(kÏ‡
)
Â·
qor
!

dâ†’âˆ
i
kÏ‡
âˆˆ
Z+
nÏ‡
which
is
the
same
sum
as
that
which
appeared
in
the
discussion
of
the
(S1
)cv
case.

Remark
1.
Stated
in
words,
Theorem
6.7
asserts
that:
As
d
â†’
âˆ,
the
orthogonal
systems
of
canonical
SW
zeta
functions
obtained
from
the
natural
inner
products
on
L2
((S1
)cv
)
and
L2
(Î¼d
)
converge
to:
(i)
one
another;
(ii)
canonical
SW
zeta
functions
modeled
on
the
Hermite
polynomials;
(iii)
the
de
Rham
zeta
functions
studied
in
Â§4,5.
Thus,
in
particular,
Theorem
6.7
implies
that
the
de
Rham
zeta
functions
Î¶rDR
are
equal
to
Hermite
polynomial-based
canonical
Schottky-Weierstrass
zeta
functions.
In
other
words,
268
we
see
that
we
have
obtained
another
independent
proof
of
the
latter
part
of
Theorem
5.3,
which,
in
the
notation
of
the
present
discussion,
reads:

(âˆ’Ï€
Â·
u)j
Â·
(Î´
âˆ—
)râˆ’2j
(ÏƒÏ‡
)
Lrâˆ’2j
Â·
j!
(r
âˆ’
2j)!
j=0
[r/2]
Î¶rDR
=
[r/2]
r

(2Ï€
Â·
u)
2
(âˆ’2)âˆ’j
Â·
(Î´
âˆ—
)râˆ’2j
(ÏƒÏ‡
)
r
Â·
(âˆ’1)
=
Â·
r!
Â·
1
(âˆ’1)r
Â·
r!
{(2Ï€
Â·
u)
2
Â·
L}râˆ’2j
Â·
j!
(r
âˆ’
2j)!
j=0
r
1
(2Ï€
Â·
u)
2
Â·
Hr
({(2Ï€
Â·
u)
2
Â·
L}âˆ’1
Â·
Î´
âˆ—
)
Â·
ÏƒÏ‡
=
r
(âˆ’1)
Â·
r!
(where
|L|
=
{8Ï€
2
Â·
Im(Ï„sc
)}âˆ’
2
,
|u|
=
1).
Note
that
the
scaling
factor
here,
i.e.,
{(2Ï€
Â·
u)
2
Â·
1
2Ï€
}
2
=
Î³d
.
That
is
to
say,
Theorems
5.3
and
6.7
L},
has
absolute
value
equal
to
{
8Ï€2
Â·Im(Ï„
sc
)
are
consistent
in
the
sense
that
they
yield
the
same
scaling
factor.
Note,
relative
to
the
discussion
surrounding
Terminology
3.7,
that
this
implies
that
(if
we
think
of
Im(Ï„or
)
as
OR,Î¼
â€™s
(for
varying
d)
have
slope
12
(as
promised
in
Â§3).
ï¬xed),
the
Î¶r
1
1
Remark
2.
It
is
interesting
to
note
that
in
the
discussion
of
this
Â§,
there
are
three
natural
parameters
involved;
we
would
like
to
think
of
these
parameters
as
follows:
Holomorphic
Variable:
Ï„or
Anti-Holomorphic
Variable:
d
Arithmetic
Variable:
r
That
is
to
say,
one
way
to
think
of
the
goal
of
this
paper
is
that
we
are
trying
to
descend
the
Z-scheme
(M1,0
)Z
(i.e.,
the
moduli
stack
of
elliptic
curves)
to
some
sort
of
object
over
the
hypothetical/mythical
â€œï¬eld
of
constantsâ€
F1
âŠ†
Z.
This
descent
may
be
carried
out
at
diï¬€erent
primes;
here
we
are
interested
in
carrying
it
out
at
the
inï¬nite
prime.
Thus,
one
expects
that
(M1,0
)Z
should
have
three
arithmetic/real
dimensions
over
F1
.
Two
of
these
arithmetic
dimensions
should
be
geometric
and
correspond
to
the
holomorphic
and
anti-holomorphic
coordinates
on
the
complex
manifold
(M1,0
)C
.
We
feel
that
these
two
dimensions
are
given
by
Ï„or
(the
holomorphic
coordinate)
and
the
scaling
parameter
d
(which
plays
the
role
of
the
anti-holomorphic
coordinate,
and
corresponds
to
powers
of
the
geometric
Frobenius
morphism
in
the
p-adic
theory).
Note
that
this
interpretation
of
these
parameters
is
compatible
with
the
fact
that
the
exponent
of
the
exponential
appearing
in
the
various
theta/zeta
functions
of
this
Â§
essentially
consists
of
Ï„or
Â·dâˆ’1
,
which
is
reminiscent
of
the
exponent
â€œ|z|2
=
z
Â·
zâ€
of
the
exponential
which
appears
in
the
usual
complex
theory
of
theta
functions
(cf.,
e.g.,
Remark
2
following
Proposition
2.2;
[Mumf3],
Â§12).
Finally,
we
have
the
index
â€œrâ€
which
plays
the
role
of
the
single
arithmetic
dimension
of
F1
.
In
the
padic
theory,
this
dimension
corresponds
to
arithmetic
Frobenius,
i.e.,
the
single
dimension
of
Gal(Fp
).
269
Note
that
this
point
of
view
is
compatible
with
the
point
of
view
of
the
discussion
at
the
end
of
Â§3
(see
also
Remark
1
above).
Indeed,
the
slope
as
discussed
in
Â§3
is
obtained
precisely
by
looking
at
the
â€œaction
of
the
scaling
parameter
d.â€
Also,
we
observe
that
this
point
of
view
is
reminiscent
of
the
point
of
view
of
the
Introductions
of
[Mzk1,2]
which
discuss
the
analogy
between
Frobenius
actions
and
real
analytic
KaÌˆhler
metrics.
(The
connection
here
being
that
orthogonal
functions
typically
arise
from
some
sort
of
real
analytic
KaÌˆhler
metric,
as
in
Â§4.)
Bibliography
[Ahlf]
L.
Ahlfors,
Complex
Analysis,
McGraw-Hill
Book
Company
(1979).
[Bate]
ErdeÌlyi,
Magnus,
Oberhettinger,
and
Tricomi,
Higher
Transcendental
Functions,
Bateman
Manuscript
Project,
Volume
II,
McGraw-Hill
(1953).
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
Publ.
of
RIMS
32,
No.
6
(1996),
pp.
957-1151.
[Mzk2]
S.
Mochizuki,
Foundations
of
p-adic
TeichmuÌˆller
Theory,
AMS/IP
Studies
in
Advanced
Mathematics
11,
American
Mathematical
Society/International
Press
(1999).
[Mumf1,2,3]
D.
Mumford,
On
the
equations
deï¬ning
abelian
varieties
I,
II,
III,
Invent.
Math.
1
(1966),
pp.
287-354;
2
(1967),
pp.
71-135;
3
(1967),
pp.
215-244.
[Rice]
J.
R.
Rice,
The
Approximation
of
Functions,
Volume
1:
Linear
Theory,
AddisonWesley
Publishing
Company
(1964).
[Sze]
G.
SzegoÌˆ,
Orthogonal
Polynomials,
Amer.
Math.
Soc.,
Colloquium
Pub.
23
(1959).
[Sze2]
G.
SzegoÌˆ,
Ein
Beitrag
zur
Theorie
der
Thetafunktionen,
Gabor
SzegoÌˆ:
Collected
Papers,
Vol.
I,
BirkhaÌˆuser
(1982),
pp.
795-811.
[Wells]
R.
O.
Wells,
Diï¬€erential
Analysis
on
Complex
Manifolds,
Graduate
Texts
in
Mathematics
65,
Springer
(1980).
270
Chapter
VIII:
The
Hodge-Arakelov
Comparison
Theorem
Â§0.
Introduction
In
Chapter
VII,
we
so-to-speak
â€œintroduced
the
actorsâ€
(which
are
systems
of
orthogonal
functions)
in
the
archimedean
theory
of
the
Comparison
Isomorphism.
In
the
present
Chapter,
we
â€œpresent
the
play.â€
Put
another
way,
we
complete
the
â€œScheme-Theoretic
Comparison
Isomorphismâ€
of
Chapter
VI
by
computing
the
behavior
of
the
Comparison
Isomorphism
at
archimedean
primes.
Thus,
in
summary,
our
result
may
be
roughly
stated
as
follows
(cf.
the
Introduction
to
Chapter
VI):
There
is
a
natural
bijection
between
certain
natural
types
of
algebraic
functions
on
the
universal
extension
of
an
elliptic
curve
and
the
â€œsettheoretic
functionsâ€
on
the
torsion
points
of
the
elliptic
curve.
Moreover,
this
bijection
is
compatible
with
certain
natural
metrics/integral
structures
deï¬ned
at
all
(ï¬nite
and
inï¬nite)
primes
of
a
number
ï¬eld,
as
well
as
at
the
divisor
at
which
the
elliptic
curve
in
question
degenerates.
We
refer
to
this
result
as
the
Hodge-Arakelov
Comparison
Isomorphism.
In
more
precise
terms,
our
result,
obtained
by
combining
Theorem
7.4
of
the
present
Chapter
with
Chapter
VI,
Theorem
4.1,
is
as
follows:
Theorem
A.
(The
Hodge-Arakelov
Comparison
Isomorphism)
Let
d,
m
â‰¥
1
be
integers
such
that
m
does
not
divide
d.
Suppose
that
S
log
is
a
ï¬ne
noetherian
log
scheme,
and
let
C
log
â†’
S
log
be
a
log
elliptic
curve
over
S
log
such
that
the
divisor
at
inï¬nity
D
âŠ†
S
(i.e.,
the
pullback
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
via
the
classifying
morphism
S
â†’
(M1,0
)Z
)
is
a
Cartier
divisor
on
S.
Also,
let
us
assume
that
eÌtale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root,
and
that
we
are
given
a
torsion
point
Î·
âˆˆ
Eâˆ,S
(Sâˆ
)
271
ev
of
order
precisely
m
which
deï¬nes
line
bundles
Lst,Î·
,
Lst,Î·
(cf.
Chapter
V,
Â§1).
If
d
is
def
ev
def
odd
(respectively,
even),
then
let
L
=
Lst,Î·
(respectively,
L
=
Lst,Î·
).
Then:
(1)
(Compatibility
with
Base-Change)
The
formation
of
the
push-forward
(cf.
Chapter
VI,
Deï¬nition
1.3)
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et}
(along
with
its
ï¬ltration)
commutes
with
base-change
(among
bases
S
log
satisfying
the
hypotheses
given
above).
(2)
(Zero
Locus
of
the
Determinant)
Assume
that
S
is
Z-ï¬‚at.
The
schemetheoretic
zero
locus
of
the
determinant
det(Î{âˆ,
et}),
i.e.,
the
determinant
of
the
evaluation
map
(cf.
Chapter
V,
Proposition
2.2;
Chapter
VI,
Theorem
3.1,
(1))
Î{âˆ,
et}
:
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et}
â†’
(fS
)âˆ—
(L|
â€ 
)
(d
Eâˆ
)
is
given
by
the
divisor
d
Â·
[Î·

(d
E)]
(where
d
E
is
the
kernel
of
multiplication
by
d
on
Ed
).
In
fact,
the
divisor
of
poles

of
the
inverse
morphism
to
Î{âˆ,
et}
is
contained
in
the
divisor
[Î·
(d
E)].
(3)
(Analytic
Torsion
at
the
Divisor
at
Inï¬nity)
For
each
Î¹,
there
is
a
sequence
of
elements
aÎ¹
=
{(aÎ¹
)0
,
.
.
.
,
(aÎ¹
)dâˆ’1
};
(aÎ¹
)j
â‰ˆ
j2
8d
2
j
(cf.
Chapter
of
Qâ‰¥0
Â·
log(q),
where
(aÎ¹
)j
goes
roughly
(as
a
function
of
j)
as
8d
VI,
Theorem
3.1,
(2)),
such
that
the
subquotients
of
the
natural
ï¬ltration
on
the
domain
of
Î{âˆ,
et}
admits
natural
isomorphisms:
(F
j+1
/F
j
)((fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et})
âˆ’â†’
272
1
Â·
exp(âˆ’(aÎ¹
)j
)
Â·
(fS
)âˆ—
(L|Eâˆ,S
)
âŠ—OS
Ï„EâŠ—j
j!
for
j
=
0,
.
.
.
,
d
âˆ’
1.
Moreover,
the
sections
of
L|
â€ 
that
realize
these
bijections
Eâˆ,[d]
have
q-expansions
in
a
neighborhood
of
inï¬nity
that
are
given
explicitly
in
Chapter
V,
Theorem
4.8.
(4)
(Integrality
Properties
at
the
Inï¬nite
Prime)
Suppose
that
D
=
âˆ…,
and
S
â€ 
â€ 
is
of
ï¬nite
type
over
C.
Let
us
then
write
L,
Î,
E
â€ 
,
E
for
L,
Î{âˆ,
et},
Eâˆ
,
d
d
[d]
â€ 
Eâˆ,[d]
.
Then
one
may
equip
L
with
a
(smooth,
i.e.,
C
âˆ
)
metric
|
âˆ¼
|L
whose
curvature
is
translation-invariant
on
the
ï¬bers
of
E
â†’
S.
Moreover,
such
a
metric
is
unique
up
to
multiplication
by
a
(smooth)
positive
function
on
S(C).
Then
|
âˆ¼
|L
deï¬nes
a
metric
on
the
vector
bundle
(fS
)âˆ—
(L|
â€ 
)
(i.e.,
the
range
dE
of
Î),
namely,
the
L
-metric
for
â€œL-valued
functions
on
d
E
â€ 
â€
(where
we
assume
that
the
total
mass
of
d
E
â€ 
is
1).
Since
Î
is
an
isomorphism,
this
metric
thus
induces
a
metric
on
(fS
)âˆ—
(L|
â€ 
)<d
(i.e.,
the
domain
of
Î),
which
we
denote
by
2
E[d]
||
âˆ¼
||et
and
refer
to
as
the
eÌtale
metric.
On
the
other
hand,
by
using
the
canonical
real
â€ 
analytic
splitting
of
E[d]
(C)
â†’
E(C)
(i.e.,
the
unique
splitting
which
is
a
continuous
homomorphism),
we
may
split
sections
of
(fS
)âˆ—
(L|
â€ 
)<d
into
components
E[d]
âŠ—r
which
are
real
analytic
sections
of
L
âŠ—
Ï„E
(where
r
<
d)
over
E(C).
Since
Ï„E
gets
a
natural
metric
by
square
integration
over
E,
these
components
have
natural
L2
-norms
determined
by
integrating
their
|
âˆ¼
|2L
over
the
ï¬bers
of
E(C)
â†’
S(C).
This
deï¬nes
what
we
refer
to
as
the
de
Rham
metric
||
âˆ¼
||DR
on
(fS
)âˆ—
(L|
â€ 
)<d
.
The
relationship
between
the
eÌtale
and
de
Rham
metrics
may
E[d]
be
described
using
three
â€œmodelsâ€:
(A.)
The
Hermite
Model:
This
model
states
that
if
we
ï¬x
r
<
d,
and
let
d
â†’
âˆ,
then
over
any
compact
subset
of
S(C),
the
eÌtale
metric
||
âˆ¼
||et
on
F
r
((fS
)âˆ—
(L|
â€ 
)<d
)
converges
(up
to
a
factor
â‰¤
eÏ€+r
,
â‰¥
1)
E[d]
to
the
metric
||
âˆ¼
||DR
,
as
well
as
to
a
certain
metric
â€œ||
âˆ¼
||HMd
â€
deï¬ned
by
considering
Hermite
polynomials
scaled
by
a
factor
of
âˆš
(constant)Â·
d
in
the
derivatives
of
the
theta
functions
âˆˆ
(fS
)âˆ—
(L|E
)
=
F
1
((fS
)âˆ—
(L|
â€ 
)<d
).
E[d]
(B.)
The
Legendre
Model:
This
model
states
(roughly)
that
over
any
compact
subset
of
S(C),
a
certain
average
â€“
which
we
denote
273
||
âˆ¼
||w,Î¼a
â€“
of
translates
of
the
eÌtale
metric
||
âˆ¼
||et
on
(fS
)âˆ—
(L|
â€ 
)<d
E[d]
is
equal
(provided
d
â‰¥
25),
up
to
a
factor
of
(constant)
,
to
the
de
Rham
metric
||
âˆ¼
||DR
,
as
well
as
to
a
certain
metric
â€œ||
âˆ¼
||Tch
â€
deï¬ned
by
considering
discrete
Tchebycheï¬€
polynomials
scaled
by
a
factor
of
d
in
the
derivatives
of
the
theta
functions
âˆˆ
(fS
)âˆ—
(L|E
)
=
F
1
((fS
)âˆ—
(L|
â€ 
)<d
).
These
discrete
Tchebycheï¬€
polynomials
are
disd
E[d]
crete
versions
of
the
Legendre
polynomials,
and
in
fact,
if
we
let
d
â†’
âˆ
with
the
said
scaling
by
d,
then
the
discrete
Tchebycheï¬€
polynomials
converge
uniformly
to
the
Legendre
polynomials.
(C.)
The
Binomial
Model:
This
model
involves
the
explicit
q-expansions
(where
we
write
E
=
Gm
/q
Z
,
and
q
is
a
holomorphic
function
which
is
deï¬ned,
at
least
locally,
on
S(C))
referred
to
in
(3)
above,
which
are
essentially
binomial
coeï¬ƒcient
polynomials
(scaled
by
1)
in
the
derivatives
of
the
theta
functions
âˆˆ
(fS
)âˆ—
(L|E
)
=
F
1
((fS
)âˆ—
(L|
â€ 
)<d
).
E[d]
If
we
divide
these
functions
by
appropriate
powers
of
q,
then
the
norm
||
âˆ¼
||qCG
for
which
these
functions
divided
by
powers
of
q
are
orthonormal
satisï¬es
the
following
property:
If
d
â‰¥
12,
and
Im(Ï„
)
â‰¥
200{log2
(d)
+
n
Â·
log(d)
+
n
Â·
log(n)}
(where
q
=
exp(2Ï€iÏ„
)),
then:
nâˆ’1
Â·
eâˆ’32d
Â·
||
âˆ¼
||qCG
â‰¤
||
âˆ¼
||et
â‰¤
e4d
Â·
||
âˆ¼
||qCG
Here,
the
factor
of
nâˆ’1
that
appears
is
the
exact
archimedean
analogue
of
the
poles
that
appeared
at
ï¬nite
primes
in
(2)
above.
Finally,
for
each
of
these
three
models,
the
combinatorial/arithmetic
portion
of
the
analytic
torsion
(i.e.,
the
portion
not
arising
from
letting
the
elliptic
curve
E
degenerate
â€“
cf.
(3)
above
for
the
portion
arising
from
degeneration
of
the
elliptic
curve)
induced
on
(F
r+1
/F
r
)((fS
)âˆ—
(L|
â€ 
)<d
)
by
the
metrics
||
âˆ¼
||DR
;
||
âˆ¼
||HMd
;
||
âˆ¼
||Tch
;
||
âˆ¼
||w,Î¼a
;
E[d]
||
âˆ¼
||qCG
(in
their
respective
domains
of
applicability)
as
r
â†’
d,
goes
(modulo
factors
of
the
order
(constant)d
)
as
â‰ˆ
(r!)âˆ’1
â‰ˆ
(d!)âˆ’1
which
is
precisely
what
you
would
expect
by
applying
the
product
formula
to
the
computation
of
the
â€œanalytic
torsionâ€
in
the
ï¬nite
prime
case,
which
consists
of
a
factor
of
precisely
(r!)âˆ’1
(cf.
Chapter
V,
Theorem
3.1;
Chapter
VI,
Theorem
4.1;
Chapter
VII,
Proposition
3.4).
As
discussed
in
the
statement
of
Theorem
A,
the
key
point
of
the
archimedean
portion
of
Theorem
A
is
the
comparison
of
the
eÌtale
and
de
Rham
metrics
||
âˆ¼
||et
,
||
âˆ¼
||DR
.
Unfortunately,
we
are
unable
to
prove
a
simple
sharp
result
that
they
always
coincide.
Instead,
we
choose
three
natural
â€œdomains
of
investigationâ€
â€“
which
we
refer
to
as
models
274
â€“
where
we
compare
these
two
metrics
using
a
particular
system
of
functions
which
are
welladapted
to
the
domain
of
investigation
in
question.
One
of
the
most
important
features
of
these
three
models
is
that
they
each
have
natural
scaling
factors
associated
to
them.
The
three
models,
along
with
their
natural
scaling
factors,
and
natural
domains
of
applicability
are
as
follows:
1
Hermite
Model
(scaling
factor
=
d
2
)
:
nondegenerating
E,
ï¬xed
r
<
d
Legendre
Model
(scaling
factor
=
d)
:
nondegenerating
E,
varying
r
<
d
Binomial
Model
(scaling
factor
=
1)
:
degenerating
E
It
is
interesting
to
observe
that
the
exponents
appearing
in
these
scaling
factors,
i.e.,
0,
12
,
1,
which
we
refer
to
as
slopes,
are
precisely
the
same
as
the
slopes
that
appear
when
one
considers
the
action
of
Frobenius
on
the
crystalline
cohomology
of
an
elliptic
curve
at
a
ï¬nite
prime
(cf.
the
discussions
at
the
end
of
Chapter
VII,
Â§3,
6,
for
more
on
this
analogy).
If
we
write
E
=
Gm
/q
Z
,
q
=
exp(2Ï€iÏ„
),
then
the
Hermite
Model
(respectively,
Legendre
Model,
Binomial
Model)
corresponds
to
the
case
where/is
most
useful
when
Im(Ï„
)
is
ï¬xed
(respectively,
â†’
0;
â†’
âˆ).
The
Binomial
Model
is
interesting
in
that
it
is
the
most
closely
analogous
to
the
situation
at
the
ï¬nite
primes.
The
Hermite
model
is
interesting
in
2
1
that
it
sheds
light
on
the
factors
of
q
â‰ˆ
8d
Â·j
â€“
which
are
essentially
Gaussians
â€“
that
appear
in
Theorem
A,
(3).
Moreover,
the
Hermite
model
in
some
sense
makes
explicit
that
essentially
what
we
are
doing
throughout
this
entire
paper
is
simply
studying
the
derivatives
of
a
Gaussian/theta
function.
Finally,
the
Legendre
model
is
interesting
in
that
it
shows
how
the
Comparison
Isomorphism
for
general
elliptic
curves
may
be
thought
of
as
being
essentially
a
(more
complicated)
version
of
the
Fundamental
Combinatorial
Model
(cf.
Chapter
VII,
Â§3)
given
by
considering
integer-valued
polynomial
functions
on
a
set
of
d
points.
Our
main
technique
for
comparing
the
eÌtale
and
de
Rham
metrics
in
these
various
models
is
to
reduce
the
problem
to
the
computation
of
certain
metrics
on
certain
ï¬nitedimensional
spaces
of
q-series.
The
q-series
then
tend
to
have
the
form:
q-series
=
â€œheadâ€
+
â€œtailâ€
where
â€œheadâ€
=
a
function
of
the
sort
that
appears
in
the
â€œmodelâ€
while
!
!
!
!
!
â€œtailâ€
!
â‰¤
(i.e.,
the
tail
is
rather
small
compared
to
the
head).
Such
estimates
then
show
that
the
behavior
of
the
q-series
is
roughly
the
same
as
the
behavior
as
the
special
functions
of
the
275
â€œmodel.â€
This
sort
of
analysis
was
already
carried
out
for
the
Hermite
Model,
which
is
technically
the
simplest
of
the
three
models,
in
Chapter
VII,
Â§6.
The
analogous
analysis
for
the
Legendre
Model
(which
is
technically
the
next
simplest
of
the
three)
is
carried
out
in
Â§1,2,
of
the
present
Chapter.
Finally,
we
carry
out
this
analysis
for
the
Binomial
Model,
which
is
by
far
the
most
technically
intricate
of
the
three
models,
in
Â§3,4,5,
of
the
present
Chapter.
In
Â§6,
we
then
relate
these
estimates
to
the
analysis
of
the
de
Rham
metric
given
in
Chapter
VII,
Â§4,5.
Finally,
in
Â§7,
we
summarize
everything
in
the
form
of
the
main
theorem.
In
a
word,
the
main
point
of
this
sort
of
â€œhead
+
tailâ€
estimate
is
to
show
that
the
â€œtailâ€
is
small.
The
reason
that
the
tail
is
small
is,
invariably,
because
it
decays
like
a
Gaussian,
since
the
q-series
in
question
are
essentially
just
derivatives
of
theta
functions.
Unfortunately,
however,
because
we
are
ultimately
working
with
the
L2
-metric
||
âˆ¼
||et
deï¬ned
by
a
discrete
set
of
points
(as
opposed
to,
say,
the
L2
-metric
obtained
by
integrating
over
the
entire
continuous
elliptic
curve
in
question),
numerous
technical
diï¬ƒculties
arise.
These
technical
diï¬ƒculties
make
the
resulting
analysis
rather
unpleasant,
especially
in
the
case
of
the
binomial
model.
Because
of
the
cumbersome
and
unenlightening
nature
of
this
analysis,
we
submit
that
the
experienced
mathematician
may
ï¬nd
it
substantially
easier
to
work
out
the
details
for
himself/herself
than
to
wade
through
the
lengthy
estimates
of
the
present
Chapter.
Also,
we
remark
in
passing,
that
although
in
Theorem
A,
we
only
give
â€œqualitative
estimatesâ€
(e.g.,
of
the
form
â€œ(constant)d
â€),
in
fact,
all
the
results
that
we
derive
involve
explicit
estimates
of
the
constants
that
appear.
We
refer
to
Â§6,7,
for
such
explicit
estimates.
Nevertheless,
despite
the
fact
that
we
made
an
eï¬€ort
to
give
such
explicit
estimates
of
the
constants
that
appear,
we
made
no
eï¬€ort
to
give
â€œbest
possible
estimatesâ€
for
these
constants.
Thus,
throughout
the
arguments
of
the
present
Chapter,
the
reader
will
often
note
that
the
estimates
tend
to
be
rather
weak,
and
that
with
very
little
extra
eï¬€ort,
one
could
give
somewhat
stronger
estimates
for
these
constants.
Our
aim
here
was
not
to
make
any
pretense
of
giving
such
strong
estimates,
but
only
to
give
estimates
that
are
representative
of
the
essential
technique
involved.
Finally,
we
remark
that
although
this
â€œhead
+
tailâ€
technique
has
an
unenlightening
technical
side,
it
also
admits
the
following
intriguing
philosophical
interpretation.
Namely,
the
terms
appearing
in
the
q-series
are
naturally
indexed
by
Z.
Roughly
speaking,
the
terms
that
contribute
to
the
head
are
those
numbered
0,
1,
.
.
.
,
N
âˆ’1
(where
N
is
a
positive
integer).
The
remaining
terms
then
naturally
form
deformations
of
the
â€œhead
termsâ€
in
the
following
fashion:
The
term
numbered
by
j
deforms
the
term
numbered
by
the
unique
Head(j)
âˆˆ
{0,
.
.
.
,
N
âˆ’
1}
such
that
Head(j)
â‰¡
j
modulo
N
.
Thus,
the
fact
that
ultimately
only
the
â€œhead
termsâ€
contribute
signiï¬cantly
may
thus
be
interpreted
as
the
datum
of
the
map
(from
Z
to
{0,
1,
.
.
.
,
N
âˆ’
1})
j
â†’
Head(j)
in
the
language
of
function-theory.
Put
another
way,
it
may
be
regarded
as
a
functiontheoretic
encoding
of
the
splitting
276
Zâˆ¼
=
{0,
1,
.
.
.
,
N
âˆ’
1}
Ã—
(N
Â·
Z)
(given
by
j
â†’
(Head(j),
j
âˆ’
Head(j))).
This
interpretation
is
interesting
for
the
following
reason:
As
explained
in
the
Introduction
to
the
present
paper,
the
Hodge-Arakelov
Comparison
Isomorphism
was
originally
envisioned
as
a
sort
of
Hodge
theory-type
comparison
theorem
between
de
Rham
and
eÌtale/singular
cohomology,
in
the
context
of
Arakelov
theory.
By
analogy
with
the
case
of
a
geometric
base
(as
opposed
to,
say,
a
number
ï¬eld
as
base)
for
the
elliptic
curve
in
question,
such
a
comparison
should
result
in
some
sort
of
Kodaira-Spencer
map,
i.e.,
a
map
from
the
tangent
vectors
of
the
base
to
tangent
vectors
of
the
moduli
stack
of
elliptic
curves
(cf.
the
Introduction).
Thus,
in
particular,
this
sort
of
comparison
theorem
should
have
something
to
do
with
absolute
diï¬€erentials
of
Z,
i.e.,
with
the
point
of
view
that
Z
contains
some
sort
of
â€œabsolute
ï¬eld
of
constants
F1
â€
over
which
it
acts
like
a
polynomial
algebra:
â€œZ
âˆ¼
=
F1
[t]â€
But
now
note
that
this
formula
â€œZ
âˆ¼
=
F1
[t]â€
is
strikingly
reminiscent
of
the
decomposition
âˆ¼
â€œZ
=
{0,
1,
.
.
.
,
N
âˆ’
1}
Ã—
(N
Â·
Z)â€
that
appeared
above.
Thus,
in
summary,
it
is
as
if
the
â€œhead
+
tailâ€
approach
is
a
sort
of
appeal
to
the
notion
Z
âˆ¼
=
F1
[t]
encoded
in
functiontheoretic
language.
In
fact,
it
is
tempting
to
take
this
analogy
a
step
further
as
follows:
The
â€œfundamental
symmetriesâ€
of
a
polarized
elliptic
curve
are
controlled
by
the
â€œtheta
groupâ€
and
its
analogous
Lie
algebra
version
(cf.
Chapter
VII,
Â§4).
Moreover,
this
sort
of
algebraic
structure
is
exactly
what
noncommutative
geometers
refer
to
as
a
noncommutative
torus.
Thus,
it
is
as
if
the
mathematics
of
the
Hodge-Arakelov
Comparison
Isomorphism
is
trying
to
assert
that:
The
symmetries/twist
inherent
in
the
inclusion
â€œF1
âŠ†
Zâ€
are
precisely
the
symmetries/twist
described
by
the
structure
known
as
a
noncommutative
torus.
It
is
the
hope
of
the
author
that
some
day
future
research
will
allow
one
to
make
these
ideas
more
rigorous.
277
Â§1.
Averages
of
Metrics
In
this
Â§,
we
discuss
certain
metrics
on
the
space
of
functions
on
S1
obtained
by
averaging
the
usual
L2
-metrics
obtained
by
restricting
these
functions
to
translates
of
a
ï¬xed
ï¬nite
subgroup
of
S1
.
These
metrics
will
play
an
important
role
in
the
theory
of
Â§2.
We
would
like
to
begin
by
discussing
the
Hilbert
space
L2
(S1
)
equipped
with
the
standard
inner
product:
def
(f,
g)
=
1
Â·
2Ï€
S1
f
Â·g
def
We
shall
write
U
=
exp(2Ï€it)
(where
t
âˆˆ
[0,
2Ï€))
for
the
standard
coordinate
on
S1
.
Thus,
any
element
f
âˆˆ
L2
(S1
)
may
be
written
in
the
form
f=

ck
Â·
U
k
kâˆˆZ
(where
ck
âˆˆ
C).
Then
L2
-norm
of
such
an
f
is
then
given
by

def
||f
||2
=
|ck
|2
kâˆˆZ
Let
us
write
C
âˆ
(S1
)
âŠ†
L2
(S1
)
for
the
subspace
of
smooth
functions
on
S1
.
def
Now
let
us
suppose
that
we
are
also
given
two
positive
integers
d,
a.
Write
d
=
d
Â·
a.
Suppose
that
we
are
also
given
positive
real
numbers
(â€œweightsâ€)
w0
,
.
.
.
,
wdâˆ’1
.
If
Ï†
=
dâˆ’1
k
1
k=0
Î³k
Â·
U
(where
Î³k
âˆˆ
C)
is
a
function
on
Î¼d
(âŠ†
S
),
then
we
would
like
to
consider
the
norm
def
1
||Ï†||2w
=
Â·
d
dâˆ’1

wk
Â·
|Î³k
|2
k=0
on
L2
(Î¼d
).
Thus,
for
smooth
functions
f
=

1
def
||f
||2w
=
||(f
|Î¼d
)||2w
=
Â·
d
ck
Â·
U
k
âˆˆ
C
âˆ
(S1
),
we
have:
kâˆˆZ
dâˆ’1

!
!
wk
Â·
!
k=0

!2
!
ck
!
k
âˆˆk+dÂ·Z
Moreover,
if
Î±
âˆˆ
S1
,
then
we
may
translate
||
âˆ¼
||w
as
follows:
1
||(TÎ±
(f
)|Î¼d
)||2w
=
Â·
d
dâˆ’1

!
!
wk
Â·
!
k=0
278

k
âˆˆk+dÂ·Z
!2
ck
Â·
Î±
!
k
!
def
(where
TÎ±
(f
)(U
)
=
f
(Î±
Â·
U
)).
Note
that
||(TÎ±
(f
)|Î¼d
)||2w
only
depends
on
the
image
of
Î±
in
S1
/Î¼d
.
Thus,
if
we
write
Î±Î¼
for
the
image
of
Î±
in
S1
/Î¼d
,
it
makes
sense
to
deï¬ne
def
||f
||2w,Î±Î¼
=
||(TÎ±
(f
)|Î¼d
)||2w
Now
we
have
the
following
result:
Proposition
1.1.
For
smooth
functions
f
=
def
1
||f
||2w,Î¼a
=
=
a
Â·

Î±Î¼
âˆˆÎ¼a
kâˆˆZ
ck
Â·
U
k
âˆˆ
C
âˆ
(S1
),
we
have:
||f
||2w,Î±Î¼
dâˆ’1
aâˆ’1

!!
1

Â·
wk
Â·
!
d

k=0

k
=0

k
âˆˆk+dÂ·k
+dÂ·Z
dâˆ’1
!2
!
1

!
!
ck
!
â‰¥
Â·
wk
Â·
!
d
k=0

!2
!
ck
!
k
âˆˆk+dÂ·Z
(where
we
regard
Î¼a
=
Î¼d
/Î¼d
âŠ†
S1
/Î¼d
).
Proof.
Indeed,
from
the
deï¬nitions,
we
have:


1
1
Â·
||f
||2w,Î±Î¼
=
Â·
a
Î±
âˆˆÎ¼
a
Î±
âˆˆÎ¼
Î¼
a
Î¼
a
dâˆ’1
!

1

!
Â·
wk
Â·
!
d

k=0
!

!2
ck
Â·
Î±k
!
k
âˆˆk+dÂ·Z

1
=
Â·
a
Î±
âˆˆÎ¼
Î¼
a
dâˆ’1
!
aâˆ’1
1

!
Â·
wk
Â·
!
d


1
=
Â·
a
Î±
âˆˆÎ¼
Î¼
a
dâˆ’1
!
aâˆ’1

1

!
Â·
wk
Â·
!
Î±dÂ·k
d

k=0
k=0
k
=0
!

!2
ck
Â·
Î±k
!

k
âˆˆk+dÂ·k
+dÂ·Z
k
=0

!2
!
ck
!
k
âˆˆk+dÂ·k
+dÂ·Z
(where
Î±
âˆˆ
S1
denotes
any
element
that
maps
to
Î±Î¼
âˆˆ
S1
/Î¼d
).
Thus,
(readjusting
the
notation)
we
see
that
it
suï¬ƒces
to
prove
that
if
Î»0
,
.
.
.
,
Î»aâˆ’1
âˆˆ
C,
then
1

Â·
a
Î±âˆˆÎ¼
a
!
aâˆ’1
!2
aâˆ’1

!!
!!2
!
k
!
Î±
Â·
Î»k
!
=
!
!Î»k
!
k=0
k=0
To
prove
this,
it
suï¬ƒces
to
observe
that
279
!
aâˆ’1
!2

aâˆ’1

aâˆ’1



!
k
!
k
Î±
Â·
Î»k
!
=
Î±
Â·
Î»k
Î±âˆ’j
Â·
Î»j
!
k=0
j=0
k=0
=
aâˆ’1

aâˆ’1

Î±kâˆ’j
Â·
Î»k
Â·
Î»j
k=0
j=0
(where
Î»j
denotes
the
complex
conjugate
of
Î»j
).
But
if
we
average
over
Î±
âˆˆ
Î¼a
in
this
last
sum,
we
see
that
the
only
terms
that
survive
are
those
for
which
k
=
j.
Moreover,
the
aâˆ’1
!!
!!2
sum
of
these
terms
is
precisely
k=0
!Î»k
!
,
as
desired.

Â§2.
The
Legendre
Model
In
this
Â§,
we
study
the
space
of
canonical
SW
zeta
functions
equipped
with
a
certain
natural
metric,
arising
from
restriction
to
torsion
points.
In
particular,
we
show
that
when
equipped
with
this
metric,
the
space
of
canonical
SW
zeta
functions
becomes
â€œapproximately
isomorphicâ€
to
the
space
of
discrete
Tchebycheï¬€
polynomials
studied
in
Chapter
VII,
Â§3.
We
begin
by
making
certain
estimates,
based
on
the
estimates
of
Chapter
VII,
Lemma
6.1.
In
the
following
discussion,
we
use
the
notation
of
Chapter
VII,
Â§6;
also,
we
assume
(for
simplicity)
that
d
â‰¥
2.
First,
we
recall
the
theta
function
Î˜Ï‡

1
Â·k2
+(iÏ‡
/n)Â·k
2
qsc
2mk+iÏ‡
Â·
Ucv
Â·
Ï‡(ket
)
=
kâˆˆZ

1
(
1
Â·k2
+(iÏ‡
/n)Â·k)
d
2
qor
2mk+iÏ‡
Â·
Ucv
Â·
Ï‡(ket
)
kâˆˆZ
In
Chapter
VII,
Â§6,
we
also
considered
the
derivatives
def
Î¶rSS
=

Î´
âˆ—
r
Ï‡
d
(Î˜Ï‡
)
=


k
r
kâˆˆZ
d
1
(
1
Â·k2
+(iÏ‡
/n)Â·k)
d
2
Â·
qor
2mk+iÏ‡
Â·
Ucv
Â·
Ï‡(ket
)
where
(to
simplify
the
notation)
we
omit
the
â€œÂ·Î¸
âˆ’m
â€
in
the
deï¬nition
of
Î¶rSS
.
To
prepare
for
the
discussion
below,
we
would
like
to
introduce
various
objects
related
to
the
coeï¬ƒcients
of
this
expansion.
If
we
think
of
the
integers
0,
.
.
.
,
d
âˆ’
1
as
representing
the
elements
of
Z/dZ,
then
for
j
=
0,
.
.
.
,
d
âˆ’
1,
let
us
write
def
ej
=
Min
1
2
Â·
k
+
(iÏ‡
/n)
Â·
k)
2
280
def
(where
the
minimum
is
over
k
such
that
k
â‰¡
j
modulo
d)
and
wj
=
|qsc
|âˆ’2Â·ej
â‰¥
1.
Next,
iÏ‡
â€
of
Chapter
V,
Theorem
4.8.
Let
us
write
recall
the
linear
function
â€œLd
(T
)
=
T
+
Î»d
âˆ’
2m
def
Î»d
ld
=
d
Thus,
0
â‰¤
ld
â‰¤
12
(since
d
â‰¥
2).
It
is
easy
to
check
that
Î»d
has
the
following
property
(cf.
the
proof
of
Chapter
V,
Theorem
4.8):
the
minimum
appearing
in
the
deï¬nition
of
ej
is
attained
for
any
k
such
that
0
â‰¤
k
+
Î»d
â‰¤
d
âˆ’
1.
Let
us
write
def
KCrit
=
{0
âˆ’
Î»d
,
1
âˆ’
Î»d
,
.
.
.
,
d
âˆ’
1
âˆ’
Î»d
}
for
the
set
of
such
â€œcriticalâ€
k.
It
thus
follows
that
ej
is
attained
for
some
k
satisfying
|k|
â‰¤
d.
In
particular,
it
follows
that
2|ej
|
â‰¤
|k2
+
(iÏ‡
/m)
Â·
k|
â‰¤
32
Â·
d2
,
hence
that
0
â‰¤
log(wj
)
â‰¤
3Ï€
Â·
Im(Ï„or
)
Â·
d
â‰¤
6(1
+
)Q
Â·
d
(in
the
notation
of
Chapter
VII,
Lemma
6.1,
(2)).
Thus,
if,
for
instance,
one
is
considering
a
situation
in
which
Im(Ï„or
)
varies
in
a
compact
subset
of
the
upper
half-plane,
then
it
follows
that
on
that
compact
subset,
wj
is
bounded
above
and
below
by
constants
C1d
,
C2d
,
where
C1
,
C2
âˆˆ
R>0
depend
only
on
the
compact
set.
Now
that
w0
,
.
.
.
,
wdâˆ’1
have
been
deï¬ned,
we
may
apply
the
theory
of
Â§1.
In
particular,
if
we
ï¬x
a

positive
integer
a
â‰¥
2,
then
it
follows
from
Proposition
1.1
that
for
smooth
functions
f
=
kâˆˆZ
Ï†k
Â·
U
k
âˆˆ
C
âˆ
((S1
)sc
),
we
have
the
following
â€œaveragedâ€
L2
-norm:
def
1
||f
||2w,Î¼a
=
d
Â·
dâˆ’1

wj
Â·
aâˆ’1

j

=0
j=0
!
!
!

!2
!
Ï†k
!
kâˆˆj+dÂ·j

+dÂ·Z
In
this
Â§,
we
would
like
to
consider
two
related
norms:
def
1
||f
||2Tch
=
Â·
d

!
!
wj
Â·
!
jâˆˆKCrit

!2
!
Ï†k
!
â‰¤
||f
||2w,Î¼a
kâˆˆj+dÂ·Z
(where,
for
j
<
0
or
>
dâˆ’1,
wj
is
deï¬ned
as
wj

for
the
unique
j
âˆˆ
{0,
.
.
.
,
dâˆ’1}
such
that
j
â‰¡
j;
and
the
inequality
follows
from
the
fact
that
||f
||2Tch
is
deï¬ned
to
be
the
sum
of
a
subset
of
the
same
collection
of
nonnegative
numbers
whose
sum
constitutes
the
deï¬nition
of
||f
||2w,Î¼a
)
and
def
1
||f
||2Tch
=
Â·
d

jâˆˆKCrit
281
!
!2
!
!
wj
Â·
!Ï†j
!
In
fact,
in
the
following
discussion,
we
would
like
to
consider
functions
f
âˆˆ
C
âˆ
((S1
)cv
)
def
i
which
are
of
the
form
f1
Â·
UcvÏ‡
,
for
some
f1
âˆˆ
C
âˆ
((S1
)sc
).
For
such
f
,
we
write
||f
||??
=
||f1
||??
,
where
??=
w,
Î¼a
;
Tch
;
or
Tch.
Next,
let
us
observe
that
when
f
=
Î˜Ï‡
,
then
it
follows
from
the
above
discussion
concerning
ld
that
the
resulting
â€œÏ†j
â€
satisfy
wj
Â·
|Ï†j
|2
=
1,
for
j
âˆˆ
KCrit
.
Similarly,
if
Î´Ï‡âˆ—
is
the
diï¬€erential
operator
of
Chapter
VII,
Â§6,
and
P
(âˆ’)
is
a
polynomial
with
complex
coeï¬ƒcients,
then
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||2Tch
=

1
Â·
d
!2
!
!
!
P
(j)
!
!
jâˆˆKCrit
that
is
to
say,
the
expression
on
the
right-hand
side
of
this
equation
is
essentially
(i.e.,
up
to
a
factor
of
d1
in
front,
and
a
shift
in
the
variable
j
by
the
number
Î»d
of
Chapter
V,
Theorem
4.8)
the
(squared)
L2
-norm
||
âˆ¼
||2
considered
in
our
discussion
of
discrete
Tchebycheï¬€
polynomials
(Chapter
VII,
Â§3).
In
the
following,
we
would
like
to
show
that
in
the
situation
that
we
are
interested
in,
the
norms
subscripted
w,
Î¼a
;
Tch
;
and
Tch
are
very
close
to
another
and
hence
that
the
theory
of
orthogonal
functions
with
respect
to
the
w,
Î¼a
-norm
is
very
close
to
the
theory
of
discrete
Tchebycheï¬€
polynomials
of
Chapter
VII,
Â§3.
This
observation
motivates
the
following
deï¬nitions:
First,
we
introduce
some
indeterminates
def
T
t
=
d
;
def
s
=
t
+
ld
Thus,
as
T
ranges
over
KCrit
,
s
ranges
over
0,
d1
,
.
.
.
,
dâˆ’1
d
.
In
particular,
we
have
1
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||2Tch
=
Â·
d

jâˆˆKCrit
dâˆ’1
!
!2
!2
1

!!
!
!
!
!P
(âˆ’)|T
=j
!
=
Â·
!P
(j)|s=
j
!
d
d
j=0
This
makes
the
relationship
between
the
norms
considered
here
and
the
norms
of
Chapter
VII,
Â§3,
explicit.
Recall
that
the
â€œnormalized
discrete
Tchebycheï¬€
polynomialsâ€
tr
(s)
of
Chapter
VII,
Proposition
3.2,
are
orthonormal
with
respect
to
the
(square
L2
-)
norm
!2
dâˆ’1
!!
!
Q(s)
â†’
d1
Â·
j=0
!Q(
dj
)!
.
Now
we
deï¬ne
the
(discrete)
Tchebycheï¬€
canonical
SW
zeta
functions
as
follows:
def
Î¶rTCH
=

2
1
1
Î´Ï‡âˆ—
k
2mk+iÏ‡
d
(
2
Â·k
+(iÏ‡
/n)Â·k)
tr
(
+
ld
)
Â·
qor
tr
(
+
ld
)
Â·
(Î˜Ï‡
)
=
Â·
Ucv
Â·
Ï‡(ket
)
d
d
kâˆˆZ
282
where
0
â‰¤
r
â‰¤
d
âˆ’
1,
tr
(s)
is
the
â€œnormalized
discrete
Tchebycheï¬€
polynomialâ€
of
Chapter
VII,
Proposition
3.2.
Thus,
The
Î¶rTCH
are
orthonormal
with
respect
to
the
inner
product
deï¬ned
by
||
âˆ¼
||Tch
.
Now
we
would
like
to
estimate
the
diï¬€erence
between
the
various
norms
deï¬ned
above:
def
Lemma
2.1.
Let
A
be
an
integer
which
satisï¬es
A
â‰¥
Max(a,
1
+
Qâˆ’1
),
where
Q
=
Ï€
4
Â·
Im(Ï„or
).
Then
we
have:
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||Tch
â‰¤
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||w,Î¼a
â‰¤
(r
+
1)
2
Â·
e4r+4
Â·
A2r+1
Â·
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||Tch
9
for
any
polynomial
with
complex
coeï¬ƒcients
P
(âˆ’)
of
degree
â‰¤
r
<
d.
Proof.
The
ï¬rst
inequality
was
already
noted
in
the
discussion
above.
Thus,
let
us
prove
the
second
inequality.
We
may
assume
without
loss
of
generality
that
||P
(Î´Ï‡âˆ—
)Â·Î˜Ï‡
||2Tch
=
1.
Thus,
it
follows
from
the
above
discussion
that
P
(T
)
=
r

Î³j
Â·
tj
(t
+
ld
)
j=0
where
Î³j
âˆˆ
C,
r
j=0
|Î³j
|2
=
1.
Next,
we
would
like
to
bound
the
coeï¬ƒcients
of
P
(T
)
as
a
polynomial
in
t.
To
do
this,
1
ï¬rst
we
observe
that
the
coeï¬ƒcients
of
tj
(âˆ’)
(for
j
â‰¤
r)
may
be
bounded
by
(2r+1)
2
Â·e3r+1
(by
Chapter
VII,
Proposition
3.2,
(ii.)).
Moreover,
if
one
expands
(t
+ld
)j
(for
j
â‰¤
r)
as
a

polynomial
in
t,
the
absolute
values
of
the
coeï¬ƒcients
are
bounded
by
jj
Â·
|ld
|j
â‰¤
2j
â‰¤
2r
(where
0
â‰¤
j
â‰¤
j,
and
we
note
that
|ld
|
â‰¤
12
).
Since
(t
+
ld
)j
(for
j
â‰¤
r)
has
â‰¤
r
+
1
terms
as
a
polynomial
in
t,
it
thus
follows
that
as
a
polynomial
in
t,
tj
(t
+
ld
)
has
coeï¬ƒcients
of
5
5
absolute
value
â‰¤
(r
+
1)
2
Â·
e3r+2
Â·
2r
â‰¤
(r
+
1)
2
Â·
e4r+2
.
Since
|Î³j
|
â‰¤
1
(for
j
â‰¤
r),
we
thus
obtain
that
as
a
polynomial
in
t,
P
(T
)
=
P
(t
+
ld
)
has
coeï¬ƒcients
of
absolute
value
7
â‰¤
(r
+
1)
2
Â·
e4r+2
Thus,
we
obtain
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||w,Î¼a
â‰¤
(r
+
1)
2
Â·
e4r+2
Â·
7
7
2
â‰¤
(r
+
1)
Â·
e
4r+2
Â·

Î´
âˆ—
j
Ï‡
||
Â·
Î˜Ï‡
||w,Î¼a
d
j=0
r

r

j=0
283
||Î¶jSS
||w,Î¼a
On
the
other
hand,
the
terms
||Î¶jSS
||w,Î¼a
may
be
bounded
by
what
was
already
done
in
Chapter
VII,
Lemma
6.1,
as
follows.
To
simplify
the
notation
(more
precisely,
to
free
up
the
letter
â€œjâ€
for
use
in
future
summations),
we
consider
the
case
j
=
r.
When
j
<
r,
a
similar
argument
applies.
Now
recall
the
general
formula:
1
||f
||2w,Î¼a
=
Â·
d
dâˆ’1

j=0
wj
Â·
aâˆ’1

j

=0
!
!
!

!2
!
Ï†k
!
kâˆˆj+dÂ·j

+dÂ·Z
In
the
case
of
f
=
Î¶rSS
,
we
would
like
to
divide
up
the
task
of
bounding
the
|Ï†k
|
into
two
cases,
the
case
where
|k|
<
A
Â·
d,
and
the
case
where
|k|
â‰¥
A
Â·
d:
Case
(i):
First,
we
consider
the
case
where
|k|
<
A
Â·
d.
In
this
case,
it
follows
from
Chapter
VII,
Lemma
6.1,
(1),
(plus
the
deï¬nition
of
wk
)
that
wj
Â·
|Ï†k
|2
â‰¤
A2r
.
Note
that
the
number
of
k
in
a
given
residue
class
modulo
d
=
a
Â·
d
that
fall
under
the
present
Case
(i)
is
â‰¤
2
Â·
A
Â·
aâˆ’1
.
Case
(ii):
Next,
we
consider
the
case
where
|k|
â‰¥
A
Â·
d.
Let
k0
denote
the
unique
integer
âˆˆ
KCrit
such
that
k
â‰¡
k0
modulo
d.
Let
Ïƒk
be
the
sign
of
k,
i.e.,
1
(respectively,
âˆ’1)
if
k
is
>
0
(respectively,
<
0).
def
Write
kÎ´
=
Ïƒk
Â·
(|k|
âˆ’
|k0
|).
Note
that
since
|k0
|
â‰¤
d,
we
obtain
that
|kÎ´
|
â‰¥
(A
âˆ’
1)
Â·
d
â‰¥
1
(since
A
â‰¥
2).
Thus,
(k2
+
(iÏ‡
/m)
Â·
k)
âˆ’
(k02
+
(iÏ‡
/m)
Â·
k0
)
=
(|k0
|
+
|kÎ´
|)2
âˆ’
k02
+
(iÏ‡
/m)
Â·
(kÎ´
+
k
âˆ’
k0
âˆ’
kÎ´
)
=
kÎ´2
+
(iÏ‡
/m)
Â·
kÎ´
+
2
Â·
|k0
|
Â·
|kÎ´
|
+
(iÏ‡
/m)
Â·
(Ïƒk
Â·
|k0
|
âˆ’
k0
)
â‰¥
kÎ´2
+
(iÏ‡
/m)
Â·
kÎ´
+
2
Â·
|k0
|
Â·
(|kÎ´
|
âˆ’
1)
â‰¥
kÎ´2
+
(iÏ‡
/m)
Â·
kÎ´
But
note
that,
if
we
raise
these
inequalities
to
the
base
qsc
,
we
obtain
that

|k|
2r
wj
Â·
|Ï†k
|2
=
wk0
Â·
|Ï†k
|2
â‰¤
Â·
|Ï†kÎ´
|2
|kÎ´
|

A
2r
â‰¤
Â·
|Ï†kÎ´
|2
â‰¤
4r
Â·
|Ï†kÎ´
|2
Aâˆ’1
def
Thus,
by
Chapter
VII,
Lemma
6.1,
if
Aâˆ’1
â‰¥
Qâˆ’1
,
where
Q
=
Ï€4
Â·Im(Ï„or
)
(and
we
take
â€œb,â€
â€œ
â€
in
loc.
cit.
to
be
1;
â€œaâ€
in
loc.
cit.
to
be
A
âˆ’
1;
â€œkâ€
in
loc.
cit.
to
be
kÎ´
),
then

1
wj2
Â·
|Ï†k
|
â‰¤
2r+2
Â·
eâˆ’(Aâˆ’1)Â·d
â‰¤
2d+2
Â·
eâˆ’(Aâˆ’1)Â·d
|k|â‰¥AÂ·d
â‰¤
4
Â·
eâˆ’(Aâˆ’2)Â·d
â‰¤
4
284
If
we
then
add
up
the
contributions
from
these
two
cases,
we
obtain
dâˆ’1
aâˆ’1

!!
1

Â·
wj
Â·
!
d
j=0

j
=0

kâˆˆj+dÂ·j

+dÂ·Z
dâˆ’1
aâˆ’1
!2
1



!
Ï†k
!
â‰¤
Â·
d
j=0

j
=0
!
!2
1
!
!
wj2
Â·
!Ï†k
!

kâˆˆj+dÂ·j

+dÂ·Z
dâˆ’1
aâˆ’1
2
1



â‰¤
Â·
2
Â·
A
Â·
aâˆ’1
Â·
A2r
+
4
d
j=0

j
=0
2

2

âˆ’1
2r+1
2r+1
â‰¤aÂ·
6Â·a
Â·A
â‰¤
6Â·A
(where
we
use
that
A
â‰¥
a
in
the
third
inequality).
Thus,
we
have
||Î¶rSS
||w,Î¼a
â‰¤
6
Â·
A2r+1
.
Combining
this
with
the
previous
inequalities
concerning
||P
(Î´Ï‡âˆ—
)Â·Î˜Ï‡
||2w,Î¼a
,
we
thus
obtain
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||w,Î¼a
â‰¤
(r
+
1)
2
Â·
e4r+2
Â·
6
Â·
A2r+1
â‰¤
(r
+
1)
2
Â·
e4r+4
Â·
A2r+1
9
9
as
desired.

Next,
we
would
like
to
compare
||
âˆ¼
||Tch
and
||
âˆ¼
||Tch
.
Lemma
2.2.
def
Suppose
that
a
â‰¥
Max(2
+
Qâˆ’1
,
8),
where
Q
=
Ï€4
Â·
Im(Ï„or
).
Then
we
have:
1âˆ’(d+1)
2
Â·e4âˆ’d
Â·||P
(Î´Ï‡âˆ—
)Â·Î˜Ï‡
||Tch
â‰¤
||P
(Î´Ï‡âˆ—
)Â·Î˜Ï‡
||Tch
â‰¤
1+(d+1)
2
Â·e4âˆ’d
Â·||P
(Î´Ï‡âˆ—
)Â·Î˜Ï‡
||Tch
9
9
for
any
polynomial
with
complex
coeï¬ƒcients
P
(âˆ’)
of
degree
â‰¤
r
<
d.
Here,
the
ï¬rst
9
expression
in
large
brackets,
i.e.,
1
âˆ’
(d
+
1)
2
Â·
e4âˆ’d
,
is
â‰¥
12
if
d
â‰¥
25.
Proof.
The
argument
is
similar
to
the
argument
given
for
â€œCase
(ii)â€
in
the
proof
of
Lemma
2.1
(except
that
we
take
â€œAâ€
to
be
a
âˆ’
1).
Indeed,
the
diï¬€erence
between
the
two
norms
def
1
||f
||2Tch
=
d
Â·

jâˆˆKCrit
!
!
wj
Â·
!

!2
!
Ï†k
!
;
kâˆˆj+dÂ·Z
def
1
and
||f
||2Tch
=
d
Â·

!
!2
!
!
w
j
Â·
!
Ï†j
!
jâˆˆKCrit
is
that
the
sum
in
the
deï¬nition
of
||f
||2Tch
involves
the
Ï†k
for
k
âˆˆ
(KCrit
+
d
Â·
Z)\KCrit
,
i.e.,
(by
the
triangle
inequality)
285
(||f
||Tch
âˆ’
||f
||Tch
)
2
def
1
â‰¤
||f
||2TchÎ”
=
Â·
d
!
!
wj
Â·
!

jâˆˆKCrit

!2
!
Ï†k
!
kâˆˆ(j+dÂ·Z)\{j}
Just
as
in
the
proof
of
Lemma
2.1,
we
may
assume
without
loss
of
generality
that
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||2Tch
=
1.
This
implies
(just
as
in
the
proof
of
Lemma
2.1)
that
the
coeï¬ƒcients
of
P
(âˆ’)
7
have
absolute
value
â‰¤
(r
+
1)
2
Â·
e4r+2
,
hence
that
7
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||TchÎ”
â‰¤
(r
+
1)
2
Â·
e4r+2
Â·
r

||Î¶jSS
||TchÎ”
j=0
Thus,
it
suï¬ƒces
to
bound
||Î¶rSS
||TchÎ”
.
But
(as
remarked
at
the
beginning
of
this
proof)
this
was
essentially
already
done
in
â€œCase
(ii)â€
of
the
proof
of
Lemma
2.1.
More
precisely,
/
KCrit
.
We
would
like
to
let
k0
âˆˆ
KCrit
,
k
â‰¡
k0
modulo
d;
assume,
moreover,
that
k
âˆˆ
SS
consider
the
coeï¬ƒcient
Ï†k
in
the
expansion
of
f
=
Î¶r
.
Note
that
since
|k0
|
â‰¤
d,
k
âˆˆ
KCrit
,
it
follows
that
|k|
â‰¥
d
âˆ’
d
=
(a
âˆ’
1)d.
Thus,
if
we
substitute
a
âˆ’
1
(â‰¥
1
+
Qâˆ’1
)
for
â€œAâ€
in
the
treatment
of
Case
(ii)
in
the
proof
of
Lemma
2.1,
we
obtain

1
wk20
Â·
|Ï†k
|
â‰¤
4
Â·
eâˆ’(aâˆ’3)Â·d
|k|â‰¥(aâˆ’1)Â·d
hence
1
||Î¶rSS
||2TchÎ”
=
Â·
d
â‰¤

!
!
wk0
Â·
!
k0
âˆˆKCrit
1
Â·
d


!2
!
Ï†k
!
kâˆˆ(k0
+dÂ·Z)\{k0
}
16
Â·
eâˆ’2(aâˆ’3)Â·d
=
16
Â·
eâˆ’2(aâˆ’3)Â·d
k0
âˆˆKCrit
Thus,
we
have
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||TchÎ”
â‰¤
(r
+
1)
2
Â·
e4r+2
Â·
4
Â·
eâˆ’(aâˆ’3)Â·d
9
â‰¤
(d
+
1)
2
Â·
e4
Â·
eâˆ’(aâˆ’7)Â·d
â‰¤
(d
+
1)
2
Â·
e4âˆ’d
9
9
9
(where
in
the
last
inequality
we
use
that
a
â‰¥
8).
Moreover,
(d
+
1)
2
Â·
e4âˆ’d
â‰¤
12
if
d
â‰¥
25.
This
completes
the
proof.

We
are
now
ready
to
state
the
main
result
of
this
Â§:
Theorem
2.3.
Let
HÏ‡d
be
the
vector
space
of
functions
on
S1
of
the
form
P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
,
where
P
(âˆ’)
is
a
polynomial
of
degree
<
d
with
complex
coeï¬ƒcients,
and
Î˜Ï‡
and
Î´Ï‡âˆ—
are
as
286
deï¬ned
in
Chapter
VII,
Â§6.
For
r
âˆˆ
Z,
let
F
r
(HÏ‡d
)
âŠ†
HÏ‡d
be
the
subspace
of
such
functions
for
which
the
degree
of
P
(âˆ’)
is
â‰¤
r
(cf.
the
notation
of
Chapter
VII,
Â§1).
Let
a
â‰¥
8
be
an
integer.
Let
||
âˆ¼
||w,Î¼a
be
the
L2
-norm
on
HÏ‡d
given
by
averaging
the
L2
-norms
on
Î±
Â·
Î¼d
âŠ†
(S1
)sc
with
weights
w0
,
.
.
.
,
wdâˆ’1
(as
deï¬ned
at
the
beginning
of
this
Â§)
as
Î±
varies
in
Î¼aÂ·d
/Î¼d
(see
the
above
discussion
for
more
details).
Let
||
âˆ¼
||Tch
be
the
L2
-norm
on
HÏ‡d
given
by:
dâˆ’1
!2
1

!!
!
âˆ—
2
||P
(Î´Ï‡
)
Â·
Î˜Ï‡
||Tch
=
Â·
!P
(j
âˆ’
Î»d
)!
d
j=0
where
ld
is
d1
times
the
constant
â€œÎ»d
â€
of
Chapter
V,
Theorem
4.8.
Then
as
r
varies
over
0,
.
.
.
,
d
âˆ’
1,
the
functions
def
Î¶rTCH
=
tr
(

2
1
1
Î´Ï‡âˆ—
k
2mk+iÏ‡
d
(
2
Â·k
+(iÏ‡
/n)Â·k)
tr
(
+ld
)Â·qor
Â·Ucv
Â·Ï‡(ket
)
+ld
)Â·(Î˜Ï‡
)
=
d
d
âˆˆ
F
r
(HÏ‡d
)
kâˆˆZ
(where
tr
(âˆ’)
is
the
â€œnormalized
discrete
Tchebycheï¬€
polynomialâ€
of
Chapter
VII,
Proposition
3.2)
form
an
orthonormal
basis
of
HÏ‡d
with
respect
to
the
inner
product
associated
to
def
norm
||
âˆ¼
||Tch
.
Moreover,
if
a
â‰¥
Max(2
+
Qâˆ’1
,
8)
(where
Q
=
Ï€4
Â·
Im(Ï„or
)
â€“
cf.
Chapter
VII,
Lemma
6.1),
and
d
â‰¥
25,
then
we
have
9
1
Â·
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||Tch
â‰¤
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||w,Î¼a
â‰¤
(r
+
1)
2
Â·
e4r+4
Â·
a2r+1
Â·
||P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
||Tch
2
w,Î¼a
w,Î¼
,
.
.
.
,
Î¶dâˆ’1
a
form
an
orthonormal
basis
of
HÏ‡d
with
respect
to
the
r
w,Î¼
TCH
,
then
inner
product
associated
to
||
âˆ¼
||w,Î¼a
,
and
we
write
Î¶r
a
=
j=0
Î³r,j
Â·
Î¶j
r
2
j=0
|Î³r,j
|
â‰¤
4,
and
In
particular,
if
Î¶0
9
(r
+
1)
2
Â·
e4r+4
Â·
a2r+1
âˆ’1
â‰¤
|Î³r,r
|
â‰¤
2
Finally,
if
Im(Ï„or
)
varies
in
a
compact
subset
of
the
upper
half-plane,
then
on
that
compact
subset,
the
wj
are
bounded
above
and
below,
i.e.,
there
exist
constants
C1
,
C2
âˆˆ
R>0
(depending
only
on
the
compact
set)
such
that
C1d
Â·
||
âˆ¼
||1,Î¼a
â‰¤
||
âˆ¼
||w,Î¼a
â‰¤
C2d
Â·
||
âˆ¼
||1,Î¼a
where
||
âˆ¼
||1,Î¼a
is
the
norm
deï¬ned
in
the
same
way
as
||
âˆ¼
||w,Î¼a
except
with
all
the
â€œweightsâ€
(i.e.,
â€œwj
â€)
equal
to
1.
287
Proof.
Most
of
the
assertions
of
Theorem
2.3
have
already
been
proven.
Thus,
it
remains
only
to
check
the
following:
The
inequalities
relating
||
âˆ¼
||w,Î¼a
and
||
âˆ¼
||Tch
follow
from
2.1,
2.2
(where
in
Lemma
2.1,
we
take
â€œAâ€
to
be
a).
The
resulting
bound
r
Lemmas
2
|Î³
|
â‰¤
4
follows
immediately.
This
implies
|Î³r,r
|
â‰¤
2.
The
lower
bound
for
r,j
j=0
|Î³r,r
|
results
from
the
elementary
geometry
of
Hilbert
spaces,
together
with
the
inequality
bounding
||
âˆ¼
||w,Î¼a
in
terms
of
||
âˆ¼
||Tch
.

Remark.
Thus,
stated
in
words,
Theorem
2.3
asserts
the
following:
Up
to
a
factor
of
order
C
r
on
the
degree
â‰¤
r
portion
of
HÏ‡d
=
{P
(Î´Ï‡âˆ—
)
Â·
Î˜Ï‡
|
deg(P
(âˆ’))
<
d}
the
L2
-norm
on
HÏ‡d
given
by
averaging
the
L2
-norms
on
the
Î±
Â·
Î¼d
(as
Î±
varies
over
Î¼aÂ·d
/Î¼a
,
and
a
â‰¥
8,
d
â‰¥
25
are
suï¬ƒciently
large)
with
weights
w0
,
.
.
.
,
wdâˆ’1
induces
orthonormal
polynomials
which
are
essentially
the
discrete
Tchebycheï¬€
polynomials.
Thus,
as
d
â†’
âˆ,
the
orthonormal
polynomials
for
this
averaged
L2
-norm
are
essentially
the
Legendre
polynomials
(cf.
Chapter
VII,
Propositions
2.1,
3.1).
Moreover,
if
the
elliptic
curve
in
question
varies
on
a
compact
set,
then,
up
to
a
factor
of
order
C
d
,
we
may
even
assume
that
the
weights
(i.e.,
the
â€œwj
â€)
are
all
equal
to
1.
Stated
in
this
way,
we
feel
that
this
theorem
justiï¬es
the
terminology
â€œLegendre
modelâ€
used
in
the
title
of
this
Â§.
Also,
note
that,
as
expected,
the
Legendre
limit
involves
a
scaling
factor
of
d,
i.e.,
this
limit
is
a
slope
1
limit
â€“
cf.
the
discussions
at
the
end
of
Chapter
VII,
Â§3,
6.
Finally,
we
remark
that
that
if,
on
the
other
hand,
one
ï¬xes
d
and
lets
a
â†’
âˆ,
then
one
veriï¬es
easily
that
the
norm
with
weights
equal
to
1,
i.e.,
1
||f
||21,Î¼a
=
Â·
d
dâˆ’1
aâˆ’1


!!
!
j=0
j

=0

!2
!
Ï†k
!
kâˆˆj+dÂ·j

+dÂ·Z
converges
(up
to
a
constant
factor)
to
the
usual
L2
-norm
on
L2
(S1
).
Thus,
in
this
limit,
the
resulting
orthonormal
functions
converge
(up
to
a
constant
factor)
to
the
orthogonal
1
canonical
Schottky-Weierstrass
zeta
functions
Î¶rOR,S
of
Chapter
VII,
Deï¬nition
6.3.
288
Â§3.
The
Truncated
Binomial
Model
In
this
Â§,
we
discuss
the
analogue
of
the
â€œtruncatedâ€
(i.e.,
by
comparison
to
||
âˆ¼
||Tch
,
||
âˆ¼
||w,Î¼a
)
norm
||
âˆ¼
||Tch
of
Â§2
for
what
we
call
the
binomial
model.
In
the
case
of
the
Legendre
model
that
we
studied
in
Â§2,
the
truncated
version
was
essentially
isomorphic
to
the
system
of
discrete
Tchebycheï¬€
polynomials
(cf.
Chapter
VII,
Â§3),
which
is
already
well-known.
In
the
present
binomial
case,
however,
the
truncated
version
is
not
so
wellknown,
so
we
give
an
independent
treatment
in
the
present
Â§.
This
will
prepare
us
for
the
following
two
Â§â€™s,
in
which
we
study
the
function
space
of
derivatives
of
the
theta
function
by
regarding
it
as
a
deformation
of
the
truncated
binomial
model
(cf.
what
we
did
in
Â§2
â€“
i.e.,
we
studied
this
same
function
space
by
regarding
it
as
a
deformation
of
the
discrete
Tchebycheï¬€
polynomials).
We
maintain
the
notation
of
Â§2.
In
this
Â§,
we
would
like
to
consider
a
ï¬ltration
on
the
set
KCrit
,
deï¬ned
as
follows.
Recall
the
function
â€œLr
(T
)
=
T
+
Î»r
âˆ’
iÏ‡
/nâ€
of
Chapter
V,
Theorem
4.8.
Then
we
deï¬ne
(for
r
=
0,
1,
.
.
.
,
d)
def
F
r
(KCrit
)
=
{0
âˆ’
Î»r
,
1
âˆ’
Î»r
,
.
.
.
,
r
âˆ’
1
âˆ’
Î»r
}
Thus,
F
r
(KCrit
)
has
r
elements;
F
0
(KCrit
)
=
âˆ…;
F
d
(KCrit
)
=
KCrit
.
Moreover,
one
checks
easily
from
the
deï¬nitions
that
(for
r
=
1,
.
.
.
,
d)
F
râˆ’1
(KCrit
)
âŠ†
F
r
(KCrit
).
Thus,
for
r
=
0,
.
.
.
,
d
âˆ’
1
F
r+1
(KCrit
)\F
r
(KCrit
)
consists
of
precisely
one
element,
which
we
denote
by
k[r].
Moreover,
the
ï¬ltration
F
r
(KCrit
)
induces
a
total
ordering
â€œâ‰¤Crit
â€
on
the
set
KCrit
deï¬ned
by
k
â‰¤Crit
k
(for
k,
k
âˆˆ
KCrit
)
if
k
âˆˆ
F
r
(KCrit
)
=â‡’
k
âˆˆ
F
r
(KCrit
)
(for
all
r
=
1,
.
.
.
,
d).
Put
another
way,
k[r1
]
â‰¤Crit
k[r2
]
â‡â‡’
r1
â‰¤
r2
When
the
chosen
character
belongs
to
Case
I
(respectively,
Case
II;
Case
III),
and
r
is
even
(respectively,
odd;
either
even
or
odd)
F
r
(KCrit
)
is
the
set
of
exponents
of
â€œU
â€
(cf.
Chapter
V,
Schola
4.1)
of
the
ï¬rst
r
special
monomials
considered
in
Chapter
V,
Schola
4.1,
where
â€œï¬rstâ€
is
relative
to
the
ordering
induced
by
the
exponent
of
q.
Stated
in
a
word,
the
purpose
of
the
present
and
the
next
two
Â§â€™s,
is
to
study
the
congruence
canonical
SW
zeta
functions
(cf.
Chapter
V,
Theorem
4.8)
def
Î¶rCG
=



k
+
Î»r

1
Â·k2
+(iÏ‡
/n)Â·k
Lr
(Î´
âˆ—
)
CG
2mk+iÏ‡
2
Â·
Ucv
Â·
Ï‡(ket
)
Â·
qsc
(Î¶0
)
=
r
r
kâˆˆZ
289
at
the
inï¬nite
prime
(where,
for
simplicity,
we
omit
mention
of
the
â€œtrivializationâ€
Î¸
m
).
In
the
present
Â§,
we
would
like
to
consider
the
following
truncated
versions
of
the
Î¶rCG
:
def
âˆ’
1
Â·k[r]2
âˆ’(iÏ‡
/n)Â·k[r]
ZrCG
=
qsc
2
Â·


kâˆˆKCrit
k
+
Î»r
r

1
Â·k2
+(iÏ‡
/n)Â·k
2
Â·
qsc
k
Â·
Usc
Â·
Ï‡(ket
)
i
n
=
Usc
(note
that
we
also
divide
by
the
unnecessary
factor
of
UcvÏ‡
).
Note
that
where
Ucv
the
only
nonzero
terms
of
this
sum
over
KCrit
are
those
for
which
k
âˆˆ
/
F
r
(KCrit
).
Thus,
the
exponents
of
qsc
are
all
nonnegative.
In
the
following
discussion,
we
shall
write
def
1
Î¨(k)
=
2
Â·
k2
+
iÏ‡
k
n
for
the
function
of
k
appearing
in
the
exponent
of
qsc
.
In
this
Â§,
we
would
like
to
think
of
the
space
of
linear
combinations
of
the
ZrCG
as
equipped
with
the
usual
L2
-norm
||
âˆ¼
||
k
(k
âˆˆ
Z)
form
an
orthonormal
system
â€“
cf.
Â§1).
on
(S1
)sc
(i.e.,
the
norm
for
which
the
Usc
The
purpose
of
the
present
Â§
is
to
consider
the
following
problem:
Let
def
Z
=
dâˆ’1

Î³r
Â·
ZrCG
r=0
be
a
C-linear
combination
(i.e.,
the
Î³r
âˆˆ
C)
of
the
ZrCG
.
def
Suppose
that
||Z||
=
1.
Then
to
what
extent
can
one
bound
the
gr
=
|Î³r
|?
k
(k
âˆˆ
Z)
form
an
orthonormal
system,
it
follows
that
the
coefSince
||Z||
=
1,
and
the
Usc
k
ï¬cients
of
the
Usc
(in
the
â€œFourier
expansionâ€
of
Z)
are
â‰¤
1.
In
particular,
the
coeï¬ƒcient
k[r]
of
Usc
is
â‰¤
1,
hence:


r
!
!

k[r]
+
Î»j
!
!
Î¨(k[r])âˆ’Î¨(k[j])
Î³j
Â·
Â·
Ï‡(k[r]et
)
!
â‰¤
1
Â·
qsc
!
j
j=0
Thus,
if
we
write
def
C[r,
j]
=

k[r]
+
Î»j
j

then
we
obtain
290
Â·
|qsc
|Î¨(k[r])âˆ’Î¨(k[j])
gr
â‰¤
1
+
râˆ’1

C[r,
r1
]
Â·
gr1
r1
=0
(so
in
particular,
g0
â‰¤
1).
If
we
then
substitute
into
this
last
inequality
the
analogous
inequality
for
gr1
,
we
obtain

gr
â‰¤
1
+
C[r,
r1
]
+
r>r1
â‰¥0

C[r,
r1
]
Â·
C[r1
,
r2
]
Â·
gr2
r>r1
>r2
â‰¥0
Continuing
in
this
fashion,
we
obtain
gr
â‰¤
1
+
r


C[r,
r1
]
Â·
C[r1
,
r2
]
Â·
.
.
.
Â·
C[rjâˆ’1
,
rj
]
j=1
r>r1
>r2
>...>rj
â‰¥0
(where
we
use
that
g0
â‰¤
1,
and
that
if
r
>
r1
>
.
.
.
>
rj
â‰¥
0,
then
j
â‰¤
r).
Next,
we
would
like
to
analyze
this
double
summation
in
more
detail.
First,
we
would
like
to
estimate
the
number
of
terms
appearing
in
this
summation.
By
using
the
transformation
(r1
,
r2
,
.
.
.
,
rj
)
â†’
(r
âˆ’
r1
,
r1
âˆ’
r2
,
r2
âˆ’
r3
,
.
.
.
,
rjâˆ’1
âˆ’
rj
),
one
veriï¬es
easily
that
the
number
of
terms
in
this
double
summation
is
â‰¤
the
coeï¬ƒcient
of
tr
in
the
power
series
(1
âˆ’
t)âˆ’r
(where
t
is
an
indeterminate).
By
taking
the
r-th
derivative
of
(1
âˆ’
t)âˆ’r
(and
dividing
by

2râˆ’1
r!),
we
obtain
that
this
coeï¬ƒcient
is
equal
to
â‰¤
22râˆ’1
â‰¤
4r
âˆ’
1.
Thus,
we
obtain
r
that
The
number
of
terms
in
the
double
summation
above
is
â‰¤
4r
âˆ’
1.
Next,
we
would
like
to
bound
the
C[r,
r
]â€™s
(where
r
<
r).
This
consists
of
two
parts,
i.e.,
bounding
the
binomial
coeï¬ƒcient
portion
of
C[r,
r
],
and
bounding
the
power
of
|qsc
|
appearing
in
C[r,
r
].
Let
us
begin
with
the
binomial
coeï¬ƒcient
portion,
i.e.,

k[r]
+
Î»r
r

of
C[r,
r
],
where
0
â‰¤
r
<
r
â‰¤
d
âˆ’
1.
First,
let
us
observe
that
k[r
âˆ’
1]
+
Î»r
is
either
0
or
r
âˆ’
1.
Now
one
may
check
easily
from
the
deï¬nitions
that
the
interval
of
integers
F
r+1
(KCrit
)
is
obtained
from
interval
of
integers
F
r
(KCrit
)
by
adjoining
one
more
integer
to
F
r
(KCrit
),
where
this
last
integer
lies
either
immediately
to
the
left
or
immediately
to
the
right
of
F
r
(KCrit
).
Moreover,
whether
this
last
integers
lies
to
the
left
or
to
the
right
depends
only
on
the
parity
of
r,
i.e.,
as
r
increases,
â€œleftâ€
and
â€œrightâ€
occur
alternately,
one
after
the
other.
Thus,
it
follows
that
k[r]
+
Î»r
is
either
âˆˆ
{âˆ’
21
(r
âˆ’
r
+
2),
.
.
.
,
âˆ’1}


r
|
is
â‰¤
a
product
of
or
âˆˆ
{r
,
.
.
.
,
r
âˆ’
1
+
12
(r
âˆ’
r
+
2)}.
But
this
implies
that
|
k[r]+Î»

r
291
1
2
(r
âˆ’
r
+
2)
â‰¤
2(r
âˆ’
r
)
positive
integers,
each
of
which
is
â‰¤
r
1
2
(r
+
r
)
â‰¤
r.
Thus,
we
obtain
that:
âˆ’
1
+
12
(r
âˆ’
r
+
2)
=

The
binomial
coeï¬ƒcient
portion
of
C[r,
r
]
is
â‰¤
r
2(râˆ’r
)
.
In
particular,
the
binomial
coeï¬ƒcient
portion
of
the
term
C[r,
r1
]
Â·
C[r1
,
r2
]
Â·
.
.
.
Â·
C[rjâˆ’1
,
rj
]
in
the
double
summation
above
is
â‰¤
r
2{(râˆ’r1
)+(r1
âˆ’r2
)+...+(rjâˆ’1
âˆ’rj
)}
â‰¤
r
2(râˆ’rj
)
.
Next,
we
would
like
to
bound
the
power
of
|qsc
|,
i.e.,

|qsc
|Î¨(k[r])âˆ’Î¨(k[r
])
appearing
in
C[r,
r
]
(where
0
â‰¤
r
<
r
â‰¤
d
âˆ’
1).
Since
|qsc
|
<
1,
this
means
that
we
would
like
to
bound
Î¨(k[r])âˆ’Î¨(k[r
])
from
below.
Note
that
we
always
have
Î¨(k[r])âˆ’Î¨(k[r
])
â‰¥
0.
In
the
following,
we
would
like
to
obtain
a
stronger
bound
from
below
under
the
assumption
that
r
â‰¥
r
+
6.
Lemma
3.1.
1
(r
+
r
)(r
âˆ’
r
).
Suppose
that
r
+
6
â‰¤
r.
Then
Î¨(k[r])
âˆ’
Î¨(k[r
])
â‰¥
16
Proof.
The
proof
consists
of
a
case
by
case
analysis,
depending
on
which
of
the
three
Cases
I,
II,
III
of
Chapter
V,
Schola
4.1,
the
character
Ï‡
belong
to.
We
begin
with
Case
I.
In
this
Case,
r
may
be
written
as
2k
or
2k
+
1
(where
k
â‰¥
0
is
an
integer).
Then
Î¨(k[r])
=
12
(k2
+
k)
(cf.
Chapter
V,
Schola
4.1).
Let
us
write
k
for
the
â€œkâ€
associated
to
r
.
Then
Î¨(k[r])
âˆ’
Î¨(k[r
])
=
râˆ’r
â‰¥
kâˆ’k
2(r
âˆ’
r
)
râˆ’r
8(r
âˆ’
r
)
Â·
(k
+
k
+
1)
â‰¥
Â·
r
+
r

2
=
râˆ’1âˆ’r
4(r
âˆ’
r
)
Â·
r
+
r

2
1
(r
+
r
)
16
as
desired.
Next,
we
consider
Case
II.
In
this
Case,
r
may
be
written
as
2k
or
2k
âˆ’
1
(where
k
â‰¥
0
is
an
integer).
Then
Î¨(k[r])
=
12
Â·
k
2
(cf.
Chapter
V,
Schola
4.1).
Let
us
write
k
for
the
â€œkâ€
associated
to
r
.
Then
292
Î¨(k[r])
âˆ’
Î¨(k[r
])
=
râˆ’r
â‰¥
kâˆ’k
2(r
âˆ’
r
)
râˆ’r
8(r
âˆ’
r
)
r
+
r

râˆ’1âˆ’r
Â·
4(r
âˆ’
r
)
2
r
+
r

1
Â·
=
(r
+
r
)
2
16
Â·
(k
+
k
)
â‰¥
as
desired.
Finally,
we
consider
Case
III.
In
this
Case,
r
may
be
written
as
2k
or
2k
âˆ’
1
(where
k
â‰¥
0
is
an
integer).
Then
Î¨(k[r])
is
â‰¥
12
(k2
âˆ’
k),
â‰¤
12
(k2
+
k)
(cf.
Chapter
V,
Schola
4.1).
Let
us
write
k
for
the
â€œkâ€
associated
to
r
.
Note
that
since
r
â‰¥
r
+
6,
we
have
r
âˆ’
r
âˆ’
3
â‰¥
12
Â·
(r
âˆ’
r
),
k
â‰¥
k
+
2.
Thus,
Î¨(k[r])
âˆ’
Î¨(k[r
])
â‰¥
râˆ’r
â‰¥

k
2
âˆ’
k
âˆ’
(k
)2
âˆ’
k

kâˆ’k
âˆ’1
Â·
â‰¥
2(r
âˆ’
r
)
kâˆ’k
âˆ’1
r
+
r

râˆ’r
1
Â·
=
(r
+
r
)
8(r
âˆ’
r
)
2
16
râˆ’r
âˆ’3
4(r
âˆ’
r
)
Â·
(k
+
k
)
as
desired.

Thus,
in
particular,
it
follows
that
The
power
of
|qsc
|
appearing
in
the
term
C[r,
r1
]Â·C[r1
,
r2
]Â·.
.
.Â·C[rjâˆ’1
,
rj
]
in
the
double
summation
above
is
={Î¨(k[r])
âˆ’
Î¨(k[r1
])}
+
{Î¨(k[r1
])
âˆ’
Î¨(k[r2
])}+
.
.
.
+
{Î¨(k[rjâˆ’1
])
âˆ’
Î¨(k[rj
])}
=Î¨(k[r])
âˆ’
Î¨(k[rj
])
1
which
is
â‰¥
0
always
and
â‰¥
16
(r
+
rj
)(r
âˆ’
rj
)
if
r
â‰¥
rj
+
6.
Lemma
3.2.
We
have
r
Â·
log(r)
âˆ’
2r
Â·

log2
(d)

d
â‰¤
12
Â·
d
for
any
integer
r
satisfying
0
â‰¤
r
â‰¤
d.
Proof.
Lemma
3.2
is
clear
if
r
=
0,
1,
2
(note
that
if
r
=
1,
2,
then
the
expression
in
brackets
{,
}
is
â‰¤
1),
or
if
r
=
d.
Thus,
we
may
assume
that
r
â‰¥
3
(so,
in
particular,
d
â‰¥
3).
Write
293
def
f
(r)
=
r
Â·
log(r)
âˆ’
2r
Â·

log2
(d)

d
Since
we
have
checked
that
f
(r)
â‰¤
12
Â·
d
for
r
=
2,
d,
it
suï¬ƒces
(by
elementary
calculus)
to
show
that
f
(Ï)
â‰¤
12
Â·
d
for
any
real
number
Ï
âˆˆ
[2,
d]
such
that
f
(Ï)
=
0.
For
such
a
Ï,
we
have
3
Â·
log(Ï)
â‰¥
log(Ï)
+
1
=
4Ï
Â·

log2
(d)

d
(where
we
use
that
Ï
â‰¥
2
implies
2
Â·
log(Ï)
â‰¥
log(4)
â‰¥
1)
hence
f
(Ï)
=
Ï
Â·
log(Ï)
âˆ’
1
1
Â·
(log(Ï)
+
1)
â‰¤
Â·
Ï
Â·
log(Ï)
2
2
Ï
3d
Next,
let
us
apply
the
function
log2
(âˆ’)
to
both
sides
of
the
inequality
4Â·log
2
(d)
â‰¥
log(Ï)
(â‰¥
1).
Since
both
sides
of
this
equality
are
â‰¥
1,
it
thus
follows
that
we
obtain
an
inequality
log2
(d)
â‰¥
log2
3d
4
Â·
log2
(d)
â‰¥
log2

1
Ï

â‰¥
Â·
log2
(Ï)
log(Ï)
16
1
Ï
â‰¥
Ï
4
(since
Ï
â‰¥
2)).
If
we
then
(where
we
use
that
log(d)
â‰¥
1
(since
d
â‰¥
3),
and
log(Ï)
Ï
1
3d
Â·
log2
(Ï)
by
4Â·log
multiply
the
inequality
log2
(d)
â‰¥
16
2
(d)
â‰¥
log(Ï)
,
we
thus
obtain
1
3
3d
Ï
1
Â·
d
â‰¥
log2
(d)
Â·
Â·
log2
(Ï)
Â·
=
Â·
Ï
Â·
log(Ï)
â‰¥
2
4
16
log(Ï)
16
4
Â·
log
(d)
i.e.,
f
(Ï)
â‰¤
Ï
Â·
log(Ï)
â‰¤
12
Â·
d,
as
desired.

Now
let
us
return
to
the
inequality
gr
â‰¤
1
+
r


C[r,
r1
]
Â·
C[r1
,
r2
]
Â·
.
.
.
Â·
C[rjâˆ’1
,
rj
]
j=1
r>r1
>r2
>...>rj
â‰¥0
Suppose
that
qsc
satisï¬es:
1
64
Â·
log2
(d)
âˆ’log|qsc
|
=
2Ï€
Â·
Â·
Im(Ï„or
)
â‰¥
d
d
Then
by
what
we
have
done
above
(cf.
especially
Lemmas
3.1,
3.2),
each
term
in
the
double
summation
satisï¬es:
294
1
Â·
(r
+
rj
)(r
âˆ’
rj
)
Â·
log|qsc
|
16
1
Â·
r
Â·
log|qsc
|)
â‰¤
2(r
âˆ’
rj
)
Â·
(log(r)
+
32
â‰¤
2(r
âˆ’
rj
)
Â·
(log(r)
âˆ’
2
Â·
r
Â·
dâˆ’1
Â·
log2
(d))
d
â‰¤
2(r
âˆ’
rj
)
Â·
12
Â·
â‰¤
24
Â·
d
r
log(C[r,
r1
]
Â·
C[r1
,
r2
]
Â·
.
.
.
Â·
C[rjâˆ’1
,
rj
])
â‰¤
2(r
âˆ’
rj
)
Â·
log(r)
+
when
r
â‰¥
rj
+
6
and
log(C[r,
r1
]
Â·
C[r1
,
r2
]
Â·
.
.
.
Â·
C[rjâˆ’1
,
rj
])
â‰¤
2(r
âˆ’
rj
)
Â·
log(r)
â‰¤
12
Â·
log(r)
â‰¤
12
Â·
log(d)
otherwise.
Thus,
since
(as
we
saw
above)
there
are
4r
âˆ’
1
such
terms
in
the
above
double
summation,
(if
we
add
in
the
additional
â€œ1+â€
at
the
beginning,
so
that
we
get
a
total
of
4r
terms,
then)
it
follows
that
gr
â‰¤
4r
Â·
e24Â·d
â‰¤
e26Â·d
Now
we
are
ready
to
state
the
main
result
of
the
present
Â§:
Theorem
3.3.
Suppose
that
Im(Ï„or
)
â‰¥
def
dâˆ’1
r=0
and
let
Z
=
Then
32
Â·
log2
(d)
Ï€
Î³r
Â·
ZrCG
be
a
C-linear
combination
(i.e.,
the
Î³r
âˆˆ
C)
of
the
ZrCG
.
(1)
If
the
|Î³r
|
â‰¤
1
for
r
=
0,
.
.
.
,
d
âˆ’
1,
then
the
L2
((S1
)sc
)-norm
of
Z
satisï¬es:
||Z||
â‰¤
d2
Â·
ed
â‰¤
e3d
.
(2)
If
||Z||
â‰¤
1,
then
the
|Î³r
|
â‰¤
e26Â·d
,
for
r
=
0,
.
.
.
,
d
âˆ’
1.
In
particular,
if
we
orthonormalize
the
ZrCG
to
form
OC
Z0OC
,
.
.
.
,
Zdâˆ’1
295
â€“
which
are
unique
if
we
stipulate
that
the
leading
coeï¬ƒcient
of
ZrOC
(i.e.,
the
coeï¬ƒcient
of
ZrCG
in
the
linear
combination
of
Z0CG
,
.
.
.
,
ZrCG
that
forms
ZrOC
)
be
positive
â€“
then
the
have
absolute
value
â‰¤
e26d
,
and
the
absolute
values
of
coeï¬ƒcients
of
the
ZrCG
in
each
ZrOC

âˆ’2
âˆ’d
the
leading
coeï¬ƒcients
are
â‰¥
d
Â·
e
â‰¥
eâˆ’3d
.
Proof.
The
assertion
concerning
the
ZrOC
at
the
end
of
Theorem
3.3
follows
formally
from
Assertions
(1)
and
(2)
(cf.
the
proof
of
Theorem
2.3).
Assertion
(2)
is
precisely
what
we
have
just
proven
in
the
above
discussion.
Thus,
it
remains
to
verify
Assertion
(1).
As
we
k[r]
saw
above,
the
absolute
value
of
the
coeï¬ƒcient
of
Usc
(for
k[r]
âˆˆ
KCrit
)
in
Z
is


!
r
r
!

!

!

k[r]
+
Î»j
!
!
k[r]
+
Î»j
!
!
Î¨(k[r])âˆ’Î¨(k[j])
Î³j
Â·
Â·
Ï‡(k[r]et
)
!
â‰¤
Â·
qsc
!
!
!
j
j
j=0
j=0


r
j
|
â‰¤
d
Â·
ed
,
Thus,
since
the
cardinality
of
KCrit
is
d,
it
suï¬ƒces
to
show
that
j=0
|
k[r]+Î»
j
for
all
k[r]
âˆˆ
KCrit
.
Moreover,
this
last
inequality
will
follow
as
soon
as
we
show
that
!
k[r]
+
Î»

!
!
!
j
!
â‰¤
2
d
â‰¤
ed
!
j
But
this
follows
from
the
analysis
of
the
â€œbinomial
coeï¬ƒcient
portion
of
C[r,
r
]â€
in
the
discussion
above:
Indeed,
this
analysis
shows
that
there
exists
an
integer
N
satisfying
j
â‰¤
N
â‰¤
j
âˆ’
1
+
12
(r
âˆ’
j
+
2)
â‰¤
r
such
that
!
k[r]
+
Î»

!
N

!
!
j
â‰¤
2
N
â‰¤
2
r
â‰¤
er
â‰¤
ed
!
!=
j
j
as
desired.

Remark.
Thus,
stated
in
words,
Theorem
3.3
asserts
that:
2
d
If
Im(Ï„or
)
â‰¥
32
Ï€
Â·
log
(d),
then
up
to
a
factor
of
order
C
(for
some
constant
C),
the
L2
((S1
)sc
)-norm
on
the
complex
vector
space
generCG
ated
by
Z0CG
,
.
.
.
,
Zdâˆ’1
,
is
the
same
as
the
norm
for
which
the
functions
CG
CG
Z0
,
.
.
.
,
Zdâˆ’1
are
orthonormal.
Note
that
unlike
the
case
with
Theorem
2.3,
in
the
present
situation,
one
does
not
have
the
stronger
result
that
the
discrepancy
is
of
order
C
r
on
the
subspace
generated
by
Z0CG
,
.
.
.
,
ZrCG
.
Indeed,
typically
results
such
as
Theorem
3.3,
(2),
(i.e.,
where
one
must
show
that
the
coeï¬ƒcients
are
bounded
whenever
the
L2
((S1
)sc
)-norm
is
bounded)
are
much
more
diï¬ƒcult
than
results
such
as
Theorem
3.3,
(1)
(i.e.,
where
one
must
show
that
if
the
296
coeï¬ƒcients
are
bounded,
then
the
L2
((S1
)sc
)-norm
is
bounded).
But
it
is
not
diï¬ƒcult
to
check
that
even
in
this
easier
direction
(i.e.,
the
direction
of
Theorem
3.3,
(1))
the
binomial
coeï¬ƒcients
that
one
must
bound
do
not
satisfy
â‰¤
C
r
type
inequalities.
Â§4.
The
Combinatorics
of
the
Full
Binomial
Model
In
this
and
the
following
Â§â€™s,
we
discuss
what
we
call
the
(full)
binomial
model.
This
â€œfullâ€
binomial
model
is
a
deformation
of
the
truncated
binomial
model
studied
in
Â§3
(cf.
especially
Theorem
3.3)
in
essentially
the
same
way
as
the
â€œLegendre
modelâ€
studied
in
Â§2
(cf.
especially
Theorem
2.3)
is
a
deformation
of
(what
are
essentially)
the
discrete
Tchebycheï¬€
polynomials.
One
diï¬€erence,
however,
between
what
we
do
in
the
present
and
following
Â§â€™s
and
what
was
done
in
Â§3
is
that
here,
we
do
not
use
the
averaging
process
of
Â§1.
As
a
result,
there
are
two
types
of
deformation
term
that
occur.
The
ï¬rst
type
results
from
the
fact
that
we
do
not
use
the
averaging
process
of
Â§1.
This
type
will
be
dealt
with
in
the
discussion
of
the
semi-truncated
binomial
model
below,
and
is
the
more
diï¬ƒcult
to
handle
(of
the
two
types).
The
second
type
is
exactly
the
same
as
the
deformation
terms
that
occurred
in
â€œCase
(ii)â€
of
the
proof
of
Lemma
2.1,
and
may
be
handled
in
exactly
the
same
way
as
in
the
proof
of
Lemma
2.1.
Unfortunately,
since
our
estimates
of
the
ï¬rst
type
of
deformation
term
are
very
involved,
we
treat
the
combinatorial
aspects
of
these
estimates
in
the
present
Â§.
In
the
following
Â§,
we
apply
the
results
of
the
present
Â§
to
study
the
orthogonal
system
which
constitutes
the
â€œfull
binomial
model.â€
We
maintain
the
notation
of
Â§3.
Also,
for
simplicity,
we
assume
in
the
following
discussion
that
d
â‰¥
12
Let
us
write
KSemi
=
{k
âˆˆ
Z
|
âˆƒ
k0
âˆˆ
KCrit
s.t.
|k
âˆ’
k0
|
=
d,
|k0
+
(iÏ‡
/n)|
â‰¥
def
Thus,
KSemi

d
,
k
Â·
k0
<
0}
4
/
KSemi
.
In
general,
for
k
âˆˆ
Z,
let
us
write
KCrit
=
âˆ…,
0
âˆˆ
Crit(k)
for
the
(unique)
k0
âˆˆ
KCrit
such
that
k
â‰¡
k0
modulo
d.
Also,
let
us
write
def
{k[d]}
=
{0
âˆ’
Î»d+1
,
1
âˆ’
Î»d+1
,
.
.
.
,
d
âˆ’
Î»d+1
}\KCrit
;
297
def
F
d+1
(KCrit
)
=
{k[d]}

KCrit
In
the
following
discussion,
if
F
is
a
ï¬nite
subset
of
R,
and
Î»
âˆˆ
R,
then
we
shall
write
def
Dist(Î»,
F
)
=
Minf
âˆˆF
{|Î»
âˆ’
f
|}
for
the
â€œdistanceâ€
between
Î»
and
F
.
Finally,
we
shall
write
def
Î¨(Î»)
=
Î¨(Î»)
+
1
1
Â·
(iÏ‡
/n)2
=
Â·
(Î»
+
(iÏ‡
/n))2
2
2
for
Î»
âˆˆ
R.
Note
that
if
r1
â‰¤
r2
(where
r1
,
r2
are
nonnegative
integers
â‰¤
d),
then
Î¨(k[r1
])
â‰¤
Î¨(k[r2
]),
Î¨(k[r1
])
â‰¤
Î¨(k[r2
]).
We
would
like
to
begin
by
introducing
the
â€œsemi-truncated
versionâ€
of
the
Î¶rCG
,
i.e.,
a
function
which
is
a
sort
of
intermediate
step
between
Î¶rCG
and
ZrCG
:
def
âˆ’Î¨(k[r])
ZCG
=
qsc
Â·
r


kâˆˆKCrit
âˆ’Î¨(k[r])
=
ZrCG
+
qsc
Â·
KSemi

kâˆˆKSemi
k
+
Î»r
r

Î¨(k)
Crit(k)
Â·
qsc
Â·
Usc
Â·
Ï‡(ket
)


k
+
Î»r
Î¨(k)
Crit(k)
Â·
Usc
Â·
Ï‡(ket
)
Â·
qsc
r
The
key
to
understanding
ZCG
is
the
following
analysis
of
the
combinatorics
of
the
sets
r
KCrit
,
KSemi
:
Lemma
4.1.
If
A,
B
âˆˆ
R,
let
us
write
[A,
B]Int
for
the
set
of
integers
in
the
closed
interval
[A,
B]
âŠ†
R.
Let
r
âˆˆ
[2,
d]Int
.
Then

âˆ’

r
r
(r
âˆ’
2)
(r
âˆ’
2)

,
âŠ†
F
r
(KCrit
)
=
[âˆ’Î»r
,
r
âˆ’
1
âˆ’
Î»r
]Int
âŠ†
âˆ’
,
2
2
2
2
Int
Int
In
particular,
for
any
k0
âˆˆ
F
r
(KCrit
),
we
have
|k0
|
â‰¤
r2
,
and
2r
â‰¥
|k[r
âˆ’
1]|
â‰¥
râˆ’2
2
.
Finally,
the
average
(or
â€œcenter
of
massâ€)
Avg(F
r
(KCrit
))
of
the
elements
of
F
r
(KCrit
)
is
1
1
2
(r
âˆ’
1)
âˆ’
Î»r
âˆˆ
{0,
Â±
2
}.
Proof.
Indeed,
the
number
Î»r
of
Chapter
V,
Theorem
4.8,
satisï¬es
r2
â‰¥
Î»r
â‰¥
râˆ’2
2
â‰¥
0
r
r
r
r
(since
r
â‰¥
2).
Thus,
F
(KCrit
)
=
[âˆ’Î»r
,
r
âˆ’
1
âˆ’
Î»r
]Int
âŠ†
[âˆ’
2
,
2
];
F
(KCrit
)
=
[âˆ’Î»r
,
r
âˆ’
1
âˆ’
râˆ’2
Î»r
]Int
âŠ‡
[âˆ’
râˆ’2
2
,
2
].
Since
k[r
âˆ’
1]
âˆˆ
{âˆ’Î»r
,
r
âˆ’
1
âˆ’
Î»r
},
it
thus
follows
that
|k[r
âˆ’
1]|
â‰¥
râˆ’2
râˆ’2
Min(Î»r
,
r
âˆ’
1
âˆ’
Î»r
)
â‰¥
Min(
râˆ’2
2
,
2
)
=
2
.
Finally,
the
statement
concerning
the
average
follows
immediately.

298
Lemma
4.2.
Suppose
that
k
âˆˆ
Z\(KCrit
KSemi
).
Then
|k
+
(iÏ‡
/n)|
â‰¥
34
d;
|k|
â‰¥
12
d.
1
Â·
d
Â·
|k|.
Moreover,
we
have
Î¨(k)
âˆ’
Î¨(k[d
âˆ’
1])
â‰¥
16
def
Proof.
Write
k0
=
Crit(k).
Since
k
âˆˆ
/
KSemi
,
âˆˆ
/
KCrit
,
it
follows
from
the
deï¬nitions
that
at
least
one
of
the
following
holds:
|k
âˆ’
k0
|
â‰¥
2d,
or
|k0
+
(iÏ‡
/n)|
<
d4
,
or
k
Â·
k0
â‰¥
0.
Suppose
that
|k
âˆ’
k0
|
â‰¥
2d.
By
Lemma
4.1
above,
we
have
|k0
|
â‰¤
d2
.
Thus,
it
follows
that
|k
+
(iÏ‡
/n)|
â‰¥
2d
âˆ’
|k0
|
âˆ’
12
â‰¥
2d
âˆ’
12
d
âˆ’
12
=
32
d
âˆ’
12
â‰¥
34
d
(since
d
â‰¥
1),
as
desired.
Next,
let
us
assume
that
|k0
+
(iÏ‡
/n)|
<
d4
.
Write
k
=
k0
+
A
Â·
d,
where
A
âˆˆ
Z,
A
=
0.
Then
|k
+
(iÏ‡
/n)|
â‰¥
|A|
Â·
d
âˆ’
|k0
+
(iÏ‡
/n)|
â‰¥
d
âˆ’
14
d
=
34
d,
as
desired.
Finally,
let
us
assume
that
k
Â·
k0
â‰¥
0.
Write
k
=
k0
+
A
Â·
d,
where
A
âˆˆ
Z,
A
=
0.
Then
since
|k0
|
â‰¤
d2
â‰¤
d
âˆ’
1
(by
Lemma
4.1,
d
â‰¥
2),
it
follows
that
|A|
Â·
d
â‰¥
d
>
|k0
|.
Thus,
k
Â·
k0
â‰¥
0
implies
that
A
Â·
k0
Â·
d
â‰¥
âˆ’k02
,
hence
that
A
Â·
k0
â‰¥
0.
In
particular,
|k
+
(iÏ‡
/n)|
â‰¥
|A
Â·
d
+
k0
|
âˆ’
12
â‰¥
|A|
Â·
d
âˆ’
12
â‰¥
d
âˆ’
12
â‰¥
34
d
(since
d
â‰¥
2),
as
desired.
This
completes
the
proof
of
the
assertion
|k
+
(iÏ‡
/n)|
â‰¥
34
d.
This
implies
that
|k|
â‰¥
|k
+
(iÏ‡
/n)|
âˆ’
12
â‰¥
34
d
âˆ’
12
â‰¥
12
d
(since
d
â‰¥
2).
Now
we
compute
(using
this
assertion,
together
with
the
estimates
of
Lemma
4.1):
2(Î¨(k)
âˆ’
Î¨(k[d
âˆ’
1]))
=
2(Î¨(k)
âˆ’
Î¨(k[d
âˆ’
1]))
=
(k
+
(iÏ‡
/n))2
âˆ’
(k[d
âˆ’
1]
+
(iÏ‡
/n))2
=
{|k
+
(iÏ‡
/n)|
+
|k[d
âˆ’
1]
+
(iÏ‡
/n)|}
Â·
{|k
+
(iÏ‡
/n)|
âˆ’
|k[d
âˆ’
1]
+
(iÏ‡
/n)|}
3
1
â‰¥
d
Â·
(|k
+
(iÏ‡
/n)|
âˆ’
âˆ’
|k[d
âˆ’
1]|)
4
2
1
1
3
â‰¥
d
Â·
(|k
+
(iÏ‡
/n)|
âˆ’
(d
+
2)
+
)
4
2
2
5
1
3
1
3
1
â‰¥
d
Â·
(|k
+
(iÏ‡
/n)|
âˆ’
d
+
)
â‰¥
d
Â·
(
|k
+
(iÏ‡
/n)|
+
)
4
8
2
4
6
2
1
1
1
1
â‰¥
d
Â·
(|k
+
(iÏ‡
/n)|
+
3)
â‰¥
d
Â·
(|k|
âˆ’
+
3)
â‰¥
Â·
d
Â·
|k|
8
8
2
8
(where
we
use
d
â‰¥
8),
as
desired.

Lemma
4.3.
Let
k
âˆˆ
KSemi
.
Suppose
that
there
exists
some
k[r]
âˆˆ
KCrit
(where
r
âˆˆ
[0,
dâˆ’1]Int
)
such
that
Î¨(k)
=
Î¨(k[r]).
Then
r
=
dâˆ’1,
k
=
k[d],
and
the
character
Ï‡
belongs
(in
the
language
of
Chapter
V,
Â§4)
to
Cases
I
or
II.
Moreover,
under
these
hypotheses,
Crit(k)
=
k[d
âˆ’
1],
and
(for
any
r
<
d
âˆ’
1)
we
have
Î¨(k[r
])
<
Î¨(k[r])
=
Î¨(k[d
âˆ’
1]).
We
shall
refer
to
such
k
as
exceptional.
Proof.
Indeed,
this
follows
from
the
discussion
of
Chapter
V,
Schola
4.1.
More
precisely,
if
Ï‡
belongs
to
Case
III,
then
Î¨
is
injective
on
Z.
Thus,
Ï‡
must
belong
to
Cases
I
or
II.
299
It
follows
from
the
discussion
of
Chapter
V,
Schola
4.1,
that
the
map
r
â†’
Î¨(k[r
])
(for
r
=
0,
.
.
.
,
d)
is
monotone
increasing
even
in
Cases
I
or
II,
and
that
the
ï¬bers
of
the
map
/
KCrit
,
it
follows
k
â†’
Î¨(k
)
(for
k
âˆˆ
Z)
contain
at
most
two
elements.
Moreover,
since
k
âˆˆ
that
Î¨(k[d])
â‰¤
Î¨(k).
Now
I
claim
that
Î¨(k[d
âˆ’
1])
=
Î¨(k[d]).
Indeed,
if
Î¨(k[d
âˆ’
1])
<
Î¨(k[d]),
then
it
follows
that
Î¨(k[r])
â‰¤
Î¨(k[d
âˆ’
1])
<
Î¨(k[d])
â‰¤
Î¨(k)
(which
contradicts
the
hypothesis
Î¨(k[r])
=
Î¨(k)).
This
proves
the
claim.
Thus,
since
the
ï¬bers
of
the
map
r
â†’
Î¨(k[r
])
(for
r
=
0,
.
.
.
,
d)
contain
at
most
two
elements,
it
follows
that
for
r
=
0,
.
.
.
,
d
âˆ’
2,
we
have
Î¨(k[r
])
<
Î¨(k[d
âˆ’
1])
=
Î¨(k[d])
â‰¤
Î¨(k).
Thus,
we
conclude
that
r
=
d
âˆ’
1.
If
k[d]
=
k,
then
the
fact
that
the
ï¬bers
of
the
map
k
â†’
Î¨(k
)
(for
k
âˆˆ
Z)
contain
at
most
two
elements
implies
that
Î¨(k[r])
=
Î¨(k[dâˆ’1])
=
Î¨(k[d])
<
Î¨(k),
which
is
absurd.
Thus,
we
conclude
that
k[d]
=
k.
Thus,
it
remains
to
prove
that
Crit(k)
=
k[d
âˆ’
1].
But
this
follows
from
the
explicit
analysis
of
Chapter
V,
Schola
4.1.
Indeed,
in
Case
I,
since
Î¨(k[d
âˆ’
1])
=
Î¨(k[d]),
it
follows
that
d
is
odd,
and
that
|k[d]
âˆ’
k[d
âˆ’
1]|
=
2
Â·
{
21
(d
âˆ’
1)}
+
1
=
d.
Similarly,
in
Case
II,
since
k[d
âˆ’
1]
=
k[d],
it
follows
that
d
is
even,
and
that
|k[d]|
=
|k[d
âˆ’
1]|
=
12
d,
so
|k[d]
âˆ’
k[d
âˆ’
1]|
=
d,
as
desired.
This
completes
the
proof.

def
Lemma
4.4.
Suppose
that
k
is
exceptional
(cf.
Lemma
4.3).
Write
k0
=
Crit(k).
k0
in
ZCG
Then
the
coeï¬ƒcient
of
Usc
dâˆ’1
is
a
complex
number
whose
absolute
value
is
â‰¤
2
and
Ï€
â‰¥
2m
=
Ï€n
.
Proof.
Recall
the
original
nontruncated
series
def
Î¶rCG
=



k
+
Î»r

Lr
(Î´
âˆ—
)
CG
Î¨(k
)
2mk
+iÏ‡
Â·
Ucv
Â·
Ï‡((k
)et
)
(Î¶0
)
=
Â·
qsc
r
r

k
âˆˆZ
Now
I
claim
that
as
k
ranges
over
k0
+dÂ·Z,
the
only
k
(other
than
k0
=
k[dâˆ’1])
for
which
Î¨(k
)
=
Î¨(k0
)
is
the
current
exceptional
k
under
consideration.
Indeed,
if
k
âˆˆ
KCrit
,
this
follows
from
Lemma
4.3.
If
k
âˆˆ
KSemi
,
then
by
Lemma
4.3,
k
=
k[d]
=
k.
Finally,
if
/
KCrit
,
âˆˆ
/
KSemi
,
then
by
Lemma
4.2,
Î¨(k
)
>
Î¨(k[d
âˆ’
1])
=
Î¨(k0
).
This
completes
k
âˆˆ
the
proof
of
the
claim.
Next,
recall
from
Lemma
4.3
that
Î¨(k[d
âˆ’
1])
>
Î¨(k[r])
for
r
<
d
âˆ’
1.
It
thus
follows
âˆ’Î¨(k[r])
Â·
Î¶rCG
(for
r
=
0,
.
.
.
,
d
âˆ’
1)
to
Î¼d
âŠ†
(S1
)sc
,
and
let
qsc
â†’
0,
that
if
we
restrict
the
qsc
2mk
+i
then
the
coeï¬ƒcient
of
Ucv
0
Ï‡
will
be
0
for
r
<
d
âˆ’
1,
and
it
will
be
equal
(by
the
claim
of
the
preceding
paragraph)
to

k
=k0
,k

k
+
Î»dâˆ’1
dâˆ’1
300

Â·
Ï‡((k
)et
)


dâˆ’1

=
Â±1.
for
r
=
d
âˆ’
1.
Note
that
for
k
=
k0
,
k,
we
have
k
+
Î»dâˆ’1
âˆˆ
{âˆ’1,
d
âˆ’
1},
so
k
+Î»
dâˆ’1
Thus,
the
coeï¬ƒcient
in
question
will
be
a
sum
of
two
n-th
roots
of
unity.
This
shows
that
this
coeï¬ƒcient
has
absolute
value
â‰¤
2.
It
also
shows
that
if
this
coeï¬ƒcient
is
nonzero,
then
Ï€
(where
the
inequality
may
be
proven
it
has
absolute
value
â‰¥
sin(2Ï€/n)
=
sin(Ï€/m)
â‰¥
2m
by
elementary
calculus,
using
the
fact
that
m
â‰¥
2).
Moreover,
it
follows
immediately
from
the
deï¬nitions
that
this
coeï¬ƒcient
is
the
coeï¬ƒcient
referred
to
in
the
statement
of
Lemma
4.4.
Thus,
it
suï¬ƒces
to
show
that
this
coeï¬ƒcient
is
nonzero.
But
since
the
corresponding
âˆ’Î¨(k[r])
Â·
Î¶rCG
are
0
for
r
<
d
âˆ’
1,
to
say
that
the
present
coeï¬ƒcient
in
coeï¬ƒcients
in
qsc
question
is
zero
would
imply
that
the
comparison
isomorphism
(Chapter
VI,
Theorem
4.1
â€“
in
fact,
we
only
need
it
in
characteristic
zero,
i.e.,
Chapter
VI,
Theorem
3.1)
is
false.
This
contradiction
completes
the
proof
of
Lemma
4.4.

Remark.
The
proof
of
Lemma
4.4
is
interesting
because
it
may
be
turned
around
and
regarded
as
an
explicit
way
to
verify
the
comparison
theorem
(Chapter
VI,
Theorem
4.1)
in
a
neighborhood
of
inï¬nity.
That
is
to
say,
the
fact
that
the
coeï¬ƒcient
in
question
is
nonzero
may
also
be
proven
by
a
direct
computation
(which
is
not
diï¬ƒcult,
and
is
left
as
an
exercise
for
the
reader).
This
direct
computation
may
then
be
regarded
as
an
alternate
proof
of
Chapter
VI,
Theorem
4.1,
in
a
neighborhood
of
inï¬nity.
Put
another
way,
this
portion
of
the
treatment
of
the
archimedean
theory
in
the
present
Chapter
may
be
regarded
as
the
archimedean
analogue
of
the
description
of
the
scheme-theoretic
zero
locus
of
the
determinant
given
in
Chapter
VI,
Theorem
4.1,
(2).
Lemma
4.5.
Let
k
âˆˆ
KSemi
.
Then
|k|
â‰¥
12
d.
def
Proof.
Write
k0
=
Crit(k).
Since
|k
âˆ’
k0
|
=
d,
we
have
|k|
â‰¥
d
âˆ’
|k0
|
â‰¥
d
âˆ’
12
d
=
12
d
(by
Lemma
4.1).

Lemma
4.6.
Let
X,
A,
and
B
be
nonnegative
real
numbers
such
that
B
â‰¥
A,
B
>
0.
Then
(X
+
A)
â‰¥
(A/B)
Â·
(X
+
B).
Proof.
Indeed,
B(X
+
A)
â‰¥
B
Â·
X
+
A
Â·
B
â‰¥
A
Â·
X
+
A
Â·
B
=
A(X
+
B).

Lemma
4.7.
Let
k
âˆˆ
KSemi
.
Write
k0
=
k[r0
]
=
Crit(k).
Let
r
be
an
integer
satisfying
4
â‰¤
r
â‰¤
d
âˆ’
1.
Then
Î¨(k)
âˆ’
Î¨(k[r])
â‰¥
1
Â·
d
Â·
Dist(k,
F
r
(KCrit
))
32n
so
long
as
either
k
is
non-exceptional
(cf.
Lemma
4.3)
or
r
<
d
âˆ’
1.
301
def
def
Proof.
Write
Ïƒk
=
k/|k|
(note
that
|k|
â‰¥
1
>
0,
by
Lemma
4.5),
k[r]âˆ—
=
âˆ’(iÏ‡
/n)
+
Ïƒk
Â·
1
âˆ—
|k[r]
+
(iÏ‡
/n)|.
By
Lemma
4.1,
|k[r]|
â‰¥
r+1
2
âˆ’
1
â‰¥
1
+
2
.
It
thus
follows
that
k[r]
has
the
râˆ’3
same
sign
as
k,
and
that
|k[r]âˆ—
|
â‰¥
r+1
2
âˆ’1âˆ’1=
2
.
Write
R
Â·
F
r
(KCrit
)
for
the
closed
convex
hull
(in
R)
of
the
points
in
F
r
(KCrit
).
Note
that
k
âˆˆ
/
F
r
(KCrit
),
so
k
âˆˆ
/
R
Â·
F
r
(KCrit
);
0
âˆˆ
R
Â·
F
r
(KCrit
)
(by
Lemma
4.1).
Observe
that
k
divides
the
real
line
into
two
open
rays.
Now
I
claim
that
k[r]âˆ—
lies
in
the
same
open
ray
as
R
Â·
F
r
(KCrit
).
Indeed,
if
this
were
not
the
case,
then
since
0
âˆˆ
R
Â·
F
r
(KCrit
),
it
would
then
follow
that
|k[r]âˆ—
|
â‰¥
|k|
â‰¥
1.
Since
k[r]âˆ—
and
k
have
the
same
sign,
it
thus
follows
that
|k[r]âˆ—
+
(iÏ‡
/n)|
âˆ’
|k[r]âˆ—
|
=
|k
+
(iÏ‡
/n)|
âˆ’
|k|,
hence
that
|k[r]âˆ—
+
(iÏ‡
/n)|
â‰¥
|k
+
(iÏ‡
/n)|.
But
this
implies
that
2
Â·
Î¨(k[r])
=
(k[r]
+
(iÏ‡
/n))2
=
(k[r]âˆ—
+
(iÏ‡
/n))2
â‰¥
(k
+
(iÏ‡
/n))2
=
2
Â·
Î¨(k)
i.e.,
that
Î¨(k[r])
â‰¥
Î¨(k).
On
the
other
hand,
since
k[r]
âˆˆ
KCrit
,
k
âˆˆ
/
KCrit
,
we
have
Î¨(k[r])
â‰¤
Î¨(k).
Thus,
we
conclude
that
Î¨(k[r])
=
Î¨(k),
so
k
is
exceptional
and
r
=
d
âˆ’
1,
contrary
to
the
hypotheses
of
Lemma
4.7.
This
completes
the
proof
of
the
claim.
Thus,
k[r]âˆ—
=
k
lies
to
the
same
side
of
k
as
R
Â·
F
r
(KCrit
).
Next,
let
us
prove
the
inequality
|k
âˆ’
k[r]âˆ—
|
â‰¥
1
Â·
Dist(k,
F
r
(KCrit
))
4n
Indeed,
if
|k
âˆ’
k[r]âˆ—
|
â‰¥
Dist(k,
F
r
(KCrit
)),
then
this
inequality
follows
immediately,
so
we
may
assume
that
|k
âˆ’
k[r]âˆ—
|
<
Dist(k,
F
r
(KCrit
)),
i.e.,
that
k[r]âˆ—
lies
between
k
and
R
Â·
F
r
(KCrit
).
Since
k
=
k[r]âˆ—
and
n
Â·
k,
n
Â·
k[r]âˆ—
âˆˆ
Z,
it
follows
that
|k
âˆ’
k[r]âˆ—
|
â‰¥
n1
.
On
the
other
hand,
Dist(k[r]âˆ—
,
F
r
(KCrit
))
=
|k[r]âˆ—
âˆ’
k[r
]|
for
some
r
âˆˆ
{r
âˆ’
2,
r
âˆ’
1}
(i.e.,
k[r
]
is
the
closest
element
âˆˆ
F
r
(KCrit
)
to
k[r]âˆ—
).
Moreover,
by
Lemma
4.1,
we
have
r+1
râˆ’3
r
râˆ’3
âˆ—
2
+
1
â‰¥
|k[r]
|
â‰¥
2
;
2
â‰¥
|k[r
âˆ’
1]|,
|k[r
âˆ’
2]|
â‰¥
2
>
0.
Thus,
in
particular,
it
follows
that
k[r
]
and
k[r]âˆ—
have
the
same
sign,
so
we
obtain
Dist(k[r]âˆ—
,
F
r
(KCrit
))
=
|k[r]âˆ—
âˆ’
k[r
]|
1

1
1
1
â‰¤
Max
(r
+
3)
âˆ’
(r
âˆ’
3),
r
âˆ’
(r
âˆ’
3)
=
3
2
2
2
2
Thus,
by
Lemma
4.6
(where
we
take
the
quantity
â€œX
+
Aâ€
(respectively,
â€œX
+
Bâ€)
of
Lemma
4.6
to
be
|k
âˆ’
k[r]âˆ—
|
(respectively,
Dist(k,
F
r
(KCrit
)))),
we
have
|k
âˆ’
k[r]âˆ—
|
â‰¥
âˆ’1
1
1
1
Â·
+3
Â·
Dist(k,
F
r
(KCrit
))
Â·
Dist(k,
F
r
(KCrit
))
â‰¥
n
n
4n
302
1
This
completes
the
proof
of
the
inequality
|k
âˆ’
k[r]âˆ—
|
â‰¥
4n
Â·
Dist(k,
F
r
(KCrit
)).
Now
we
are
ready
to
complete
the
proof
of
Lemma
4.7.
Note
that
since
either
k
is
non-exceptional
or
r
<
d
âˆ’
1,
we
have
Î¨(k)
>
Î¨(k[r])
(cf.
Lemma
4.3).
Also,
by
the
deï¬nition
of
k[r]âˆ—
,
it
follows
that
k[r]âˆ—
+
(iÏ‡
/n)
and
k
+
(iÏ‡
/n)
have
the
same
sign.
Thus,
we
compute
(using
the
inequality
of
the
preceding
paragraph,
together
with
Lemma
4.5):
2(Î¨(k)
âˆ’
Î¨(k[r]))
=
2(Î¨(k)
âˆ’
Î¨(k[r]))
=
2(Î¨(k)
âˆ’
Î¨(k[r]âˆ—
))
=
(k
+
(iÏ‡
/n))2
âˆ’
(k[r]âˆ—
+
(iÏ‡
/n))2
=
(|k
+
(iÏ‡
/n)|
+
|k[r]âˆ—
+
(iÏ‡
/n)|)
Â·
(|k
+
(iÏ‡
/n)|
âˆ’
|k[r]âˆ—
+
(iÏ‡
/n)|)
â‰¥
|k
+
(iÏ‡
/n)|
Â·
|k
+
(iÏ‡
/n)
âˆ’
k[r]âˆ—
âˆ’
(iÏ‡
/n)|
1
1
â‰¥
(
d
âˆ’
)
Â·
|k
âˆ’
k[r]âˆ—
|
2
2
1
1
1
Â·
Dist(k,
F
r
(KCrit
))
=
Â·
d
Â·
Dist(k,
F
r
(KCrit
))
â‰¥
(
d)
Â·
4
4n
16n
(where
we
use
that
d
â‰¥
2)
as
desired.

Finally,
we
need
one
more
lemma
in
the
style
of
Lemma
4.7,
which
is
a
sort
of
analogue
(in
the
present
context)
of
Lemma
3.1
of
Â§3:
Lemma
4.8.
Let
r
>
r
be
nonnegative
integers
â‰¤
d
âˆ’
1
such
that
|k[r]
+
(iÏ‡
/n)|,
|k[r
]
+
(iÏ‡
/n)|
â‰¥
d
4

1
Â·
d
Â·
Dist(k[r],
F
r
(KCrit
)).
and
Î¨(k[r])
=
Î¨(k[r
]).
Then
Î¨(k[r])
âˆ’
Î¨(k[r
])
â‰¥
32n
def
def
def
Proof.
Write
k
=
k[r],
k
=
k[r
],
Ïƒk
=
k/|k|
(note
that
|k|
â‰¥
|k
+
(iÏ‡
/n)|
âˆ’
12
â‰¥
d4
âˆ’
12
â‰¥
def
1
>
0,
since
d
â‰¥
6),
(k
)âˆ—
=
âˆ’(iÏ‡
/n)
+
Ïƒk
Â·
|k
+
(iÏ‡
/n)|.
Since
|k
+
(iÏ‡
/n)|,
|k
+
(iÏ‡
/n)|
â‰¥
d
âˆ—
âˆ—
4
>
1,
it
follows
that
k,
(k
)
,
k
+
(iÏ‡
/n),
and
(k
)
+
(iÏ‡
/n)
have
the
same
sign.
Thus,
|k
+(iÏ‡
/n)|âˆ’|(k
)âˆ—
+(iÏ‡
/n)|
=
Ïƒk
(k
+(iÏ‡
/n)âˆ’(k
)âˆ—
âˆ’(iÏ‡
/n))
=
Ïƒk
(k
âˆ’(k
)âˆ—
)
=
|k|âˆ’|(k
)âˆ—
|
On
the
other
hand,
since
Î¨(k)
>
Î¨(k
)
=
Î¨((k
)âˆ—
),
it
follows
that
this
diï¬€erence
of
absolute
values
is
>
0,
hence
that
|k|
>
|(k
)âˆ—
|
303
Next,
observe
that
Î»1
=
0
(cf.
Chapter
V,
Theorem
4.8).
Thus,
k[0]
=
0,
hence
r,
r
â‰¥
1

(since
|k|,
|k
|
â‰¥
d4
âˆ’
12
â‰¥
1).
In
particular,
0
âˆˆ
F
1
(KCrit
)
âŠ†
F
r
(KCrit
).
On
the
other


hand,
since
r
>
r
,
k
=
k[r]
âˆˆ
/
F
r
(KCrit
).
Thus,
we
conclude
that
(k
)âˆ—
and
F
r
(KCrit
)
lie
to
the
same
side
of
k
(i.e.,
in
the
same
connected
component
of
R\{k}).


Note
that
the
fact
that
0
âˆˆ
F
r
(KCrit
)
also
implies
that
F
r
(KCrit
)
is
nonempty.
Let
us


write
k[r
]
for
the
unique
element
of
F
r
(KCrit
)
such
that
|k
âˆ’
k[r
]|
=
Dist(k,
F
r
(KCrit
)).
Then
r
âˆˆ
{r
âˆ’
1,
r
âˆ’
2}.
Thus,
by
Lemma
4.1
(plus
the
fact
that
k[0]
=
0),
we
have:
r
âˆ’1
r
+1
â‰¥
|k[r
]|
â‰¥
2
2
On
the
other
hand,
again
by
Lemma
4.1,
we
have
r
âˆ’1
r
+1
â‰¥
|k
|
=
|k[r
]|
â‰¥
2
2
which
implies
that
r
âˆ’3
r
+3
â‰¥
|(k
)âˆ—
|
â‰¥
2
2
hence
(since
k[r
]
Â·
k
â‰¥
0,
(k
)âˆ—
Â·
k
>
0)
that
|(k
)âˆ—
âˆ’
k[r
]|
â‰¤
Max(
â‰¤
r
+1
r
âˆ’3
r
+3
r
âˆ’1
âˆ’
,
âˆ’
)
2
2
2
2
1
Â·
Max(r
âˆ’
r
+
4,
r
âˆ’
r
+
4)
â‰¤
3
2
Now
we
are
ready
to
prove
the
inequality:
|k
âˆ’
(k
)âˆ—
|
â‰¥

1
Â·
Dist(k,
F
r
(KCrit
))
4n

Indeed,
without
loss
of
generality,
we
may
assume
that
|k
âˆ’
(k
)âˆ—
|
<
Dist(k,
F
r
(KCrit
)),

i.e.,
that
(k
)âˆ—
lies
strictly
between
k
and
F
r
(KCrit
).
Since
k
=
(k
)âˆ—
and
n
Â·
k,
n
Â·
(k
)âˆ—
âˆˆ
Z,
it
follows
that
|k
âˆ’
(k
)âˆ—
|
â‰¥
n1
.
On
the
other
hand,
|(k
)âˆ—
âˆ’
k[r
]|
â‰¤
3,
so
by
Lemma
4.6,
we
have
|k
âˆ’
(k
)âˆ—
|
â‰¥

1
1
1
1
Â·
(
+
3)âˆ’1
Â·
|k
âˆ’
k[r
]|
â‰¥
Â·
|k
âˆ’
k[r
]|
=
Â·
Dist(k,
F
r
(KCrit
))
n
n
4n
4n
as
desired.
304
Thus,
just
as
in
Lemma
4.7,
we
have:
2(Î¨(k)
âˆ’
Î¨(k
))
=
2(Î¨(k)
âˆ’
Î¨(k
))
=
2(Î¨(k)
âˆ’
Î¨((k
)âˆ—
))
=
(k
+
(iÏ‡
/n))2
âˆ’
((k
)âˆ—
+
(iÏ‡
/n))2
=
(|k
+
(iÏ‡
/n)|
+
|(k
)âˆ—
+
(iÏ‡
/n)|)
Â·
(|k
+
(iÏ‡
/n)|
âˆ’
|(k
)âˆ—
+
(iÏ‡
/n)|)
â‰¥
(|k
+
(iÏ‡
/n)|)
Â·
|k
+
(iÏ‡
/n)
âˆ’
(k
)âˆ—
âˆ’
(iÏ‡
/n)|
1
â‰¥
d
Â·
|k
âˆ’
(k
)âˆ—
|
4


1
1
1
Â·
Dist(k,
F
r
(KCrit
))
=
Â·
d
Â·
Dist(k,
F
r
(KCrit
))
â‰¥
dÂ·
4
4n
16n
as
desired.

Â§5.
The
Full
Binomial
Model
In
this
Â§,
we
apply
the
estimates
of
the
preceding
Â§
to
study
the
orthogonal
system
which
constitutes
the
full
binomial
model.
We
maintain
the
notation
of
Â§4.
We
begin
by
considering
the
binomial
coeï¬ƒcients
that
appear
in
the
sum
deï¬ning
ZCG
r
.
def
Lemma
5.1.
Let
k
âˆˆ
Z,
r
âˆˆ
[0,
d
âˆ’
1]Int
(where
[0,
d
âˆ’
1]Int
=
[0,
d
âˆ’
1]
Lemma
4.1).
Then

Z
is
as
in
!k
+
Î»
!
Dist(k,
F
r
(K
))
+
r
âˆ’
1
!
r
!
Crit
!=
!
r
r
!
!
!
k+Î»r
!
In
particular,
log(!
r
!)
â‰¤
Dist(k,
F
r
(KCrit
))
Â·
log(|k|
+
d).
Proof.
First,
let
us
observe
that
in
general,
for
any
N
âˆˆ
Z,
we
have
the
identity
!N
!
Dist(N,
[0,
r
âˆ’
1]
)
+
r
âˆ’
1
!
!
Int
!
!=
r
r
Indeed,
thisis
clear
for
N
âˆˆ

[0,
r
âˆ’
1]Int
(since
both
sides
are
zero).
For
N
<
0,
one
checks
N
râˆ’1âˆ’N
,
Dist(N,
[0,
r
âˆ’1]Int
)
=
Dist(r
âˆ’1âˆ’N,
[0,
r
âˆ’1]Int
),
so
it
suï¬ƒces
easily
that
|
r
|
=
r
305
to
prove
the
identity
when
N
â‰¥
r.
But
for
N
â‰¥
r,
we
have
Dist(N,
[0,
râˆ’1]Int
)
=
N
âˆ’(râˆ’1),
so
the
identity
follows
immediately.
Applying
this
identity,
we
obtain
!k
+
Î»
!
Dist(k
+
Î»
,
[0,
r
âˆ’
1]
)
+
r
âˆ’
1
!
r
!
r
Int
!
!=
r
r




Dist(k,
F
r
(KCrit
))
+
r
âˆ’
1
Dist(k,
[0,
r
âˆ’
1]Int
âˆ’
Î»r
)
+
r
âˆ’
1
=
=
r
r
by
the
deï¬nition
of
F
r
(KCrit
).


r
Finally,
we
note
that
the
binomial
coeï¬ƒcient
Dist(k,F
(Kr
Crit
))+râˆ’1
may
be
bounded
by
the
product
of
Dist(k,
F
r
(KCrit
))
âˆ’
1
(â‰¤
Dist(k,
F
r
(KCrit
)))
integers
all
of
which
have
absolute
value
â‰¤
|Dist(k,
F
r
(KCrit
))
+
r
âˆ’
1|
â‰¤
|k
âˆ’
Avg(F
r
(KCrit
))|
+
|r
âˆ’
1|
â‰¤
|k|
+
12
+
(d
âˆ’
2)
â‰¤
|k|
+
d
(by
Lemma
4.1).

Let
us
write
def
Semi
=
Crit(KSemi
)
âŠ†
KCrit
KCrit
Semi
Thus,
(by
the
deï¬nition
of
KSemi
)
every
k0
âˆˆ
KCrit
satisï¬es
|k0
+
(iÏ‡
/n)|
â‰¥
d4
â‰¥
3
(so
Semi
,
then
r
â‰¥
4
(indeed,
if
r
â‰¤
3,
|k0
|
â‰¥
52
),
where
we
use
that
d
â‰¥
12.
Also,
if
k[r]
âˆˆ
KCrit
r+1
then
by
Lemma
4.1,
|k[r]|
â‰¤
2
â‰¤
2).
Let
us
write
def
Semi
Semi
=
{r
âˆˆ
[0,
d
âˆ’
1]Int
|
k[r]
âˆˆ
KCrit
}
RCrit
Next,
let
us
observe
that
Semi
KCrit
=
{k0
âˆˆ
KCrit
|
|k0
+
(iÏ‡
/n)|
â‰¥
d
}
4
Indeed,
â€œâŠ†â€
follows
from
the
deï¬nition
of
KSemi
.
On
the
other
hand,
if
|k0
+
(iÏ‡
/n)|
â‰¥
d4
,
def
def
and
Ïƒk0
=
k0
/|k0
|,
then
(since
|k0
|
â‰¤
d2
<
d
by
Lemma
4.1,
d
â‰¥
1)
the
integer
k
=
k0
âˆ’
Ïƒk0
Â·
d
satisï¬es
k
Â·
k0
<
0,
hence
âˆˆ
KSemi
.
This
completes
the
proof
of
the
above
observation.
In
the
following,
we
shall
write
def
Semi(k0
)
=
k0
âˆ’
Ïƒk0
Â·
d
1
In
particular,
since
(for
r
âˆˆ
[0,
d
âˆ’
1]Int
)
r
â†’
|k[r]
+
(iÏ‡
/n)|
=
{2
Â·
Î¨(k[r])}
2
is
(not
Semi
is
an
interval
of
integers,
necessarily
strictly)
monotone
increasing,
it
follows
that
RCrit
306
1
d
i.e.,
of
the
form
[r,
d
âˆ’
1]Int
(where
|k[d
âˆ’
1]
+
(iÏ‡
/n)|
â‰¥
dâˆ’2
2
âˆ’
2
â‰¥
4
(by
Lemma
4.1,
Semi
)
for
some
integer
r.
d
â‰¥
6)
implies
d
âˆ’
1
âˆˆ
RCrit
def
Semi
)
by:
Next,
we
would
like
to
deï¬ne
a
matrix
M
=
{Mr,r
}
(where
r,
r
âˆˆ
RCrit
def
Mr,r
=
Coeï¬€
U
k[r
]
(ZCG
r
)
sc


k[r
]
+
Î»r
âˆ’Î¨(k[r])
Î¨(k[r
])
Â·
qsc
Â·
Â·
Ï‡(k[r
]et
)
=
qsc
r


Semi(k[r
])
+
Î»r
Î¨(Semi(k[r
]))
+
Â·
Ï‡(Semi(k[r
])et
)
Â·
qsc
r
Let
us
write
def
M
=
M0
+
MSemi
where
(M0
)r,r
is
deï¬ned
to
be
the
sum
of
all
the
terms
in
Mr,r
in
which
the
exponent
of
def
qsc
is
zero;
MSemi
=
M
âˆ’
M0
.
More
precisely,
(by
Lemma
4.3)
(M0
)r,r
can
be
nonzero
only
when
Î¨(k[r])
=
Î¨(k[r
]).
Moreover,
when
Î¨(k[r])
=
Î¨(k[r
]),
we
have

(M0
)r,r
=
where
k[r
]
+
Î»r
r



Semi(k[r
])
+
Î»r
Â·
Ï‡(k[r
]et
)
+
Â·
Â·
Ï‡(Semi(k[r
])et
)
r
def
=
1
if
r
=
r
=
d
âˆ’
1
and
Semi(k[d
âˆ’
1])
=
k[d]
is
exceptional
(cf.
Lemma
def
4.3);
and
=
0
otherwise.
In
the
following
discussion,
we
would
like
to
show
that
(under
certain
conditions)
M
admits
a
bounded
inverse.
We
will
do
this
by
regarding
MSemi
as
a
deformation
of
M0
,
i.e.,
we
will
ï¬rst
study
the
inverse
of
M0
and
then
show
that
MSemi
is
rather
small.
We
begin
by
considering
M0
.
Note
that
since
the
ï¬bers
of
the
map
r
â†’
Î¨(k[r])
have
at
most
two
(necessarily
adjacent)
elements,
it
follows
that
(M0
)r,r
can
be
nonzero
only
in
the
cases
r
=
r
and
r
=
r
Â±
1.


r
Now
suppose
that
r
=
r
.
Then
we
have
k[r]
+
Î»r
âˆˆ
{âˆ’1,
r},
so
k[r]+Î»
=
Â±1.
r
Similarly,
if
r
=
r
=
d
âˆ’
1
and
Semi(k[d
âˆ’
1])
=
k[d]
is
exceptional,
then
we
have



])+Î»r
Semi(k[r])
+
Î»r
âˆˆ
{âˆ’1,
d
âˆ’
1},
so
Semi(k[r
=
Â±1.
Thus,
r
(M0
)r,r
=
Â±Ï‡(k[r]et
)
Â±
Â·
Ï‡(Semi(k[r])et
)
(where
the
two
â€œÂ±â€™sâ€
are
not
necessarily
the
same
sign).
Note
that
when
r
=
r
=
d
âˆ’
1
and
k[d]
is
exceptional,
(M0
)r,r
is
precisely
the
coeï¬ƒcient
discussed
in
Lemma
4.4.
307
F
Next,
suppose
that
r
=
r
âˆ’
1.
In
this
case,
=
0.
Moreover,
k[r
]
=
k[r
+
1]
âˆˆ



(KCrit
),
so
k[r
]
+
Î»r
âˆˆ
{âˆ’1,
r}.
Thus,
k[r
r]+Î»r
=
Â±1,
so
we
have:
r+2
(M0
)r,r+1
=
Â±Ï‡(k[r
+
1]et
)
Note,
moreover,
that
in
this
case,
since
Î¨(k[r])
=
Î¨(k[r
+
1]),
and
the
ï¬bers
of
the
map
r
â†’
Î¨(k[r])
have
at
most
two
elements,
it
follows
that
Î¨(k[r
+
1])
<
Î¨(k[r
+
2]),
i.e.,
that
(M0
)r+1,r+2
=
0.
Finally,
suppose
that
r
=
r
+
1.
In
this
case,
=
0.
Moreover,
k[r
]
=
k[r
âˆ’
1]
âˆˆ


r
F
(KCrit
),
so
k[r
]
+
Î»r
âˆˆ
[0,
r
âˆ’
1]Int
.
Thus,
k[r
]+Î»
=
0,
so
we
have:
r
r
(M0
)r,râˆ’1
=
0
In
particular,
we
conclude
that
(M0
)r,r
=
0
if
r
>
r
or
r
<
r
âˆ’
1.
In
fact,
this
analysis
shows
the
following:
Lemma
5.2.
The
matrix
M0
is
of
the
form
â›
âˆ—
âœ
âœ0
âœ
âœ
âœ
â
0
0
0
...
âˆ—
0
...
...
0
0
...
0
â
âŸ
0âŸ
âŸ
âŸ
âŸ
â 
âˆ—
that
is
to
say,
zeroes
away
from
the
â€œdiagonalâ€
(i.e.,
the
â€œâˆ—â€™sâ€),
where
each
â€œâˆ—â€
in
the
diagonal
is
either
a
one-by-one
matrix
or
an
upper
triangular
two-by-two
matrix.
In
particular,
M0
itself
is
upper
triangular.
Moreover,
the
diagonal
matrix
elements
of
each
submatrix
â€œâˆ—â€
are
either
n-th
roots
of
unity,
or
(in
the
case
of
(M0
)dâˆ’1,dâˆ’1
,
when
k[d]
is
exceptional)
the
coeï¬ƒcient
of
Lemma
4.4.
The
oï¬€-diagonal
elements
of
each
submatrix
â€œâˆ—â€
are
all
n-th
roots
of
unity.
Finally,
M0
is
invertible,
and
the
components
of
its
inverse
n
Mâˆ’1
0
are
complex
numbers
of
absolute
value
â‰¤
Ï€
.
Proof.
All
the
statements
except
for
the
â€œFinally,...â€
follow
immediately
from
the
above
analysis.
The
â€œFinally,...â€
follows
from
the
fact
that
each
of
the
âˆ—â€™s
are
invertible,
with
inverses
bounded
as
stated.
(Note
that
here
we
use
the
estimates
of
Lemma
4.4.)

Next,
we
would
like
to
bound
MSemi
.
By
deï¬nition,
MSemi
consists
of
the
terms
of
308


k[r
]
+
Î»r
Î¨(k[r
])
Â·
Ï‡(k[r
]et
)
Â·
qsc
r


Semi(k[r
])
+
Î»r
Î¨(Semi(k[r
]))
Â·
Ï‡(Semi(k[r
])et
)
+
Â·
qsc
r
âˆ’Î¨(k[r])
Mr,r
=
qsc
Â·
for
which
the
exponent
of
qsc
is
nonzero.
Thus,
there
are
two
cases
(corresponding
to
the
two
terms
that
appear
in
Mr,r
)
to
consider:
(i)
Î¨(k[r
])
=
Î¨(k[r]);
(ii)
Î¨(Semi(k[r
]))
=
Î¨(k[r]).
We
begin
by
considering
case
(ii).
In
this
case,
either
Semi(k[r
])
is
nonSemi
exceptional,
or
r
<
d
âˆ’
1.
Moreover,
(since
r
âˆˆ
RCrit
)
r
â‰¥
4.
Thus,
Lemma
4.7
implies
that
Î¨(Semi(k[r
]))
âˆ’
Î¨(k[r])
â‰¥
1
Â·
d
Â·
Dist(Semi(k[r
]),
F
r
(KCrit
))
32n
Thus,
since
d
+
|Semi(k[r
])|
â‰¤
2d
+
|k[r
]|
â‰¤
52
Â·
d
â‰¤
d2
(by
the
deï¬nition
of
â€œSemi(âˆ’),â€
Lemma
4.1,
d
â‰¥
3),
we
have
(by
Lemma
5.1):
!
!
Semi(k[r
])
+
Î»

!
!
r
Î¨(Semi(k[r
]))âˆ’Î¨(k[r])
Â·
Ï‡(Semi(k[r
])et
)
!
Â·
qsc
!
r


â‰¤
e2Â·log(d)Â·Dist(Semi(k[r
]),F
(KCrit
))
Â·
|qsc
|
32n
Â·Dist(Semi(k[r
]),F
(KCrit
))
r
d

Ï€
r
r
=
e(2Â·log(d)âˆ’Im(Ï„or
)Â·
16n
)Â·Dist(Semi(k[r
]),F
(KCrit
))
(where
we
use
that
log|qsc
|
=
âˆ’
2Ï€
/
d
Â·
Im(Ï„or
)).
Also,
let
us
observe
that
(since
Semi(k[r
])
âˆˆ
F
r
(KCrit
)),
we
have
Dist(Semi(k[r
]),
F
r
(KCrit
))
â‰¥
1.
Next,
we
consider
case
(i),
i.e.,
the
ï¬rst
term
in
Mr,r
when
Î¨(k[r
])
=
Î¨(k[r]).
Note
ï¬rst
of
all
that
this
condition
implies
that
r
=
r
.
Moreover,
if
r
>
r
,
then
k[r
]
âˆˆ



F
r
(KCrit
),
i.e.,
k[r
]
+
Î»r
âˆˆ
[0,
r
âˆ’
1]Int
,
so
k[r
r]+Î»r
=
0.
Thus,
it
suï¬ƒces
to
bound
this
Semi
,
we
have
|k[r]+(iÏ‡
/n)|,
|k[r
]+(iÏ‡
/n)|
â‰¥
d4
.
term
when
r
<
r
.
Note
that
since
r,
r
âˆˆ
RCrit
Thus,
by
applying
Lemma
4.8
(note
that
â€œr,â€
â€œr
â€
in
Lemma
4.8
are
the
reverse
of
what
they
are
in
the
present
discussion),
we
obtain
Î¨(k[r
])
âˆ’
Î¨(k[r])
â‰¥
1
Â·
d
Â·
Dist(k[r
],
F
r
(KCrit
))
32
Â·
n
Thus,
using
Lemma
5.1
(and
the
fact
that
d
+
|k[r
]|
â‰¤
32
Â·
d
â‰¤
d2
,
by
Lemma
4.1,
d
â‰¥
2)
as
in
the
preceding
paragraph,
we
obtain:
!
k[r
]
+
Î»

!
!
!
r
Î¨(k[r
])âˆ’Î¨(k[r])
Â·
Ï‡(k[r
]et
)
!
Â·
qsc
!
r


â‰¤
e2Â·log(d)Â·Dist(k[r
],F
(KCrit
))
Â·
|qsc
|
32n
Â·Dist(k[r
],F
(KCrit
))
r
Ï€
d

r
=
e(2Â·log(d)âˆ’Im(Ï„or
)Â·
16n
)Â·Dist(k[r
],F
(KCrit
))
309
r

Also,
let
us
observe
that
since
r
<
r
(so
k[r
]
âˆˆ
/
F
r
(KCrit
)
âŠ†
F
r
(KCrit
)),
we
have
Dist(k[r
],
F
r
(KCrit
))
â‰¥
1.
Now
let
us
assume
that
Im(Ï„or
)
â‰¥
{5
+
(log(n)/log(d))}
Â·
16
Â·
log(d)
Â·
n
Ï€
Then
it
follows
that
2
Â·
log(d)
âˆ’
Im(Ï„or
)
Â·
Ï€
â‰¤
âˆ’{3
+
(log(n)/log(d))}
Â·
log(d)
16n

Ï€

16n
â‰¤
âˆ’{3
+
(log(n)/log(d))}
Â·
log(d)
=
âˆ’3
Â·
log(d)
âˆ’
log(n)
+
{5
+
(log(n)/log(d))}
Â·
log(d)
âˆ’
Im(Ï„or
)
Â·
In
particular,
it
follows
that
both
of
the
terms
(cf.
the
treatment
of
cases
(i),
(ii)
above)
which
appear
in
the
components
of
MSemi
have
absolute
value
â‰¤
eâˆ’3Â·log(d)âˆ’log(n)
=
(n
Â·
d3
)âˆ’1
.
Thus,
since
there
are
two
terms
involved,
we
obtain
the
following
result:
Lemma
5.3.
If
the
condition
Im(Ï„or
)
â‰¥
{5
+
(log(n)/log(d))}
Â·
16
Â·
log(d)
Â·
n
Ï€
2
In
is
satisï¬ed,
then
the
components
of
the
matrix
MSemi
have
absolute
value
â‰¤
nÂ·d
3.
âˆ’1
n
2
particular,
the
components
of
the
matrix
M0
Â·
MSemi
have
absolute
value
â‰¤
d
Â·
Ï€
Â·
nÂ·d3
â‰¤
dâˆ’2
.
Proof.
The
statement
concerning
the
absolute
values
of
the
components
of
MSemi
was
proven
in
the
above
discussion.
The
statement
concerning
the
absolute
values
of
the
components
of
Mâˆ’1
0
Â·
MSemi
follows
from
this
estimate,
plus
the
estimates
of
Lemma
5.2
(together
with
the
fact
that
these
matrices
are
square
matrics
of
order
equal
to
the
Semi
Semi
|
â‰¤
|KCrit
|
=
d
of
KCrit
).

cardinality
|KCrit
Now
we
come
to
the
invertibility
of
the
original
matrix
M.
Note
that
âˆ’1
Mâˆ’1
0
Â·
M
=
1
+
M0
Â·
MSemi
def
Write
M
=
âˆ’Mâˆ’1
0
Â·
MSemi
.
Then
by
Lemma
5.3,
the
components
of
M
have
absolute
value
â‰¤
dâˆ’2
.
Thus,
for
any
nonnegative
integer
N
,
the
components
of
(M
)N
+1
will
have
Semi
|â‰¤
absolute
value
â‰¤
dâˆ’2
Â·
(d
Â·
dâˆ’2
)N
=
dâˆ’N
âˆ’2
(where
we
again
use
the
fact
that
|KCrit
def
310

|KCrit
|
=
d).
Thus,
the
series
N
â‰¥0
(M
)N
converges
to
a
matrix
whose
components
have
absolute
value
â‰¤
(1
âˆ’
dâˆ’1
)âˆ’1
â‰¤
2.
Moreover,
M
âˆ’1
=

N
(M
)

Â·
Mâˆ’1
0
N
â‰¥0
Thus,
(applying
the
estimates
of
Lemma
5.2)
we
see
that
we
have
proven
the
following:
Lemma
5.4.
Under
the
hypothesis
of
Lemma
5.3,
the
matrix
M
is
invertible,
and
the
components
of
its
inverse
have
absolute
value
â‰¤
2
Â·
d
Â·
nÏ€
â‰¤
d
Â·
n.
to
the
problem
that
Now
we
would
like
to
consider
the
analogous
problem
for
the
ZCG
r
we
solved
in
Â§3
for
the
ZrCG
:
Namely,
let
def
Z
=
dâˆ’1

Î³r
Â·
ZCG
r
r=0
be
a
C-linear
combination
(i.e.,
the
Î³r
âˆˆ
C)
of
the
ZCG
r
.
def
Suppose
that
||Z||
=
1.
Then
to
what
extent
can
one
bound
the
gr
=
|Î³r
|?
k
(k
âˆˆ
Z)
form
an
orthonormal
system
in
L2
((S1
)sc
),
it
follows
Since
||Z||
=
1,
and
the
Usc
k
that
the
coeï¬ƒcients
of
the
Usc
(in
the
â€œFourier
expansionâ€
of
Z)
are
â‰¤
1.
In
particular,
k[r
]
for
each
r
=
0,
.
.
.
,
d
âˆ’
1,
the
coeï¬ƒcient
of
Usc
is
â‰¤
1.
Thus,
we
would
like
to
analyze
these
coeï¬ƒcients
in
a
fashion
similar
to
Â§3.
Unfortunately,
however,
the
present
situation
is
somewhat
more
complicated
than
in
Â§3,
so
we
must
break
the
situation
down
into
two
cases.
Semi
/
RCrit
.
This
case
is
the
simpler
case
since
it
may
be
First,
we
consider
the
case
r
âˆˆ
Semi
reduced
to
the
results
of
Â§3.
More
precisely,
let
us
observe
that
for
r
âˆˆ
/
RCrit
,
there
do
not
exist
any
k
âˆˆ
KSemi
such
that
Crit(k)
=
k[r
].
Thus,
if
we
just
look
at
the
coeï¬ƒcient
k[r
]
is
exactly
the
same
as
ZrCG
.
Thus,
we
obtain
exactly
the
same
inequalities
of
Usc
,
ZCG
r


r
!

!
k[r
]
+
Î»r
!
!
Î¨(k[r
])âˆ’Î¨(k[r])
Î³r
Â·
Â·
Ï‡(k[r]et
)
!
â‰¤
1
Â·
qsc
!
r
r=0
Semi
Semi
,
any
r
â‰¤
r
will
also
âˆˆ
RCrit
.
Thus,
for
the
r
appearing
as
in
Â§3.
Note
that
since
r
âˆˆ
RCrit
k[r]
in
this
sum,
we
also
get
similar
inequalities
(obtained
by
considering
the
coeï¬ƒcient
of
Usc
).
In
particular,
by
the
analysis
of
Â§3
(more
precisely:
by
Theorem
3.3,
(2)),
we
obtain
the
following
result:
311
2
26Â·d
Semi
Suppose
that
Im(Ï„or
)
â‰¥
32
,
for
all
r
âˆˆ
/
RCrit
.
Ï€
Â·
log
(d).
Then
|Î³r
|
â‰¤
e
Lemma
5.5.
Semi
.
This
case
is
the
more
diï¬ƒcult
of
the
two
cases.
Next,
we
consider
the
case
r
âˆˆ
RCrit
k[r
]
First,
let
us
observe
that
by
looking
at
the
coeï¬ƒcient
of
Usc
,
we
obtain
an
inequality
!
!
dâˆ’1
!

CG
!
Î³r
Â·
Coeï¬€
U
k[r
]
(Zr
)
!
â‰¤
1
!
sc
r=0
Semi
analogous
to
the
one
considered
in
the
â€œâˆˆ
/
RCrit
case.â€
Thus,
under
the
hypothesis
of
Lemma
5.5,
we
obtain
!
!
!
!
!
!
!
Î³r
Â·
Mr,r
!
=
!

Semi
râˆˆRCrit
!

!
Î³r
Â·
Coeï¬€
U
k[r
]
(ZCG
)!
r
sc
Semi
râˆˆRCrit
!
!
â‰¤1+!
!
!
Î³r
Â·
Coeï¬€
U
k[r
]
(ZCG
)
!
r

sc
Semi
râˆˆR
/
Crit
â‰¤
1
+
e26Â·d
Â·
!
!
!
!
)
!
Coeï¬€
U
k[r
]
(ZCG
!
r

sc
Semi
râˆˆR
/
Crit
Now
we
have
the
following
result:
Lemma
5.6.
Let
r
âˆˆ
[0,
d
âˆ’
1]Int
,
r
!
!
!
CG
!

!
Coeï¬€
U
k[r
]
(Zr
)
!
â‰¤
23dâˆ’1
.
Semi
âˆˆ
RCrit
.
Then
sc
Proof.
Note
that
Î¨(Semi(k[r
]))
â‰¥
Î¨(k[r])
always,
and
Î¨(k[r
])
â‰¥
Î¨(k[r])
if
r
â‰¤
r
.
On
the
other
hand,
Coeï¬€
U
k[r
]
(ZCG
r
)
is
given
by
sc

k[r
]
+
Î»r
r


Î¨(k[r
])âˆ’Î¨(k[r])
Â·
Ï‡(k[r
]et
)
Â·
qsc


Semi(k[r
])
+
Î»r
Î¨(Semi(k[r
]))âˆ’Î¨(k[r])
Â·
qsc
Â·
Ï‡(Semi(k[r
])et
)
+
r

where
the
ï¬rst
term
is
zero
if
r
>
r
(since
then
k[r
]
âˆˆ
F
r
+1
(KCrit
)
âŠ†
F
r
(KCrit
),
so
k[r
]
+
Î»r
âˆˆ
[0,
r
âˆ’
1]Int
).
Since
the
exponents
of
qsc
appearing
in
the
nonzero
term(s)
are
â‰¥
0,
we
thus
obtain
that
this
coeï¬ƒcient
has
absolute
value
â‰¤
!k[r
]
+
Î»
!
!Semi(k[r
])
+
Î»
!
!
!
r
!
r
!
!+!
!
!
r
r




Dist(Semi(k[r
]),
F
r
(KCrit
))
+
r
âˆ’
1
Dist(k[r
],
F
r
(KCrit
))
+
r
âˆ’
1
â‰¤
+
r
r


r
r
â‰¤
2Dist(k[r
],F
(KCrit
))+dâˆ’2
+
2Dist(Semi(k[r
]),F
(KCrit
))+dâˆ’2
â‰¤
22dâˆ’2
+
23dâˆ’2
â‰¤
2
Â·
23dâˆ’2
=
23dâˆ’1
312
(where
we
use
Lemma
5.1,
d
â‰¥
1,
and
the
estimates
Dist(k[r
],
F
r
(KCrit
))
â‰¤
|k[r
]
âˆ’
Avg(F
r
(KCrit
))|
â‰¤
d
1
+
â‰¤d
2
2
and
Dist(Semi(k[r
]),
F
r
(KCrit
))
â‰¤
|Semi(k[r
])
âˆ’
Avg(F
r
(KCrit
))|
â‰¤
|Semi(k[r
])|
+
â‰¤
d
+
|k[r
]|
+
1
2
1
d
1
â‰¤
d
+
+
â‰¤
2d
2
2
2
â€“
cf.
Lemma
4.1).

Thus,
applying
Lemma
5.6
in
the
above
discussion,
we
obtain:
!
!
!

!
!
Semi
Î³r
Â·
Mr,r
!
â‰¤
1
+
e26Â·d
Â·
|[0,
d
âˆ’
1]Int
\RCrit
|
Â·
23dâˆ’1
â‰¤
d
Â·
e26Â·d
Â·
23d
â‰¤
d
Â·
e29Â·d
Semi
râˆˆRCrit
On
the
other
hand,
by
Lemma
5.4,
M
is
invertible,
and
the
components
of
Mâˆ’1
have
absolute
value
â‰¤
d
Â·
n.
Thus,
we
conclude
that,
under
the
hypothesis
of
Lemma
5.3,
we
have:
Semi
|Î³r
|
â‰¤
|RCrit
|
Â·
(d
Â·
n)
Â·
d
Â·
e29Â·d
â‰¤
n
Â·
d3
Â·
e29Â·d
â‰¤
n
Â·
e30Â·d
Semi
(since
d
â‰¤
e
3
Â·d
for
d
â‰¥
6)
for
r
âˆˆ
RCrit
.
That
is
to
say,
we
have
proven
the
following
CG
analogue
for
the
Zr
of
Theorem
3.3:
1
Suppose
that
d
â‰¥
12,
and
Theorem
5.7.
Im(Ï„or
)
â‰¥
def
dâˆ’1
r=0
and
let
Z
=
16
32
80
Â·
log2
(d)
+
Â·
n
Â·
log(d)
+
Â·
n
Â·
log(n)
Ï€
Ï€
Ï€
Î³r
Â·ZCG
be
a
C-linear
combination
(i.e.,
the
Î³r
âˆˆ
C)
of
the
ZCG
r
r
.
Then
(1)
If
the
|Î³r
|
â‰¤
1
for
r
=
0,
.
.
.
,
d
âˆ’
1,
then
the
L2
((S1
)sc
)-norm
of
Z
satisï¬es:
||Z||
â‰¤
d2
Â·
e3d
â‰¤
e4d
.
313
(2)
If
||Z||
â‰¤
1,
then
the
|Î³r
|
â‰¤
n
Â·
e30Â·d
,
for
all
r
=
0,
.
.
.
,
d
âˆ’
1,
and
Semi
/
RCrit
.
|Î³r
|
â‰¤
e26Â·d
if
r
âˆˆ
In
particular,
if
we
orthonormalize
the
ZCG
to
form
r
OC
ZOC
0
,
.
.
.
,
Zdâˆ’1
â€“
which
are
unique
if
we
stipulate
that
the
leading
coeï¬ƒcient
of
ZOC
(i.e.,
the
coeï¬ƒcient
r
CG
CG
CG
OC
of
Zr
in
the
linear
combination
of
Z0
,
.
.
.
,
Zr
that
forms
Zr
)
be
positive
â€“
then
the
30d
coeï¬ƒcients
of
the
ZCG
in
each
ZOC
,
and
the
absolute
values
r
r
have
absolute
value
â‰¤
n
Â·
e
âˆ’2
âˆ’3d
âˆ’4d
â‰¥e
.
of
the
leading
coeï¬ƒcients
are
â‰¥
d
Â·
e
Proof.
Note
that
the
hypothesis
of
Theorem
5.7
implies
the
hypotheses
of
Lemmas
5.3,
5.4,
5.5.
The
ï¬nal
portion
concerning
the
ZOC
follows
formally
from
(1),
(2)
(cf.
the
proof
r
of
Theorem
3.3).
Moreover,
(2)
is
precisely
what
was
proven
above
(cf.
Lemma
5.5
for
the
last
part
of
(2)).
Thus,
it
suï¬ƒces
to
prove
(1).
To
prove
(1),
it
suï¬ƒces
to
bound
the
k[r
]
(for
r,
r
=
0,
.
.
.
,
d
âˆ’
1)
by
e3d
.
For
absolute
value
of
the
coeï¬ƒcient
of
each
Usc
in
ZCG
r
CG
Semi
r
âˆˆ
/
RCrit
,
(as
discussed
above)
the
Zr
look
exactly
the
same
as
the
ZrCG
,
so
we
obtain
Semi
,
the
coeï¬ƒcient
the
estimate
â€œâ‰¤
ed
(â‰¤
e3d
)â€
as
in
the
proof
of
Theorem
3.3.
For
r
âˆˆ
RCrit

k[r
]
of
Usc
has
absolute
value
â‰¤
e3d
by
Lemma
5.6
(cf.
the
proof
of
Theorem
3.3).
This
completes
the
proof
of
(1).

and
the
original
Î¶rCG
.
This
It
thus
remains
to
deal
with
the
discrepancy
between
ZCG
r
discrepancy
may
be
dealt
with
exactly
as
in
the
proof
of
Lemma
2.1
in
Â§2
(where
we
dealt
with
deformations
of
the
discrete
Tchebycheï¬€
polynomials).
Indeed,
let
def
Î¶rCG,Î¼
=

k
+
Î»r

kâˆˆZ
=
ZCG
+
r
r
Î¨(k)âˆ’Î¨(k[r])
Crit(k)
Â·
Usc
Â·
Ï‡(ket
)
Â·
qsc


kâˆˆZ\(KCrit
k
+
Î»r
r

Î¨(k)âˆ’Î¨(k[r])
Crit(k)
Â·
Usc
Â·
Ï‡(ket
)
Â·
qsc
KSemi
)
âˆ’Î¨(k[r])
be
the
series
obtained
by
restricting
qsc
def
Î¶Î¼
=
dâˆ’1

âˆ’i
Â·
Ucv
Ï‡
Â·
Î¶rCG
to
Î¼d
âŠ†
(S1
)sc
.
Let
Î³r
Â·
Î¶rCG,Î¼
r=0
CG,Î¼
be
a
C-linear
combination
(i.e.,
the
Î³r
âˆˆ
C)
of
the
Î¶r
314
.
Moreover,
let
us
assume
that
def
Z
=
dâˆ’1

Î³r
Â·
ZCG
r
r=0
satisï¬es
||Z||
=
1.
Then
we
would
like
to
bound
||Î¶
Î¼
||
from
above
and
below.
In
the
following
discussion,
we
assume
that
the
hypotheses
of
Theorem
5.7
are
satisï¬ed.
Then
by
Theorem
5.7,
(2),
we
obtain
|Î³r
|
â‰¤
n
Â·
e30Â·d
for
r
=
0,
.
.
.
,
d
âˆ’
1.
On
the
other
hand,
by
Lemma
4.2,
for
k
âˆˆ
Z\(KCrit
KSemi
),
we
1
Â·
d
Â·
|k|.
Thus,
(by
Lemmas
4.1,
5.1,
and
the
estimate
have
|k|
â‰¥
12
d,
Î¨(k)
âˆ’
Î¨(k[d
âˆ’
1])
â‰¥
16
Dist(k,
F
r
(KCrit
))
â‰¤
|k
âˆ’
Avg(F
r
(KCrit
))|
â‰¤
|k|
+
12
)
we
have:
!
k
+
Î»

!
Dist(k,
F
r
(K
))
+
r
âˆ’
1
!
r
Crit
Î¨(k)âˆ’Î¨(k[r])
!
Â·
qsc
Â·
|qsc
|Î¨(k)âˆ’Î¨(k[dâˆ’1])
!
!â‰¤
r
r
â‰¤
2Dist(k,F
(KCrit
))+râˆ’1
Â·
|qsc
|
16
Â·dÂ·|k|
â‰¤
2|k|+
2
+dâˆ’2
Â·
|qor
|
16
Â·|k|
r
1
1
1
â‰¤
23Â·|k|
Â·
|qor
|
16
Â·|k|
â‰¤
e3Â·|k|âˆ’
16
Â·Im(Ï„or
)Â·|k|
â‰¤
e|k|Â·(3âˆ’
8
Â·Im(Ï„or
))
1
2Ï€
Ï€
Now
let
us
assume
that
def
Ï€
C
=
8
Â·
Im(Ï„or
)
âˆ’
3
â‰¥
62
+
2
Â·
log(n)
d
Then
it
follows
that
!
k
+
Î»

!
!
r
Î¨(k)âˆ’Î¨(k[r])
!
Â·
q
!
!
sc
r

||Î¶rCG,Î¼
âˆ’
ZCG
r
||
â‰¤
kâˆˆZ\(KCrit

â‰¤
kâˆˆZ\(KCrit
â‰¤2Â·

KSemi
)
eâˆ’CÂ·|k|
KSemi
)
eâˆ’CÂ·k
kâ‰¥
12
d
â‰¤
2
Â·
eâˆ’
2
CÂ·d
Â·
(1
âˆ’
eâˆ’C
)âˆ’1
â‰¤
4
Â·
eâˆ’
2
CÂ·d
1
1
(since
C
â‰¥
1
implies
eC
â‰¥
e
â‰¥
2,
so
(1
âˆ’
eâˆ’C
)âˆ’1
â‰¤
2).
Thus,
since
12
C
â‰¥
31
+
log(n)
d
,
we
have:
315
||Î¶
Î¼
âˆ’
Z||
â‰¤
dâˆ’1

|Î³r
|
Â·
||Î¶rCG,Î¼
âˆ’
ZCG
r
||
r=0
â‰¤
d
Â·
(n
Â·
e30Â·d
)
Â·
(4
Â·
eâˆ’
2
CÂ·d
)
1
1
â‰¤
Â·
n
Â·
edÂ·(31âˆ’
2
C)
2
1
1
â‰¤
Â·
n
Â·
eâˆ’log(n)
=
2
2
1
(where
we
use
that
d
â‰¥
4
implies
8d
â‰¤
ed
).
Thus,
since
||Z||
=
1,
we
obtain
1
3
1
Â·
||Z||
=
â‰¤
||Z||
âˆ’
||Z
âˆ’
Î¶
Î¼
||
â‰¤
||Î¶
Î¼
||
â‰¤
||Î¶
Î¼
âˆ’
Z||
+
||Z||
â‰¤
â‰¤
2
=
2
Â·
||Z||
2
2
2
This
is
the
desired
bound
on
||Î¶
Î¼
||.
Thus,
we
have
proven
the
following
result,
which
is
the
main
result
of
the
present
Â§:
Theorem
5.8.
Suppose
that
d
â‰¥
12,
and
Im(Ï„or
)
â‰¥
32
80
16
8
Â·
log2
(d)
+
Â·
n
Â·
log(d)
+
Â·
n
Â·
log(n)
+
Â·
65
Ï€
Ï€
Ï€
Ï€
def
dâˆ’1
âˆ’Î¨(k[r])
and
let
Î¶
=
Â·
Î¶rCG
be
a
C-linear
combination
(i.e.,
the
Î³r
âˆˆ
C)
of
the
r=0
Î³r
Â·
qsc
âˆ’Î¨(k[r])
Â·
Î¶rCG
.
Let
us
write
qsc
||Î¶||et
0
1
dâˆ’1
for
the
L2
(Î¼d
)
norm
(i.e.,
the
norm
for
which
Usc
,
Usc
,
.
.
.
,
Usc
are
orthonormal)
of
the
âˆ’iÏ‡
function
(Ucv
Â·
Î¶)|Î¼d
âŠ†(S1
)sc
.
Then
(1)
If
the
|Î³r
|
â‰¤
1
for
r
=
0,
.
.
.
,
dâˆ’1,
then
we
have:
||Î¶||et
â‰¤
2Â·d2
Â·e3d
â‰¤
e4d
.
(2)
If
||Î¶||et
â‰¤
1,
then
the
|Î³r
|
â‰¤
2n
Â·
e30Â·d
,
for
all
r
=
0,
.
.
.
,
d
âˆ’
1,
and
Semi
|Î³r
|
â‰¤
2
Â·
e26Â·d
if
r
âˆˆ
/
RCrit
.
âˆ’Î¨(k[r])
In
particular,
if
we
orthonormalize
the
qsc
Â·
Î¶rCG
to
form
OC
Î¶0OC
,
.
.
.
,
Î¶dâˆ’1
â€“
which
are
unique
if
we
stipulate
that
the
leading
coeï¬ƒcient
of
Î¶rOC
(i.e.,
the
coeï¬ƒcient
of
Î¶rCG
in
the
linear
combination
of
Î¶0CG
,
.
.
.
,
Î¶rCG
that
forms
Î¶rOC
)
be
positive
â€“
then
the
316
coeï¬ƒcients
of
the
Î¶rCG
in
each
Î¶rOC
have
absolute
value
â‰¤
2n
Â·
e30d
,
and
the
absolute
values

of
the
leading
coeï¬ƒcients
are
â‰¥
eâˆ’4d
.
Proof.
One
checks
easily
that
the
hypothesis
of
Theorem
5.8
implies
both
the
hypothesis
of
Theorem
5.7,
as
well
as
the
assumption
Ï€
2
Â·
Im(Ï„or
)
âˆ’
3
â‰¥
62
+
Â·
log(n)
8
d
made
above.
Then
(1),
(2)
follow
from
the
corresponding
assertions
of
Theorem
5.7,
together
with
the
inequalities
1
Â·
||Z||
â‰¤
||Î¶
Î¼
||
â‰¤
2
Â·
||Z||
2
derived
above
(which
hold
even
if
||Z||
=
1).
The
assertions
concerning
the
Î¶rOC
follow
formally
from
(1),
(2)
(cf.
the
proof
of
Theorem
5.7).

Remark.
Thus,
stated
in
words,
Theorem
5.8
asserts
that:
If
Im(Ï„or
)
is
suï¬ƒciently
large
(roughly
â‰¥
the
order
of
log2
(d),
when
n
is
held
ï¬xed),
then
up
to
a
factor
of
order
n
Â·
C
d
(for
some
constant
C),
âˆ’Î¨(k[r])
Â·
Î¶rCG
the
L2
-norm
on
the
complex
vector
space
generated
by
the
qsc
(for
r
=
0,
.
.
.
,
d
âˆ’
1)
is
the
same
as
the
norm
for
which
these
functions
âˆ’Î¨(k[r])
Â·
Î¶rCG
(for
r
=
0,
.
.
.
,
d
âˆ’
1)
are
orthonormal.
qsc
Note
that
the
factor
of
n
in
â€œn
Â·
C
d
â€
is
precisely
the
archimedean
analogue
of
the
schemetheoretic
zero
locus
of
the
determinant
given
in
Chapter
VI,
Theorem
4.1,
(2)
(cf.
also
the
Remark
following
Lemma
4.4).
In
some
sense,
of
the
three
models
(Hermite,
Legendre,
and
Binomial)
discussed,
the
(full)
binomial
model
is
the
closest
archimedean
analogue
to
what
is
done
in
Chapter
VI
at
ï¬nite
primes.
Unfortunately,
however,
the
estimates
for
the
binomial
model
only
hold
when
the
elliptic
curve
in
question
is
fairly
close
to
inï¬nity.
This
degree
of
proximity,
i.e.,
log2
(d)
when
n
is
held
ï¬xed,
is
not
so
outrageously
large
in
the
sense
that,
roughly
speaking,
Im(Ï„or
)
should
be
regarded
as
being
roughly
on
a
par
with
d
in
terms
of
size
(cf.
the
discussion
of
â€œnatural
variables
over
F1
â€
in
Remark
2
at
the
end
of
Chapter
VII,
Â§6).
Thus,
in
some
sense,
to
require
that
Im(Ï„or
)
be
at
least
of
the
order
of
log2
(d)
is
a
â€œlogarithmically
weakâ€
requirement
on
the
proximity
to
inï¬nity.
317
Â§6.
Relations
Among
Various
Norms
and
Zeta
Functions
In
this
Â§,
we
prepare
for
the
discussion
of
the
Hodge-Arakelov
Comparison
Isomorphism
in
Â§7
below
by
relating
the
material
of
Â§1
through
5
of
the
present
Chapter
to
the
theory
of
Â§4
through
6
of
Chapter
VII.
That
is
to
say,
throughout
Chapter
VII
and
the
present
Chapter,
various
canonical
norms
on
function
spaces,
as
well
as
various
canonical
zeta
functions
were
introduced.
The
reason
that
so
many
such
objects
were
introduced
was
because
each
one
relates
to
a
certain
piece
of
the
fundamental
problem
of
relating
the
natural
metrics
on
the
function
spaces
of
â€œde
Rham
functionsâ€
and
â€œeÌtale
functionsâ€
to
one
another
(cf.
the
Introduction
to
Chapter
VII).
Thus,
the
purpose
of
the
present
Â§
is
to
explain
how
to
put
these
pieces
together.
We
continue
with
the
notation
of
Â§5.
In
addition,
we
suppose
for
simplicity
that
d
â‰¥
25
Let
us
review
the
situation
that
we
are
in.
First
of
all,
we
have
our
â€œoriginalâ€
elliptic
def
def
Z
Z
,
together
with
our
â€œscaledâ€
elliptic
curve
Esc
=
(Gm
)sc
/qsc
,
curve
Eor
=
(Gm
)or
/qor
2Ï€iÏ„or
2Ï€iÏ„sc
where
qor
=
e
,
qsc
=
e
,
Ï„or
=
d
Â·
Ï„sc
,
and
(Gm
)or
=
(Gm
)sc
.
Thus,
we
may
think
of
Esc
as
a
quotient
Z
Z
Eor
=
(Gm
)or
/qor
â†’
Esc
=
(Gm
)sc
/qsc
def
def
of
Eor
.
The
pull-back
morphism
on
diï¬€erentials
thus
induces
a
natural
isomorphism
Î¹diï¬€
:
Ï‰Eor
âˆ¼
=
Ï‰Esc
Note
that
this
quotient
map
extends
to
a
push-forward
morphism
on
the
universal
extensions
of
Eor
,
Esc
:
0
âˆ’â†’
Ï‰Eor
âˆ’â†’
â
âdÂ·Î¹

diff
â€ 
Eor
â
â

0
âˆ’â†’
âˆ’â†’
â€ 
Esc
Ï‰Esc
âˆ’â†’
Eor
â
â

âˆ’â†’
0
âˆ’â†’
Esc
âˆ’â†’
0
One
checks
easily
that
the
push-forward
morphism
induces
the
map
d
Â·
Î¹diï¬€
on
Ï‰Eor
=
âˆ¨
(respectively,
Ï‰Esc
.
In
the
following
discussion,
we
would
like
to
think
of
Ï„Eor
=
Ï‰E
or
âˆ¨
Ï„Esc
=
Ï‰E
)
as
the
space
of
(linear)
functions
on
the
Ï‰
(respectively,
Ï‰
Eor
Esc
)
portion
sc
â€ 
â€ 
of
Eor
(respectively,
Esc
).
From
this
â€œfunction-theoreticâ€
point
of
view,
we
obtain
an
isomorphism
Î¹func
:
Ï„Esc
â†’
Ï„Eor
318
def
where
Î¹func
=
(d
Â·
Î¹diï¬€
)âˆ¨
.
Next,
we
would
like
to
consider
various
trivializations
of
Ï„Eor
,
Ï„Esc
.
If
we
think
of
Esc
as
the
elliptic
curve
â€œEâ€
of
Chapter
VII,
Â§4,5,
then
we
have
the
trivialization
â€œÎ¸
âˆ¨
â€
(cf.
Chapter
VII,
Â§4,5)
of
Ï„Esc
,
which
is
determined
up
to
multiplication
by
an
element
âˆˆ
S1
âŠ†
CÃ—
by
the
property
that
its
norm
with
respect
to
the
metric
â€œ||
âˆ¼
||Ï„
â€
of
Chapter
VII,
Â§4,
is
1.
Let
us
denote
this
trivialization
by
Î˜DR,sc
.
Put
another
way,
if
we
regard
Esc
as
the
â€œEâ€
of
Chapter
VII,
Â§4,5,
then
Î˜DR,sc
may
be
identiï¬ed
with
the
exterior
derivative
of
the
function
â€œTDR
â€
on
Chapter
VII,
Â§4,5.
Similarly,
we
have
a
metric
â€œ||
âˆ¼
||Ï„
â€
(as
in
Chapter
VII,
Â§4)
on
Ï„Eor
which
gives
rise
to
a
trivialization
Î˜DR,or
of
Ï„Eor
whose
norm
is
1
and
which
may
be
normalized
by
requiring
that
it
be
a
positive
multiple
of
Î˜DR,sc
âˆˆ
Ï„Esc
âˆ¼
=
Ï„Eor
(where
â€œâˆ¼
=â€
is
either
Î¹âˆ¨
diï¬€
or
Î¹func
â€“
both
give
the
same
result
since
they
diï¬€er
by
a
positive
multiple).
Since
the
metric
â€œ||
âˆ¼
||Ï„
â€
of
Chapter
VII,
Â§4,
is
deï¬ned
by
integration,
and
integrating
the
pull-back
to
Eor
of
a
(1,
1)-form
on
Esc
diï¬€ers
by
a
factor
1
âˆ¨
of
d
from
integrating
the
form
on
Esc
,
we
thus
obtain
that
d
2
Â·(Î˜DR,or
)âˆ¨
=
Î¹âˆ’1
diï¬€
((Î˜DR,sc
)
),
1
which
implies
(by
taking
the
dual)
dâˆ’
2
Â·
Î˜DR,or
=
Î¹âˆ¨
diï¬€
(Î˜DR,sc
),
hence
(by
multiplying
by
1
d
2
):
Î˜DR,or
=
dâˆ’
2
Â·
Î¹func
(Î˜DR,sc
)
1
âˆ‚
On
the
other
hand,
in
Chapter
VII,
Â§5,
we
also
considered
the
trivialization
â€œ
âˆ‚log(U
)â€
(where
U
is
the
standard
coordinate
on
Gm
),
which
gave
rise
to
the
function
â€œTSW
â€
of
Chapter
VII,
Â§5.
Let
us
write
Î˜SW,sc
(respectively,
Î˜SW,or
)
for
the
trivialization
of
Ï‰Esc
âˆ‚
âˆ‚
(respectively,
Ï‰or
)
deï¬ned
by
âˆ‚log(U
(respectively,
âˆ‚log(U
).
If
we
think
of
the
elliptic
sc
)
or
)
curve
â€œEâ€
of
Chapter
VII,
Â§5,
as
being
Esc
,
then
one
may
also
think
of
Î˜SW,sc
as
the
exterior
derivative
of
the
function
â€œTSW
â€
of
Chapter
VII,
Â§5.
In
particular,
it
follows
from
Chapter
VII,
Lemma
5.2,
that
Î˜DR,sc
=
{8Ï€
2
Im(Ï„sc
)}
2
Â·
Î˜SW,sc
=
dâˆ’
2
Â·
Cor
Â·
Î˜SW,sc
1
def
1
1
where
Cor
=
{8Ï€
2
Â·
Im(Ï„or
)}
2
.
Similarly,
Î˜DR,or
=
Cor
Â·
Î˜SW,or
Remark.
One
convenient
way
to
keep
track
of
the
various
trivializations
introduced
above
is
â€ 
to
think
of
them
as
functions
on
the
â€œÏ‰Eor
(respectively,
Ï‰Esc
)
portionâ€
of
Eor
(respectively,
â€ 
â€ 
â€ 
Esc
),
hence
as
linear
functions
(well-deï¬ned
up
to
some
constant
term,
since
Eor
,
Esc
are
â€ 
â€ 
torsors)
on
the
d-torsion
points
of
Eor
(which
map
to
the
d-torsion
points
of
Esc
).
From
this
point
of
view,
we
see
that
(if
we
neglect
the
constant
term,
then)
Î˜SW,or
(respectively,
Î˜SW,sc
)
takes
values
âˆˆ
d1
Â·
Z
(respectively,
âˆˆ
Z)
on
the
d-torsion
points
(cf.
Chapter
III,
â€ 
Corollary
5.9)
of
Eor
.
Thus,
in
summary,
the
values
taken
(if
we
neglect
the
constant
term)
â€ 
by
these
functions
(trivializations)
on
the
d-torsion
of
Eor
are
given
by:
319
Î˜SW,sc
:
âˆˆ
Z
Î˜DR,sc
:
âˆˆ
Cor
1
Â·
Z
d2
Cor
Î˜DR,or
:
âˆˆ
d
Â·
Z
Î˜SW,or
:
âˆˆ
d1
Â·
Z
1
As
we
will
see
in
the
following
discussion,
these
factors
of
d,
d
2
that
occur
are
related
to
various
scaling
issues,
of
the
sort
discussed
at
the
end
of
Chapter
VII,
Â§3.
Next,
we
would
like
to
apply
the
theory
of
Chapter
VII,
Â§5,
relating
the
de
Rham
and
Schottky-Weierstrass
canonical
zeta
functions
in
the
case
where
the
elliptic
curve
â€œEâ€
(of
Chapter
VII,
Â§5)
is
Esc
.
First,
let
us
write
(S1
)sc
âŠ†
(Gm
)sc
for
the
copy
of
(S1
)sc
in
(Gm
)sc
.
Note
that
(S1
)sc
also
injects
into
Esc
via
the
projection
(Gm
)sc
â†’
Esc
.
Moreover,
â€ 
(S1
)sc
âŠ†
Esc
lifts
naturally
(and
uniquely!)
to
a
closed
subgroup
(S1
)sc
âŠ†
Esc
.
Thus,
â€ 
we
may
restrict
the
relations
of
Chapter
VII,
Theorem
5.3,
to
(S1
)sc
âŠ†
Esc
.
Note
that
â€ 
the
functions
â€œTSW
â€
and
â€œTDR
â€
of
Chapter
VII,
Â§5,
are
zero
on
(S1
)sc
âŠ†
Esc
.
(This
â€ 
follows
since
the
canonical
sections
of
Esc
â†’
Esc
used
to
deï¬ne
â€œTSW
â€
and
â€œTDR
â€
are
â€ 
continuous
homomorphisms,
hence
map
(S1
)sc
âŠ†
Esc
into
(S1
)sc
âŠ†
Esc
.)
Also,
note
that
although
the
theory
of
Chapter
VII,
Â§5,
was
only
given
in
the
case
of
a
trivial
character
Ï‡,
it
generalizes
immediately
to
the
case
of
an
arbitrary
character
Ï‡
(cf.
Chapter
IV,
Â§3,
especially
Theorems
3.2,
3.3),
for
instance,
by
â€œtransport
of
structureâ€
relative
to
the
automorphism
of
â€œEâ€
given
by
translating
by
an
appropriate
torsion
point
(cf.
the
discussion
immediately
preceding
Chapter
VII,
Theorem
6.7).
Thus,
by
Chapter
VII,
Theorem
5.3,
we
obtain
(for
r
âˆˆ
Zâ‰¥0
):
Î¶rSS
|(S1
)sc
=
[r/2]

(Ï€
Â·
u)m
r!
PD
r!
DR
1
Â·
Î¶râˆ’2m
Â·
Î¶r
|(S
)sc
=
r
|(S1
)sc
r
Â·
r
2
d
m!
Cor
Â·
d
m=0
(where
Î¶rSS
is
as
in
Chapter
VII,
Â§6).
Thus,
in
particular,
if
we
think
of
Î¶rSS
as
a
section
â€ 
of
the
line
bundle
LÏ‡sc
on
Esc
corresponding
to
Ï‡
(cf.
Chapter
VII,
Â§6)
over
Esc
,
then
the
leading
term
of
Î¶rSS
,
i.e.,
the
image
of
Î¶rSS
in
(F
r+1
/F
r
)(R
â€ 
)
âŠ—OEsc
LÏ‡sc
,
is
equal
to
a
unimodular
multiple
(i.e.,
S1
âŠ†
CÃ—
-multiple)
of
Esc
1
1
âŠ—r
âŠ—r
Â·
Î˜âŠ—r
r
Â·
Î˜DR,sc
=
DR,or
=
Î˜SW,or
r
r
Â·
d2
Cor
Cor
while
the
norm
of
Î¶rSS
with
respect
to
the
metric
â€œ||
âˆ¼
||L2DR
â€
of
Chapter
VII,
Â§4,5,
which
we
denote
here
by
||
âˆ¼
||DR,sc
,
satisï¬es
(by
Chapter
VII,
Corollary
5.4,
and
the
fact
that
1
1
dr
â‰¤
r!
):
e
||Î¶rSS
||DR,sc
â‰¤
||Î¶0SS
||DR,sc
Â·
Ï€
r!
Â·

8Ï€
Â·
r
Â·
d

r2
Im(Ï„or
)
320
=
||Î¶0SS
||DR,sc
Â·
eÏ€
Â·

8Ï€
23
r
(r
Â·
d)
r2
Â·
Cor
r!
Finally,
by
Chapter
VII,
Lemma
6.5
(where
we
take
â€œP
(âˆ’)â€
to
be
1,
and
change
the
def
1
2
variable
of
integration
from
â€œkâ€
to
x
=
{
2Ï€
d
Â·
Im(Ï„or
)}
Â·
k),
we
have:
||Î¶0SS
||2DR,sc
=
e
d
Â·Im(Ï„or
)Â·(iÏ‡
/n)
Â·
2
2Ï€
=e
2
8Ï€
2
4Ï€d
Â·Im(Ï„or
)Â·(iÏ‡
/n)


12
4Ï€
Â·
d
8Ï€
2
Â·
Im(Ï„or
)
eâˆ’x
dx
2
R
âˆ’1
2
2
Â·
(4Ï€
Â·
d)
Â·
Cor
Â·
Ï€
=
2Ï€
Â·
(d/Cor
)
Â·e
1
2
1
2
1
(Cor
Â·iÏ‡
/n)2
8Ï€d
(r
Â·
d)
2
Â·
(50/Cor
)
Â·
r!
(Cor
Â·iÏ‡
/n)2
4Ï€d
Thus:
2
14
)
Â·e
||Î¶rSS
||DR,sc
â‰¤
100
Â·
(d/Cor
r
r
In
the
following
discussion,
we
would
like
to
think
of
the
metric
||
âˆ¼
||DR,sc
,
as
well
as
the
metrics
||
âˆ¼
||Tch
;
||
âˆ¼
||w,Î¼a
of
Â§2,
as
being
metrics
on
the
space
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
R
â€ 
),
Esc
which
we
think
of
as
the
subspace
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
R
â€ 
)
â†’
L2
((S1
)sc
)
Esc
i
(where
the
map
â€œâ†’â€
is
obtained
by
dividing
by
the
trivialization
â€œUcvÏ‡
Â·
Î¸
m
â€)
generated
by
Î¶0SS
,
.
.
.
,
Î¶rSS
,
.
.
.
(i.e.,
Î¶0SS
and
its
derivatives).
On
the
other
hand,
let
us
write
||
âˆ¼
||SS
for
the
metric
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
R
â€ 
)
for
which
the
Î¶rSS
are
orthonormal.
Then
by
Chapter
VII,
Theorem
5.3,
we
have:

d
12
r
Cor

[r/2]
Â·
Î¶rDR
|(S1
)sc
=
drâˆ’m
Â·
(âˆ’Ï€
Â·
u)m
SS
Â·
Î¶râˆ’2m
|(S1
)sc
2m
Â·
m!
Â·
(r
âˆ’
2m)!
C
or
m=0
which
shows
that
(for
r
<
d)

d
12
r
Cor

[r/2]
Â·
||Î¶rDR
||SS
â‰¤
e3d
Â·
Ï€m
2
â‰¤
e3d
Â·
r
Â·
{1
+
(Ï€/Cor
)}r
2m
Cor
m=0
(where
we
use
that


drâˆ’m
râˆ’m
drâˆ’m
drâˆ’m
â‰¤
Â·
â‰¤
2r
Â·
m
m!(r
âˆ’
2m)!
(r
âˆ’
m)!
(r
âˆ’
m)!
râˆ’m
d
â‰¤
e2r+d
â‰¤
e3d
â‰¤
e2r
Â·
(r
âˆ’
m)râˆ’m
321
Esc
by
Chapter
VII,
Lemmas
3.5,
3.6).
Since,
by
Chapter
VII,
Corollary
4.6,
Lemma
6.5,
we
have:
||Î¶rDR
||DR,sc
â‰¥

(2Ï€)r

12
r!
Â·
||Î¶0DR
||DR,sc
=

(2Ï€)r

12
r!
Â·e
(Cor
Â·iÏ‡
/n)2
8Ï€d
1
1
2
4
Â·
(2Ï€)
2
Â·
(d/Cor
)
we
obtain:
(Cor
Â·iÏ‡
/n)2
8Ï€d
1
1
1
(r!)
2
2
r+
2
Â·
r
Â·
{1
+
(Ï€/C
2
)}r
Â·
e3d
Â·
r
Â·
(Cor
/d
)
or
(2Ï€)
2
1/2

âˆ’1
r
(C
Â·iÏ‡
/n)2
r
Â·
Cor
âˆ’
or8Ï€d
âˆ’r
12
Cor
+
Ï€
Â·
Cor
â‰¤e
Â·
(r!
Â·
d
)
Â·
Â·
e3d
1
1
(2Ï€)
2
d4
DR
âˆ’
||Î¶rDR
||âˆ’1
DR,sc
Â·
||Î¶r
||SS
â‰¤
e
Thus,
in
summary:
Lemma
6.1.
For
r
â‰¤
d,
the
metrics
||
âˆ¼
||DR,sc
,
||
âˆ¼
||SS
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))
Esc
satisfy:
e
(Cor
Â·iÏ‡
/n)2
âˆ’3d
8Ï€d

r
3
(2Ï€)
2
1/2
âˆ’1
Â·
(d
/r!)
Â·
Â·
(d
4
Â·
r
Â·
Cor
)
Â·
||
âˆ¼
||SS
â‰¤
||
âˆ¼
||DR,sc
âˆ’1
Cor
+
Ï€
Â·
Cor
r
(Cor
Â·iÏ‡
/n)2
(r
Â·
d)
2
2
14
Â·
(50/Cor
)r
Â·
100
Â·
(d5
/Cor
â‰¤
e
8Ï€d
Â·
)
Â·
||
âˆ¼
||SS
r!
r
1
2
1
Proof.
This
follows
immediately
from
the
above
inequalities:
Indeed,
if
||Ï†||SS
â‰¤
1
(where
Ï†
âˆˆ
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))),
then
Ï†
may
be
written
as
a
linear
combination
of
the
Esc
SS
Î¶r
with
complex
coeï¬ƒcients
â‰¤
1.
Thus,
||Ï†||DR,sc
may
be
bounded
using
the
bound
for
||Î¶rSS
||DR,sc
obtain
above.
Similarly,
if
||Ï†||DR,sc
â‰¤
1,
then
Ï†
may
be
written
as
a
linear
DR
combination
of
the
||Î¶rDR
||âˆ’1
with
complex
coeï¬ƒcients
â‰¤
1.
Thus,
||Ï†||SS
may
be
DR,sc
Â·
Î¶r
DR
âˆ’1
bounded
using
the
bound
for
||Î¶r
||DR,sc
Â·
||Î¶rSS
||SS
obtain
above.

Remark.
Note
that
(for
r
â‰¤
d),
we
have:
(dr
/r!)
2
Â·
dâˆ’2
Â·
eâˆ’3d
â‰¥
eâˆ’4d
1
r
r
r
d
(r
Â·
d)
2
er
Â·
(r
Â·
d)
2
Â·
d2
â‰¤
Â·
d2
â‰¤
er
Â·
(d/r)
2
Â·
d2
â‰¤
er
Â·
d2
Â·
e
2
â‰¤
e2d
r
r!
r
322
d
(cf.
Chapter
VII,
Lemmas
3.5,
3.6),
where
we
use
that
d2
â‰¤
e
2
since
d
â‰¥
10.
It
thus
follows
that:
If
Ï„or
is
restricted
to
vary
in
a
compact
subset
of
the
upper
half-plane,
then
||
âˆ¼
||SS
and
||
âˆ¼
||DR,sc
diï¬€er
from
each
other
by
a
factor
â‰¤
constant
Â·
e4d
.
In
fact,
even
if
Ï„or
is
not
restricted
to
vary
inside
a
compact
set,
the
â€œconstantâ€
in
this
statement
is
bounded
by
(some
absolute
constant)d
times
e
in
particular,
that:
(Cor
Â·iÏ‡
/n)2
8Ï€d
âˆ’1
d
Â·
(Cor
+
Cor
)
.
Note,
Despite
the
fact
that
the
â€œleading
termâ€
of
Î¶rSS
(cf.
the
above
discussion)
âŠ—r
SS
goes
like
C1r
Â·
Î˜âŠ—r
DR,or
=
Î˜SW,or
,
the
absolute
value
of
Î¶r
with
respect
or
to
||
âˆ¼
||DR,sc
(a
norm
which
is
based
on
a
Î˜DR,sc
-type
scaling
of
R
â€ 
,
Esc
not
a
Î˜DR,or
-type
scaling!)
goes
(at
least
for
compactly
varying
Im(Ï„or
),
and
up
to
a
factor
of
constant
Â·
e4d
)
like
â‰ˆ
1.
r
This
discrepancy
of
roughly
a
factor
d
2
(when
Im(Ï„or
)
varies
compactly)
in
the
portion
1
of
torsorial
degree
r,
i.e.,
a
scaling
factor
of
d
2
,
is
the
phenomenon
of
analytic
torsion
â€“
1
r
cf.
Remark
1
following
Chapter
VII,
Corollary
4.6,
which
concerns
a
factor
of
(r!)
2
â‰ˆ
d
2
(as
r
â†’
d)
in
the
portion
of
torsorial
degree
r.
This
analytic
torsion
may
be
regarded
as
1
the
analogue
at
the
inï¬nite
prime
of
the
factors
of
r!
that
must
be
added
to
the
integral
structure
of
the
portion
of
torsorial
degree
r
in
the
ï¬nite
prime
case
(cf.,
e.g.,
Chapter
V,
Theorem
3.1).
Next,
we
would
like
to
recall
from
Â§2
the
relationship
between
||
âˆ¼
||SS
and
||
âˆ¼
||Tch
.
First,
let
us
recall
from
the
ï¬rst
part
of
the
proof
of
Lemma
2.1
that
if
||Ï†||Tch
=
1
(for
Ï†
âˆˆ
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
)),
r
â‰¤
d),
then
Ï†
may
be
written
as
a
linear
combination
of
Esc
the
Î¶rSS

(where
r
<
r)
with
complex
coeï¬ƒcients
of
absolute
value
7
â‰¤
r
2
Â·
e4r
Thus,
we
conclude
that
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))
(where
r
â‰¤
d),
we
have:
Esc
9
||
âˆ¼
||SS
â‰¤
r
2
Â·
e4r
Â·
||
âˆ¼
||Tch
On
the
other
hand,
from
the
deï¬nition
of
||
âˆ¼
||Tch
,
we
have
1
||Î¶rSS
||2Tch
=
Â·
d
dâˆ’1
!
!2r

!
!
!(j/d)
âˆ’
ld
!
j=0
dâˆ’1
1

â‰¤
Â·
1=1
d
j=0
323
where
ld
is
as
in
Â§2,
hence
satisï¬es
0
â‰¤
ld
â‰¤
12
.
Thus,
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))
(where
Esc
r
â‰¤
d),
we
have:
||
âˆ¼
||Tch
â‰¤
r
Â·
||
âˆ¼
||SS
We
summarize
this
as
follows:
For
r
â‰¤
d,
the
metrics
||
âˆ¼
||Tch
,
||
âˆ¼
||SS
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))
Lemma
6.2.
Esc
satisfy:
r
âˆ’1
Â·
||
âˆ¼
||Tch
â‰¤
||
âˆ¼
||SS
â‰¤
r
2
Â·
e4r
Â·
||
âˆ¼
||Tch
9
while
the
metrics
||
âˆ¼
||Tch
,
||
âˆ¼
||DR,sc
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))
satisfy:
Esc
e
(Cor
Â·iÏ‡
/n)2
âˆ’3d
8Ï€d
r
3
(2Ï€)
2
1/2
âˆ’1
Â·
(d
/r!)
Â·
Â·
(d
4
Â·
r
2
Â·
Cor
)
Â·
||
âˆ¼
||Tch
âˆ’1
Cor
+
Ï€
Â·
Cor
â‰¤
||
âˆ¼
||DR,sc
r

1
2
1
â‰¤e
(Cor
Â·iÏ‡
/n)2
8Ï€d
r
1
(r
Â·
d)
2
Â·
(e8
/Cor
)r
Â·
100
Â·
(d12
/Cor
)
2
Â·
||
âˆ¼
||Tch
Â·
r!
Finally,
the
metrics
||
âˆ¼
||w,Î¼a
(cf.
Â§2),
||
âˆ¼
||DR,sc
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))
satisfy:
Esc
e
(Cor
Â·iÏ‡
/n)2
âˆ’3d
8Ï€d
1

r
(2Ï€)
2
1/2
âˆ’1
Â·
(d8
Â·
Cor
)
Â·
||
âˆ¼
||w,Î¼a
âˆ’1
4
2
e
Â·
a
Â·
(Cor
+
Ï€
Â·
Cor
)
â‰¤
||
âˆ¼
||DR,sc
Â·
(dr
/r!)
2
Â·
â‰¤e
1
(Cor
Â·iÏ‡
/n)2
8Ï€d
r
1
(r
Â·
d)
2
Â·
Â·
(e8
/Cor
)r
Â·
200
Â·
(d12
/Cor
)
2
Â·
||
âˆ¼
||w,Î¼a
r!
where
a
is
a
positive
integer
satisfying
a
â‰¥
8
+
(
Ï€4
Â·
Im(Ï„or
))âˆ’1
.
Remark.
Thus,
stated
in
words,
the
above
Lemma
asserts
that:
When
Im(Ï„or
)
varies
compactly,
||
âˆ¼
||DR,sc
and
||
âˆ¼
||w,Î¼a
diï¬€er
by
at
most
a
factor
of
(constant)d
.
Thus,
||
âˆ¼
||DR,sc
;
||
âˆ¼
||SS
;
||
âˆ¼
||Tch
;
||
âˆ¼
||w,Î¼a
belong
to
â€œthe
same
equivalence
classâ€
â€“
i.e.,
in
the
sense
that
when
Im(Ï„or
)
varies
compactly,
they
diï¬€er
by
at
most
a
factor
of
(constant)d
.
324
Similarly,
we
may
recall
the
relationship
between
||
âˆ¼
||SS
and
the
Î¶rCG
,
as
follows.
Let
us
write
||
âˆ¼
||CG
(respectively,
||
âˆ¼
||qCG
)
âˆ’Î¨(k[r])
for
the
metric
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
d
(R
â€ 
))
for
which
the
Î¶rCG
(respectively,
qsc
Esc
Â·Î¶rCG
â€“
notation
of
Â§3,4,5),
where
r
=
0,
.
.
.
,
d
âˆ’
1,
are
orthonormal.
Recall
from
the
proof
of
Chapter
VII,
Lemma
6.2
(i.e.,
in
essence,
Chapter
VII,
Proposition
3.3),
that
Î¶rCG
is
a
linear
combination
of
Î¶0SS
,
.
.
.
,
Î¶rSS
with
complex
coeï¬ƒcients
of
absolute
value
â‰¤
e2r+d
.
Thus,
||Î¶rCG
||SS
â‰¤
(r
+
1)
Â·
e3d
In
particular,
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))
(where
r
â‰¤
d),
we
have:
Esc
||
âˆ¼
||SS
â‰¤
r
2
Â·
e3d
Â·
||
âˆ¼
||CG
On
the
other
hand,
if
we
consider
a
linear
combination
of
Î¶0CG
,
.
.
.
,
Î¶rCG
whose
||
âˆ¼
||Tch
=
dâˆ’1
,
then
we
see
that
the
issue
of
bounding
the
coeï¬ƒcients
of
such
a
linear
combination
is
exactly
the
same
as
the
situation
considered
in
Â§3,
except
with
|qsc
|
=
1.
(Indeed,
note
that
if
we
set
|qsc
|
=
1,
then
in
the
context
of
Â§3,
||
âˆ¼
||Tch
=
dâˆ’1
means
that
the
usual
L2
((S1
)sc
)-norm
of
the
corresponding
linear
combination
of
Z0CG
,
.
.
.
,
ZrCG
is
=
1.)
Thus,
by
specializing
what
we
did
in
Â§3
to
the
case
where
|qsc
|
=
1,
we
see
that
the
coeï¬ƒcients
of
this
linear
combination
are
bounded
by
a
sum
of
4r
terms,
each
of
which
has
absolute
value
â‰¤
r
2r
(cf.
the
bounding
of
the
â€œbinomial
coeï¬ƒcient
portion
of
the
C[r,
r1
]
Â·
C[r1
,
r2
]
Â·
.
.
.
Â·
C[rjâˆ’1
,
rj
]â€
in
Â§3).
Thus,
the
coeï¬ƒcients
of
the
linear
combination
under
consideration
have
absolute
value
â‰¤
4r
Â·
r
2r
.
In
particular,
we
obtain
that
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))
(where
r
â‰¤
d),
we
have:
Esc
||
âˆ¼
||CG
â‰¤
r
Â·
4r
Â·
r
2r
Â·
d
Â·
||
âˆ¼
||Tch
Finally,
the
leading
term
of
Î¶rCG
is
equal
to
the
leading
term
of
Î¶rPD
.
That
is,
in
summary:
Lemma
6.3.
For
r
â‰¤
d,
the
metrics
||
âˆ¼
||CG
,
||
âˆ¼
||SS
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))
Esc
satisfy:
dâˆ’1
Â·
4âˆ’r
Â·
r
âˆ’2râˆ’2
Â·
||
âˆ¼
||CG
â‰¤
||
âˆ¼
||SS
â‰¤
r
2
Â·
e3d
Â·
||
âˆ¼
||CG
325
and
(for
0
â‰¤
r
â‰¤
d
âˆ’
1)
Î¶rCG
has
the
same
leading
term
(i.e.,
image
in
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
r
(F
r+1
/F
r
)(R
â€ 
)))
as
dr!
Â·
Î¶rSS
.
On
the
other
hand,
(for
r
â‰¤
d)
the
metrics
||
âˆ¼
||CG
,
Esc
||
âˆ¼
||DR,sc
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
r
(R
â€ 
))
satisfy:
Esc
e
(Cor
Â·iÏ‡
/n)2
âˆ’3d
8Ï€d
Â·
(dr
/r!)
2
Â·
r
âˆ’2râˆ’2
Â·
1

r
(2Ï€)
2
1/2
âˆ’1
Â·
(d2
Â·
r
Â·
Cor
)
Â·
||
âˆ¼
||CG
âˆ’1
4(Cor
+
Ï€
Â·
Cor
)
1
â‰¤
||
âˆ¼
||DR,sc
â‰¤e
r
1
(r
Â·
d)
2
Â·
(e7
/Cor
)d
Â·
100
Â·
(d7
/Cor
)
2
Â·
||
âˆ¼
||CG
Â·
r!
(Cor
Â·iÏ‡
/n)2
8Ï€d
and
(for
0
â‰¤
r
â‰¤
d
âˆ’
1)
Î¶rCG
has
the
same
leading
term
(i.e.,
image
in
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
r
(F
r+1
/F
r
)(R
â€ 
)))
as
Cdr
2Â·r!
Â·
Î¶rDR
.
Esc
or
Remark.
Thus,
stated
in
words,
the
above
Lemma
asserts
that:
When
Im(Ï„or
)
varies
compactly,
the
||Î¶rCG
||DR,sc
are
bounded
by
a
factor
of
(constant)d
,
but
if
one
expands
Î¶rCG
in
terms
of
an
orthonormal
basis
for
||
âˆ¼
||DR,sc
,
the
resulting
coeï¬ƒcients
have
rather
large
absolute
values,
i.e.,
of
the
order
dconstantÂ·d
.
Put
another
way,
whereas
||
âˆ¼
||DR,sc
;
||
âˆ¼
||SS
;
||
âˆ¼
||Tch
;
||
âˆ¼
||w,Î¼a
belong
to
â€œthe
same
equivalence
classâ€
â€“
i.e.,
in
the
sense
that
when
Im(Ï„or
)
varies
compactly,
they
diï¬€er
by
at
most
a
factor
of
(constant)d
â€“
the
metric
||
âˆ¼
||CG
lies
outside
this
equivalence
class.
That
is
to
say,
it
is
bounded
below
by
metrics
in
this
equivalence
class,
but
not
above.
Moreover,
this
obstruction
to
bounding
it
above
by
metrics
in
the
said
equivalence
class
arises
not
from
letting
the
elliptic
curve
in
question
degenerate,
but
from
the
combinatorial
portion
of
the
coeï¬ƒcients
involved.
Finally,
we
consider
the
Hermite
model.
Let
us
write
||
âˆ¼
||HMd
for
the
metric
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
d
(R
â€ 
))
for
which
Esc
||P
(Î´
âˆ—
)
Â·
Î¶0
||2HMd
=
def
def
R
!
!2
2
1
!
!
!P
(s)!
Â·
eâˆ’
2
(s/Î³d
)
Â·
ds
1
HMd
where
Î³d
=
{d/4Ï€Â·Im(Ï„or
)}
2
(as
in
Chapter
VII,
Theorem
6.7).
Thus,
the
Î¶0HMd
,
.
.
.
,
Î¶dâˆ’1
(of
Chapter
VII,
Theorem
6.7)
are
orthogonal
for
||
âˆ¼
||HMd
,
and
Î³dâˆ’1
Â·
||Î¶rHMd
||2HMd
=
326
1
(2Ï€)
2
Â·
r!.
Recall
that
the
Î¶rHMd
are
the
canonical
zeta
functions
associated
to
the
(scaled)
Hermite
polynomials
Hr
(s/Î³d
)
where
Hr
(âˆ’)
is
as
in
Chapter
VII,
Proposition
2.2.
Let
us
write
||
âˆ¼
||R,sc
for
the
metric
on
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
d
(R
â€ 
))
denoted
by
||
âˆ¼
||L2
(Esc
)
in
Chapter
VII,
Â§6,
Esc
and
by
||
âˆ¼
||L2R
in
Chapter
VII,
Â§4.
Note
that
2
2Ï€
||Î¶0SS
||2R,sc
=
||Î¶0SS
||2DR,sc
=
e
d
Â·Im(Ï„or
)Â·(iÏ‡
/n)
Â·


12
1
d
(2Ï€)
2
4Ï€
Â·
Im(Ï„or
)
2
=
(2Ï€)
2
Â·
Î³d
Â·
e
d
Â·Im(Ï„or
)Â·(iÏ‡
/n)
1
2Ï€
(cf.
the
discussion
preceding
Lemma
6.1),
and
!!

!!
!!
2
1
2Ï€
r!

DR
!!!!2
Â·
Î¶r
!!
=
r!
Â·
||Î¶0DR
||2R,sc
=
(2Ï€)
2
Â·
r!
Â·
Î³d
Â·
e
d
Â·Im(Ï„or
)Â·(iÏ‡
/n)
r
R,sc
(2Ï€)
2
(cf.
Chapter
VII,
Theorem
4.5).
Now,
if
we
write
||Î¶||et
0
1
dâˆ’1
(as
in
Theorem
5.8)
for
the
L2
(Î¼d
)
norm
(i.e.,
the
norm
for
which
Usc
,
Usc
,
.
.
.
,
Usc
âˆ’iÏ‡
are
orthonormal)
of
the
function
(Ucv
Â·
Î¶)|Î¼d
âŠ†(S1
)sc
,
then
we
obtain
from
Chapter
VII,
Theorem
6.7,
that:
Lemma
6.4.
If
we
ï¬x
a
nonnegative
integer
r
â‰¤
d
and
let
d
â†’
âˆ,
then
on
Ï‡
r
Î“(Esc
,
Lsc
âŠ—OEsc
F
(R
â€ 
)),
we
have:
Esc
âˆ’1
lim
Î³d
2
Â·
||
âˆ¼
||et
=
dâ†’âˆ
âˆ’1
lim
Î³d
2
Â·
||
âˆ¼
||HMd
=
dâ†’âˆ
âˆ’1
lim
Î³d
2
Â·
||
âˆ¼
||R,sc
dâ†’âˆ
(where
all
three
sides
are
ï¬nite)
and
||
âˆ¼
||R,sc
â‰¤
||
âˆ¼
||DR,sc
â‰¤
eÏ€+r
Â·
||
âˆ¼
||R,sc
.
327
Proof.
Note
that
the
inequalities
relating
||
âˆ¼
||R,sc
and
||
âˆ¼
||DR,sc
result
from
Chapter
VII,
Corollary
4.6
(for
Ï
=
1).

Â§7.
The
Comparison
Isomorphism
at
the
Inï¬nite
Prime
In
this
Â§,
we
complete
the
proof
of
a
theorem,
which
is
the
main
theorem
of
this
paper,
concerning
the
behavior
of
the
comparison
isomorphism
of
Chapter
VI,
Theorem
3.1,
at
all
the
primes
of
a
number
ï¬eld.
The
behavior
of
this
comparison
isomorphism
at
ï¬nite
primes
is
discussed
in
Chapter
VI,
Theorem
4.1;
the
behavior
of
this
comparison
isomorphism
at
archimedean
primes
is
the
general
topic
of
Chapter
VII
and
the
present
Chapter.
We
refer
to
the
result
which
encompasses
integrality
issues
at
all
primes
of
a
number
ï¬eld
as
the
Hodge-Arakelov
Comparison
Isomorphism
(cf.
the
Introduction
to
this
Chapter).
In
the
present
Â§,
we
complete
the
archimedean
portion
of
this
result,
which
consists
of
showing
that
the
natural
metrics
on
the
function
spaces
of
â€œde
Rham
functionsâ€
and
â€œeÌtale
functionsâ€
are
close
to
one
another
in
three
senses.
These
three
senses
correspond,
respectively,
to
the
Hermite,
Legendre,
and
Binomial
Models
treated
in
Chapter
VII
and
the
present
Chapter.
def
We
continue
with
the
notation
of
Â§5.
Write
LÏ‡or
=
LÏ‡sc
|Eor
.
Thus,
LÏ‡or
is
a
line
bundle
of
degree
d
on
Eor
.
Let
def
G
=
GLÏ‡or
be
the
theta
group
associated
to
this
line
bundle
(cf.
Chapter
IV,
Â§1).
Let
us
write
GS1
âŠ†
G
for
the
maximal
compact
subgroup.
Thus,
we
have
an
exact
sequence
0
â†’
S1
â†’
GS1
â†’
KLÏ‡or
â†’
0
Note
that
the
kernel
of
Eor
â†’
Esc
,
together
with
the
line
bundle
LÏ‡sc
,
deï¬ne
a
Lagrangian
subgroup
(cf.
Chapter
IV,
the
Remark
following
Theorem
1.4)
H
âŠ†
G.
Suppose
that
V
is
an
irreducible
C[G]-module
(such
that
Gm
âŠ†
G
acts
on
V
in
the
usual
fashion).
Thus,
V
is
a
d-dimensional
complex
vector
space,
and
the
subspace
of
H-invariants
V
H
âŠ†
V
is
a
1-dimensional
complex
subspace.
Let
v
âŠ†
V
H
be
nonzero.
Lemma
7.1.
There
exists
a
unique
GS1
-invariant
Hermitian
metric
(âˆ’,
âˆ’)
on
V
such
that
(v,
v)
=
1.
328
Proof.
Write
KH
âŠ†
KLÏ‡or
for
the
image
of
H
in
KLÏ‡or
.
Let
H
âŠ†
G
be
a
ï¬nite
cyclic
subgroup
of
order
d
with
the
property
that
the
image
KH

of
H
in
KLÏ‡or
is
such
that
KLÏ‡or
=
KH
Ã—
KH

.
(It
is
not
diï¬ƒcult
to
see
that
such
an
H
always
exists
â€“
cf.,
e.g.,
Chapter
IV,
Example
1.2).
Since
V
is
irreducible,
it
follows
(cf.
Chapter
IV,
Example
1.2)
that
V
=

C
Â·
g(v)
gâˆˆH

def
def
For
g,
g
âˆˆ
H
such
that
g
=
g
,
deï¬ne
(g(v),
g(v))
=
1,
(g(v),
g
(v))
=
0.
This
gives
us
a
well-deï¬ned
metric
(âˆ’,
âˆ’)
on
V
.
On
checks
easily
that
this
metric
is
H
-invariant.
Because
of
the
well-known
structure
of
G,
(cf.
Chapter
IV,
Â§1),
it
follows
that
if
g
âˆˆ
H,
g
âˆˆ
H
,
then
g(g
(v))
=
Î»
Â·
g
(g(v))
=
Î»
Â·
g
(v),
where
Î»
âˆˆ
S1
âŠ†
CÃ—
.
Thus,
it
is
clear
that
H
also
preserves
this
metric.
Thus,
it
follows
that
this
metric
is
GS1
-invariant.
Uniqueness
follows
from
the
fact
that
V
is
irreducible
as
an
GS1
-module.

Lemma
7.2.
Let
{M
;
(âˆ’,
âˆ’)M
}
be
a
pair
consisting
of
a
GS1
-module
M
and
a
GS1
invariant
metric
(âˆ’,
âˆ’)M
on
M
.
Then
the
correspondence
def
{M
;
(âˆ’,
âˆ’)M
}
â†’
{M
H
;
(âˆ’,
âˆ’)M
H
=
(âˆ’,
âˆ’)M
|M
H
}
given
by
taking
H-invariants
is
an
equivalence
of
categories
(cf.
Chapter
IV,
Theorem
1.4)
between
the
category
of
ï¬nite
dimensional
(i.e.,
over
C)
C[GS1
]-modules
equipped
with
GS1
invariant
Hermitian
metrics
and
the
category
of
ï¬nite
dimensional
complex
vector
spaces
equipped
with
Hermitian
metrics.
Proof.
Indeed,
the
functor
â€œâ†’â€
is
clearly
well-deï¬ned.
If
{N
;
(âˆ’,
âˆ’)N
}
is
a
ï¬nite
dimensional
complex
vector
space
equipped
with
a
Hermitian
metric,
and
{V
;
(âˆ’,
âˆ’)V
}
is
a
C[GS1
]-module
as
in
Lemma
7.1
equipped
with
the
metric
of
Lemma
7.1
(relative
to
some
v
âˆˆ
V
H
),
then
N
âŠ—C
V
admits
a
natural
structure
of
GS1
-module
(where
g
âˆˆ
GS1
acts
by
g(Î±
âŠ—
Î²)
=
Î±
âŠ—
g(Î²),
for
Î±
âˆˆ
N
,
Î²
âˆˆ
V
),
as
well
as
a
natural
metric
(obtained
by
tensoring
(âˆ’,
âˆ’)N
with
(âˆ’,
âˆ’)V
),
which
is
clearly
GS1
-invariant.
Moreover,
it
is
clear
that
â€œâ†’â€
associates
{N
âŠ—
V
;
(âˆ’,
âˆ’)N
âŠ—V
}
to
the
pair
{N
;
(âˆ’,
âˆ’)N
}.
Since
maps
between
â€œ{N
;
(âˆ’,
âˆ’)N
}â€™sâ€
clearly
induce
maps
between
â€œ{N
âŠ—
V
;
(âˆ’,
âˆ’)N
âŠ—V
}â€™s,â€
we
thus
see
that
the
functor
â€œâ†’â€
is
full
and
essentially
surjective.
Faithfulness
follows
from
Chapter
IV,
Theorem
1.4.

Thus,
applying
Lemma
7.2
shows
that
the
various
metrics:
||
âˆ¼
||DR,sc
;
||
âˆ¼
||R,sc
;
329
||
âˆ¼
||SS
;
||
âˆ¼
||Tch
||
âˆ¼
||w,Î¼a
;
||
âˆ¼
||et
;
||
âˆ¼
||CG
;
||
âˆ¼
||qCG
on
the
space
Î“(Esc
,
LÏ‡sc
âŠ—OEsc
F
d
(R
â€ 
))
that
we
discussed
in
Â§5,
6
naturally
deï¬ne
metrics
Esc
on
the
space
Î“(Eor
,
LÏ‡or
âŠ—OEsc
F
d
(R
â€ 
)).
(By
abuse
of
notation)
we
shall
denote
the
Esc
resulting
metrics
on
Î“(Eor
,
LÏ‡or
âŠ—OEsc
F
d
(R
â€ 
))
by
the
same
names.
Esc
â€ 
â€ 
Note
that
the
morphism
Eor
â†’
Esc
considered
in
Â§6
deï¬nes
an
isomorphism
â€ 
â€ 
Ã—
E
Eor,[d]
âˆ¼
=
Esc
Esc
or
â€ 
(where
Eor,[d]
is
as
in
Chapter
V,
Â§2)
which,
if
we
identify
Ï‰Eor
with
Ï‰Esc
via
Î¹diï¬€
(cf.
â€ 
the
discussion
at
the
beginning
of
Â§6),
induces
an
isometry
between
Ï‰Eor
âŠ†
Eor,[d]
and
â€ 
Ï‰Eor
=
Ï‰Esc
âŠ†
Esc
Ã—Esc
Eor
â€“
i.e.,
both
may
be
identiï¬ed
naturally
with
â€œd
times
the
Ï‰Eor
âŠ†
â€ 
Eor
.â€
Thus,
we
may
naturally
identify
Î“(Eor
,
LÏ‡or
âŠ—OEsc
F
r
(R
â€ 
))
with
Î“(Eor
,
LÏ‡or
âŠ—OEor
Esc
F
r
(R
â€ 
)).
Note,
moreover,
that
these
spaces
Î“(Eor
,
LÏ‡or
âŠ—OEor
F
r
(R
â€ 
))
are
exactly
Eor,[d]
Eor,[d]
the
spaces
the
appear
in
the
domain
of
the
evaluation
map
of
Chapter
VI,
Theorem
4.1,
(2)
(when
applied
to
Eor
).
def
Next,
let
us
consider
the
action
of
Z
on
H
=
{Ï„
âˆˆ
C
|
Im(Ï„
)
>
0}
deï¬ned
by
letting
1
âˆˆ
Z
act
as
Ï„
â†’
Ï„
+
1.
Write
def
Tâˆ
=
H/Z
def
for
the
quotient
of
H
by
this
action.
Thus,
the
function
q
=
exp(2Ï€iÏ„
)
deï¬nes
a
biholomorphic
isomorphism
of
Tâˆ
with
the
punctured
unit
disk
{z
âˆˆ
C
|
0
<
|z|
<
1}.
In
the
present
context,
we
would
like
to
think
of
Tâˆ
as
a
covering
space
of
the
analytic
stack
an
M1,0
=
H/SL2
(Z)
(where
the
quotient
H/SL2
(Z)
is
the
quotient
of
H
by
the
standard
action
of
SL2
(Z)
in
the
sense
of
analytic
stacks).
Then
let
us
observe
that
as
the
moduli
of
Eor
vary
(i.e.,
where
take
â€œqâ€
in
the
preceding
paragraph
to
be
qor
),
the
metrics
deï¬ned
above
all
descend
naturally
from
H
to
Tâˆ
.
(Indeed,
this
follows
immediately
from
the
deï¬nitions.)
Moreover,
I
claim
that:
an
The
metrics
||
âˆ¼
||DR,sc
;
||
âˆ¼
||R,sc
;
||
âˆ¼
||et
descend
naturally
to
M1,0
.
Indeed,
||
âˆ¼
||R,sc
is
deï¬ned
by
using
the
canonical
real
analytic
section
(Îºsc
)R
:
(Esc
)R
â†’
â€ 
â€ 
(Esc
)R
(which
deï¬nes
a
real
analytic
splitting
of
R
â€ 
)
to
restrict
sections
of
LÏ‡sc
over
Esc
Esc
330
to
sections
over
LÏ‡sc
.
On
the
other
hand,
one
checks
easily
(for
instance,
by
considering
â€ 
torsion
points)
that
the
canonical
real
analytic
splitting
(Îºor
)R
:
(Eor
)R
â†’
(Eor
)R
is
â€ 
â€ 
compatible
with
(Îºsc
)R
with
respect
to
the
natural
morphism
Eor
â†’
Esc
.
Moreover,
(Îºor
)R
an
manifestly
descends
from
H
to
M1,0
.
On
the
other
hand,
the
metric
with
translationinvariant
curvature
on
LÏ‡sc
(that
was
used
in
Chapter
VII,
Â§4)
pulls
back
to
a
metric
with
translation-invariant
curvature
on
LÏ‡or
.
Since
metrics
with
translation-invariant
curvature
are
unique
up
to
multiplication
by
a
positive
real
number,
we
thus
see
that
such
a
metric
an
descends
from
H
to
M1,0
.
Thus,
in
summary,
all
the
ingredients
used
to
deï¬ne
||
âˆ¼
||R,sc
an
descend
naturally
to
M1,0
,
so
we
conclude
that
||
âˆ¼
||R,sc
itself
descends
naturally
to
an
M1,0
.
Similarly,
the
only
additional
object
used
to
deï¬ne
||
âˆ¼
||DR,sc
is
the
metric
on
Ï‰Esc
1
deï¬ned
in
Chapter
VII,
Â§4,
but
this
metric
is
equal
to
dâˆ’
2
times
the
analogously
deï¬ned
an
metric
on
Ï‰Eor
(which
manifestly
descends
to
M1,0
)
â€“
cf.
the
discussion
at
the
beginning
1
an
of
Â§6
involving
Î˜DR,sc
=
d
2
Â·
Î˜DR,or
.
Thus,
||
âˆ¼
||DR,sc
also
descends
naturally
to
M1,0
.
Finally,
the
metric
on
||
âˆ¼
||et
on
Î“(Eor
,
LÏ‡or
âŠ—OEor
F
r
(R
â€ 
))
is
clearly
equal
to
the
Eor,[d]
â€ 
metric
obtained
as
follows:
Since
we
have
a
natural
inclusion
d
Eor
âŠ†
Eor,[d]
of
the
d-torsion
â€ 
points
d
Eor
of
Eor
in
Eor,[d]
,
we
may
restrict
sections
s
âˆˆ
Î“(Eor
,
LÏ‡or
âŠ—OEor
F
r
(R
â€ 
))
to
Eor,[d]
Ï‡
d
Eor
to
obtain
sections
s|d
Eor
âˆˆ
Lor
|d
Eor
.
Then
||s||2et
=

1
Â·
d2
|s(Î±)|2
Î±âˆˆd
Eor
(where
|
âˆ¼
|
is
the
chosen
metric
on
LÏ‡or
with
translation-invariant
curvature),
which
an
manifestly
descends
to
M1,0
.
This
completes
the
proof
of
the
claim.
Next,
we
pause
to
take
a
closer
look
at
the
metric
||
âˆ¼
||R,sc
on
Î“(Eor
,
LÏ‡or
âŠ—OEor
F
r
(R
â€ 
)).
Note
that
we
have
a
natural
surjection:
Eor,[d]
Î“(Eor
,
LÏ‡or
âŠ—OEor
F
r+1
(R
â€ 
Eor,[d]
))
â†’
Î“(Eor
,
LÏ‡or
âŠ—OEor
(F
r+1
/F
r
)(R
â€ 
))
Eor,[d]
=
(d
Â·
Ï„Eor
)r
âŠ—
Î“(Eor
,
LÏ‡or
)
Moreover,
since
all
the
metrics
dealt
with
here
are
GS1
-invariant,
it
follows
that,
if
we
equip
d
Â·
Ï„Eor
with
its
natural
metric
(i.e.,
the
metric
for
which
Î˜DR,or
has
norm
dâˆ’1
),
then
the
metric
induced
by
||
âˆ¼
||R,sc
on
(d
Â·
Ï„Eor
)r
âŠ—
Î“(Eor
,
LÏ‡or
)
is
equal
to
some
constant
times
the
metric
induced
by
||
âˆ¼
||R,sc
on
Î“(Eor
,
LÏ‡or
).
By
Chapter
VII,
Theorem
4.5,
it
follows
that

12

r
3r
.
Since
(dâˆ’1
Â·
Î˜DR,or
/Î˜DR,sc
)r
=
dâˆ’
2
,
this
constant
is
(dâˆ’1
Â·
Î˜DR,or
/Î˜DR,sc
)r
Â·
r!
Â·
(2Ï€)
r!
we
thus
obtain:
331
Lemma
7.3.
We
have:
Metric
induced
by
||
âˆ¼
||R,sc
on
(d
Â·
Ï„Eor
)r
âŠ—
Î“(Eor
,
LÏ‡or
)

(2Ï€)r
Â·
r!

12
=
Metric
induced
by
Â·
||
âˆ¼
||R,sc
on
Î“(Eor
,
LÏ‡or
)
d3r
Remark.
The
meaning
of
Lemma
7.3
is
the
following:
We
saw
in
Chapter
VI,
Theorem
4.1,
that
at
ï¬nite
primes,
the
necessary
modiï¬cation
to
the
integral
structure
of
the
space
â€œ(d
Â·
Ï„Eor
)r
âŠ—
Î“(Eor
,
LÏ‡or
)â€
that
allows
one
to
obtain
an
exact
comparison
isomorphism
is
a
factor
of
(r!)âˆ’1
(cf.
Chapter
V,
Theorem
3.1).
Thus,
by
the
product
formula,
assuming
that
the
modiï¬cations
to
the
integral
structure
are
distributed
evenly
with
respect
to
r,
one
expects
that
the
modiï¬cation
to
the
integral
structure
to
â€œ(d
Â·
Ï„Eor
)r
âŠ—
Î“(Eor
,
LÏ‡or
)â€
at
the
inï¬nite
primes
should
be
of
the
order
of
(r!)âˆ’1
â‰ˆ
(d!)âˆ’1
(as
r
â†’
d)
(cf.
the
discussion
of
the
â€œFundamental
Combinatorial
Modelâ€
in
Chapter
VII,
Â§3,
especially
the
proof
of
Proposition
3.4).
On
the
other
hand,
Lemma
7.3
states
that
in
fact,
for
the
metric
||
âˆ¼
||R,sc
(hence
also
for
||
âˆ¼
||DR,sc
â€“
by
Lemma
6.4),
the
corresponding
modiï¬cation
to
the
integral
structure
is
roughly

(2Ï€)r
Â·
r!

12
d3r
â‰ˆ
(dâˆ’3r
Â·
r!)
2
â‰ˆ
(d!)âˆ’1
1
(where
we
ignore
factors
of
the
order
(constant)d
)
as
r
â†’
d.
Moreover,
let
us
recall
that
these
â€œmodiï¬cations
to
the
integral
structureâ€
are
also
known
as
analytic
torsion.
Thus,
in
summary:
Lemma
7.3
asserts
that
for
the
metrics
||
âˆ¼
||DR,sc
,
||
âˆ¼
||R,sc
,
the
resulting
analytic
torsion
at
the
inï¬nite
prime
is
roughly
the
same
as
the
analytic
torsion
that
one
would
expect
from
applying
the
product
formula
(of
elementary
number
theory)
to
the
analytic
torsion
at
the
ï¬nite
primes.
Put
another
way,
Lemma
7.3
is
the
analogue
for
general
smooth
elliptic
curves
of
Chapter
VII,
Proposition
3.4
(which,
in
eï¬€ect,
concerns
â€œdegenerate
elliptic
curvesâ€).
In
particular,
Lemma
7.3
leads
one
to
suspect
that:
The
metrics
||
âˆ¼
||DR,sc
,
||
âˆ¼
||R,sc
are
natural
(rough)
candidates
for
(at
least
the
â€œcombinatorialâ€
or
â€œarithmeticâ€
portion
â€“
i.e.,
the
portion
that
does
not
arise
from
allowing
the
elliptic
curve
in
question
to
degenerate
â€“
of)
the
integral
structure
on
Î“(Eor
,
LÏ‡or
âŠ—OEor
F
d
(R
â€ 
Eor,[d]
332
))
arising
from
the
â€œeÌtale
sideâ€
of
the
comparison
isomorphism,
i.e.,
the
metric
||
âˆ¼
||et
.
The
extensive
calculations
of
Chapter
VII
and
the
present
Chapter
imply
that
this
intuitive
argument
based
on
the
product
formula
does,
in
fact,
give
the
right
answer:
Theorem
7.4.
def
E
=
Gm
/q
Z
(The
Comparison
Isomorphism
at
the
Inï¬nite
Prime)
Let
(where
q
=
exp(2Ï€iÏ„
)
âˆˆ
Tâˆ
)
be
an
elliptic
curve
over
C.
Let
d,
m
â‰¥
1
be
def
integers
such
that
m
does
not
divide
d;
write
n
=
2m.
Let
def
L
=
OE
(d
Â·
[Î·])
â€ 
where
Î·
âˆˆ
E
is
a
point
of
order
equal
to
m.
Write
E[d]
for
the
result
of
pushing
forward
the
universal
extension
E
â€ 
â†’
E
of
E
by
the
map
Ï‰
â†’
Ï‰
given
by
multiplication
by
d.
E
E
Write
d
E
âŠ†
E
for
the
subscheme
of
d-torsion
points;
thus,
we
have
a
natural
inclusion
â€ 
d
E
âŠ†
E[d]
.
Consider
the
Comparison
Isomorphism
Î
:
Î“(E,
L
âŠ—OE
F
d
(R
â€ 
))
âˆ¼
=
L|d
E
E[d]
â€ 
â€ 
of
Chapter
VI,
Theorem
4.1
(given
by
restriction
sections
of
L
over
E[d]
to
d
E
âŠ†
E[d]
).
Choose
a
metric
|
âˆ¼
|L
on
L
whose
curvature
is
translation-invariant.
Let
us
regard
L|d
E
as
equipped
with
the
L2
-metric
deï¬ned
by
|
âˆ¼
|L
,
i.e.:
def
||s||2
=
1

Â·
|s(Î±)|2
d2
Î±âˆˆd
E
for
s
âˆˆ
L|d
E
.
Write
||
âˆ¼
||et
for
the
â€œeÌtale
metric,â€
i.e.,
the
metric
on
Î“(E,
L
âŠ—OE
F
d
(R
â€ 
))
induced
by
this
L2
-metric.
On
the
other
hand,
the
canonical
real
analytic
E[d]
â€ 
splitting
ÎºR
:
ER
â†’
(E[d]
)R
(i.e.,
the
unique
continuous
section
which
is
a
group
homomorphism)
deï¬nes
a
metric
||
âˆ¼
||R
on
Î“(E,
L
âŠ—OE
F
d
(R
â€ 
))
by
restricting
sections
of
E[d]
â€ 
holomorphic
sections
of
L
over
E[d]
to
real
analytic
sections
of
L
over
E,
where
one
has
the
L2
-metric:
def
|Îºâˆ—R
(s)|2L
Â·
dÎ¼
||s||2R
=
E
(where
s
âˆˆ
Î“(E,
L
âŠ—OE
F
(R
â€ 
)),
and
dÎ¼
is
the
unique
translation-invariant
(1,
1)-form
d
E[d]
â€ 
whose
integral
is
1).
Finally,
the
section
ÎºR
:
ER
â†’
(E[d]
)R
determines
a
real
analytic
direct
sum
decomposition

Ï„EâŠ—r
âŠ—
OER
(R
â€ 
)R
âˆ¼
=
E[d]
râ‰¥0
333
(where
the
subscript
â€œRâ€™sâ€
denote
that
the
decomposition
is
in
the
real
analytic
category).
If
we
use
this
decomposition
to
write
s
âˆˆ
Î“(E,
L
âŠ—OE
F
d
(R
â€ 
))
as
s
=
s[0]
+
s[1]
+
.
.
.
+
E[d]
s[r]
+
.
.
.,
and,
moreover,
equip
Ï‰E
with
the
metric
given
by:
def
||Î±||2
=
d
Â·
Î±âˆ§Î±
E
then
we
obtain
another
metric,
the
â€œde
Rham
metricâ€
||
âˆ¼
||DR
,
on
Î“(E,
L
âŠ—OE
F
d
(R
â€ 
)):
E[d]
def
||s||DR
=

râ‰¥0
E
|s[r]|2L
Â·
dÎ¼
(cf.
Chapter
VII,
Â§4,
for
more
details).
These
metrics
satisfy:
||
âˆ¼
||R
â‰¤
||
âˆ¼
||DR
â‰¤
eÏ€+r
Â·
||
âˆ¼
||R
Moreover,
(1)
(Hermite
Model)
If
we
ï¬x
a
nonnegative
integer
r
â‰¤
d
and
let
d
â†’
âˆ,
then
on
Î“(E,
L
âŠ—OE
F
r
(R
â€ 
)),
we
have:
E[d]
âˆ’1
lim
Î³d
2
Â·
||
âˆ¼
||et
=
dâ†’âˆ
def
Here
Î³d
=
d
4Ï€Â·Im(Ï„
)
1
2
âˆ’1
lim
Î³d
2
Â·
||
âˆ¼
||HMd
=
dâ†’âˆ
âˆ’1
lim
Î³d
2
Â·
||
âˆ¼
||R
dâ†’âˆ
,
and
||
âˆ¼
||HMd
is
the
metric
on
the
space
Î“(E,
L
âŠ—OE
F
r
(R
â€ 
))
E[d]
deï¬ned
by
considering
Hermite
polynomials
scaled
by
Î³d
in
the
derivatives
of
the
theta
functions
âˆˆ
Î“(E,
L)
(cf.
Â§6
for
more
details
on
||
âˆ¼
||HMd
).
(2)
(Legendre
Model)
There
is
a
natural
metric
||
âˆ¼
||Tch
on
Î“(E,
L
âŠ—OE
F
d
(R
â€ 
))
E[d]
which
admits
a
natural
orthonormal
basis
obtained
by
considering
discrete
Tchebycheï¬€
polynomials
(cf.
Chapter
VII,
Proposition
3.1)
scaled
by
d
in
the
derivatives
of
the
theta
functions
âˆˆ
Î“(E,
L)
(cf.
Â§2
for
more
details
on
||
âˆ¼
||Tch
).
In
the
limit,
as
d
â†’
âˆ,
with
this
scaling,
these
polynomials
converge
to
the
Legendre
polynomials.
Moreover,
if
d
â‰¥
25,
then
for
r
â‰¤
d,
the
metrics
||
âˆ¼
||Tch
;
||
âˆ¼
||DR
on
Î“(E,
L
âŠ—OE
F
r
(R
â€ 
))
satisfy:
E[d]
2
|q|âˆ’
2d
Â·(iÏ‡
/n)
Â·
||
âˆ¼
||Tch
â‰¤
||
âˆ¼
||DR
d3
Â·
C
1/2
Â·
e5d
Â·
(C
+
C
âˆ’1
)r

e5
Â·
d6


e10
d
2
1
â‰¤
Â·
|q|âˆ’
2d
Â·(iÏ‡
/n)
Â·
||
âˆ¼
||Tch
Â·
1
C
C2
1
334
def
1
where
C
=
{8Ï€
2
Â·
Im(Ï„
)}
2
.
Moreover,
if
a
is
a
natural
number,
then
there
is
a
natural
metric
||
âˆ¼
||w,Î¼a
on
Î“(E,
LâŠ—OE
F
d
(R
â€ 
))
obtained
by
averaging
||
âˆ¼
||et
with
respect
to
E[d]
translates
by
the
a
Â·
d-torsion
points
of
E
=
Gm
/q
Z
arising
from
the
torsion
points
of
Gm
(cf.
Â§1,2,
for
more
details).
The
metrics
||
âˆ¼
||w,Î¼a
;
||
âˆ¼
||DR
on
Î“(E,
L
âŠ—OE
F
r
(R
â€ 
))
E[d]
satisfy:
|q|âˆ’
2d
Â·(iÏ‡
/n)
Â·
||
âˆ¼
||w,Î¼a
â‰¤
||
âˆ¼
||DR
d8
Â·
C
1/2
Â·
e9d
Â·
{a2
Â·
(C
+
C
âˆ’1
)}r

e6
Â·
d6


e10
d
2
1
â‰¤
Â·
|q|âˆ’
2d
Â·(iÏ‡
/n)
Â·
||
âˆ¼
||w,Î¼a
Â·
1
C
C2
2
1
whenever
a
â‰¥
8
+
(
Ï€4
Â·
Im(Ï„
))âˆ’1
.
(3)
(Binomial
Model)
There
is
a
natural
metric
||
âˆ¼
||CG
on
Î“(E,
L
âŠ—OE
F
d
(R
â€ 
))
E[d]
which
admits
a
natural
orthonormal
basis
obtained
by
considering
certain
binomial
coefï¬cient
polynomials
(cf.
Chapter
V,
Theorem
4.8)
(scaled
by
1
=
d0
)
in
the
derivatives
of
the
theta
functions
âˆˆ
Î“(E,
L)
(cf.
Â§2
for
more
details
on
||
âˆ¼
||Tch
).
If
d
â‰¥
25,
for
r
â‰¤
d,
then
the
metrics
||
âˆ¼
||CG
,
||
âˆ¼
||DR
on
Î“(E,
L
âŠ—OE
F
d
(R
â€ 
))
satisfy:
E[d]
|q|âˆ’
2d
Â·(iÏ‡
/n)
Â·
||
âˆ¼
||CG
â‰¤
||
âˆ¼
||DR
e3d
Â·
r
2r
Â·
d5
Â·
C
1/2
Â·
{4Ï€(C
+
C
âˆ’1
)}r

e
5
Â·
d
4


e
9
d
2
1
Â·
â‰¤
Â·
|q|âˆ’
2d
Â·(iÏ‡
/n)
Â·
||
âˆ¼
||CG
1
C
C2
1
2
Moreover,
there
is
a
natural
metric
||
âˆ¼
||qCG
on
Î“(E,
L
âŠ—OE
F
d
(R
â€ 
))
which
admits
a
E[d]
natural
orthonormal
basis
obtained
by
dividing
the
binomial
coeï¬ƒcient
polynomials
in
the
derivatives
of
the
theta
functions
considered
above
by
certain
powers
of
q.
If
d
â‰¥
12,
and
Im(Ï„
)
â‰¥
200{log2
(d)
+
n
Â·
log(d)
+
n
Â·
log(n)},
then
this
metric
satisï¬es:
nâˆ’1
Â·
eâˆ’32d
Â·
||
âˆ¼
||qCG
â‰¤
||
âˆ¼
||et
â‰¤
e4d
Â·
||
âˆ¼
||qCG
In
particular,
for
each
of
these
models,
the
combinatorial/arithmetic
portion
of
the
analytic
torsion
(i.e.,
the
portion
not
arising
from
letting
the
elliptic
curve
E
degenerate)
induced
on
Î“(E,
L
âŠ—OE
(F
r+1
/F
r
)(R
â€ 
))
by
the
metrics
||
âˆ¼
||R
;
||
âˆ¼
||DR
;
||
âˆ¼
||HMd
;
E[d]
||
âˆ¼
||Tch
;
||
âˆ¼
||w,Î¼a
;
||
âˆ¼
||qCG
(in
their
respective
domains
of
applicability)
as
r
â†’
d,
goes
(modulo
factors
of
the
order
(constant)d
)
as
â‰ˆ
(d!)âˆ’1
335
which
is
precisely
what
you
would
expect
by
applying
the
product
formula
to
the
computation
of
the
â€œanalytic
torsionâ€
in
the
ï¬nite
prime
case
(cf.
Chapter
V,
Theorem
3.1;
Chapter
VI,
Theorem
4.1;
Chapter
VII,
Proposition
3.4).
Finally,
all
of
the
metrics
appearing
above
on
the
space
Î“(E,
LâŠ—OE
F
r
(R
â€ 
))
are
invariant
with
respect
to
the
maximal
E[d]
compact
subgroup
GS1
âŠ†
GL
of
the
theta
group
GL
associated
to
L.
Proof.
Note
that
relative
to
the
discussion
preceding
Theorem
7.4,
we
replace
Eor
(respectively,
qor
;
DR,
sc;
R,
sc)
by
the
simpler
notation
E
(respectively,
q;
DR;
R)
in
the
statement
of
Theorem
7.4.
The
inequality
relating
||
âˆ¼
||R
;
||
âˆ¼
||DR
follows
from
Lemma
6.4.
The
estimates
of
(1)
(respectively,
(2);
(3))
follow
by
weakening/simplifying
the
estimates
of
Lemma
6.4
(respectively,
Lemma
6.2;
Lemma
6.3,
Theorem
5.8).
For
stronger
estimates,
we
refer
to
the
various
estimates
of
Â§5,
6.
(Note
that
to
simplify
these
estimates,
we
make
use
of
Chapter
VII,
Lemmas
3.5,
3.6.)
The
statement
concerning
the
relationship
between
the
analytic
torsion
and
the
comparison
theorem
at
ï¬nite
primes
follows
from
Lemma
7.3
and
the
Remark
following
Lemma
7.3.
The
statement
concerning
invariance
with
respect
to
GS1
follows
from
the
deï¬nitions
of
the
metrics
using
Lemma
7.2.

Remark.
Note
that
the
three
models
correspond
roughly
to
three
â€œdomains
of
validity/applicabilityâ€:
1
Hermite
Model
(scaling
factor
=
d
2
)
:
nondegenerating
E,
ï¬xed
r
<
d
Legendre
Model
(scaling
factor
=
d)
:
nondegenerating
E,
varying
r
<
d
Binomial
Model
(scaling
factor
=
1)
:
degenerating
E
Relative
to
Im(Ï„
)
(where
E
=
Gm
/q
Z
,
q
=
exp(2Ï€iÏ„
)),
the
Hermite
Model
(respectively,
Legendre
Model,
Binomial
Model)
corresponds
to
the
case
where/is
most
useful
when
Im(Ï„
)
is
ï¬xed
(respectively,
â†’
0;
â†’
âˆ).
Finally,
as
remarked
at
the
end
of
Â§5,
the
factor
of
nâˆ’1
appearing
at
the
beginning
of
the
last
line
of
inequalities
of
Theorem
7.4,
(3),
is
the
archimedean
analogue
of
the
description
of
the
scheme-theoretic
zero
locus
of
the
determinant
given
in
Chapter
VI,
Theorem
4.1,
(2).
336
Chapter
IX:
The
Arithmetic
Kodaira-Spencer
Morphism
Â§0.
Introduction
In
this
Chapter,
we
apply
the
Hodge-Arakelov
Comparison
Theorem
(Chapter
VIII,
Theorem
A)
to
construct
an
arithmetic
version
of
the
well-known
Kodaira-Spencer
morphism
of
a
family
of
elliptic
curves
E
â†’
S
(satisfying
a
mild
technical
assumption
concerning
its
2-torsion):
Îºarith
:
Î S
â†’
Filt(HDR
)(S)
E
Roughly
speaking,
this
arithmetic
Kodaira-Spencer
morphism
is
a
canonical
map
from
the
def
algebraic
fundamental
group
of
SQ
=
S
âŠ—Z
Q
(i.e.,
if
S
=
Spec(OK
),
where
OK
is
the
ring
of
integers
of
a
number
ï¬eld
K,
then
one
may
think
of
Î S
as
the
absolute
Galois
group
of
K)
to
a
ï¬‚ag
variety
of
ï¬ltrations
of
a
module
which
is
a
certain
analogue
of
the
de
Rham
cohomology
of
the
elliptic
curve.
Moreover,
this
morphism
has
certain
remarkable
integrality
properties
(in
the
Arakelov
sense)
at
all
the
primes
(both
ï¬nite
and
inï¬nite)
of
a
number
ï¬eld.
This
arithmetic
Kodaira-Spencer
morphism
is
constructed
in
Â§3
of
this
Chapter.
In
Â§1,2,
we
ï¬rst
give
a
construction
of
the
Kodaira-Spencer
morphism
in
the
complex
and
p-adic
cases
which
is
entirely
analogous
to
the
construction
to
be
given
in
the
arithmetic
case
in
Â§3,
but
which
shows
quite
explicitly
how
this
construction
is
related
(in
the
complex
and
p-adic
cases)
to
the
â€œclassical
Kodaira-Spencer
morphismâ€
that
appears
in
the
theory
of
moduli
of
algebraic
varieties.
Conceptually
speaking,
the
main
point
in
all
of
these
constructions
consists,
as
depicted
in
the
following
diagram:
Kodaira-Spencer
morphism:
motion
in
base-space
â†’
induced
deformation
of
Hodge
ï¬ltration
of
the
idea
that
the
Kodaira-Spencer
morphism
is
the
map
which
associates
to
a
â€œmotionâ€
in
the
base-space
of
a
family
of
elliptic
curves,
the
deformation
in
the
Hodge
ï¬ltration
of
the
de
Rham
cohomology
of
the
elliptic
curve
induced
by
the
motion.
More
concretely,
the
main
idea
consists
of
a
certain
â€œrecipeâ€
for
constructing
â€œKodaira-Spencer-type
morphismsâ€
out
of
â€œcomparison
isomorphisms
between
de
Rham
and
eÌtale/singular
cohomology.â€
In
Â§3,
we
carry
out
this
recipe
in
the
case
when
the
comparison
isomorphism
is
the
the
Hodge-Arakelov
Comparison
Isomorphism
(Chapter
VIII,
Theorem
A);
in
Â§1,2,
we
discuss
certain
novel
approaches
to
the
well-known
comparison
isomorphisms
for
elliptic
curves
337
in
the
complex
and
p-adic
cases,
which,
on
the
one
hand,
make
the
connection
with
the
classical
Kodaira-Spencer
morphism
explicit,
and,
on
the
other
hand,
show
how
the
HodgeArakelov
Comparison
Isomorphism
is
entirely
analogous
to
the
well-known
complex
and
p-adic
comparison
isomorphisms.
Â§1.
The
Complex
Case:
The
Classical
â€œModular
Theoryâ€
of
the
Upper
Half-Plane
In
this
Â§,
we
review
the
de
Rham
isomorphism
of
a
complex
elliptic
curve,
showing
how
this
isomorphism
may
be
regarded
as
being
analogous
in
a
fairly
precise
sense
to
the
Comparison
Isomorphism
of
Chapter
VIII,
Theorem
A.
We
then
discuss
the
theory
of
the
Kodaira-Spencer
morphism
of
a
family
of
complex
elliptic
curves
in
the
universal
case,
but
we
formulate
this
theory
in
a
somewhat
novel
fashion,
showing
how
the
Kodaira-Spencer
morphism
may
be
derived
directly
from
the
de
Rham
isomorphism
in
a
rather
geometric
way.
This
formulation
will
allow
us
to
make
the
connection
with
the
global
arithmetic
theory
of
Â§3.
We
begin
our
discussion
by
considering
a
single
elliptic
curve
E
over
C.
Frequently
in
the
following
discussion,
we
shall
also
write
â€œEâ€
for
the
complex
manifold
deï¬ned
by
the
original
algebraic
curve.
Recall
(cf.
Chapter
III,
Â§3)
that
we
have
a
commutative
diagram
1
(E,
OE
)
=
E
â€ 
HDR
â
âexp

âˆ¼
=
Ã—
1
HDR
(E,
OE
)
=
Eâ€ 
1
âˆ¼
(E,
CÃ—
)
=
Hsing
1
(E,
C)
Hsing
â
âexp

âŠ‡
1
Hsing
(E,
2Ï€i
Â·
R)
â
âexp

1
âŠ‡
Hsing
(E,
2Ï€i
Â·
Z)
â
âexp

1
âŠ‡
Hsing
(E,
S1
)
=
ER
âŠ‡
identity
elt.
Here,
the
horizontal
isomorphisms
are
the
de
Rham
isomorphisms
relating
de
Rham
cohomology
to
singular
cohomology.
Note
that
in
characteristic
zero,
line
bundles
with
connecÃ—
1
(E,
OE
),
tion
are
necessarily
of
degree
zero,
so
E
â€ 
may
be
naturally
identiï¬ed
with
HDR
the
group
of
line
bundles
equipped
with
a
connection
on
E.
(Similarly,
the
(topological)
1
(E,
OE
).)
The
vertical
maps
are
the
universal
cover
E
â€ 
of
E
â€ 
may
be
identiï¬ed
with
HDR
morphisms
induced
on
cohomology
by
the
exponential
map;
S1
âŠ†
CÃ—
is
the
unit
circle
(equipped
with
its
usual
group
structure).
Finally,
ER
âŠ†
E
â€ 
is
the
real
analytic
submanifold
(discussed
in
Chapter
III,
Â§3)
which
is
equal
to
the
closure
of
the
torsion
points
of
E
â€ 
and
maps
bijectively
onto
E
via
the
natural
projection
E
â€ 
â†’
E.
Here,
we
would
like
to
consider
the
issue
of
precisely
how
the
de
Rham
isomorphisms
of
the
above
diagram
are
deï¬ned.
Of
course,
there
are
many
possible
deï¬nitions
for
these
isomorphisms,
but
the
point
that
we
would
like
to
make
here
is
the
following:
def
1
1
If
one
thinks
of
Hsing
(E,
S1
)
=
ER
(respectively,
Tv
(E)
=
Hsing
(E,
2Ï€iÂ·
R))
as
the
â€œv-divisible
group
of
torsion
points
of
Eâ€
(respectively,
the
338
â€œv-adic
Tate
moduleâ€)
â€”
where
v
=
âˆ
is
the
archimedean
prime
of
Q
â€”
then,
roughly
speaking,
one
may
think
of
the
de
Rham
isomorphisms
as
being
given
by
the
diagram
1
Hol.
fns.
on
HDR
(E,
OE
)
=
E
â€ 
â€œâˆ¼
=â€
1
Real
an.
fns.
on
Hsing
(E,
2Ï€i
Â·
R)
Ã—
1
Hol.
fns.
on
HDR
(E,
OE
)
=
Eâ€ 
â€œâˆ¼
=â€
1
Real
an.
fns.
on
Hsing
(E,
S1
)
=
ER
where
the
horizontal
isomorphisms
â€œâˆ¼
=â€
are
given
by
restricting
holoâ€ 
â€ 
morphic
functions
on
E
,
E
to
real
analytic
functions
on
the
â€œâˆ-adic
def
1
torsion
points/Tate
moduleâ€
ER
,
Tâˆ
(E)
=
Hsing
(E,
2Ï€i
Â·
R).
Here,
we
say
â€œroughly
speakingâ€
(and
write
â€œâˆ¼
=â€)
for
the
following
reason:
Although
this
restriction
morphism
is
injective,
the
correspondence
between
holomorphic
functions
on
the
de
Rham
objects
E
â€ 
,
E
â€ 
and
real
analytic
functions
on
the
v-adic
torsion
point
objects
ER
,
Tâˆ
(E)
is,
strictly
speaking,
only
true
on
an
â€œinï¬nitesimal
neighborhoodâ€
of
ER
âŠ†
E
â€ 
,
Tâˆ
(E)
âŠ†
E
â€ 
.
(That
is
to
say,
although
a
real
analytic
function
on
ER
always
corresponds
to
a
holomorphic
function
on
some
open
neighborhood
of
ER
in
E
â€ 
,
whether
or
not
this
holomorphic
function
extends
to
a
holomorphic
function
deï¬ned
over
all
of
E
â€ 
involves
subtle
convergence
issues
and,
in
fact,
is
not
always
the
case.)
Thus,
here,
in
order
to
get
a
precise
statement,
we
shall
work
with
polynomial
functions
on
E
â€ 
and
Tâˆ
(E).
Then
one
sees
immediately
that
the
de
Rham
isomorphism
of
the
ï¬rst
commutative
diagram
of
this
Â§
may
be
formulated
as
the
isomorphism
HolomPoly
(E
â€ 
)
âˆ¼
=
Real
AnPoly
(Tâˆ
(E))
given
by
restricting
holomorphic
polynomials
on
E
â€ 
to
the
âˆ-adic
torsion
points
so
as
to
obtain
real
analytic
polynomials
on
Tâˆ
(E).
When
formulated
from
this
point
of
view,
one
sees
that
the
Comparison
Isomorphism
of
Chapter
VIII,
Theorem
A,
is
analogous
in
a
very
direct
sense
to
the
classical
de
Rham
isomorphism
in
the
complex
case,
i.e.:
Both
may
be
thought
of
as
being
bijections
between
algebraic/
holomorphic
functions
on
de
Rham-type
objects
and
arbitrary/
real
analytic
functions
on
torsion
points
â€“
bijections
given
by
restricting
algebraic/
holomorphic
functions
on
de
Rham-type
objects
to
the
torsion
points
lying
inside
those
de
Rham-type
objects.
This
observation
may
be
thought
of
as
the
philosophical
starting
point
of
the
theory
of
this
paper.
339
1
Remark.
Note
that
the
collection
of
â€œholomorphic
functions
on
HDR
(E,
OE
)â€
includes,
in
particular,
the
theta
functions
(cf.,
e.g.,
[Mumf],
Chapter
I,
Â§3)
associated
to
the
elliptic
curve
E.
Moreover,
these
functions
are
â€œfairly
representative
ofâ€
(roughly
speaking,
â€œgen1
erateâ€)
the
set
of
all
holomorphic
functions
on
HDR
(E,
OE
)
that
arise
by
pull-back
via
the
1
1
projection
HDR
(E,
OE
)
â†’
H
(E,
OE
)
(deï¬ned
by
the
Hodge
ï¬ltration)
from
holomorphic
functions
on
H
1
(E,
OE
).
This
observation
played
a
fundamental
motivating
role
in
the
development
of
the
theory
of
the
present
paper.
Next,
we
shift
gears
and
discuss
various
versions
of
the
Kodaira-Spencer
morphism
for
def
the
universal
family
of
complex
elliptic
curves.
First,
let
us
write
H
=
{z
âˆˆ
C
|
Im(z)
>
0}
for
the
upper
half-plane,
and
EH
â†’
H
for
the
universal
family
of
complex
elliptic
curves
over
H.
That
is
to
say,
over
a
point
z
âˆˆ
H,
the
ï¬ber
Ez
of
this
family
is
given
by
Ez
=
C/
<
1,
z
>
(where
<
1,
z
>
denotes
the
Z-submodule
generated
by
1,
z).
Let
us
ï¬x
a
â€œbase-pointâ€
z0
âˆˆ
H.
Write
def
1
1
HDR
(Ez0
)
=
HDR
(Ez0
,
OEz0
)
1
Thus,
HDR
(Ez0
)
is
a
two-dimensional
complex
vector
space.
Recall
that,
in
fact,
the
1
correspondence
z
â†’
HDR
(Ez
)
deï¬nes
a
rank
two
vector
bundle
E
on
H
equipped
with
a
natural
(integrable)
connection
(the
â€œGauss-Manin
connectionâ€).
Since
the
underlying
topological
space
of
H
is
contractible,
parallel
transport
via
this
connection
thus
gives
rise
to
a
natural
trivialization
of
this
rank
two
vector
bundle
E,
i.e.,
a
natural
isomorphism
1
Eâˆ¼
(Ez0
)
=
H
Ã—
HDR
Recall
that
the
Hodge
ï¬ltration
of
de
Rham
cohomology
deï¬nes
a
subbundle
F
1
(E)
âŠ†
E
of
rank
one.
This
subbundle
induces
a
natural
holomorphic
morphism
def
1
ÎºH
:
H
â†’
P
=
P1
(HDR
(Ez0
))
1
1
that
maps
a
point
z
âˆˆ
H
to
the
subspace
of
HDR
(Ez0
)
=
HDR
(Ez
)
deï¬ned
by
F
1
(E)
âŠ†
E
at
z.
Now
let
us
recall
that
we
have
a
natural
action
of
SL2
(R)
on
H
given
by
linear
fractional
transformations.
This
action
allows
us
to
deï¬ne
a
morphism
ÎºSL2
:
SL2
(R)
â†’
P
340
def
by
letting
ÎºSL2
(Î³)
=
ÎºH
(Î³
Â·
z0
)
(for
Î³
âˆˆ
SL2
(R)).
If
we
then
diï¬€erentiate
ÎºSL2
at
z0
,
we
obtain
a
morphism
on
tangent
spaces
that
ï¬ts
into
a
commutative
diagram:
Îºsl
2
âˆ’â†’
sl2
(R)
â
â

sl2
(R)/so2
âˆ¼
=
Ï„P,p0
#
âÎºÏ„
â
Ï„H,z0
Here,
the
vertical
morphism
on
top
is
the
derivative
of
ÎºSL2
at
the
origin
of
SL2
(R);
def
Ï„P,p0
(respectively,
Ï„H,z0
)
is
the
tangent
space
to
P
(respectively,
H)
at
p0
=
ÎºH
(z0
)
(respectively,
z0
).
This
vertical
morphism
clearly
factors
through
the
quotient
sl2
(R)
â†’
sl2
(R)/so2
,
where
sl2
(R)
(respectively,
so2
)
is
the
Lie
algebra
associated
to
SL2
(R)
(respectively,
the
subgroup
of
SL2
(R)
that
ï¬xes
z0
).
Moreover,
all
tangent
vectors
to
z0
âˆˆ
H
are
obtained
by
acting
by
various
elements
of
sl2
(R)
on
H
at
z0
;
thus,
one
may
identify
sl2
(R)/so2
with
Ï„H,z0
(the
vertical
isomorphism
on
the
bottom).
Deï¬nition
1.1.
We
shall
refer
to
ÎºSL2
(respectively,
Îºsl2
;
ÎºÏ„
)
as
the
group-theoretic
(respectively,
Lie-theoretic;
classical)
Kodaira-Spencer
morphism
(of
the
family
EH
â†’
H
at
z0
).
Thus,
the
â€œclassical
Kodaira-Spencer
morphismâ€
ÎºÏ„
is
obtained
(cf.
the
above
commutative
diagram)
simply
by
using
the
fact
that
Îºsl2
factors
through
the
quotient
sl2
(R)
â†’
sl2
(R)/so2
.
One
checks
easily
that
this
morphism
is
indeed
the
usual
Kodaira-Spencer
morphism
associated
to
the
family
EH
â†’
H.
In
particular,
ÎºÏ„
is
an
isomorphism.
The
reason
that
we
feel
that
it
is
natural
also
to
regard
ÎºSL2
and
Îºsl2
as
â€œKodairaSpencer
morphismsâ€
is
the
following:
The
essence
of
the
notion
of
a
â€œKodaira-Spencer
morphismâ€
is
that
of
a
correspondence
that
associates
to
a
motion
in
the
base-space
the
induced
deformation
of
the
Hodge
ï¬ltration
of
the
de
Rham
cohomology,
i.e.,
symbolically,
Kodaira-Spencer
morphism:
motion
in
base-space
â†’
induced
deformation
of
Hodge
ï¬ltration
In
the
case
of
the
â€œgroup-theoretic
Kodaira-Spencer
morphismâ€
(respectively,
â€œLie-theoretic
Kodaira-Spencer
morphismâ€;
â€œclassical
Kodaira-Spencer
morphismâ€),
this
motion
is
a
motion
given
by
the
â€œLie
group
SL2
(R)
of
motions
of
Hâ€
(respectively,
the
Lie
algebra
associated
to
this
Lie
group
of
motions;
a
tangent
vector
in
H).
That
is
to
say,
all
three
types
of
Kodaira-Spencer
morphism
discussed
here
ï¬t
into
the
general
pattern
just
described.
It
turns
out
that
the
group-theoretic
Kodaira-Spencer
morphism
is
the
version
which
is
most
suited
to
generalization
to
the
arithmetic
case
(cf.
the
discussions
of
Â§2,3
below).
Finally,
we
make
the
connection
between
the
theory
of
the
Kodaira-Spencer
morphism
just
discussed
and
the
function-theoretic
approach
to
the
de
Rham
isomorphism
discussed
341
at
the
beginning
of
this
Â§.
First
of
all,
let
us
observe
that
the
action
of
SL2
(R)
on
H
lifts
naturally
to
an
action
on
E.
Moreover,
if
one
thinks
of
SL2
(R)
as
the
group
of
unimodular
(i.e.,
with
determinant
=
1)
R-linear
automorphisms
of
the
two-dimensional
R-vector
space
Tâˆ
(Ez0
),
that
is,
if
one
makes
the
identiï¬cation
SL2
(R)
=
SL(Tâˆ
(Ez0
))
1
(Ez0
)
corresponds
to
the
natural
action
of
then
the
action
of
SL2
(R)
on
E
âˆ¼
=
H
Ã—
HDR
1
âˆ¼
SL(Tâˆ
(Ez0
))
on
HDR
(Ez0
)
=
Tâˆ
(Ez0
)
âŠ—R
C
(where
the
isomorphism
here
is
the
de
Rham
isomorphism).
It
thus
follows
that
the
group-theoretic
Kodaira-Spencer
morphism
ÎºSL2
may
also
be
deï¬ned
as
the
morphism
1
SL2
(R)
=
SL(Tâˆ
(Ez0
))
â†’
P
=
P(HDR
(Ez0
))
given
by
Î³
â†’
Î³
Â·
p0
,
where
the
expression
â€œÎ³
Â·
p0
â€
is
relative
to
the
natural
action
of
1
SL(Tâˆ
(Ez0
))
on
P
=
P(HDR
(Ez0
))
âˆ¼
=
P(Tâˆ
(Ez0
)
âŠ—R
C)
(where
the
isomorphism
here
is
that
derived
from
the
de
Rham
isomorphism).
This
approach
to
deï¬ning
ÎºSL2
shows
that:
The
group-theoretic
Kodaira-Spencer
morphism
ÎºSL2
may
essentially
be
deï¬ned
directly
from
the
de
Rham
isomorphism.
This
observation
brings
us
one
step
closer
to
the
discussion
of
the
arithmetic
case
in
Â§3.
In
particular,
in
light
of
the
above
â€œfunction-theoretic
approach
to
the
de
Rham
isomorphism,â€
it
motivates
the
following
point
of
view:
Note
that
(in
the
notation
of
the
discussion
at
the
beginning
of
this
Â§)
the
space
HolomPoly
(E
â€ 
)
of
holomorphic
polynomials
on
E
â€ 
has
a
Hodge
ï¬ltration
.
.
.
F
d
(HolomPoly
(E
â€ 
))
âŠ†
.
.
.
âŠ†
HolomPoly
(E
â€ 
)
given
by
letting
F
d
(HolomPoly
(E
â€ 
))
âŠ†
HolomPoly
(E
â€ 
)
denote
the
subspace
of
polynomials
whose
â€œtorsorial
degreeâ€
(cf.
Chapter
III,
Deï¬nition
2.2),
i.e.,
degree
as
a
polynomial
in
the
relative
variable
of
the
torsor
E
â€ 
â†’
E
(where
E
is
the
universal
covering
space
of
E),
is
<
d.
Note
that
relative
to
the
â€œfunction-theoretic
de
Rham
isomorphismâ€
HolomPoly
(E
â€ 
)
âˆ¼
=
Real
AnPoly
(Tâˆ
(E)),
F
d
(HolomPoly
(E
â€ 
))
corresponds
to
the
subspace
d
of
Real
AnPoly
(Tâˆ
(E))
annihilated
by
âˆ‚
.
(Here,
âˆ‚
is
the
usual
â€œdel-barâ€
operator
of
complex
analysis
on
Tâˆ
(E)
=
ER
,
relative
to
the
complex
structure
on
ER
deï¬ned
by
E.)
Let
us
write
Filt(HolomPoly
(E
â€ 
))
342
for
the
(inï¬nite-dimensional)
ï¬‚ag-manifold
of
C-linear
ï¬ltrations
{F
d
}dâˆˆZâ‰¥0
of
HolomPoly
(E
â€ 
)
such
that
F
0
=
0.
Then
the
â€œHodge
ï¬ltrationâ€
just
deï¬ned
determines
a
point
âˆˆ
Filt(HolomPoly
(E
â€ 
))
pfunc
E
Similarly,
any
one-dimensional
complex
quotient
E
â€ 
â†’
Q
deï¬nes
a
ï¬ltration
of
HolomPoly
(E
â€ 
)
(given
by
looking
at
the
degree
with
respect
to
the
variable
corresponding
to
the
kernel
of
E
â€ 
â†’
Q).
In
particular,
we
get
an
immersion
P(E
â€ 
)
â†’
Filt(HolomPoly
(E
â€ 
))
Thus,
returning
to
the
discussion
of
the
group-theoretic
Kodaira-Spencer
morphism,
we
see
that
we
may
think
of
the
composite
Poly
(E
â€ 
))
Îºfunc
SL2
:
SL2
(R)
=
SL(Tâˆ
(Ez0
))
â†’
Filt(Holom
of
ÎºSL2
with
the
inclusion
P(E
â€ 
)
â†’
Filt(HolomPoly
(E
â€ 
))
as
being
deï¬ned
as
follows:
The
natural
action
of
SL(Tâˆ
(Ez0
))
on
Real
AnPoly
(Tâˆ
(Ez0
))
induces,
via
the
â€œfunction-theoretic
de
Rham
isomorphismâ€
Real
AnPoly
(Tâˆ
(Ez0
))
âˆ¼
=
HolomPoly
(Ezâ€ 0
)
â€ 
an
action
of
SL(Tâˆ
(Ez0
))
on
HolomPoly
(Ez0
);
then
the
â€œfunction-theoretic
version
of
the
group-theoretic
Kodaira-Spencer
morphismâ€
Poly
(Ezâ€ 0
))
Îºfunc
SL2
:
SL(Tâˆ
(Ez0
))
â†’
Filt(Holom
â€ 
Poly
func
is
deï¬ned
by
Î³
â†’
Î³
Â·
pfunc
(Ez0
))
is
the
Ez0
,
where
pEz0
âˆˆ
Filt(Holom
â€ 
natural
point
deï¬ned
by
the
Hodge
ï¬ltration
on
HolomPoly
(Ez0
).
It
is
this
point
of
view
that
forms
the
basis
of
our
approach
to
the
arithmetic
case
in
Â§3.
Remark.
The
theory
discussed
in
Â§1,2,
of
this
Chapter
generalizes
immediately
to
the
case
of
higher-dimensional
abelian
varieties.
Since,
however,
the
Hodge-Arakelov
Comparison
Theorem
(Chapter
VIII,
Theorem
A)
is
only
available
(at
the
time
of
writing)
for
elliptic
curves,
we
restrict
ourselves
both
in
the
present
and
the
following
Â§â€™s
to
the
case
of
elliptic
curves.
343
Â§2.
The
p-adic
Case:
The
Hodge-Tate
Decomposition
as
an
Evaluation
Map
The
purpose
of
this
Â§
is
to
exhibit
the
morphism
which
deï¬nes
the
Hodge-Tate
decomposition
of
the
p-adic
Tate
module
of
an
elliptic
curve
as
an
evaluation
map,
given
by
restricting
certain
functions
on
the
universal
extension
of
the
elliptic
curve
to
the
p-power
torsion
points
of
the
elliptic
curve.
This
renders
explicit
the
analogy
between
the
HodgeArakelov
Comparison
Isomorphism
of
Chapter
VIII,
Theorem
A,
and
the
p-adic
Hodge
theory
of
an
elliptic
curve.
We
then
explain
how,
if
one
applies
the
general
recipe
â€“
which
is
the
theme
of
the
present
Chapter
â€“
for
obtaining
Kodaira-Spencer-type
morphisms
from
evaluation
map-based
comparison
isomorphisms
(cf.
Â§1
in
the
complex
case
and
in
Â§3
in
the
global
Arakelov
case)
to
the
present
p-adic
situation,
one
obtains
a
sort
of
â€œp-adic
arithmetic
Kodaira-Spencer
morphism,â€
which,
by
Faltingsâ€™
computation
of
certain
Galois
cohomology
groups,
may
be
identiï¬ed
with
the
classical
Kodaira-Spencer
morphism
of
a
family
of
elliptic
curves.
Remark.
The
material
of
the
present
Â§
is
in
principle
â€œwell-known,â€
and,
in
fact,
inspired
by
the
techniques
and
points
of
view
of
[Falt1,2],
[Font],
but
I
do
not
know
of
an
adequate
explicit
reference
for
this
material.
Roughly
speaking,
the
idea
here
is
what
is
usually
referred
to
as
the
p-adic
period
map
for
abelian
varieties
â€“
cf.
[Coln],
[Colz],
[Wint].
Indeed,
our
point
of
view
here
essentially
coincides
with
what
is
done
in
[Coln],
[Colz],
[Wint],
and
[Font],
when
restricted
to
the
subspace
of
the
de
Rham
cohomology
of
an
elliptic
curve
arising
from
diï¬€erentials
of
the
ï¬rst
kind
(i.e.,
globally
holomorphic
diï¬€erentials).
Our
treatment
of
the
â€œother
halfâ€
of
the
de
Rham
cohomology,
however,
appears
to
diï¬€er
from
these
other
sources.
Indeed,
Coleman
([Coln])
and
Fontaine
([Font])
do
not
construct
a
morphism
on
the
entire
de
Rham
cohomology
module.
On
the
other
hand,
Colmez
([Colz],
TheÌoreÌ€me
5.2)
constructs
such
a
morphism
by
thinking
of
the
remainder
of
the
de
Rham
cohomology
as
being
deï¬ned
by
diï¬€erentials
of
the
second
kind
(i.e.,
meromorphic
diï¬€erentials
which
are
â€œlocally
integrableâ€),
which
he
integrates
to
construct
his
period
map;
in
particular,
Colmez
does
not
use
the
universal
extension
as
we
do
here.
Finally,
Wintenberger
([Wint],
Â§4)
uses
the
universal
extension,
but
in
a
somewhat
diï¬€erent
fashion
from
what
is
done
here.
Let
k
be
a
perfect
ï¬eld
of
characteristic
p
>
2.
(In
fact,
the
case
p
=
2
may
be
handled
without
much
more
diï¬ƒculty,
but
for
simplicity,
we
assume
here
that
p
>
2.)
def
def
Write
A
=
W
(k);
K
=
A
âŠ—Zp
Qp
.
Let
S
be
a
formal
p-adic
A-scheme,
which
is
formally
smooth
and
formally
of
ï¬nite
type
over
A.
Suppose
that
S
is
equipped
with
an
A-ï¬‚at
divisor
with
normal
crossings
D
âŠ†
S.
Write
S
log
for
the
resulting
log
scheme.
Suppose
that
C
log
â†’
S
log
is
a
log
elliptic
curve
over
S
log
(cf.
Chapter
III,
Deï¬nition
1.1).
344
Next,
let
us
suppose
that
S
is
aï¬ƒne,
i.e.,
of
the
form
Spf(R)
where
R
is
a
p-adic
ring,
and
small
(cf.
[Falt2],
II.,
(a.)),
i.e.,
R
is
eÌtale
over
the
p-adic
completion
A[t1
,
.
.
.
,
tr
]âˆ§
of
A[t1
,
.
.
.
,
tr
],
where
t1
,
.
.
.
,
tr
are
indeterminates
such
that
the
def
schematic
zero
locus
of
t
=
t1
Â·
.
.
.
Â·
tr
in
S
is
equal
to
D.
Write
R
for
the
p-adic
completion
of
the
normalization
R
of
R
in
the
maximal
eÌtale
extension
of
def
RQp
[tâˆ’1
]
(where
RQp
=
R
âŠ—
Qp
).
(Here,
â€œmaximalâ€
means
â€œamong
those
extensions
whose
Spf
is
connected.â€)
Also,
let
us
write
def
Î“R
=
Gal(RQp
/RQp
)
Then
as
in
[Falt2],
II.,
(b.),
we
may
form
the
ring
of
p-adic
periods
B
+
(R)
This
ring
admits
a
natural
Î“R
-action,
together
with
a
Î“R
-equivariant
projection
B
+
(R)
â†’
R
whose
kernel
I
is
a
â€œprincipal
divided
power
ideal.â€
In
the
discussion
of
the
present
Â§,
we
will
work
with
the
following
truncated
version
of
B
+
(R):
def
B
=
B
+
(R)/I
[2]
def
(where
I
[2]
is
the
second
divided
power
of
I).
Write
J
=
I/I
[2]
âŠ†
B
for
the
image
of
I
in
B.
Thus,
we
have
an
exact
sequence
of
Î“R
-modules:
0â†’J
â†’Bâ†’Râ†’0
Moreover,
J
is
a
free
R-module
of
rank
1.
If
one
further
takes
the
Î“R
-action
on
J
into
account,
then
one
has
a
natural
identiï¬cation
(cf.
[Falt2],
II.,
(b.))
1
Zp
(1)
Â·
R
=
p
(pâˆ’1)
Â·
J
(where
the
â€œ(1)â€
is
a
Tate
twist).
Put
another
way,
there
is
a
Î“R
-equivariant
homomorphism
Î²Qp
:
Qp
(1)
â†’
B
Ã—
345
Ã—
Ã—
whose
projection
to
R
is
the
natural
inclusion
Qp
(1)/Zp
(1)
â†’
R
and
whose
restriction
to
Zp
(1)
is
equal
to
1
plus
the
homomorphism
Î²
:
Zp
(1)
â†’
J.
Note
that
since
R
contains
all
roots
of
the
q-parameter
at
inï¬nity,
we
may
form
Eâˆ
â†’
Spf(R);
Câˆ
â†’
Spf(R)
as
in
Chapter
IV,
Â§4.
Note
that
we
have
a
projection
Câˆ
â†’
C,
and
an
open
immersion
Eâˆ
â†’
Câˆ
.
Thus,
in
particular,
by
pulling
back
via
this
projection
and
this
open
immersion
the
extension
to
C
(cf.
Chapter
III,
Corollary
4.3)
â€ 
EC
â†’
C
of
the
universal
extension
E
â€ 
â†’
E
of
E,
we
obtain
â€ 
â†’
Spf(R);
Eâˆ
â€ 
ECâˆ
â†’
Spf(R)
â€ 
â€ 
Next,
let
us
recall
that
the
universal
extension
Eâˆ
deï¬nes
a
crystal
Eâˆ,crys
(cf.,
e.g.,
[Mess],
for
the
non-logarithmic
case)
over
Spf(R)log
(where
â€œlogâ€
refers
to
the
natural
log
structure
deï¬ned
by
roots
of
the
q-parameter
at
inï¬nity).
Since
we
may
regard
Spf(B)
as
â€ 
a
PD-thickening
of
Spf(R)log
,
we
thus
see
that
it
makes
sense
to
speak
of
Eâˆ,crys
(B),
or
even
â€ 
(BQp
)
Eâˆ,crys
def
where
BQp
=
B
âŠ—
Qp
.
In
particular,
we
see
that,
for
n
â‰¥
0,
â€ 
â€ 
pn
Eâˆ,crys
(BQp
)
âŠ†
Eâˆ,crys
(BQp
)
forms
a
group
(noncanonically
isomorphic
to)
(Z/pn
Â·
Z)2
.
In
fact,
the
sections
of
the
â€ 
â€ 
crystal
Eâˆ,crys
deï¬ned
by
pn
Eâˆ,crys
(BQp
)
are
all
horizontal,
hence
preserved
by
baseâ€ 
changes
of
Eâˆ,crys
among
various
thickenings
of
BQp
.
Observe
also
that
as
n
â†’
âˆ,
â€ 
the
pn
Eâˆ,crys
(BQp
)
form
a
natural
inverse
system
(all
of
whose
transition
morphisms
are
surjective);
the
inverse
limit
of
this
inverse
system
is
the
Tate
module
TE
of
E.
Note
that
as
a
topological
group,
TE
âˆ¼
=
Zp
2
.
Moreover,
TE
has
a
natural
structure
of
â€ 
continuous
Î“R
-module,
and
TE
âŠ—Z/pn
Â·
Z
may
be
naturally
identiï¬ed
with
pn
Eâˆ,crys
(BQp
).
346
Next,
we
would
like
to
consider
functions.
Let
us
write
R
â€ 
Eâˆ
â€ 
for
the
push-forward
to
Eâˆ
of
the
structure
sheaf
O
â€ 
on
Eâˆ
.
Recall
that
this
structure
Eâˆ
sheaf
has
a
ï¬ltration
F
(R
â€ 
)
âŠ†
R
â€ 
(for
j
âˆˆ
Z),
where
we
take
F
j
(R
â€ 
)
to
be
the
j
Eâˆ
Eâˆ
Eâˆ
subsheaf
of
sections
of
torsorial
degree
(cf.
Chapter
III,
Deï¬nition
2.2)
â‰¤
âˆ’j.
Note
that
the
ï¬ltration
index
that
we
use
here
diï¬€ers
from
the
ï¬ltration
index
of
Chapters
III-VIII
in
that
â€œthe
index
used
here
=
1âˆ’
the
index
used
there.â€
In
particular,
F
j
(R
â€ 
)
as
deï¬ned
Eâˆ
here
is
a
vector
bundle
on
Eâˆ
of
rank
1
âˆ’
j,
when
j
â‰¤
0.
Thus,
we
have
an
exact
sequence:
âˆ’â†’
0
OEâˆ
âˆ’â†’
F
âˆ’1
(R
â€ 
)
Eâˆ
âˆ’â†’
Ï„E
âŠ—OS
O
â€ 
Eâˆ
R
âˆ’â†’
0
â€ 
In
particular,
if
we
apply
this
ï¬ltration
to
the
crystal
Eâˆ,crys
evaluated
on
the
thickening
B,
where
we
regard
B
itself
as
equipped
with
the
ï¬ltration
given
by:
F
â‰¥2
(B)
=
0;
then
we
see
that
the
sheaf
R
â€ 
F
1
(B)
=
J;
Eâˆ,crys
(B)
F
â‰¤0
(B)
=
B
â€ 
of
functions
on
Eâˆ,crys
(B)
(pushed
forward
topo-
logically
to
Eâˆ
)
gets
a
ï¬ltration
whose
F
0
(âˆ’)
we
denote
by
R0
â€ 
â€ 
â€ 
If
one
restricts
functions
on
Eâˆ,crys
(B)
to
Eâˆ,crys
(R)
=
Eâˆ
(R),
then
one
obtains
a
surjection
R0
â†’
OEâˆ
which
ï¬ts
into
an
exact
sequence
0
âˆ’â†’
J
âŠ—
F
âˆ’1
(R
â€ 
)
R
Eâˆ
âˆ’â†’
R0
âˆ’â†’
OEâˆ
âˆ’â†’
âˆ’â†’
âˆ’â†’
0
Let
us
write
def
RJ
=
R0
/J
Â·
OEâˆ
Thus,
we
have
an
exact
sequence
0
âˆ’â†’
(J
âŠ—R
Ï„E
)
âŠ—
OEâˆ
R
âˆ’â†’
RJ
347
OEâˆ
0
The
evaluation
map
that
we
will
consider
in
this
Â§
(which
gives
rise
to
the
comparison
isomorphism
of
Hodge-Tate
theory)
will
be
deï¬ned
by
restricting
functions
in
R0
to
the
â€ 
p-power
torsion
points
pn
Eâˆ,crys
(BQp
)
(and
then
noting
that
this
restriction
map
factors
through
RJ
).
â€ 
More
precisely,
since
sections
of
R0
are
functions
on
Eâˆ,crys
(B),
hence
deï¬ne
funcâ€ 
â€ 
tions
on
Eâˆ,crys
(BQp
),
we
may
restrict
them
to
the
points
of
pn
Eâˆ,crys
(BQp
)
to
obtain
a
morphism
def
â€ 
(BQp
),
BQp
)
=
ÎQp
[pn
]
:
R0
â†’
Func(pn
Eâˆ,crys

BQp
â€ 
Î³âˆˆpn
Eâˆ,crys
(BQp
)
Now
we
have
the
following:
Lemma
2.1.
The
morphism
ÎQp
[pn
]
reduced
modulo
JQp
âŠ†
BQp
maps
into
R
âŠ†
RQp
.
Proof.
Indeed,
this
follows
from
the
deï¬nition
of
R0
,
together
with
the
fact
that
the
image
â€ 
of
pn
Eâˆ,crys
(RQp
)
in
Eâˆ
(RQp
)
maps
into
Eâˆ
(R)
âŠ†
Eâˆ
(RQp
)
(i.e.,
all
the
p-torsion
points
of
Eâˆ
over
RQp
are
already
deï¬ned
over
R).

â€ 
Thus,
it
follows
that
ÎQp
[pn
]
maps
J
Â·
O(Eâˆ
)
âŠ†
R0
into
Func(pn
Eâˆ,crys
(BQp
),
J)
âŠ†
R
â€ 
Func(pn
Eâˆ,crys
(BQp
),
BQp
).
In
particular,
if
we
compose
ÎQp
[pn
]
with
the
projection
â€ 
â€ 
(BQp
),
BQp
)
â†’
Func(pn
Eâˆ,crys
(BQp
),
BQp
/Zp
)
Func(pn
Eâˆ,crys
def
â€ 
(where
BQp
/Zp
=
B
âŠ—
Qp
/Zp
)
we
get
a
morphism
R0
â†’
Func(pn
Eâˆ,crys
(BQp
),
BQp
/Zp
)
â€ 
which
vanishes
on
the
kernel
of
R0
â†’
RJ
and
maps
into
Func(pn
Eâˆ,crys
(BQp
),
JQp
/Zp
),
i.e.,
a
morphism
ÎRJ
[pn
]
:
RJ
â†’
Func(TE
âŠ—
Z/pn
Â·
Z,
JQp
/Zp
)
â€ 
(since
TE
âŠ—
Z/pn
Â·
Z
=
pn
Eâˆ,crys
(BQp
)).
Let
us
analyze
this
morphism
ÎRJ
[pn
]
in
more
detail.
First,
let
us
observe
from
the
deï¬nitions
that
R0
has
a
natural
ring
structure
(inherited
from
the
ring
structure
).
Moreover,
it
follows
immediately
from
the
deï¬nitions
that
the
evaluation
of
O
â€ 
Eâˆ,crys
map
ÎQp
[pn
]
is
a
ring
homomorphism.
Note
also
that
Func(TE
âŠ—
Z/pn
Â·
Z,
JQp
/Zp
)
has
a
natural
R0
-module
structure
deï¬ned
by
ÎQp
[pn
].
348
Lemma
2.2.
a
derivation.
The
restriction
R0
â†’
Func(TE
âŠ—
Z/pn
Â·
Z,
JQp
/Zp
)
of
ÎRJ
[pn
]
to
R0
is
Proof.
Suppose
that
f,
g
are
local
sections
of
R0
.
Write:
(ÎQp
[pn
])(f
)
=
Î±0
+
Î±J
;
(ÎQp
[pn
])(g)
=
Î²0
+
Î²J
where
Î±0
,
Î²0
âˆˆ
B,
and
Î±J
,
Î²J
âˆˆ
JQp
.
(Note
that
the
fact
that
such
Î±0
,
Î²0
,
Î±J
,
Î²J
exist
follows
from
Lemma
2.1.)
Then
since
ÎQp
[pn
]
is
a
ring
homomorphism,
we
obtain
that:
(ÎQp
[pn
])(f
g)
=
(ÎQp
[pn
])(f
)
Â·
(ÎQp
[pn
])(g)
=
(Î±0
+
Î±J
)
Â·
(Î²0
+
Î²J
)
=
Î±0
Â·
Î²J
+
Î²0
Â·
Î±J
+
Î±0
Â·
Î²0
But
Î±0
Â·
Î²0
âˆˆ
B,
so
modulo
B,
we
obtain:
(ÎQp
[pn
])(f
g)
â‰¡
Î±0
Â·
Î²J
+
Î²0
Â·
Î±J
â‰¡
f
Â·
(ÎQp
[pn
])(g)
+
g
Â·
(ÎQp
[pn
])(f
)
This
completes
the
proof.

â€ 
Next,
let
us
observe
that
the
crystal
Eâˆ,crys
gives
rise
to
a
crystal
Î©
â€ 
(the
sheaf
Eâˆ,crys
â€ 
of
diï¬€erentials
of
Eâˆ,crys
over
the
base,
i.e.,
thickening
of
R,
in
question)
of
modules
over
(where
R
â€ 
is
the
topological
push-forward
to
Eâˆ
of
the
structure
sheaf
of
R
â€ 
Eâˆ,crys
Eâˆ,crys
â€ 
Eâˆ,crys
).
Let
us
denote
by
Î©invâ€ 
Eâˆ,crys
âŠ†Î©
â€ 
Eâˆ,crys
the
subsheaf
of
invariant
diï¬€erentials
(cf.
the
discussion
at
the
beginning
of
the
Appendix).
Thus,
Î©invâ€ 
forms
a
crystal
in
(rank
two)
vector
bundles
over
Spf(R),
and
we
have
an
Eâˆ,crys
isomorphism
of
crystals:
Î©invâ€ 
Eâˆ,crys
âŠ—R
â€ 
Eâˆ,crys
âˆ¼
=Î©
â€ 
Eâˆ,crys
(where
the
tensor
product
is
over
the
base,
i.e.,
thickening
of
R,
in
question).
Note
that
Î©invâ€ 
(i.e.,
Î©invâ€ 
Eâˆ
evaluated
on
Spf(R))
admits
a
natural
two-step
Hodge
ï¬ltration,
whose
Eâˆ,crys
349
F
0
=
Î©invâ€ 
;
F
2
=
0;
and
F
1
consists
of
the
invariant
diï¬€erentials
Ï‰E
on
Eâˆ
.
(Thus,
F
0
/F
1
Eâˆ
may
be
identiï¬ed
with
Ï„E
.)
Tensoring
this
ï¬ltration
with
the
ï¬ltration
discussed
above
on
R
â€ 
gives
rise
to
a
ï¬ltration
on
Î©
â€ 
.
Moreover,
these
ï¬ltrations
deï¬ne
ï¬ltrations
on
the
Eâˆ
Eâˆ
evaluations
(on
various
thickenings
of
Spf(R))
of
the
corresponding
crystals.
Thus,
if
we
evaluate
these
crystals
on
Spf(B),
we
obtain:
F
1
(Î©invâ€ 
Eâˆ,crys
)|Spf(B)
âŠ†
F
1
(Î©
â€ 
Eâˆ,crys
)|Spf(B)
âŠ†
Î©
â€ 
Eâˆ,crys
|Spf(B)
Note
that
we
have
a
natural
inclusion
F
1
(Î©invâ€ 
)
âŠ—
Ker(R0
â†’
OEâˆ
))
â†’
F
1
(Î©
â€ 
Eâˆ
R
Eâˆ,crys
|Spf(B)
)
Let
us
write
def
Î©J
â€ 
=
F
1
(Î©
â€ 
|Spf(B)
)/(F
1
(Î©invâ€ 
)
âŠ—
Ker(R0
â†’
OEâˆ
))
Eâˆ
Eâˆ
R
Eâˆ
def
Î©Inv,J
=
(F
1
/F
2
)(Î©invâ€ 
)|Spf(B)
â€ 
E
E
âˆ
âˆ
Thus,
we
have
a
commutative
diagram
of
R-modules:
0
âˆ’â†’
J
âŠ—R
Ï„E
â
â

0
âˆ’â†’
(J
âŠ—R
Ï„E
)
âŠ—
OEâˆ
R
âˆ’â†’
Î©Inv,J
â€ 
Eâˆ
â
â

âˆ’â†’
âˆ’â†’
Î©J
â€ 
âˆ’â†’
Î©
Eâˆ
Ï‰E
âŠ—R
R
â
â

âˆ’â†’
0
=
Ï‰E
âŠ—R
OEâˆ
âˆ’â†’
0
Eâˆ
/R
In
particular,
we
see
that
we
obtain
a
natural
isomorphism
Î©Inv,J
âŠ—
OEâˆ
âˆ¼
=
Î©J
â€ 
â€ 
R
E
E
âˆ
âˆ
On
the
other
hand,
it
follows
immediately
from
the
deï¬nitions
of
the
various
ï¬ltrations
|Spf(B)
induces
a
morphism
R0
â†’
that
the
exterior
derivative
d
(over
B)
on
R
â€ 
Eâˆ,crys
F
1
(Î©
â€ 
|Spf(B)
),
hence
(by
projecting)
a
morphism
Eâˆ
R0
â†’
Î©
J
â€ 
Eâˆ
350
which
is
easily
seen
to
vanish
on
J
Â·
O(Eâˆ
)
.
Thus,
we
obtain
that
the
exterior
derivative
R
induces
a
derivation
RJ
â†’
Î©
J
â€ 
Eâˆ
from
the
ring
RJ
to
the
module
Î©J
â€ 
,
hence
a
natural
morphism
Eâˆ
Î©
J
R
/R
â†’
Î©J
â€ 
Eâˆ
But
one
computes
easily
(using
the
exact
sequence
considered
above
in
which
RJ
appears
as
the
term
in
the
middle)
that
this
morphism
is
an
isomorphism
(where
we
use
that
p
=
2!),
i.e.,
we
have
proven
the
following
We
have:
Î©
J
Lemma
2.3.
R
/R
âˆ¼
=
Î©J
â€ 
.
Eâˆ
Thus,
the
well-known
relation
between
derivations
and
diï¬€erentials
implies
(by
Lemmas
2.2,
2.3)
that
ÎRJ
[pn
]
factors
as
the
composite
of
the
tautological
derivation
d
R
J
:
RJ
â†’
Î©
J
R
/R
âˆ¼
=
Î©J
â€ 
Eâˆ
and
a
morphism
Î©J
â€ 
â†’
Func(TE
âŠ—
Z/pn
Â·
Z,
JQp
/Zp
)
Eâˆ
If
we
then
restrict
to
the
invariant
diï¬€erentials
Î©Inv,J
âŠ†
Î©J
â€ 
,
we
get
a
morphism
â€ 
E
E
âˆ
âˆ
Î¨[pn
]
:
Î©Inv,J
â†’
Func(TE
âŠ—
Z/pn
Â·
Z,
JQp
/Zp
)
â€ 
E
âˆ
Lemma
2.4.
The
image
of
Î¨[pn
]
lies
in
the
subset
Hom(TE
âŠ—
Z/pn
Â·
Z,
JQp
/Zp
)
âŠ†
Func(TE
âŠ—
Z/pn
Â·
Z,
JQp
/Zp
)
of
â€œfunctions
that
are
compatible
with
the
additive
group
operations
on
TE
âŠ—
Z/pn
Â·
Z
and
JQp
/Zp
.â€
Proof.
Indeed,
this
follows
by
observing
that
since
the
deï¬nition
of
Î¨[pn
]
is
â€œnatural,â€
it
is
functorial
with
respect
to
the
homomorphism
Î¼
:
Eâˆ
Ã—
Eâˆ
â†’
Eâˆ
(deï¬ned
by
the
R
351
group
law
on
the
group
scheme
Eâˆ
).
On
the
other
hand,
(by
the
functoriality
of
invariant
diï¬€erentials
with
respect
to
homomorphisms)
the
pull-back
to
Eâˆ
Ã—
Eâˆ
of
any
section
Î±
R
of
Î©Inv,J
is
simply
(Î±,
Î±).
Put
another
way,
this
implies
that
to
evaluate
(Î¨[pn
])(Î±)
on
the
â€ 
Eâˆ
sum
of
two
elements
of
TE
âŠ—
Z/pn
Â·
Z
is
the
same
as
the
sum
of
the
values
of
(Î¨[pn
])(Î±)
at
each
of
these
two
elements,
i.e.,
the
function
(Î¨[pn
])(Î±)
âˆˆ
Func(TE
âŠ—
Z/pn
Â·
Z,
JQp
/Zp
)
is
additive,
as
desired.

Note
that
the
additivity
property
of
Lemma
2.4
implies
that:
(i)
the
image
of
Î¨[pn
]
is
annihilated
by
pn
;
(ii)
for
Î±
âˆˆ
Î©Inv,J
,
the
function
(Î¨[pnâˆ’1
])(Î±)
is
the
function
induced
by
â€ 
Eâˆ
(p
Â·
Î¨[pn
])(Î±)
on
the
quotient
TE
âŠ—
Z/pn
Â·
Z
â†’
TE
âŠ—
Z/pnâˆ’1
Â·
Z.
In
particular,
by
taking
the
inverse
limit,
we
obtain
a
morphism:
Î¨Zp
:
Î©Inv,J
â†’
Hom(TE
,
J)
â€ 
E
âˆ
This
morphism
is
the
morphism
that
deï¬nes
the
Hodge-Tate
decomposition
(cf.,
e.g.,
the
ï¬nal
Theorem
â€“
i.e.,
the
â€œrelative
versionâ€
â€“
in
[Hyodo],
Â§0.3).
The
following
result
may
be
regarded
as
the
main
theorem
of
the
Hodge-Tate
theory
of
an
elliptic
curve:
Theorem
2.5.
The
morphism
Î¨Zp
:
Î©Inv,J
â†’
Hom(TE
,
J)
â€ 
E
âˆ
1
is
invertible
over
Qp
,
and
its
inverse
has
poles
annihilated
by
p
(pâˆ’1)
.
Proof.
Note
that
Î¨Zp
is
an
R-linear
morphism
between
free
R-modules
of
rank
2.
Moreover,
its
determinant
may
be
regarded
as
a
morphism
det(Î¨Zp
)
:
J
â†’
det(TE
)âˆ¨
âŠ—Zp
J
âŠ—2
=
J
âŠ—2
(âˆ’1)
i.e.,
this
determinant
may
be
thought
of
as
an
element
D
âˆˆ
Hom
(J,
J
âŠ—2
(âˆ’1))
=
J(âˆ’1)
=
HomZp
(Zp
(1),
J)
R
I
claim
that
(up
to
a
sign)
this
element
is
the
morphism
Î²
:
Zp
(1)
â†’
J
discussed
at
the
beginning
of
this
Â§.
(Note
that
this
is
suï¬ƒcient
to
complete
the
proof
of
Theorem
2.5.)
In
order
to
prove
this
claim,
let
us
ï¬rst
observe
that
it
suï¬ƒces
to
prove
it
when
the
present
S
is
replaced
by
the
(formal
scheme
given
by
the)
completion
of
S
along
D.
Indeed,
this
is
clear
when
this
completion
along
the
divisor
at
inï¬nity
D
is
â€œschematically
denseâ€
352
in
S
(i.e.,
the
map
from
functions
on
S
to
functions
on
this
completion
is
injective).
But
this
holds
in
the
â€œuniversal
case,â€
i.e.,
when
the
original
S
is
eÌtale
over
(the
padic
completion
of)
the
moduli
stack
(M1,0
)Zp
.
Thus,
it
suï¬ƒces
to
work
in
a
formal
neighborhood
of
inï¬nity.
In
particular,
for
the
rest
of
the
proof,
we
assume
that
S
is
such
a
formal
neighborhood.
Then,
by
Chapter
III,
Theorem
2.1,
we
have
an
exact
sequence
of
group
objects
â€ 
â†’W
â†’0
0
â†’
(Gm
)S
â†’
Eâˆ
E
over
S.
(Here,
WE
is
the
aï¬ƒne
group
object
associated
to
Ï‰E
.)
Let
us
observe
that,
â€ 
relative
to
the
structure
of
Eâˆ
as
a
crystal
over
Spf(R),
this
exact
sequence
is
horizontal.
â€ 
Indeed,
the
subobject
(Gm
)S
âŠ†
Eâˆ
may
be
recovered
as
the
(formal)
schematic
closure
â€ 
of
the
prime-to-p
torsion
points
of
Eâˆ
that
lie
inside
(Gm
)S
.
But
it
is
clear
that
the
subschemes
deï¬ned
by
these
torsion
points
are
horizontal.
Thus,
we
see
that
this
exact
sequence
is
horizontal,
as
desired.
Next,
observe
that,
since
we
are
working
in
a
formal
neighborhood
of
inï¬nity,
the
Î“R
-module
ï¬ts
into
a
natural
exact
sequence
of
Î“R
-modules:
0
â†’
Z/pn
Â·
Z(1)
â†’
TE
âŠ—
Z/pn
Â·
Z
â†’
Z/pn
Â·
Z
â†’
0
Moreover,
if
we
consider
the
aï¬ƒne
coordinate
â€œT
â€
on
WE
corresponding
to
the
trivialization
of
Ï‰E
given
by
â€œd
log(U
)â€
(notation
of
Chapter
III,
Â§5),
then
it
follows
from
Chapter
III,
Corollary
5.9,
that
the
image
under
ÎRJ
[pn
]
of
the
section
of
RJ
deï¬ned
by
â€œT
Â·
jâ€
(where
j
âˆˆ
J)
is
the
function
on
TE
âŠ—Z/pn
Â·
Z
that
arises
by
pulling
back
(to
TE
âŠ—Z/pn
Â·
Z)
the
J-valued
function
on
Z/pn
Â·
Z
that
maps
b
âˆˆ
Z/pn
Â·
Z
to
b
Â·
j.
Thus,
in
particular,
applying
Hom(âˆ’,
J)
to
the
inverse
limit
as
n
â†’
âˆ
of
the
above
exact
sequence
â€”
which
yields
an
exact
sequence
0
â†’
J
â†’
Hom(TE
,
J)
â†’
J(âˆ’1)
â†’
0
â€”
we
see
that
Î¨Zp
maps
T
Â·J
âŠ†
Î©Inv,J
to
J
âŠ†
Hom(TE
,
J)
isomorphically
via
the
morphism
â€ 
Eâˆ
given
by
T
â†’
1.
Thus,
it
remains
to
consider
what
happens
when
functions
on
(Gm
)S
are
restricted
to
Z/pn
Â·
Z(1)
âŠ†
TE
âŠ—
Z/pn
Â·
Z.
In
particular,
we
would
like
to
investigate
the
image
of
the
invariant
diï¬€erential
d
log(U
)
under
Î¨[pn
].
But
since
Î¨[pn
]
was
deï¬ned
by
factoring
the
derivation
ÎRJ
[pn
]
(cf.
Lemma
2.2)
through
the
tautological
derivation,
it
follows
that
this
amounts
to
investigating
the
behavior
of
the
function
â€œlog(U
)â€
on
Z/pn
Â·
Z(1)
âŠ†
(Gm
)S
.
But
then
it
follows
from
the
deï¬nition
of
the
morphism
Î²
:
Zp
(1)
â†’
J
(which
is
essentially
given
by
taking
the
logarithm
of
p-power
roots
of
unity!
â€”
cf.
[Falt2],
II.,
(b.))
that
(up
to
a
sign),
if
we
take
the
inverse
limit
as
n
â†’
âˆ,
the
image
of
d
log(U
)
âˆˆ
Ï‰E
âŠ†
Î©invâ€ 
/(J
âŠ—R
Ï„E
)
Eâˆ
353
under
the
composite
of
Î¨Zp
with
the
quotient
Hom(TE
,
J)
â†’
J(âˆ’1)
is
precisely
Î²
âˆˆ
Hom(Zp
(1),
J)
=
J(âˆ’1).
More
explicitly,
let
Î¶
âˆˆ
R
be
a
pn
-th
root
of
unity.
Write
def
Î¶
âˆˆ
pâˆ’n
Â·
Zp
(1)
âŠ†
Qp
(1)
for
an
element
such
that
z
=
Î²Qp
(Î¶)
â‰¡
Î¶
modulo
J.
Note
that
def
z
âˆˆ
B
itself
is
not
necessarily
a
pn
-th
root
of
unity.
If
Î´
=
âˆ’pâˆ’n
Â·Î¶
Â·Î²(pn
Â·
Î¶)
âˆˆ
pâˆ’n
Â·J
âŠ†
JQp
,
then
(z
+
Î´)p
=
z
p
+
pn
Â·
z
p
âˆ’1
Â·
Î´
=
1
+
Î²(pn
Â·
Î¶)
+
pn
Â·
Î¶
âˆ’1
Â·
Î´
=
1
n
n
n
i.e.,
z
+
Î´
âˆˆ
Î¼pn
(B).
Thus,
the
evaluation
map
â€œmodulo
Bâ€
(cf.
the
deï¬nition
of
ÎRJ
[pn
]
above)
maps
the
function
U
on
(Gm
)S
to
the
image
of
z
+
Î´
in
BQp
/Zp
.
In
fact,
this
image
is
equal
to
the
image
Î´
âˆˆ
JQp
/Zp
of
Î´.
Put
another
way,
we
obtain
that
dU
â†’
Î´,
so
d
log(U
)
=
U
âˆ’1
Â·
dU
â†’
Î¶
âˆ’1
Â·
Î´
=
âˆ’pâˆ’n
Â·
Î²(pn
Â·
Î¶)
(mod
J)
âˆˆ
JQp
/Zp
.
Taking
the
inverse
limit
as
n
â†’
âˆ,
we
thus
obtain
that,
in
this
inverse
limit,
d
log(U
)
â†’
âˆ’Î²,
as
desired.
Thus,
combining
this
with
what
was
done
in
the
preceding
paragraph,
we
see
that
the
determinant
D
in
question
is
equal
to
Â±Î²,
as
claimed.

Remark.
The
isomorphism
of
Theorem
2.5
is
the
Hodge-Tate
Comparison
Isomorphism
of
an
elliptic
curve.
If
one
restricts
it
to
a
point
Î±
of
S
valued
in
some
ï¬nite
extension
L
of
K,
def
then
it
follows
from
the
facts
H
1
(Î“L
,
L(1))
=
0,
H
0
(Î“L
,
L)
=
L
(where
Î“L
=
Gal(L/L))
that
Î©invâ€ 
|Î±
admits
a
unique
Î“L
-invariant
splitting
Eâˆ
Î©invâ€ 
|Î±
=
Ï‰E
|Î±
âŠ•
Ï„E
(1)|Î±
Eâˆ
(where
we
use
that
JQp
=
RQp
(1)),
hence
that
Theorem
2.5
gives
us
an
isomorphism
Ï‰E
|Î±
âŠ•
Ï„E
(1)|Î±
âˆ¼
=
TE
âŠ—Zp
L
This
is
the
usual
form
in
which
the
Hodge-Tate
â€œcomparison
isomorphismâ€/decomposition
is
stated.
The
important
point
here
is
that
this
well-known
isomorphism
is
essentially
deï¬ned
by
restricting
functions
on
the
universal
extension
of
E
to
p-power
torsion
points
(cf.
the
deï¬nition
of
ÎQp
[pn
]),
i.e.,
The
Hodge-Tate
Comparison
Isomorphism
is
deï¬ned
in
a
fashion
which
is
entirely
analogous
to
the
deï¬nition
of
the
Hodge-Arakelov
Comparison
Isomorphism
(Chapter
VIII,
Theorem
A).
Note,
moreover,
that
after
reducing
ÎQp
[pn
]
â€œmodulo
Zp
,â€
and
factoring
through
the
tautological
derivation
dRJ
,
we
restricted
to
the
invariant
diï¬€erentials
on
the
universal
354
extension.
Thus,
put
another
way,
the
comparison
isomorphism
of
Theorem
2.5
was
deï¬ned
essentially
by
integrating
invariant
diï¬€erentials,
and
then
restricting
the
resulting
functions
to
p-power
torsion
points.
(Thus,
these
â€œresulting
functionsâ€
are
essentially
â€œlogarithmâ€
type
functions,
of
the
sort
reviewed
in
the
Appendix.)
Regarded
from
this
point
of
view,
we
thus
also
see
the
explicit
analogy
between
this
p-adic
comparison
isomorphism
and
its
complex
counterpart
in
Â§1.
Finally,
we
make
the
connection
between
the
above
discussion
of
the
Hodge-Tate
Comparison
Isomorphism
and
the
arithmetic
Kodaira-Spencer
morphism.
In
keeping
with
the
analogy
to
the
theory
of
Â§1,3,
we
start
oï¬€
with
the
comparison
isomorphism
(Theorem
2.5):
Î¨Qp
:
E
=
(Î©Inv,J
)Qp
âˆ¼
=
Hom(TE
,
JQp
)
=
VEâˆ¨
(1)
âŠ—Qp
RQp
âˆ¼
=
VE
âŠ—Qp
RQp
â€ 
E
def
âˆ
def
def
(where
Î¨Qp
=
Î¨Zp
âŠ—
Qp
,
VE
=
TE
âŠ—
Qp
).
Since
VE
âŠ—Qp
RQp
has
a
natural
Î“R
-action,
we
thus
obtain
a
natural
Î“R
-action
on
E.
This
technique
of
obtaining
a
Galois
action
on
the
de
Rham
side
of
the
comparison
isomorphism
by
pulling
back
(via
the
comparison
isomorphism)
the
natural
Galois
action
on
the
eÌtale
side
is
entirely
analogous
to
what
is
done
in
Â§1,3.
Thus,
we
have
a
natural
Î“R
-action
on
E.
Note,
moreover,
that
we
have
an
exact
sequence
of
RQp
-modules:
0
â†’
Ï„E
(1)
âŠ—R
RQp
â†’
E
â†’
Ï‰E
âŠ—R
RQp
â†’
0
(where
we
identify
JQp
with
RQp
(1)
via
Î²).
Moreover,
it
is
easy
to
see
from
the
deï¬nition
of
ÎRJ
[pn
]
that
the
natural
Galois
action
on
Ï„E
(1)
âŠ—R
RQp
âŠ†
E
is
compatible
with
the
Galois
action
on
VE
âŠ—Qp
RQp
.
Thus,
this
submodule
is
stabilized
by
Î“R
,
and
the
above
exact
sequence
is
an
exact
sequence
of
Î“R
-modules.
(Note
that
the
fact
that
the
Galois
action
on
Ï‰E
âŠ—R
R
arising
from
the
Galois
action
on
E
is
the
expected
action
may
be
derived
using
determinants,
as
in
the
proof
of
Theorem
2.5.)
We
observe
that
this
exact
sequence
is
essentially
the
same
as
that
of
[Mzk3],
Proposition
2.4.
This
exact
sequence
thus
deï¬nes
a
cohomology
class
Î·KS
âˆˆ
H
1
(Î“R
,
Hom
RQp
(Ï‰E
âŠ—R
RQp
,
Ï„E
(1)
âŠ—R
RQp
))
=
H
1
(Î“R
,
Ï„EâŠ—2
(1)
âŠ—R
RQp
)
Such
a
cohomology
class
may
be
thought
of
as
an
equivalence
class
of
twisted
homomordef
âŠ—2
=
Ï„E
(1)
âŠ—R
RQp
,
where
we
consider
twisted
homomorphisms
phisms
Î“R
â†’
Ï„EâŠ—2
(1)
R
Qp
355
that
diï¬€er
by
(the
twisted
homomorphism
deï¬ned
by)
a
coboundary
to
be
equivalent.
We
would
like
to
regard
this
equivalence
class
of
twisted
homomorphisms
which,
by
abuse
of
notation,
we
write
:
Î“R
â†’
Ï„EâŠ—2
(1)
Îºarith,p
R
R
Qp
as
a
sort
of
p-adic
(Galois)
group-theoretic/arithmetic
Kodaira-Spencer
morphism,
analarith
â€
in
Â§3.
Note
that
the
construction
of
ogous
to
the
morphisms
â€œÎºfunc
SL2
â€
of
Â§1,
and
â€œÎºE
arith,p
starting
from
the
comparison
isomorphism
is
entirely
analogous
to
what
is
done
in
ÎºR
Â§1,3.
as
a
sort
of
Kodaira-Spencer
morphism,
To
explain
why
it
is
natural
to
regard
Îºarith,p
R
we
must
recall
the
theory
of
[Falt1].
In
[Falt1],
I.,
Â§4,
(b),
(f),
a
certain
natural
extension
of
Î“R
-modules
0
â†’
pâˆ’
(pâˆ’1)
Â·
R
â†’
EÏ
â†’
Î©log
S
(âˆ’1)
âŠ—R
R
â†’
0
1
def
def
âˆ¨
(where
Î©log
=
Î©S
log
/A
)
is
constructed.
If
we
write
Î˜log
=
(Î©log
S
S
S
)
for
the
logarithmic
tangent
bundle
of
S
log
over
A,
then
we
get
an
element
Î·Falt
âˆˆ
H
1
(Î“R
,
Î˜log
S
(1)
âŠ—R
RQp
)
This
element
may
be
thought
of
as
a
twisted
homomorphism
Falt
Î¾R
:
Î“R
â†’
Î˜log
S
(1)
R
Qp
On
the
other
hand,
we
have
the
classical
Kodaira-Spencer
morphism
âŠ—2
Îºclass
:
Î˜log
R
S
â†’
Ï„E
given
by
observing
the
extent
to
which
the
Hodge
ï¬ltration
of
the
crystal
Î©
â€ 
varies
as
Eâˆ
one
moves
in
various
tangent
directions
âˆˆ
Î˜log
S
.
Then
the
relationship
between
the
p-adic
arith,p
and
the
classical
Kodaira-Spencer
morphism
arithmetic
Kodaira-Spencer
morphism
ÎºR
class
Falt
ÎºR
is
given
by
Faltingsâ€™
morphism
Î¾R
,
as
described
in
Theorem
2.6
below.
Remark.
If
we
write
def
def
Î”R
=
Ker(Î“R
â†’
Î“K
=
Gal(K/K))
356
for
the
geometric
portion
of
the
Galois
group
Î“R
,
then
according
to
the
theory
of
â€œalmost
eÌtale
extensionsâ€
discussed
in
[Falt1],
â€œÎ”R
âŠ—Zp
RQp
â€
(notation,
which,
of
course,
is
not
deï¬ned
rigorously,
but
is
meant
to
be
suggestive
of
what
is
going
on)
may
roughly
be
identiï¬ed
with
Î˜log
S
(1)
âŠ—R
RQp
,
that
is
to
say,
over
RQp
,
the
geometric
Galois
group
Î”R
log
of
S
is
â€œalmost
equivalentâ€
to
the
tangent
bundle
of
S
log
,
hence
may
be
thought
of
as
a
group
of
â€œmotions
in
S
log
.â€
From
this
â€œalmostâ€
point
of
view,
it
is
thus
natural
that
the
domain
of
our
p-adic
arithmetic
Kodaira-Spencer
morphism
Îºarith,p
is
the
Galois
group
R
Î“R
.
Theorem
2.6.
We
have
a
commutative
diagram:
Î“R
â
â
id
Î“R
Falt
âˆ’Î¾R
âˆ’â†’
Îºarith,p
R
âˆ’â†’
Î˜log
S
(1)R
Qp
â
class
âÎºR
(1)

RQ
p
Ï„EâŠ—2
(1)
R
Qp
i.e.,
in
terms
of
cohomology
classes,
the
change
of
coeï¬ƒcients
morphism
âŠ—2
1
H
1
(Î“R
,
Î˜log
S
(1)
âŠ—R
RQp
)
â†’
H
(Î“R
,
Ï„E
(1)
âŠ—R
RQp
)
deï¬ned
by
Îºclass
maps
âˆ’Î·Falt
â†’
Î·KS
.
R
Proof.
First
of
all,
since
both
Î·Falt
and
Î·KS
are
clearly
functorial
in
R,
it
suï¬ƒces
to
prove
the
result
in
the
universal
case,
i.e.,
the
case
where
S
is
(formally)
eÌtale
over
the
p-adic
completion
of
the
moduli
stack
(M1,0
)Zp
.
Thus,
for
the
rest
of
the
proof,
we
assume
that
we
are
dealing
with
such
an
S.
Let
us
write
def
def
Î”R
=
Ker(Î“R
â†’
Î“K
=
Gal(K/K))
Then
observe
that
by
the
theory
of
[Falt1]
(cf.
especially
[Falt1],
p.
270,
Theorem
4.4,
(i)),
it
follows
that
H
0
(Î“K
,
H
1
(Î”R
,
Ï„EâŠ—2
(1)
âŠ—R
RQp
))
is
a
free
RQp
-module
of
rank
1,
while
H
1
(Î“K
,
H
0
(Î”R
,
Ï„EâŠ—2
(1)
âŠ—R
RQp
))
=
0
(cf.
the
well-known
fact
that
H
1
(Î“K
,
K(1))
=
0;
[Mzk3],
Lemma
2.2).
Thus,
by
the
Leray-Serre
spectral
sequence,
we
obtain
that
H
1
(Î“R
,
Ï„EâŠ—2
(1)
âŠ—R
RQp
)
â†’
H
0
(Î“K
,
H
1
(Î”R
,
Ï„EâŠ—2
(1)
âŠ—R
RQp
))
(âˆ¼
=
RQp
)
i.e.,
that
two
classes
in
H
1
(Î“R
,
Ï„EâŠ—2
(1)
âŠ—R
RQp
)
coincide
if
and
only
if
they
coincide
after
restriction
to
a
formal
neighborhood
of
the
divisor
at
inï¬nity
D
(cf.
the
proof
of
Theorem
2.5).
Thus,
it
suï¬ƒces
to
prove
the
result
in
the
case
where
S
is
a
such
a
formal
neighborhood.
357
In
this
case,
however,
it
follows
from
the
construction
of
the
extension
â€œEÏ
â€
in
[Falt1],
I.,
Â§4,
that
Î·Falt
is
essentially
given
by
the
image
of
the
class
âˆˆ
H
1
(Î“R
,
Zp
(1))
obtained
by
extracting
p-power
roots
of
the
q-parameter
under
the
change
of
coeï¬ƒcients
morphism
H
1
(Î“R
,
Zp
(1))
â†’
H
1
(Î“R
,
Î˜log
S
(1)
âŠ—R
RQp
)
deï¬ned
by
the
â€œtangent
vectorâ€
âˆ‚/âˆ‚log(q).
On
the
other
hand,
it
follows
from
the
discussion
in
the
proof
of
Theorem
2.5
that
the
extension
Î·KS
is
simply
the
extension
class
of
the
exact
sequence
0
â†’
Zp
(1)
â†’
TE
â†’
Zp
â†’
0
pushed
forward
by
the
change
of
coeï¬ƒcients
morphism
H
1
(Î“R
,
Zp
(1))
â†’
H
1
(Î“R
,
Ï„EâŠ—2
(1)
âŠ—R
RQp
)
deï¬ned
by
(âˆ‚/âˆ‚U
)âŠ—2
(notation
of
the
proof
of
Theorem
2.5).
On
the
other
hand,
since
it
is
well-known
that
the
classical
Kodaira-Spencer
morphism
maps
âˆ‚/âˆ‚log(q)
â†’
âˆ’(âˆ‚/âˆ‚U
)âŠ—2
(cf.,
e.g.,
[FC],
p.
84,
the
second
paragraph
preceding
Lemma
9.3,
beginning
â€œAs
an
example...â€),
it
thus
follows
that
âˆ’Î·Falt
â†’
Î·KS
,
as
desired.

Remark.
Put
another
way,
the
message
of
the
proof
of
Theorem
2.6,
and
indeed
of
this
entire
Â§,
is
that:
The
relationship
between
the
p-adic
Galois-theoretic/arithmetic
KodairaSpencer
morphism
and
the
classical
Kodaira-Spencer
morphism
is
the
essential
content
of
Serre-Tate
theory.
For
more
on
this
point
of
view
in
the
case
of
abelian
varieties,
we
refer
to
[Katz].
For
more
on
this
point
of
view
in
a
more
general
context
(in
particular,
the
case
of
hyperbolic
curves),
we
refer
to
[Mzk1],
Introduction;
Chapter
V,
Â§1;
as
well
as
to
[Mzk2],
Introduction,
especially
Â§2.3.
358
Â§3.
The
Global
Arithmetic
Case:
Application
of
the
Hodge-Arakelov
Comparison
Isomorphism
In
this
Â§,
we
apply
the
Hodge-Arakelov
Comparison
Isomorphism
(cf.
Chapter
VIII,
Theorem
A)
to
construct
a
global
arithmetic
analogue
of
the
Kodaira-Spencer
morphism
of
a
family
of
elliptic
curves.
The
technique
of
construction
is
motivated
by
the
point
of
view
discussed
in
Â§1,2,
in
the
complex
and
p-adic
cases.
We
begin
by
discussing
the
behavior
of
the
trivializations
arising
from
theta
groups
at
archimedean
primes.
Thus,
let
E
be
an
elliptic
curve
over
C.
Fix
a
positive
integer
d,
and
write
def
L
=
OE
(d
Â·
[e])
Let
|
âˆ¼
|L
be
a
metric
on
L
whose
curvature
is
translation-invariant.
Recall
from
Chapter
IV,
Â§1,
the
subscheme
of
symmetric
elements
SL
âŠ†
G
L
of
the
theta
group
GL
of
L.
Lemma
3.1.
The
automorphisms
of
(E,
L)
deï¬ned
by
points
of
SL
preserve
|
âˆ¼
|L
.
Proof.
Indeed,
clearly
any
translation
of
a
translation-invariant
(1,
1)-form
is
again
translation-invariant.
Thus,
it
follows
that
for
Î³
=
(Î±,
Î¹)
âˆˆ
SL
,
the
metric
Î³(|
âˆ¼
|L
)
that
one
obtains
on
L
by
ï¬rst
pulling
back
|
âˆ¼
|L
via
Î¹
:
TÎ±âˆ—
L
âˆ¼
=
L,
and
then
applying
âˆ’1
âˆ—
(TÎ±
)
to
produce
(by
transport
of
structure)
a
metric
on
L
has
translation-invariant
curvature.
Thus,
the
metrics
Î³(|
âˆ¼
|L
)
and
|
âˆ¼
|L
both
have
translation-invariant
curvature,
hence
diï¬€er
by
a
positive
constant
Î»Î³
.
Moreover,
since
Î³
âˆˆ
SL
implies
Î³
N
âˆˆ
SL
(âˆ€
N
âˆˆ
Z),
it
follows
that
the
correspondence
Î³
â†’
Î»Î³
deï¬nes
a
homomorphism
from
<
Î³
>
(the
subgroup
of
GL
generated
by
Î³,
which
lies
inside
SL
)
to
R>0
(equipped
with
its
multiplicative
group
structure).
Since
<
Î³
>
is
a
ï¬nite
group,
it
thus
follows
that
this
homomorphism
is
trivial,
so
Î»Î³
=
1,
as
desired.

Now
recall
the
â€œtheta
trivializationâ€
Î˜Î±
:
L|TÎ±âˆ—
KL
âˆ¼
=
(L|Î±0
)
âŠ—OK
0
OKL
L
(where
Î±
âˆˆ
KL
)
of
the
discussion
following
Chapter
IV,
Theorem
1.6.
Note
that
both
sides
of
this
isomorphism
may
be
regarded
as
ï¬nite-dimensional
complex
vector
spaces.
Moreover,
both
of
these
vector
spaces
have
natural
metrics,
arising
from
|
âˆ¼
|L
,
and
the
359
fact
that
since
we
are
working
over
C,
the
ring
OKL
may
be
regarded
as
the
ring
of
C-valued
functions
on
the
d-torsion
points
d
E
of
E,
hence
admits
a
natural
L2
-metric
def
||f
||2
=
1

Â·
|f
(Ï„
)|2
d2
Ï„
âˆˆd
E
(for
f
âˆˆ
OKL
).
Since
this
trivialization
is
deï¬ned
by
the
splitting
Ïƒ
:
2
Â·
KL
â†’
GL
of
GL
â†’
KL
discussed
in
Chapter
IV,
Theorem
1.6,
which
factors
through
SL
,
it
follows
from
Lemma
3.1
that:
Lemma
3.2.
If
one
equips
both
sides
of
the
theta
trivialization
Î˜Î±
:
L|TÎ±âˆ—
KL
âˆ¼
=
(L|Î±0
)
âŠ—OK
0
OKL
L
determined
by
the
splitting
Ïƒ
of
Chapter
IV,
Theorem
1.6,
with
their
natural
metrics
(arising
from
|
âˆ¼
|L
,
and
the
L2
-metric
on
OKL
),
then
this
trivialization
Î˜
is
an
isometry.
Remark.
In
particular,
we
may
conclude
the
following:
Recall
the
Comparison
Isomorphism
(cf.
Chapter
V,
Theorem
3.1,
(2);
or,
alternatively,
Chapter
VIII,
Theorem
A,
(2))
â€ 
Î
:
Î“(E[d]
,
LÎ·
)<d
âˆ¼
=
LÎ·
|d
E
def
where
LÎ·
=
TÎ·âˆ—
L,
and
Î·
âˆˆ
E
is
a
torsion
point
of
order
m
not
dividing
d.
Thus,
if
we
compose
this
isomorphism
with
the
trivialization
Î˜Î·
:
L|TÎ·âˆ—
KL
=
LÎ·
|d
E
âˆ¼
=
(L|Î·0
)
âŠ—OK
0
OKL
L
we
get
an
isomorphism
â€ 
Î¨
:
Î“(E[d]
,
TÎ·âˆ—
L)<d
âˆ¼
=
(L|Î·0
)
âŠ—OK
0
OKL
L
of
d-dimensional
vector
spaces
over
C.
Next,
suppose
that
we
are
given
an
automorphism
Î¦
of
the
C-algebra
OKL
which
preserves
and
induces
the
identity
on
the
C-subalgebra
OKL
0
âŠ†
OKL
arising
from
the
quotient
KL
â†’
KL
0
.
Observe
(by
thinking
about
the
fact
that
Î¦
necessarily
arises
as
the
morphism
induced
on
functions
by
some
automorphism
of
the
set
of
d-torsion
points
of
E)
that
such
an
automorphism
Î¦
is
an
isometry
of
OKL
onto
itself
(where
we
equip
OKL
with
the
natural
L2
-metric
of
the
discussion
above).
Note,
moreover,
that
Î¦
induces
an
(isometric)
automorphism
of
(L|Î·0
)
âŠ—OK
0
OKL
,
hence
(by
L
360
â€ 
conjugating
by
Î¨)
an
automorphism
of
Î“(E[d]
,
TÎ·âˆ—
L)<d
.
By
Lemma
3.2
(and
the
deï¬nition
â€ 
of
the
â€œeÌtale
metricâ€
||
âˆ¼
||et
on
Î“(E[d]
,
TÎ·âˆ—
L)<d
),
we
thus
obtain
that:
â€ 
Î¦
induces
an
automorphism
of
Î“(E[d]
,
TÎ·âˆ—
L)<d
which
is
an
isometry
with
respect
to
the
||
âˆ¼
||et
-metric
(cf.
Chapter
VIII,
Theorem
A,
(4)).
This
observation
will
be
of
central
importance
in
the
following
discussion.
Now
let
S
log
be
any
log
scheme
whose
underlying
scheme
is
connected,
ï¬‚at
and
of
ï¬nite
type
over
Z,
and
whose
log
structure
is
deï¬ned
by
a
divisor
with
normal
crossings.
Write
Int(S
log
)
âŠ†
S
for
the
interior
of
S
log
,
i.e.,
the
open
subscheme
where
the
log
structure
is
trivial.
Let
C
log
â†’
S
log
be
a
log
elliptic
curve
over
S
log
as
in
Chapter
VIII,
Theorem
A,
i.e.:
(1)
the
divisor
at
inï¬nity
D
âŠ†
S
(i.e.,
the
pull-back
of
the
divisor
at
inï¬nity
of
(M1,0
)Z
via
the
classifying
morphism
S
â†’
(M1,0
)Z
)
is
a
Cartier
divisor
on
S;
(2)
eÌtale
locally
on
the
completion
of
S
along
D,
the
pull-back
of
the
Tate
parameter
q
to
this
completion
admits
a
d-th
root.
Here,
we
also
make
the
technical
assumption
that
if
d
is
even,
then
the
2-torsion
points
of
E
â†’
S
over
the
interior
of
SQ
are
all
rational
(i.e.,
deï¬ned
over
the
interior
of
SQ
).
Let
us
write
(as
usual)
dE
â†’
S
for
the
ï¬nite,
ï¬‚at
group
scheme
of
d-torsion
points
of
Eâˆ,S
.
Note
that
if
we
tensor
with
Q,
the
resulting
morphism
(d
E)Q
â†’
SQ
is
ï¬nite
eÌtale.
Let
us
ï¬x
a
geometric
point
s
of
log
Int(SQ
)
valued
in
an
algebraically
closed
ï¬eld
of
characteristic
0,
and
write
def
Î S
=
Ï€1
((S
log
)Q
,
s)
log
for
the
algebraic
fundamental
group
of
Int(SQ
).
Also,
let
us
ï¬x
a
geometric
point
sd
of
E
lying
over
s.
Thus,
it
is
clear
that
Î 
acts
naturally
on
(d
E)Q
â†’
SQ
.
d
S
Now
I
claim
that:
361
The
natural
action
of
Î S
on
(d
E)Q
â†’
SQ
extends
(uniquely)
to
an
action
on
d
E
â†’
S,
except
for
possible
poles
annihilated
by
4.
The
uniqueness
of
the
action
follows
immediately
from
the
ï¬‚atness
of
the
morphisms
d
E
â†’
S
and
S
â†’
Spec(Z).
To
prove
existence,
let
us
ï¬rst
observe
that
it
suï¬ƒces
to
verify
this
claim
for
the
â€œuniversal
casesâ€
S
=
(M1,0
)Z
(with
the
trivial
log
structure)
and
def
1
1
S
=
Spec(Z[[q
d
]]),
endowed
with
the
log
structure
deï¬ned
by
the
divisor
V
(q
d
).
In
these
cases,
it
follows
from
the
theory
of
[KM]
(cf.,
[KM],
Chapter
5,
especially
Theorem
5.1.1)
that
the
closed
subscheme
Fd
of
d
E
corresponding
to
points
of
a
given
order
d
is
regular,
hence
normal.
Thus,
it
follows
immediately
that
the
action
of
Î S
extends
to
the
Fd
.
Next,
one
checks
that,
for
instance,
at
the
prime
2,
regular
functions
on
the
disjoint
union
of
the
Fd
regarded
as
rational
functions
on
the
original
d
E
have
poles
annihilated
by
4.
Indeed,
in
our
situation,
since
the
base
S
is
regular
of
dimension
2,
it
suï¬ƒces
to
verify
this
assertion
on
the
ordinary
locus,
where
it
essentially
amounts
to
the
corresponding
assertion
for
Î¼2N
(as
opposed
to
d
E),
where
we
write
2N
for
the
maximal
power
of
2
dividing
d.
But
then
OF
i

F
j
(where
i
<
j
â‰¤
N
)
is
annihilated
by
Î¶2i
âˆ’
Î¶2j
(where
Î¶??
is
a
primitive
2
2
âˆ’j+1
??-th
root
of
unity),
which
has
the
same
2-adic
valuation
as
22
.
Thus,
we
see
that
the
structure
sheaf
of
the
intersection
of
F2i
with
the
union
of
the
other
Fd
â€™s
is
annihilated
by
2
to
the
power
i
Â·
2âˆ’i+1
+
2âˆ’(i+1)+1
+
2âˆ’(i+2)+1
+
.
.
.
+
2âˆ’N
+1
â‰¤
i
Â·
2âˆ’i+1
+
2âˆ’i+1
=
(i
+
1)
Â·
2âˆ’i+1
â‰¤
2
i.e.,
annihilated
by
4
(which
implies
that
the
â€œrational
function
on
Î¼2N
â€
which
is
1
on
F2i
and
0
on
the
other
Fd
â€™s
has
poles
annihilated
by
4,
as
desired).
This
completes
the
proof
of
the
claim
at
the
prime
2.
At
odd
primes,
the
extendability
of
the
action
of
Î S
follows
from
the
fact
that
since
the
universal
bases
in
question
(i.e.,
S
=
(M1,0
)Z
and
def
1
S
=
Spec(Z[[q
d
]]))
are
â€œabsolutely
unramiï¬ed,â€
the
fact
that
d
E
Ïƒ
(where
Ïƒ
âˆˆ
Î S
)
and
d
E
are
â€œequalâ€
over
Q
implies
that
their
integral
structures
at
the
prime
p
are
equal,
as
well
(cf.
[Falt2],
Theorems
2.6,
7.1).
Now
let
us
assume
that
we
are
also
given
a
torsion
point
Î·
âˆˆ
Eâˆ,S
(Sâˆ
)
of
order
precisely
m
âˆˆ
Zâ‰¥1
(where
m
does
not
divide
d)
which
allows
us
to
deï¬ne
a
(Zhangtheoretically
metrized)
line
bundle
L
as
in
Chapter
VIII,
Theorem
A.
Note
that
KL
â†’
S
may
be
identiï¬ed
with
d
E
â†’
S.
On
the
other
hand,
by
the
isomorphism
in
the
discussion
at
the
end
of
Chapter
V,
Â§1
(where
we
take
â€œÎ±â€
to
be
e),
we
have
a
natural
isomorphism:
L|d
E
=
L|KL
âˆ¼
=
(L|e0
)
âŠ—OK
0
OKL
L
362
Indeed,
this
follows
immediately
from
the
discussion
at
the
end
of
Chapter
V,
Â§1,
in
the
case
when
m
=
2d
(which
ensures
that
L
is
symmetric).
But
this
case
diï¬€ers
(cf.
the
deï¬niton
of
L
in
Chapter
V,
Â§1)
from
the
case
of
an
arbitrary
m
by
a
translation,
plus
a
modiï¬cation
of
the
integral
structure
at
inï¬nity
by
a
d-invariant
distribution.
Translations
are
not
a
problem
(by
â€œtransport
of
structureâ€),
while
modiï¬cations
of
the
integral
structure
at
inï¬nity
by
a
d-invariant
distribution
are
not
a
problem
since
they
are
preserved
by
the
action
of
theta
groups
(cf.
Chapter
IV,
Proposition
5.1).
Thus,
in
particular,
we
see
(by
the
assumption
concerning
the
rationality
of
the
2-torsion
points!)
that
we
get
a
natural
action
(up
to
poles
annihilated
by
4)
of
Î S
on
(L|e0
)
âŠ—OK
0
OKL
L
(where
e
is
the
identity
section
of
C
â†’
S).
Thus,
we
obtain
a
natural
action
(up
to
poles
annihilated
by
4)
of
Î S
on
L|d
E
=
L|
â€ 
d
Eâˆ
i.e.,
on
the
range
of
the
evaluation
map
of
Chapter
VIII,
Theorem
A:
Î{âˆ,
et}
:
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et}
â†’
(fS
)âˆ—
(L|
â€ 
)
(d
Eâˆ
)
By
Chapter
VIII,
Theorem
A,
(2),
it
follows
that
the

poles
of
the
inverse
morphism
to
this
evaluation
map
are
contained
in
the
divisor
[Î·
(d
E)].
Thus,
we
see
that
we
get
a
natural
action
of
Î S
up
to
poles
in
the
divisor
[Î·
(d
E)]
+
V
(4)
on
def
HDR
=
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et}
(where
V
(4)
is
the
zero
locus
of
4).
Here
by
the
expression
â€œwith
poles
in
(a
divisor),â€
we
mean
that
the
action
of
any
element
of
Î S
induces
an
endomorphism
of
HDR
âŠ—
Q,
which
takes
HDR
into
the
subsheaf
of
HDR
âŠ—
Q
given
by
meromorphic
sections
of
HDR
which
are
integral
everywhere,
except
for
possible
poles
contained
in
the
divisor
stated.
Moreover,
the
Remark
following
Lemma
3.2
implies
that
if
we
put
a
metric
on
LC
(where
def
LC
=
L
âŠ—Z
C)
whose
curvature
on
the
ï¬bers
of
EC
â†’
SC
is
translation-invariant,
then
the
resulting
â€œeÌtale
metricâ€
||
âˆ¼
||et
(cf.
Chapter
VIII,
Theorem
A,
(4))
is
preserved
by
the
action
of
Î S
on
HDR
.
We
summarize
this
discussion
as
follows:
363
Theorem
3.3.
Let
S
log
be
any
connected
log
scheme,
whose
underlying
scheme
is
ï¬‚at
and
of
ï¬nite
type
over
Z,
and
such
that
the
log
structure
is
deï¬ned
by
a
divisor
with
normal
crossings.
Fix
positive
integers
m,
d,
where
m
does
not
divide
d.
Let
C
log
â†’
S
log
be
a
log
elliptic
curve
over
S
log
,
and
Î·
âˆˆ
Eâˆ,S
(Sâˆ
)
be
a
torsion
point
of
order
precisely
m
satisfying
the
hypotheses
of
Chapter
VIII,
Theorem
A.
Fix
geometric
points
sd
,
s
of
d
E
(the
scheme
of
d-torsion
points
of
Eâˆ,S
),
Int(S
log
)Q
such
that
sd
maps
to
s.
Write
def
Î S
=
Ï€1
((S
log
)Q
,
s)
log
for
the
algebraic
fundamental
group
of
Int(SQ
).
Let
us
assume
that
if
d
is
even,
then
Î S
acts
trivially
on
the
2-torsion
points
of
the
given
log
elliptic
curve.
Fix
a
metric
on
def
LC
=
L
âŠ—Z
C
whose
curvature
on
the
ï¬bers
of
EC
â†’
SC
is
translation-invariant.
Then
there
is
a
natural
action
of
Î S
on
the
metrized
vector
bundle
def
HDR
=
(fS
)âˆ—
(L|
â€ 
Eâˆ,[d]
)<d
{âˆ,
et}
on
S
which
is
integral
(over
S)
except
for
possible
poles
contained
in
the
divisor
[Î·

(d
E)]
+
V
(4)
and
preserves
the
â€œeÌtale
metricâ€
||
âˆ¼
||et
(cf.
Chapter
VIII,
Theorem
A)
determined
by
the
chosen
metric
on
L.
Next,
recall
that
the
metrized
vector
bundle
HDR
is
equipped
with
a
natural
ï¬ltration,
which
we
refer
to
as
the
Hodge
ï¬ltration.
The
subquotients
of
this
ï¬ltration
admit
natural
isomorphisms
(cf.
Chapter
VIII,
Theorem
A,
(3)):
1
âŠ—j
(F
j+1
/F
j
)(HDR
)
âˆ¼
=
Â·
exp(âˆ’(aÎ¹
)j
)
Â·
(fS
)âˆ—
(L|Eâˆ,S
)
âŠ—OS
Ï„E
j!
for
j
=
0,
.
.
.
,
d
âˆ’
1.
Here,
the
â€œexp(âˆ’(aÎ¹
)j
)â€
are
powers
of
the
q-parameter,
as
in
Chapter
VIII,
Theorem
A,
(3),
i.e.,
j2
exp((aÎ¹
)j
)
=
q
â‰ˆ
8d
Let
us
write
364
Filt(HDR
)
for
the
ï¬‚ag
variety
over
S
of
ï¬ltrations
of
HDR
which
are
of
the
same
â€œtypeâ€
(i.e.,
each
â€œF
j
â€
has
the
same
rank
as
F
j
(HDR
))
as
the
Hodge
ï¬ltration.
(Thus,
each
ï¬ber
of
Filt(HDR
)
â†’
S
is
noncanonically
isomorphic
to
the
ï¬‚ag
variety
of
ï¬‚ags
F
1
(V
)
âŠ†
F
2
(V
)
âŠ†
.
.
.
F
dâˆ’1
(V
)
âŠ†
F
d
(V
)
=
V
in
a
d2
-dimensional
vector
space
V
for
which
dim(F
j
(V
))
=
j
Â·
d.)
Note
that
if
we
apply
the
action
of
Î S
on
HDR
to
the
Hodge
ï¬ltration,
we
thus
obtain
a
morphism
:
Î S
â†’
Filt(HDR
)(S)
Îºarith
E
(where
the
â€œ(S)â€
denotes
the
â€œS-valued
pointsâ€).
Note
that
The
integrality
statements
of
Theorem
3.3
(at
both
the
ï¬nite
and
inï¬nite
primes)
imply
that
the
image
of
each
element
Î³
âˆˆ
Î S
under
Îºarith
is
a
E
j
to
denominators
contained
in
the
ï¬ltration
{Î³(F

(HDR
)}
such
that
(up
divisor
[Î·
(d
E)]+V
(4))
each
Î³(F
j
(HDR
)}
is
globally
isomorphic
(i.e.,
isomorphic
as
a
vector
bundle
on
S,
equipped
with
a
metric
over
SC
)
to
F
j
(HDR
).
is
entirely
analogous
to
the
construction
of
the
Note,
further
that
the
construction
of
Îºarith
E
â€œgroup-theoretic
Kodaira-Spencer
morphismâ€
Poly
(E
â€ 
))
Îºfunc
SL2
:
SL2
(R)
â†’
Filt(Holom
of
Â§1,
as
well
as
to
the
morphism
:
Î“R
â†’
Ï„EâŠ—2
(1)
Îºarith,p
R
R
Qp
of
Â§2.
Deï¬nition
3.4.
We
shall
refer
to
Îºarith
:
Î S
â†’
Filt(HDR
)(S)
E
as
the
arithmetic
Kodaira-Spencer
morphism
associated
to
E
â†’
S.
Example
3.5.
Suppose,
for
instance,
that
S
=
Spec(OK
)
365
where
OK
is
the
ring
of
integers
of
a
number
ï¬eld
K
(i.e.,
[K
:
Q]
<
âˆ).
Suppose,
moreover,
that
the
log
structure
of
S
log
is
deï¬ned
by
the
divisor
Dred
âŠ†
S
(where
D
is
the
â€œdivisor
at
inï¬nityâ€
associated
to
C
log
â†’
S
log
).
In
this
example,
let
us
assume
that
d
â‰¥
12
def
def
and
write
d2
=
2ord2
(d)
(i.e.,
d2
divides
d
and
d/d2
is
odd).
Here,
let
us
take
m
=
2d2
,
n
=
4d2
.
Suppose
that
the
elliptic
curve
EK
over
K
is
suï¬ƒciently
close
to
inï¬nity
at
all
the
archimedean
primes,
in
the
following
sense:
For
each
embedding
Ïƒ
of
K
into
C,
the
resulting
elliptic
curve
EÏƒ
(over
C)
can
be
written
as
Gm
/q
Z
,
where
q
=
exp(2Ï€iÏ„
)
satisï¬es:
Im(Ï„
)
â‰¥
200{log2
(d)
+
4d2
Â·
log(d)
+
4d2
Â·
log(4d2
)}
(Thus,
if
d
>>
d2
(for
instance,
if
d
is
odd,
in
which
case
d2
=
1),
then
the
lower
bound
on
Im(Ï„
)
goes
roughly
as
log2
(d).)
Note
that
it
is
not
diï¬ƒcult,
for
a
ï¬xed
d,
to
construct
lots
of
examples
of
EK
satisfying
this
condition
at
the
archimedean
primes.
Now
it
follows
from
Chapter
VIII,
Theorem
A,
(4),
(C),
that:
eâˆ’33d
Â·
||
âˆ¼
||qCG
â‰¤
1
Â·
eâˆ’32d
Â·
||
âˆ¼
||qCG
â‰¤
||
âˆ¼
||et
â‰¤
e4d
Â·
||
âˆ¼
||qCG
4d2
Thus,
in
particular,
it
follows
that
if
we
include
both
the
poles
at
the
ï¬nite
primes
(cf.
Theorem
3.3;
the
ï¬rst
Remark
following
Chapter
VI,
Theorem
4.1)
as
well
as
the
poles
at
the
archimedean
primes,
then:
The
global
divisor
of
poles
of
the
action
on
HDR
of
an
element
of
Î S
has
Arakelov-theoretic
degree
(cf.
Chapter
I,
Â§1)
â‰¤
38d
Â·
[K
:
Q],
and
is
concentrated
at
the
archimedean
primes,
and
the
primes
that
divide
m
=
2d2
.
(where
the
â€œ38â€
is
the
sum
of
the
â€œ4â€
and
the
â€œ33â€
appearing
in
the
inequalities
above,
plus
â€œ1â€
more,
to
take
care
of
the
contribution
from
the
ï¬nite
primes).
Put
another
way,
the
action
of
each
element
of
Î S
maps
HDR
,
whose
subquotients
are
given
by
1
Â·
exp(âˆ’(aÎ¹
)j
)
Â·
Ï„EâŠ—j
j!
(tensored
with
a
â€œcommon
factorâ€
of
(fS
)âˆ—
(L|Eâˆ,S
))
to
a
module
whose
subquotients
are
given
by
366
1
Â·
exp(âˆ’(aÎ¹
)j
)
Â·
Ï„EâŠ—j
Â·
(poles)
j!
(tensored
with
a
â€œcommon
factorâ€
of
(fS
)âˆ—
(L|Eâˆ,S
))
â€”
where
the
â€œ(poles)â€
admit
bounds
as
described
in
the
italicized
caption
above
â€”
in
a
fashion
which
is
integral
at
all
the
primes
(both
archimedean
and
non-archimedean)
of
the
number
ï¬eld
K.
Remark.
It
is
thus
tempting,
relative
to
the
analogue
with
the
Kodaira-Spencer
morphism
in
the
geometric
case,
to
try
to
apply
this
theory
to
obtain
bounds
on
the
height
of
an
elliptic
curve
over
a
number
ï¬eld,
as
conjectured
by
Szpiro
and
Vojta
(cf.,
e.g.,
[Lang],
[Vojta]).
There
are,
unfortunately,
a
number
of
technical
diï¬ƒculties
here.
Perhaps
the
most
obvious
is
the
factors
of
â€œexp(âˆ’(aÎ¹
)j
)â€
that
appear
in
the
subquotients
â€“
we
refer
to
these
factors
as
Gaussian
poles
(since
they
grow
like
a
Gaussian
distribution)
â€“
since
these
factors
distort
oneâ€™s
ability
to
compute
degrees
as
one
would
like.
That
is
to
say,
by
analogy
to
the
geometric
case,
ideally
one
wishes
for
only
the
factor
â€œÏ„EâŠ—j
Â·
(poles)â€
to
appear
in
these
subquotients.
Relative
to
this
point
of
view,
poles
of
the
order
â€œC
j
â‰ˆ
C
d
â€
(as
j
â†’
d)
are
not
a
substantial
problem
(at
least
if
one
concentrates
on
the
subquotients
where
j
is
close
to
d),
since
this
just
adds
an
extra
constant
term
to
the
Arakelov-theoretic
degree
of
Ï„E
.
From
this
point
of
view,
one
might
a
priori
think
that
the
factors
of
j!1
are
also
a
cause
for
concern
(since
they
are
not
of
the
order
C
d
).
Note
that
this
is
why,
in
the
theory
of
Chapter
VIII
â€“
cf.
especially
the
statement
concerning
analytic
torsion
and
the
product
formula
at
the
end
of
Chapter
VIII,
Theorem
A
â€“
we
were
so
concerned
with
making
sure
that
the
â€œdenominatorsâ€
that
occurred
in
the
theory
at
the
archimedean
primes
were
of
the
order
â€œC
d
â€
(i.e.,
even
when
one
takes
the
factors
of
j!1
mentioned
above
into
account).
Another
technical
diï¬ƒculty
(by
comparison
to
the
geometric
case)
is
the
general
nonlinearity
that
appears
â€“
e.g.,
of
Î S
,
by
comparison
to
the
tangent
bundle
in
the
geometric
case;
of
the
action
of
Î S
on
HDR
,
which
does
not
appear
to
arise
from,
say,
taking
symmetric
powers
of
the
some
action
on
F
2
(HDR
),
as
in
the
geometric
case.
Perhaps
this
nonlinearity
is
not
surprising
in
view
of
the
general
phenomenon
that
Arakelov
theory
tends
to
give
rise
to
nonlinear
objects
which
are
analogous
to
linear
objects
in
the
classical
geometric
theory
(for
instance,
the
global
integral
sections
of
a
line
bundle
in
Arakelov
theory
are
not,
in
general,
closed
under
addition).
Yet
another
technical
diï¬ƒculty
is
the
fact
that
in
Example
3.5
above,
we
needed
to
assume
that
EK
is
rather
close
to
inï¬nity
at
the
archimedean
primes.
It
is
the
hope
of
the
author
that
these
technical
diï¬ƒculties
can
be
overcome
in
a
future
paper.
367
Appendix:
Formal
Uniformization
of
Smooth
Abelian
Group
Schemes
In
this
Appendix,
we
review
various
well-known
facts
concerning
the
â€œexponential
mapâ€
of
an
abelian
group
scheme.
Let
S
be
a
noetherian
scheme.
Let
f
:Gâ†’S
be
a
smooth,
abelian
group
scheme
with
identity
section
e
:
S
â†’
G.
Observe
that
the
morphism
G
Ã—S
G
â†’
G
Ã—S
G
deï¬ned
on
T
-valued
points
(where
T
is
an
S-scheme)
g,
h
âˆˆ
G(T
)
by
(g,
h)
â†’
(gh,
g)
induces
an
isomorphism
of
the
diagonal
embedding
G
â†’
G
Ã—S
G
with
the
embedding
G
â†’
G
Ã—S
G
given
by
g
â†’
(g,
e)
(where
e
is
the
identity
element).
Since
the
sheaf
of
diï¬€erentials
Î©G/S
on
G
is
the
conormal
bundle
of
the
former
embedding,
we
thus
obtain
a
natural
isomorphism
f
âˆ—
eâˆ—
Î©G/S
âˆ¼
=
Î©G/S
Write
Î©
=
eâˆ—
Î©G/S
def
Thus,
Î©
is
a
locally
free
sheaf
on
S,
and
the
above
isomorphism
induces
a
natural
morphism
Î©
â†’
fâˆ—
Î©G/S
.
The
diï¬€erentials
in
the
image
of
this
morphism
are
called
invariant
diï¬€erentials
on
G.
Now
let
A
be
the
â€œpro-algebraâ€
(i.e.,
inverse
limit
of
ï¬nite
locally
free
OS
-algebras)
on
S
given
by
taking
the
completed
PD-envelope
in
G
of
e
(cf.,
e.g.,
[BO]
for
more
details).
Thus,
A
is
equipped
with
a
natural
augmentation
A
â†’
OS
(â€œevaluation
at
eâ€)
whose
kernel
I
is
a
PD-ideal
of
A.
If
n
is
a
positive
integer,
let
us
write
I
[n]
for
the
nth
divided
power
of
I.
Thus,
def
An
=
A/I
[n]
368
is
a
ï¬nite
locally
free
OS
-algebra,
and
I
[n]
/I
[n+1]
is
a
ï¬nite
locally
free
OS
-module.
Moreover,
A
is
complete
with
respect
to
the
ï¬ltration
.
.
.
âŠ†
I
[n]
âŠ†
.
.
.
âŠ†
I
[2]
âŠ†
I
Intuitively
speaking,
if
x1
,
.
.
.
,
xr
are
a
complete
set
of
local
parameters
on
G
(over
S)
at
e,
then
A
may
be
described
as
the
ring
of
formal
power
series
in
divided
powers
of
the
xi
with
coeï¬ƒcients
in
OS
.
Moreover,
note
that
A
may
be
regarded
as
also
being
equipped
with
an
OG
-algebra
structure
in
the
sense
that
one
has
a
coherent
system
of
natural
morphisms
Spec(An
)
â†’
G
(â€œTaylor
expansion
at
e
to
order
n
of
functions
on
Gâ€).
Thus,
if,
for
instance,
F
is
a
locally
free
coherent
sheaf
on
G,
it
makes
sense
to
write
A
âŠ—OG
F.
Moreover,
A
âŠ—OG
F
will
be
a
locally
free
A-module
of
ï¬nite
rank.
In
the
following,
we
shall
denote
A
âŠ—OG
âˆ§i
Î©G/S
by
Î©iA
.
Sometimes,
we
shall
want
to
consider
the
completed
PD-envelope
of
G
at
an
S-valued
point
x
âˆˆ
G(S)
of
G
which
is
not
equal
to
e.
Note,
however,
that
translation
by
x
induces
an
automorphism
Tx
:
G
â†’
G
which
maps
the
completed
PD-envelope
of
G
at
e
(i.e.,
A)
isomorphically
onto
the
completed
PD-envelope
of
G
at
x.
Thus,
in
the
following,
we
shall
identify
these
two
PDenvelopes
by
means
of
this
isomorphism.
Now
observe
that
by
formally
diï¬€erentiating
power
series,
we
obtain
a
de
Rham
complex
of
â€œPD-functionsâ€
d
A
âˆ’â†’
Î©1A
d
âˆ’â†’
Î©2A
d
âˆ’â†’
.
.
.
Composing
the
morphism
Î©
â†’
fâˆ—
Î©G/S
constructed
above
with
restriction
to
Î©1A
then
gives
us
a
morphism
Î¹
:
Î©
â†’
Î©1A
Now
we
have
the
following
well-known
result:
Lemma
A.1.
Suppose
that
the
map
OS
â†’
OS
given
by
multplication
by
2
is
injective.
Then
the
composite
of
Î¹
with
the
exterior
derivative
d
is
zero.
Proof.
Since
G
is
abelian,
it
follows
that
the
automorphism
Î½
:
G
â†’
G
given
by
inversion
is
a
group
homomorphism.
Note
that
Î½
induces
natural
actions
Î½
âˆ—
on
Î©
and
on
the
Î©iA
.
Indeed,
Î½
âˆ—
acts
as
âˆ’1
on
Î©
and
as
(âˆ’1)i
on
Î©iA
.
Since
d
and
Î¹
are
natural,
Î½
âˆ—
acts
on
elements
in
the
image
of
d
â—¦
Î¹
by
multiplication
by
âˆ’1.
On
the
other
hand,
since
these
369
elements
are
sections
of
Î©2A
,
Î½
âˆ—
must
act
on
these
elements
as
the
identity.
Thus,
it
follows
that
Im(d
â—¦
Î¹)
is
annihilated
by
multiplication
by
2.
On
the
other
hand,
since
Î©2A
is
an
inverse
limit
of
locally
free
coherent
OS
-modules,
it
follows
from
the
assumption
of
the
Lemma
that
Im(d
â—¦
Î¹)
=
0,
as
desired.

Let
us
assume
for
the
rest
of
this
Appendix
that
the
assumption
of
Lemma
A.1
is
in
force.
Thus,
the
diï¬€erentials
in
the
image
of
Î¹
are
closed,
and
hence,
by
formal
integration,
exact
(see,
e.g.,
[BO]
for
a
discussion
of
the
PoincareÌ
Lemma
in
the
context
of
PD-functions).
Moreover,
it
is
clear
(from
the
PoincareÌ
Lemma)
that
d
induces
an
isomorphism:
d
:
I
(âŠ†
A)
âˆ¼
=
{exact
diï¬€erentials
of
Î©1A
}
Thus,
we
see
that
Î¹
lifts
to
a
natural
morphism
Î»
:
Î©
â†’
I
whose
composite
with
the
projection
to
I/I
[2]
=
Î©
is
the
identity.
Deï¬nition
A.2.
Suppose
that
S
is
a
noetherian
scheme
such
that
multiplication
by
2
on
OS
is
injective.
Let
G
â†’
S
be
a
smooth,
abelian
group
scheme
over
S.
Then
we
shall
refer
to
the
natural
morphism
Î»
:
Î©
â†’
I
just
constructed
as
the
logarithmic
uniformization
(morphism)
of
G.
Proposition
A.3.
The
morphism
Î»
:
Î©
â†’
I
is
functorial
(in
the
obvious
sense)
with
respect
to
homomorphisms
G
â†’
H
of
smooth,
abelian
group
schemes
over
S.
Proof.
Indeed,
Î»
is
determined
by
its
composite
with
the
exterior
diï¬€erential
operator
d.
Thus,
it
suï¬ƒces
to
observe
that
the
morphism
Î©
â†’
fâˆ—
Î©G/S
constructed
above
is
functorial
in
G,
but
this
is
clear
from
its
construction.

Example
A.4.
Suppose
that
G
=
(Gm
)S
i.e.,
the
multiplicative
group
scheme
over
S.
One
may
think
of
G
as
the
spectrum
of
OS
[U,
U
âˆ’1
],
where
U
is
an
indeterminate.
Then
the
image
of
the
natural
morphism
370
Î©
â†’
fâˆ—
Î©G/S
constructed
above
is
generated
by
dU/U
.
Moreover,
Î»(dU/U
)
is
the
natural
logarithm
def
log(U
)
=
âˆ’
âˆ

(1
âˆ’
U
)i
i=1
Example
A.5.
i
Suppose
that
G
=
(Ga
)S
i.e.,
the
additive
group
scheme
over
S.
One
may
think
of
G
as
the
spectrum
of
OS
[T
],
where
T
is
an
indeterminate,
and
T
=
0
is
the
section
â€œe.â€
Then
the
image
of
the
natural
morphism
Î©
â†’
fâˆ—
Î©G/S
constructed
above
is
generated
by
dT
.
Moreover,
Î»(dT
)
is
just
the
function
T
.
Finally,
before
proceeding,
we
recall
the
analogue
of
the
construction
above
at
the
inï¬nite
prime.
Thus,
let
C
denote
the
ï¬eld
of
complex
numbers.
Let
G
be
an
abelian
complex
Lie
group.
Thus,
G
is
â€œan
abelian
group
objectâ€
in
the
category
of
complex
(i.e.,
holomorphic)
manifolds.
Let
Î˜
(respectively,
Î©)
denote
the
tangent
(respectively,
cotangent)
space
to
G
at
the
origin.
Thus,
Î˜
and
Î©
are
ï¬nite-dimensional
complex
vector
spaces
which
are
dual
to
one
another.
Now
one
knows
from
the
elementary
theory
of
complex
Lie
groups
(see,
e.g.,
[Vara])
that
there
exists
a
unique
holomorphic
morphism,
called
the
exponential
map
expG
:
Î˜
â†’
G
compatible
with
the
additive
structures
of
Î˜
and
G
and
whose
derivative
at
the
origin
is
the
identity
map
Î˜
â†’
Î˜.
Let
us
denote
by
Ahol
the
local
ring
of
holomorphic
functions
in
a
neighborhood
of
the
origin
of
G.
Thus,
Ahol
is
equipped
with
an
ideal
I
hol
âŠ†
Ahol
of
functions
vanishing
at
the
origin
of
G.
Since
expG
induces
an
isomorphism
between
the
local
rings
of
holomorphic
functions
in
a
neighbhorhood
of
the
origin
of
Î˜
and
G,
we
thus
see
that
the
local
coordinate
functions
(i.e.,
elements
of
Î©)
on
Î˜
deï¬ne
elements
of
I
hol
,
i.e.,
we
have
a
natural
morphism
Î»hol
:
Î©
â†’
I
hol
which
is
the
holomorphic
analogue
of
the
algebraic
Î»
constructed
above
in
the
following
sense:
Suppose
G
is
the
complex
Lie
group
deï¬ned
by
some
abelian
group
scheme
G
over
371
C.
Then
both
Ahol
and
A
embed
naturally
in
the
ring
Afor
of
formal
functions
at
the
origin
of
G
(i.e.,
the
ring
obtained
by
completing
G
at
e).
Write
I
for
âŠ†
Afor
for
the
ideal
of
functions
vanishing
at
the
origin.
Thus,
since
both
I
hol
and
I
may
be
regarded
as
subsets
of
I
for
,
it
follows
that
both
Î»hol
and
Î»
deï¬ne
natural
morphisms
Î©
â†’
I
for
.
Proposition
A.6.
These
two
morphisms
Î©
â†’
I
for
coincide.
Proof.
Indeed,
it
is
clear
(from
the
theory
of
the
exponential
map)
that
the
exterior
derivative
d
of
the
image
of
Î»hol
gives
rise
to
(the
power
series
expansions
at
the
origin
of)
invariant
diï¬€erentials
on
G.
Since
d
is
injective
on
I
for
,
this
completes
the
proof.

Bibliography
[BO]
P.
Berthelot
and
A.
Ogus,
Notes
on
Crystalline
Cohomology,
Princeton
Univ.
Press
(1978).
[Coln]
R.
Coleman,
Hodge-Tate
periods
and
p-adic
Abelian
integrals,
Inv.
Math.
78
(1984),
pp.
351-379.
[Colz]
P.
Colmez,
PeÌriodes
p-adiques
des
varieÌteÌs
abeÌliennes,
Math.
Ann.
292
(1992),
pp.
629-644.
[Falt1]
G.
Faltings,
p-adic
Hodge
Theory,
Journal
of
the
Amer.
Math.
Soc.
1,
No.
1
(1988),
pp.
255-299.
[Falt2]
G.
Faltings,
Crystalline
Cohomology
and
p-adic
Galois
Representations,
Proceedings
of
the
First
JAMI
Conference,
Johns-Hopkins
University
Press
(1990),
pp.
25-79.
[FC]
G.
Faltings
and
C.-L.
Chai,
Degenerations
of
Abelian
Varieties,
Springer-Verlag
(1990).
[Font]
J.
M.
Fontaine,
Formes
diï¬€erentielles
et
modules
de
Tate
des
varieÌteÌs
abeÌliennes
sur
les
corps
locaux,
Inv.
Math.
65
(1982),
pp.
379-409.
[Hyodo]
O.
Hyodo,
On
variation
of
Hodge-Tate
structures,
Math.
Ann.
284
(1989),
pp.
7-22.
[Katz]
N.
Katz,
Serre-Tate
Local
Moduli,
Algebraic
Surfaces
(Orsay,
1976-78),
Lecture
Notes
in
Mathematics
868,
Springer-Verlag
(1981),
pp.
138-202.
[KM]
N.
Katz
and
B.
Mazur,
Arithmetic
Moduli
of
Elliptic
Curves,
Annals
of
Mathematics
Studies
108,
Princeton
University
Press
(1985).
[Lang]
S.
Lang,
Introduction
to
Arakelov
Theory,
Springer-Verlag
(1988),
Appendix
by
Vojta.
[Mess]
W.
Messing,
The
Crystals
Associated
to
Barsotti-Tate
Groups;
with
Applications
to
Abelian
Schemes,
Lecture
Notes
in
Mathematics
264,
Springer-Verlag
(1972).
[Mumf]
D.
Mumford,
Abelian
Varieties,
Oxford
University
Press
(1974).
372
[Mzk1]
S.
Mochizuki,
A
Theory
of
Ordinary
p-adic
Curves,
Publ.
of
RIMS
32
(1996),
pp.
957-1151.
[Mzk2]
S.
Mochizuki,
Foundations
of
p-adic
TeichmuÌˆller
Theory,
AMS/IP
Studies
in
Advanced
Mathematics
11,
American
Mathematical
Society/International
Press
(1999).
[Mzk3]
S.
Mochizuki,
The
Local
Pro-p
Anabelian
Geometry
of
Curves,
Inv.
Math.,
to
appear.
[Vara]
V.
S.
Varadarajan,
Lie
Groups,
Lie
Algebras,
and
their
Representations,
Prentice
Hall
(1974).
[Vojta]
P.
Vojta,
Diophantine
Approximations
and
Value
Distribution
Theory,
Lecture
Notes
in
Mathematics
1239,
Springer-Verlag
(1987).
[Wint]
J.-P.
Wintenberger,
TheÌoreÌ€me
de
comparaison
p-adique
pour
les
scheÌmas
abeÌliens.
I:
Construction
de
lâ€™accouplement
de
peÌriodes,
PeÌriodes
p-Adiques,
AsteÌrisque
223,
Soc.
Math.
de
France
(1994).
373
